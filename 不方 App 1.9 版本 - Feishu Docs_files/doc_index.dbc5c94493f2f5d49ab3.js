(this.webpackJsonp=this.webpackJsonp||[]).push([["doc_index",5,7,9,16,17,"contact_us_button","i18n","list_component","viewport_watcher",62],{"+/Fj":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"18",height:"18",viewBox:"0 0 18 18"},t),c.a.createElement("path",{d:"M0 9a9 9 0 1018 0A9 9 0 000 9zm8.94 2.81h.69c.27 0 .5.23.5.5V13a.5.5 0 01-.5.5h-.7a.5.5 0 01-.5-.5v-.69c0-.27.23-.5.5-.5zm0-7.31h.69c.27 0 .5.22.5.5v4.63a.5.5 0 01-.5.5h-.7a.5.5 0 01-.5-.5V5c0-.28.23-.5.5-.5z",fill:"#FFC60A",fillRule:"evenodd"}))}},"+0ye":function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s});var i=n("HmyT"),r=n("182n"),o=function(e){for(var t=["heading-h1","heading-h2","heading-h3","heading-h4","heading-h5","heading-h6","heading-h7","heading-h8","heading-h9"],n=0;n<t.length;n++)if(Object(i.$)(e).hasClass(t[n]))return t[n];return null},a=function(e){return Number(e.match(/\d+/)[0])},s=function(e){var t=/heading-(\S+)/.exec(e);return!!t&&r.a.includes(t[1])}},"+4/E":function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i=n("lwsE"),r=n.n(i),o=n("vJtL"),a=n("qAkX"),s=(n("zmn3"),n("HmyT")),c=n("4HEM"),l=n("8wYP"),u=function(){return"comment-id-".concat(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")},d=function(e){return"comment-resolved-".concat(e)};function h(){return"doc-token-".concat(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")}function f(e){return Object(o.default)(e.getDocId)?e.getDocId():Object(o.default)(e.getToken)?e.getToken():""}function p(e,t){var n=Object(s.$)("<div>").html(t),i=h(f(e));return n.children().first().addClass(i),n.html()}},"+BHD":function(e,r,o){"use strict";(function(d){o.d(r,"a",function(){return i});var e=o("lSNA"),h=o.n(e),t=o("J4zp"),f=o.n(t),p=o("q1tI"),g=o.n(p),m=o("UlbS"),v=o("c5mg"),b=o("oGkr"),y=o("vKd0"),n=o("TSYQ"),E=o.n(n),O=(o("LMGK"),"list-modify-popup");function i(i){var e=i.continueVisible,t=i.createVisible,r=Object(p.useRef)(null),n=Object(p.useState)({}),o=f()(n,2),a=o[0],s=o[1];Object(p.useEffect)(function(){var e,t,n;r.current&&(e=window.getComputedStyle(r.current),t=parseInt(e.height||"0",10),n=parseInt(e.width||"0",10),t&&s(i.calcRenderStyle(t,n)))},[]);var c=function(e){"function"==typeof i.handleItemClick&&i.handleItemClick(e)},l=function(e){(r.current=e)&&i.popupContainerRef&&i.popupContainerRef(e)},u=[{key:"continue",disable:!e,Icon:v.a,text:d("doc.list.continue_numbering")},{key:"create",disable:!t,Icon:b.a,text:d("doc.list.start_a_new_list")},{key:"renumber",disable:!1,Icon:y.a,text:d("doc.list.restart_numbering")}];return g.a.createElement("div",{className:O,style:a,ref:l},g.a.createElement(m.Menu,{selectable:!1,onItemClick:c,className:"".concat(O,"-menu")},u.map(function(e){var t=e.Icon,n=e.key,i=e.text,r=e.disable;return g.a.createElement(m.Menu.Item,{key:n,value:n,disable:r,className:E()("".concat(O,"-menu-item"),h()({},"".concat(O,"-menu-item-disabled"),r))},g.a.createElement(t,{className:"".concat(O,"-menu-icon")}),g.a.createElement("span",{className:"".concat(O,"-menu-text")},i))})))}}).call(this,o("2vAP"))},"+DGl":function(e,t,n){"use strict";var i=n("o0o1"),o=n.n(i),r=n("J4zp"),a=n.n(r),s=n("yXPU"),c=n.n(s),l=n("lwsE"),u=n.n(l),d=n("W8MJ"),h=n.n(d),f=n("uXHE"),p=n("y2sV"),g=function(){function t(e){var n=this;u()(this,t),this.className="ISVBlock",this.onEditorContentChange=function(){n.editor&&n.scaleText(n.editor.plugins.viewportObserver.getVisibleRange())},this.viewportChangeHandler=function(e){var t=e.visibleRangeInMainZone;n.scaleText(t)},e&&(this.editor=e,this.bindEvent("on"))}function e(e){return n.apply(this,arguments)}var n;return h()(t,[{key:"reset",value:function(){this.bindEvent("off")}},{key:"bindEvent",value:function(e){this.editor&&(this.editor[e](p.k.CONTENT_CHANGE,this.onEditorContentChange),this.editor[e]("viewportChange",this.viewportChangeHandler))}},{key:"scaleText",value:(n=c()(o.a.mark(function e(t){var n,i,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.editor||f.a.ready)return this.bindEvent("off"),e.abrupt("return");e.next=3;break;case 3:n=a()(t,2),i=n[0],r=n[1],Object(f.b)(this.editor,{selStart:[i-15,0],selEnd:[r+15,0]}).filter(function(e){return e.props.data.AppBlockId}).length&&f.a.initBlockit();case 6:case"end":return e.stop()}},e,this)})),e)}]),t}();t.a=g},"+ECM":function(e,t,n){},"+FT0":function(e,t,n){"use strict";n.d(t,"a",function(){return i});n("FJEn");function i(e){var t=e.getRep(),n=t.zoneId,i=t.selStart,r=t.selEnd;return"0"===n&&0===i[0]&&0===r[0]}},"+Gkg":function(e,b,y){"use strict";(function(n){y.d(b,"a",function(){return v});var e=y("lwsE"),i=y.n(e),t=y("W8MJ"),r=y.n(t),o=y("a1gu"),a=y.n(o),s=y("Nsbk"),c=y.n(s),l=y("7W2i"),u=y.n(l),d=y("q1tI"),h=y.n(d),f=y("ahx2"),p=y("JyuV"),g=y("6jHd"),m=y("3VXv"),v=function(e){function t(){return i()(this,t),a()(this,c()(t).apply(this,arguments))}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props.className,t=this.coverInfo,n=t.cover,i=t.text;return h.a.createElement(m.a,{className:e},n&&h.a.createElement(n,null),Boolean(i)&&h.a.createElement(m.b,null,i))}},{key:"coverInfo",get:function(){var e={cover:null,text:""};switch(this.props.code){case f.SpecitalSuiteCodeMap[9009]:e.cover=p.a,e.text=n("common.cover.empty_doc");break;case f.SpecitalSuiteCodeMap[9010]:e.cover=g.a}return e}}]),t}(h.a.Component)}).call(this,y("2vAP"))},"+I4n":function(e,t,n){"use strict";n.d(t,"a",function(){return Z});var i=n("RIqP"),m=n.n(i),v=n("H6oK"),r=n("wd/R"),o=n.n(r),l=n("Hj9z"),b=n("Kwn9"),u=n("4PFL"),d=n("rhi5"),h=n("D7h9"),f=n("xKvl"),p=n("2ACu"),g=n("FnDM"),y=n("iR+8"),a=n("ZGZ5"),s=n("5cZX"),c=n("uGsk"),E=n("AiBH"),O=n("vE74"),C=n("HIeq"),k=n("1dfU"),I=n("rFy5"),S=n("VI6H"),T=n("QM+C"),_=n("iP/4"),w=n("kUgE"),j=n("IyQe"),M=n("qYkn"),L=n("CVSs"),R=n("n/R6"),N=n("OX8E"),D=n("toa8"),x=n("y9S/"),P=n("5UUe"),B=n("bn+F"),U=n("KhU0");Object(c.a)();var z={SOURCE:E.z.DOC,SUITE_TYPE:T.NUM_FILE_TYPE.DOC,JOIN_CHAT_ERROR_MSG:E.s},H={createCustomEvent:O.b,getPageToken:C.e,encryptTea:k.a,htmlEncode:I.b,htmlDecode:I.a,getIsCurrentUserToCUser:S.g},F={browser:_.a,getLanguage:w.getLanguage,getLocale:w.getLocale,getUserPermissions:j.getUserPermissions,moment:o.a},V={copyTextWithoutPermission:M.a,clearFailedServices:L.clearFailedServices},W={selectCurrentUser:a.a,selectCurrentSuiteOtherPermissions:s.u,selectCanEditInvolvingEditMode:s.e,selectFromMinaConfig:s.A};function K(e){var t=e.sheetBridgePlugin,n=e.bitableBridgePlugin,i=e.mindnoteBridgePlugin,r=e.historyMode,o=e.options,a=e.modules,s=[];a&&a.iframeModule&&(s=a.iframeModule);var c=a.blockWidthNotifyModule;return new v.BlockManager([new l.AtUserCreator({ExternalServices:b.a.AtUserCreator,moduleConfigs:m()(c)}),new l.FileCardCreator({ExternalServices:b.a.FileCardCreator,moduleConfigs:m()(c)}),new l.IframeCreator({ExternalServices:Object.assign({},b.a.IframeCreator,{mountOptions:{historyMode:r[v.BlockType.IFRAME_BLOCK]}}),moduleConfigs:[].concat(m()(s),m()(c))}),new l.PollCreator({ExternalServices:{LogService:{teaLogger:f.b,collectEvent:p.default,collectSuiteEvent:p.collectSuiteEvent},t:y.b,Utils:H,Helpers:F,Redux:{store:h.default,selectors:W,actions:V},Toast:R.a,VotePicker:b.c,VoteEmoji:b.b,io:null,EventEmitter:N.a,mountOptions:{historyMode:r[v.BlockType.POLL_BLOCK]}},moduleConfigs:m()(c)}),new l.JiraIssueCreator({ExternalServices:Object.assign({},b.a.JiraCreator(N.a),{components:{JiraIssueCard:d.c,SyncBtn:d.d,JiraFieldConfigurePopover:d.b},request:D.d,mountOptions:{historyMode:r[v.BlockType.JIRA_ISSUE_BLOCK]}}),moduleConfigs:m()(c)}),new l.JiraFilterCreator({ExternalServices:Object.assign({},b.a.JiraCreator(N.a),{components:{SyncBtn:d.d},viewManager:x.a.getInstance,mountOptions:{historyMode:r[v.BlockType.JIRA_ISSUE_BLOCK]}}),moduleConfigs:m()(c)}),new l.SheetCreator({ExternalServices:Object.assign({LogService:{teaLogger:f.b,collectEvent:p.default,collectSuiteEvent:p.collectSuiteEvent},t:y.b,Utils:H,Helpers:F,EventEmitter:N.a},Object(B.a)(),{},Object(u.b)(t),{mountOptions:{historyMode:r[v.BlockType.SHEET_BLOCK]}})}),new l.PlaceholderCreator({ExternalServices:{t:y.b}}),new l.ReminderCreator({ExternalServices:{t:y.b,Helpers:F,EventEmitter:N.a}}),new l.ChatCardCreator({ExternalServices:{Redux:{store:h.default,selectors:W,actions:V},LogService:{teaLogger:f.b,collectEvent:p.default,collectSuiteEvent:p.collectSuiteEvent,getFileType:g.f,getEncryptToken:g.d},Toast:R.a,Constants:z,Utils:H,Request:D.d,t:y.b,mountOptions:{historyMode:r[v.BlockType.CHAT_CARD_BLOCK]},onRenderComplete:function(n,e){var t;o&&o.inSideHistory&&((t=document.querySelector("#history-sidebar"))&&Array.from(t.querySelectorAll(".block-id-".concat(e))).forEach(function(e){var t;!!e.querySelector(".block-chatcard__ready")||(t=e.querySelector(".block-chatcard__content"))&&(t.innerHTML=n.innerHTML)}))}},moduleConfigs:m()(c)}),new l.BitableCreator({ExternalServices:Object.assign({},b.a.BitableCreator(N.a),{},Object(P.b)(n),{mountOptions:{historyMode:r[v.BlockType.BITABLE_BLOCK]}})}),new l.ISVCreator({ExternalServices:Object.assign({},b.a.ISVCreator(N.a),{mountOptions:{historyMode:r[v.BlockType.ISV_BLOCK]}})}),new l.DiagramCreator({ExternalServices:Object.assign({},b.a.DiagramCreator(N.a),{mountOptions:{historyMode:r[v.BlockType.DIAGRAM_BLOCK]}}),moduleConfigs:m()(c)}),new l.EquationCreator({ExternalServices:b.a.EquationCreator}),new l.MindnoteCreator({ExternalServices:Object.assign({},b.a.MindnoteCreator(N.a),{},Object(U.b)(i),{mountOptions:{historyMode:r[v.BlockType.MINDNOTE_BLOCK]}})}),new l.LinkBlockCreator({ExternalServices:b.a.LinkBlockCreator})])}function Z(e,t){var n=t.sheetBridgePlugin,i=t.bitableBridgePlugin,r=t.mindnoteBridgePlugin,o=t.historyMode,a=t.defaultSupportModules,s=t.useSyncRender,c=t.options,l=t.modules,u=t.appConfig,d=l&&l.iframe.regionSelector?Object(b.e)({regionSelector:l.iframe.regionSelector,ignoreComment:!1}):null,h=l&&l.mindnote.regionSelector?Object(b.f)({regionSelector:l.iframe.regionSelector,ignoreComment:!1,regionPadding:0}):null,f=(d||h)&&Object(b.g)(),p=Object(b.d)(),g=new v.BlockPlugin({editor:e,blockManager:K({sheetBridgePlugin:n,bitableBridgePlugin:i,mindnoteBridgePlugin:r,historyMode:o,options:c,modules:{iframeModule:d,mindnoteModule:h,blockWidthNotifyModule:p}}),pure:!0,appConfig:Object.assign({lazyBlockRender:!0,blockFiberRender:!1},u||{}),defaultSupportModules:a,useSyncRender:!!s,modules:f?[].concat(m()(f),m()(p)):m()(p)});return n.setBlockEventEmitter(g.event),r.setBlockEventEmitter(g.event),g}},"+KmE":function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"u",function(){return o}),n.d(t,"o",function(){return m}),n.d(t,"q",function(){return l}),n.d(t,"v",function(){return u}),n.d(t,"f",function(){return h}),n.d(t,"n",function(){return d}),n.d(t,"m",function(){return f}),n.d(t,"k",function(){return v}),n.d(t,"l",function(){return b}),n.d(t,"d",function(){return y}),n.d(t,"c",function(){return E}),n.d(t,"j",function(){return O}),n.d(t,"p",function(){return C}),n.d(t,"h",function(){return k}),n.d(t,"i",function(){return I}),n.d(t,"r",function(){return S}),n.d(t,"g",function(){return T}),n.d(t,"s",function(){return _}),n.d(t,"e",function(){return M}),n.d(t,"b",function(){return L}),n.d(t,"a",function(){return R});var i=n("lSNA"),p=n.n(i),s=n("eaa2"),c=n("Muja"),a=n("y2sV"),g=n("p3Wu");function r(e,t){var n=e.repManager.editor.getLineListInfo(e.zoneId,t);return!(!n||!g.g.exec(n.listType))}function o(e,t){return!!r(e,t)&&0===y(e,t,e.repManager.editor.getLineListInfo(e.zoneId,t).listId,g.b.UP).length}function m(e){var t=g.g.exec(e);return t?parseInt(t[2],10):null}function l(e,t){var n=e.attributeManager.findAttributeOnLine(t,"text-indent");if(!n)return!1;var i=/([a-z]+)([0-9]+)/.exec(e.repManager.editor.getLineListType(e.zoneId,t)),r=0;return i&&(r=Number(i[2])),n&&(r+=2),r}function u(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"number1",i=l(e,t);return i?"number".concat(i):n}function h(e,t,n,i,r){var o,a,s=e.lines.length(),c=(o={},p()(o,g.b.UP,-1),p()(o,g.b.DOWN,1),o);for(t+=c[n];0<=t&&t<s;t+=c[n]){var l=e.repManager.editor.getLineListInfo(e.zoneId,t)||{},u=l.listId,d=void 0===u?"":u,h=l.listType,f=m(void 0===h?"":h);if(f){if((a=a||d)&&d!==a||i&&!r&&f<i)return null;if(void 0===i||r&&f<i||!r&&f===i)return{zoneId:e.zoneId,listId:d,lineNum:t,order:parseInt(e.attributeManager.findAttributeOnLine(t,"start"),10),level:f}}}return null}function d(e,t,n,i,r){var o,a=i&&r?{level:i,order:r}:v(e,n);if(!a)return null;var s=a.level,c=a.order;if(1<s&&t===g.b.UP){var l=h(e,n,t,s,!0);if(l||1===c)return l}var u=h(e,n,t,s);if(!u)return null;var d=(o={},p()(o,g.b.UP,-1),p()(o,g.b.DOWN,1),o);return u.order===c+d[t]?u:null}function f(e,t,n){var i=n||t,r=h(e,t,g.b.UP),o=h(e,i,g.b.DOWN);return r&&o&&r.listId===o.listId?{upwardClosestOListInfo:r,downwardClosestOListInfo:o}:{}}function v(e,t){var n=e.repManager.editor.getLineListInfo(e.zoneId,t)||{},i=n.listId,r=void 0===i?"":i,o=n.listType,a=void 0===o?"":o,s=g.g.exec(a);return s?{zoneId:e.zoneId,listId:r,lineNum:t,order:parseInt(e.attributeManager.findAttributeOnLine(t,"start"),10),level:parseInt(s[2],10)}:null}function b(e,t){var n=e.repManager.editor.domToRep(t);return n?v(e,n.selStart[0]):null}function y(e,t,n,i){var r,o=[],a=/(number)([0-9]+)/,s=e.lines.length(),c=(r={},p()(r,g.b.UP,-1),p()(r,g.b.DOWN,1),r);for(t+=c[i];0<=t&&t<=s;t+=c[i]){var l=e.repManager.editor.getLineListInfo(e.zoneId,t)||{},u=l.listType,d=void 0===u?"":u,h=l.listId,f=void 0===h?"":h;if(a.exec(d)){if(f!==n)break;o.push(t)}}return o}function E(e,f,p){return e.every(function(e){for(var t=e.selStart,n=e.selEnd,i=e.attributeManager,r=t[0],o=n[0],a=r;a<=o;a++){var s=i.getAttributeOnLine(a,f);if(!s||s.slice(0,p.length)!==p){for(var c=i.getAttributesOnLine(a),l=!1,u=0,d=c.length;u<d;++u){var h=c[u][0];if("sheet-id"===h||"horizontal-line"===h||"aceTable"===h){l=!0;break}}if(!l)return!1}}return!0})}function O(e){for(var t=null,n=e;n;){if("UL"===n.tagName){t="bullet";break}if("OL"===n.tagName){t="number";break}n=n.parentElement}return t}function C(e){for(var t=null,n=e;n;){var i=/(?:^| )list-([a-z]+[0-9]+)\b/.exec(n.className);if(i&&i[1]){t=i[1];break}n=n.parentElement}return t}function k(e){for(var t=0,n=e.parentElement;n;)["OL","UL"].includes(n.tagName)&&t++,n=n.parentElement;return t}function I(e){var t=e.parentElement;if(t&&"OL"===t.tagName&&"LI"===e.tagName)return Array.from(t.children).indexOf(e)+1;for(;t;){if("OL"===t.tagName&&t.start)return t.start;t=t.parentElement}return 1}function S(a){var s=[],c=0;return a.forEach(function(e,t){var n=a[t-1],i=T(e).type,r=s[c]&&T(s[c][0]),o=e&&e.parentNode&&n&&n.parentNode&&Number(e.parentNode.dataset.lineIndex)===Number(n.parentNode.dataset.lineIndex)+1;0===t||o&&i===r.type?s[c]||(s[c]=[]):s[++c]=[],s[c].push(e)}),s}function T(e){if(e instanceof HTMLElement){var t=e.dataset.list||"",n=/(number|bullet|check|done)(\d+)/;if(n.test(t)){var i=n.exec(t),r=i[1],o=Number(i[2]);return"number"===r?{type:"ol",level:o}:{type:"ul",level:o}}}throw new Error("unkonw list node")}function _(e){return w(e)||j(e)}function w(e){return e.split("number")[1]}function j(e){return e.split("bullet")[1]}function M(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(1<t){var n=M(e,--t),i=n.child,r=n.root,o=document.createElement(e);return o.appendChild(r),{child:i,root:o}}var a=document.createElement(e);return{child:a,root:a}}var L=function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],r=4<arguments.length&&void 0!==arguments[4]&&arguments[4],o=e.getAllAttributesOnLine(t,n),a=r?c.default:function(e,t){return e[0]===t[0]};return Object(s.a)(i,o,a).length<=0};function R(e,t,n){var i,r,o=e.get(t);o instanceof a.E&&(i=o.ops[0],r=new a.E({zoneId:t}),"*"===i.insert&&i.attributes&&i.attributes.lmkr?r.retain(1,Object.assign({},i.attributes,{},n)):r.insertLineMarker(n),e.replace(t,o.compose(r)))}},"+Xq6":function(e,t,n){"use strict";var i=n("wN88");n.d(t,"d",function(){return i.a}),n.d(t,"e",function(){return i.b}),n.d(t,"g",function(){return i.d}),n.d(t,"h",function(){return i.e});var r=n("qkqw");n.d(t,"a",function(){return r.a}),n.d(t,"c",function(){return r.b});var o=n("PiJo");n.d(t,"f",function(){return o.generatePublicUrl}),n.d(t,"i",function(){return o.makePulicUrlEffective})},"+c5q":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("J4zp"),b=n.n(i),y=n("elsr"),E=n("y2sV"),O=n("Tqb2"),C=function(e,t,n){var i=e.offsetToPoint(t),r=e.offsetToPoint(n);return e.getEntities({start:i,end:r})},k=function(e,t,n){if(!t)return!1;var i=t.text===E.o&&t.attributes.lmkr,r=e.offsetToPoint(n),o=r.line,a=r.offset,s=e.getLine(o);if(!s)return!1;var c="\n"===s.getModelText()[a];return i||c},s=function(e,t){var n=e.insert===E.o&&e.attributes&&e.attributes.lmkr;return(t?e.insert.endsWith(E.f):e.insert.startsWith(E.f))||n},I=function(e,t){var n=e.line,i=e.offset;if(e.zoneId!==y.a)return!1;if(0!==n)return!1;var r=t.getContentState().getZoneState(y.a).getLine(0);return!!r&&(0===i||r.hasLineMarker()&&1===i)},r=function(e,t){var n,i,r,o,a,s,c,l,u,d,h,f,p=t.selection.getSelection(),g=p.start,m=p.end,v=g.zoneId;e.zoneId===v&&(n=t.getContentState().getZoneState(v),r=(i=e.ops)[0],o=i[i.length-1],a=v!==y.a&&m.line===n.length()-1,Object(O.M)(r)&&(s=n.pointToOffset(g),c=I(g,t),l=C(n,Math.max(0,s-1),s),u=b()(l,1)[0],k(n,u,s-1)&&!c||i.splice(0,0,{insert:E.f})),Object(O.M)(o)&&(d=n.pointToOffset(m),h=C(n,d,d+1),f=b()(h,1)[0],k(n,f,d)&&!a||i.splice(i.length,0,{insert:E.f})))},o=function(e,t){var a=e.ops;if(0===a.length)return e;r(e,t);return e.reduce(function(e,t,n){if(e.push(t),t.insert){var i=a[n+1];if(!i)return e;var r=Object(O.M)(t),o=Object(O.M)(i);r&&!o?s(i,!1)||e.insertEnter():!r&&o&&(s(t,!0)||e.insertEnter())}return e},e.create({zoneId:e.zoneId}))}},"+exY":function(e,t,n){"use strict";var i=n("QILm"),r=n.n(i),o=(n("Bw5p"),n("Qyje")),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("cDf5"),u=n.n(l),d=n("lwsE"),h=n.n(d),f=n("FeGr"),p=n.n(f),g=0,m=function r(e){var o=this;if(h()(this,r),this.state=r.PENDING,this.canceled=!1,this.deferredQueue=[],this.deferredState=r.DEFER_INIT,this.then=function(e,t){var n=new r(r.noop),i=new v(n,e,t);return b(o,i),n},this.catch=function(e){return o.then(void 0,e)},this.always=function(e){return o.then(e,e)},this.abort=function(){return o.cancel()},this.cancel=function(){return o.canceled=!0,o},this.finally=function(t){return o.then(function(e){return Promise.resolve(t()).then(function(){return e})},function(e){return Promise.reject(t()).then(function(){throw e})})},this.id=g++,e!==r.noop)try{e(function(e){E(o,e)},function(e){y(o,e)})}catch(e){y(this,e)}};m.PENDING=0,m.RESOLVED=1,m.REJECTED=2,m.DEFER_INIT=0,m.DEFER_ADDED=1,m.noop=function(){};var v=function e(t,n,i){h()(this,e),this.onFulfilled="function"==typeof n?n:void 0,this.onRejected="function"==typeof i?i:void 0,this.promise=t};function b(e,t){switch(e.deferredQueue.push(t),e.deferredState=m.DEFER_ADDED,e.state){case m.RESOLVED:E(e,e.value);break;case m.REJECTED:y(e,e.value)}}function y(e,t){e.value=t,e.state=m.REJECTED,O(e,t,m.REJECTED)}function E(t,e){if(e===t){var n=new TypeError("A promise cannot be resolved with itself.");return y(t,n)}if(e&&e.then)try{e.then(function(e){E(t,e)},function(e){y(t,e)})}catch(n){y(t,n),console.error(n)}else t.value=e,t.state=m.RESOLVED,O(t,e,m.RESOLVED)}function O(e,i,r){e.deferredState!==m.PENDING&&p()(function(){e.deferredQueue.forEach(function(t){if(!t.promise.canceled){var e=r===m.RESOLVED?t.onFulfilled:t.onRejected;if(e)try{var n=e(i);E(t.promise,n)}catch(e){y(t.promise,e)}else(r===m.RESOLVED?E:y)(t.promise,i)}})})}var C=n("DgHK"),k=n("fujP"),I=n("Ysvc"),S=n("lQZd"),T=n("TNRG"),_=n("2ACu");function w(u){return new Promise(function(t,e){var n=u.data,n=Object.is(u.data,null)?"":n,i=u.needSync,r=void 0!==i&&i,o=u.token,a=void 0===o?Object(S.g)():o,s=u.uri,c=void 0===s?location.pathname:s,l=u.keyGened?u.key:M(u.key);Object(I.e)()?window.lark.biz.util.setData({key:l,data:n,needSync:r,objToken:a,uri:c,type:u.type,dataType:u.dataType,callback:function(e){t(e)}}):T.b.setItem(a+"_"+l,JSON.stringify(n)).then(function(e){t({code:0,data:n})}).catch(e)})}function j(o){return new Promise(function(n,e){var t=o.token,i=void 0===t?Object(S.g)():t;o.token=i;var r=o.keyGened?o.key:M(o.key);Object(I.e)()?window.lark.biz.util.getData({key:r,objToken:o.token,callback:function(e){var t="CLIENT_VARS"===r.substr(-11)&&e.data&&e.data.data&&e.data.data.collab_client_vars||{};t.initialAttributedText&&!t.initialAttributedTexts&&(t.initialAttributedTexts={texts:{0:t.initialAttributedText.text},attribs:{0:t.initialAttributedText.attribs}}),n(e)}}):T.b.getItem(i+"_"+r).then(function(t){var e="";try{e=JSON.parse(t)}catch(e){Object(_.collectSuiteEvent)("dev_getData_error",{data:t,err:e})}Object(k.default)(e)&&(e=""),n({code:0,data:e})}).catch(e)})}function M(e){var t=L();return"".concat(t,"_").concat(e)}function L(){var e=window.User,t=e.tenantId,n=void 0===t?1:t,i=e.id;return"".concat(n,"_").concat(i)}window.getData=j,window.setData=w;var R=n("TRtO"),N=n("yH1+"),D=n("dQBc");function x(e){var t=e.res,n=e.req,i=e.isRejected,r=n.noStore,o=n.readStore;return!r||o||Object(N.c)()?(r&&!o||!n.resolved||t.from!==D.g||!i||!t._networkCode)&&t?i?Promise.reject(t):t:new Promise(function(){}):Promise.reject(new Error("networker error"))}var P=n("iP/4"),B="application/json",U=function e(){var o=this;h()(this,e),this.request=function(n){return new m(function(e,t){!P.a.mobile||n.noStore&&!n.readStore||o.requestLocal(n).then(e,t),!0===o.config.forbidden&&!n.ignoreForbidden||o.requestNetwork(n.url,n).then(e,t)})},this.setFetchConfig=function(e){o.config=e},this.requestLocal=function(t){return j(t).then(function(e){return e&&"object"===u()(e.data)&&(e.data.from=D.a),e.data?console.info("local request success response:".concat(t.key," ok")):console.info("local request success response:".concat(t.key," no data")),e.data})},this.requestNetwork=function(e,t){return Object(I.e)()&&Object(I.c)()?o.nativeRequest(t):o.ajaxRequest(t.url,t)},this.ajaxRequest=function(i,e){var r=e.method,t=e.headers,o=void 0===t?{}:t,a=e.contentType||o["Content-Type"],s=e.body;return a===B&&"object"===u()(s)&&(s=JSON.stringify(s)),new Promise(function(t,n){delete o["Accept-Encoding"],Object(C.a)({url:i,data:s,method:r,contentType:a,headers:o}).then(function(e){"object"===u()(e)&&(e.from=D.g),t(e),console.info("ajax request success response ".concat(i))},function(e){e.then?n({res:e,code:D.h,message:"xhr request error"}):n(e),R.a.error("ajax request error ".concat(i," ----\x3e: ").concat(JSON.stringify(e)))})})},this.nativeRequest=function(a){return new Promise(function(r,o){window.lark.biz.util.fetch(Object.assign({},a,{callback:function(e){var t=e.code,n=e.data,i=void 0===n?{}:n;return"object"===u()(i)&&(i.from=D.g),t?(e.data._networkCode=t,o(e.data),console.info("native request error ".concat(a.key,"\n             req:").concat(JSON.stringify(a)," response:").concat(JSON.stringify(e)))):e.data.code?(o(e.data),console.info("api request error\n             req:".concat(JSON.stringify(a)," ").concat(a.key,"----\x3e: ").concat(JSON.stringify(e)))):(r(e.data),void console.info("native request success response ".concat(a.key," ok")))}}))})},this.fetch=function(e,t){var n=[],i=Object.assign({url:e},t);o.interceptors.request.handles.forEach(function(e){e.fulfilled&&(i=e.fulfilled(i))});var r=o.request(i);for(o.interceptors.response.use(x,x),o.interceptors.response.handles.forEach(function(t){n.push(function(e){return t.fulfilled?t.fulfilled({req:i,res:e,isRejected:!1}):e},function(e){return t.rejected?t.rejected({req:i,res:e,isRejected:!0}):e})});n.length;)r=r.then(n.shift(),n.shift());return r.catch(function(e){console.error(e)}),r},this.interceptors={request:new z,response:new z},this.config={forbidden:!1}},z=function(){function e(){h()(this,e),this.handles=[]}return c()(e,[{key:"use",value:function(e,t){this.handles.push({fulfilled:e,rejected:t})}}]),e}(),H=n("oaNE"),F=n("TJya"),V="application/x-www-form-urlencoded",W="POST",K="GET",Z=0;function q(e){var t=e.url,n=e.contentType,i={method:W,key:t,token:Object(S.g)(),reqId:++Z,serverFirst:!1,readStore:!1,noStore:!1,once:!1,ignoreForbidden:!1,headers:Object.assign({"Content-Type":n||V,"Accept-Encoding":"gzip, deflate, br",Accept:"application/json, text/plain, */*",Pragma:"no-cache"},Object(F.a)()),body:{}};return e=Y(e=Object(H.a)(i,e)),Object(I.c)()&&e.body&&"string"!=typeof e.body&&(e.body=JSON.stringify(e.body)),e}function Y(e){return e.headers&&e.headers["Content-Type"]===V&&"object"===u()(e.body)&&(e.body=a.a.stringify(e.body,{arrayFormat:"repeat"})),e.method===K&&e.body&&(e.url=(-1<e.url.indexOf("?")?"".concat(e.url,"&"):"".concat(e.url,"?")).concat(e.body),delete e.body),e}var J=n("lSNA"),Q=n.n(J),X=n("QYVc");function $(e){var t=e.req,n=e.res;if(!n||!n.data){var i=ee(t.url,r()(t,["url"]));if(i)return i.from=D.a,i}return n}function ee(e,t){var n=t.key,i=void 0===n?"":n;return Object(X.a)()?te(e,t):i!==D.c||Object(N.c)()?i!==D.j||Object(N.c)()?null:{type:"SPREADSHEET",data:{fakeCode:D.e,type:D.c,token:Object(S.g)()}}:{type:"DOC",data:{fakeCode:D.e,type:D.c,token:Object(S.g)(),collab_client_vars:{rev:1}}}}function te(e,t){var n="/api/suite/permission.v2/user/",i="/api/suite/permission/user",r=t.key,o=void 0===r?"":r;if(o!==D.c)return-1<o.indexOf(i)?{data:{permissions:15,entities:{users:{}}},code:0,msg:"",meta:{}}:-1<o.indexOf(n)?{code:0,data:{permissions:15,relationship_level:1,contact_url:""},msg:"Success",meta:{}}:null;var a=window.User.id;return{type:"DOC",req_id:0,from:D.a,data:{type:D.c,token:Object(S.g)(),docKey:(new Date).getTime(),user_id:a,collab_client_vars:Object.assign({},Object(D.m)(),{rev:0,time:Date.now(),comment_rev:0,doc_comment_rev:0}),readonly:!1,permissions:[1,2,4,8],colorPalette:["#E94D3D"],is_template:!1,entities:{users:Q()({},a,{cn_name:"",en_name:"",avatar_url:"",user_email:"",user_mobile:""})}}}}function ne(e){var t=e.req,n=e.res,i=e.isRejected;return!0===t.once&&t.resolved?new Promise(function(){}):(t.resolved=!0,i?Promise.reject(n):n)}function ie(e){var t=e.req,n=e.res,i=e.isRejected,r=t.serverFirst;return Object(N.c)()&&n.from===D.a&&r?new Promise(function(){}):i?Promise.reject(n):n}function re(e){var t=e.req,n=e.res,i=t.noStore,r=t.key,o=t.token,a=void 0===o?Object(S.g)():o;return i||n.from===D.a||w({key:r,token:a,needSync:!1,data:n}),n}function oe(e){var t=e.req,n=e.res,i=e.isRejected,r=n.from,o=n._networkCode||n.code;return r===D.g&&o&&Object(_.default)("request_network_error",{url:t.url,network_code:n._networkCode,api_code:n.code}),i?Promise.reject(n):n}var ae=new U;function se(e){ae.setFetchConfig(e)}ae.interceptors.request.use(q),ae.interceptors.response.use(re,ce),ae.interceptors.response.use(ne,ne),ae.interceptors.response.use(ie,ie),ae.interceptors.response.use($,ce),ae.interceptors.response.use(void 0,oe),ae.interceptors.response.use(function(e){var t=e.res;return t&&null===t.data&&(t.data={}),t},ce);ae.fetch;function ce(e){return Promise.reject(e.res||e)}n.d(t,"c",function(){return se}),n.d(t,"a",function(){return j}),n.d(t,"b",function(){return w})},"+fJc":function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r,i,o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("cDf5"),u=n.n(l),d=n("4PSP"),h=n("0cva"),f=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":u()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};(i=r=r||{}).TEXT="text/plain",i.HTML="text/html";var p=function(){function i(e,t){var n=this;a()(this,i),this.docbody=e,this.handler=t,this.disposables=[],this.isComposing=!1,this.lastInputTime=null,this.disposables.push(this.addEventListener("input",function(e){return n.onInput(e)})),this.disposables.push(this.addEventListener("cut",function(e){return n.onCut(e)})),this.disposables.push(this.addEventListener("paste",function(e){return n.onPaste(e)})),this.disposables.push(this.addEventListener("compositionstart",this.onCompositionStart)),this.disposables.push(this.addEventListener("compositionupdate",this.onCompositionUpdate)),this.disposables.push(this.addEventListener("compositionend",this.onCompositionEnd)),this.disposables.push(this.addEventListener("keydown",this.logOnKeydown)),this.disposables.push(this.addEventListener("click",this.logOnClick))}return c()(i,[{key:"destroy",value:function(){this.disposables.forEach(function(e){return e()}),this.disposables=[],this.cancelCompositionTimeout(),this.isComposing=!1}},{key:"addEventListener",value:function(e,t){var n=this;return this.docbody.addEventListener(e,t,!0),function(){return n.docbody.removeEventListener(e,t,!0)}}},{key:"onInput",value:function(e){Object(h.b)("onInput","isComposing =",this.isComposing),Object(h.a)("onInput","isComposing =",this.isComposing),this.lastInputTime=Date.now(),this.isComposing||this.handler.handleCCInputEvent(e)}},{key:"onCut",value:function(e){var t=window.getSelection(),n=t&&t.isCollapsed;Object(h.b)("onCut","isCaret =",n),n||this.handler.handleCCInputEvent(e)}},{key:"onPaste",value:function(e){var t=this.isClipboardDataEmpty(e);Object(h.b)("onPaste","isClipboardDataEmpty =",t),t||this.handler.handleCCInputEvent(e)}},{key:"isClipboardDataEmpty",value:function(e){var t=e.clipboardData;if(null===t)return!0;if(Object(h.a)("isClipboardDataEmpty",t.types.join(", ")),t.types.some(function(e){return e!==r.TEXT&&e!==r.HTML}))return!1;var n=t.getData(r.TEXT);return!(0<n.length&&"\n"!==n)&&0===t.getData(r.HTML).length}},{key:"onCompositionStart",value:function(e){var t=null!==this.lastInputTime&&Date.now()-this.lastInputTime<500;Object(h.b)("onCompositionStart","isImmediatelyAfterInput =",t),Object(h.a)("onCompositionStart","isImmediatelyAfterInput =",t),this.isComposing=!0,this.lastInputTime=null,this.debounceCompositionTimeoutEnd(e),t&&this.handler.handleCompositionStartImmediatelyAfterInput()}},{key:"onCompositionUpdate",value:function(e){Object(h.b)("onCompositionUpdate"),Object(h.a)("onCompositionUpdate"),this.isComposing=!0,this.debounceCompositionTimeoutEnd(e)}},{key:"debounceCompositionTimeoutEnd",value:function(e){Object(h.b)("onCompositionTimeoutEnd"),Object(h.a)("onCompositionTimeoutEnd"),this.isComposing=!1,this.handler.handleCCInputEvent(e)}},{key:"cancelCompositionTimeout",value:function(){this.debounceCompositionTimeoutEnd.cancel()}},{key:"onCompositionEnd",value:function(e){Object(h.b)("onCompositionEnd"),Object(h.a)("onCompositionEnd"),this.cancelCompositionTimeout(),this.isComposing=!1,0<e.data.length&&this.handler.handleCCInputEvent(e)}},{key:"logOnKeydown",value:function(e){var t=String(e.code).startsWith("Key"),n=String(e.code).startsWith("Backspace"),i=String(e.code).startsWith("Process");Object(h.a)("keydown","isKey =",t,"isBackspace =",n,"isProcess =",i,"isTrusted =",e.isTrusted)}},{key:"logOnClick",value:function(e){Object(h.a)("click","detail =",e.detail)}}]),i}();f([Object(d.Bind)()],p.prototype,"onCompositionStart",null),f([Object(d.Bind)()],p.prototype,"onCompositionUpdate",null),f([Object(d.Debounce)(1e4)],p.prototype,"debounceCompositionTimeoutEnd",null),f([Object(d.Bind)()],p.prototype,"onCompositionEnd",null),f([Object(d.Bind)()],p.prototype,"logOnKeydown",null),f([Object(d.Bind)()],p.prototype,"logOnClick",null)},"+hmC":function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return l});var i,r,o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s);(r=i=i||{}).DOC="DOC",r.SHEET="SHEET";var l=function(){function t(e){a()(this,t),this.queue=[],this.queueMap=new Map,this.isFiring=!1,this.editor=e}return c()(t,[{key:"push",value:function(e){this.queue.push(e),this.fireNext()}},{key:"fireNext",value:function(){var e=this;if(!this.isFiring){var t=this.queue.shift();if(!this.queueMap.get(t))throw new Error("this.queueMap should contain queue type: "+t);this.isFiring=!0;var n=this.queueMap.get(t),i=this.editor.plugins.client.getRev();n.sendNextCS(i).finally(function(){e.isFiring=!1,0<e.queue.length&&e.fireNext()})}}},{key:"registerCSQueue",value:function(e){this.queueMap.set(e.type,e)}},{key:"unregisterCSQueue",value:function(e){this.queueMap.delete(e.type)}}]),t}()},"+l4x":function(e,t,n){},"+v7G":function(e,S,T){"use strict";(function(oe){var e=T("pVnL"),ae=T.n(e),t=T("lSNA"),se=T.n(t),n=T("o0o1"),r=T.n(n),i=T("yXPU"),o=T.n(i),a=T("lwsE"),c=T.n(a),s=T("W8MJ"),l=T.n(s),u=T("a1gu"),d=T.n(u),h=T("Nsbk"),f=T.n(h),p=T("PJYZ"),g=T.n(p),m=T("7W2i"),v=T.n(m),ce=T("7EGn"),le=T("NZ+B"),b=T("hbEN"),y=T("q1tI"),ue=T.n(y),E=T("i8i4"),O=(T("17x9"),T("TSYQ")),de=T.n(O),he=T("JXNz"),fe=T("dd8S"),pe=(T("QuVm"),T("iP/4")),ge=T("VI6H"),C=T("peh1"),me=T("cHHt"),ve=T("Sjdk"),k=T("2ACu"),be=378,I=function(e){function t(e){var s;return c()(this,t),(s=d()(this,f()(t).call(this,e))).observe=function(){s.props.observer&&!s.isObverse&&(s.isObverse=!0,s.props.observer.observe(Object(E.findDOMNode)(g()(s))))},s.unobserve=function(){s.props.observer&&s.props.observer.unobserve(Object(E.findDOMNode)(g()(s)))},s.handleCommentDraft=function(){var t=o()(r.a.mark(function e(t){var n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.replyId,i=t.html,e.prev=1,e.next=4,s.waitUntilTextareaLoaded();case 4:s.setPrevContentToTextarea({type:n?"update":"add",replyId:n,html:i,entities:null}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:case"end":return e.stop()}},e,null,[[1,7]])}));return function(e){return t.apply(this,arguments)}}(),s.setPrevContentToTextarea=function(e){var t=e.type,n=e.replyId,i=e.content,r=e.html,o=e.entities;"update"!==t?s.textareaRef&&(s.textareaRef.handleFillHtml(i,r,o),s.textareaRef.focus(),s.textareaRef.setCursorEnd()):s.commentListRef.setContentToUpdateTextarea(n,r)},s.hasText=function(){if(s.textareaRef&&s.textareaRef.isEmpty)return s.textareaRef&&!s.textareaRef.isEmpty()},s.setLastHaveUpdateTextarea=function(){var e,t,n=s.props.list;n.length<1?s.setState({lastHaveUpdateTextarea:!1}):(e=n[n.length-1].reply_id,t=s.updateTextareaRefs&&s.updateTextareaRefs.get(e),s.setState({lastHaveUpdateTextarea:!!t}))},s.hasUnFinishComment=function(){if(s.hasText())return!0;for(var e=0;e<=s.props.list.length-1;e++){var t=s.props.list[e],n=t.content,i=t.sending,r=t.error,o=t.reply_id;if(i||r)return!0;var a=s.updateTextareaRefs&&s.updateTextareaRefs.get(o);if(a)if(n!==a.getCurrentTextareaValue())return!0}return!1},s.getPanelRef=function(e){s.panelRef=e},s.getTextareaRef=function(e){s.textareaRef=e,s.handleTextareaLoaded();var t=s.props.textareaProps;t.ref&&t.ref(e)},s.getUpdateTextareaRef=function(e,t){t?s.updateTextareaRefs.set(e,t):s.updateTextareaRefs.delete(e)},s.getCurTextareaRef=function(){return s.textareaRef},s.getCurPanelNode=function(){return s.panelRef},s.handlePanelResize=Object(b.default)(function(){var e=s.props.onPanelResize;e&&e()},100),s.handleTextareaResize=function(){var e=s.props,t=e.textareaProps,n=e.onPanelResize;t.onResize&&t.onResize.apply(t,arguments),n&&n.apply(void 0,arguments),s.setLastHaveUpdateTextarea()},s.handleListResize=function(){var e=s.props,t=e.onPanelResize,n=e.listProps;n.onResize&&n.onResize.apply(n,arguments),t&&t.apply(void 0,arguments),s.setLastHaveUpdateTextarea()},s.setFocusIfNecessary=o()(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.props.readOnly)return e.abrupt("return");e.next=3;break;case 3:return e.next=5,s.waitUntilTextareaLoaded();case 5:t=g()(s),(n=t.textareaRef)&&!n.isFocus()&&(n.focus(),n.setCursorEnd());case 7:case"end":return e.stop()}},e)})),s.waitUntilTextareaLoaded=function(){return s.textareaRef?Promise.resolve():new Promise(function(e){s.handleTextareaLoadedQueue.push(function(){e()})})},s.handleTextareaLoaded=function(){s.handleTextareaLoadedQueue.forEach(function(e){return e()}),s.handleTextareaLoadedQueue=[]},s.triggerPanelClick=function(e){var t=s.props.onPanelClick;t&&t(e)},s.handlePanelMouseDown=function(e){s.props.enableFullCommentStyle||(s.mouseDownContext={pageX:e.pageX,pageY:e.pageY})},s.handlePanelClick=function(e){var t=e.pageX,n=e.pageY;0===t&&0===n?s.triggerPanelClick(e):s.mouseDownContext&&(5<Math.abs(s.mouseDownContext.pageX-t)||5<Math.abs(s.mouseDownContext.pageY-n)||(s.mouseDownContext=null,s.triggerPanelClick(e)))},s.handleItemEdit=function(e,t){var n=s.props.onItemEdit;n&&n(e)},s.handlePanelReply=function(){var n=o()(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.triggerPanelClick(t),e.next=3,s.setFocusIfNecessary();case 3:n&&(s.performUserToTextareaHead(n),Object(k.default)("orientation_comment_click",{from:"part_comment"}));case 4:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),s.mentionOptions=Object.assign({},e.mentionOptions||{},{type:"part_comment"}),s.updateTextareaRefs=new Map,s.getUpdateTextAreaProps=Object(C.createSelector)(function(e){return e.updateTextAreaProps},function(e){return e.textareaProps},function(e,t){var n="comment-panel",i=de()("".concat(n,"__textarea"),t.className),r=t.cancelText||oe("common.cancel");return Object.assign({},e,{confirmText:oe("common.confirm"),className:i,limit:t.limit,cancelText:r,onResize:s.handleTextareaResize,mentionOptions:s.mentionOptions,getUpdateTextareaRef:s.getUpdateTextareaRef})}),s.commentListRef=null,s.handleTextareaLoadedQueue=[],s.mouseDownContext=null,s.isObverse=!1,s.state={lastHaveUpdateTextarea:!1},s}return v()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.observe()}},{key:"componentDidUpdate",value:function(){this.observe()}},{key:"componentWillUnmount",value:function(){this.handlePanelResize.cancel(),this.handlePanelResize=null,this.getUpdateTextAreaProps=null,this.panelRef=null,this.textareaRef=null,this.updateTextareaRefs.clear(),this.unobserve()}},{key:"isFocusOnTextarea",value:function(){var e=this.textareaRef;return e&&e.isFocus()}},{key:"renderNoInPositionComment",value:function(){var e=this.props,t=e.finish,n=e.onPanelReopenComment,i="comment-panel";return ue.a.createElement("div",{className:"".concat(i,"__tip-wrapper")},ue.a.createElement("div",{className:"".concat(i,"__tip-container")},"[".concat(oe(t?"feed.comment_resolve":"feed.comment_deleted"),"]")),t?ue.a.createElement("button",{onClick:n},oe("etherpad.comment.reopen")):null)}},{key:"getReplyOffsets",value:function(e){return this.commentListRef?this.commentListRef.getReplyOffsets(e):!e&&this.panelRef?{listToContainerOffsetTop:this.panelRef.offsetTop,replyToListOffsetTop:0,replyOffsetHeight:0}:null}},{key:"startHighlightAnimation",value:function(e,t){this.commentListRef&&this.commentListRef.startHighlightAnimation(e,t)}},{key:"performUserToTextareaHead",value:function(e){this.textareaRef&&this.textareaRef.performUserToTextareaHead(e)}},{key:"render",value:function(){var e,t,n=this,i=this.props,r=i.reference,o=i.className,a=i.style,s=i.userName,c=i.myUserId,l=i.userAvatarUrl,u=i.list,d=i.expand,h=i.deleted,f=i.finish,p=i.readOnly,g=i.listProps,m=i.textareaProps,v=i.canSwitchToPrevComment,b=i.canSwitchToNextComment,y=i.onSwitchToPrevComment,E=i.onSwitchToNextComment,O=i.onPanelMouseEnter,C=i.onPanelMouseLeave,k=i.onTransitionEnd,I=i.quote,S=i.ellipsisAuthorClass,T=i.onCommentListCopy,_=i.enableReaction,w=i.translateContentCompare,j=i.transEnabled,M=i.commentId,L=i.haveContentAfter,R=i.embedObjShareEnable,N=i.enableFullCommentStyle,D=i.blockLoaded,x=i.commentImageEnabled,P=i.isCalcCommentPosition,B=this.state.lastHaveUpdateTextarea,U="comment-panel",z=u&&0<u.length,H=this.hasText(),F=de()("".concat(U,"__arrow"),se()({},"".concat(U,"__arrow--expand"),d)),V=Object(ce.default)(u,"[0].error"),W=Object(ce.default)(u,"[0].sending"),K=!(V||Object(le.a)(W)&&!1!==W),Z=!p&&d&&K,q=K,Y=de()("".concat(U,"__list"),g.className),J=de()("".concat(U),(e={},se()(e,"".concat(U,"_safari"),pe.a.isSafari),se()(e,"".concat(U,"_firefox"),pe.a.isFF),se()(e,"".concat(U,"--read"),p),se()(e,"".concat(U,"--expand"),d),se()(e,"".concat(U,"--new"),!z),se()(e,"".concat(U,"--has-text"),H),se()(e,"".concat(U,"--unresolvable"),!d),se()(e,"".concat(U,"--unreply"),h||f),se()(e,"".concat(U,"--no-bottom"),B),e),o),Q=de()("".concat(U,"__textarea"),se()({},"".concat(U,"__textarea--expand"),H||d),m.className),X="",$=m.cancelText||oe("common.cancel"),X=m.confirmText||oe(z?"etherpad.reply":"comment.post"),ee=this.getUpdateTextAreaProps(this.props),te=!(void 0===I||f||h&&D),ne=H||d,ie=!0===B||!1===L||N,re=oe(z?"comment.placeholder.reply_comment":"comment.placeholder.add_comment");return m.placeholder&&(re=m.placeholder),z||(t=Object(me.a)())&&(re=t),ue.a.createElement("div",{className:J,style:a,ref:this.getPanelRef,onMouseDown:this.handlePanelMouseDown,onClick:this.handlePanelClick,onMouseEnter:O,onMouseLeave:C,onTransitionEnd:k,"content-after":ie?"":"".concat(oe("etherpad.reply"),"...")},te||N?null:ue.a.createElement("div",{className:F}),te&&d?ue.a.createElement("div",{className:"".concat(U,"__quote-hat")}):null,te?ue.a.createElement("div",{className:"".concat(U,"__quote-wrapper"),onCopy:T,onCut:T},ue.a.createElement("div",{className:"".concat(U,"__quote-container")},I)):null,h&&D||f?this.renderNoInPositionComment():null,z?ue.a.createElement(he.a,ae()({ref:function(e){return n.commentListRef=e},readonly:p,enableReaction:_},g,{reference:r,myUserId:c,commentId:M,canSwitchToPrevComment:v,canSwitchToNextComment:b,onSwitchToPrevComment:y,onSwitchToNextComment:E,className:Y,resolvable:Z,onResize:this.handleListResize,list:u,showContentLimit:be,ellipsisAuthorClass:S,updateTextAreaProps:ee,panelExpand:d,source:"part_comment",onCopy:T,onCut:T,translateContentCompare:w,transEnabled:j,embedObjShareEnable:R,enableFullCommentStyle:this.props.enableFullCommentStyle,onReply:this.handlePanelReply,onEdit:this.handleItemEdit,commentImageEnabled:x,isCalcCommentPosition:P})):ue.a.createElement("div",{className:"".concat(U,"__meta")},ue.a.createElement(fe.a,{reference:r,token:c,userName:Object(ge.o)(c)||s,avatar:l,ellipsisAuthorClass:S})),!p&&ne&&ue.a.createElement(ve.a,ae()({},m,{getRef:this.getTextareaRef,className:Q,limit:m.limit,confirmText:X,cancelText:$,sendable:q,onResize:this.handleTextareaResize,mentionOptions:this.mentionOptions,placeholder:re,commentId:M,commentImageEnabled:x})))}}]),t}(ue.a.PureComponent);S.a=I}).call(this,T("2vAP"))},"/2EM":function(e,t,n){"use strict";var i,r,o,a,s=n("J4zp"),E=n.n(s),c=n("iP/4"),u=n("pzL3"),l=n("m9Pg"),d=n("o0o1"),h=n.n(d),f=n("yXPU"),p=n.n(f),g=n("lwsE"),m=n.n(g),v=n("Z/PY"),b=n("XRg5"),y=n("15MJ"),O=n("RIqP"),C=n.n(O),k=n("m3ds"),I=n("lSNA"),S=n.n(I),T=n("LghI"),_=n("W8MJ"),w=n.n(_),j=n("Cf53"),M=n("VklI"),L=n("zfY2"),R=new(function(){function e(){var t=this;m()(this,e),this.showOpendocMask=function(e){t.isOpendoc&&(Object(L.registerOpendocApi)(M.a.closeImageViewer,function(){e&&e.hidden(),Object(L.unregisterOpendocApi)(M.a.closeImageViewer)}),Object(M.f)(M.a.closeImageViewer,"rgba(0, 0, 0, 0.85)"))},this.isOuterViewer=function(){var e=Object(j.b)();return e&&"outer"===e.viewer},this.isNeedBlob=function(){var e=Object(j.b)();return e&&e.needBlob},this.previewInOpendoc=function(e){Object(L.sendOpendocEvent)(M.c.IMAGE_VIEW,e)},this.hideOpendocMask=function(){t.isOpendoc&&Object(M.d)()}}return w()(e,[{key:"isOpendoc",get:function(){return c.a.isOpendoc}}]),e}()),N=n("Mp37");(a=o=o||{}).Web="web",a.Mobile="mobile",a.Lark="lark",a.OpenDoc="opendoc";var D=(i={},S()(i,o.Web,b.imageViewerCreator.create),S()(i,o.Lark,T.e.openLarkImageViewer),S()(i,o.OpenDoc,R.previewInOpendoc),i),x=(r={},S()(r,N.UX_ACTION_TYPE.NEXT,1),S()(r,N.UX_ACTION_TYPE.PREV,-1),S()(r,N.UX_ACTION_TYPE.HIDE,0),r),P=n("Tqb2"),B=n("H6oK"),U=n("j1lG"),z=function(){return k.a.isMobile?o.Mobile:!k.a.isLark||k.a.isInVC||k.a.isLKP?k.a.isOpendoc?o.OpenDoc:o.Web:o.Lark};function H(e){return e.getEntities(function(e,t){return!![U.K,U.M].includes(e)||"dataMetaBlockProps"===e&&(JSON.parse(t)||{}).blockType===B.BlockType.DIAGRAM_BLOCK})}function F(e,t){var n=e.attributes.dataMetaBlockProps||"",i=Object(v.C)(n)||{},r=t.plugins.blockPlugin.getBlockById(i.blockId);if(!r||!r.getSvg)return[];try{var o=r.getSvg();if(!o)return[];var a=(a=(new XMLSerializer).serializeToString(o)).replace(/\x08/g,""),s=new Blob([a],{type:"image/svg+xml"});return i.originSrc=URL.createObjectURL(s),i.uuid=i.blockId,[i]}catch(e){return console.log("fail to open viewer for  diagram",e),[]}}function V(i){var e=H(i),r=[];return e.forEach(function(e){var t=Object(P.s)(e),n=F(e,i);r.push.apply(r,C()(t)),r.push.apply(r,C()(n))}),r}var W=function(t,e){var n=(K()?Object(P.u):V)(e),i=n.findIndex(function(e){return e.uuid===t});return{allImageAttributes:n,currentImageIndex:i}};function K(){if(k.a.isOpendoc){var e=Object(j.b)();if(e&&"outer"===e.viewer)return!0}else if(k.a.isLark&&!k.a.isLKP&&!k.a.isInVC)return!0;return!1}var Z,q,Y=n("1dfU"),J=n("lQZd"),Q=n("bu34"),X=n("wAsq"),$=n("SyrE"),ee=n("Trbk"),te="DocImage";(q=Z=Z||{}).OPEN="OPEN",q.SWITCH="SWITCH",q.CLOSE="CLOSE";var ne={IMAGE_SYNC:"ImageSync",IMAGE_TRANSFORM_SYNC:"ImageTransformSync"},ie=function(){function t(e){var f=this;m()(this,t),this.previewer=e,this.imageTransformRetryCount=0,this.destroy=function(){f.switchEvent("off")},this.switchEvent=function(e){$.g[e]("".concat(ee.g,":").concat(te),f.replayFollowActionHandler),"on"===e&&f.emitFollowAction(Z.CLOSE,null)},this.reportForFollow=function(e){var t=e.currentUuid;f.emitFollowAction(t?Z.SWITCH:Z.CLOSE,t)},this.emitFollowAction=function(e,t){e===Z.OPEN?Object(X.b)("follower",{space:t||""}):e===Z.CLOSE&&Object(X.b)("follower",{space:Object(Y.a)(Object(J.g)())}),$.g.emit(ee.a,{module:te,actionType:ne.IMAGE_SYNC,data:{type:e,uuid:t}})},this.emitTransformFollowAction=function(e){$.g.emit(ee.a,{module:te,actionType:ne.IMAGE_TRANSFORM_SYNC,data:e})},this.replayFollowActionHandler=function(){var t=p()(h.a.mark(function e(t){var n,i,r,o,a,s,c;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.actionType,i=t.data,r=t.uuid,n===ne.IMAGE_SYNC)return a=i.type,s=i.uuid,o={},S()(o,Z.OPEN,function(){return f.previewer.open(s)}),S()(o,Z.SWITCH,function(){return f.previewer.switchImage(s)}),S()(o,Z.CLOSE,function(){return f.previewer.hidden()}),c=o,e.next=6,c[a];e.next=12;break;case 6:if(e.t0=e.sent,!e.t0){e.next=9;break}c[a]();case 9:f.statImageSync(r,i),e.next=16;break;case 12:if(n===ne.IMAGE_TRANSFORM_SYNC)return e.next=15,f.transformImage(i);e.next=16;break;case 15:f.statImageTransformSync(r,i);case 16:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.resetTransformImage=function(){window.clearInterval(f.imageTransformTimer),f.imageTransformTimer=void 0,f.imageTransformRetryCount=0},this.transformImage=function(d){var h=f.previewer;d&&h&&(f.resetTransformImage(),f.imageTransformTimer=window.setInterval(function(){var e,t,n,i,r,o,a,s,c,l,u;10<f.imageTransformRetryCount?f.resetTransformImage():(f.imageTransformRetryCount+=1,e=h.isPcImageViewerReady,t=(0,h.getViewerInstance)(),e&&t&&(i=(n=d.imageData).left,r=n.top,a=(o=d.containerData).width,s=o.height,l=(c=t.containerData).width,u=c.height,d.imageData.left=i+(l-a)/2,d.imageData.top=r+(u-s)/2,t.imageData=d.imageData,f.resetTransformImage(),t.renderImage()))},300))},this.switchEvent("on")}return w()(t,[{key:"statImageSync",value:function(e,t){var n=t.type,i=t.uuid,r=this.previewer.getViewerInstance();if(n===Z.CLOSE)r?Object(Q.a)(e,"[IMAGE] viewer has not closed"):Object(Q.c)(e);else{var o=this.previewer.getEditor(),a=W(i,o),s=a.allImageAttributes,c=a.currentImageIndex;if(!r)return Object(Q.a)(e,"[IMAGE] no viewer");if(c<0)return Object(Q.a)(e,"[IMAGE] no image");var l=r.image,u=r.images,d=s[c].originSrc,h=u[c],f=h&&h.getAttribute("data-src"),p=h&&h.getAttribute("data-loaded-src"),g=l&&l.src||f;d===g||/blob/.test(g)&&g===p&&d===f?Object(Q.c)(e):Object(Q.a)(e,"[IMAGE] src is not same")}}},{key:"statImageTransformSync",value:function(e,t){if(!t.uuid)return Object(Q.c)(e);var n=this.previewer.getViewerInstance();if(!n)return Object(Q.a)(e,"[IMAGE] no viewer");var i=n.image,r=n.imageData,o=r.top,a=r.left,s=r.height,c=r.width,l=window.getComputedStyle(i),u=l.marginTop,d=l.marginLeft,h=l.height,f=l.width,p=function(e,t){return Math.floor(e)===Math.floor(t)};p(o,parseFloat(u))&&p(a,parseFloat(d))&&p(s,parseFloat(h))&&p(c,parseFloat(f))?Object(Q.c)(e):Object(Q.a)(e,"[IMAGE] image data and dom style are not the same")}}]),t}();ie.followType=Z;var re=ie,oe=function e(t){var s=this,n=t.editor,i=t.imageStateInstance;m()(this,e),this.viewerInstance=null,this.docOpenEnv=z(),this.isInnerViewerOpen=!1,this.isOuterViewerOpen=!1,this.isPcImageViewerReady=!1,this.getViewerInstance=function(){return s.viewerInstance},this.getEditor=function(){return s.editor},this.open=function(){var t=p()(h.a.mark(function e(t){var n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.editor){e.next=2;break}return e.abrupt("return");case 2:if(n=W(t,s.editor)){e.next=5;break}return e.abrupt("return");case 5:if(s.currentUuid=t,s.docOpenEnv!==o.Web)return e.next=9,s.openOuterViewer(n);e.next=10;break;case 9:s.isOuterViewerOpen=e.sent;case 10:if(s.isOuterViewerOpen)return e.abrupt("return");e.next=12;break;case 12:s.isInnerViewerOpen&&s.viewerInstance?s.switchImage(t,n):(s.isInnerViewerOpen=s.openInnerViewer(n),s.followController&&s.followController.emitFollowAction(re.followType.OPEN,s.currentUuid));case 13:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.switchImage=function(e,t){if(s.editor){var n=t||W(e,s.editor);if(n){if(!s.viewerInstance)return s.openInnerViewer(n);var i=n.currentImageIndex;return s.viewerInstance.view(i)}}},this.hidden=function(){s.viewerInstance&&s.viewerInstance.hidden()},this.destroy=function(){s.hidden(),s.followController&&s.followController.destroy(),s.followController=null,s.editor=null,s.viewerInstance=null,s.isInnerViewerOpen=!1,s.isOuterViewerOpen=!1},this.followController=new re(this),this.openInnerViewer=function(e){var t=s.getInnerViewerParams(e);return s.viewerInstance=D[o.Web](t),s.viewerInstance&&s.viewerInstance.show(),!0},this.openOuterViewer=function(){var t=p()(h.a.mark(function e(t){var n,i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=s.docOpenEnv,e.next=e.t0===o.OpenDoc?3:e.t0===o.Lark?13:19;break;case 3:if(R.isOuterViewer())return e.next=6,s.getOuterViewerParams(t,R.isNeedBlob());e.next=11;break;case 6:return n=e.sent,D[o.OpenDoc](n),e.abrupt("return",!0);case 11:return s.viewerInstance&&R.showOpendocMask(s.viewerInstance),e.abrupt("return",!1);case 13:return e.next=15,s.getOuterViewerParams(t);case 15:return i=e.sent,e.next=18,D[o.Lark](i);case 18:return e.abrupt("return",e.sent);case 19:return e.abrupt("return",!1);case 20:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.genImageListWrapper=function(e){var o=document.createElement("div");return e.forEach(function(e){var t=document.createElement("img"),n=e.originSrc,i=e.uuid,r=s.imageStateInstance.getImageState().loadedSrcMap.get(i);t.dataset.src=n||"",t.dataset.uuid=i,t.dataset.loadedSrc=r||"",o.appendChild(t)}),o},this.getInnerViewerParams=function(e){var t=e.allImageAttributes,n=e.currentImageIndex,i=function(e){var t=e.getAttribute("data-loaded-src"),n=e.getAttribute("data-src");return t||n||e.src||y.r},r=function(e){var t=e.getAttribute("data-src");if(!t)return null;var n=Object(v.p)(t)&&/\/file\/f\//.test(t),i=Object(v.s)(t);return n?t.replace(/\/$/,"~noop"):i?t:null},o=function(){var e,t,n;s.viewerInstance&&(t=(e=s.viewerInstance).imageData,n=e.containerData,s.isPcImageViewerReady=!0,s.followController&&s.followController.emitTransformFollowAction({imageData:t,containerData:n,uuid:s.currentUuid}))};return{elementsWrapper:s.genImageListWrapper(t),options:{initialViewIndex:n<0?0:n,loading:!0,hidden:function(){s.isInnerViewerOpen=!1,s.isPcImageViewerReady=!1,s.viewerInstance&&s.viewerInstance.destroy(),s.followController&&s.followController.resetTransformImage(),s.viewerInstance=null},report:function(e){e.evtType;var t=e.actionType;if(t===N.UX_ACTION_TYPE.HIDE&&R.hideOpendocMask(),s.currentUuid&&s.editor){var n=W(s.currentUuid,s.editor),i=x[t];if(void 0!==i&&n){var r=n.allImageAttributes,o=n.currentImageIndex;if(i){var a=r[o+x[t]];if(!a)return;s.currentUuid=a.uuid}else s.currentUuid=null;s.followController&&s.followController.reportForFollow({currentUuid:s.currentUuid})}}},errorPlaceholder:y.r,url:i,highResolutionUrl:r,onImageDataUpdate:o},evtSource:b.MODULE_TYPE.DOC_BODY}},this.getImages=function(){var t=p()(h.a.mark(function e(t){var o,n,i=arguments;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=1<i.length&&void 0!==i[1]&&i[1],n=t.map(function(){var t=p()(h.a.mark(function e(t){var n,i,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.uuid,i=t.originSrc,r={key:n,url:i||""},e.t0=o&&i,e.t0)return e.next=6,Object(v.h)(i);e.next=7;break;case 6:r.blob=e.sent;case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),e.next=4,Promise.all(n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.getOuterViewerParams=function(){var t=p()(h.a.mark(function e(t){var n,i,r,o=arguments;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.allImageAttributes,i=t.currentImageIndex,r=1<o.length&&void 0!==o[1]&&o[1],e.next=4,s.getImages(n,r);case 4:return e.t0=e.sent,e.t1=i,e.abrupt("return",{images:e.t0,index:e.t1});case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.docOpenEnv=z(),this.editor=n,this.imageStateInstance=i},ae=n("cDf5"),se=n.n(ae),ce=n("a1gu"),le=n.n(ce),ue=n("Nsbk"),de=n.n(ue),he=n("7W2i"),fe=n.n(he),pe=n("toa8");function ge(e){var o=e.data,a=e.key,s=e.algorithm,c=e.iv;return new Promise(function(e,t){var n,i,r;ve()?(n=me(a),i=new Uint8Array(c),r=new Uint8Array(o),crypto.subtle.importKey("raw",n,s,!1,["decrypt"]).then(function(e){return crypto.subtle.decrypt({name:s,iv:i},e,r)}).then(e).catch(t)):t(new Error("[image plugin] can't decrypt for not support web crypto."))})}function me(){for(var e=atob(0<arguments.length&&void 0!==arguments[0]?arguments[0]:""),t=e.length,n=new Uint8Array(t),i=0;i<t;i++)n[i]=e.charCodeAt(i);return n}function ve(){return crypto&&crypto.subtle}function be(e){for(var t=e.slice(0,4),t=new Uint8Array(t),n=[],i=0;i<t.byteLength;i++)n.push(t[i].toString(16));return ye(n.join("").toUpperCase())}function ye(e){switch(e){case"89504E47":return"image/png";case"47494638":return"image/gif";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":case"FFD8FFE2":case"FFD8FFE3":case"FFD8FFE8":return"image/jpeg";case"52494646":return"image/webp";default:return""}}var Ee=function(){function n(e,t){m()(this,n),this.token=e.token,this.isHD=e.isHD,this.logger=t}return w()(n,[{key:"fetchImageResource",value:function(){var t=this;return this.fetchCdn().then(function(e){return{src:t.convertToBlobUrl(e),status:t.logger.fetchStatus}}).catch(function(e){return console.error("[image plugin] fetch failed",e),{src:t.generateOriginSrc(),status:t.logger.fetchStatus}})}},{key:"convertToBlobUrl",value:function(e){var t=new DataView(e),n=new Blob([t],{type:be(e)});return URL.createObjectURL(n)}},{key:"destroy",value:function(){this.logger.destroy()}}]),n}(),Oe=n("VIFs"),Ce=n("FsMz"),ke=function(e){function t(){var e;return m()(this,t),(e=le()(this,de()(t).apply(this,arguments))).cdnUrl=null,e.key=null,e}function n(e){return i.apply(this,arguments)}var i,r,o;function a(){return r.apply(this,arguments)}function s(){return o.apply(this,arguments)}return fe()(t,e),w()(t,[{key:"generateOriginSrc",value:function(){var e="".concat(Object(Oe.prependAPI)("/api/file/f/")).concat(this.token,"/"),t="".concat(Object(Oe.prependAPI)("/api/file/f/")).concat(this.token,"~noop");return this.isHD?t:e}},{key:"fetchCdn",value:(o=p()(h.a.mark(function e(){var t,n,i,r,o,a,s,c,l;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.logFetchCdnConfigStart(),e.next=3,this.fetchCdnConfig();case 3:return t=e.sent,this.logger.logFetchCdnConfigEnd(!!t),n=this.parseCdnConfig(t),i=n.cdnUrl,r=n.key,this.logger.logFetchCdnStart(),e.next=9,this.fetchCdnResource(i);case 9:return o=e.sent,this.logger.logFetchCdnEnd(o),a=this.splitDecryptData(o),s=a.iv,c=a.decryptData,this.logger.logDecryptStart(),e.next=15,ge({data:c,key:r,iv:s,algorithm:Ce.a});case 15:return l=e.sent,this.logger.logDecryptEnd(!!l),e.abrupt("return",l);case 18:case"end":return e.stop()}},e,this)})),s)},{key:"parseCdnConfig",value:function(e){var t=e.cdn_url;return{cdnUrl:e.thumbnail_cdn_url||t,key:e.decrypt_key}}},{key:"splitDecryptData",value:function(e){return{iv:e.slice(0,16),decryptData:e.slice(16)}}},{key:"fetchCdnConfig",value:(r=p()(h.a.mark(function e(){var t,n,i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(Oe.prependAPI)("/api/file/get"),n={key:this.token},e.next=4,pe.d.get(t,{params:n});case 4:return i=e.sent,e.abrupt("return",i.data);case 6:case"end":return e.stop()}},e,this)})),a)},{key:"fetchCdnResource",value:(i=p()(h.a.mark(function e(t){var n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.d.get(t,{ignoreInterceptors:!0,responseType:"arraybuffer",withCredentials:!1,timeout:Ce.f});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)})),n)}]),t}(Ee),Ie=n("Pozx");function Se(e){var i=e.duration,c=new Set,r=null;function o(e){c.add(e)}function l(e){return t.apply(this,arguments)}function t(){return(t=p()(h.a.mark(function e(t){var n,i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.forEach(function(e){n.push({file_token:e.token,platform:"pc",type:e.isHD?"":Ce.c})}),e.next=4,Te(n);case 4:return i=e.sent,t.forEach(function(t){var e=i.find(function(e){return e.file_token===t.token});Object.assign(t,{cdnInfo:e})}),e.abrupt("return",t);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function u(){c.clear(),r=null}return function(e,t,n){var s=n.value;"function"==typeof s&&(n.value=function(e){var a=this;if(!Object(Ie.c)(e.category))return s.call(a,e);o(e),r=r||window.setTimeout(p()(h.a.mark(function e(){var t,n,i,r,o;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Set(c),u(),n=performance.now(),e.prev=3,e.next=6,l(t);case 6:i=e.sent,r=performance.now()-n,o={request_cdn_url_necessary:!0,request_cdn_url_fail:!i,request_cdn_url_time_cost:r.toString()},i.forEach(function(e){return s.call(a,e,o)}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),console.error("[image fetcher] batch fetch drive cdn config failed",e.t0),t.forEach(function(e){return s.call(a,e)});case 16:return e.abrupt("return");case 17:case"end":return e.stop()}},e,null,[[3,12]])})),i)})}}function Te(e){return _e.apply(this,arguments)}function _e(){return(_e=p()(h.a.mark(function e(t){var n,i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(Oe.prependAPI)("/api/box/file/cdn_url/"),e.next=3,pe.d.post(n,t);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var we=n("EAIz"),je=n("TJjI"),Me=function(e){function i(e,t){var n;return m()(this,i),(n=le()(this,de()(i).call(this,e,t))).cdnInfo=null,e.cdnInfo&&(n.cdnInfo=e.cdnInfo),n}function t(e,t){return n.apply(this,arguments)}var n,r,o;function a(){return r.apply(this,arguments)}function s(){return o.apply(this,arguments)}return fe()(i,e),w()(i,[{key:"generateOriginSrc",value:function(){var e=this.isHD?null:{policy:je.a.EQUAL};return Object(P.k)(this.token,e)}},{key:"fetchCdn",value:(o=p()(h.a.mark(function e(){var t,n,i,r,o,a,s,c;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.cdnInfo){e.next=5;break}return e.next=4,this.fetchSingleCdnConfig();case 4:t=e.sent;case 5:return n=this.parseCdnConfig(t),i=n.needDecrypt,r=n.cdnUrl,o=n.key,a=n.iv,this.logger.logFetchCdnStart(),e.next=9,this.fetchCdnResource(r,i);case 9:if(s=e.sent,this.logger.logFetchCdnEnd(s),i)return this.logger.logDecryptStart(),e.next=15,ge({data:s,key:o,iv:a,algorithm:Ce.b});e.next=20;break;case 15:return c=e.sent,this.logger.logDecryptEnd(!!c),e.abrupt("return",c);case 20:this.logger.logNoNeedDecrypt();case 21:return e.abrupt("return",s);case 22:case"end":return e.stop()}},e,this)})),s)},{key:"fetchSingleCdnConfig",value:(r=p()(h.a.mark(function e(){var t,n,i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={file_token:this.token,platform:"pc",type:this.isHD?"":Ce.c},this.logger.logFetchCdnConfigStart(),e.next=4,Te([t]);case 4:return n=e.sent,i=n&&n[0],this.logger.logFetchCdnConfigEnd(!!i),e.abrupt("return",i);case 8:case"end":return e.stop()}},e,this)})),a)},{key:"parseCdnConfig",value:function(e){var t=e.url,n=e.cipher_type,i=e.secret,r=e.nonce;return{needDecrypt:n!==Ce.d,cdnUrl:t,key:i,iv:me(r)}}},{key:"fetchCdnResource",value:(n=p()(h.a.mark(function e(t,n){var i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=pe.d,e.t1=t,e.t2=!n,e.t3=Ce.f,e.t4=Object,e.t5={},we.e)return e.next=9,Object(we.c)();e.next=12;break;case 9:e.t6=e.sent,e.next=13;break;case 12:e.t6={};case 13:return e.t7=e.t6,e.t8=e.t4.assign.call(e.t4,e.t5,e.t7),e.t9={ignoreInterceptors:!0,responseType:"arraybuffer",withCredentials:e.t2,timeout:e.t3,headers:e.t8},e.next=18,e.t0.get.call(e.t0,e.t1,e.t9);case 18:return i=e.sent,e.abrupt("return",i.data);case 20:case"end":return e.stop()}},e)})),t)}]),i}(Ee),Ae=n("SfZW"),Le=function(){function t(e){m()(this,t),this.fetchStatus={},this.timer=new Ae.a,this.uuid=e}return w()(t,[{key:"logFetchCdnConfigStart",value:function(){this.timer.start("fetchCdnConfig_".concat(this.uuid)),this.fetchStatus.request_cdn_url_necessary=!0}},{key:"logFetchCdnConfigEnd",value:function(e){this.fetchStatus.request_cdn_url_fail=!e,this.fetchStatus.request_cdn_url_time_cost=this.timer.end("fetchCdnConfig_".concat(this.uuid))}},{key:"logFetchCdnStart",value:function(){this.timer.start("fetchCdn_".concat(this.uuid)),this.fetchStatus.request_cdn_necessary=!0}},{key:"logFetchCdnEnd",value:function(e){var t=!!e;this.fetchStatus.request_cdn_fail=!t,this.fetchStatus.request_cdn_time_cost=this.timer.end("fetchCdn_".concat(this.uuid)),this.fetchStatus.cdn_size=e.byteLength}},{key:"logDecryptStart",value:function(){this.timer.start("decrypt_".concat(this.uuid)),this.fetchStatus.decrypt_necessary=!0}},{key:"logNoNeedDecrypt",value:function(){this.fetchStatus.decrypt_necessary=!1}},{key:"logDecryptEnd",value:function(e){this.fetchStatus.decrypt_fail=!e,this.fetchStatus.decrypt_time_cost=this.timer.end("decrypt_".concat(this.uuid))}},{key:"destroy",value:function(){this.fetchStatus={},this.timer.clear()}}]),t}(),Re=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":se()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Ne=function(){function t(e){m()(this,t),this.config=null,this.config=e}function e(e,t){return n.apply(this,arguments)}var n;return w()(t,[{key:"fetch",value:(n=p()(h.a.mark(function e(t,n){var i,r,o,a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getFetcherInstance(t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,i.fetchImageResource();case 5:r=e.sent,o=r.src,a=r.status,this.config&&this.config.sendFinishedMsg&&this.config.sendFinishedMsg(t,{src:o,fetchCdnLogStatus:Object.assign({},a,{},n||{})}),i.destroy();case 10:case"end":return e.stop()}},e,this)})),e)},{key:"sendImage",value:function(e,t){this.fetch(e)}},{key:"getFetcherInstance",value:function(e){switch(e.category){case U.D.Doc:return new ke(e,this.getLogger(e.uuid));case U.D.Drive:return new Me(e,this.getLogger(e.uuid));default:return null}}},{key:"getLogger",value:function(e){return new Le(e)}}]),t}();Re([Se({duration:10})],Ne.prototype,"fetch",null);var De,xe,Pe=function(){function e(){m()(this,e),this.statusMap=new Map,this.callbackListMap=new Map,this.scheduler=new Ne({sendFinishedMsg:this.onFetchFinished.bind(this)})}return w()(e,[{key:"fetch",value:function(e,t,n){var i=this.getCachedResult(e);if(i)return n(i);var r=this.getMapKey(e),o=this.statusMap.get(r);o&&o.isFetching||(this.scheduler.sendImage(e,t),this.statusMap.set(r,{isFetching:!0,success:!1})),this.addCallback(e,n)}},{key:"addCallback",value:function(e,t){var n=this.getMapKey(e),i=this.callbackListMap.get(n)||[];i.push(t),this.callbackListMap.set(n,i)}},{key:"onFetchFinished",value:function(e,t){var n=this.getMapKey(e),i=this.callbackListMap.get(n);i&&0<i.length&&i.forEach(function(e){return e(t)}),this.callbackListMap.set(n,[]),this.statusMap.set(n,{isFetching:!1,success:!!t.src,result:t})}},{key:"getCachedResult",value:function(e){var t=this.getMapKey(e),n=this.statusMap.get(t);return n&&n.success?n.result:null}},{key:"getMapKey",value:function(e){return"".concat(e.token,"-").concat(e.category,"-").concat(e.isHD)}},{key:"destroy",value:function(){this.statusMap.clear(),this.callbackListMap.clear()}}]),e}(),Be=n("1fXG"),Ue=n("ifGE"),ze={draggingImg:null},He=function(){function t(e){var s=this;m()(this,t),this.editor=e,this.isDragging=!1,this.scrollTopDelta=Object(Ue.f)(),this.scrollBottomDelta=20,this.scrollIntervalId=null,this.getSnapshot=function(){var n=p()(h.a.mark(function e(t,n){var i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(i=new Image).src=t.src,Object.assign(i.style,{maxWidth:"64px",maxHeight:"64px"}),e.abrupt("return",{node:i});case 4:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),this.onDragStart=function(){var i=p()(h.a.mark(function e(t,n,i){var r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(Be.c)(t,".".concat(U.s)),i.draggingImg=r,ze.draggingImg=r){e.next=5;break}return e.abrupt("return",!1);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}},e)}));return function(e,t,n){return i.apply(this,arguments)}}(),this.onDragMove=function(e,t,n){var i=t.y,r=window.innerHeight-i<s.scrollBottomDelta,o=i<s.scrollTopDelta,a=[6,10];(o||r)&&null==s.scrollIntervalId?s.scrollIntervalId=window.setInterval(function(){var e=a[0]*(o?-1:1);s.editor.scrollBy({top:e})},a[1]):o||r||!s.scrollIntervalId||(window.clearInterval(s.scrollIntervalId),s.scrollIntervalId=null),n.draggingImg&&!s.isDragging&&(s.isDragging=!0,Object.assign(n.draggingImg.style,{opacity:.2}))},this.onDrop=function(e,t,n){var i=n.draggingImg;return s.isDragging=!1,s.scrollIntervalId&&(window.clearInterval(s.scrollIntervalId),s.scrollIntervalId=null),i&&Object.assign(i.style,{opacity:1}),{draggingImg:i}},this.updateDragStatus=function(e){s.editor.call("draggable:dragstatuschange",{isDragging:e})},this.dragManager=new Be.a,this.dragManager.register(".".concat(U.s),{getSnapshot:this.getSnapshot,onDragStart:this.onDragStart,onDragMove:this.onDragMove,onDragStatusChange:this.updateDragStatus,onDrop:this.onDrop,onDropSuccess:function(){s.allowImageAutoFixSelection()},onDropFailed:function(){s.allowImageAutoFixSelection()}})}return w()(t,[{key:"allowImageAutoFixSelection",value:function(){this.editor.getPlugin(U.K).setPreventAutoFixSelection(!1)}},{key:"connect",value:function(e){this.dragManager.connect(e)}},{key:"destroy",value:function(){this.dragManager.destroy()}}]),t}(),Fe=n("UXvI"),Ve=n("Ngi8"),We=n("vE74"),Ke=n("4D8z");(xe=De=De||{}).LINE="LINE",xe.IMAGE="IMAGE";var Ge={transform:"translateX(30px)"},Ze={transform:"translateX(-30px)"},qe={transform:""},Ye=function(){function t(e){var n=this;m()(this,t),this.editor=e,this.bodyHighlightEl=null,this.lastTransformedElements=[],this.tableHighlightEl=null,this.outerBody=null,this.getHighlightEl=function(e){return e?n.tableHighlightEl:n.bodyHighlightEl},this.removeTypedHighlight=function(e){var t="".concat(e,"HighlightEl");n[t]&&n[t].remove(),n[t]=null},this.removeTransform=function(){n.lastTransformedElements.forEach(function(e){return Object.assign(e.style,qe)}),n.lastTransformedElements.length=0},this.outerBody=document.querySelector("#outerdocbody")}return w()(t,[{key:"checkIsInTable",value:function(e){if(!e)return null;for(var t=e;t!==this.outerBody&&null!==t;){var n=t.parentElement;if(n instanceof HTMLElement&&n.classList.contains("tb-scrollable-children"))return n;t=n}return null}},{key:"setHighlight",value:function(e,t){var n,i,r;e?(n=e.element,i=e.type,(r=this.checkIsInTable(n))?(this.removeTypedHighlight("body"),this.tableHighlightEl||(this.tableHighlightEl=this.initHighlightEl(r))):(this.removeTypedHighlight("table"),this.bodyHighlightEl||(this.bodyHighlightEl=this.initHighlightEl(this.outerBody))),i===De.LINE?this.setLineHighlight(e,t,r):this.setGalleryHighlight(e,r)):this.removeAllHighlightEl()}},{key:"setLineHighlight",value:function(e,t,n){this.removeTransform();var i,r,o,a,s,c,l=this.getHighlightEl(!!n);l&&(i=e.element,r=e.isLineTop,o=i.clientWidth,a=i.clientHeight,s=i.offsetTop,c=0,n&&(s=Object(We.d)(i,n)||0,c=Object(We.d)(i,n,"Left")||0),Object.assign(l.style,{top:"".concat(s+(r?0:a),"px"),left:n?"".concat(c,"px"):"20px",width:n?"".concat(o,"px"):"calc(100% - ".concat(Ke.l+Ke.m,"px)"),height:"2px"}))}},{key:"setGalleryHighlight",value:function(e,t){var n,i,r,o,a,s,c,l,u,d,h,f=this.getHighlightEl(!!t);f&&(n=e.element,i=e.isImageLeft,r=e.imageWidth,this.lastTransformedElements.includes(n)||this.removeTransform(),(o=Object(Be.c)(n,".ace-line"))&&(s=(a=Array.from(o.querySelectorAll(".".concat(U.r)))).findIndex(function(e){return e===n}),s=i?s:s+1,c=a.slice(0,s),l=a.slice(s,a.length),c.forEach(function(e){return Object.assign(e.style,Ze)}),l.forEach(function(e){return Object.assign(e.style,Ge)}),this.lastTransformedElements=a,u=o.getBoundingClientRect().height,d=o.offsetTop,h=0,h=t?(d=Object(We.d)(o,t)||0,Object(We.d)(n,t,"Left")||0):Object(We.d)(n,this.outerBody,"Left")||0,Object.assign(f.style,{top:"".concat(d,"px"),left:"".concat(i?h:h+r,"px"),width:"2px",height:"".concat(u,"px")})))}},{key:"initHighlightEl",value:function(e){if(!e)return null;var t=document.createElement("div");return Object.assign(t.style,{position:"absolute",top:"-100px",left:"-100px",width:0,height:0,backgroundColor:Ve.B500,zIndex:1}),e.appendChild(t),t}},{key:"removeAllHighlightEl",value:function(){this.removeTransform(),this.removeTypedHighlight("table"),this.removeTypedHighlight("body")}},{key:"destroy",value:function(){this.removeAllHighlightEl(),this.outerBody=null}}]),t}(),Je=n("y2sV"),Qe=n("RQuH"),Xe=function(e,t){var n=t.getBoundingClientRect(),i=[n.bottom-n.height/10,n.bottom];return Object(Qe.a)(e,i[0],i[1])},$e=function(e,t){var n=e.map(function(e){return e.getBoundingClientRect()});if(t<n[0].left)return[0,!0,n[0].width];if(t>n[n.length-1].right)return[e.length-1,!1,n[n.length-1].width];var i=!0,r=!1,o=void 0;try{for(var a,s=n.entries()[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=E()(a.value,2),l=c[0],u=c[1];if(Object(Qe.a)(t,u.left,u.right))return[l,t-u.left<u.width/2,u.width];var d=n[l+1];if(!d)break;if(t<d.left)return[l,!1,u.width]}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return[-1,!1,0]},et=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return{element:e,type:De.LINE,isLineTop:t}},tt=function(e,t,n){return{element:e,isImageLeft:t,imageWidth:n,type:De.IMAGE}},nt=n("v6N1"),it=n("ZKUE"),rt=n("kESg"),ot=n("zTCG"),at=n("ciJ8"),st=function(){function i(e,t,n){var T=this;m()(this,i),this.editor=e,this.state=t,this.onDrop=function(e,t,n){var i=n.draggingImg,r=T.state.draggingUuid;T.editor.getPlugin(U.K).setPreventAutoFixSelection(!0);var o=T.candidateElement||{},a=o.element,s=o.type,c=o.isImageLeft,l=o.isLineTop;if(T.candidateElement=null,T.highlightManager.removeAllHighlightEl(),T.state.draggingUuid=null,!a||!i||!r||a.matches(".".concat(U.r))&&a.contains(i))return!1;try{var u=Object(P.o)({uuid:r},T.editor),d=Object(P.n)(a,T.editor);if(0===u.length||!d)return!1;var h,f=u[0],p=Object(P.r)([f]).filter(function(e){return e.uuid!==r||(h=e,!1)}),g=d.start,m=g.zoneId,v=g.line,b=f.start,y=b.zoneId,E=b.line,O=m===y;if(s===De.LINE){var C=T.dropToNewLine(d,f,h,l),k=T.cleanSourceImage(f,p);T.composeAndApply(C,k,O,r)}else{var I=T.dropToImage(a,d,c,h);if(!I)return!1;if(O&&v===E)return T.editor.inCallStackIfNecessary("dropImageEvent",function(){T.editor.getContentState().apply(I),T.selectTargetImage(r),T.triggerAnimation(r,c)}),!0;var S=T.cleanSourceImage(f,p);T.composeAndApply(I,S,O,r),T.triggerAnimation(r,!1)}return!0}catch(e){return console.error("[New Image] Drop error",e),!1}},this.dropToNewLine=function(e,t,n,i){var r,o=e.start.zoneId,a=T.editor.getContentState().getZoneState(o),s=a.length()-1,c=s<e.start.line+1,l=T.clacDropInsertRetain(a,i,s,c,e),u=new Je.E({zoneId:o}).retain(l);c&&u.insertEnter();var d,h=a.getLine(t.start.line);return h&&h.hasLineMarker()&&(d=h.getLineAttributes(),u.insertLineMarker(d.toMap())),u.insert(U.B,(r={},S()(r,U.K,Object(P.f)(n)),S()(r,"author",t.attributes.author),r)).insertEnter(),u},this.dropToImage=function(e,t,n,i){var r,o,a=t.start,s=a.zoneId,c=a.line,l=T.editor.getContentState().getZoneState(s),u=l.getLine(c),d=Object(P.x)(s,c,T.editor),h=Object(P.v)(e);if(!d||!h||!u)return null;d=T.getNewLineImages(d,i,h,n,s,T.editor),u.getEntities([]).forEach(function(e){Object(P.M)(e)&&(r=r||e,o=e)});for(var f=l.pointToOffset(r.start),p=l.pointToOffset(o.end)-f,g=new Je.E({zoneId:s}).retain(f).delete(p),m=0;m<d.length;m++){var v,b=d[m],y=Object(P.o)({uuid:b.uuid},T.editor);g.insert(U.B,(v={},S()(v,U.K,Object(P.f)(b)),S()(v,"author",y&&y.length&&y[0].attributes.author||""),v))}return g},this.selectTargetImage=function(i){var r=Object(P.o)({uuid:i},T.editor);r&&0!==r.length&&T.editor.once("paint",function(){var e=r[0],t=e.start,n=e.end;T.editor.selection.setSelection({start:t,end:n},!0),Object(it.a)(T.imageStateInstance,i)})},this.triggerAnimation=function(i,r){T.editor.once("paint",function(){var e,t=document.querySelector('img[data-uuid="'.concat(i,'"]')),n=Object(Be.c)(t,".".concat(U.r));n&&(e=r?U.o:U.n,n.classList.add(e),setTimeout(function(){n.classList.remove(e)},U.m))})},this.cleanSourceImage=function(e,t){var n=e.start.zoneId,i=Object(P.E)(e,T.editor,!0,n),r=i.retainLen,o=i.deleteLen,a=new Je.E({zoneId:n});a.retain(r).delete(Object(P.H)(e.start,T.editor,o)?o-1:o);for(var s=0;s<t.length;s++){var c,l=t[s],u=Object(P.o)({uuid:l.uuid},T.editor);a.insert(U.B,(c={},S()(c,U.K,Object(P.f)(l)),S()(c,"author",u&&u.length&&u[0].attributes.author||""),c))}return a},this.composeAndApply=function(i,r,o,e){var a=T.editor.getContentState();T.editor.inCallStackIfNecessary("dropImageEvent",function(){var e,t,n;o?(e=i.transform(r,!0),t=i.compose(e),console.log("[image plugin] Drop delta",t),a.apply(t)):((n=new Je.e).add(i.zoneId,i),n.add(r.zoneId,r),console.log("[image plugin] Drop delta",n),a.apply(n))}),T.selectTargetImage(e)},this.onDragMove=Object(Fe.default)(function(e,t){var n,i=t.clientX,r=t.clientY,o=ze.draggingImg,a=document.elementFromPoint(i,r);o&&a&&(n=T.tryGetCandidate(a,o,i,r),T.candidateElement=n,T.highlightManager.setHighlight(T.candidateElement,t))},16,{leading:!0,trailing:!1}),this.imageStateInstance=n,this.highlightManager=new Ye(e),this.dropManager=new Be.b({withoutDropTarget:!0}),this.dropManager.register([".ace-line",".".concat(U.r)],{onDrop:this.onDrop,onDragMove:this.onDragMove})}return w()(i,[{key:"clacDropInsertRetain",value:function(e,t,n,i,r){var o,a=r.start.line+1;return t?e.pointToOffset({line:r.start.line,offset:0}):i?(o=e.getLine(n),e.pointToOffset({line:n,offset:o.length()-1})):e.pointToOffset({line:a,offset:0})}},{key:"getNewLineImages",value:function(e,t,n,i,r,o){var a=e.filter(function(e){return e.uuid!==t.uuid}),s=a.findIndex(function(e){return e.uuid===n})+(i?0:1);a.splice(s,0,t);var c=Object(nt.a)(e,t,r,o);return a.map(function(e){var t=e.uuid,n=e.size,i=c.get(t);if(!i)return e;var r=i.width,o=i.height;return n.displayWidth=r,n.displayHeight=o,e})}},{key:"tryGetCandidate",value:function(e,t,n,i){if(!e)return this.candidateElement;var r=Object(Be.c)(e,[".ace-line",".ace-table-cell",".ace-table-wrapper"]);if(!r)return this.candidateElement;if(r.matches(".ace-table-cell")){var o=r.querySelectorAll(".ace-line");if(1===o.length)return et(o[0],!0);var a=o[o.length-1].getBoundingClientRect();return i<a.top+a.height/2?et(o[0],!0):et(o[o.length-1])}if(r.matches(".ace-table-wrapper"))return this.candidateElement;if(r.matches(".ace-line")){var s=r.querySelectorAll(".".concat(U.r));if(0<s.length){var c=!C()(s).some(function(e){return e.contains(t)})&&s.length>=U.w;if(Xe(i,r)||c)return et(r);var l=$e(Array.from(s),n),u=E()(l,3),d=u[0],h=u[1],f=u[2];if(-1===d)return null;var p=s[d],g=s[d+(h?-1:1)];return p.contains(t)||g&&g.contains(t)?null:tt(p,h,f)}var m=Object(Be.c)(r,".ace-table-cell");if(m){var v=m.querySelectorAll(".ace-line");if(1===v.length)return et(v[0],!0)}if(r.classList.contains("list-code")){for(var b=r;b.nextElementSibling&&b.nextElementSibling.classList.contains("list-code");)b=b.nextElementSibling;return et(b)}if(r.classList.contains(ot.a.LINE)||r.classList.contains(at.h.LINE)){var y=Object(Be.c)(r,".".concat(rt.e.ACE_LINE));if(y)return et(y)}return et(r)}return null}},{key:"getDropManager",value:function(){return this.dropManager}},{key:"destroy",value:function(){this.highlightManager.destroy(),this.dropManager.destroy()}}]),i}(),ct=function(){function n(e){m()(this,n),this.config=e,this.imageDragState={draggingUuid:null};var t=e.editor;this.imageDragManager=new He(t),this.imageDropManager=new st(t,this.imageDragState,e.imageStateInstance),this.imageDragManager.connect(this.imageDropManager.getDropManager())}return w()(n,[{key:"destroy",value:function(){this.imageDragManager.destroy(),this.imageDropManager.destroy()}},{key:"setDraggingUuid",value:function(e){this.imageDragState.draggingUuid=e}}]),n}(),lt=n("+Xq6"),ut=n("WsN4"),dt=function(){function n(e){m()(this,n),this.copyOut=null;var t=e.copyOut;this.copyOut=t}return w()(n,[{key:"generatePublicUrl",value:function(e){return this.copyOut?this.copyOut.generatePublicUrl(e):""}},{key:"getDriveImgInfo",value:function(e){var t=e.fileToken,n=e.originSrc;return Object(lt.e)({fileToken:t||"",objType:Object(J.k)(),objToken:Object(J.g)(),originSrc:n})}},{key:"generateSerializedNode",value:function(e){var t=document.createElement("img"),n=e.token,i=e.originSrc,r=e.imageCategory,o=e.size,a=o.displayHeight,s=o.displayWidth,c={fileToken:r===U.D.Drive&&n||"",originSrc:i||""},l=this.generatePublicUrl(c),u=this.getDriveImgInfo(c);return t.setAttribute(ut.a.DataNoRequestSrc,l),t.setAttribute(ut.a.DataSrc,c.originSrc),t.setAttribute(ut.a.DataSuite,u),t.setAttribute(ut.a.DataHeight,a.toString()),t.setAttribute(ut.a.DataWidth,s.toString()),t}},{key:"makePublicUrlEffective",value:function(){this.copyOut&&this.copyOut.makePublicUrlEffective()}},{key:"destroy",value:function(){this.copyOut=null}}]),n}(),ht=n("PiJo"),ft=n("wU5f").a,pt=n("afrW"),gt=n("q1tI"),mt=function(){return{hoveredImageUuid:null,bodyWidth:document.body.clientWidth,inViewImages:new Set,demandLoadImages:new Set,editorWidth:0,imageSizeMap:new Map,isSkipLoading:!1,isReadOnly:!1,fullscreenMode:null,loadedSrcMap:new Map,selectedImageSet:new Set,onSelectionImageSet:new Set,reuseSSRImage:new Map,lastUploadedImageUuid:""}},vt=function(){var i=[],r=mt(),o=function(e){r=Object.assign({},r,{},e),i.forEach(function(e){e(r)})};return{useImageState:function(){var e=Object(gt.useState)(),t=E()(e,2),n=(t[0],t[1]);return Object(gt.useEffect)(function(){return i.push(n),function(){i=i.filter(function(e){return e!==n})}},[]),[r,o]},setImageState:o,resetImageState:function(){return r=mt()},getImageState:function(){return r}}};function bt(e){var t=e.editor,n=e.moduleMap,i=e.eventEmitter,r=e.newGalleryEnable,o=e.pure,a=e.containerCls;if(t){if(!r){var s=n?n.galleryComment:void 0;return new pt.a({editor:t,galleryComment:s,eventEmitter:i,pure:o,containerCls:a})}if(n){var c=vt(),l=yt(t,c,n);return new u.a({editor:t,imageStateInstance:c,moduleInstanceMap:l})}console.error("[image plugin] registerImagePlugin fail, moduleMap is required in new image plugin.")}else console.error("[image plugin] registerImagePlugin fail, can not get editor")}function yt(o,a,s){var c={};return Object.keys(s).forEach(function(e){var t,n,i,r;Array.isArray(s[e])?(n=(t=E()(s[e],2))[0],r=void 0===(i=t[1])?{}:i,c[e]=new n(Object.assign({},r,{editor:o,imageStateInstance:a}))):c[e]=s[e]}),c}function Et(){return c.a.isMobile?{}:{imageUploader:[l.a,{}],imagePreviewer:[oe,{}],imageDraggable:[ct,{}],imageCopy:[dt,{copyOut:ht}],imageExternalSaver:[ft,{}],imageFetcher:[Pe,{}]}}n.d(t,"b",function(){return bt}),n.d(t,"a",function(){return Et})},"/C+9":function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n("o0o1"),r=n.n(i),o=n("yXPU"),a=n.n(o),s=n("lwsE"),c=n.n(s),l=n("W8MJ"),u=n.n(l),d=n("6YuL"),h=n("LUUo"),f=n("aXiW"),p=n("F4ZU"),g=function(){function t(e){c()(this,t),this.props=e,this.getStorage=p.a.getStorage,this.getLegacyDataStorage=p.a.getLegacyDataStorage,this.hash=p.a.hash}function e(e){return n.apply(this,arguments)}var n;return u()(t,[{key:"getWatchdogConfig",value:function(){return{MIN_RECORD_NUM_TO_PERFORM_CLEANING:10,RECORD_EXPIRE_AFTER:1296e6,HANDLE_USER_CHANGE_TIMEOUT:2e3,THROTTLE_SAVE_UI_DATA_INTERVAL:1e4}}},{key:"generateUIDataToSave",value:(n=a()(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.props.getToken(),e.t1=this.props.getStartTime(),e.t2=this.props.getMemberId(),e.next=5,this.props.getExtra();case 5:return e.t3=e.sent,e.t4=this.props.getUIData(t),e.abrupt("return",{token:e.t0,startTime:e.t1,memberId:e.t2,extra:e.t3,UIData:e.t4});case 8:case"end":return e.stop()}},e,this)})),e)},{key:"onAddRecordSuccess",value:function(){Object(f.a)("dev_doc_watch_dog_save").report({status:"success"})}},{key:"onAddRecordError",value:function(e){Object(f.a)("dev_doc_watch_dog_save").report({status:"fail"})}}]),t}();function m(e,t){var n=new g(t),i=new d.a(n),r=new h.a(e);return r.setWatchdogNotifier(i),{watchdog:i,watchdogPlugin:r}}},"/CvD":function(e,t,n){"use strict";var i,r,o,a;n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),(r=i=i||{})[r.NotSupport=0]="NotSupport",r[r.Text=1]="Text",r[r.Number=2]="Number",r[r.SingleSelect=3]="SingleSelect",r[r.MultiSelect=4]="MultiSelect",r[r.DateTime=5]="DateTime",(a=o=o||{})[a.Textarea=1]="Textarea",a[a.Editor=2]="Editor"},"/Mcf":function(e,t,n){"use strict";var i=n("o0o1"),v=n.n(i),r=n("yXPU"),o=n.n(r),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),l=n.n(c),u=n("a1gu"),d=n.n(u),h=n("PJYZ"),b=n.n(h),f=n("Nsbk"),p=n.n(f),g=n("iWIM"),m=n.n(g),y=n("7W2i"),E=n.n(y),O=n("cDf5"),C=n.n(O),k=n("BScZ"),I=n("H6oK"),S=n("8dyR"),T=n("SCx9"),_=n("IyQe"),w=function(){function e(){var t=this;s()(this,e),this.destroyed=!1,this.unsubscribe=null,this.permissionChangeCallback=null,this.unsubscribe=Object(_.getCurrentPublicPermissionAsync)(function(e){t.destroyed||(t.permissions=e,t.permissionChangeCallback&&t.permissionChangeCallback())})}return l()(e,[{key:"isCommentEnabled",value:function(){return Object(_.getIsCommentable)(this.permissions)}},{key:"isWritable",value:function(){return Object(_.getUserPermissions)(this.permissions).editable}},{key:"onPermissionChange",value:function(e){this.permissionChangeCallback=e}},{key:"destroy",value:function(){this.unsubscribe&&this.unsubscribe(),this.destroyed=!0}}]),e}(),j=n("7EGn"),M=n("iP/4"),L=n("sFgt"),R=function(){function t(e){var d=this;s()(this,t),this.handleCommentShortcut=null,this.hasBind=!1,this.contains=function(e,t){var n="string"==typeof M.a.version?parseInt(M.a.version,10):M.a.version;return t&&3===t.nodeType&&M.a.modernIE&&11===n?e.contains(t.parentNode):e.contains(t)},this.handleKeyEvent=function(e){if(d.editor){var t=e.which,n=e.metaKey,i=e.altKey,r=e.type,o=e.ctrlKey,a=M.a.isIE||M.a.safari||M.a.chrome?"keydown"===r:"keypress"===r,s=d.editor.getClientVars().padShortcutEnabled.cmdOptionM,c=String.fromCharCode(t).toLowerCase();if(a&&("m"===c&&o&&i||"m"===c&&n&&i&&s)){var l=Object(j.default)(window.getSelection(),"focusNode"),u=d.editor.getInnerContainer();return l&&Object(L.b)(u,l)?(e.preventDefault(),Object(L.a)(d.editor),d.handleCommentShortcut&&d.handleCommentShortcut(e),!0):void 0}}},this.editor=e}return l()(t,[{key:"setEditable",value:function(e){this.hasBind||e?this.hasBind&&e&&this.unbind():this.bind()}},{key:"onCommentShortcut",value:function(e){this.handleCommentShortcut=e}},{key:"unbind",value:function(){document.removeEventListener("keydown",this.handleKeyEvent),document.removeEventListener("keypress",this.handleKeyEvent),this.hasBind=!1}},{key:"bind",value:function(){document.addEventListener("keydown",this.handleKeyEvent),document.addEventListener("keypress",this.handleKeyEvent),this.hasBind=!0}},{key:"destroy",value:function(){this.unbind()}}]),t}(),N=n("OX8E"),D=n("AYG9"),x=(n("3OMI"),n("4HEM")),P=n("SebV"),B=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":C()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},U=function(e){function n(e){var m,t;return s()(this,n),(m=d()(this,p()(n).call(this,e))).permission=new w,m.shortcut=null,m.className="Comment",m.handlePermissionChange=function(){var e;if(m.isCommentEnabled())return m.shortcut||(m.onNotify(T.c.UPDATE_COMMENTABLE,m.isCommentEnabled()),(e=new R(m.editor)).onCommentShortcut(m.handleShortcut),m.shortcut=e),void m.shortcut.setEditable(m.permission.isWritable());m.shortcut&&(m.shortcut.destroy(),m.shortcut=null)},m.showBlockEditbar=function(e){var t,n=e.context,i=m.editor.getRep(),r=i.selStart,o=i.selEnd,a=i.zoneId;r&&o&&a&&(t=n.block,Object(I.isEditbarConfigurable)(t)&&t.editbarTrigger!==I.Trigger.hover&&m.detectActiveComment({selStart:r,selEnd:o,selZone:a}))},m.handleSuspensionButtonClick=function(){var t=o()(v.a.mark(function e(t){var n,i,r,o,a,s;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={},e.next=3,m.handleOpenPanel();case 3:return e.next=5,m.comment.startNewComment(t,n);case 5:if(i=e.sent,r=i.serviceType,o=i.serviceToken,a=i.tempCommentId,s=m.comment.getRectByCommentId(r,o,a,0)){e.next=10;break}throw new Error("no start new comment's rect found");case 10:m.onNotify(T.c.START_NEW_COMMENT,Object.assign({},i,{selection:t,context:n,activeTop:s.top,createFrom:T.a.Bubble}));case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),m.handlePopupClick=function(){var t=o()(v.a.mark(function e(t){var n,i,r,o,a,s,c,l,u;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.event,i=t.selection,r=t.context,o=void 0===r?{}:r,i=i||m.getCurrentSelection()){e.next=4;break}return e.abrupt("return");case 4:return Object(D.b)(D.a.ADD_COMMENT),e.next=7,m.handleOpenPanel();case 7:return e.next=9,m.comment.startNewComment(i,o);case 9:if(a=e.sent,s=a.serviceType,c=a.serviceToken,l=a.tempCommentId,u=m.comment.getRectByCommentId(s,c,l,0)){e.next=14;break}throw new Error("no start new comment's rect found");case 14:m.onNotify(T.c.START_NEW_COMMENT,Object.assign({},a,{selection:i,context:o,activeTop:u.top,createFrom:T.a.EDITOR_BAR})),m.comment.logger.logClickPopup(n.target),m.comment.logger.logTriggerStartNewCommentByEditorbar(n.target);case 17:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),m.handleOpenPanel=o()(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){m.onNotify(T.c.OPEN_PANEL,{resolve:e})}));case 1:case"end":return e.stop()}},e)})),m.handleShortcut=o()(v.a.mark(function e(){var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.isCommentEnabled()){e.next=2;break}return e.abrupt("return");case 2:if(t=b()(m),(n=t.editor).inCallStackIfNecessary("commentShortcut",function(){n.fastIncorp()}),i=n.getRep(),r=i.selStart,o=i.selEnd,a=i.zoneId,!(s={selStart:r,selEnd:o,selZone:a})||n.selection.isCaret(s))return e.abrupt("return");e.next=8;break;case 8:return(c=m.comment.getCoveredCommentBySelection(s))&&c.comment&&m.comment.deactivateComment(),m.onNotify(T.c.HIDE_COMMENT_POPUP,void 0),l=Object(x.b)(m.editor,a,r,o),u=l?{choosenImageUUid:l.choosenImageUUid}:{},e.next=15,m.handleOpenPanel();case 15:return e.next=17,m.comment.startNewComment(s,u);case 17:if(d=e.sent,h=d.serviceType,f=d.serviceToken,p=d.tempCommentId,g=m.comment.getRectByCommentId(h,f,p,0)){e.next=22;break}throw new Error("no start new comment's rect found");case 22:m.onNotify(T.c.START_NEW_COMMENT,Object.assign({},d,{selection:s,context:u,activeTop:g.top,createFrom:T.a.SHORT_KEY})),m.comment.logger.logTriggerStartNewCommentByShortcut();case 24:case"end":return e.stop()}},e)})),m.mountComment=function(){var n=o()(v.a.mark(function e(t,n){var i,r,o,a,s,c,l=arguments;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=2<l.length&&void 0!==l[2]?l[2]:{},e.next=3,m.comment.startNewComment(t,i,n);case 3:if(r=e.sent,o=r.serviceType,a=r.serviceToken,s=r.tempCommentId,c=m.comment.getRectByCommentId(o,a,s,0)){e.next=8;break}throw new Error("no start new comment's rect found");case 8:m.onNotify(T.c.START_NEW_COMMENT,Object.assign({},r,{selection:t,context:i,activeTop:c.top,createFrom:T.a.SHORT_KEY})),m.comment.logger.logTriggerStartNewCommentByShortcut();case 10:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),m.invokeCollapse=function(e){var t=e.serviceType,n=e.serviceToken,i=e.commentId,r=e.source,o=m.comment.findComment(t,n,i);if(!o)throw new Error("no comment found");var a=o.docPositions[0],s=a.selStart,c=a.selEnd,l=a.selZone;N.a.emit("invokeCollapse",{zoneId:l,range:{selStart:s,selEnd:c},source:r})},m.collopseLineChange=function(){m.comment.handleResizeComment(5,!1)},m.immediatelyResizeComment=o()(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m.comment.handleResizeComment(7,!0);case 1:case"end":return e.stop()}},e)})),m.onNotify=function(e,t){m.editor.call(e,t)},m.changesetApply=function(e,t){m.comment.logger.logChangesetApply(t.changeset)},m.aceSelectionChanged=function(){var e=m.getCurrentSelection();e&&m.detectActiveCommentAtNextTick(e)},m.aceKeyEvent=function(e,t){m.shortcut&&m.shortcut.handleKeyEvent(t.evt)},m.fullscreenEntered=function(){m.resizeComments(11)},m.fullscreenExited=function(){m.resizeComments(12)},m.deactivateComment=function(){m.comment.deactivateComment()},m.activateComment=function(){var r=o()(v.a.mark(function e(n,i,r,o){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(t){m.comment.activateComment(n,i,r,function(e){t(e)},o)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(e,t,n,i){return r.apply(this,arguments)}}(),m.locateComment=function(){var i=o()(v.a.mark(function e(n,i,r){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(t){m.comment.locateComment(n,i,r,function(e){t(e)})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(e,t,n){return i.apply(this,arguments)}}(),m.fixHorizontalScroll=function(){var i=o()(v.a.mark(function e(t,n,i){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.comment.fixHorizontalScroll(t,n,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(e,t,n){return i.apply(this,arguments)}}(),m.addHoverHighlight=function(e,t,n){m.comment.addHoverHighlight(e,t,n)},m.removeHoverHighlight=function(e,t,n){m.comment.removeHoverHighlight(e,t,n)},m.getTeaParams=function(e,t,n){return m.comment.getTeaParams(e,t,n)},m.saveCommentOnDoc=function(){var t=o()(v.a.mark(function e(t){var n,i,r,o,a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.serviceType,i=t.serviceToken,r=t.commentId,o=t.tempCommentId,m.isCommentEnabled()){e.next=3;break}throw new Error("comment is disabled");case 3:if(r){e.next=6;break}throw Object(P.a)("doc: empty commentId"),new Error("doc: empty commentId");case 6:return e.next=8,m.comment.addComment({serviceType:n,serviceToken:i,commentId:r,tempCommentId:o});case 8:return a=e.sent,e.abrupt("return",a);case 10:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),m.deleteCommentOnDoc=function(){var i=o()(v.a.mark(function e(t,n,i){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.isCommentEnabled()){e.next=2;break}throw new Error("comment is disabled");case 2:if(i){e.next=5;break}throw Object(P.a)("doc: empty commentId"),new Error("doc: empty commentId");case 5:if(m.comment.isUnSubmitComment(t,n,i))return m.comment.cancelNewComment(t,n,i),e.abrupt("return");e.next=8;break;case 8:return e.next=10,m.comment.removeComment(t,n,i);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e)}));return function(e,t,n){return i.apply(this,arguments)}}(),m.resolveCommentOnDoc=function(){var i=o()(v.a.mark(function e(t,n,i){var r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.isCommentEnabled()){e.next=2;break}throw new Error("comment is disabled");case 2:return r=m.comment.findComment(t,n,i),e.next=5,m.comment.resolveComment(t,n,i);case 5:m.editor.getInnerContainer().querySelector(".comment-id-".concat(i))&&m.comment.logger.logResolveCommentError(i,r?r.docPositions:[]);case 7:case"end":return e.stop()}},e)}));return function(e,t,n){return i.apply(this,arguments)}}(),m.reopenCommentOnDoc=function(){var i=o()(v.a.mark(function e(t,n,i){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.isCommentEnabled()){e.next=2;break}throw new Error("comment is disabled");case 2:return e.abrupt("return",m.comment.reopenComment(t,n,i));case 3:case"end":return e.stop()}},e)}));return function(e,t,n){return i.apply(this,arguments)}}(),m.resizeComments=function(e){return m.comment.handleResizeComment(e)},m.getFullCoveredCommentBySelection=function(e){return m.comment.getFullCoveredCommentBySelection(e)},m.setCommentData=function(e){m.comment.setCommentData&&m.comment.setCommentData(e)},m.activateMention=function(){var n=o()(v.a.mark(function e(t,n){var i;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.comment.activateMention)return e.next=3,m.comment.activateMention(t,n);e.next=5;break;case 3:return i=e.sent,e.abrupt("return",i);case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),m.getCommentTargetType=function(e,t,n){return m.comment.getCommentTargetType(e,t,n)},m.isTemplate=Boolean(e.isTemplate),m.comment.onNotify(m.onNotify),m.handleEventBinding("on"),m.permission.onPermissionChange(m.handlePermissionChange),m.isCommentEnabled()&&((t=new R(m.editor)).setEditable(m.permission.isWritable()),t.onCommentShortcut(m.handleShortcut),m.shortcut=t),m}return E()(n,e),l()(n,[{key:"getCurrentSelection",value:function(){var e=this.editor.getRep(),t=e.selStart,n=e.selEnd,i=e.zoneId;if(t&&n&&i)return{selStart:t,selEnd:n,selZone:i}}},{key:"isCommentEnabled",value:function(){return this.permission.isCommentEnabled()||this.isTemplate}},{key:"handleEventBinding",value:function(e){this.editor[e]("showBlockEditbar",this.showBlockEditbar),this.editor[e]("handleSuspensionButtonClick",this.handleSuspensionButtonClick),this.editor[e]("commentButtonClick",this.handlePopupClick),this.editor[e]("handlePopupCommentClick",this.handlePopupClick),this.editor[e]("invokeCollapse",this.invokeCollapse),N.a[e]("collapseLineChange",this.collopseLineChange)}},{key:"detectActiveCommentAtNextTick",value:function(e){this.detectActiveComment(e)}},{key:"detectActiveComment",value:function(e){this.comment.detectActiveComment(e)}},{key:"reset",value:function(){m()(p()(n.prototype),"reset",this).call(this),this.handleEventBinding("off"),this.shortcut&&(this.shortcut.destroy(),this.shortcut=null),this.permission.destroy()}},{key:"shouldDeactivate",value:function(e,t,n){var i=this.getCurrentSelection();if(!i)return!0;var r=this.comment.getCoveredCommentBySelection(i);return!r||!this.comment.isSameComment(r.comment,{serviceType:e,serviceToken:t,commentId:n})}}]),n}(k.b);B([Object(S.a)()],U.prototype,"detectActiveCommentAtNextTick",null);t.a=U},"/MeM":function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r});var i=["horizontal-line","true"],r=["blockquote","blockquote"]},"/OTu":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("kUgE"),r={zh:"cn_name",en:"en_name"};function o(e,t){var n=e[t]||{};return n[r[Object(i.getLanguage)()]]||n.name||n.cn_name||n.en_name}},"/P/v":function(e,C,k){"use strict";(function(r){k.d(C,"a",function(){return n});var e=k("lwsE"),i=k.n(e),t=k("W8MJ"),o=k.n(t),a=k("HIeq"),M=k("Z/PY"),L=k("15MJ"),s=k("0bqa"),c=k("1I8I"),l=k("TJya"),f=k("OsWd"),u=k("n/R6"),d=k("aXiW"),h=k("zaV1"),R=k("2ACu"),p=k("K9Ia"),g=k("t9fZ"),m=k("VIFs"),v=k("1dfU"),N=k("lQZd"),b=k("mRaX"),y=k("QM+C"),E=k("Poi8"),O=k("zAQS"),n=function(){function n(e,t){var j=this;i()(this,n),this.events=["beforeFileQueued","uploadStart","uploadProgress","uploadSuccess","uploadError","uploadBeforeSend"],this.waitUntilCompositionEnd=function(i){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];j.editorInfo.getInInternationalComposition()?j.compositionEndSubject.pipe(Object(g.a)(1)).subscribe(function(e){return i.apply(j,t)}):i.apply(j,t)}},this._uploadBeforeSend=function(e,t,n,i){Object.assign(n,Object(l.a)()),j.performImageViewer(e.file,i)},this._uploadStart=function(){var e,t,n=Object(N.g)();j.imageUploadInstance&&j.imageUploadInstance.driveImageEnable?(e="/api/box/stream/upload/all/",j.uploader.option("server",Object(m.prependAPI)(e)),j.uploader.option("formDataAsQuery",!0),j.uploader.option("formData",{mount_node_token:n,mount_point:"doc_image",push_open_history_record:1})):(t=encodeURI("/api/file/upload/"),j.uploader.option("server",Object(m.prependAPI)(t)),j.uploader.option("formData",{token:n,obj_type:y.NUM_SUITE_TYPE.DOC}))},this.performImageViewer=function(t,l){var u=t.uuid=Object(a.b)();j.filesUUID.push(u);var d=j.imageViews[t.uuid]=new s.a(t.uuid),h=j.imageAttrs,n=j.ace.editorInfo;Object(f.a)(n),window._currentViewHeight=window.innerHeight/2-50,j.imageViewCalcPromise[u]=new Promise(function(c,e){j.readImgPromise[u]=d.createObjectURL(t.source.source).then(function(s){return d.calcImageRect(s).then(function(a){n.callWithAce(function(){var e=a.height,t=a.width,n=a.natrualWidth,i=a.natrualHeight,r=a.scale;h[u]={height:e,width:t,src:s,natrualWidth:n,natrualHeight:i,scale:r},c(h[u]),j.imageUploadInstance.uploadDispayUrl[u]=l||s;var o=[["image-previewer",[Object(M.e)({uuid:u,pluginName:L.s,height:e,width:t})]]];d.performImagePreviewer(o),j.updateCursor()},"uploadImageSuc",!0)},function(){j.showAlertForLoadTimeout()}),s},function(e){j.showAlertForLoadTimeout()})})},this._uploadProgress=function(e,t){j.imageViews[e.uuid].updateProgressStyle(t)},this.deleteImageView=function(e){j.imageViews[e]&&(delete j.imageAttrs[e],delete j.imageViews[e])},this._uploadSuccess=function(b,e){var t,y,n,E,O,i,C,k,I,S,T,_,r=j.ace,o=j.imageViews,a=j.imageAttrs,w=r.editorInfo;j.imageUploadInstance.driveImageEnable&&0!==e.code?j.uploadError(b,e.msg):(t=e.data&&!e.data.url,0!==e.code&&t?j.uploadError(b,e.msg):(y=b.uuid,n=e.data,E=n.file_token,O=n.version,i=n.url,C=n.cdn_url,k=n.thumbnail_cdn_url,I=n.webp_thumbnail_cdn_url,S=n.decrypt_key,T=Object(v.a)(E||i),_=E?Object(M.i)(E,Object(N.g)()):i,Object(R.default)("doc_image_insert_status",{insert_status:"uploaded",image_code:T,image_catagory:Object(M.j)(E)}),j.imageViewCalcPromise[y].then(function(){var m=o[y],v=a[y];w.call(L.l,_),w.callWithAce(function(){var e=v||{},t=e.natrualWidth,n=e.natrualHeight,i=e.scale,r=n,o=t,a=n,s=t,c=w?w.getInnerContainer():document.querySelector(".doc-history-revert__content.innerdocbody")||document.querySelector(".history-list"),l=w&&c["data-last-width"]||c.offsetWidth,u=16/9,d=parseInt(r)/parseInt(o),h=isNaN(parseInt(o))||isNaN(parseInt(r));(u<d||h)&&(r=a=l/3*d+"px",o=s=Math.floor(l/3)+"px");var f=b.source.type,p=j.imageUploadInstance.uploadDispayUrl[y];j.imageUploadInstance.uploadDispayUrl[_]=p,delete j.imageUploadInstance.uploadDispayUrl[y],"image/gif"===f&&j.imageUploadInstance.setLoadedGifResource(_,p);var g=[["gallery",JSON.stringify({items:[{attachmentId:"attachment-id-"+y,type:"image",src:encodeURIComponent(_),pluginName:L.s,uuid:y,natrualWidth:t,natrualHeight:n,decrypt_key:S||"",cdn_url:C||"",thumbnail_cdn_url:k||"",webp_thumbnail_cdn_url:I||"",height:r,width:o,scale:i,comments:[],isDragging:!1,image_type:f,size:b.source.size,currHeight:a,currWidth:s,file_token:E||"",file_version:O||""}]})]];w.call("imageUploadSuccess"),m.replacePlaceholderWidthImage(g),Object(R.default)("doc_image_insert_status",{insert_status:"inserted",image_code:T,image_catagory:Object(M.j)(E)})},"uploadImageSuc",!0),j.deleteImageView(y),b.source&&Object(d.a)("client_uploader_image").push({create_source:b.source.logSource||"toolbar"}),Object(d.a)("client_uploader_image").report(Object.assign({upload_status:"success",mention_file_length:b.size,mention_file_type:b.ext,image_catagory:Object(M.j)(E)},Object(h.b)()))})))},this._uploadError=function(t,e){u.a.show({type:"error",closable:!0,content:r("etherpad.upload_failed")});var n,i=j.ace.editorInfo;t&&((n=Object(M.f)(i,function(e){return e.uuid===t.uuid}))&&s.a.clearImagePreviewer(n),j.deleteImageView(t.uuid),t.source&&Object(d.a)("client_uploader_image").push({create_source:t.source.logSource||"toolbar"}),Object(d.a)("client_uploader_image").report(Object.assign({upload_status:"fail",mention_file_length:t.size,mention_file_type:t.ext},Object(h.b)())))},this.updateCursor=function(){j.updateCursorTimeout&&clearTimeout(j.updateCursorTimeout),j.updateCursorTimeout=setTimeout(function(){var e=j.editorInfo.getRep();j.editorInfo.selection.setWithSelection(e.zoneId,e.selStart,e.selEnd,!1),j.editorInfo.updateBrowserSelectionFromRep(!0),s.a.removeImageChooseStyle()})},this.beforeFileQueued=function(e){if(y.isAnonymousAccess)return e.source&&"paste"===e.source.logSource&&Object(M.a)(),!1;if(e.source&&e.source.fromDir)return!1;var t=j.editorInfo.getRep().zoneId;if(Object(E.i)(j.editorInfo,t)||Object(O.j)(j.editorInfo,t))return!1;e.source.logSource&&"drag"===e.source.logSource||Object(R.default)("confirm_mention",{mention_type:"insertimage",panel_source:"a_panel",line_is_empty:Object(b.P)(j.editorInfo)});var n=j.pasteOverSized;return j.pasteOverSized=!1,!(e.size>L.j)||(u.a.show({type:"error",closable:!0,content:r(n?"etherpad.upload_noallow_paste":"etherpad.upload_failed_than_size")}),!1)},this.showAlertForLoadTimeout=function(){Promise.all([k.e("vendors--mobile_modal_helper"),k.e("mobile_modal_helper")]).then(k.bind(null,"CxcE")).then(function(e){return e.showAlert("",r("etherpad.load_timeout"))})},this.uploader=n.uploader,this.editorInfo=e.editorInfo,this.ace=e,this.imageUploadInstance=t,this.pasteOverSized=!1,this.extensions="gif,jpg,jpeg,bmp,png",this.imageViews={},this.imageAttrs={},this.imageViewCalcPromise={},this.readImgPromise={},this.allFileList=[],this.filesUUID=[],this.uploader=Object(c.a)(e),this.uploadStart=this.waitUntilCompositionEnd(this._uploadStart),this.uploadProgress=this.waitUntilCompositionEnd(this._uploadProgress),this.uploadSuccess=this.waitUntilCompositionEnd(this._uploadSuccess),this.uploadError=this.waitUntilCompositionEnd(this._uploadError),this.uploadBeforeSend=this.waitUntilCompositionEnd(this._uploadBeforeSend),this.compositionEndSubject=new p.a,this.events.forEach(function(e){return j.uploader.on(j.extensions,e,j[e])})}return o()(n,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.uploader.off(t.extensions,e,t[e])}),Object(c.c)(),this.uploader=null,this.editorInfo=null,this.ace=null,this.imageUploadInstance=null,this.imageViews={},this.imageAttrs={},this.imageViewCalcPromise={},this.readImgPromise={},this.allFileList=[],this.filesUUID=[],this.updateCursorTimeout&&clearTimeout(this.updateCursorTimeout),this.updateCursorTimeout=null,this.uploadStart=null,this.uploadProgress=null,this.uploadSuccess=null,this.uploadError=null,this.uploadBeforeSend=null}}]),n}();n.threads=10}).call(this,k("2vAP"))},"/WRf":function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("FJEn"),c=n("GGin"),l=n("cDf5"),u=n.n(l),d=n("ylw9"),h=n("nVH4"),f=n("4PSP"),p=n("2hu8"),g=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":u()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},m="0",v=function(){function t(e){r()(this,t),this.editor=e}return a()(t,[{key:"getLineEntry",value:function(e){return this.editor.getRep(m).lines.atIndex(e)}},{key:"getLineNumSelection",value:function(e,t){return{selStart:[e,0],selEnd:[e,this.getLineEntry(e).text.length],selZone:m}}},{key:"getLineEntryTopBottom",value:function(e){var t={lineTop:0,lineBottom:0},n=this.editor.getRep(m),i=Object(p.d)(n,e,!0);return i&&(t.lineTop=i.top,t.lineBottom=i.bottom),t}},{key:"binarySearchLineNu",value:function(e){var t=this.editor.getRep(m);return Object(p.b)(t,e)}},{key:"withInDocScope",value:function(e){var t=Object(p.e)(this.editor)-1,n=0,i=this.editor.getRep(m);return Object(p.h)(i,e,[n,t])}},{key:"withInHideScope",value:function(e,t,n){if(e&&t&&n){var i=this.getLineEntryTopBottom(n),r=i.lineTop,o=i.lineBottom;return t<r&&r<e||t<o&&o<e||t<r&&o<e}return!1}},{key:"withInBlackList",value:function(e){var t=this.editor.getRep(m),n=Object.assign({},t,{selStart:[e,0],selEnd:[e+1,0],selZone:m});return Object(d.a)({rep:n})!==h.d.TEXT}},{key:"getLineNumIsActiveComment",value:function(e){var t=this.editor.plugins.comment.getFullCoveredCommentBySelection(e);return!(!t||t.isSubmitted)}}]),t}();g([Object(f.Bind)()],v.prototype,"getLineEntry",null),g([Object(f.Bind)()],v.prototype,"getLineNumSelection",null),g([Object(f.Bind)()],v.prototype,"getLineEntryTopBottom",null),g([Object(f.Bind)()],v.prototype,"binarySearchLineNu",null),g([Object(f.Bind)()],v.prototype,"withInDocScope",null),g([Object(f.Bind)()],v.prototype,"withInHideScope",null),g([Object(f.Bind)()],v.prototype,"withInBlackList",null),g([Object(f.Bind)()],v.prototype,"getLineNumIsActiveComment",null);var b="showBtn",y="hideBtn",E=(n("b5Yl"),n("4udo"));n.d(t,"a",function(){return O});var O=function(){function n(e){var d=this,t=e.editor;r()(this,n),this.className="SuspensionComment",this.handlePopupTop=function(e){var t=e.popupTop,n=e.selection,i=d.util.withInHideScope;0<t?(d.hideTop=t<n.top?t:n.top,d.hideBottom=t>n.bottom?t+40:n.top+n.height,i(d.hideBottom,d.hideTop,d.lineNum)&&d.hideButton()):(d.hideTop=null,d.hideBottom=null)},this.handleTableColSelected=function(e){var t,n=e.hideTop,i=e.hideBottom;e.isReset?(d.hideTop=null,d.hideBottom=null):(t=d.util.withInHideScope,d.hideTop=n,d.hideBottom=i,t(d.hideBottom,d.hideTop,d.lineNum)&&d.hideButton())},this.onClick=function(e,t){var n;n=d.hlId?d.editor.getRange(d.hlId,"0")._range:(0,d.util.getLineNumSelection)(t),d.editor.call("clearActiveComment"),d.editor.call("handleSuspensionButtonClick",n),d.hideButton(),n&&d.setSelectionBackground("",n,d.editor)},this.handleMouseEvent=function(e){var t=e.type;if(d.lineNum||0===d.lineNum){var n=Object(E.c)(d.lineNum,d.editor,s.DEFAULT_REP_ZONE);if("mouseenter"===t)return d.clearHl(),void((0,d.util.getLineNumIsActiveComment)(n)||(d.addHl(n),n&&d.setSelectionBackground("none",n,d.editor)));"mouseleave"===t&&d.hlId&&(d.clearHl(),n&&d.setSelectionBackground("",n,d.editor))}},this.resetLineNum=function(){d.lineNum=null},this.changesetApply=function(e,t){var n=t.changeset,i=t.editor.changesetHelper;if(d.lineNum){for(var r=(0,d.util.getLineEntry)(d.lineNum),o=[d.lineNum,r.text.length][0],a=i.unpack(n),s=i.opIterator(a[0]&&a[0].ops),c=!1,l=0;s.hasNext();){var u=s.next().lines;l+u<=o&&(c=!0),l+=u}if(c){if(!d.hlId)if(d.getIsLineShouldHideButton(d.lineNum))return void d.hideButton();setTimeout(function(){d.editor.call("changeBeforeLine")},0)}}},this.editor=t,this.util=new v(t),this.handleEventBinding("on")}return a()(n,[{key:"handleEventBinding",value:function(e){this.editor[e]("handlePopupTop",this.handlePopupTop),this.editor[e]("handleTableColSelected",this.handleTableColSelected)}},{key:"onMouseAcross",value:function(e){var t,n,i,r=this.util,o=r.withInDocScope,a=r.binarySearchLineNu,s=r.getLineEntryTopBottom,c=r.getLineNumSelection,l=r.getLineEntry;o(e)?(t=a(e))<0||this.lineNum===t&&this.hlId||(n=c(this.lineNum=t,l(this.lineNum)),i=s(t).lineTop,this.hlId&&(this.clearHl(),this.addHl(n)),this.getIsLineShouldHideButton(t)?this.hideButton():this.showButton(t,i)):this.hideButton()}},{key:"getIsLineShouldHideButton",value:function(e){var t=this.util,n=t.getLineEntry,i=t.withInBlackList,r=t.getLineNumSelection,o=t.withInHideScope,a=t.getLineNumIsActiveComment;if(e<0)return!0;var s=n(e);return!!i(e)||(!(!s.text||s.text.length!==s.lineMarker)||(!s.text||(!!a(r(e,s))||!!o(this.hideBottom,this.hideTop,this.lineNum))))}},{key:"showButton",value:function(e,t){this.editor.call(b,{lineNum:e,mouseY:t})}},{key:"hideButton",value:function(){this.resetLineNum(),this.clearHl(),this.editor.call(y)}},{key:"clearHl",value:function(){this.hlId&&this.editor.removeRange(this.hlId,"0"),this.hlId=null}},{key:"addHl",value:function(e){this.hlId=this.editor.addRange(e,c.e,null,null,["comment-range"])}},{key:"setSelectionBackground",value:function(t,e,n){var i=e.selEnd[0],r=n.getRep(e.selZone).lines.atIndex(i),o=r&&r.lineNode,a=o&&o.querySelector(".translate-line-container");n.getObserver().withoutRecordingMutations(function(){var e=a&&a.style;e&&(e.background=t)})}}]),n}()},"/cTv":function(e,t,n){},"/fVd":function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i=n("J4zp"),d=n.n(i),r=n("UXvI"),o=n("kohC"),h=n("AiBH"),s=n("OX8E"),c=n("2ACu"),f=n("tp5K"),a=[h.E.FILE,h.E.SHEET,h.E.MINDNOTE,h.E.BITABLE,h.E.SLIDE,h.E.BOX,h.E.WIKI];function p(){console.error("Instance EmbedObjPermissionManager is not existed")}function l(e){Object(c.default)("page_visit_embed_info_collect",{initially_request_embed_num:e.length})}function u(){var t=!0;return new o.a({onPermissionChange:function(e){t&&(l(e),t=!1);var o=0,a=0;e.forEach(function(e){var t,n,i=e.token,r=e.permission;r&&(t=r.cantRead,n=r.canInvite,t&&++o,n&&++a,b.hasEmbedObj(i)&&(b.cantReadFiles[i]=t,s.a.trigger(h.D,[i,t])))}),(o||a)&&Object(c.default)("page_visit_embed_info_collect",{self_can_not_access_doc_num:o,collaborator_can_not_access_doc_num:a})},onError:function(e){return console.error(e)}})}var g=1e3,m=500,v=500,b={embedObjCountMap:{},cantReadFiles:{},embedObjPermissionManager:null,embedObjMap:{},zoneToLineNodeIdMap:{},waitingIntoBufferMap:new Map,getInstance:function(){return this.embedObjPermissionManager},initEmbedObjMap:function(l){var u=this;this.recreateEmbedObjPermissionManager();var t=new RegExp("^mention-type_(".concat(a.join("|"),")$")),d=l.getMatchedAttributePositionOnSelection(null,function(e){return t.test(e)},{shouldMerge:!1});l.getMatchedAttributePositionOnSelection(null,function(e){return/mention-token/.test(e)},{shouldMerge:!1}).forEach(function(e){var r,t,n,i=e.attrKey,o=e.docPosition,a=o.selEnd,s=o.selStart,c=o.selZone;d.some(function(e){var t=e.attrKey,n=e.docPosition;if(n.selEnd[0]!==a[0]||n.selEnd[1]!==a[1]||n.selStart[0]!==s[0]||n.selStart[1]!==s[1]||n.selZone!==c)return!1;var i=t.split("_")[1];return r=h.v[i],!0}),r&&(t=Object(f.c)(i),u.embedObjCountMap[t]?++u.embedObjCountMap[t]:u.embedObjCountMap[t]=1,n=u.getTitle(s,a,c,l),u.embedObjMap[t]={token:t,type:r,title:n})})},getTitle:function(e,t,n,i){var r=i.selection.flatten([e[0],e[1],n]),o=i.selection.flatten([t[0],t[1],n]);return i.getRep(n).alltext.slice(r,o)},createEmbedObjPermissionManager:function(){this.embedObjPermissionManager||(this.embedObjPermissionManager=u())},destroyEmbedObjPermissionManager:function(){this.embedObjPermissionManager&&(this.embedObjPermissionManager.destroy(),this.embedObjPermissionManager=null,this.embedObjMap={},this.embedObjCountMap={},this.cantReadFiles={},this.addStash={},this.zoneToLineNodeIdMap={},this.waitingIntoBufferMap.clear())},embedObjPermissionManagerUpdateEmbedObjList:Object(r.default)(function(){this.embedObjPermissionManager&&this.embedObjPermissionManager.updateEmbedObjList(Object.values(this.embedObjMap))},v),recreateEmbedObjPermissionManager:function(){this.destroyEmbedObjPermissionManager(),this.createEmbedObjPermissionManager()},hasEmbedObj:function(e){return this.embedObjCountMap[e]&&this.embedObjMap[e]},addEmbedObj:function(e){if(!this.embedObjPermissionManager)return p();var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=a.num,c=a.obj,l=c.token,u=c.title;this.hasEmbedObj(l)?(this.embedObjCountMap[l]+=s,this.embedObjMap[l].title!==u&&(this.embedObjMap[l].title=u)):(this.embedObjCountMap[l]=s,this.embedObjMap[l]=c)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}},sendEmbedObjsToManager:function(e){var t;this.embedObjPermissionManager&&0<e.length&&(t=Object(f.b)(e).filter(function(e){return!!e}),this.embedObjPermissionManager.addEmbedObjs(t),Object(c.default)("page_visit_embed_info_collect",{total_request_embed_doc_num:t.length}))},debounceSendEmbedObjsToManager:Object(f.a)(function(e){return b.sendEmbedObjsToManager(e)},m,{maxWait:g}),removeEmbedObj:function(e){if(!this.embedObjPermissionManager)return p();var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.num,l=s.obj.token;this.embedObjCountMap[l]&&(this.embedObjCountMap[l]-=c,0===this.embedObjCountMap[l]&&(t.push(this.embedObjMap[l]),delete this.embedObjCountMap[l],delete this.embedObjMap[l]))}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}this.embedObjPermissionManager.removeEmbedObjs(t)},addStash:{},addTokenInStash:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a,s=r.value,c=d()(Object.entries(s)[0],2),l=c[0],u=c[1];this.addStash[l]?this.addStash[l].num+=u:(a={token:l,type:void 0,title:void 0},this.addStash[l]={num:u,obj:a})}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}},completeInStash:function(e){var t,n=e.token,i=e.type,r=e.title;!1===this.isCompleteInStash(n)&&((t=this.addStash[n].obj).type=i,t.title=r,this.execStashList())},removeFromStash:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=d()(Object.entries(s)[0],2),l=c[0],u=c[1];this.addStash[l]?this.addStash[l].num&&(this.addStash[l].num-=u,0===this.addStash[l].num&&delete this.addStash[l]):this.hasEmbedObj(l)&&t.push({num:u,obj:this.embedObjMap[l]})}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}this.removeEmbedObj(t)},isEmptyStash:function(){return!Object.keys(this.addStash).length},isCompleteInStash:function(e){return this.addStash[e]?Object.values(this.addStash[e].obj).every(function(e){return void 0!==e}):null},execStashList:function(){var t=this;if(!this.embedObjPermissionManager)return p();var n=[],e=Object.keys(this.addStash);0<e.length&&(e.forEach(function(e){t.isCompleteInStash(e)&&(n.push(t.addStash[e]),delete t.addStash[e])}),this.addEmbedObj(n))},fetchEmbedObjsPerm:function(){this.embedObjPermissionManager&&this.embedObjPermissionManager.fetchEmbedObjsAllPerm()}}},"/kQF":function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i=n("lwsE"),o=n.n(i),r=n("W8MJ"),a=n.n(r),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("nN3d"),p=n("D28M"),g=n("LghI"),m=n("y2sV"),v=8,b=function(e){function r(e,t){var n;o()(this,r),(n=c()(this,u()(r).call(this))).namespace="title__hiding-".concat(Object(f.c)(16));var i="\n      ".concat(e," > div:first-child.").concat(n.namespace," {\n        ").concat(t||"display: none;","\n      }\n    ").trim();return n.style=Object(p.c)(i),document.body.appendChild(n.style),n.isFirstTimeToEdit=!1,n}return h()(r,e),a()(r,[{key:"renderLine",value:function(e){return e.lineClass+=" ".concat(this.namespace),e.children}},{key:"aceKeyEvent",value:function(e,t){var n=t.evt,i=t.editorInfo;this.isFirstTimeToEdit||(this.isFirstTimeToEdit=!0,Object(g.h)());var r=n.type,o=n.keyCode;if("keydown"===r&&o===v&&(i.fastIncorp(),i.isCaret())){var a=i.getRep();if("0"===a.zoneId)if(a.lines.atIndex(1)){var s=a.selStart;return 1===s[0]&&0===s[1]?(n.preventDefault(),!0):void 0}}}},{key:"destroy",value:function(){document.body.removeChild(this.style)}}]),r}(m.p)},"/spq":function(e,t,n){"use strict";function i(a){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"pure";return function(e){var t=e;function i(o){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};a.forEach(function(e){var i=(t.editor||t)[s],r=o[e];o[e]=function(){if(!i){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(o,t)}}})}function n(e,t){var n=function(){return i(this,t),e.call(this,t)};return n.prototype=e.prototype,new n}var r=function(e){return n(t,e)};return r.prototype=t.prototype,r}}n.d(t,"a",function(){return i})},"093l":function(e,t,n){"use strict";function i(e){var t=!0;return function(){t?t=!1:e()}}n.d(t,"a",function(){return i})},"0Hpa":function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("cDf5"),p=n.n(f),m=n("XhtD"),g=n("q1tI"),v=n.n(g),b=n("i8i4"),y=n.n(b),E=n("FJEn"),O=n("lSNA"),C=n.n(O),k=n("RIqP"),I=n.n(k),S=n("hbEN"),T=n("puQj"),_=n.n(T),w=n("YWBl"),j=n("7Kxq"),M=n("F9bh"),L=n("LFUy"),R=n("HmyT"),N=n("OX8E"),D=n("Trbk"),x=n("soGB"),P=function(n,e,t,i){var r=t[0],o=t[t.length-1],a=[],s=n.getReps()[e],c=n.lineTracker.collapseLines;if(c){var l=c.trackers[e].entries,u=[];for(t.forEach(function(e){u.push(l[e].output.renderCollapsed)});u.includes(!0);){for(var d=r;d<=o;d++)if(l[d].output.renderCollapsed){for(var h=d;!l[h].output.startOfCollapseSection;)h--;a.push(h)}a.forEach(function(e){var t=Object(x.g)(e,s);Object(x.b)(n,t,!0,n.isEditable(),i)}),t.forEach(function(e,t){u.splice(t,1,l[e].output.renderCollapsed)})}}};function B(e){var t=new RegExp("([a-z]+)([123456789])").exec(e);return t?{type:t[1],indent:Number(t[2])}:null}function U(e){return e["clientside-collapse"]?"true"===e["clientside-collapse"]:"true"===e.collapse}var z=n("182n"),H=function(e){return Number(e.match(/\d+/)[0])},F=function(e){var t=/heading-(\S+)/.exec(e);return!!t&&z.a.includes(t[1])},V=n("y2sV"),W=n("Poi8"),K=n("PcuH"),Z=n("YNKm"),q=n("rPvU"),Y=n("+4eN"),J=n("kESg"),Q=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},X="IGNORE_HEADING",ee="MAX_HEADING_LEVEL_CHANGE",te="DocHeading",ne=E.config.PREFIX_LOCAL,ie=[].concat(I()(z.a),["code"]),re={22.75:"h1",19.25:"h2",17.5:"h3",15.75:"h4",14:"h5"},oe=/(font-size: (\d{2}.\d{1,2})px; )?letter-spacing: (-0.\d+)px/,ae="heading",se="collapse",ce="heading";function le(e,t){return-1<e.indexOf(t)}var ue=function(){function n(e,t){var y=this;r()(this,n),this.className="Heading",this.needUpdateCollapse=!1,this.headingCount={},this.headingMaxLevel=1,this.editor=null,this._bindEvent=function(){y._removeEvent(),y.bindEvent(),y.hasCollapse&&N.a.on("invokeCollapse",y.checkCollapse),y.editor&&y.editor.eventEmitter.on("lineTrackerUpdate",y.lineTrackerUpdateHandler)},this.lineTrackerUpdateHandler=function(e){var t,n;e.dirtyLines.length&&(t=e.dirtyLines[0].lineNum,n=e.dirtyLines[0].output.startOfCollapseSection,N.a.emit(D.a,{module:te,actionType:"DocHeadingToggle",data:{lineNum:t,isCollapse:n}}))},this._removeEvent=function(){y.removeEvent(),y.editor&&y.editor.eventEmitter.off("lineTrackerUpdate",y.lineTrackerUpdateHandler)},this.onHeadingMaxLevel=function(e){y.headingMaxLevel=e},this.getHeadingMaxLevel=function(){return y.headingMaxLevel},this.checkCollapse=function(e){var t,n,i=e.dom,r=e.multiRange,o=e.range,a=e.zoneId,s=e.source;y.editor&&(t=o,n=a||"",i&&(t=y.editor.domToRep(i),n=t.selStart[2]),n&&t&&y.notifyCollapse({sel:[t.selStart,t.selEnd],selZone:n,source:s}),n&&r&&r.forEach(function(e){y.notifyCollapse({sel:[e.start,e.end],selZone:n,source:s})}))},this.getTargetLineHTML=function(e,t,n,i){var r=y.editor.getRep(e).lines.atIndex(t);if(!r||!r.lineNode)return"";var o=document.createRange(),a=y.editor.selection.getPointForChatAtLeafNode(r,n,!0);return i&&r.lineNode.previousSibling?(o.setStart(r.lineNode.previousSibling,0),o.setEnd(a.node,a.index),o.cloneContents().lastElementChild.outerHTML):!i&&r.lineNode.nextSibling?(o.setStart(a.node,a.index),o.setEnd(r.lineNode.nextSibling,0),o.cloneContents().firstElementChild.outerHTML):""},this.isSelectionContainsCollapsedLine=function(t,e,n){return t===E.DEFAULT_REP_ZONE&&(y.editor.lineTracker.collapseLines&&Object(m.a)(e[0],n[0]+1).some(function(e){return!!y.checkIsLineCollapsed(t,e)}))},this.aceCopy=function(e,t){if(y.editor){var n=t.range,i=y.editor.getRep(),r=i.selEnd,o=i.selStart,a=i.lines.atIndex(r[0]);if(a){var s=a.text,c=a.lineMarker,l=a.domInfo;if(l){var u,d,h=l.lineClass,f=F(h),p=le(h,se);if(s.length===r[1]&&(o[1]===c&&o[0]===r[0]&&(d=!(u=!0)),o[0]<r[0]&&(d=u=!0)),f&&u&&p){var g,m=Object(R.$)("<div>");d||(g=Object(R.$)(a.lineNode).clone(!0),m.html(g[0]));var v=r[0]+1;n.push(v);var b=i.lines.atIndex(v);for(b&&(g=Object(R.$)(b.lineNode).clone(!0));g.hasClass("ace-line-collapsed");)g.removeClass("ace-line-collapsed"),m.append(g[0]),v+=1,(b=i.lines.atIndex(v))&&(g=Object(R.$)(b.lineNode).clone(!0));v>r[0]+1&&n.push(v-1),d?t.html+=m.html():t.html=m.html()}}}}},this.aceCut=function(e,t){return y.aceCopy(e,t)},this.aceCutRangeReplaceSeletion=function(e,t){var n=t.range,i=t.rep;i.selEnd&&i.attributeManager.getAttributeOnLine(i.selEnd[0],"heading")&&2===n.length&&y.cutCollapseRange(n)},this.cutCollapseRange=function(e){var t,n,i,r,o,a;y.editor&&(t=y.editor.performDocumentReplaceRangeWithAttributes,n=[e[0],0],i=e[1],(o=(r=y.editor.getRep()).lines.atIndex(i))&&(a=[i,o.text.length],t(r.zoneId,n,a,"",[])))},this.notifyCollapse=function(e){var t,n,i,r,o,a=e.sel,s=e.selZone,c=e.source,l=y.editor;l&&(t=a[0],n=a[1],i=[],o=t[0],r=n[0],s!==E.DEFAULT_REP_ZONE&&(o=r=l.getLineNumInRootZone(s,t)),i.push(o,r),i=I()(new Set(i)),P(l,E.DEFAULT_REP_ZONE,i,c))},this.aceDoDeleteKey=function(e,t){var n,i,r=t.editor,o=t.rep,a=t.caretLine;r.isCaret()&&(n=a(),i=o.lines.atIndex(n),o.selStart[1]===i.lineMarker||y.handleDeleteCollapse(r,o,n))},this.editorAfterDoDeleteKey=function(e,t){var n=t.editor,i=n.getRep(),r=i.selStart[0];y.handleDeleteCollapse(n,i,r)},this.handleDeleteCollapse=function(e,t,n){var i,r,o,a=e.getContentState().getActiveZone().getLine(n),s=a.getLineAttributes().toMap();s.list&&s.list.includes("code")||(i=Boolean(s.heading),a.isEmpty()||(r=U(s),(i||r)&&(o=Object(x.g)(n,t),y.editor&&y.editor.getAttributeOnLine(E.DEFAULT_REP_ZONE,n,se)&&Object(x.c)(e,o,!0,e.isEditable(),!1))))},this.aceRegisterBlockElements=function(){return ie},this.init=function(t){y._bindEvent(),[Z.r].concat(z.a).forEach(function(e,a){t.commands.registerAceCommand(e,function(e,t,n,i){var r=i.source,o=y.doInsertHeading({attribKey:ae,attribValue:"h".concat(a)});Object(w.a)({action:"heading-h".concat(a),op:o?j.g:j.f,source:r})},{statusKey:"heading-h".concat(a)})})},this.handleClick=function(e){e.data.context.ace.callWithAce(function(){y.doInsertHeading({attribKey:ae,attribValue:"h".concat(e.data.headingType+1)})},"insertheading",!0)},this.willChangesetApply=function(e,t){var n=t.editor,i=t.changeset,r=[],o=n.getApool();n.changesetHelper.eachAttribNumber(i,function(e){r.push(o.getAttribKey(e))}),y.needUpdateCollapse=!!r.find(function(e){return e===ce})},this.notifyHeadingCountChange=Object(S.default)(function(){for(var e=1,t=9;1<=t;t--){var n="h".concat(t);if(y.headingCount[n]){e=t;break}}y.headingMaxLevel!==e&&y.editor&&y.editor.call(ee,e),y.headingMaxLevel=e},200),this.hasKey=function(e,t){if(e)for(var n in e)if(e[n][0]===t)return!0;return!1},this.acePreWriteDomLineHTML=function(e,t){var n,i,r,o,a,s,c;t.info&&(i=(n=t.info).lineClass,r=n.lineMarker,a=(o=n.zone)&&o!==E.DEFAULT_REP_ZONE,s=i&&F(i)&&!le(i,"list-code"),c=i&&le(i,"single-line"),s&&(r&&1===r)&&y.hasCollapse&&!a&&!c&&(t.isPocket=!0))},this.aceShouldPocketReuse=function(e,t){var n=t.oldLineNode,i=t.newLineEntry,r=t.type,o=n.pocket.lineEntry,a=i.domInfo.lineClass;if(!le(a,"list-code")&&(F(a)&&F(o.domInfo.lineClass)&&y.hasCollapse))return!(o.domInfo.isCollapsedHeading()!==i.domInfo.isCollapsedHeading())&&"collapseble-header-handle"===r||void 0},this.findCollapsedSection=function(){if(y.editor){for(var e=y.editor.getRep().lines,t=e.numNodes,n=[],i=0;i<t;i++){var r,o,a,s=e.atIndex(i);s&&s.domInfo&&(o=(r=s.domInfo).collapseStatus,a=r.lineClass,F(a)&&!le(a,"list-code")&&(o.collapseOnlyMe||o.collapseAll&&!1!==o.collapseOnlyMe)&&n.push(i))}return n}},this.changesetApply=function(e,t){var n=t.editor,i=!y.needUpdateCollapse;n.lineTracker.doUpdate(i),y.needUpdateCollapse=!1},this.editorWillDoReturnKey=function(e){if(y.editor){var t=y.editor,n=t.getRep(),i=Object(Y.n)(t,n.zoneId);if(n.zoneId===E.DEFAULT_REP_ZONE||i===J.l.CalloutBlock){var r=n.selStart[0],o=n.selStart[1],a=n.lines.atIndex(r);if(a){var s=a.lineMarker;if(n.zoneId===E.DEFAULT_REP_ZONE)if(n.selStart[1]===s){var c=r<1?0:r-1;if(0===c)return;P(t,E.DEFAULT_REP_ZONE,[c])}else 0<Object(R.$)(a.lineNode).find(".collapsable-section-handle-collapsed").length&&Object(R.$)(a.lineNode).find(".collapsable-section-handle").click();var l=y.editor.getContentState().getActiveZone().getLine(r);if(l&&(o===s||o===l.length()-1)){var u=l.getLineAttributes().toMap();if(!!u.heading){var d=new V.E({zoneId:n.zoneId}),h=y.editor.selection.getSelection().toPosition(),f=h.start,p=h.len;if(o===l.length()-1){var g=!1;return e.delta.forEach(function(e){"*"===e.insert&&e.attributes&&e.attributes.lmkr&&e.attributes.heading&&(e.attributes.heading="",g=!0)}),g||e.delta.ops.length||(u.heading="",d.retain(f).delete(p).insertEnter().insertLineMarker(u)),void(e.delta=e.delta.compose(d))}y.editor.hasOtherAttribsOnLine(Object.entries(u),"heading")?d.retain(f-s).retain(s,{heading:""}):d.retain(f-s).retain(s,{heading:""}).delete(p).insertEnter().insertLineMarker(u),e.delta=e.delta.compose(d)}}}}}},this.updateCollapse=function(e,t,n){var a,s,c,l,i,u,d,r;e&&t&&0<t.length&&n&&(l=c=!(a=[]),t.length&&y.editor&&(i=y.editor.selection.getSelection(),u=i.start.line,d=i.end.line,t.length&&t.forEach(function(e,t){var n,i,r,o;!y.editor||(n=y.editor.getRep(E.config.DEFAULT_REP_ZONE).lines.atIndex(e.lineNum))&&(i=n.lineNode,r=n.domInfo,i&&(s=0===t?e.lineNum:s,o=e.output.renderCollapsed&&!e.output.startOfCollapseSection,a.push(e.lineNum),_.a.msie?(o&&Object(R.$)(i).addClass("ace-line-collapsed"),o||Object(R.$)(i).removeClass("ace-line-collapsed")):i.classList.toggle("ace-line-collapsed",o),o&&e.lineNum>=u&&e.lineNum<=d&&(l=!0)),e.output.startOfCollapseSection&&0===t&&r&&(c="boolean"==typeof r.collapseStatus.collapseOnlyMe?r.collapseStatus.collapseOnlyMe:r.collapseStatus.collapseAll))}),(r=y.editor.plugins.sheetBridge.getBridge())&&r.syncVirtualScroll(),N.a.trigger("collapseLineChange",[{startOfCollapseSection:s,collapseRange:a,collapsed:c}]),l&&window.getSelection().removeAllRanges()))},this.performUndoRedo=function(){var e;y.editor&&(e=!y.needUpdateCollapse,y.editor.lineTracker.doUpdate(e),y.needUpdateCollapse=!1)},this.lineTrackerUpdate=function(e,t){var n=t.isDirtyZone,i=t.dirtyLines,r=t.root;y.updateCollapse(n,i,r)},this.collectContentPre=function(e,t){var n,i,r=t.state,o=t.cls,a=t.styl,s=t.tname,c=y.getHeadingType(s,o||"",a||""),l=r.lineAttributes,u=y.getCollapseType(o||"");t.styl&&_.a.safari&&((n=oe.exec(t.styl))&&(i=re[n[2]||14],l[ae]=i)),c&&(l[ae]=c),u&&("collapse-all"===u&&t.cc.doAttrib(r,se,"true"),"collapse-onlymenot"===u&&t.cc.doAttrib(r,"".concat(ne,"collapse"),"false"),"collapse-onlyme"===u&&t.cc.doAttrib(r,"".concat(ne,"collapse"),"true"))},this.collectContentPost=function(e,t){var n=t.state.lineAttributes,i=t.cls,r=t.styl,o=t.tname;y.getHeadingType(o,i||"",r||"")&&delete n[ae]},this.removeCollapse=function(e){var t,n,i,r,o,a;y.editor&&((t=y.editor.getRep()).zoneId!==E.DEFAULT_REP_ZONE||(n=t.lines.atIndex(e))&&(i=n.text,r=[e,n.lineMarker],o=[e,i.length],a=[[se,""]],t.attributeManager.setAttributesOnRange(r,o,a)))},this.getHeadingType=function(e,t,n){if(t){var i=/(?:^| |Mso)[hH]eading-?(\S+)/.exec(t);if(i){var r="h".concat(i[1].replace(/[^\d]/g,""));if(z.a.includes(r))return r}}return/^h[1-9]$/.test(e)?e:null},this.getCollapseType=function(e){if(e){var t=/collapse-([a-z]{3,})/.exec(e);if(t)return t[0]}},this.deserialize=function(e){var t=e.node,i=e.deltaSet,r=e.zoneId;if(t instanceof HTMLElement){var n=t.tagName,o=t.className,a=t.getAttribute("style")||"",s=y.getHeadingType(n.toLowerCase(),o,a),c=i;s&&(c=Object(V.I)(c,r,C()({},ae,s)));var l=y.getCollapseType(o),u=function(e,t){var n=c||i;return Object(V.H)(n,r,C()({},e,t))};if(l){if("collapse-all"===l)return u(se,"true");if("collapse-onlymenot"===l)return u("".concat(ne,"collapse"),"false");if("collapse-onlyme"===l)return u("".concat(ne,"collapse"),"true")}return c}return i},this.editorWillPaste=function(e){var t=e.deltaSet,n=e.zoneId;if(e.lineState.isEmpty())return t;var i=t.get(n),r=i.ops[0];return r&&r.attributes&&r.attributes.heading&&(r.attributes.list||delete r.attributes.heading,Object(q.a)(r.attributes)&&i.ops.shift()),t},e&&(this.hasCollapse=!!t&&t.hasCollapse,this.editor=e)}return a()(n,[{key:"match",value:function(e){return["heading","clientside-collapse",se].includes(e)}},{key:"reset",value:function(){this._removeEvent(),this.editor=null,N.a.off("invokeCollapse",this.checkCollapse)}},{key:"clientVars",value:function(){if(this.editor){var e=this.editor.getMatchedAttributePositionOnSelection(null,function(e){return"heading"===e}),t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value.attrValue;this.headingCount[a]=1+(this.headingCount[a]||0)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}this.notifyHeadingCountChange()}}},{key:"render",value:function(e){var t=e.attributes,n=e.children,i=e.lineState,r=i.getZoneId(),o=i.getLineAttributes().toMap(),a=!!o.heading,s=r!==E.DEFAULT_REP_ZONE,c=o.list&&o.list.includes("code"),l=!!t.dataMetaBlockProps,u=t[ne+se],d="true"===u,h=i.getText();return!a||s||!this.hasCollapse||c||l||(u?(e.domLine.collapseStatus.collapseOnlyMe=d,e.lineClass+=" collapse-onlyme".concat(d?"":"not")):t[se]&&"true"===t[se]?(e.domLine.collapseStatus.collapseAll=!0,e.lineClass+=" ".concat(se,"-all")):h||!1!==e.domLine.collapseStatus.collapseOnlyMe||(e.lineClass+=" collapse-onlymenot")),n}},{key:"editorAlinesDidSplice",value:function(e,t){var n,i,r=t.start,o=t.deleteCount,a=t.prevState,s=t.currentState,c=t.editor,l=t.zoneId;this.needUpdateCollapse||(i=(n=c.callStack.getCurrentCallStack())&&n.type===x.a,this.needUpdateCollapse=i||this.hasKey(a.numToAttrib,se)||this.hasKey(s.numToAttrib,se)||this.hasKey(a.numToAttrib,ce)&&!this.hasKey(s.numToAttrib,ce)),c.lineTracker.splice(l,r,o,s.alinesSplice);var u,d=this.getHeadingCountChange(a,s);for(u in d)this.headingCount[u]=(this.headingCount[u]||0)+d[u];this.notifyHeadingCountChange()}},{key:"renderLine",value:function(e){var t=e.lineState,n=e.children,i=t.getLineAttributes().toMap().heading;return i&&ie.includes(i)&&(e.lineClass+=" heading-".concat(i," ace-line")),n}},{key:"doInsertHeading",value:function(e){var i=this,r=e.attribKey,o=e.attribValue,a=e.range,s=e.isAllHasAttrib,t=o?o.slice(1):-1;if(!(0<=t&&void 0===ie[t])&&a&&a.selEnd&&a.selStart){var n=a.selStart,c=a.selEnd,l=a.attributeManager,u=a.zoneId,d=Object(m.a)(n[0],c[0]+1),h=[],f=this.editor&&Object(W.i)(this.editor,u),p=!0,g=!0;return d.forEach(function(e){var t,n=a.lines.atIndex(e);!n||!n.lineNode||-1<n.lineNode.className.indexOf(X)||-1<n.lineNode.className.indexOf(j.b)||Object(L.a)(n.lineNode)||(f||i.editor&&Object(W.f)(i.editor,u,e)?s=p=!1:h.push(e),p&&i.editor&&(t=i.editor.getAttributeOnLine(u,e,r),p=t===o,t&&(g=!1)))}),s||p||o===Z.r?o===Z.r&&g||(l.removeAttributeOnMultiLines(d,r),this.hasCollapse&&d.forEach(function(e){i.removeCollapse(e)})):l.setAttributeOnMultiLinesExcludeAttrs(h,[[r,o]],[["aceTable",""]]),this.editor&&K.a.tryConvertZone(this.editor,a,r,o),s}}},{key:"editorWillCopy",value:function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g=this.editor;g&&(t=e.range,n=e.deltaSet,i=t.end,r=i.line,o=i.offset,a=i.zoneId,n.forEach(function(e){e instanceof V.E&&e.forEach(function(e){e.attributes&&("true"!==e.attributes[se]&&"true"!==e.attributes["".concat(ne).concat(se)]||(delete e.attributes[se],delete e.attributes["".concat(ne).concat(se)]))})}),s=g.getContentState(),(c=s.getLineAttributes(a,r).toMap().heading)&&(!(l=s.getZoneState(a))||(u=l.getLine(r))&&u.getAttributes(0,u.length()-1).toMap().collapse&&o>=u.length()-1&&(d=l.getContent(),h=r,d.eachLine(function(e,t,n){if(r<n){if(t.heading&&H(t.heading)<=H(c))return!1;h++}return!0}),(f=l.getLine(h))&&(p={zoneId:a,line:h,offset:f.length()-1},t.end=p,e.range=t,e.deltaSet=g.clipboard.slice(t)))))}},{key:"serialize",value:function(e){var t,n=e.type,i=e.node,r=e.lineAttributes,o=r&&r[ce];return n===V.u.LINE&&o&&((t=H(o)<=6?document.createElement(o):document.createElement("span")).appendChild(i),t.classList.add("".concat(ce,"-").concat(o)),e.node=t),e}},{key:"isHeadingLine",value:function(e){return e.hasLineMarker()&&e.getLineAttributes().toMap().heading}},{key:"alineToLineInput",value:function(e,t){if(t&&"string"==typeof t.value){var n=B(t.value);if(!n)return;var i=n.type,r=n.indent;if("h"===i&&"number"==typeof r&&0<r&&r<=9)return r}}},{key:"checkIsLineCollapsed",value:function(e,t){if(void 0!==t&&this.editor){var n=this.editor.lineTracker;if(e&&e!==E.DEFAULT_REP_ZONE||!n||!n.collapseLines||!n.collapseLines.trackers[E.DEFAULT_REP_ZONE])return!1;var i=n.collapseLines.trackers[E.DEFAULT_REP_ZONE].entries[t].output,r=i.renderCollapsed,o=i.startOfCollapseSection;return r&&!o}}},{key:"getHeadingCountChange",value:function(e,t){var n,i,r=this.getHeadingCountByState(e),o=this.getHeadingCountByState(t),a={};for(n in Object.assign({},r,o))(r[n]||o[n])&&(i=(o[n]||0)-(r[n]||0),a[n]=i);return a}},{key:"getHeadingCountByState",value:function(e){var t={},n=!0,i=!1,r=void 0;try{for(var o,a=e.alinesAttribs[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=!0,l=!1,u=void 0;try{for(var d,h=s[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var f=d.value;if("heading"===f[0]){var p=f[1];t[p]=1+(t[p]||0);break}}}catch(e){l=!0,u=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw u}}}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}}]),n}();Q([Object(M.a)({ignoreAttrs:[["aceTable"]]})],ue.prototype,"doInsertHeading",null);var de=n("SyrE"),he=n("SGN9"),fe=n("G8Hj"),pe=n("2ACu"),ge=n("TSYQ"),me=n.n(ge),ve=n("UlbS"),be=n("FI0B"),ye=function(e){function t(e){var n;return r()(this,t),(n=c()(this,u()(t).call(this,e))).handleToggleRef=function(e,t){n.hideTooltip=t},n.state={isCollapsed:e.line.domInfo.isCollapsedHeading()},n}return h()(t,e),a()(t,[{key:"updateIsCollapsed",value:function(e){this.setState({isCollapsed:e})}},{key:"render",value:function(){var t=this,e=this.props,n=e.container,i=e.onClick,r=e.etherpadContainer,o=this.state.isCollapsed?x.d.expandSection:x.d.collapseSection,a=me()("collapsable-section-handle",{"collapsable-section-handle-collapsed":this.state.isCollapsed,"hpx-button":!0}),s=["bottom"],c=[!0,"check-viewport"],l={padding:"4px 6px",pointer_events:"none"};return v.a.createElement(ve.Tooltip,{title:o,placement:"bottom",tooltipClassName:"ignore-dom editor_toggle_button",adjustPlacements:s,adjustOverflow:c,getContainer:function(){return Object(R.$)(document.body).hasClass("fs-mode-non-paged")?n:r||null},style:l,onTooltipMouseEnter:function(e){setTimeout(function(){t.hideTooltip()},0)},toggleRef:this.handleToggleRef,gap:3,showDelay:500},v.a.createElement("button",{className:a,onClick:i,dir:"auto","data-track-title":"collapse-section"},v.a.createElement("span",{className:"dmc-button-content"},v.a.createElement("span",{className:"icon-wraper"},v.a.createElement(be.a,null)))))}}]),t}(g.PureComponent);n("H3z/");n.d(t,"a",function(){return ke});var Ee=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Oe="collapseble-header-handle";function Ce(e,t){return-1<e.indexOf(t)}var ke=function(e){function n(e,t){var C;return r()(this,n),(C=c()(this,u()(n).call(this,e,t))).guideCount=0,C.lineNumberForPaste=-1,C.lineForPasteIsCollapse=null,C.getTargetLineHTML=function(e,t,n,i){var r=C.editor.getRep(e).lines.atIndex(t);if(!r||!r.lineNode)return"";var o=document.createRange(),a=C.editor.selection.getPointForChatAtLeafNode(r,n,!0);if(i){var s=r.lineNode,c=s.previousSibling||s;return o.setStart(c,0),o.setEnd(a.node,a.index),o.cloneContents().lastElementChild.outerHTML}return!i&&r.lineNode.nextSibling?(o.setStart(a.node,a.index),o.setEnd(r.lineNode.nextSibling,0),o.cloneContents().firstElementChild.outerHTML):""},C.isSelectionContainsCollapsedLine=function(t,e,n){return t===E.DEFAULT_REP_ZONE&&(C.editor.lineTracker.collapseLines&&Object(m.a)(e[0],n[0]+1).some(function(e){return!!C.checkIsLineCollapsed(t,e)}))},C.aceCopy=function(e,t){if(C.editor){var n=t.range,i=C.editor.getRep(),r=i.selEnd,o=i.selStart,a=i.zoneId,s=i.lines,c=i.lines.atIndex(r[0]);if(c&&c.domInfo){var l=c.text,u=c.lineMarker,d=c.domInfo.lineClass,h=F(d),f=Ce(d,"collapse"),p=null,g=null;if(o[0]===r[0]&&h&&f&&u===o[1]&&l.length===r[1]){p=g=o[0];var m=C.editor.lineTracker.collapseLines;if(!m)return;for(;g+1<s.length();){var v=m.getCollapsedStatusOfLine(a,g+1);if(!v||v.startOfCollapseSection||!v.renderCollapsed)break;g++}n.push(p),n.push(g)}var b,y,E="",O="";o[0]!==r[0]&&C.isSelectionContainsCollapsedLine(a,o,r)&&(p=o[0]+1,g=r[0]-1,(b=i.lines.atIndex(o[0]))&&b.text.length!==o[1]&&(E=C.getTargetLineHTML(a,o[0],o[1],!1)),c.lineMarker!==r[1]&&(O=C.getTargetLineHTML(a,r[0],r[1],!0))),null!==p&&null!==g&&(y="",s.traverseEntries(p,g,function(e){y+=e.lineNode.outerHTML}),t.html=E+y+O)}}},C.bindEvent=function(){C.editor&&$(C.editor.getInnerContainer()).on("mouseenter",'[class*="collapsable-section-handle"]',C.onBoarding),de.g.on("".concat(D.g,":").concat(te),C.onVCFollowHandler),Object(pe.default)("bind_vc_event",{module:te,operation:"on"})},C.removeEvent=function(){C.editor&&$(C.editor.getInnerContainer()).off("mouseenter",'[class*="collapsable-section-handle"]',C.onBoarding),de.g.off("".concat(D.g,":").concat(te),C.onVCFollowHandler),Object(pe.default)("bind_vc_event",{module:te,operation:"off"})},C.onVCFollowHandler=function(e){var t,n,i,r,o=e.actionType,a=e.data;"DocHeadingToggle"===o&&C.editor&&(t=a.lineNum,n=a.isCollapse,(i=C.editor.getRep().lines.atIndex(t))&&i.domInfo&&(i.domInfo.isCollapsedHeading()===n||!i.lineNode||(r=i.lineNode.querySelector(".collapsable-section-handle"))&&r.click()))},C.onBoarding=function(e){var t,n,i;e.target&&(i="toggle-heading-btn"===(n=(t=$(e.target)).hasClass("collapsable-section-handle")?t:t.closest(".collapsable-section-handle")).attr("data-selector"),n.length&&0===C.guideCount&&!i&&(n.attr("data-selector","toggle-heading-btn"),Object(he.b)(fe.STEP_TYPES.toggle_heading_intro),C.guideCount++))},C.beforeFullscreenEnter=function(e,t){var n,i;1===t.mode&&C.editor&&(n=C.findCollapsedSection(),i=C.editor.getRep(),n&&n.forEach(function(e){var t=Object(x.g)(e,i);C.editor&&Object(x.b)(C.editor,t,!0,C.editor.isEditable())}))},C.beforeFullscreenModeChange=C.beforeFullscreenEnter,C.addPocketToLine=function(e,t){var n,i,r,l,o,u=t.editor,a=t.lineEntry,s=t.linePocket;C.editor&&a&&a.domInfo&&(Ce(n=a.domInfo.lineClass,"list-code")||F(n)&&C.hasCollapse&&a.lineNode&&a.zone===E.DEFAULT_REP_ZONE&&(i=$(a.lineNode).find(".ace-line-pocket")[0],r=$("#editorcontainerbox")[0],l=v.a.createRef(),o=function(e){var t,n,i,r,o,a,s,c=$(e.target).closest(".ace-line");!c.length||(t=u.domToRep(c.get(0)))&&(n=t.selStart[0],i=t.selStart[2],(r=u.getRep(i).lines.atIndex(n))&&r.domInfo&&(o=r.lineMarker,a=!!r.domInfo.isCollapsedHeading(),s=Object(x.h)(t,o),Object(x.i)(u,s,a,e),l&&l.current&&l.current.updateIsCollapsed(!a)))},s.put([{uniqueClass:Oe,mount:function(e){y.a.render(v.a.createElement(ye,{editor:u,line:a,container:i,etherpadContainer:r,onClick:o,ref:l}),e)},onReuse:function(e){l&&l.current&&e.domInfo&&l.current.updateIsCollapsed(!!e.domInfo.isCollapsedHeading())},unmount:function(e){y.a.unmountComponentAtNode(e)}}])))},C.getPocketTypesOfLine=function(e,t){var n=t.lineEntry.domInfo.lineClass;if(!Ce(n,"list-code")&&F(n)&&C.hasCollapse)return Oe},e&&C.init(e),C}return h()(n,e),a()(n,[{key:"acePaste",value:function(e,t){var n=t.rep,i=n.selStart;i&&(this.lineNumberForPaste=i[0],this.lineForPasteIsCollapse="true"===n.attributeManager.getAttributeOnLine(this.lineNumberForPaste,"collapse"))}},{key:"afterPaste",value:function(e,t){var n=t.rep,i=n.selStart,r=n.zoneId,o="true"===n.attributeManager.getAttributeOnLine(this.lineNumberForPaste,"collapse");(0<=this.lineNumberForPaste&&i[0]!==this.lineNumberForPaste&&o||!1===this.lineForPasteIsCollapse&&o)&&N.a.emit("invokeCollapse",{zoneId:r,range:{selStart:[this.lineNumberForPaste,0],selEnd:[this.lineNumberForPaste,0]},source:"paste"}),this.lineNumberForPaste=-1}},{key:"editorWillDoReturnKey",value:function(e){var t,n,i=e.delta,r=e.editor,o=r.selection.getSelection(),a=r.getContentState().getActiveZone(),s=a.getZoneId(),c=a.getLine(o.start.line),l=c.getLineAttributes().toMap(),u=o.toPosition(),d=u.start,h=u.len,f=c.isEndOfLine(o.end.offset);l.heading&&!h&&(t=c.isEmpty(),n=new V.E({zoneId:s}),i.ops.length?t||n.retain(d+1).retain(1,{heading:f?"":l.heading}):(f&&(l.heading=""),n.retain(d).insertEnter().insertLineMarker(l)),e.delta=i.compose(n))}},{key:"editorWillDoDeleteKey",value:function(e){var t,n,i,r,o,a,s=e.deltaSet,c=e.editor,l=c.selection.getSelection(),u=c.getContentState().getActiveZone(),d=u.getZoneId(),h=u.getLine(l.start.line),f=h.previousSibling(),p=h.getLineAttributes().toMap(),g=l.toPosition(),m=g.start,v=g.len,b=1===l.start.offset;f&&!v&&p.heading&&b&&(t=Number(f.hasLineMarker()),n=f.isEmpty(),i=f.getLineAttributes().toMap(),r=Object.keys(i).find(function(e){return!["author","lmkr","insertorder","lineguid","align"].includes(e)}),o=s.get(d).ops.length,r||!n||o||(a=new V.E({zoneId:d}),(t?a.retain(m-3).retain(1,Object.assign({},i,{heading:p.heading})):a.retain(m-2).insertLineMarker(Object.assign({},i,{heading:p.heading}))).delete(2),e.deltaSet=s.compose(a)))}}]),n}(ue);Ee([Object(V.J)(500)],ke.prototype,"editorWillDoDeleteKey",null)},"0X7r":function(e,t,n){"use strict";var i=n("J4zp"),o=n.n(i),r=n("lwsE"),a=n.n(r),s=n("W8MJ"),c=n.n(s),f=n("LrWZ"),p=n("Muja"),l=n("Mpt7"),u=n("D7h9"),d=n("WzBf"),h=n("MUo5"),g=n("5cZX"),m=function(){function e(){a()(this,e),this.instances={}}return c()(e,[{key:"reroll",value:function(e){var t=this.getUserList(e),n=this.selectPermissions(e),i=[],r=!0,o=!1,a=void 0;try{for(var s,c=n.keys()[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;t.has(l)||i.push(l)}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}i.length&&u.default.dispatch(Object(h.removeAuthorizedUsers)(e,i))}},{key:"selectPermissions",value:function(e){var t=Object(g.K)(u.default.getState()).getIn([e,"authorizedUsers"]);return t||Object(l.Map)({})}},{key:"getUserList",value:function(e){var t=new Set,n=!0,i=!1,r=void 0;try{for(var o,a=this.instances[e][Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.getUsers(),c=!0,l=!1,u=void 0;try{for(var d,h=s[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var f=d.value;t.add(f)}}catch(e){l=!0,u=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw u}}}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}},{key:"ensureToken",value:function(e){this.instances[e]||(this.instances[e]=new Set)}},{key:"add",value:function(e,t){this.ensureToken(e),this.instances[e].add(t),this.reroll(e)}},{key:"delete",value:function(e,t){this.ensureToken(e),this.instances[e].delete(t),this.reroll(e)}},{key:"destroyToken",value:function(e){delete this.instances[e]}}]),e}(),v=n("vc5i"),b=n("eL/v"),y=n("IyQe"),E=n("/PhZ"),O=n("o0o1"),C=n.n(O),k=n("yXPU"),I=n.n(k),S=n("2spZ"),T=10,_=new(function(){function e(){a()(this,e),this.fetchingStatus={},this.pendingUserMap=new Map}function t(e,t){return n.apply(this,arguments)}var n;return c()(e,[{key:"addPendingUserList",value:function(e,t,n){var i,r=this.pendingUserMap.get(e);r=r?(i=n.filter(function(e){return!r.includes(e)}),r.concat(i)):n,this.pendingUserMap.set(e,r),this.startFetchUserPerm(e,t)}},{key:"startFetchUserPerm",value:function(e,t){this.fetchingStatus[e]||(this.fetchingStatus[e]=!0,this.fetchUserPerm(e,t))}},{key:"fetchUserPerm",value:(n=I()(C.a.mark(function e(t,n){var i,r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=this.pendingUserMap.get(t))&&0!==i.length){e.next=4;break}return this.fetchingStatus[t]=!1,e.abrupt("return");case 4:return r=i.splice(0,T),u.default.dispatch(Object(h.fetchAuthorizedUsers)(t,n,r)),e.next=8,Object(S.c)(1e3);case 8:this.fetchUserPerm(t,n);case 9:case"end":return e.stop()}},e,this)})),t)}]),e}()),w=new m;function j(e){return{token:"PERMISSION_CHANGE_".concat(e),resourceType:"PERMISSION_CHANGE",routeType:"token",routeKey:e}}var M=function(){function r(e){var h=this,t=e.userList,n=e.onPermissionChange,i=e.onError;a()(this,r),this.ready=!1,this.envInfos=null,this.onError=function(){},this.oldPermissions=Object(l.Map)({}),this.oldUserList=new Set,this.handleStoreChangeForNetworkState=function(){var e=Object(b.a)(u.default.getState());e&&!h.isOnline?(h.isOnline=e,h.fetchUserPermissions()):h.isOnline=e},this.handleStoreChangeForPermission=function(){if(h.ready){var e=h.selectPermissions();if(e!==h.oldPermissions||!Object(p.default)(h.userList,h.oldUserList)){var n=h.oldUserList,t=h.oldPermissions.filter(function(e,t){return n.has(t)});h.oldPermissions=e,h.oldUserList=new Set(h.userList);var i={},r=!0,o=!1,a=void 0;try{for(var s,c=h.userList[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value,u=h.userList.has(l)&&e.get(l),d=t.get(l);Object(f.a)(u)&&!Object(f.a)(d)?i[l]=null:(!Object(f.a)(u)&&Object(f.a)(d)||u!==d)&&(i[l]=null!=e.get(l)?e.get(l):null)}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}Object.keys(i).length&&h.emitChanges(i)}}else h.checkEnvReady()},this.handleMessage=function(){h.fetchUserPermissions()},this.userList=new Set(t),this.onPermissionChange=n,i&&(this.onError=i),this.unsubscribePermission=u.default.subscribe(this.handleStoreChangeForPermission),this.unsubscribeNetworkState=u.default.subscribe(this.handleStoreChangeForNetworkState),this.isOnline=Object(b.a)(u.default.getState()),this.checkEnvReady()}return c()(r,[{key:"bootstrap",value:function(){var e=this.envInfos.token,t=j(e);d.a.register(t,this.handleMessage),w.add(e,this)}},{key:"checkEnvReady",value:function(){var e=u.default.getState(),t=Object(v.n)(e),n=Object(v.o)(e);Object(f.a)(t)||Object(f.a)(n)||(this.ready=!0,this.envInfos={token:t,suiteType:n},this.bootstrap(),this.fetchUserPermissions())}},{key:"fetchUserPermissions",value:function(e){var t,n,i,r;this.ready&&this.isOnline&&(n=(t=this.envInfos).token,i=t.suiteType,r=e||Array.from(this.userList),_.addPendingUserList(n,i,r))}},{key:"emitChanges",value:function(e){var r=this,t=Object.entries(e).map(function(e){var t=o()(e,2),n=t[0],i=t[1];return{userId:n,permission:null!=i?r.convert(i):null}});this.onPermissionChange(t)}},{key:"convert",value:function(e){return Object(y.permission2Booleans)(e)}},{key:"selectPermissions",value:function(){if(!this.ready)return Object(l.Map)({});var e=this.envInfos.token,t=Object(g.K)(u.default.getState()).getIn([e,"authorizedUsers"]);return t||Object(l.Map)({})}},{key:"updateUserPerm",value:function(e){this.fetchUserPermissions(e)}},{key:"updateUserList",value:function(e){var t=new Set(e);Object(p.default)(this.userList,t)||(this.userList=t,this.fetchUserPermissions())}},{key:"addUsers",value:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.userList.has(s)||(this.userList.add(s),t.push(s))}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}0<t.length&&this.fetchUserPermissions(t)}},{key:"fetchUsers",value:function(e){return u.default.dispatch(Object(E.fetchUserDetail)({mentioned_users:e}))}},{key:"removeUsers",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;this.userList.has(a)&&this.userList.delete(a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"getUsers",value:function(){return Array.from(this.userList)}},{key:"getUserPermissions",value:function(){var e=this.selectPermissions(),t={},n=!0,i=!1,r=void 0;try{for(var o,a=this.userList[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t[s]=e.has(s)?this.convert(e.get(s)):null}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}},{key:"getPermissionByUser",value:function(e){var t=this.selectPermissions();return t.has(e)?this.convert(t.get(e)):null}},{key:"destroy",value:function(){var e,t;this.userList.clear(),this.unsubscribePermission&&this.unsubscribePermission(),this.unsubscribeNetworkState&&this.unsubscribeNetworkState(),this.ready&&(t=j(e=this.envInfos.token),d.a.deregister(t,this.handleMessage),w.delete(e,this))}}],[{key:"destroyToken",value:function(e){w.destroyToken(e)}}]),r}();t.b=M},"0bqa":function(e,f,p){"use strict";(function(i){p.d(f,"a",function(){return h});var e=p("J4zp"),z=p.n(e),t=p("lwsE"),r=p.n(t),n=p("W8MJ"),o=p.n(n),y=p("OZf9"),H=p("3Hq1"),F=p("owWc"),V=p("HmyT"),W=p("15MJ"),m=p("ibWA"),v=p("jVwk"),a=p("puQj"),s=p.n(a),b=p("Z/PY"),c=p("YWjA"),K=p("2ACu"),E=p("+4/E"),O=p("OX8E"),l=p("Ngi8"),C=p("7Kxq"),Z=p("Tqb2"),k=p("dn8U"),u=p("SebV"),d=500,h=function(){function a(e){var n=this;r()(this,a),this.updateProgressStyle=function(e){var t=n.uuid;a.updateProgressStyle(t,e)},this.ace=a.ace,this.uuid=e}return o()(a,null,[{key:"initAce",value:function(e){a.ace=e}},{key:"destroy",value:function(){a.ace=null}}]),o()(a,[{key:"performImagePreviewer",value:function(n){var e=this.ace;e.editorInfo.fastIncorp();var t,i,r,o=e.editorInfo,a=o.getRep(),s=a.selStart||[1,0],c=a.selEnd||[1,0];s[0]!==c[0]||(t=a.lines.atIndex(s[0]))&&(i="single-line"===t.domInfo.lineManagerType,r=!!t.getInstanceByName(C.e.ACE_TABLE),(i||r)&&(c=s=[s[0],t.width-1],o.selection.setWithSelection(a.zoneId,s,c,!1)));var l=Object(v.a)(a,{selStart:s,selEnd:c});Object(b.v)(a.zoneId,s[0],o)&&"\n"!==l.slice(0,1)&&(l="\n"+l);var u=" ",d=Object(m.a)(l,u),h=o.getAttributesOnPosition(a.zoneId,s[0],1),f=h.some(function(e){return"blockquote"===z()(e,1)[0]}),p="\n"===l[0],g=d.map(function(e,t){return{start:0===t?s:c,end:c,newText:e,attributes:e===u?n:[]}});p&&f&&g.splice(1,0,{start:s,end:s,newText:"*",attributes:h.filter(function(e){return"blockquote"===e[0]||"lmkr"===e[0]})}),O.a.emit("invokeCollapse",{multiRange:g,zoneId:a.zoneId,source:"insert_image_previewer"}),o.performDocumentReplaceMultiRangeWithAttributes(a.zoneId,g)}},{key:"createDataURL",value:function(i){return new Promise(function(t,n){var e=new FileReader;e.readAsDataURL(i),e.onload=function(e){t(e.target.result)},e.onerror=function(e){n(e)}})}},{key:"createObjectURL",value:function(n){return new Promise(function(e,t){try{e(URL.createObjectURL(n))}catch(e){t(e)}})}},{key:"setImageRectByDirection",value:function(e){var t=e.direction,n=e.alignment,i=e.imageSize,r=e.moveVector,o=e.imageMaxWidth,a=Object(b.d)({direction:t,alignment:n,imageSize:i,moveVector:r,imageMaxWidth:o}),s=a.width,c=a.height;s===i.width&&c===i.height||this.setImageStyle(s,c)}},{key:"setImageStyle",value:function(e,t){var n=4,i=this.ace.editorInfo.getScrollContainer(),r="container-wrap-image-upload-image-"+this.uuid,o=i.scrollTop,a=r+"-rect-style";Object(V.$)("#"+a).remove(),Object(V.$)("body").append("\n      <style id=".concat(a,">\n        #innerdocbody .gallery #").concat(r," {\n          width:").concat(e+n,"px!important;\n        }\n        #innerdocbody .gallery #").concat(r," img {\n          width:").concat(e+n,"px!important;\n        }\n        #innerdocbody .image-container-wrap-old#").concat(r," > div {\n          width:").concat(e+n,"px!important;\n        }\n        #innerdocbody .image-container-wrap-old#").concat(r," img {\n          width:").concat(e,"px!important;\n        }\n      </style>\n    ")),i.scrollTop=o}},{key:"applyImageStyle",value:function(e,t){var n=this.ace,i=this.uuid,r=n.editorInfo,o=Object(V.$)("#".concat(e)),a=r.dom.zoneOfRootNode(r.dom.rootNodeOfZoneContaining(o.get(0))),s=o.find("img");if(o.length){var c={},l=s.width(),u=0;try{u=parseInt(s.attr("style").split(";")[0].match(/\d+/)[0])}catch(e){}var d=s.height();if(c[i]={width:l,height:d},t.length){var h=!0,f=!1,p=void 0;try{for(var g,m=t[Symbol.iterator]();!(h=(g=m.next()).done);h=!0){var v=g.value,b=Object(V.$)("#".concat(v)).find("img"),y=b.width(),E=b.height(),O=v.split("-"),C=O[O.length-1];c[C]={width:y,height:E}}}catch(e){f=!0,p=e}finally{try{h||null==m.return||m.return()}finally{if(f)throw p}}}var k,I,S,T,_,w,j,M,L,R,N,D,x,P=encodeURIComponent(s.attr("data-src")),B=["src=".concat(P,"&uuid=").concat(i,"&pluginName=").concat(W.s,"&height=").concat(d,"px&width=").concat(l,"px")],U=Object(Z.o)({uuid:i},r);0!==U.length&&(I=(k=U[0]).start,S=k.end,T=[I.line,I.offset],_=[S.line,S.offset],w=r.getAttributesOnSelection(a,{selStart:T,selEnd:_},!1),j={"image-uploaded":B[0],"image-placeholder":""},M={},1<(R=(L=Object(F.a)(w.attribs,function(e,t){var n,i=t[0],r=t[1];if(!Object(H.default)(j[i])){if(M[i])return e;r=j[i],M[i]=!0}return"gallery"===i&&((n=JSON.parse(r).items).forEach(function(e){var t=c[e.uuid];t&&(e.currWidth="".concat(t.width+4,"px"),e.currHeight="".concat(t.height,"px"),e.width="".concat(t.width+4,"px"),e.height="".concat(t.height,"px"))}),r=JSON.stringify({items:n})),e.push([i,r]),e},[])).filter(function(e){var t=z()(e,2),n=t[0],i=t[1];return"gallery"===n&&i})).length&&(N=R.reduce(function(e,t){var n=t[1],i=JSON.parse(n);return i&&i.items&&0<i.items.length?e.concat(i.items):e},[]),D=JSON.stringify({items:N}),(x=L.filter(function(e){var t=z()(e,2),n=t[0],i=t[1];return"gallery"!==n&&i})).push(["gallery",D]),L=x),r.callWithAce(function(){r.getRep(a).attributeManager.setAttributesOnRange(T,_,L),r.getObserver().withoutRecordingMutations(function(){Object(V.$)("#"+e+"-rect-style").remove()})},"performImageStyle",!0),Object(K.collectSuiteEvent)("click_image_zoom",{zoom_status:0===u?"":u<l?"zoom_out":"zoom_in"}),Object(K.collectSuiteEvent)("client_image_operation",{action:u<l?"zoom_out":"zoom_in",is_gallery:1<t.length}))}}},{key:"getImageDomRepByUuid",value:function(e){var t=this.ace.editorInfo,n=Object(V.$)("#container-wrap-".concat(W.u,"-image-").concat(e)).closest(".ace-line").get(0);return t.domToRep(n)}},{key:"focusOnImage",value:function(){var e,t,n,i,r,o,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],s=1<arguments.length?arguments[1]:void 0;!Array.isArray(a)||0===a.length||(e=this.getImageDomRepByUuid(a[a.length-1]))&&(t=this.ace.editorInfo,n=e.selStart[2]||"0",i=e.selStart[0],o=void 0===(r=(t.getRep(n).lines.atIndex(i)||{}).text)?"":r,t.selection.setWithSelection(n,[i,o.length],[i,o.length],!1),t.updateBrowserSelectionFromRep(!0),s&&s())}},{key:"replacePlaceholderWidthImage",value:function(e){var t=this.ace,n=this.uuid,i=t.editorInfo,r=Object(b.f)(i,function(e){return e.uuid===n});if(r){var o=r.selStart,a=r.selEnd,s=r.selZone;0===o[0]&&"0"===s&&(Object(u.a)("replacePlaceholderWidthImage selection 0"),console.trace());var c=(i.getRep(s).lines.atIndex(o[0])||{}).text,l=[a[0],c.length];if(O.a.emit("invokeCollapse",{zoneId:s,range:{selStart:o,selEnd:l},source:"insert_image"}),o[0]===a[0])i.performDocumentReplaceRangeWithAttributes(s,o,[a[0],c.length]," ",e);else try{Object(u.a)("replace img fail: id ".concat(n,", zone: ").concat(s,", sel: ").concat(JSON.stringify(r),", \n        attrObj: ").concat(JSON.stringify(e)))}catch(e){console.log(e)}}}},{key:"calcImageRect",value:function(e){return new Promise(function(a,t){var s=new Image,c=!1;s.src=e,setTimeout(function(){c||t(new Error({type:"timeout"}))},W.h),s.onload=function(){var e=s.width,t=s.height,n=e,i=t,r=window.innerHeight,o=parseInt(n,10)/parseInt(i,10);if(c=!0,d<t&&(e*=d/t,t=d),r<e)return a({height:t,width:e,natrualWidth:parseInt(n,10)+"px",natrualHeight:parseInt(i,10)+"px",scale:o});a({width:parseInt(e,10)+"px",height:parseInt(t,10)+"px",natrualWidth:parseInt(n,10)+"px",natrualHeight:parseInt(i,10)+"px",scale:o})},s.onerror=function(e){c=!0,t(e)}})}}],[{key:"clearImagePreviewer",value:function(r){var o=a.ace.editorInfo;o.callWithAce(function(){var e=o.getReps()[r.selZone].lines.atIndex(r.selStart[0])||{},t=e.text,n=e.lineNode,i=o.dom.zoneOfRootNode(o.dom.rootNodeOfZoneContaining(n));o.performDocumentReplaceRange(i,r.selStart,[r.selEnd[0],t.length],"")},"uploadImageFail",!0)}},{key:"setImageEditable",value:function(e){for(var t=Array.prototype.slice.call(document.querySelectorAll("#innerdocbody .image-container")),n=0,i=t.length;n<i;n++){var r=t[n];r.getAttribute("contenteditable")!==e&&r.setAttribute("contenteditable",e)}}},{key:"setImageReadWrite",value:function(){a.setImageEditable(!0)}},{key:"setImageReadOnly",value:function(){a.setImageEditable(!1)}},{key:"clearAllImagePreviewer",value:function(){a.ace.editorInfo.getMatchedAttributePositionOnSelection(null,function(e){return"image-previewer"===e}).forEach(function(e){var t=e.docPosition;return a.clearImagePreviewer(t)})}},{key:"hasGalleryChooseStyle",value:function(){return 0<Object(V.$)("#galleryTempStyle").length}},{key:"hasImageChooseStyle",value:function(){return 0<Object(V.$)("#imageTempStyle").length}},{key:"getChosenImgContainer",value:function(){var e=Object(V.$)("#imageTempStyle");if(0===e.length)return Object(V.$)(null);var t=e.data("id");return Object(V.$)("#".concat(t))}},{key:"getChosenGalleryContainer",value:function(){var e=Object(V.$)("#galleryTempStyle");if(0===e.length)return null;var t=e.data("id");return Object(V.$)("#".concat(t))}},{key:"removeImageChooseStyle",value:function(e){Object(V.$)("#imageTempStyle").remove()}},{key:"setRangeOnCloneImages",value:function(e,t){var n=a.ace.editorInfo,i=Object(V.$)(e).clone(!1);return i&&i.each(function(e,t){return Object(c.c)(Object(V.$)(t))}),Object(c.b)(),a.getCopiedImagesLineHandler(n,e,t)}},{key:"getCopiedImagesLineHandler",value:function(e,n,t){var i,r=Object(V.$)(n[0]),o=r.closest(".image-uploaded"),a=r.closest(".ace-line"),s=o.attr("data-ace-gallery-json");if(0!==a.length){if(s){var c=document.createElement("div"),l=JSON.parse(s);l.items=l.items.filter(function(e){var t=e.uuid;return n.some(function(e){return e.dataset.uuid===t})});var u=o[0].classList;Object(y.a)(u,function(e){!/comment-/.test(e)||/gallery/.test(e)||l.items[0].comments.includes(e)||l.items[0].comments.push(e)});var d=Object(k.a)(o[0].className),h=l.items[0].comments.join(" ");c.className="image-uploaded ".concat(h," gallery"),d&&c.classList.add(d),c.setAttribute("data-ace-gallery-json",JSON.stringify(l));var f=!0,p=!1,g=void 0;try{for(var m,v=n[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var b=m.value;c.appendChild(b.cloneNode(!0))}}catch(e){p=!0,g=e}finally{try{f||null==v.return||v.return()}finally{if(p)throw g}}i=t&&"cut"===t.type?Object(E.a)(e,c.outerHTML):c.outerHTML}else i=t&&"cut"===t.type?Object(E.a)(e,a.get(0).outerHTML):a.get(0).outerHTML;return i}}},{key:"addImageChooseStyle",value:function(e){var t,n=a.ace.editorInfo.getEditStatus(),i=n?"cursor: zoom-in;cursor:-webkit-zoom-in;":"";n&&!s.a.mobile&&(t=!0),Object(V.$)("#imageTempStyle").remove(),Object(V.$)("body").append('\n    <style id="imageTempStyle" data-id="'.concat(e,'">\n    #innerdocbody #').concat(e," {\n      border: 1px solid ").concat(l.B500," !important;\n      margin: 1px;\n      ").concat(i,"\n    }\n    #innerdocbody #").concat(e," .n-icon-dragable {\n        display:").concat(t?"block":"none",";\n    }\n    <style>\n  "))}},{key:"addGalleryChoosedStyle",value:function(e){var t=a.ace.editorInfo.getEditStatus()?"cursor: zoom-in;cursor:-webkit-zoom-in;":"";Object(V.$)("#galleryTempStyle").remove(),Object(V.$)("body").append('\n      <style id="galleryTempStyle" data-id="'.concat(e,'">\n      #innerdocbody #container-wrap-').concat(e," {\n        z-index: 1000;\n      }\n      #innerdocbody #").concat(e," {\n          border: 0;\n        ").concat(t,"\n      }\n      #innerdocbody #").concat(e," img {\n        outline: 2px solid ").concat(l.B500," !important;\n        outline-offset: -1px;\n      ").concat(t,"\n    }\n      #innerdocbody #").concat(e," .n-icon-dragable {\n          display: block;\n      }\n      <style>\n    "))}},{key:"removeGalleryChoosedStyle",value:function(){Object(V.$)("#galleryTempStyle").remove()}},{key:"addGalleryHoverStyle",value:function(e){var t=a.ace.editorInfo.getEditStatus()?"":"cursor: zoom-in;cursor:-webkit-zoom-in;";Object(V.$)("#galleryTempHoverStyle").remove(),Object(V.$)("body").append('\n    <style id="galleryTempHoverStyle" data-id="'.concat(e,'">\n    #innerdocbody #').concat(e," {\n      box-shadow: 0 0 0 2px ").concat(l.B200,";\n      ").concat(t,"\n    }\n    </style>\n    "))}},{key:"removeGalleryHoverStyle",value:function(){Object(V.$)("#galleryTempHoverStyle").remove()}},{key:"updateProgressStyle",value:function(e,t){var n="".concat(W.u,"-holder-").concat(e);Object(V.$)("#".concat(n,"-style")).remove(),Object(V.$)("body").append('\n    <style id="'.concat(n,'-style">\n      #').concat(n," .upload-progress-bar{\n        width:").concat(100*t,"%!important;\n      }\n      #").concat(n,'::after{\n        content: "').concat(i("etherpad.uploaded_tips")," ").concat(parseInt(100*t),'%"!important;\n      }\n    </style>'))}}]),a}();h.IMAGE_READWRITE_ID="image-read-write-style"}).call(this,p("2vAP"))},"0cva":function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return h}),n.d(t,"a",function(){return f});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("wd/R"),c=n.n(s);function l(){if(window.User.showWatchdogLog){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=console).warn.apply(e,["[WATCHDOG]"].concat(n))}}var u=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:40;r()(this,t),this.maxLogNum=e,this.logsToUpload=[]}return a()(t,[{key:"getLogsToUpload",value:function(){return this.logsToUpload.map(function(e){return e.join(" ")})}},{key:"addLogToUpload",value:function(){this.logsToUpload.length>=this.maxLogNum&&this.logsToUpload.splice(0,this.logsToUpload.length-this.maxLogNum+1);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logsToUpload.push([c()().format("YYYY-MM-DD HH:mm:ss.SSS")].concat(t))}},{key:"clearLogsToUpload",value:function(){this.logsToUpload.splice(0,this.logsToUpload.length)}}]),t}(),d=new u(40),h=new u(40);function f(){d.addLogToUpload.apply(d,arguments)}},"0nDA":function(e,t,n){},"0toH":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("J4zp"),f=n.n(i),p=n("XIp8"),g=n("TGBA"),r=n("a6Ml"),o=n.n(r),a=n("xk4V"),s=n.n(a),c=n("uEBw"),u=n("H6oK"),m=n("SebV"),v=[{attrs:["drive-fileInfo","drive-fileId"],primaryKey:"drive-fileId",outputAttrKey:"dataMetaBlockProps",transformFunc:function(e){var t=e["drive-fileInfo"].data,n=Object(c.f)(t),i=e["drive-fileId"].data;return{engineType:"none",blockId:o()(i,o.a.DNS),blockType:"FILE_CARD_BLOCK",dataVersion:0,token:"faketoken",props:{data:{fileId:i,fileInfo:n}}}}}],E=/(\*[0-9a-z]+)+/g,y="transformed_value";function O(e){return parseInt(e,36)}function C(e){return e.toString(36)}function k(e,t,n){var i={},r=!0,o=!1,a=void 0;try{for(var s,c=e[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value,u=f()(t[l],2),d=u[0],h=u[1];n.includes(d)&&(i[d]={index:l,data:h})}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return i}function I(e,t,n){var i=e.filter(function(e){return e[0]===n});return 0<i.length&&i.find(function(e){return e[0].includes(t)})}function b(e,t,n,i){if(e.match(E)){var r=!0,o=!1,a=void 0;try{for(var s,c=i[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l,u=s.value,d=u.matchedAttrs,h=u.settingsObj;for(l in d){var f,p=d[l],g=h.transformFunc(p),m=I(t,g.blockId,h.outputAttrKey),v=0;for(f in p){var b=p[f].index;0!==v||m?(n[b][0]=y,n[b][1]=y+g.blockId):(n[b][0]=h.outputAttrKey,n[b][1]=JSON.stringify(g)),v++}}}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}}}function S(e,h,t){var f=e.match(E);if(!f)return[];var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,p=c.settingsObj,l=c.matchedKeyAttrs,g={},u=!0,d=!1,m=void 0;try{for(var v,b=function(){var e=v.value,t=e.index,n=e.value,i="*"+C(t),r=function(e){var t=new RegExp("\\"+i+"[^0-9^a-z]","g"),n=new RegExp("\\"+i+"$","g");return-1!==e.search(t)||-1!==e.search(n)},o=f.find(function(e){return e.includes(i)&&r(e)});if(!o)return"continue";for(var a=o.split("*"),s=[],c=0;c<a.length;c++)""!==a[c]&&s.push(O(a[c]));var l=p.attrs,u=k(s,h,l),d=n[1];g[d]=u},y=l[Symbol.iterator]();!(u=(v=y.next()).done);u=!0)b()}catch(e){d=!0,m=e}finally{try{u||null==y.return||y.return()}finally{if(d)throw m}}n.push({matchedAttrs:g,settingsObj:p})}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}function T(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){for(var c,l=a.value,u=l.primaryKey,d=[],h=0;h<t.length;h++)t[h][0]===u&&(c={index:h,value:t[h]},d.push(c));d.length&&n.push({settingsObj:l,matchedKeyAttrs:d})}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}function _(o,e){var a=[];if(!e.length)return a;var l=["author","mention-link","mention-chatId","mention-chatToken"];return e.forEach(function(e){var t=e.split("*");t.splice(0,1);var n=t.map(function(e){return o[O(e)]}).reduce(function(e,t){var n,i,r,o,a=f()(t,2),s=a[0],c=a[1];return l.includes(s)?e[s]=c:(n=s.split("_"),r=(i=f()(n,2))[0],o=i[1],e[r]=o),e},{}),i={engineType:"none",blockId:s()(),blockType:u.BlockType.CHAT_CARD_BLOCK,dataVersion:0,token:"faketoken",props:{data:{author:n.author,icon:decodeURIComponent(n["mention-link"]),chatId:n["mention-chatId"],chatToken:n["mention-chatToken"]||""}}},r=Object.keys(o).length;o[r]=["dataMetaBlockProps",JSON.stringify(i)],a.push([e,"*".concat(C(r))])}),a}function w(e){var t,n="mention-chatId",i=function(e){return-1!==e[0].indexOf(n)},r=[];for(t in e)i(e[t])&&r.push(C(+t));return r}function j(e,t){var n=e.match(E);if(!n)return[];if(!t.length)return[];var i=t.map(function(e){return new RegExp("\\*".concat(e,"[+\\*|]"))});return n.filter(function(t){return i.some(function(e){return e.test(t)})})}function l(t){var n;try{n=Object(p.default)(t.collab_client_vars);var e,i,r,o,a,s,c=t.collab_client_vars.initialAttributedTexts.attribs,l=t.collab_client_vars.apool.numToAttrib,u=Object(g.a)(l),d=!1,h=w(l),f=T(v,u);for(e in c)c.hasOwnProperty(e)&&(i=c[e],!f.length||(r=S(i,u,f)).length&&b(i,u,l,r),h.length&&(!(o=j(i,h)).length||(a=_(l,o)).length&&(d=!0,s=a.reduce(function(e,t){return e.replace(t[0],t[1])},i),t.collab_client_vars.initialAttributedText[e]=s,t.collab_client_vars.initialAttributedTexts.attribs[e]=s)));d&&(t.collab_client_vars.apool.nextNum=Object.keys(l).length)}catch(e){throw t.collab_client_vars=n,Object(m.a)(e),new Error("Error: clientVars transform failed: "+e)}}},"0xAR":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwKSI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNTQuMzY2IDM5LjA3NjhDNTQuMjUwNyAzOS4zODc1IDUzLjkwMTIgMzkuNTM3NiA1My41OTMyIDM5LjQxNTJMNTIuODQ5OCAzOS4xMTk3QzUyLjU0MTkgMzguOTk3MiA1Mi4zOTIzIDM4LjY0ODYgNTIuNTA3IDM4LjMzNzdDNTIuNzYxOSAzNy42NDY5IDUyLjk4NzYgMzYuOTM3OSA1My4xODIyIDM2LjIxMTZDNTMuMzc2OCAzNS40ODU0IDUzLjUzNTkgMzQuNzU4NSA1My42NjA1IDM0LjAzMjhDNTMuNzE2NiAzMy43MDYyIDU0LjAyMDUgMzMuNDc5MSA1NC4zNDg0IDMzLjUyN0w1NS4xNCAzMy42NDI4QzU1LjQ2NzkgMzMuNjkwNyA1NS42OTU1IDMzLjk5NTUgNTUuNjQgMzQuMzIyMkM1NS41MDM4IDM1LjEyNDQgNTUuMzI4OSAzNS45Mjc1IDU1LjExNDEgMzYuNzI5M0M1NC44OTkyIDM3LjUzMSA1NC42NDkyIDM4LjMxNCA1NC4zNjYgMzkuMDc2OFpNNTUuOTg5OSAyOS4wNTg2QzU2LjAwMTggMjkuMzg5OCA1NS43MzU4IDI5LjY2MTggNTUuNDA0NSAyOS42NjZMNTQuNjA0NSAyOS42NzYxQzU0LjI3MzIgMjkuNjgwMyA1NC4wMDIgMjkuNDE1IDUzLjk4OTQgMjkuMDgzOEM1My45MzI4IDI3LjU4NzggNTMuNzM1NiAyNi4xMTMgNTMuNDA3NSAyNC42NzYzQzUzLjMzMzcgMjQuMzUzMiA1My41MjY4IDI0LjAyNjcgNTMuODQ3OSAyMy45NDQ5TDU0LjYyMzIgMjMuNzQ3MkM1NC45NDQzIDIzLjY2NTQgNTUuMjcxNiAyMy44NTkyIDU1LjM0NiAyNC4xODIxQzU1LjcxMjEgMjUuNzcwNCA1NS45MzA0IDI3LjQwMjUgNTUuOTg5OSAyOS4wNTg2Wk01My42NDYxIDE5LjE4ODFDNTMuNzg0MSAxOS40ODkzIDUzLjY0MjkgMTkuODQyNiA1My4zMzg1IDE5Ljk3MzZMNTIuNjAzNyAyMC4yODk5QzUyLjI5OTMgMjAuNDIwOSA1MS45NDcxIDIwLjI4IDUxLjgwODUgMTkuOTc5QzUxLjE4NyAxOC42Mjg0IDUwLjQ0MTYgMTcuMzM3MyA0OS41ODI3IDE2LjEyMzdDNDkuMzkxMyAxNS44NTMzIDQ5LjQ0NTQgMTUuNDc3NyA0OS43MTEgMTUuMjc5N0w1MC4zNTI0IDE0LjgwMTRDNTAuNjE4IDE0LjYwMzMgNTAuOTk0NSAxNC42NTc3IDUxLjE4NjUgMTQuOTI3OEM1Mi4xMzgyIDE2LjI2NzIgNTIuOTYyIDE3LjY5NDEgNTMuNjQ2MSAxOS4xODgxWk00Ny43MTE1IDEwLjk1ODZDNDcuOTUzOSAxMS4xODQ1IDQ3Ljk1ODEgMTEuNTY0OSA0Ny43MjY2IDExLjgwMjFMNDcuMTY3OSAxMi4zNzQ2QzQ2LjkzNjQgMTIuNjExOCA0Ni41NTcxIDEyLjYxNTggNDYuMzE0MiAxMi4zOTA0QzQ1LjIzNDEgMTEuMzg3OSA0NC4wNTU1IDEwLjQ3OTcgNDIuNzg4MSA5LjY4MjZDNDIuNTA3NiA5LjUwNjE4IDQyLjQxMzUgOS4xMzg2NiA0Mi41ODI4IDguODUzOEw0Mi45OTE1IDguMTY2MDhDNDMuMTYwOCA3Ljg4MTIxIDQzLjUyOTMgNy43ODY5MiA0My44MTAyIDcuOTYyNzlDNDUuMjE0NyA4Ljg0MjMzIDQ2LjUxODkgOS44NDc0NyA0Ny43MTE1IDEwLjk1ODZaTTM5LjA3NjkgNS42MzM5NkMzOS4zODc1IDUuNzQ5MjggMzkuNTM3NyA2LjA5ODgyIDM5LjQxNTIgNi40MDY3NUwzOS4xMTk3IDcuMTUwMTVDMzguOTk3MyA3LjQ1ODA3IDM4LjY0ODYgNy42MDc3MSAzOC4zMzc4IDcuNDkyOTlDMzcuNjQ2OSA3LjIzODA3IDM2LjkzNzkgNy4wMTIzNiAzNi4yMTE3IDYuODE3NzZDMzUuNDg1NCA2LjYyMzE3IDM0Ljc1ODYgNi40NjQxMyAzNC4wMzI4IDYuMzM5NDlDMzMuNzA2MiA2LjI4MzQgMzMuNDc5MSA1Ljk3OTUgMzMuNTI3MSA1LjY1MTYxTDMzLjY0MjggNC44NjAwM0MzMy42OTA3IDQuNTMyMTQgMzMuOTk1NSA0LjMwNDQ5IDM0LjMyMjIgNC4zNTk5NkMzNS4xMjQ1IDQuNDk2MTcgMzUuOTI3NSA0LjY3MTA4IDM2LjcyOTMgNC44ODU5MUMzNy41MzExIDUuMTAwNzUgMzguMzE0IDUuMzUwOCAzOS4wNzY5IDUuNjMzOTZaTTI5LjA1ODYgNC4wMTAxMkMyOS4zODk4IDMuOTk4MjQgMjkuNjYxOCA0LjI2NDE5IDI5LjY2NiA0LjU5NTUzTDI5LjY3NjEgNS4zOTU0N0MyOS42ODAzIDUuNzI2ODEgMjkuNDE1IDUuOTk4MDIgMjkuMDgzOSA2LjAxMDU1QzI3LjU4NzggNi4wNjcxNiAyNi4xMTMgNi4yNjQzNyAyNC42NzYzIDYuNTkyNTNDMjQuMzUzMiA2LjY2NjMyIDI0LjAyNjcgNi40NzMxNSAyMy45NDQ5IDYuMTUyMDVMMjMuNzQ3MyA1LjM3Njg0QzIzLjY2NTQgNS4wNTU3NCAyMy44NTkyIDQuNzI4MzcgMjQuMTgyMSA0LjY1Mzk1QzI1Ljc3MDUgNC4yODc5MiAyNy40MDI1IDQuMDY5NTUgMjkuMDU4NiA0LjAxMDEyWk0xOS45NzM2IDYuNjYxNDZDMTkuODQyNiA2LjM1NzA5IDE5LjQ4OTQgNi4yMTU5IDE5LjE4ODEgNi4zNTM4NkMxNy42OTQyIDcuMDM3OTUgMTYuMjY3MiA3Ljg2MTc4IDE0LjkyNzggOC44MTM1MkMxNC42NTc3IDkuMDA1NDYgMTQuNjAzNCA5LjM4MTk5IDE0LjgwMTQgOS42NDc2M0wxNS4yNzk3IDEwLjI4OUMxNS40Nzc4IDEwLjU1NDYgMTUuODUzMyAxMC42MDg3IDE2LjEyMzggMTAuNDE3M0MxNy4zMzc0IDkuNTU4NDEgMTguNjI4NCA4LjgxMzAxIDE5Ljk3OSA4LjE5MTQ1QzIwLjI4IDguMDUyOTEgMjAuNDIwOSA3LjcwMDY2IDIwLjI4OTkgNy4zOTYyOUwxOS45NzM2IDYuNjYxNDZaTTEwLjk1ODcgMTIuMjg4NUMxMS4xODQ2IDEyLjA0NjEgMTEuNTY1IDEyLjA0MTkgMTEuODAyMSAxMi4yNzM0TDEyLjM3NDcgMTIuODMyMUMxMi42MTE4IDEzLjA2MzYgMTIuNjE1OSAxMy40NDI5IDEyLjM5MDQgMTMuNjg1OEMxMS4zODc5IDE0Ljc2NTkgMTAuNDc5NyAxNS45NDQ1IDkuNjgyNjMgMTcuMjExOUM5LjUwNjIxIDE3LjQ5MjQgOS4xMzg2OSAxNy41ODY1IDguODUzODMgMTcuNDE3Mkw4LjE2NjExIDE3LjAwODVDNy44ODEyNCAxNi44MzkyIDcuNzg2OTUgMTYuNDcwNiA3Ljk2MjgxIDE2LjE4OThDOC44NDIzNiAxNC43ODUyIDkuODQ3NDkgMTMuNDgxIDEwLjk1ODcgMTIuMjg4NVpNNi40MDY3OCAyMC41ODQ3QzYuMDk4ODUgMjAuNDYyMyA1Ljc0OTMgMjAuNjEyNSA1LjYzMzk5IDIwLjkyMzFDNS4zNTA4MyAyMS42ODYgNS4xMDA3NyAyMi40Njg5IDQuODg1OTQgMjMuMjcwN0M0LjY3MTExIDI0LjA3MjUgNC40OTYxOSAyNC44NzU1IDQuMzU5OTkgMjUuNjc3OEM0LjMwNDUyIDI2LjAwNDUgNC41MzIxNyAyNi4zMDkzIDQuODYwMDUgMjYuMzU3Mkw1LjY1MTY0IDI2LjQ3MjlDNS45Nzk1MiAyNi41MjA5IDYuMjgzNDMgMjYuMjkzOCA2LjMzOTUyIDI1Ljk2NzJDNi40NjQxNiAyNS4yNDE0IDYuNjIzMiAyNC41MTQ2IDYuODE3NzkgMjMuNzg4M0M3LjAxMjM4IDIzLjA2MjEgNy4yMzgwOSAyMi4zNTMxIDcuNDkzMDIgMjEuNjYyMkM3LjYwNzc0IDIxLjM1MTQgNy40NTgxIDIxLjAwMjcgNy4xNTAxNyAyMC44ODAzTDYuNDA2NzggMjAuNTg0N1pNNC4wMTAxNSAzMC45NDE0QzMuOTk4MjcgMzAuNjEwMiA0LjI2NDIyIDMwLjMzODEgNC41OTU1NiAzMC4zMzRMNS4zOTU1IDMwLjMyMzlDNS43MjY4NCAzMC4zMTk3IDUuOTk4MDUgMzAuNTg1IDYuMDEwNTggMzAuOTE2MUM2LjA2NzE5IDMyLjQxMjIgNi4yNjQ0IDMzLjg4NyA2LjU5MjU2IDM1LjMyMzdDNi42NjYzNSAzNS42NDY4IDYuNDczMTggMzUuOTczMyA2LjE1MjA4IDM2LjA1NTFMNS4zNzY4NyAzNi4yNTI3QzUuMDU1NzcgMzYuMzM0NiA0LjcyODQgMzYuMTQwOCA0LjY1Mzk4IDM1LjgxNzlDNC4yODc5NSAzNC4yMjk1IDQuMDY5NTggMzIuNTk3NSA0LjAxMDE1IDMwLjk0MTRaTTYuMzUzODkgNDAuODExOUM2LjIxNTkzIDQwLjUxMDYgNi4zNTcxMiA0MC4xNTc0IDYuNjYxNDkgNDAuMDI2M0w3LjM5NjMyIDM5LjcxMDFDNy43MDA2OSAzOS41NzkxIDguMDUyOTQgMzkuNzIgOC4xOTE0NyA0MC4wMjFDOC44MTMwNCA0MS4zNzE2IDkuNTU4NDMgNDIuNjYyNiAxMC40MTczIDQzLjg3NjJDMTAuNjA4NyA0NC4xNDY3IDEwLjU1NDYgNDQuNTIyMiAxMC4yODkgNDQuNzIwM0w5LjY0NzY2IDQ1LjE5ODVDOS4zODIwMiA0NS4zOTY2IDkuMDA1NDkgNDUuMzQyMyA4LjgxMzU1IDQ1LjA3MjJDNy44NjE4MSA0My43MzI4IDcuMDM3OTggNDIuMzA1OCA2LjM1Mzg5IDQwLjgxMTlaTTEyLjI4ODUgNDkuMDQxM0MxMi4wNDYxIDQ4LjgxNTQgMTIuMDQxOSA0OC40MzUgMTIuMjczNCA0OC4xOTc5TDEyLjgzMjEgNDcuNjI1M0MxMy4wNjM2IDQ3LjM4ODIgMTMuNDQyOSA0Ny4zODQxIDEzLjY4NTggNDcuNjA5NkMxNC43NjU5IDQ4LjYxMjEgMTUuOTQ0NiA0OS41MjAzIDE3LjIxMTkgNTAuMzE3NEMxNy40OTI0IDUwLjQ5MzggMTcuNTg2NSA1MC44NjEzIDE3LjQxNzIgNTEuMTQ2MkwxNy4wMDg1IDUxLjgzMzlDMTYuODM5MyA1Mi4xMTg4IDE2LjQ3MDcgNTIuMjEzIDE2LjE4OTggNTIuMDM3MkMxNC43ODUzIDUxLjE1NzYgMTMuNDgxMSA1MC4xNTI1IDEyLjI4ODUgNDkuMDQxM1pNMjAuOTIzMSA1NC4zNjZDMjAuNjEyNSA1NC4yNTA3IDIwLjQ2MjQgNTMuOTAxMSAyMC41ODQ4IDUzLjU5MzJMMjAuODgwMyA1Mi44NDk4QzIxLjAwMjggNTIuNTQxOSAyMS4zNTE0IDUyLjM5MjMgMjEuNjYyMyA1Mi41MDdDMjIuMzUzMSA1Mi43NjE5IDIzLjA2MjEgNTIuOTg3NiAyMy43ODg0IDUzLjE4MjJDMjQuNTE0NiA1My4zNzY4IDI1LjI0MTUgNTMuNTM1OCAyNS45NjcyIDUzLjY2MDVDMjYuMjkzOCA1My43MTY2IDI2LjUyMDkgNTQuMDIwNSAyNi40NzMgNTQuMzQ4NEwyNi4zNTcyIDU1LjEzOTlDMjYuMzA5MyA1NS40Njc4IDI2LjAwNDUgNTUuNjk1NSAyNS42Nzc4IDU1LjY0QzI0Ljg3NTUgNTUuNTAzOCAyNC4wNzI1IDU1LjMyODkgMjMuMjcwNyA1NS4xMTQxQzIyLjQ2ODkgNTQuODk5MiAyMS42ODYgNTQuNjQ5MiAyMC45MjMxIDU0LjM2NlpNMzAuOTQxNCA1NS45ODk4QzMwLjYxMDIgNTYuMDAxNyAzMC4zMzgyIDU1LjczNTggMzAuMzM0IDU1LjQwNDRMMzAuMzIzOSA1NC42MDQ1QzMwLjMxOTcgNTQuMjczMiAzMC41ODUgNTQuMDAxOSAzMC45MTYyIDUzLjk4OTRDMzIuNDEyMiA1My45MzI4IDMzLjg4NyA1My43MzU2IDM1LjMyMzcgNTMuNDA3NEMzNS42NDY4IDUzLjMzMzYgMzUuOTczMyA1My41MjY4IDM2LjA1NTEgNTMuODQ3OUwzNi4yNTI4IDU0LjYyMzFDMzYuMzM0NiA1NC45NDQyIDM2LjE0MDggNTUuMjcxNiAzNS44MTc5IDU1LjM0NkMzNC4yMjk2IDU1LjcxMiAzMi41OTc1IDU1LjkzMDQgMzAuOTQxNCA1NS45ODk4Wk00MC44MTE5IDUzLjY0NjFDNDAuNTEwNiA1My43ODQxIDQwLjE1NzQgNTMuNjQyOSA0MC4wMjY0IDUzLjMzODVMMzkuNzEwMSA1Mi42MDM3QzM5LjU3OTEgNTIuMjk5MyAzOS43MiA1MS45NDcxIDQwLjAyMSA1MS44MDg1QzQxLjM3MTYgNTEuMTg3IDQyLjY2MjcgNTAuNDQxNiA0My44NzYzIDQ5LjU4MjdDNDQuMTQ2NyA0OS4zOTEzIDQ0LjUyMjIgNDkuNDQ1NCA0NC43MjAzIDQ5LjcxMUw0NS4xOTg2IDUwLjM1MjNDNDUuMzk2NyA1MC42MTggNDUuMzQyMyA1MC45OTQ1IDQ1LjA3MjIgNTEuMTg2NEM0My43MzI4IDUyLjEzODIgNDIuMzA1OSA1Mi45NjIgNDAuODExOSA1My42NDYxWk00OS4wNDE0IDQ3LjcxMTVDNDguODE1NSA0Ny45NTM5IDQ4LjQzNSA0Ny45NTggNDguMTk3OSA0Ny43MjY2TDQ3LjYyNTQgNDcuMTY3OEM0Ny4zODgyIDQ2LjkzNjQgNDcuMzg0MiA0Ni41NTcxIDQ3LjYwOTYgNDYuMzE0MkM0OC42MTIxIDQ1LjIzNCA0OS41MjAzIDQ0LjA1NTQgNTAuMzE3NCA0Mi43ODgxQzUwLjQ5MzggNDIuNTA3NiA1MC44NjEzIDQyLjQxMzUgNTEuMTQ2MiA0Mi41ODI3TDUxLjgzMzkgNDIuOTkxNUM1Mi4xMTg4IDQzLjE2MDcgNTIuMjEzMSA0My41MjkzIDUyLjAzNzIgNDMuODEwMkM1MS4xNTc3IDQ1LjIxNDcgNTAuMTUyNSA0Ni41MTg5IDQ5LjA0MTQgNDcuNzExNVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yNy4xMDk0IDM0LjMzODlDMjYuNjQ2NSAzNC45NDI0IDI2LjAwNDkgMzUuMzk5NCAyNS4xODQ2IDM1LjcxQzI0LjM2NDMgMzYuMDIwNSAyMy40MzI2IDM2LjE3NTggMjIuMzg5NiAzNi4xNzU4QzIxLjMxNzQgMzYuMTc1OCAyMC4zNjgyIDM1LjkzMjYgMTkuNTQyIDM1LjQ0NjNDMTguNzE1OCAzNC45NiAxOC4wNzcxIDM0LjI2NTYgMTcuNjI2IDMzLjM2MzNDMTcuMTgwNyAzMi40NTUxIDE2Ljk0OTIgMzEuMzk3NSAxNi45MzE2IDMwLjE5MDRWMjkuMTg4NUMxNi45MzE2IDI3LjI1NDkgMTcuMzk0NSAyNS43NDYxIDE4LjMyMDMgMjQuNjYyMUMxOS4yNDYxIDIzLjU3MjMgMjAuNTM4MSAyMy4wMjczIDIyLjE5NjMgMjMuMDI3M0MyMy42MjAxIDIzLjAyNzMgMjQuNzUxIDIzLjM3ODkgMjUuNTg4OSAyNC4wODJDMjYuNDI2OCAyNC43ODUyIDI2LjkzMDcgMjUuNzk4OCAyNy4xMDA2IDI3LjEyM0gyNC45MjA5QzI0LjY3NDggMjUuNTgyIDIzLjc4MTIgMjQuODExNSAyMi4yNDAyIDI0LjgxMTVDMjEuMjQ0MSAyNC44MTE1IDIwLjQ4NTQgMjUuMTcxOSAxOS45NjM5IDI1Ljg5MjZDMTkuNDQ4MiAyNi42MDc0IDE5LjE4MTYgMjcuNjU5MiAxOS4xNjQxIDI5LjA0NzlWMzAuMDMyMkMxOS4xNjQxIDMxLjQxNSAxOS40NTQxIDMyLjQ5MDIgMjAuMDM0MiAzMy4yNTc4QzIwLjYyMDEgMzQuMDE5NSAyMS40MzE2IDM0LjQwMDQgMjIuNDY4OCAzNC40MDA0QzIzLjYwNTUgMzQuNDAwNCAyNC40MTQxIDM0LjE0MjYgMjQuODk0NSAzMy42MjdWMzEuMTIyMUgyMi4yNTc4VjI5LjQzNDZIMjcuMTA5NFYzNC4zMzg5Wk0zMS44OTk0IDM2SDI5LjY4NDZWMjMuMjAzMUgzMS44OTk0VjM2Wk00Mi4wMDY4IDMwLjU3NzFIMzYuODU2NFYzNkgzNC42MzI4VjIzLjIwMzFINDIuNzYyN1YyNC45OTYxSDM2Ljg1NjRWMjguODAxOEg0Mi4wMDY4VjMwLjU3NzFaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo="},"0zrf":function(e,t,i){var r={"./":["2C+q",13],"./de-DE":["3AUJ",19],"./de-DE.js":["3AUJ",19],"./en-US":["nGoF",20],"./en-US.js":["nGoF",20],"./es-ES":["NlVp",21],"./es-ES.js":["NlVp",21],"./fr-FR":["gJsQ",22],"./fr-FR.js":["gJsQ",22],"./hi-IN":["wpGd",23],"./hi-IN.js":["wpGd",23],"./id-ID":["Jgxz",24],"./id-ID.js":["Jgxz",24],"./index":["2C+q",13],"./index.js":["2C+q",13],"./it-IT":["K4jQ",25],"./it-IT.js":["K4jQ",25],"./ja-JP":["Pkk5",26],"./ja-JP.js":["Pkk5",26],"./ko-KR":["fRIe",27],"./ko-KR.js":["fRIe",27],"./pt-BR":["ezSg",28],"./pt-BR.js":["ezSg",28],"./ru-RU":["JdEb",29],"./ru-RU.js":["JdEb",29],"./th-TH":["hmln",30],"./th-TH.js":["hmln",30],"./vi-VN":["DMXk",31],"./vi-VN.js":["DMXk",31],"./zh-CN":["LeJW",32],"./zh-CN.js":["LeJW",32]};function n(t){if(!i.o(r,t))return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e});var e=r[t],n=e[0];return i.e(e[1]).then(function(){return i(n)})}n.keys=function(){return Object.keys(r)},n.id="0zrf",e.exports=n},"1+jt":function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l});var r=n("lQZd"),o=n("Ngi8"),a=function(e){var t=0,n=0,i=e.length;if(0<i)for(;n<i;)t=(t<<5)-t+e.charCodeAt(n++)|0;return t},s=new Map,i=function(e){if(i=s.get(e))return i;var t=Object(r.h)()+e,n=a(t),i=Math.abs(n)%o.CURSOR_COLOR_PALETTE.length;return s.set(e,i),i},c=function(e){var t=i(e);return o.CURSOR_COLOR_PALETTE[t]},l=function(){s.clear()}},"15MJ":function(e,t,n){"use strict";n.d(t,"u",function(){return d}),n.d(t,"s",function(){return h}),n.d(t,"m",function(){return f}),n.d(t,"q",function(){return p}),n.d(t,"h",function(){return g}),n.d(t,"j",function(){return m}),n.d(t,"l",function(){return v}),n.d(t,"i",function(){return b}),n.d(t,"e",function(){return y}),n.d(t,"a",function(){return E}),n.d(t,"p",function(){return O}),n.d(t,"o",function(){return C}),n.d(t,"n",function(){return k}),n.d(t,"b",function(){return I}),n.d(t,"k",function(){return S}),n.d(t,"t",function(){return T}),n.d(t,"f",function(){return _}),n.d(t,"g",function(){return w}),n.d(t,"d",function(){return j}),n.d(t,"c",function(){return M});var i=n("NSt8"),r=n.n(i),o=n("K6ZQ"),a=n.n(o),s=n("bCqk"),c=n.n(s),l=n("bIgJ"),u=n.n(l);n.d(t,"r",function(){return u.a});var d="image-upload",h="imageUpload",f=20,p=["tl","tc","tr","cr","br","bc","bl","lc"],g=9e4,m=20971520,v="mark_decode_image",b=6,y="gallery",E="data-ace-gallery-json",O="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",C={zh:a.a,en:r.a,ja:c.a},k=r.a,I="doc_decrypt_img_display",S="doc_insert_image",T=["list","heading"],_="gif-load-icon-active",w="gif-load-icon",j=/\/api\/box\/stream\/download\/(?:v\d+\/)?(all|cover)\/(\w*)/,M=/\/api\/file\/f\/(\w*)/},"16UX":function(e,t,n){"use strict";var i=n("q1tI"),o=n.n(i),r=n("CnBM"),a=n.n(r),s=n("yKd+"),c=n("lwsE"),l=n.n(c),u=n("W8MJ"),d=n.n(u),h=n("a1gu"),f=n.n(h),p=n("Nsbk"),g=n.n(p),m=n("7W2i"),v=n.n(m),b=n("iWIM"),y=n.n(b),E=n("D0c4"),O=n("QILm"),C=n.n(O),k=n("i8i4"),I=n.n(k),S=n("hKza"),T=function(){function e(){var n=this;l()(this,e),this.ghost=null,this.popoverProps=null,this.childProps=null,this.triggerId=0,this.handleMouseEnter=function(e){var t=n.popoverProps;t&&t.onMouseEnter&&t.onMouseEnter(e)},this.handleMouseLeave=function(e){n.hideGhost(n.triggerId);var t=n.popoverProps;t&&t.onMouseLeave&&t.onMouseLeave(e)}}return d()(e,[{key:"generateGhost",value:function(e){var t=document.createElement("div");t.style.position="absolute",t.style.display="none";var n=this.getDefaultStyle()||{},i=e.style||{},r=Object.assign({},n,{},i);return Object.keys(r).forEach(function(e){t.style[e]=r[e]}),document.body.appendChild(t),t}},{key:"renderContent",value:function(e,t,n){I.a.render(o.a.createElement("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},this.getContent(t)),e,n)}},{key:"showGhost",value:function(e){var t=this.getDefaultPopupPositionOptions();e.popupPositionOptions&&(t=Object.assign({},t,{},e.popupPositionOptions)),this.ghost.style.display="block";var n,i,r,o=Object(S.a)(Object.assign({popup:this.ghost,referTarget:e.target},t)),a=(r=o?o.position:(n=e.target.getBoundingClientRect(),i=this.ghost.getBoundingClientRect(),{direction:{left:n.left-i.width,top:n.bottom}})).left,s=r.top,c=r.right;void 0!==a&&(this.ghost.style.left="".concat(a,"px")),void 0!==s&&(this.ghost.style.top="".concat(s,"px")),void 0!==c&&(this.ghost.style.right="".concat(c,"px")),this.onShow&&this.onShow()}},{key:"hideGhost",value:function(e){e===this.triggerId&&this.ghost&&(this.ghost.style.display="none",this.popoverProps&&(this.popoverProps.destroyAfterHide&&this.destroy(),this.popoverProps.onHide&&this.popoverProps.onHide()),this.onHide&&this.onHide(),this.popoverProps=null)}},{key:"getChildProps",value:function(){return this.childProps}},{key:"getPopoverProps",value:function(){return this.popoverProps}},{key:"onShow",value:function(){}},{key:"hide",value:function(){this.hideGhost(this.triggerId)}},{key:"show",value:function(e){var t=this,n=e.target,i=e.style,r=e.container,o=e.destroyAfterHide,a=e.onMouseEnter,s=e.onMouseLeave,c=e.onHide,l=C()(e,["target","style","container","destroyAfterHide","onMouseEnter","onMouseLeave","onHide"]),u={target:n,style:i,container:r,destroyAfterHide:o,onMouseEnter:a,onMouseLeave:s,onHide:c};this.hideGhost(this.triggerId),this.popoverProps=u,this.childProps=l;var d=this.triggerId+1;return this.ghost?this.showGhost(u):(this.ghost=this.generateGhost(u),this.renderContent(this.ghost,l,function(){t.popoverProps===u&&t.showGhost(u)})),this.triggerId=d,function(){t.hideGhost(d)}}},{key:"destroy",value:function(){this.ghost&&(I.a.unmountComponentAtNode(this.ghost),this.ghost.remove(),this.ghost=null)}}]),e}(),_=n("716e"),w={width:"320px",height:"500px"},j=function(n,i,r){var e=function e(t){r(t),n.removeEventListener(i,e)};return n.addEventListener(i,e),function(){n.removeEventListener(i,e)}},M=function(e){function i(){var t,e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return l()(this,i),(t=f()(this,g()(i).call(this))).removeMouseLeaveHandler=null,t.hideTimer=null,t.handleTargetMouseLeave=function(e){t.clearTimer(),t.hideTimer=window.setTimeout(function(){e()},100)},t.isSamplePopup=e,t}return v()(i,e),d()(i,[{key:"clearTimer",value:function(){this.hideTimer&&window.clearTimeout(this.hideTimer)}},{key:"handlePopoverMouseEnter",value:function(e,t){this.clearTimer(),e&&e(t)}},{key:"onHide",value:function(){this.clearTimer(),this.removeMouseLeaveHandler&&this.removeMouseLeaveHandler(),this.removeMouseLeaveHandler=null}},{key:"getDefaultStyle",value:function(){return this.isSamplePopup?{}:w}},{key:"getDefaultPopupPositionOptions",value:function(){return{placement:[_.a.left,_.b.center],gapToTarget:10,isSamplePopup:this.isSamplePopup}}},{key:"getContent",value:function(e){var t={};return this.isSamplePopup?(t.position="static",t.WebkitTransform="translateY(-50%)",t.msTransform="translateY(-50%)",t.transform="translateY(-50%)",t.border="none"):t=Object.assign({},w),o.a.createElement("div",{className:"mention-popover reaction-mention-profile comment-ignore-blur",style:t},o.a.createElement(E.default,Object.assign({closePopover:this.onHide},e,{triangle:this.isSamplePopup?"right":void 0})))}},{key:"show",value:function(e){var t=this.handlePopoverMouseEnter.bind(this,e.onMouseEnter),n=y()(g()(i.prototype),"show",this).call(this,Object.assign({},e,{onMouseEnter:t}));return this.removeMouseLeaveHandler=j(e.target,"mouseleave",this.handleTargetMouseLeave.bind(this,n)),n}}]),i}(T),L=null,R=function(){return L=L||new M(0<arguments.length&&void 0!==arguments[0]&&arguments[0])},N=n("chSF"),D=n("8Km3"),x=n("YlgD"),P=n("JO1u"),B=(n("dccM"),function(e){function t(e){var i;return l()(this,t),(i=f()(this,g()(t).call(this,e))).isOversea=!1,i.getUserByChatter=function(t){return i.props.reaction.userList.find(function(e){return e.userId===t.id})},i.handleChatterClick=function(e,t){var n;!i.props.onUserClick||(n=i.getUserByChatter(e))&&i.props.onUserClick(n,t)},i.handleMoreClick=function(e){i.props.onMoreClick&&i.props.onMoreClick(i.props.reaction.reactionKey,e)},i.handleReactionClick=function(e){e.stopPropagation(),i.props.onReactionClick&&i.props.onReactionClick(i.props.reaction.reactionKey,e)},i.isOversea=Object(P.c)(),i}return v()(t,e),d()(t,[{key:"render",value:function(){var e=this.props.reaction;return o.a.createElement(D.a,{emojiProps:{code:e.reactionKey,isOversea:this.isOversea,onClick:this.handleReactionClick},chatterCount:e.totalCount,chatters:e.userList.map(function(e){return Object(x.a)(e)}),onChatterClick:this.handleChatterClick,onMoreClick:this.handleMoreClick})}}]),t}(o.a.PureComponent)),U=n("VI6H"),z=n("iP/4"),H=n("ECq1"),F=n("kUgE"),V=(n("Va3G"),function(e){function t(e){var n;return l()(this,t),(n=f()(this,g()(t).call(this,e))).handleUserClick=function(e,t){t.stopPropagation(),e.anonymous||Object(U.j)()||z.a.isOpendoc||R(Object(U.y)()).show({token:e.userId,name:e.userName,target:t.target,destroyAfterHide:!0,style:{zIndex:1001}})},n.handleClose=function(){n.setState({dialogVisible:!1,dialogActiveReactionKey:n.getDefaultReactionKey()}),n.props.onReactionDetailClose&&n.props.onReactionDetailClose()},n.handleMoreClick=function(e,t){n.setState({dialogVisible:!0,dialogActiveReactionKey:e}),n.props.onMoreClick&&n.props.onMoreClick(e,t)},n.state={dialogVisible:!1,dialogActiveReactionKey:n.getDefaultReactionKey()},n.locale=Object(F.getLocale)(),n}return v()(t,e),d()(t,[{key:"getDefaultReactionKey",value:function(){return this.props.reactions&&0<this.props.reactions.length?this.props.reactions[0].reactionKey:"THUMBSUP"}},{key:"render",value:function(){var n=this,e=this.props,t=e.reactions,i=e.lang,r=e.onReactionClick;return o.a.createElement(H.b,{locale:this.locale,theme:H.a.light,lang:i},o.a.createElement("div",{className:"reaction-list-rewrite"},t.map(function(e,t){return o.a.createElement(B,{key:t,reaction:e,onUserClick:n.handleUserClick,onReactionClick:r,onMoreClick:n.handleMoreClick})})),this.state.dialogVisible&&o.a.createElement(N.a,{reactions:t,activeReactionType:this.state.dialogActiveReactionKey,onUserClick:this.handleUserClick,onClose:this.handleClose}))}}]),t}(o.a.PureComponent));n.d(t,"b",function(){return W}),n.d(t,"a",function(){return K}),Object(P.b)();var W=a()({loader:function(){return Object(P.a)(Object(F.getLocale)())},loading:function(){return null},render:function(e,t){return o.a.createElement(V,Object.assign({},t,{lang:e}))}});W.preload();var K=a()({loader:function(){return Promise.all([Object(P.a)(Object(F.getLocale)()),Promise.all([n.e("commons--home_banner--reaction--user_profile--whats_new_request"),n.e("commons--reaction--user_profile"),n.e("reaction")]).then(n.bind(null,"buzE"))])},loading:function(){return o.a.createElement(s.a,{width:"16",height:"16",className:"reaction-svg-placeholder"})},render:function(e,t){var n=e[0],i=e[1].Reaction;return o.a.createElement(i,Object.assign({},t,{lang:n}))}})},"182n":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("YNKm"),r=[i.s,i.t,i.u,i.v,i.w,i.x,i.y,i.z,i.A]},"1BX5":function(e,i,r){"use strict";(function(m){r.d(i,"a",function(){return n});var e=r("J4zp"),v=r.n(e),b=r("q1tI"),y=r.n(b),E=r("UlbS"),O=r("4DL9"),t=r("nN3d"),C=r("gpe9"),k=(r("fOP3"),[{formatter:t.g,transformer:t.k,checker:function(e){return/^[ivxlcdm]*$/i.test(e)}},{},{formatter:t.f,transformer:t.j,checker:function(e){return/^[a-zA-Z]*$/.test(e)}}]);function n(i){var t=i.listInfo,n=Object(b.useRef)(t.order),r=Object(b.useRef)(null),o=Object(b.useRef)(t.order),e=Object(b.useState)({}),a=v()(e,2),s=a[0],c=a[1],l=t.level%3,u=function(){return k[l].formatter},d=function(){return k[l].transformer},h=function(){return k[l].checker},f=function(e,t){n.current=e,o.current=t},p=function(){var e=i.onConfirm;"function"==typeof e&&e(t.zoneId,t.lineNum,n.current,o.current)},g=function(e){(r.current=e)&&i.popupContainerRef&&i.popupContainerRef(e)};return Object(b.useEffect)(function(){var e,t,n;r.current&&(e=window.getComputedStyle(r.current),t=parseInt(e.height||"0",10),n=parseInt(e.width||"0",10),t&&c(i.calcRenderStyle(t,n,C.a.BOTTOM,!0)))},[s.left,s.top]),y.a.createElement("div",{className:"list-input-number-popup",style:s,onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},ref:g},y.a.createElement("span",{className:"input-title"},m("doc.list.the_new_number_is")),y.a.createElement(O.a,{defaultValue:t.order,formatter:u(),transformer:d(),checker:h(),onValueUpdate:f,onEnterKeyUp:p}),y.a.createElement("div",{className:"confirm-btn-wrap"},y.a.createElement(E.Button,{className:"confirm-btn",type:"primary",onClick:p},m("common.determine"))))}}).call(this,r("2vAP"))},"1CG5":function(e,t,n){"use strict";var i=n("on5/"),r=n("BMm3"),o=n("U5G9"),c=n("FJEn").Changeset.numToString;function a(e,o){var a=e.getRepManager().apool,t=a.numToAttrib,s=[];if(Object.keys(t).forEach(function(e){var t,n=Number(e),i=a.getAttribKey(n),r=a.getAttribValue(n);o(i,r)&&(t=c(n),s.push(t))}),s&&0!==s.length)return new RegExp("\\*(".concat(s.join("|"),")[+\\*|]"))}var s=n("X4VC");n.d(t,"a",function(){return u});var l=!1;function u(){l||(l=!0,Object(i.setupAttributePositionManagerServices)({Utils:{joinable:r.d,joinPosition:r.c,charToPosition:r.a,findDocPositions:r.b,getExistZoneIdsInEditor:s.a,pluginChangesetHelper:Object(o.b)({module:o.a.ATTRIBUTE_POSITION}),getAttributeMatchRegex:a}}))}},"1D29":function(e,t,i){"use strict";i.d(t,"a",function(){return f});var n=i("o0o1"),r=i.n(n),o=i("yXPU"),a=i.n(o),s=i("lwsE"),c=i.n(s),l=i("W8MJ"),u=i.n(l),d=i("1lbP"),h=i("oJoF"),f=(i("qCz6"),function(){function n(e){var t=this;c()(this,n),this.editor=e,this.editable=!1,this.inlineDraggable=null,this.rxOp=new d.a,this.editor.on(h.c,function(){return t.loadDraggableIfNeeded()})}function e(){return t.apply(this,arguments)}var t;return u()(n,[{key:"loadDraggableIfNeeded",value:(t=a()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inlineDraggable)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,this.rxOp.toPromise(Promise.all([i.e("doc_index_css"),i.e("chunk_adit"),i.e("commons--doc_index_delay--voteEmoji--votePicker"),i.e(16),i.e("commons--doc_index_delay--jira"),i.e("doc_index_delay")]).then(i.bind(null,"YCmN")));case 4:t=e.sent,this.inlineDraggable=new t.InlineDraggable(this.editor),this.editable?this.inlineDraggable.enable():this.inlineDraggable.disable();case 7:case"end":return e.stop()}},e,this)})),e)},{key:"changesetApply",value:function(e,t){this.inlineDraggable&&this.inlineDraggable.changesetApply(e,t)}},{key:"pluginReadOnly",value:function(){this.editable=!1,this.inlineDraggable&&this.inlineDraggable.disable()}},{key:"pluginReadWrite",value:function(){this.editable=!0,this.inlineDraggable&&this.inlineDraggable.enable()}},{key:"destroy",value:function(e){this.inlineDraggable&&(this.inlineDraggable.destroy(),this.inlineDraggable=null),this.rxOp.destroy()}}]),n}())},"1I8I":function(e,t,n){"use strict";n.d(t,"c",function(){return O}),n.d(t,"b",function(){return U}),n.d(t,"a",function(){return H});var i=n("o0o1"),d=n.n(i),r=n("yXPU"),o=n.n(r),a=n("fujP"),u=n("xA8S"),h=n("HmyT"),f=n("Jn5N"),s=n("v2N6"),c=n("pylR"),l=n("Xngx"),p=n("PI5S"),g=n("m9Pg"),m=n("rLED"),v=n("Mvmg"),b=n("EAIz"),y={},E=["beforeFileQueued","fileQueued","filesQueued","fileDequeued","reset","startUpload","stopUpload","uploadFinished","uploadStart","uploadBeforeSend","uploadAccept","uploadProgress","uploadError","uploadSuccess","uploadComplete","error"];function O(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"default";if(y[e]){var t=y[e].instance;try{t.destroy(),y[e].triggerBtn&&y[e].triggerBtn.remove(),s.a(),"default"===e&&x(!1,e),delete y[e],delete z[e]}catch(e){console.warn("destroy uploader")}}}function C(e){var t,n=y[e].triggerBtn;n&&((t=Object(h.$)(n).find("input[name=file]")).attr("accept","image/gif, image/jpg, image/jpeg, image/bmp, image/png"),t.click(function(e){e.stopPropagation()}),Object(h.$)(n).find("label").click(function(e){e.stopPropagation()}).trigger("click"),t.attr("accept","*"))}function k(e,t){var n=document.querySelector(t);return n&&n.contains(e)}function I(e,t){var n,i,r;k(e.target,".bitable-editor-container")||e.target.className&&e.target.className.includes("spreadsheet-canvas")||y[t].instance.enableDropImage&&(e.preventDefault(),e.stopImmediatePropagation(),e.dataTransfer&&(i=(n=e.dataTransfer).items,r=n.files,i?S(i,t):r&&_(r,t)))}function S(e,t){return T.apply(this,arguments)}function T(){return(T=o()(d.a.mark(function e(t,n){var i,r,o,a,s,c,l,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return");case 2:for(i=Array.from(t),r=[],o=0,a=i;o<a.length;o++)(s=(s=a[o]).webkitGetAsEntry())&&s.isFile&&(c=L(s),r.push(c));l=0;case 6:if(l<r.length)return e.next=9,r[l];e.next=16;break;case 9:return u=e.sent,e.next=12,N(u);case 12:r[l]=u;case 13:l++,e.next=6;break;case 16:w(r,n);case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(e,t){w(Array.from(e),t)}function w(e,t){if(e&&0<e.length){for(var n=0;n<e.length;n++)e[n].logSource="drag";j({imgFiles:e.filter(function(e){return M(e)}),otherFiles:e.filter(function(e){return!M(e)})},t)}}function j(e,t){var n=e.imgFiles,i=void 0===n?[]:n,r=e.otherFiles,o=void 0===r?[]:r;Object(a.default)(i)||(Object(m.Q)()?i.forEach(function(e){g.a&&g.a.upload(e)}):y[t].instance.addFile(i)),Object(a.default)(o)||o.forEach(function(e){e.source=v.i.DRAG,Object(p.c)(e)})}function M(e){return!!e.type&&!!e.type.match(/image\/(gif|jpg|jpeg|bmp|png)$/)}function L(t){return new Promise(function(e){t.file(e)})}var R=["gif","jpg","jpeg","bmp","png"];function N(e){return D.apply(this,arguments)}function D(){return(D=o()(d.a.mark(function e(t){var n,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(l.d)(t.name),R.includes(n))return e.abrupt("return");e.next=3;break;case 3:return e.next=5,Object(c.a)(t);case 5:i=e.sent,s.b(t,i);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function x(e,t){var n,i=document.getElementById("innerdocbody");i&&(n=y[t].dropHandler,e?i.addEventListener("drop",n,{capture:!0}):i.removeEventListener("drop",n,{capture:!0}))}var P=function(e){return function(){return e.resolve()}},B=function(e){return function(){return e.reject()}},U=function(e){delete z[e]},z={};function H(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default",n=e.editorInfo,i={"F-Version":window&&window.rv_rev||""};b.e&&Object.assign(i,Object(b.d)());var r,o,a,s,c,l=Object(u.a)();return l&&(i.Env=l),y[t]||(y[t]={},r=Object(h.$)('<div style="width:0;overflow:hidden;"></div>'),y[t].triggerBtn=r,Object(h.$)("body").append(r),"default"===t&&(o=[".spreadsheet",".bitable-editor-container"]),(a=f.default.create({server:"",auto:!0,paste:n.getInnerContainer(),pick:r,method:"POST",multiple:!0,threads:10,fileNumLimit:100,headers:i,withCredentials:!0,duplicate:!0,dnd:n.getInnerContainer(),ignoreDragElement:[".spreadsheet",".bitable-editor-container",".attach-cover"],ignorePasteElement:o,compress:{quality:100,allowMagnify:!1,crop:!1,scale:1,preserveHeaders:!1}})).open=function(){return C(t)},a.enableDropImage=!0,s=a.on,c={},a.on=function(e,t,n){e.split(",").map(function(e){return e.trim()}).filter(function(e){return!!e}).forEach(function(e){c[e]||(c[e]={}),c[e][t]=n})},y[t].instance=a,y[t].dropHandler=function(e){return I(e,t)},E.forEach(function(r){s.call(a,r,function(){var e,t="*";0<arguments.length&&((e=(e=arguments[0]).file||e)instanceof f.default.File&&(t=(t=e.name.split(".").pop())&&t.toLowerCase()));var n=c[t]||c["*"];if(n){var i=n[r];if(i)return i.apply(void 0,arguments)}})}),"default"===t&&x(!0,t)),y[t].instance}f.default.Uploader.register({"before-send-file":"beforeSendFile"},{beforeSendFile:function(e){var t=f.default.Deferred(),n=e.comment;if(n&&!n.replyId&&n.commentService)if(z[n.uniqueId]){var i=z[n.uniqueId],r=i.resolveCb,o=i.rejectCb,a=i.succeed;if(void 0!==a)return setTimeout(function(){a?t.resolve():t.reject()}),t.promise();r.push(P(t)),o.push(B(t))}else{var s=n.commentService.genReplyId({commentId:n.commentId});z[n.uniqueId]={resolveCb:[],rejectCb:[]},s.then(function(e){n.replyId=e.replyId,t.resolve(),z[n.uniqueId].resolveCb.forEach(function(e){return e()}),z[n.uniqueId].resolveCb.length=0,z[n.uniqueId].rejectCb.length=0,z[n.uniqueId].succeed=!0}).catch(function(e){console.error(e),t.reject(),z[n.uniqueId].rejectCb.forEach(function(e){return e()}),z[n.uniqueId].resolveCb.length=0,z[n.uniqueId].rejectCb.length=0,z[n.uniqueId].succeed=!1})}else n&&n.replyId&&z[n.uniqueId]&&delete z[n.uniqueId],setTimeout(function(){t.resolve()});return t.promise()}})},"1PvN":function(e,R,N){"use strict";(function(n){N.d(R,"b",function(){return L});var r,e=N("RIqP"),i=N.n(e),t=N("o0o1"),d=N.n(t),o=N("yXPU"),a=N.n(o),s=N("1myf"),p=N("XIp8"),g=N("OZf9"),v=N("HmyT"),c=N("PyL4"),b=N("iP/4"),y=N("FJEn"),m=N("H6oK"),l=N("79iT"),u=N("Vr4U"),h=N("PFEC"),f=N("U5G9"),E=N("DVUE"),O=N("q1tI"),C=N.n(O),k=N("i8i4"),I=N.n(k),S=N("okfw"),T=y.contentcollector.makeContentCollector,_=Object(f.b)({module:f.a.HISTORY}),w={showLoading:function(e,t){if(t=t||{},void 0===e)throw new Error("argument[0] must be a selector");Object(v.$)(e).append('<span class="spiner '.concat(t.class||"center",'">\n      <span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span>\n    </span>'))},hideLoading:function(e){if(void 0===e)throw new Error("argument[0] must be a selector");Object(v.$)(e).find(".spiner").remove()},getHtmlNewAlines:function(e,t,n,i){var r=new h.a(n,t);e.forEach(function(e){e.zone_id||(e.zone_id="0")});var o=r.getNewAlines(e),a=r.getInitClientVars(),s=(w.getTransformClientVars(a),document.createElement("div"));return i.appendChild(s),s.className="doc-history-list innerdocbody syntax flex",new Promise(function(n){I.a.render(C.a.createElement(E.a,{className:s.className,role:"application",spellCheck:!1,contentEditable:!1,editable:!1,idleWorkTimer:!1,autoCorrect:!1,clientVars:a,enableVirtualScroll:!1,registerPlugin:function(e){return e.pure=!0,e.isInSideHistory=!0,e.containerCls=".doc-history-common",[new u.default(Object.assign({editor:e},e,{type:"doc",postAddMentionId:!1,hoverArea:".doc-history-revert__editot",showChatCards:!1,source:"history",container:".doc-position"}))].concat(Object(l.a)(e,{}))},onInit:function(e){var t=function(){Object(v.$)(".preview-cover-img",s).each(function(e,t){t.setAttribute("onerror",'this.removeAttribute("onerror"); this.parentNode.classList.add("drive-cover-preview-error");')});var e=Array.from(s.childNodes).map(function(e){return Object(v.$)(e).height(""),e.outerHTML}),t=r.handleTableHtml(e);n({htmls:t,newAlines:o}),I.a.unmountComponentAtNode(s)};e.once("paint",function(){setTimeout(t,0)})}}),s)})},renderAlines:(r=a()(d.a.mark(function e(t,n,i,r){var o,a,s,c,l,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],a=void 0,s="",e.next=5,w.getHtmlNewAlines(t,n,i,r);case 5:return c=e.sent,l=c.htmls,u=c.newAlines,e.abrupt("return",new Promise(function(e){Object(g.a)(u,function(e,t){var n=l[t];/("|\s)(__edit_add|__edit_del)/.test(n)||(n=""),void 0===a?s=n:a===e.index-1?s+=n:(0<s.length&&o.push(s),s=n),a=e.index}),0<s.length&&o.push(s),e(o)}));case 9:case"end":return e.stop()}},e)})),j),handleBlockContent:function(e,t,n){var i=new y.AttributePool,r=t.name,o=(t.obj_token,t.revision_range),a=r.split("#").join("_").slice(r.indexOf("/")+1),s=!1,c=Object(m.getBlockDatasetByToken)(a);c||(s=!0,c=Object(m.generateBlockDataSet)({blockType:n}));var l=i.putAttrib(["__edit_add",!0]).toString(36),u=i.putAttrib(["__edit_del",!0]).toString(36),d=i.putAttrib(["dataMetaBlockProps",JSON.stringify(c)]).toString(36),h=s?u:l,f={alines:[{text:" \n",attribs:"*".concat(d,"*").concat(h,"+1*").concat(h,"|1+1"),index:0,zone_id:"0"}],apool:JSON.stringify(i.toJsonable()),revision_range:o};return Object.assign({},e,{blockInfo:t,content:f})},formatData:function(e,t){var n=void 0,i=t.putAttrib(["__edit_add",!0],!0).toString(36),r=t.putAttrib(["__edit_del",!0],!0).toString(36),o=t.putAttrib(["insertorder","first"],!0).toString(36),a=new RegExp("^(?:\\*[a-zA-Z0-9]+)*\\*"+o+"(?:\\*[a-zA-Z0-9]+)*\\+1");null!==(n=a.exec(e.attribs))&&0===e.text.indexOf("*")&&(e.attribs=e.attribs.replace(a,""),e.text=e.text.substring(1)),a=new RegExp("(?:\\*[\\da-z]+)*\\*(?:"+i+"|"+r+")(?:\\*[\\da-z]+)*\\+[\\da-z]+","g");var l=e.attribs.split(a),u=e.attribs.match(a),d=_.stringIterator(e.text),h="",f=[];Object(g.a)(l,function(e,t){for(var n=void 0,i=[],r="",o=_.opIterator(e);o.hasNext();)n=o.next(),i.push(Object(p.default)(n)),r+=d.take(n.chars);var a,s=0!==t,c=t!==l.length-1,i=w.changeOpsByTextLength(i,s,c,r.length),r=w.substr(r,s,c);null!=u&&u.length&&(a=u.shift(),n=_.opIterator(a).next(),i.push(n),r+=d.take(n.chars)),f=f.concat(i),h+=r}),e.attribs=w.joinAttribs(f),e.text=h,n&&(e.attribs=n[0]+e.attribs,e.text="*"+e.text)},changeOpsByTextLength:function(e,t,n,i){var r=void 0,o=[],a=0;if(t&&n){if(40<i){for(var s=Array.from(e),c=0;c<s.length;c++)if(20<(a+=(r=s[c]).chars)&&(r.chars-=a-20),o.push(Object(p.default)(r)),20<=a){o.push(w.format());break}for(var l=[],a=0,u=Array.from(e.reverse()),d=0;d<u.length&&(20<(a+=(r=u[d]).chars)&&(r.chars-=a-20),l.push(Object(p.default)(r)),!(20<=a));d++);return o.concat(l.reverse())}}else if(20<i&&(t||n)){t&&(e=Array.from(e)),n&&(e=Array.from(e.reverse()));for(var h=0;h<e.length;h++)if(20<(a+=(r=e[h]).chars)&&(r.chars-=a-20),o.push(Object(p.default)(r)),20<=a){o.push(w.format());break}if(t)return o;if(n)return o.reverse()}return e},substr:function(e,t,n){if(t&&n){if(40<e.length)return e.substr(0,20)+"......"+e.substr(-20)}else if(t){if(20<e.length)return e.substr(0,20)+"......"}else if(n&&20<e.length)return"......"+e.substr(-20);return e},joinAttribs:function(e){return v.$.map(e,function(e){return e.attribs+e.opcode+e.chars.toString(36)}).join("")},format:function(){return{attribs:"",opcode:"=",chars:6}},className2Author:function(e){return"author-"==e.substring(0,7)?e.substring(7).replace(/[a-y0-9]+|-|z.+?z/g,function(e){return"-"==e?".":"z"==e.charAt(0)?String.fromCharCode(Number(e.slice(1,-1))):e}):null},getAlinesData:function(e,t,n){var i=Array.from(Object(v.$)(e)).find(function(e){return Object(v.$)(e).hasClass("innerdocbody")}).outerHTML,r=[],o=document.createElement("div"),a=new y.AttributePool;a.putAttrib(["author",t.toString()]),o.innerHTML=i;var s={changesetHelper:_},c=T({collectStyles:!0,abrowser:b.a,apool:a,className2Author:w.className2Author,mode:"history",hooks:n,forPaste:!0,editor:s});c.collectContent(o);var l=c.finish();Object.keys(l.additionalZatext.attribs).length&&r.push(l.additionalZatext);var u=l.lines,d=l.lineAttribs,h="",f="";d.forEach(function(e){return h+=e.replace(/\+/g,function(e){return"*0".concat(e)})+"*0|1+1"}),u.forEach(function(e){return f+=e+"\n"});var p={};if(l.additionalZatext.attribs)for(var g in l.additionalZatext.attribs){var m=g[0];"c"!==m&&"r"!==m||(p[g]=l.additionalZatext.attribs[g],delete l.additionalZatext.attribs[g])}return l.additionalZatext.attribs[0]=h,{apool:a,initialAttributedText:{text:l.additionalZatext.text[0]=f,attribs:h},tableMeta:p,initialAttributedTexts:l.additionalZatext}},formatDataFromLocal:function(e,t){return Object(s.a)([].concat(i()(e),i()(t)),function(e){return-e.startTime}).map(function(e){var t=e.memberId,n=e.startTime,i=e.content;return{key:"".concat(t,"-").concat(n),data:i,time:n}})},formatHistoryRecordsFromLocal:function(e){return Object(s.a)(e,function(e){return-e.startTime}).map(function(e){var t=e.type,n=e.memberId,i=e.startTime,r=e.UIData;return{key:"".concat(t,"-").concat(n,"-").concat(i),data:r,time:i}})},renderSheetPlaceHolder:function(e){Object(v.$)("".concat(e," .sheet")).html(w.getSheetPlaceHolderHtml())},renderSheetPlaceHolderBySpan:function(e){e.innerHTML=w.getSheetPlaceHolderHtml()},getSheetPlaceHolderHtml:function(){for(var e="",t=0;t<24;t++)e+="<span></span>";return'<div class="sheet-placeholder"><div class="sheet-placeholder-t">'.concat(n("common.form"),'</div><div class="sheet-placeholder-b clearfix">').concat(e,"</div></div>")},getTransformClientVars:function(e){var i=e.apool,r=e.initialAttributedTexts.attribs;return Object.keys(r).forEach(function(e){var t=r[e],n=S.a.getChangeBlockIdForOp(t,i);r[e]=n}),e}};function j(e,t,n,i){return r.apply(this,arguments)}function M(e,t){var n=t.desc,i=t.content;n&&e.find(".mention-chat-ct").append('<div class="mention-chat-desc">'.concat(Object(c.escapeHTML)(n),"</div>")),e.find(".mention-chat-tit").html(Object(c.escapeHTML)(i)).addClass(n?"mt12":""),e.find(".mention-chat-button").remove()}function L(e,t,n,i){var r=n.content,o={url:n.url,desc:n.desc,content:r,chatId:t},a=Object(v.$)(".".concat(i," .mention-chatId_").concat(t)),s=a.length;if(s)for(var c=0;c<s;c++){var l=a.eq(c);""===l.find(".mention-chat-tit").html().trim()&&M(l,o)}}R.a=w}).call(this,N("2vAP"))},"1QvZ":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){var t=e.styles,n=void 0===t?{}:t,i=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"200",height:"200",className:n.icon||"icon",viewBox:"0 0 1024 1024"},i),c.a.createElement("defs",null),c.a.createElement("path",{fill:"#AFAFAF",d:"M624.66 785.14A38.94 38.94 0 01639 731.97a38.94 38.94 0 0153.21 14.17l90.13 156.1A38.94 38.94 0 01768 955.4a38.94 38.94 0 01-53.21-14.17l-90.13-156.1z"}),c.a.createElement("path",{fill:"#D1D1D1",d:"M241.66 121.76A38.94 38.94 0 01256 68.6a38.94 38.94 0 0153.21 14.17l90.13 156.1A38.94 38.94 0 01385 292.03a38.94 38.94 0 01-53.21-14.17l-90.13-156.1z"}),c.a.createElement("path",{fill:"#9D9D9D",d:"M238.86 624.66A38.94 38.94 0 01292.03 639a38.94 38.94 0 01-14.17 53.21l-156.1 90.13A38.94 38.94 0 0168.6 768a38.94 38.94 0 0114.17-53.21l156.1-90.13z"}),c.a.createElement("path",{fill:"#C2C2C2",d:"M902.24 241.66A38.94 38.94 0 01955.4 256a38.94 38.94 0 01-14.16 53.21l-156.1 90.13A38.94 38.94 0 01731.97 385a38.94 38.94 0 0114.17-53.21l156.1-90.13z"}),c.a.createElement("path",{fill:"#A3A3A3",d:"M331.79 746.14A38.94 38.94 0 01385 731.97a38.94 38.94 0 0114.34 53.17l-90.13 156.1A38.94 38.94 0 01256 955.4a38.94 38.94 0 01-14.34-53.17l90.13-156.1z"}),c.a.createElement("path",{fill:"#C8C8C8",d:"M714.79 82.76A38.94 38.94 0 01768 68.6a38.94 38.94 0 0114.34 53.17l-90.13 156.1A38.94 38.94 0 01639 292.03a38.94 38.94 0 01-14.34-53.17l90.13-156.1z"}),c.a.createElement("path",{fill:"#949494",d:"M277.86 331.79c18.6 10.73 24.94 34.56 14.17 53.21s-34.57 25.07-53.17 14.34L82.76 309.2A38.94 38.94 0 0168.6 256a38.94 38.94 0 0153.17-14.34l156.1 90.13z"}),c.a.createElement("path",{fill:"#B6B6B6",d:"M941.24 714.79A38.94 38.94 0 01955.4 768a38.94 38.94 0 01-53.16 14.34l-156.1-90.13A38.94 38.94 0 01731.97 639a38.94 38.94 0 0153.17-14.34l156.1 90.13z"}),c.a.createElement("path",{fill:"#999",d:"M219.12 473c21.47 0 38.88 17.46 38.88 39s-17.4 39-38.88 39H38.88C17.4 551 0 533.54 0 512s17.4-39 38.88-39h180.24z"}),c.a.createElement("path",{fill:"#BBB",d:"M985.12 473c21.47 0 38.88 17.46 38.88 39s-17.4 39-38.88 39H804.88C783.4 551 766 533.54 766 512s17.4-39 38.88-39h180.24z"}),c.a.createElement("path",{fill:"#CDCDCD",d:"M551 219.12c0 21.47-17.46 38.88-39 38.88s-39-17.4-39-38.88V38.88C473 17.4 490.46 0 512 0s39 17.4 39 38.88v180.24z"}),c.a.createElement("path",{fill:"#A9A9A9",d:"M551 985.12c0 21.47-17.46 38.88-39 38.88s-39-17.4-39-38.88V804.88c0-21.47 17.46-38.88 39-38.88s39 17.4 39 38.88v180.24z"}))}},"1cTk":function(e,t,n){},"1lbP":function(e,t,n){"use strict";n.d(t,"b",function(){return h}),n.d(t,"a",function(){return f});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("K9Ia"),c=n("0/uQ"),l=n("VnD/"),u=n("t9fZ"),d=n("ny24");function h(t){return function(e){return e.pipe(Object(l.a)(t),Object(u.a)(1))}}var f=function(){function e(){r()(this,e),this.destroy$=new s.a}return a()(e,[{key:"takeUntil",value:function(){return Object(d.a)(this.destroy$)}},{key:"from",value:function(e){return Object(c.a)(e).pipe(this.takeUntil())}},{key:"toPromise",value:function(s){var c=this;return new Promise(function(e,t){var n,i=!1,r=function(e){i=!0,n=e},o=t,a=function(){i&&e(n)};c.from(s).subscribe(r,o,a)})}},{key:"destroy",value:function(){this.destroy$.next(),this.destroy$.complete()}}]),e}()},"1tpT":function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var i=n("jp/M"),r=function(e){return{type:i.actionTypes.messagePosition.SET_MESSAGE_POSITION_DATA,payload:e}},o=function(e){return{type:i.actionTypes.messagePosition.SET_ACTIVE_NOTIFICATION,payload:e}}},"1vGr":function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"e",function(){return s});var i=1015,r=9999,o=1e5,a=1021,s=[1,1005,1014,1012,1016,1008,1012,1013,1017,1020,1023,1024,1025,1217]},"1xqC":function(e,h,f){"use strict";(function(n){f.d(h,"a",function(){return d});var e=f("lwsE"),i=f.n(e),t=f("W8MJ"),r=f.n(t),o=f("HIeq"),a=f("2ACu"),s=f("Mvmg"),c=f("XDjv"),l=f("uEBw"),u=f("OX8E"),d=function(){function t(e){i()(this,t),this.progress=0,this.started=!1,this.canceled=!1,this.isDone=!1,this.editorInfo=e.editorInfo,this.file=e.file,this.id=this.file.uuid,this.handleUploadEnd=e.handleUploadEnd,this.driveUploader=e.docUploaderCreator({parentToken:Object(o.e)(),mountPoint:s.a},{onTasksAdded:this.onTasksAdded.bind(this),onTaskSuccess:this.onTaskSuccess.bind(this),onTaskError:this.onTaskError.bind(this),onComplete:this.onComplete.bind(this),onFileProgress:this.onFileProgress.bind(this)}),this.createFileController()}return r()(t,[{key:"startUpload",value:function(){var e=this.file.event;this.handleTeaLog({status:"start_upload"}),this.driveUploader.addFile(this.file,e)}},{key:"onTasksAdded",value:function(){this.driveUploader.upload()}},{key:"onTaskSuccess",value:function(e){this.isDone=!0;var t=e.fileToken;this.updateFileController(t),this.handleUploadEnd(this.id),this.handleTeaLog({status:"success"})}},{key:"onTaskError",value:function(e){this.isDone=!0,this.canceled||Object(l.g)("".concat(this.file.name.substring(0,10)," ").concat(n("mention.uploader_failure"))),this.deleteFileController(),this.handleTeaLog({status:"fail"}),this.handleUploadEnd(this.id)}},{key:"onComplete",value:function(){}},{key:"onFileProgress",value:function(){var e=this.driveUploader.progress,e=Math.round(100*e);this.progress!==e&&(this.progress=e,u.a.emit(s.b,e,this.id))}},{key:"cancelUpload",value:function(){this.canceled=!0,this.driveUploader.cancelAll(),this.isDone=!0,this.handleUploadEnd(this.id),this.handleTeaLog({status:"cancel"})}},{key:"createFileController",value:function(){var e=this.file,t=Object(o.d)();this.fileController=new c.a(this.id,{editorInfo:this.editorInfo}),this.fileController.insertPlaceholder(e,{uploadOwner:t,atUuid:e.atUuid})}},{key:"updateFileController",value:function(e){e&&this.fileController.updateDriveKey(e)}},{key:"deleteFileController",value:function(){this.fileController.deleteFileCard()}},{key:"handleTeaLog",value:function(e){var t=this.file,n=e.status,i=t.source,r=i===s.i.DRAG?"mention_drag_upload":"client_uploader_file",o=t.name.split(".").pop()||"unknown";Object(a.default)(r,{upload_status:n||"fail",mention_file_length:t.size,mention_file_type:o,create_source:i})}},{key:"isUploading",get:function(){return this.driveUploader.isUploading}}]),t}()}).call(this,f("2vAP"))},"29OK":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 16 16"},t),c.a.createElement("g",{fillRule:"evenodd"},c.a.createElement("path",{d:"M-54-4h16v16h-16z"}),c.a.createElement("path",{d:"M3.7 7c.17 0 .3.13.3.3v1.4a.3.3 0 01-.3.3H2.3a.3.3 0 01-.3-.3V7.3c0-.17.13-.3.3-.3h1.4zm5 0c.17 0 .3.13.3.3v1.4a.3.3 0 01-.3.3H7.3a.3.3 0 01-.3-.3V7.3c0-.17.13-.3.3-.3h1.4zm5 0c.17 0 .3.13.3.3v1.4a.3.3 0 01-.3.3h-1.4a.3.3 0 01-.3-.3V7.3c0-.17.13-.3.3-.3h1.4z"})))}},"2BcA":function(e,C,k){"use strict";(function(n){k.d(C,"a",function(){return O});var e=k("lwsE"),i=k.n(e),t=k("W8MJ"),r=k.n(t),o=k("a1gu"),a=k.n(o),s=k("Nsbk"),l=k.n(s),c=k("7W2i"),u=k.n(c),d=k("3Hq1"),h=k("hbEN"),f=k("q1tI"),p=k.n(f),g=k("TSYQ"),m=k.n(g),v=k("OuIN"),b=k("xi4d"),y=k("m3gH"),E=k("rLED"),O=function(e){function t(){var c;return i()(this,t),(c=a()(this,l()(t).apply(this,arguments))).state={showGoFirstCommentBtn:!1},c.calFirstCommentBtn=function(e){var t=c.props.commentList;if(t.find(function(e){return!e.isSubmitted}))c.setState({showGoFirstCommentBtn:!1});else if(0!==t.length){var n=c.props.getAnimationRef();if(n){var i,r=n.getStyles().get(t[0].commentId);if(!r||"boolean"==typeof e&&e){if(i=t[0].top,Object(d.default)(i))return void c.setState({showGoFirstCommentBtn:!0})}else i=r.top;var o=c.getScrollContainer(),a=y.a.isInFullscreen()?0:b.a,s=!1,s=!(i-(o.offsetHeight-a)<o.scrollTop);c.setState({showGoFirstCommentBtn:s})}}else c.setState({showGoFirstCommentBtn:!1})},c.handleWindowResize=Object(h.default)(function(){c.calFirstCommentBtn()},50),c.handleScrollContainerScroll=Object(h.default)(function(e){c.calFirstCommentBtn(e)},20),c}return u()(t,e),r()(t,[{key:"getScrollContainer",value:function(){return this.props.editor.getScrollContainer()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),Object(E.j)()&&this.getScrollContainer().addEventListener("scroll",this.handleScrollContainerScroll)}},{key:"componentDidUpdate",value:function(e){var t,n,i;!Object(E.j)()||(t=e.commentList)!==(n=this.props.commentList)&&(t.length||n.length)&&(i=n.length&&t.length&&n[0].top!==t[0].top,this.handleScrollContainerScroll(i))}},{key:"componentWillUnmount",value:function(){var e;window.removeEventListener("resize",this.handleWindowResize),!Object(E.j)()||(e=this.getScrollContainer())&&e.removeEventListener("scroll",this.handleScrollContainerScroll),this.handleWindowResize.cancel(),this.handleScrollContainerScroll.cancel()}},{key:"render",value:function(){var e=this.state.showGoFirstCommentBtn;return p.a.createElement("div",{className:m()("doc-comment__first-comment-btn",{"doc-comment__first-comment-btn--show":e}),onClick:this.props.handleGoFirstComment},p.a.createElement(v.a,null),p.a.createElement("span",null,n("comment.go_first_comment")))}}]),t}(f.PureComponent)}).call(this,k("2vAP"))},"2IHA":function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s});var i,r,o,l=n("gSGL"),u=n("D1oa"),d=Boolean(window.crypto&&window.crypto.subtle);function a(o,a,s,c){return new Promise(function(e,t){var n,i,r;d?(n=window.crypto.subtle,i=Object(l.a)(a)?Object(u.c)(a):a,r=Object(l.a)(s)?Object(u.c)(s):s,n.importKey("raw",i,c,!1,["decrypt"]).then(function(e){return n.decrypt({name:c,iv:r,tagLength:128},e,o)}).then(e).catch(t)):t(new Error("web crypto not support for decrypt"))})}function s(r,o){return new Promise(function(e,t){var n,i;d?(n=window.crypto.subtle,i=Object(l.a)(r)?Object(u.c)(r):r,n.digest(o,i).then(e)):t(new Error("web crypto not support for digest"))})}(r=i=i||{})["AES-GCM"]="AES-GCM",r["AES-CBC"]="AES-CBC",(o=o||{})["SHA-256"]="SHA-256"},"2IYG":function(e,t,n){"use strict";n.d(t,"f",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"g",function(){return h}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"b",function(){return g}),n.d(t,"a",function(){return m});var i=n("lwsE"),Se=n.n(i),r=n("W8MJ"),Te=n.n(r),o=n("o0o1"),_e=n.n(o),a=n("yXPU"),we=n.n(a),je=n("SYRc"),Me=n("H6oK"),Ae=n("NVF8"),s=n("9+78"),Le=n.n(s),Re=n("2ACu"),Ne="source_file_type",c=null,l=null,u=function(){var e=we()(_e.a.mark(function e(){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=c||new Promise(function(t,n){Object(Ae.a)("bitable").then(function(e){return e.bridge()}).then(function(e){l=e.EmbeddedBitableManager,t()},function(e){console.error("load DocBitableBridge error",e),n(e)})}),e.abrupt("return",c);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),d=function(){return!!l},h=function(e,t,n,i){return l.pasteBitableWithoutBridge(e,t,n,i)},f=function(e){return l.getInitCSWithoutBridge(e)},p=function(e){return l.getInitKanbanCSWithoutBridge(e)},g=function(e){return l.getBitablePasteDataWithoutBridge(e)};function De(e){if(e)try{var t=e[Ne];return JSON.parse(t)}catch(e){return!1}return!1}var m=function(){function e(){var o=this;Se()(this,e),this.bitableManager=null,this.initBitableJsStartTime=performance.now(),this.previewHistory=function(){var n=we()(_e.a.mark(function e(t,n){var i,r;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.revInfo,r=t.changesets,o.localHistoryChangeset=r,o.revInfo=i,e.next=5,o.checkManagerReady();case 5:if(!o.bitableManager){e.next=12;break}if(e.t0=o.bitableManager,e.t0)return e.next=10,o.bitableManager.previewHistory(t);e.next=11;break;case 10:e.t0=e.sent;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),this.getBlockToken=function(e){return[o.token,e].join("_")},this.getTableIdFromMention=function(n,e){var t=De(e);if(t&&t.tableId){var i=t.tableId,r=o.getAllMention()||{};return r[i]&&r[i][n]||(i=Object.keys(r).find(function(e){var t=r[e];return!(!t||!t[n])})),i}return null},this.getResolvedComments=function(e){return o.bitableManager.commentManager.getResolvedComments(e)},this.setResolvedCommentIds=function(e,t){return o.bitableManager.commentManager.setResolvedCommentIds(e,t)},this.addHoverHighlight=function(e,t){return o.bitableManager.commentManager.addHoverHighlight(e,t)},this.removeHoverHighlight=function(e,t){return o.bitableManager.commentManager.removeHoverHighlight(e,t)},this.removeTempComment=function(e,t){return o.bitableManager.commentManager.removeTempComment(e,t)},this.resolveComment=function(e,t){return o.bitableManager.commentManager.resolveComment(e,t)},this.activateComment=function(e,t){return o.bitableManager.commentManager.activateComment(e,t)},this.deactivateComment=function(e,t){return o.bitableManager.commentManager.deactivateComment(e,t)},this.reopenComment=function(e,t){return o.bitableManager.commentManager.reopenComment(e,t)},this.findComment=function(e,t){return o.bitableManager.commentManager.findComment(e,t)},this.getCommentPositions=function(e){return o.bitableManager.commentManager.getCommentPositions(e)},this.updateCommentData=function(){var n=we()(_e.a.mark(function e(t,n){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.checkManagerReady();case 2:if(e.sent)return e.next=5,o.bitableManager.commentManager.updateCommentData(t,n);e.next=5;break;case 5:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),this.getTeaParams=function(e,t){return o.bitableManager.commentManager.getTeaParams(e,t)}}function t(e){return n.apply(this,arguments)}var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k,I,S,T,_,w,j,M,L,R,N,D,x,P,B,U,z;function H(e,t){return i.apply(this,arguments)}function F(e,t,n){return r.apply(this,arguments)}function V(e,t){return o.apply(this,arguments)}function W(e,t,n){return a.apply(this,arguments)}function K(){return s.apply(this,arguments)}function Z(){return c.apply(this,arguments)}function q(e){return l.apply(this,arguments)}function Y(e){return u.apply(this,arguments)}function J(){return d.apply(this,arguments)}function Q(){return h.apply(this,arguments)}function X(e,t,n,i){return f.apply(this,arguments)}function $(e){return p.apply(this,arguments)}function ee(e,t,n){return g.apply(this,arguments)}function te(e,t){return m.apply(this,arguments)}function ne(e,t){return v.apply(this,arguments)}function ie(e,t){return b.apply(this,arguments)}function re(e){return y.apply(this,arguments)}function oe(e){return E.apply(this,arguments)}function ae(e,t){return O.apply(this,arguments)}function se(e){return C.apply(this,arguments)}function ce(e,t,n){return k.apply(this,arguments)}function le(e,t,n){return I.apply(this,arguments)}function ue(e){return S.apply(this,arguments)}function de(e,t){return T.apply(this,arguments)}function he(e){return _.apply(this,arguments)}function fe(e){return w.apply(this,arguments)}function pe(e){return j.apply(this,arguments)}function ge(e){return M.apply(this,arguments)}function me(){return L.apply(this,arguments)}function ve(e){return R.apply(this,arguments)}function be(){return N.apply(this,arguments)}function ye(){return D.apply(this,arguments)}function Ee(e){return x.apply(this,arguments)}function Oe(e){return P.apply(this,arguments)}function Ce(e,t){return B.apply(this,arguments)}function ke(e){return U.apply(this,arguments)}function Ie(){return z.apply(this,arguments)}return Te()(e,[{key:"checkManagerReady",value:(z=we()(_e.a.mark(function e(){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBitableManager(this.token);case 2:return e.abrupt("return",!!e.sent);case 3:case"end":return e.stop()}},e,this)})),Ie)},{key:"loadModule",value:function(){return this.initBitableJsStartTime=performance.now(),Object(Ae.a)("bitable").then(function(e){return e.bridge()})}},{key:"loadBitableManager",value:(U=we()(_e.a.mark(function e(t){var n,i;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bitableModule=this.bitableModule||this.loadModule(),t){e.next=3;break}return e.abrupt("return");case 3:return this.token=t,this.md5Token=Le()(t),e.next=7,this.bitableModule;case 7:return n=e.sent,i=n.EmbeddedBitableManager,window.scmbitable.tracker.initBitable_const_time||(window.scmbitable.tracker.initBitable_const_time=performance.now()-this.initBitableJsStartTime),this.bitableManager=this.bitableManager||this.createBitableManager(i),e.abrupt("return",this.bitableManager);case 12:case"end":return e.stop()}},e,this)})),ke)},{key:"fetchClientVars",value:(B=we()(_e.a.mark(function e(t,n){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.contentManager.initContents(t,n);case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),Ce)},{key:"mountBitable",value:(P=we()(_e.a.mark(function e(t){var n,i,r;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(Re.collectSuiteEvent)("client_bitable_block_mount"),n=this.blockExtraFunctions.getCreatedSource(this.token,t.id),i=Object.assign({},t,{createdSource:n.createdSource}),e.next=5,this.checkManagerReady();case 5:if(!e.sent){e.next=15;break}if(!this.revInfo){e.next=13;break}if(r={revInfo:this.revInfo,changesets:this.localHistoryChangeset},i.historyInfo=r,e.t0=this.bitableManager,e.t0)return e.next=13,this.bitableManager.previewHistory(r,{activeTableId:t.id,users:{}});e.next=13;break;case 13:return e.next=15,this.bitableManager.mountContentPresenter(i);case 15:case"end":return e.stop()}},e,this)})),Oe)},{key:"unmountBitable",value:(x=we()(_e.a.mark(function e(t){var n,i=arguments;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=1<i.length&&void 0!==i[1]&&i[1],console.log("[bitable]-debug unmountBitable"),e.next=4,this.checkManagerReady();case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=this.bitableManager.unmountContentPresenter(t,n);case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}},e,this)})),Ee)},{key:"freeze",value:(D=we()(_e.a.mark(function e(){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.freeze();case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),ye)},{key:"unfreeze",value:(N=we()(_e.a.mark(function e(){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.unfreeze();case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),be)},{key:"suspend",value:function(e){if(!this.bitableManager)throw new Error("bitable manager is not ready");return this.bitableManager.suspend(e)}},{key:"resume",value:function(e){if(!this.bitableManager)throw new Error("bitable manager is not ready");return this.bitableManager.resume(e)}},{key:"setHeight",value:(R=we()(_e.a.mark(function e(t){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.uiManager.setHeight(t);case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),ve)},{key:"enterTranslateMode",value:(L=we()(_e.a.mark(function e(){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.contentManager.enterTranslateMode();case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),me)},{key:"exitTranslateMode",value:function(){if(this.bitableManager)return this.bitableManager.contentManager.exitTranslateMode()}},{key:"handleCopy",value:function(e){return this.bitableManager.contentManager.handleCopy(e)}},{key:"applyBitableTemplate",value:(M=we()(_e.a.mark(function e(t){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bitableManager.contentManager.applyBitableTemplate(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),ge)},{key:"getBitableCSV",value:(j=we()(_e.a.mark(function e(t){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.contentManager.handleCSV(t);case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),pe)},{key:"addBitable",value:function(){if(!this.bitableManager)throw new Error("bitable manager is not ready");return this.bitableManager.addContentPresenter()}},{key:"pasteBitable",value:function(e,t,n){if(!this.bitableManager)throw new Error("bitable manager is not ready");return this.bitableManager.contentManager.handlePaste(e,t,n)}},{key:"getInitBitableCs",value:function(e){if(!this.bitableManager)throw new Error("bitable manager is not ready");return this.bitableManager.contentManager.getInitBitableCs(e)}},{key:"getInitKanbanCs",value:function(r){return new Promise(function(i,t){Object(Ae.a)("bitable").then(function(e){return e.bridge()}).then(function(e){var t=e.DefaultActions,n=e.ViewType;i(t.addTable(r,je.a.EmbeddedInDoc,n.Kanban))},function(e){console.error("load DocBitableBridge error",e),t()})})}},{key:"getBitableData",value:(w=we()(_e.a.mark(function e(t){var n,i,r=arguments;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(1<r.length&&void 0!==r[1])||r[1],i=Number(Object(Me.getMemberId)()),e.next=4,this.checkManagerReady();case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=this.bitableManager.contentManager.handlePaste(this.bitableManager.contentManager.handleCopy(t),i,!1,n);case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}},e,this)})),fe)},{key:"delBitable",value:function(e){this.unmountBitable(e,!0)}},{key:"confirmDelBitable",value:(_=we()(_e.a.mark(function e(i){var r=this;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(t,n){r.bitableManager.contentManager.getDeleteConfirmModal(i,function(e){(e?t:n)()})}));case 1:case"end":return e.stop()}},e)})),he)},{key:"checkUIIfChanged",value:(T=we()(_e.a.mark(function e(t,n){var i;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(i=this.bitableManager)&&i.contentManager&&i.contentManager.checkUIIfChanged&&i.contentManager.checkUIIfChanged(t,n);case 2:case"end":return e.stop()}},e,this)})),de)},{key:"activeBitable",value:(S=we()(_e.a.mark(function e(t){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.bitableManager&&this.bitableManager.activeBitable(t));case 1:case"end":return e.stop()}},e,this)})),ue)},{key:"getActiveViewIdMap",value:(I=we()(_e.a.mark(function e(t,n,i){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.contentManager.getActiveViewIdMap();case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),le)},{key:"setWidth",value:(k=we()(_e.a.mark(function e(t,n,i){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.bitableManager.uiManager.setWidth(i,t,n);case 5:case"end":return e.stop()}},e,this)})),ce)},{key:"currentScreenShot",value:function(e){if(this.bitableManager)return this.bitableManager.uiManager.currentScreenShot(e)}},{key:"setMaxWidth",value:(C=we()(_e.a.mark(function e(t){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.bitableManager.uiManager.setMaxWidth(t);case 5:case"end":return e.stop()}},e,this)})),se)},{key:"setSize",value:(O=we()(_e.a.mark(function e(t,n){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.bitableManager.uiManager.setSize(t,n);case 5:case"end":return e.stop()}},e,this)})),ae)},{key:"setZoom",value:(E=we()(_e.a.mark(function e(t){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.bitableManager.uiManager.setZoom(t);case 5:case"end":return e.stop()}},e,this)})),oe)},{key:"syncVirtualScroll",value:(y=we()(_e.a.mark(function e(t){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.bitableManager.uiManager.syncVirtualScroll(t||[]);case 5:case"end":return e.stop()}},e,this)})),re)},{key:"updateHighlight",value:(b=we()(_e.a.mark(function e(t,n){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.bitableManager.uiManager.updateHighlight(t,n);case 5:case"end":return e.stop()}},e,this)})),ie)},{key:"collapseLineChange",value:(v=we()(_e.a.mark(function e(t,n){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkManagerReady();case 3:e.sent&&this.bitableManager.uiManager.collapseLineChange&&this.bitableManager.uiManager.collapseLineChange(t,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("load Manager error",e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])})),ne)},{key:"updateBitableSelectionState",value:(m=we()(_e.a.mark(function e(t,n){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.bitableManager.updateSelectionState(t,n);case 5:case"end":return e.stop()}},e,this)})),te)},{key:"takeScreenShot",value:(g=we()(_e.a.mark(function e(t,n,i){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.sent&&this.bitableManager.uiManager.takeScreenShot)return e.abrupt("return",this.bitableManager.uiManager.takeScreenShot(t,n,i));e.next=5;break;case 5:case"end":return e.stop()}},e,this)})),ee)},{key:"recoverHistory",value:(p=we()(_e.a.mark(function e(t){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}},e)})),$)},{key:"enterHistoryMode",value:(f=we()(_e.a.mark(function e(t,n,i,r){var o;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBitableManager(t||this.token);case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:o=this.bitableManager.contentManager.dataSource.getSource(),this.bitableManager.uiManager.openHistoryPanel({activeTableId:n,startRev:i,endRev:r,bitableBase:o.base.toJSON(),token:t,recoverTableHistory:this.bitableManager.contentManager.recoverTableHistory});case 6:case"end":return e.stop()}},e,this)})),X)},{key:"exitHistoryMode",value:(h=we()(_e.a.mark(function e(){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.uiManager.closeHistoryPanel();case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),Q)},{key:"exitHistory",value:function(){return this.revInfo=null,this.bitableManager&&this.bitableManager.exitHistoryMode()}},{key:"destroy",value:(d=we()(_e.a.mark(function e(){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.destroy();case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),J)},{key:"getSearchResult",value:function(e,t){return this.bitableManager.uiManager.getSearchResult(e,t)}},{key:"highlightSearchItem",value:function(e,t,n){this.bitableManager.uiManager.highlightSearchItem(e,t,n)}},{key:"clearSearchResult",value:function(e,t){this.bitableManager.uiManager.clearHighlight(e,t)}},{key:"getAllMention",value:function(){return this.bitableManager&&this.bitableManager.contentManager.getAllMention()||{}}},{key:"getTableDataForServerCopy",value:(u=we()(_e.a.mark(function e(t){var n;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(this.bitableManager)return e.next=5,this.bitableManager.contentManager.getTableDataForServerCopy(t);e.next=8;break;case 5:if(n=e.sent)return e.abrupt("return",n);e.next=8;break;case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}},e,this)})),Y)},{key:"removeLocalConflictRecord",value:(l=we()(_e.a.mark(function e(t){var n;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(this.bitableManager)return e.next=5,this.bitableManager.contentManager.removeLocalConflictRecord(t);e.next=8;break;case 5:if(n=e.sent)return e.abrupt("return",n);e.next=8;break;case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}},e,this)})),q)},{key:"enableEdit",value:(c=we()(_e.a.mark(function e(){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:this.bitableManager&&this.bitableManager.enableEdit();case 3:case"end":return e.stop()}},e,this)})),Z)},{key:"disableEdit",value:(s=we()(_e.a.mark(function e(){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:this.bitableManager&&this.bitableManager.disableEdit();case 3:case"end":return e.stop()}},e,this)})),K)},{key:"getAllMentionList",value:function(){var n=this.getAllMention(),i=[];return n&&Object.keys(n).forEach(function(e){var t=n[e];Object.keys(t).forEach(function(e){return e&&i.push({mentionId:e})})}),i}},{key:"locateMention",value:(a=we()(_e.a.mark(function e(t,n,i){var r;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(!e.sent){e.next=9;break}if((r=this.bitableManager)&&r.uiManager&&r.uiManager.locateMention)return e.next=7,r.uiManager.locateMention(t,n,i[Ne]);e.next=8;break;case 7:return e.abrupt("return",e.sent);case 8:case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}},e,this)})),W)},{key:"setCommentData",value:function(e,t){this.bitableManager.commentManager.setCommentData(e,t)}},{key:"startNewComment",value:function(e,t,n){return this.bitableManager.commentManager.startNewComment(e,t,n)}},{key:"getComments",value:function(e){return this.bitableManager.commentManager.getComments(e)}},{key:"setOnCommentBatchUpdate",value:(o=we()(_e.a.mark(function e(t,n){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(!e.sent){e.next=4;break}this.bitableManager.commentManager.setOnCommentBatchUpdate(t,n);case 4:case"end":return e.stop()}},e,this)})),V)},{key:"getActiveComments",value:function(e){return this.bitableManager.commentManager.getActiveComments(e)}},{key:"saveComment",value:(r=we()(_e.a.mark(function e(t,n,i){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.bitableManager.commentManager.saveComment(t,n,i));case 1:case"end":return e.stop()}},e,this)})),F)},{key:"removeComment",value:(i=we()(_e.a.mark(function e(t,n){return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.bitableManager.commentManager.removeComment(t,n));case 1:case"end":return e.stop()}},e,this)})),H)},{key:"getTableRevision",value:(n=we()(_e.a.mark(function e(t){var i,r=this;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={},e.next=3,this.checkManagerReady();case 3:if(e.sent)return e.next=6,Promise.all(t.map(function(){var t=we()(_e.a.mark(function e(t){var n;return _e.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.bitableManager.contentManager.getTableRevision(t);case 2:n=e.sent,i[t]=n;case 4:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()));e.next=6;break;case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)})),t)},{key:"updateTime",get:function(){return this.bitableManager?this.bitableManager.contentManager.getUpdatedTime():NaN}}]),e}()},"2JAk":function(e,t,n){"use strict";var i=n("o0o1"),R=n.n(i),r=n("yXPU"),f=n.n(r),N=n("y2sV"),d=n("D28M"),D=n("j1lG"),o=n("lSNA"),x=n.n(o),P=n("+Xq6"),k=n("lQZd"),I=n("qkt2"),S=n("Z/PY"),B=n("Tqb2"),U=n("chfE"),g=n("Pozx"),T=n("BpSZ"),a=function(e){var t=Object(k.g)(),n=Object(I.b)(null),i=e.dataset.src||e.src,r=Object(g.a)(i),o=parseFloat((e.style.height.endsWith("%")?"":e.style.height)||e.dataset.height||"")||e.height,a=parseFloat((e.style.width.endsWith("%")?"":e.style.width)||e.dataset.width||"")||e.width;o&&a||(o=D.e,a=D.f);var s={uuid:n,height:o,width:a,loadingShowPreview:!1};if(Object(T.b)(i))return Object(U.f)(s,{uploading:!0,uploadProgress:D.C,intermediateSrc:i});if(e.dataset.suite||[D.D.Doc,D.D.Drive].includes(r)){var c,l="",u=!1;return!e.dataset.suite||(c=Object(P.d)(e.dataset.suite))&&(u=c.objToken===t,l=c.fileToken),u||r===D.D.Doc?Object(U.e)(s,{sourceFileToken:l,intermediateSrc:i}):Object(U.c)(s,{sourceFileToken:l})}return Object(U.d)(s,{intermediateSrc:i})},_=function(e,t,n){var i=t,r=a(e);if(!r)return i;var o=new N.E({zoneId:n});return o.insert(D.B,r),i=t.concat(o)},h=function(e,t,n,i){var r=t,o=e.dataset.aceGalleryJson,a=o&&Object(S.C)(o),s=e.querySelectorAll("img");if(0===s.length)return r;var c,l,u=s[0],g=!1,d=null,h=Object(k.g)();if(!u.dataset.suite||(c=Object(P.d)(u.dataset.suite))&&(l=c.objToken,g=l===h,d=l),!d||!a){var f=!0,p=!1,m=void 0;try{for(var v,b=s[Symbol.iterator]();!(f=(v=b.next()).done);f=!0)var y=v.value,r=_(y,r,n)}catch(e){p=!0,m=e}finally{try{f||null==b.return||b.return()}finally{if(p)throw m}}return r}var E=i&&g,O=a.items.map(function(e){var t=Object(I.b)(null),n=E?e.comments:[];e.comments=n,e.uuid=t;var i=Object(B.e)(e),r=i.originSrc,o=i.imageCategory,a=i.token,s=i.size,c=s.displayHeight,l=s.displayWidth,u=s.naturalHeight,d=s.naturalWidth,h=i.fileSize,f=i.mimeType,p={uuid:t,height:c,width:l,naturalHeight:u.toString(),naturalWidth:d.toString(),imageType:f,size:h,loadingShowPreview:!1,comments:n};return Object(T.b)(r)?Object(U.f)(p,{uploading:!0,uploadProgress:D.C,intermediateSrc:r}):o===D.D.External?Object(U.d)(p,{intermediateSrc:r}):g||o===D.D.Doc?x()({},D.K,JSON.stringify({items:[e]})):Object(U.c)(p,{sourceFileToken:a})}),C=new N.E({zoneId:n});return O.forEach(function(e){C.insert(D.B,e)}),r=t.concat(C)},p=n("OMpt"),m=n("+c5q"),s=n("J4zp"),v=n.n(s),c=n("RIqP"),b=n.n(c),y=function(e,a,s){var c=Object(k.g)(),t=e.ops;return e.ops=t.reduce(function(e,t){var n,i,r,o=e;return t.attributes&&(t.attributes[D.K]||t.attributes[D.M])?(n=t.attributes.suiteData,delete t.attributes.suiteData,r=(i=!!n&&Object(P.d)(n).objToken===c)&&a,o=t.attributes[D.K]?l(o,t,i,r,s):u(o,t,i,r)):o.push(t),o},[]),e},E=function(e,t){var n=e.getData(D.k);if(n)try{return(n=JSON.parse(n))[t]||""}catch(e){return""}return""},l=function(e,c,l,u,d){var h=b()(e),t=Object(S.C)(c.attributes[D.K]);return t&&t.items&&0!==t.items.length&&t.items.forEach(function(e){var t,n=Object(B.e)(e),i=E(d,n.uuid),r=Object(p.c)(l,n.imageCategory),o=v()(r,2),a=o[0],s=o[1];!l&&n.imageCategory!==D.D.Doc||s?h.push({insert:D.B,attributes:Object.assign({author:c.attributes.author},O(n,a,s,n.comments||[],u))}):(e.uuid=Object(I.b)(null),e.comments=u?e.comments:[],Object(T.b)(n.serverSrc)&&(e=Object(U.b)(Object.assign({},e,{uploading:!0,uploadProgress:D.C,intermediateSrc:n.serverSrc}))),h.push({insert:D.B,attributes:(t={},x()(t,D.K,JSON.stringify({items:[e]})),x()(t,"author",i||c.attributes.author),t)}))}),h},u=function(e,t,n,i){var r=b()(e),o=Object(B.p)(D.M,t.attributes[D.M]);if(!o||0===o.length)return r;delete t.attributes[D.M];var a=o[0],s=Object(B.j)(t.attributes);s.forEach(function(e){return delete t.attributes[e]});var c=Object(p.c)(n,a.imageCategory),l=v()(c,2),u=l[0],d=l[1],h=O(a,u,d,s,i);return t.attributes=Object.assign({},t.attributes,{},h),r.push(t),r},O=function(e,t,n,i,r){var o=e.size,a=o.displayWidth,s=o.displayHeight,c=o.naturalHeight,l=o.naturalWidth,u=e.token,d=e.originSrc,h=e.mimeType,f=e.fileSize,p={uuid:Object(I.b)(null),height:s,width:a,naturalHeight:c.toString(),naturalWidth:l.toString(),comments:r?i:[],imageType:h,size:f,loadingShowPreview:!1};return Object(T.b)(d)?Object(U.f)(p,{uploading:!0,uploadProgress:D.C,intermediateSrc:d}):t?Object(U.c)(p,{sourceFileToken:u}):n?Object(U.d)(p,{intermediateSrc:d}):Object(U.e)(p,{sourceFileToken:u,intermediateSrc:d})},C=function(){var a=f()(R.a.mark(function e(t,n,i,r,o,a){return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.addTask(t,n,i,r,o);case 2:case"end":return e.stop()}},e)}));return function(e,t,n,i,r,o){return a.apply(this,arguments)}}(),w=function(){var n=f()(R.a.mark(function e(t,n){var i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k,I,S,T,_,w,j,M,L;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(P.c)(Array.from(t.values())),e.next=3,i.promise;case 3:if((r=e.sent).code!==P.a.SUCCESSFUL)return z(t,n),e.abrupt("return");e.next=7;break;case 7:o=r.tokenMap,a=n.getContentState(),s=new N.e,c=Object(B.h)(n),u=!(l=!0),d=void 0,e.prev=14,h=c[Symbol.iterator]();case 16:if(l=(f=h.next()).done){e.next=34;break}if(p=f.value,1===(g=Object(B.V)(p.attributes)).length&&o[g[0].sourceFileToken||""])return v=g[0],b=v.fileSize,y=v.mimeType,E=v.size,O=E.displayHeight,C=E.displayWidth,k=E.naturalHeight,I=E.naturalWidth,S=v.uuid,T=v.sourceFileToken,_=v.comments,t.delete(g[0].sourceFileToken),e.next=24,Object(U.a)({uuid:S,fileToken:o[T],width:C,height:O,size:b,imageType:y,naturalHeight:k.toString(),naturalWidth:I.toString(),comments:_});e.next=31;break;case 24:if(w=e.sent){e.next=27;break}return e.abrupt("continue",31);case 27:j=a.rangePointToOffset(p.start),M=a.rangePointToOffset(p.end),L=new N.E({zoneId:p.start.zoneId}).retain(j).retain(M-j,(m={},x()(m,D.c,""),x()(m,D.K,w),m)),s=s.compose(L);case 31:l=!0,e.next=16;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(14),u=!0,d=e.t0;case 40:e.prev=40,e.prev=41,l||null==h.return||h.return();case 43:if(e.prev=43,u)throw d;e.next=46;break;case 46:return e.finish(43);case 47:return e.finish(40);case 48:n.inCallStackIfNecessary("image-copy-to-success",function(){a.apply(s,{nonundoable:!0})}),0<t.size&&z(t,n);case 50:case"end":return e.stop()}},e,null,[[14,36,40,48],[41,,43,47]])}));return function(e,t){return n.apply(this,arguments)}}(),j=function(){var s=f()(R.a.mark(function e(t,n,i,r,o,a,s){var c,l,u,d,h,f,p;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=Object(g.a)(a),e.next=3,Object(U.a)({uuid:n,fileToken:i,height:r,width:o,src:a,comments:s,isDocImage:l===D.D.Doc});case 3:if(u=e.sent){e.next=6;break}return e.abrupt("return");case 6:if(0===(d=Object(B.o)({uuid:n},t)).length)return e.abrupt("return");e.next=9;break;case 9:h=d[0],f=h.start,p=h.end,t.getContentState().setAttributes({start:f,end:p},(c={},x()(c,D.c,""),x()(c,D.K,u),c),{nonundoable:!0});case 12:case"end":return e.stop()}},e)}));return function(e,t,n,i,r,o,a){return s.apply(this,arguments)}}(),z=function(o,e){var a=new N.E,t=Object(B.h)(e),s=e.getContentState(),c=0;t.forEach(function(e){var t,n,i,r=Object(B.V)(e.attributes);1===r.length&&o.has(r[0].sourceFileToken||"")&&(t=s.rangePointToOffset(e.start),n=s.rangePointToOffset(e.end),i=(new N.E).retain(t-c).delete(n-t),a=a.compose(i),c++)}),e.inCallStackIfNecessary("image-copy-to-fail",function(){s.apply(a,{nonundoable:!0})})},M=n("FJEn");n.d(t,"a",function(){return F}),n.d(t,"c",function(){return Z}),n.d(t,"b",function(){return q});var L=M.tableIds.getCellIdFromRowAndCol,H=M.tableIds.getRowAndColIdFromAttributeValue,F=function(e,t){var n,i=e.node,r=e.deltaSet,o=e.zoneId,a=t.clipboard.getPasteInfo(),s=a.pasteFrom,c=a.pasteTimes,l="cut"===s&&1===c,u=r;return i instanceof HTMLElement&&(n=i.tagName,i.classList.contains("gallery")?u=h(i,r,o,l):"IMG"!==n||Object(d.o)(i,"gallery")||(u=_(i,r,o))),u};function V(e){var n=[];return e.forEach(function(e){e.ops&&e.ops.forEach(function(e){var t;e.attributes&&e.attributes.aceTable&&(t=e.attributes.aceTable,n.push(t))})}),n}function W(o){var a=[];return V(o).forEach(function(e){var t=H(e),n=t.rowId,r=t.colId;o.get(n).forEach(function(i){o.get(r).forEach(function(e){var t=L(i.insert.id,e.insert.id),n=o.get(t);n&&a.push(n)})})}),a}function K(e){var t=e.ops,n=t[t.length-2],i=t[t.length-1];return n&&Object(B.M)(n)&&i&&i.insert===N.f&&e.insertEnter(),e}var Z=function(e,i){var t=e.deltaSet,n=e.isInternalPaste,r=e.event;if(i.getPlugin(D.K).setPreventAutoFixSelection(!0),!n){var o=Object(p.a)(t),a=W(o).map(function(e){return e.zoneId});return o.forEach(function(e){var t,n;e.zoneType===N.F.Content&&(t=e.zoneId,n=Object(m.a)(e,i),a.includes(t)&&K(n),o.replace(t,n))}),o}var s=i.clipboard.getPasteInfo(),c=s.pasteFrom,l=s.pasteTimes,u="cut"===c&&1===l,d=r.clipboardData,h=t,f=W(h).map(function(e){return e.zoneId});return h.forEach(function(e){var t,n;e.zoneType===N.F.Content&&(t=e.zoneId,e=y(e,u,d),n=Object(m.a)(e,i),f.includes(t)&&K(n),h.replace(t,n))}),h=Object(p.a)(h)},q=function(e,c,t){var l=t.imageUploader,u=t.imageExternalSaver,d=t.beforeUnloadReminder,n=t.imageStateInstance;Object(p.d)(e.deltaSet,c,n);var h=new Set;Object.values(e.deltaSet.deltas).forEach(function(e){e.ops.forEach(function(e){e.attributes&&Object.entries(e.attributes).forEach(function(e){var t,n,i,r,o,a,s;e[0]===D.c&&((t=JSON.parse(e[1]).items[0]).needTransformToGallery?(n=t.uuid,i=t.sourceFileToken,r=t.height,o=t.width,a=t.intermediateSrc,s=t.comments,Object(p.b)(f()(R.a.mark(function e(){return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(c,n,i,r,o,a,s);case 2:case"end":return e.stop()}},e)})),d)):t.needSaveDriveImage&&t.sourceFileToken?h.add(t.sourceFileToken):t.needSaveExternal&&u?Object(p.b)(f()(R.a.mark(function e(){return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t.uuid,t.intermediateSrc,parseFloat(t.width),parseFloat(t.height),t.comments,u);case 2:case"end":return e.stop()}},e)})),d):t.uploading&&l&&l.upload({resource:t.intermediateSrc,source:D.F.Paste,insertedUuid:t.uuid}))})})}),0<h.size&&Object(p.b)(f()(R.a.mark(function e(){return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(h,c);case 2:case"end":return e.stop()}},e)})),d),c.getPlugin(D.K).setPreventAutoFixSelection(!1)}},"2M8O":function(e,t,n){},"2Rtb":function(e,t,n){},"2XSo":function(e,t,n){"use strict";var s,i,r=n("o0o1"),u=n.n(r),o=n("RIqP"),d=n.n(o),a=n("yXPU"),c=n.n(a),l=n("lwsE"),h=n.n(l),f=n("W8MJ"),p=n.n(f),g=n("cDf5"),m=n.n(g),v=n("OX8E"),b=n("toa8"),y=n("AESI"),E=n("2spZ"),O=n("4PSP"),C=n("vc5i"),k=n("5cZX"),I=n("D7h9"),S=n("AH9Y"),T=n("2ACu"),_=n("1lbP"),w=n("K9Ia"),j=n("t9fZ"),M=n("Gi3i"),L=n("g8ZB"),R=n("VI6H"),N=n("kUgE"),D=n("Np3H"),x=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},P=200;(i=s=s||{}).USER="user",i.AUTO="auto";var B=function(){function e(){h()(this,e),this.opTrackerChange$=new w.a,this.viewDocEditorsPerm$=new w.a}function t(e){return n.apply(this,arguments)}var n,i,r;function o(e){return i.apply(this,arguments)}function a(){return r.apply(this,arguments)}return p()(e,[{key:"init",value:function(){var i=this;this.cached=new Map,this.userIds=new Set,this.hasEditPermission=Object(k.c)(I.default.getState()),this.viewEditorsMenuStatus=!1,this.docEditorsHasTwoOrMore=!1;var e=Object(R.c)();this.rxOp=new _.a,this.bindEvents(),e&&this.cached.set(e.get("id"),{name:e.get("name"),enName:e.get("en_name")||e.get("name")}),L.b.pipe(this.rxOp.takeUntil()).subscribe(function(e){i.hasEditPermission=e.hasEditPermission,i.onViewEditorsStatusChange(s.AUTO)}),this.opTrackerChange$.pipe(Object(j.a)(1),this.rxOp.takeUntil()).subscribe(function(){i.viewDocEditorsPerm$.pipe(Object(M.a)(200),i.rxOp.takeUntil()).subscribe(function(e){var t=e.open,n=e.source;if(t)return!0!==i.viewEditorsMenuStatus&&(i.viewEditorsMenuStatus=!0,v.a.emit("viewEditorsStatusUpdate",!0),i.collectTea(!0,n)),void i.docEdtiorsChange();!0===i.viewEditorsMenuStatus&&(i.viewEditorsMenuStatus=!1,v.a.emit("viewEditorsStatusUpdate",!1),i.collectTea(!1,n))})})}},{key:"collectTea",value:function(e,t){Object(T.default)("doc_main_body_author",{action_source:t,action:e?"turn_on":"turn_off"})}},{key:"getViewEditorsPerm",value:function(){var e=S.a.getPreferenceStatus();return void 0!==e?e:!(Object(D.b)()||!this.docEditorsHasTwoOrMore||!this.hasEditPermission)}},{key:"getViewEditorsMenuStatus",value:function(){return this.viewEditorsMenuStatus}},{key:"destroy",value:function(){this.rxOp.destroy(),this.cached.clear(),this.userIds.clear(),this.hasEditPermission=!1,this.viewEditorsMenuStatus=!1,this.docEditorsHasTwoOrMore=!1,this.unBindEvents()}},{key:"bindEvents",value:function(){v.a.on("viewEditorsMenuChange",this.onViewEditorsMenuChange),v.a.on("opEditorsChange",this.onOpTrackerChange)}},{key:"unBindEvents",value:function(){v.a.off("viewEditorsMenuChange",this.onViewEditorsMenuChange),v.a.off("opEditorsChange",this.onOpTrackerChange)}},{key:"onOpTrackerChange",value:function(e){this.docEditorsHasTwoOrMore=1<e.length;var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;this.userIds.add(a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}this.opTrackerChange$.next(),this.onViewEditorsStatusChange(s.AUTO)}},{key:"onViewEditorsMenuChange",value:function(e){S.a.addCurrentPreference(e),this.onViewEditorsStatusChange(s.USER)}},{key:"onViewEditorsStatusChange",value:function(e){var t;Object(R.e)()||(t=Object(R.c)(),Object(R.i)(t)||this.hasEditPermission?this.viewDocEditorsPerm$.next({open:this.getViewEditorsPerm(),source:e}):v.a.emit("viewEditorsStatusUpdate",!1))}},{key:"docEdtiorsChange",value:(r=c()(u.a.mark(function e(){var t,n,i,r,o,a,s,c,l;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.viewEditorsMenuStatus){e.next=2;break}return e.abrupt("return");case 2:for(t=new Set,i=!(n=!0),r=void 0,e.prev=6,o=this.userIds[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)s=a.value,this.cached.has(s)||t.add(s);e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),i=!0,r=e.t0;case 14:e.prev=14,e.prev=15,n||null==o.return||o.return();case 17:if(e.prev=17,i)throw r;e.next=20;break;case 20:return e.finish(17);case 21:return e.finish(14);case 22:if(t.size){e.next=24;break}return e.abrupt("return");case 24:return e.next=26,this.batchFetchEditorsInfos(d()(t));case 26:if(c=e.sent)for(l in c)this.cached.set(l,c[l]);v.a.emit("updateDocEditors",{users:d()(t)});case 29:case"end":return e.stop()}},e,this,[[6,10,14,22],[15,,17,21]])})),a)},{key:"getUserNameById",value:function(e){var t=this.cached.get(e);return t?Object(N.isZhLanguage)()?t.name:t.enName:(this.userIds.add(e),"")}},{key:"batchFetchEditorsInfos",value:(i=c()(u.a.mark(function e(t){var n,i,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=d()(t),i={};case 2:if(0<n.length)return r=n.splice(0,P),e.prev=4,e.next=7,this.rxOp.toPromise(this.fetchEditorsInfos(r));e.next=16;break;case 7:o=e.sent,Object.assign(i,o),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return",i);case 14:e.next=2;break;case 16:return e.abrupt("return",i);case 17:case"end":return e.stop()}},e,this,[[4,11]])})),o)},{key:"fetchEditorsInfos",value:(n=c()(u.a.mark(function e(n){var i,r=this,t=arguments;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=1<t.length&&void 0!==t[1]?t[1]:3,e.abrupt("return",this.requestEditors(n).then(function(e){return e.data.details}).catch(function(){var t=c()(u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(T.default)("dev_doc_fetch_editors_catch",{err:t,times:i}),0<i)return e.next=4,Object(E.c)(3/i*1e3);e.next=7;break;case 4:return e.abrupt("return",r.fetchEditorsInfos(n,--i));case 7:return e.abrupt("return",Promise.reject(new Error("meet error")));case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,this)})),t)},{key:"requestEditors",value:function(e){return Object(b.d)({url:y.GET_USER_LIST,method:y.METHOD.POST,data:{obj_type:2,token:Object(C.n)(I.default.getState()),users:e},headers:{"Content-Type":"application/json"}})}}]),e}();x([Object(O.Bind)()],B.prototype,"onOpTrackerChange",null),x([Object(O.Bind)()],B.prototype,"onViewEditorsMenuChange",null),t.a=new B},"2hu8":function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return C}),n.d(t,"h",function(){return g}),n.d(t,"e",function(){return m}),n.d(t,"f",function(){return y}),n.d(t,"g",function(){return S}),n.d(t,"c",function(){return w});var i=n("J4zp"),h=n.n(i),r=n("RQuH"),f=n("elsr"),s=n("7Kxq"),o=n("bTJL"),c=n("Uy54"),E="0";function l(t,n,e){var i=t.zoneId,r=t.repManager.editor,o=m(r);if(!g(t,n,[(e=e||[0,o-1])[0],e[1]]))return-1;var a=function(e){return v(t,n,e)},s=function(e){return S(t,n,e)},c=function(e){return j(r,i,e)},l=function(e){return M(r,i,e)};return O({scope:[e[0],e[1]],endPredicator:a,forwardPredicator:s,upwardMatcher:c,downwardMatcher:l})}function a(e,t,n){var i=l(e,t,n);if(-1===i)return null;var r=e.lines.atIndex(i).isActive;return Object(o.b)(e,i)&&r?u(e,t,i):Object(o.a)(e,i)&&r?d(e,t,i):{lineNumInMainZone:i,selZone:E,lineNum:i}}function u(e,t,n){var i=e.lines,r=e.zoneId,o=e.repManager.editor,a=i.atIndex(n),s=16*(a.zoom||1),c=t-(C(e,n).top+s),l=o.getAttributeOnLine(r,n,"aceTable"),u=o.plugins.table.getRowAndColIdFromAttributeValue(l),d=u.rowId,h=u.colId,f=o.vectorReps,p=f[d].vectorIds,g=f[h].vectorIds[0],m=p.map(function(e){return o.plugins.table.getCellIdFromRowAndCol(e,g)}),v=function(e){return k(a,c,m[e])},b=function(e){return T(a,c,m[e])},y=O({scope:[0,m.length-1],endPredicator:v,forwardPredicator:b});return-1===y?{lineNumInMainZone:n,selZone:E,lineNum:n}:{lineNumInMainZone:n,selZone:m[y],lineNum:0,selRowIndex:y,selTableId:[d,h].join(" ")}}function d(e,t,n){var i=e.repManager.editor,r=Object(c.a)(i,e.zoneId,n),o=i.getRep(r),a=l(o,t,[0,o.lines.length()-1]);return{lineNumInMainZone:n,selZone:r,lineNum:Math.max(a,0)}}function O(e){for(var t=e.scope,n=e.endPredicator,i=e.forwardPredicator,r=e.upwardMatcher,o=e.downwardMatcher,a=t[0],s=t[1];a<s;){var c=r?r(Math.floor(a+(s-a)/2)):Math.floor(a+(s-a)/2);if(null===c)return-1;if(n(c))return c;if(i(c)){var l=o?o(c+1):c+1;if(null===l)return-1;a=l}else s=c}return a===s&&n(a)?a:-1}function C(e,t,n){if(!(t<0)){var i;!n||null!==(i=w(e,t))&&(t=i);var r=e.zoneId,o=e.lines.atIndex(t);if(o&&o.lineNode){var a,s=o.zoom||1,c=o.lineNode.offsetHeight*s,l=e.repManager.editor,u=l.getLineTop(r,[t,0]),d=u+c;return t+1<l.getRep(f.a).alines.length&&(null!==(a=M(l,r,t+1))&&(d=l.getLineTop(r,[a,0]))),{top:u,bottom:d,height:c}}}}function p(e,t){var n=e.getInstanceByName(s.e.ACE_TABLE);if(!n)return null;var i=e.zoom||1,r=n.findCellOffsetToTable(t);if(!r)return null;var o=r.top,a=r.height;return null!==o?{top:o*i,bottom:(o+a)*i,height:a*i}:null}function g(e,t,n){var i=e.zoneId,r=e.repManager.editor,o=h()(n,2),a=o[0],s=o[1],c=0===a?a:j(r,i,a),l=j(r,i,s);if(null===l||null===c)return!1;var u=C(e,c),d=C(e,l);return!(!d||!u)&&b(t,u.top,d.bottom)}function m(e){return e.getReps()[f.a].alines.length}function v(e,t,n,i){var r;!i||null!==(r=w(e,n))&&(n=r);var o=C(e,n);return!!o&&b(t,o.top,o.bottom)}function k(e,t,n){var i=p(e,n);return!!i&&b(t,i.top,i.bottom)}function b(e,t,n){return Object(r.a)(e,t,n+1)}function y(e,t,n,i){var r;!i||null!==(r=w(e,n))&&(n=r);var o=C(e,n);return!!o&&I(t,o.top)}function I(e,t){return Object(r.a)(e,t)}function S(e,t,n,i){var r;!i||null!==(r=w(e,n))&&(n=r);var o=C(e,n);return!!o&&_(t,o.bottom)}function T(e,t,n){var i=p(e,n);return!!i&&_(t,i.bottom)}function _(e,t){return Object(r.a)(t,e)}function w(e,t){var n=e.zoneId;return j(e.repManager.editor,n,t)}function j(e,t,n){var i=e.lineTracker.collapseLines;if(!i)return n;for(var r=n;0<=r;){var o=i.getCollapsedStatusOfSelection({selZone:t,selStart:[r,0],selEnd:[r,0]});if(0===o.length)return r;var a=o[0];if(!a)return null;if(r===n&&!a.renderCollapsed)return r;if(a.renderCollapsed&&a.startOfCollapseSection)return r;--r}return null}function M(e,t,n){var i=e.lineTracker.collapseLines;if(!i)return n;for(var r=e.getRep(t).alines.length-1,o=n;o<=r;){var a=i.getCollapsedStatusOfSelection({selZone:t,selStart:[o,0],selEnd:[o,0]});if(0===a.length)return o;var s=a[0];if(!s)return null;if(!s.renderCollapsed||s.startOfCollapseSection)return o;o+=1}return null}},"2sVE":function(e,m,v){"use strict";(function(e){v.d(m,"b",function(){return g}),v.d(m,"a",function(){return p});var t=v("lSNA"),n=v.n(t),i=v("RIqP"),r=v.n(i),o=v("AiBH"),a=v("DNsP"),s=v("YNKm"),c=v("rUU8"),l=v("4D8z"),u=v("bsrO"),d=v("VI6H"),h=v("m3ds"),f=v("rLED"),p=h.a.isMac?"osx":"other",g={menuLeft:[{dataKey:"undo",className:"",des:"",dataId:"undo-btn",toolTips:{tipText:e("common.undo"),keyText:{osx:"Z",other:"Ctrl+Z"}}},{dataKey:"redo",className:"",des:"",dataId:"redo-btn",toolTips:{tipText:e("common.redo"),keyText:{osx:"+Shift+Z",other:"Ctrl+Shift+Z"}}},{separator:null}].concat(r()(c.e),[{separator:null},{dataKey:"bold",className:"",des:"",toolTips:{tipText:e("editorbar.bold"),keyText:{osx:"B",other:"Ctrl+B"},markdown:!0}},{dataKey:"italic",className:"",des:"",toolTips:{tipText:e("common.italic"),keyText:{osx:"I",other:"Ctrl+I"},markdown:!0}},{dataKey:"underline",className:"",des:"",toolTips:{tipText:e("common.underline"),keyText:{osx:"U",other:"Ctrl+U"},markdown:!0}},{dataKey:"strikethrough",className:"",des:"",toolTips:{tipText:e("common.strikethrough"),keyText:{osx:"+Shift+X",other:"Ctrl+Shift+X"},markdown:!0}},{dataKey:s.B,className:"",des:"",toolTips:{tipText:e("editorbar.hight"),keyText:{osx:"+Option+H",other:"Ctrl+Alt+H"}}},{separator:null}],r()(c.d),[{separator:null},{dataKey:"insertorderedlist",className:"ol",toolTips:{tipText:e("common.ordered_list"),keyText:{osx:"+Shift+7",other:"Ctrl+Shift+7"},markdown:!0}},{dataKey:"insertunorderedlist",className:"ul",des:"",toolTips:{tipText:e("common.unordered_list"),keyText:{osx:"+Shift+8",other:"Ctrl+Shift+8"},markdown:!0}},{dataKey:"checkbox",className:"",des:"",toolTips:{tipText:e("common.task_list"),keyText:{osx:"+Option+T",other:"Ctrl+Alt+T"},markdown:!0}},{dataKey:"blockquote",className:"",des:"",toolTips:{tipText:e("common.reference"),keyText:{osx:"+Shift+>",other:"Ctrl+Shift+>"},markdown:!0}},{separator:null},{dataKey:"sheet",className:"",des:"",toolTips:{tipText:e("common.form"),keyText:null}},{dataKey:"link",className:"",des:"",toolTips:{tipText:e("common.link"),keyText:{osx:"K",other:"Ctrl+K"}}},{dataKey:"insertimage",className:"image",des:"",dataId:"image-upload",toolTips:{tipText:e("editorbar.image"),keyText:{osx:"+Shift+U",other:"Ctrl+Shift+U"}}},{dataKey:"insertseparator",className:"separator",des:"",dataId:"horizontal-btn",toolTips:{tipText:e("common.divider"),keyText:{osx:"+Option+S",other:"Ctrl+Alt+S"},markdown:!0}}]),menuText:[{dataKey:"bold",className:"",des:"",toolTips:{tipText:e("editorbar.bold"),keyText:{osx:"B",other:"Ctrl+B"},markdown:!0}},{dataKey:"strikethrough",className:"",des:"",toolTips:{tipText:e("common.strikethrough"),keyText:{osx:"+Shift+X",other:"Ctrl+Shift+X"},markdown:!0}},{dataKey:s.B,className:"",des:"",toolTips:{tipText:e("editorbar.hight"),keyText:{osx:"+Option+H",other:"Ctrl+Alt+H"}}},{dataKey:"insertorderedlist",className:"ol",toolTips:{tipText:e("common.ordered_list"),keyText:{osx:"+Shift+7",other:"Ctrl+Shift+7"},markdown:!0}},{dataKey:"insertunorderedlist",className:"ul",des:"",toolTips:{tipText:e("common.unordered_list"),keyText:{osx:"+Shift+8",other:"Ctrl+Shift+8"},markdown:!0}},{dataKey:"checkbox",className:"",des:"",feature:["panel_checkbox_use"],dataSelector:"selection-checkbox",toolTips:{tipText:e("common.task_list"),keyText:{osx:"+Option+T",other:"Ctrl+Alt+T"},markdown:!0}},{dataKey:"link",className:"",des:"",toolTips:{tipText:e("common.link"),keyText:{osx:"K",other:"Ctrl+K"}}}],menuHeading:c.e,menuMore:[{dataKey:"blockquote",className:"",des:"",toolTips:{tipText:e("common.reference"),keyText:{osx:"+Shift+>",other:"Ctrl+Shift+>"},markdown:!0}},{dataKey:"underline",className:"",des:"",toolTips:{tipText:e("common.underline"),keyText:{osx:"U",other:"Ctrl+U"},markdown:!0}},{dataKey:"italic",className:"",des:"",toolTips:{tipText:e("common.italic"),keyText:{osx:"I",other:"Ctrl+I"},markdown:!0}},{dataKey:"inlinecode",className:"",des:"",toolTips:{tipText:e("common.inline_code"),keyText:{osx:"Ctrl++C",other:"Ctrl+Shift+C"},markdown:!0}},{dataKey:s.E,className:"insertCalloutBlock",des:"",toolTips:{tipText:e("CreationDoc_Docs_CalloutBlock_Tab"),markdown:!1},hidden:!Object(f.f)()},{dataKey:s.G,className:"codeblock",des:"",toolTips:{tipText:e("help.siderbar.code_block"),keyText:{osx:"+Option+C",other:"Ctrl+Alt+C"},markdown:!0}},{dataKey:s.F,className:"codeblock",des:"",toolTips:{tipText:e("help.siderbar.code_block"),keyText:{osx:"+Option+C",other:"Ctrl+Alt+C"},markdown:!0}}].concat(r()(c.d)),commentTranslated:{dataKey:"comment",className:"",des:"",toolTips:{tipText:e("CreationDoc_TranslateView_AddComment_Tooltip")}},comment:{dataKey:"comment",className:"",des:"",toolTips:{tipText:e("editorbar.comment"),keyText:{osx:"+Option+M",other:"Ctrl+Alt+M"}}},heading:{dataKey:"heading",className:"",des:"",toolTips:{tipText:"editorbar.heading",keyText:{osx:"P",other:"Ctrl+P"}}},align:{dataKey:"align",className:"",des:"",toolTips:{tipText:"editorbar.align",keyText:{osx:"P",other:"Ctrl+P"}}},menuImages:[].concat(r()(c.f),[{dataKey:"alignfull",className:"imageFullScreen",des:"",dataId:"",toolTips:{tipText:e("editorbar.image_full_screen")}},{separator:null}]),menuCallout:[{dataKey:s.k,className:"",des:"",toolTips:{tipText:e("editorbar.hight")}},{separator:null}],table:[].concat(r()(c.f),[{dataKey:"alignfull",className:"imageFullScreen",des:"",dataId:"",toolTips:{tipText:e("editorbar.image_full_screen")}},{separator:null}]),menuCards:[],menuLineA:[{dataKey:"insertorderedlist",className:"ol",toolTips:{tipText:e("common.ordered_list"),keyText:{osx:"+Shift+7",other:"Ctrl+Shift+7"},markdown:!0},type:"style"},{dataKey:"insertunorderedlist",className:"ul",des:"",toolTips:{tipText:e("common.unordered_list"),keyText:{osx:"+Shift+8",other:"Ctrl+Shift+8"},markdown:!0},type:"style"},{dataKey:"blockquote",className:"",des:"",toolTips:{tipText:e("common.reference"),keyText:{osx:"+Shift+>",other:"Ctrl+Shift+>"},markdown:!0},type:"style"},{dataKey:"insertseparator",className:"separator",des:"",dataId:"horizontal-btn",toolTips:{tipText:e("common.divider"),keyText:{osx:"+Option+S",other:"Ctrl+Alt+S"},markdown:!0},type:"style"},{dataKey:s.G,className:"codeblock",des:"",toolTips:{tipText:e("help.siderbar.code_block"),keyText:{osx:"+Option+C",other:"Ctrl+Alt+C"},markdown:!0},type:"style"},{dataKey:s.F,className:"codeblock",des:"",toolTips:{tipText:e("help.siderbar.code_block"),keyText:{osx:"+Option+C",other:"Ctrl+Alt+C"},markdown:!0},type:"style"}].concat(r()(c.d)),menuLineB:[{dataKey:"insertorderedlist",className:"ol",toolTips:{tipText:e("common.ordered_list"),keyText:{osx:"+Shift+7",other:"Ctrl+Shift+7"},markdown:!0},type:"style"},{dataKey:"insertunorderedlist",className:"ul",des:"",toolTips:{tipText:e("common.unordered_list"),keyText:{osx:"+Shift+8",other:"Ctrl+Shift+8"},markdown:!0},type:"style"},{dataKey:"checkbox",className:"",des:"",toolTips:{tipText:e("common.task_list"),keyText:{osx:"+Option+T",other:"Ctrl+Alt+T"},markdown:!0}},{dataKey:"blockquote",className:"",des:"",toolTips:{tipText:e("common.reference"),keyText:{osx:"+Shift+>",other:"Ctrl+Shift+>"},markdown:!0},type:"style"},{dataKey:s.E,className:"insertCalloutBlock",des:"",toolTips:{tipText:e("CreationDoc_Docs_CalloutBlock_Tab"),markdown:!1},type:"style",hidden:function(){return!Object(f.f)()}},{dataKey:"insertseparator",className:"separator",des:"",dataId:"horizontal-btn",toolTips:{tipText:e("common.divider"),keyText:{osx:"+Option+S",other:"Ctrl+Alt+S"},markdown:!0},type:"style"},{dataKey:s.G,className:"codeblock",des:"",toolTips:{tipText:e("help.siderbar.code_block"),keyText:{osx:"+Option+C",other:"Ctrl+Alt+C"},markdown:!0},type:"style"},{dataKey:s.F,className:"codeblock",des:"",toolTips:{tipText:e("help.siderbar.code_block"),keyText:{osx:"+Option+C",other:"Ctrl+Alt+C"},markdown:!0},type:"style"}],insertList:[{dataKey:o.b.CHECKBOX,name:e("common.task_list"),className:"",dataSelector:"panel-checkbox",feature:["panel_checkbox_use"],toolTips:{tipText:e("common.task_list.tip"),keyText:{osx:"+Option+T",other:"Ctrl+Alt+T"},markdown:!0},type:"style"},{dataKey:o.b.INSERTIMAGE,name:e("common.image"),className:"image",des:"",dataId:"image-upload",toolTips:{tipText:e("editorbar.image"),keyText:{osx:"+Shift+U",other:"Ctrl+Shift+U"}}},{dataKey:o.b.IMAGE,name:e("common.image"),className:"image",dataId:"image-upload",toolTips:null,type:"style"},{dataKey:o.b.INSERT_TABLE,commandKey:o.F[o.b.INSERT_TABLE],actionName:"table",name:e("common.table_abtest"),className:"table",toolTips:null,type:"mention"},{dataKey:o.b.DRIVE,commandKey:o.F[o.b.DRIVE],actionName:"attachment",name:e("common.file"),className:"file",toolTips:{tipText:e("editorbar.file.des")},type:"mention"},{dataKey:o.b.BITABLE,commandKey:o.F[o.b.BITABLE],feature:["doc_create_gridview_from_list_intr"],className:"bitable",name:e("doc.a-panel.bitable.single-product"),actionName:"bitable_grid",toolTips:{tipText:e("doc.a-panel.bitable.tooltip")},type:"mention",hidden:!1},{dataKey:o.b.KANBAN,commandKey:o.F[o.b.KANBAN],name:e("doc.a-panel.kanban.single-product"),toolTips:{tipText:e("doc.a-panel.kanban.tooltip")},feature:["doc_create_kanbanview_from_list_intr"],className:"",type:"mention",hidden:!1},{dataKey:o.b.MINDNOTE,commandKey:o.F[o.b.MINDNOTE],className:"mindnote",name:e("mindnote.block_menu_item_name"),toolTips:{tipText:e("mindnote.block_menu_tips")},type:"mention"},{dataKey:o.b.SHEET,commandKey:o.F[o.b.SHEET],actionName:"sheet",name:e("common.sheet"),className:"",toolTips:null,type:"mention"},{dataKey:o.b.LINK,name:e("common.link"),className:"",toolTips:{tipText:e("editorbar.link.des"),keyText:{osx:"+K",other:"Ctrl+K"}},type:"style"},{dataKey:o.b.DOCUMENT,commandKey:o.F[o.b.DOCUMENT],actionName:"link_file",name:Object(d.x)()?e("common.docs_name"):e("common.sheet-docs"),className:"docs",toolTips:{tipText:Object(d.x)()?e("editorbar.add_docs"):e("editorbar.doc.des")},type:"mention",isLastItem:!0},{dataKey:o.b.USER,commandKey:o.F[o.b.USER],actionName:"user",name:e("common.user"),className:"user",toolTips:{tipText:e("editorbar.user.des")},type:"mention"},{dataKey:o.b.CHAT,commandKey:o.F[o.b.CHAT],actionName:"chat",name:e("common.chat"),className:"chat",toolTips:{tipText:e("editorbar.chat.des")},type:"mention"},{dataKey:o.b.POLL_BLOCK,commandKey:o.F[o.b.POLL_BLOCK],name:e("block.poll"),className:"poll",toolTips:null,type:"mention",isLastItem:!0},{dataKey:o.b.JIRA_BLOCK,commandKey:o.F[o.b.JIRA_BLOCK],name:e("doc.jira.jira"),className:"jira",actionName:"isv_jiramaster",toolTips:null,type:"mention",hidden:!Object(u.f)()||!Object(u.d)()},{dataKey:o.b.JIRA_FILTER_BLOCK,commandKey:o.F[o.b.JIRA_FILTER_BLOCK],name:e("doc.jira.jira_filter"),className:"jira",actionName:"isv_jiramaster",newUserNoShowFeature:!0,feature:[u.b],toolTips:null,type:"mention",hidden:!Object(u.d)()||Object(u.d)()&&Object(u.f)()}],embedIframeList:[{dataKey:o.b.YOUTUBE,commandKey:o.p.YOUTUBE,actionName:"iframe_youtube",name:e("common.YouTube"),className:"iframe",toolTips:{tipText:e("editorbar.youtube.des")},type:"mention"},{dataKey:o.b.TIKTOK,commandKey:o.p.TIKTOK,actionName:"iframe_tiktok",name:"TikTok",className:"iframe",toolTips:{tipText:e("editorbar.tiktok.des")},type:"mention"},{dataKey:o.b.BILIBILI,commandKey:o.p.BILIBILI,actionName:"iframe_bilibili",name:e("common.bilibili"),className:"iframe",toolTips:{tipText:e("editorbar.bilibili.des")},type:"mention"},{dataKey:o.b.XIGUA,commandKey:o.p.XIGUA,actionName:"iframe_xigua",name:e("common.xigua"),className:"iframe",toolTips:{tipText:e("editorbar.xigua.des")},type:"mention"},{dataKey:o.b.YOUKU,commandKey:o.p.YOUKU,actionName:"iframe_youku",name:e("common.youku"),className:"iframe",toolTips:{tipText:e("editorbar.youku.des")},type:"mention"},{dataKey:o.b.FIGMA,commandKey:o.p.FIGMA,actionName:"iframe_figma",name:e("common.figma"),className:"iframe",toolTips:{tipText:e("editorbar.figma.des")},type:"mention"},{dataKey:o.b.MODAO,commandKey:o.p.MODAO,actionName:"iframe_modao",name:e("common.modao"),className:"iframe",toolTips:{tipText:e("editorbar.modao.des")},type:"mention"},{dataKey:o.b.CANVA,commandKey:o.p.CANVA,actionName:"iframe_canva",name:e("common.canva"),className:"iframe",toolTips:{tipText:e("editorbar.canva.des")},type:"mention"},{dataKey:o.b.CODEPEN,commandKey:o.p.CODEPEN,actionName:"iframe_codepen",name:e("common.codepen"),className:"iframe",toolTips:{tipText:e("editorbar.codepen.des")},type:"mention"},{dataKey:o.b.JINSHUJU,commandKey:o.p.JINSHUJU,actionName:"iframe_jinshuju",name:e("common.jinshuju"),className:"iframe",toolTips:{tipText:e("editorbar.jinshuju.des")},type:"mention"},{dataKey:o.b.FEISHU_SURVEY,commandKey:o.p.FEISHU_SURVEY,actionName:"iframe_feishu_survey",name:e("common.feishu_survey"),className:"iframe",toolTips:{tipText:e("editorbar.feishu_survey.des")},type:"mention"},{dataKey:o.b.LARK_SURVEY,commandKey:o.p.LARK_SURVEY,actionName:"iframe_lark_survey",name:e("common.lark_survey"),className:"iframe",toolTips:{tipText:e("editorbar.lark_survey.des")},type:"mention"},{dataKey:o.b.AIRTABLE,commandKey:o.p.AIRTABLE,actionName:"iframe_airtable",name:e("common.Airtable"),className:"iframe",toolTips:{tipText:e("editorbar.Airtable.des")},type:"mention"},{dataKey:o.b.BAIDUMAP,commandKey:o.p.BAIDUMAP,actionName:"iframe_baidumap",name:e("block.iframe_map_baidu"),className:"iframe",toolTips:{tipText:e("editorbar.baidumap.des")},type:"mention"},{dataKey:o.b.AUTONAVI,commandKey:o.p.AUTONAVI,actionName:"iframe_autonavi",name:e("block.iframe_map_autonavi"),className:"iframe",toolTips:{tipText:e("editorbar.navimap.des")},type:"mention"},{dataKey:o.b.GMAPS,commandKey:o.p.GMAPS,actionName:"iframe_gmaps",name:e("block.iframe_map_gmaps"),className:"iframe",toolTips:{tipText:e("editorbar.gmaps.des")},type:"mention"}],menuBackColorMenu:[{dataKey:a.e.COLOR_PINK,color:a.f[a.e.COLOR_PINK]},{dataKey:a.e.COLOR_ORANGE,color:a.f[a.e.COLOR_ORANGE]},{dataKey:a.e.COLOR_YELLOW,color:a.f[a.e.COLOR_YELLOW]},{dataKey:a.e.COLOR_GREEN,color:a.f[a.e.COLOR_GREEN]},{dataKey:a.e.COLOR_BLUE,color:a.f[a.e.COLOR_BLUE]},{dataKey:a.e.COLOR_PURPLE,color:a.f[a.e.COLOR_PURPLE]},{dataKey:"separator",color:[]},{dataKey:a.e.COLOR_CLEAR,color:[]}],menuTableCell:[{dataKey:l.f.DO_MERGE_CELL,className:"mergecell",feature:["table_merge_cell"],des:"",dataId:"merge-cell-btn",toolTips:{tipText:e("editorbar.merge_cell")}},{dataKey:l.f.DO_UN_MERGE_CELL,className:"mergecell",feature:["table_merge_cell"],des:"",dataId:"merge-cell-btn",toolTips:{tipText:e("editorbar.split_cell")}},{dataKey:"alignleft",className:"",des:"",dataId:"align-left-btn",toolTips:{tipText:e("editorbar.align_left"),keyText:{osx:"+Shift+L",other:"Ctrl+Shift+L"}}},{dataKey:"aligncenter",className:"",des:"",dataId:"align-center-btn",toolTips:{tipText:e("editorbar.align_center"),keyText:{osx:"+Shift+E",other:"Ctrl+Shift+E"}}},{dataKey:"alignright",className:"",des:"",dataId:"align-right-btn",toolTips:{tipText:e("editorbar.align_right"),keyText:{osx:"+Shift+R",other:"Ctrl+Shift+R"}}},{separator:null},{dataKey:"bold",className:"",des:"",toolTips:{tipText:e("editorbar.bold"),keyText:{osx:"B",other:"Ctrl+B"},markdown:!0}},{dataKey:"strikethrough",className:"",des:"",toolTips:{tipText:e("common.strikethrough"),keyText:{osx:"+Shift+X",other:"Ctrl+Shift+X"},markdown:!0}},{dataKey:s.B,className:"",des:"",toolTips:{tipText:e("editorbar.hight"),keyText:{osx:"+Option+H",other:"Ctrl+Alt+H"}}}],menuTableCellMore:[{dataKey:"italic",className:"",des:"",toolTips:{tipText:e("common.italic"),keyText:{osx:"I",other:"Ctrl+I"},markdown:!0}},{dataKey:"underline",className:"",des:"",toolTips:{tipText:e("common.underline"),keyText:{osx:"U",other:"Ctrl+U"},markdown:!0}},{dataKey:"insertorderedlist",className:"ol",toolTips:{tipText:e("common.ordered_list"),keyText:{osx:"+Shift+7",other:"Ctrl+Shift+7"},markdown:!0}},{dataKey:"insertunorderedlist",className:"ul",des:"",toolTips:{tipText:e("common.unordered_list"),keyText:{osx:"+Shift+8",other:"Ctrl+Shift+8"},markdown:!0}},{dataKey:"checkbox",className:"",des:"",feature:["panel_checkbox_use"],dataSelector:"selection-checkbox",toolTips:{tipText:e("common.task_list"),keyText:{osx:"+Option+T",other:"Ctrl+Alt+T"},markdown:!0}},{dataKey:"blockquote",className:"",des:"",toolTips:{tipText:e("common.reference"),keyText:{osx:"+Shift+>",other:"Ctrl+Shift+>"},markdown:!0}},{dataKey:"inlinecode",className:"",des:"",toolTips:{tipText:e("common.inline_code"),keyText:{osx:"Ctrl++C",other:"Ctrl+Shift+C"},markdown:!0}},{dataKey:s.G,className:"codeblock",des:"",toolTips:{tipText:e("help.siderbar.code_block"),keyText:{osx:"+Option+C",other:"Ctrl+Alt+C"},markdown:!0}},{dataKey:s.F,className:"codeblock",des:"",toolTips:{tipText:e("help.siderbar.code_block"),keyText:{osx:"+Option+C",other:"Ctrl+Alt+C"},markdown:!0}}]};n()({},o.b.JIRA_FILTER_BLOCK,"jira_filter_enable");g.insertList=g.insertList.filter(function(e){return!e.hidden}),g.menuMore=g.menuMore.filter(function(e){return!e.hidden});o.b.USER,o.b.CHAT,o.b.DRIVE,o.b.DOCUMENT,o.b.IMAGE,o.b.INSERTIMAGE}).call(this,v("2vAP"))},"2tnv":function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("4PSP"),u=n("HmyT"),d=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},h=function(){function t(e){r()(this,t),this.editor=e}return a()(t,[{key:"aceClickEvent",value:function(e,t){var s=this;t.event.detail<3||this.editor.callStack.inCallStackIfNecessary("tripleClickSelectLineText",function(){s.editor.fastIncorp(!0);var e=s.editor.getRep(),t=e.selEnd,n=e.selStart;if(t&&n){var i=n[0],r=e.lines.atIndex(i);if(r&&r.lineNode){if(n[0]+1===t[0]){var o=e.lines.atIndex(t[0]);if(!o||o.lineMarker!==t[1])return}else if(n[0]!==t[0])return;var a=r.lineNode;Object(u.$)(a).hasClass("single-line")||(s.editor.selection.setWithSelection(e.zoneId,[i,0],[i,r.text.length]),s.editor.selection.updateBrowserSelectionFromRep(!0))}}})}}]),t}();d([Object(l.Bind)()],h.prototype,"aceClickEvent",null)},"2z0X":function(e,t,n){"use strict";var o=n("hbEN");function i(t,e){var n=[],i=Object(o.default)(function(){var e=n;n=[],t.call(void 0,e)},e),r=function(){var e=Array.prototype.slice.call(arguments,0);n=Array.from(new Set(n.concat(e))),i()};return r.cancel=i.cancel.bind(i),r.flush=i.flush.bind(i),r}t.a=i},"3AGV":function(e,t,n){"use strict";var i=n("lSNA"),s=n.n(i),o=(n("7EGn"),n("owWc")),c=n("jp/M"),l=n("QM+C"),u=n("SebV"),r=function(o,a){var s={count:0};return function(){var e,t,n=s.count,i=s.time,r=i&&Date.now()-i<1e3;return s=r?(a<(e=n+1)&&((t=console).log.apply(t,arguments),Object(u.a)("too many request: ".concat(e))),{time:i,count:e}):{time:Date.now(),count:1},o.apply(void 0,arguments)}},a=(n("lQZd"),n("OX8E"));n.d(t,"c",function(){return d}),n.d(t,"h",function(){return h}),n.d(t,"d",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"b",function(){return g}),n.d(t,"g",function(){return m}),n.d(t,"l",function(){return v}),n.d(t,"a",function(){return b}),n.d(t,"k",function(){return y}),n.d(t,"f",function(){return E}),n.d(t,"i",function(){return O}),n.d(t,"j",function(){return C});var d=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length?arguments[2]:void 0,i=3<arguments.length?arguments[3]:void 0,r=5<arguments.length?arguments[5]:void 0;return s()({type:c.actionTypes.comment.globalComment.FETCH_GLOBAL_COMMENT_LIST,payload:{token:t}},l.REQUEST,{url:c.apiUrls.POST_GET_GLOBAL_COMMENT_LIST,method:c.apiUrls.METHOD.POST,data:{token:t,page:e},serverFirst:r&&r.serverFirst,options:{transformResponse:function(e){return Object.assign({},e,{token:t,version:n,replaceAll:i})}}})};function h(e){a.a.trigger("handleSendToGlobalCommentCollabs",[{type:"DOC_COMMENT",data_str:JSON.stringify(e)}])}var f=function(e,t){return{type:c.actionTypes.comment.docComment.INIT_COMMENTS,payload:{allComments:e,token:t}}},p=function(e){return{type:c.actionTypes.comment.docComment.MERGE_COMMENT_MESSAGE_STATUSES,payload:e}},g=r(function(e,t,n,i,r){return s()({type:c.actionTypes.comment.docComment.FETCH_COMMENT_LIST,payload:{token:e}},l.REQUEST,{url:c.apiUrls.POST_GET_COMMENT_LIST,method:c.apiUrls.METHOD.POST,data:{token:e,comment_id:t},options:{transformResponse:function(e){var t=Object(o.a)(e,function(e,t,n){return"entities"!==n&&(t.finish?r&&r.call("resolveCommentSilently",n):e[n]=t),e},{});return Object.assign({fetchedComments:t,version:n},i,{entities:e.entities})}}})},10),m=function(e){return{type:c.actionTypes.comment.docComment.RESOLVE_COMMENT_ANIMATED,payload:{comment_id:e}}},v=function(e,t,n){var i=e.token,r=e.commentId,o=e.content,a=e.replyId;return s()({type:c.actionTypes.comment.docComment.UPDATE_REPLY_COMMENT,payload:{replyItem:t,commentId:r,replyId:a,editor:n}},l.REQUEST,{url:c.apiUrls.POST_UPDATE_REPLY_COMMENT,method:c.apiUrls.METHOD.POST,data:{token:i,content:o,comment_id:r,reply_id:a}})},b=function(e,t,n,i){return s()({type:c.actionTypes.comment.docComment.DELETE_REPLY_COMMENT,payload:{commentId:e,replyId:n,editor:i}},l.REQUEST,{url:c.apiUrls.POST_DELETE_REPLY_COMMENT,method:c.apiUrls.METHOD.POST,data:{token:t,reply_id:n}})},y=function(e){return{type:c.actionTypes.comment.docComment.UPDATE_COMMENTS,payload:e}},E=function(){return{type:c.actionTypes.comment.docComment.RESET_COMMENTS}},O=function(e,t){return s()({type:c.actionTypes.comment.SET_COMMENT_MESSAGE_READ,payload:Object.assign({},e,{type:t})},l.REQUEST,{url:c.apiUrls.POST_SET_MESSAGE_READ,method:c.apiUrls.METHOD.POST,data:e})},C=function(e){return{type:c.actionTypes.comment.docComment.TOGGLE_DOC_COMMENT,payload:e}}},"3BrA":function(e,t,n){},"3EEQ":function(e,t,n){"use strict";n.r(t);var i=n("pVnL"),o=n.n(i),r=n("lwsE"),a=n.n(r),s=n("q1tI"),c=n.n(s),l=n("i8i4"),u=n.n(l),d=n("W8MJ"),h=n.n(d),f=n("a1gu"),p=n.n(f),g=n("Nsbk"),m=n.n(g),v=n("7W2i"),b=n.n(v),y=(n("xD9Q"),n("Si88")),E=n.n(y),O=(n("17x9"),function(e){function n(e){var t;return a()(this,n),(t=p()(this,m()(n).call(this,e))).handleVisibilityChange=function(){"visible"===document.visibilityState&&t.exit()},t.close=function(){t.setState({show:!1})},t.exit=function(){t.props.onExited()},t.state=Object.assign({},e,{show:!0}),document.addEventListener("visibilitychange",t.handleVisibilityChange),t}return b()(n,e),h()(n,[{key:"componentWillUnmount",value:function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)}},{key:"render",value:function(){var e=this.state,t=e.style,n=e.component,i=e.show,r=e.className,o=this.props,a=o.handlePopOverEnter,s=o.handlePopOverLeave;return c.a.createElement(E.a,{in:i,timeout:250,className:"mention-popover comment-ignore-blur ".concat(r),classNames:"popover-fade",onExited:this.props.onExited},c.a.createElement("section",{style:t,onMouseEnter:a,onMouseLeave:s},n))}}]),n}(s.Component)),C=n("VI6H");n.d(t,"default",function(){return k});var k=function e(t){a()(this,e);var n=t.container,i=document.createElement("div");function r(){u.a.unmountComponentAtNode(i),n.removeChild(i)}return Object(C.x)()&&n===document.body&&(i.style.position="absolute",i.style.top=0,i.style.left=0),n.appendChild(i),u.a.render(c.a.createElement(O,o()({},t,{onExited:r})),i)}},"3HEd":function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s});var i=n("Guq5"),r="UploadImgOrVideoPlugin",o="img-and-video-upload-trigger-button",a="image/gif, image/jpg, image/jpeg, image/bmp, image/png, video/mpeg, video/mp4, video/3gpp",s=[i.a.A_PANEL,i.a.BLOCK_MENU]},"3HGU":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 16 16"},t),c.a.createElement("path",{d:"M13.44 2c.31 0 .56.26.56.58v8.56c0 .32-.25.58-.56.58h-2.51l-2.4 2.1a.54.54 0 01-.79 0l-2.4-2.1H2.57a.57.57 0 01-.56-.58V2.58c0-.32.25-.58.56-.58h10.88zM5.91 6H4.79a.28.28 0 00-.28.28v1.16c0 .15.13.27.28.27h1.12c.15 0 .28-.12.28-.27V6.28A.28.28 0 005.9 6zM8.7 6H7.58a.28.28 0 00-.28.28v1.16c0 .15.13.27.28.27H8.7c.15 0 .28-.12.28-.27V6.28A.28.28 0 008.7 6zm2.79 0h-1.12a.28.28 0 00-.28.28v1.16c0 .15.13.27.28.27h1.12c.15 0 .28-.12.28-.27V6.28a.28.28 0 00-.28-.28z",fill:"#8F959E",fillRule:"evenodd"}))}},"3Iah":function(e,t,n){},"3K16":function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n("J4zp"),r=n.n(i),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("cDf5"),u=n.n(l),d=n("d0/N"),h=n("4PSP"),f=n("U5G9"),p=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":u()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},g=Object(f.b)({module:f.a.BACK}),m=function(){function i(e){var t=e.editor,n=e.eventEmitter;a()(this,i),this.editor=null,this.scrollOffset=0,this.editor=t,this.controller=new d.a(n),this.bindEvents()}return c()(i,[{key:"changesetApply",value:function(e,t){var n,i;this.syncOffset&&(n=t.changeset,i=g.characterRangeFollow(n,this.scrollOffset,this.scrollOffset,null),this.scrollOffset=i[0])}},{key:"reset",value:function(){this.unbindEvents(),this.editor=null,this.controller&&(this.controller.destroy(),this.controller=null)}},{key:"onMount",value:function(){this.controller&&this.controller.docMounted()}},{key:"bindEvents",value:function(){this.controller&&(this.controller.onTopToOffset(this.topToOffset),this.controller.onOffsetToTop(this.offsetToTop),this.controller.onToggleSync(this.toggleSync))}},{key:"unbindEvents",value:function(){this.controller&&(this.controller.offTopToOffset(this.topToOffset),this.controller.offOffsetToTop(this.offsetToTop),this.controller.offToggleSync(this.toggleSync))}},{key:"topToOffset",value:function(){var e,t,n;this.editor&&this.editor.plugins&&this.editor.plugins.viewportObserver&&(e=this.editor.getRep("0"),t=this.editor.plugins.viewportObserver.getVisibleRange(),n=r()(t,1)[0],this.scrollOffset=e.lines.offsetOfIndex(n))}},{key:"offsetToTop",value:function(){var e,t,n,i;this.controller&&this.editor&&(t=(e=this.editor.getRep("0").lines).indexOfOffset(this.scrollOffset),(n=e.atIndex(t))&&(i=n.getLineRect().top,this.controller.jump(i)))}},{key:"toggleSync",value:function(e){this.syncOffset=e}}]),i}();p([Object(h.Bind)()],m.prototype,"topToOffset",null),p([Object(h.Bind)()],m.prototype,"offsetToTop",null),p([Object(h.Bind)()],m.prototype,"toggleSync",null)},"3OMI":function(e,t,n){},"3UIW":function(e,t,n){"use strict";n.d(t,"a",function(){return k});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),f=n("XhtD"),l=(n("KQ26"),n("YNKm")),u=n("7Kxq"),d=n("YWBl"),h=n("F9bh"),p=n("iP/4"),g=n("OX8E"),m=n("y2sV"),v=n("kESg"),b=n("Poi8"),y=n("rPvU"),E=n("DIyy"),O=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},C={left:!0,center:!0,right:!0,full:!0},k=function(){function t(e){var i=this;r()(this,t),this.className="Align",this.init=function(n){[l.c,l.a,l.d,l.b].forEach(function(e){var t=e.slice(5);n.registerAceCommand(e,i.alignCommand,{statusKey:"align-".concat(t)})})},this.alignCommand=function(e,t,n,i){var r=i.source,o=(e.slice(5)||"").toLowerCase(),a=t.doInsertAlign({attribKey:"align",attribValue:o});Object(d.a)({action:n.statusKey,op:a?u.g:u.f,source:r})},this.reset=function(){i.editor=null},e&&(this.editor=e,this.editor.doInsertAlign=this.doInsertAlign,this.init(e))}return a()(t,[{key:"renderLine",value:function(e){var t=e.lineState,n=e.children,i=t.getLineAttributes().toMap().align;return i&&(e.lineClass+=" align-".concat(i)),n}},{key:"doInsertAlign",value:function(e){var n,t=this,i=e.attribKey,r=e.attribValue,o=e.range,a=e.isAllHasAttrib,s=o.selStart,c=o.selEnd,l=o.attributeManager,u=o.zoneId,d=Object(f.a)(s[0],c[0]+1);if(!(r&&void 0===C[r]||Object(b.i)(this.editor,u))){p.a.safari&&1===d.length&&(n=this.editor.getRep(),this.editor.isImageLine(n.zoneId,d[0])&&setTimeout(function(){var e,t=n.lines.atIndex(d[0]);t&&t.lineNode&&((e=t.lineNode.querySelector("img"))&&e.click())}));var h=d.filter(function(e){return t.editor.canSetAttributesOnLineExcludeAttrs(o.zoneId,e,[["horizontal-line","true"],["sheet-id",""],["aceTable",""],[v.k.ZoneType,v.l.CodeBlock]])});return g.a.trigger("showAbstractIfNecessary"),a?l.removeAttributeOnMultiLines(h,i):l.setAttributeOnMultiLines(h,i,r),this.editor&&E.a.tryToggleAttributeInZone(this.editor,o,i,r),a}}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement){var r=/(?:^| )align-(\S+)/.exec(t.className);if(r)return Object(m.I)(n,i,{align:r[1]})}return n}},{key:"editorWillDoReturnKey",value:function(e){var t,n=e.delta,i=e.editor,r=i.getContentState().getActiveZone(),o=r.getZoneId(),a=i.selection.getSelection(),s=a.toPosition(),c=s.start,l=s.len,u=r.getLine(a.start.line),d=u.getLineAttributes().toMap(),h=u.isEmpty(),f=d.align;!f||n.ops.length||l||(t=new m.E({zoneId:o}),h&&"left"!==f&&(d.align="",t.retain(c-1).retain(1,d)),h||t.retain(c).insertEnter().insertLineMarker(d),e.delta=n.compose(t))}},{key:"editorWillDoDeleteKey",value:function(e){var t,n,i,r,o=e.deltaSet,a=e.editor,s=a.getContentState().getActiveZone(),c=s.getZoneId(),l=a.selection.getSelection(),u=l.toPosition(),d=u.start,h=u.len,f=s.getLine(l.start.line).getLineAttributes().toMap(),p=f.align;p&&!h&&(t=1===l.start.offset,n=new m.E({zoneId:c}),i=o.get(c).ops.length,t&&!i&&"left"!==p&&(r={right:"center",center:"left"},f.align=r[p],n.retain(d-1).retain(1,f)),e.deltaSet=o.compose(n))}},{key:"serialize",value:function(e){var t,n=e.type,i=e.node,r=e.lineAttributes,o=r&&r.align;return n===m.u.LINE&&o&&((t=document.createElement("div")).appendChild(i),t.style["text-align"]=o,e.node=t),e}},{key:"editorWillPaste",value:function(e){var t=e.deltaSet,n=e.zoneId,i=t.get(n),r=this.editor.getContentState().getZoneState(n),o=this.editor.selection.getLine(),a=i.ops[0]&&i.ops[0].attributes&&i.ops[0].attributes.align;!r.getLine(o).isEmpty()&&a&&(delete i.ops[0].attributes.align,Object(y.a)(i.ops[0].attributes)&&i.ops.shift())}}]),t}();O([Object(h.a)({includeTitle:!0})],k.prototype,"doInsertAlign",null),O([Object(m.J)(300)],k.prototype,"editorWillDoDeleteKey",null)},"3VXv":function(e,t,n){"use strict";n.d(t,"a",function(){return Container}),n.d(t,"b",function(){return Text});var i=n("VkAN"),r=n.n(i),o=n("vOnD"),a=n("MjSh");function s(){var e=r()(["\n  margin-top: 7px;\n  color: ",";\n  font-size: 12px;\n  line-height: 1;\n"]);return s=function(){return e},e}function c(){var e=r()(["\n  background-color: ",";\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]);return c=function(){return e},e}var Container=o.default.div(c(),a.N00),Text=o.default.div(s(),a.N600)},"3b/h":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("gq0T"),o=n("DNsP");function i(){var e=Object(r.f)();if(e)try{var t=JSON.parse(e),n=t.text,i=t.background;return Object(r.g)(n)||Object(r.g)(i)?[e,t]:[o.r,o.q]}catch(e){return console.error("Highlight local value format is damaged: ".concat(e)),[o.r,o.q]}return[o.r,o.q]}},"3doy":function(e,t,n){"use strict";n.r(t);var i,r,o=n("lSNA"),a=n.n(o),s=n("RIqP"),c=n.n(s),l=n("BmhO"),u=n("QM+C"),d=n("ahx2"),h=n("hNo0");(r=i=i||{}).ADD="ADD",r.TASK_PROGRESS="TASK_PROGRESS",r.FILE_PROGRESS="FILE_PROGRESS",r.SUCCESS="SUCCESS",r.ERROR="ERROR",r.CANCEL="CANCEL",r.CANCEL_ALL="CANCEL_ALL",r.PAUSE="PAUSE",r.PAUSE_ALL="PAUSE_ALL",r.PENDING="PENDING";var f,p,g,m,v,b,y,E,O,C,k,I,S,T,_,w,j,M,L,R,N,D,x=n("658s");n.d(t,"BoxUploadStatus",function(){return p}),n.d(t,"BoxDownloadStatus",function(){return m}),n.d(t,"BoxLarkUploadStatus",function(){return b}),n.d(t,"CallerType",function(){return E}),n.d(t,"RegenerateType",function(){return O}),n.d(t,"RedirectType",function(){return k}),n.d(t,"PreviewRightPanelType",function(){return S}),n.d(t,"VersionPreviewType",function(){return _}),n.d(t,"WarningType",function(){return j}),n.d(t,"FileErrorType",function(){return L}),n.d(t,"PostFileCdnUrlPolicy",function(){return N}),n.d(t,"PDFPreviewTypes",function(){return H}),n.d(t,"mountPointTypeMap",function(){return F}),n.d(t,"IOMessageDataType",function(){return P}),n.d(t,"CommentType",function(){return U}),n.d(t,"FeedToolbarHiddenWidth",function(){return Z}),n.d(t,"COMPLETE_DELETE_CALLER",function(){return V}),n.d(t,"NoteMetaSyncTypes",function(){return W}),n.d(t,"MountPointType",function(){return h.a}),n.d(t,"ACTION",function(){return i}),n.d(t,"NEW_FILE_VERSION_SOURCE",function(){return x.a}),(g=p=p||{}).PENDING="pending",g.UPLOADING="uploading",g.SUCCESS="success",g.ERROR="error",g.PAUSE="pause",(v=m=m||{}).PENDING="downloadPending",v.DOWNLOADING="downloading",v.SUCCESS="downloadSuccess",v.ERROR="downloadError",v.PAUSE="downloadPause",(y=b=b||{}).PENDING="uploadPending",y.UPLOADING="uploading",y.CONVERTING="importConverting",y.SUCCESS="uploadSuccess",y.ERROR="uploadError",y.PAUSE="uploadPause",(E=E||{}).EXPLORER="explorer",(C=O=O||{})[C.DEFAULT=0]="DEFAULT",C[C.MANUAL=1]="MANUAL",(I=k=k||{})[I.OFF=0]="OFF",I[I.ON=1]="ON",(T=S=S||{}).Comment="Comment",T.FileInfo="FileInfo",(w=_=_||{}).Revert="Revert",w.Download="Download",w.Delete="Delete",(M=j=j||{})[M.ColumnCut=1]="ColumnCut",M[M.CellCut=2]="CellCut",M[M.ColumnAndCellCut=3]="ColumnAndCellCut",(R=L=L||{})[R.Other=1]="Other",R[R.NumLimited=88]="NumLimited",R[R.UnknownProblem=100]="UnknownProblem",R[R.xmlVersionNotSupport=101]="xmlVersionNotSupport",R[R.FileEncrypted=102]="FileEncrypted",R[R.ForderNumLimited=4001]="ForderNumLimited",R[R.SizeLimited=9004]="SizeLimited",R[R.EmptyFile=9011]="EmptyFile",R[R.FolderNodeLimited=d.NODE_OUT_OF_LIMIT_BY_EXPLORER_ERROR_CODE]="FolderNodeLimited",(D=N=N||{}).equal="equal",D.near="near",D.allow_up="allow_up",D.allow_down="allow_down";var P,B,U,z,H=[l.s.PDF].concat(c()(l.F),c()(l.G),c()(l.B),c()(l.H)),F=(f={},a()(f,u.NUM_FILE_TYPE.DOC,h.a.DOC),a()(f,u.NUM_FILE_TYPE.BITABLE,h.a.BITABLE),a()(f,h.a.BITABLE,h.a.BITABLE),f);(B=P=P||{}).USER_NEWINFO="USER_NEWINFO",B.USER_LEAVE="USER_LEAVE",B.ROOM_MEMBERS="ROOM_MEMBERS",B.USER_CHANGES="USER_CHANGES",B.MESSAGE_CHANNEL="MESSAGE_CHANNEL",B.PUSH_COMMENT="driveCommonPushChannel",B.DELETE_FILE_VERSION="DELETE_FILE_VERSION",B.UPLOAD_FILE_VERSION="UPLOAD_FILE_VERSION",B.UPDATE_FILE_META="UPDATE_FILE_META",(z=U=U||{})[z.RECT=1]="RECT",z[z.OLD=2]="OLD",z[z.FULL=3]="FULL",z[z.TEXT=4]="TEXT";var V,W,K,Z=300;(V=V||{}).STORAGE_CENTER="quota_center",(K=W=W||{}).USER_CHANGES="USER_CHANGES",K.ACCEPT_COMMIT="ACCEPT_COMMIT",K.NEW_CHANGES="NEW_CHANGES"},"3iI8":function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("AYG9"),u=n("4PSP"),d=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},h=function(){function e(){r()(this,e),this.className="MemoryMonitor",this.isStartEdit=!1}return a()(e,[{key:"changesetApplyAsync",value:function(e,t){t&&t.isRemote||(this.logAfterEditMemoryChange(),this.isStartEdit||(Object(l.b)(l.a.AFTER_EDIT),this.isStartEdit=!0))}},{key:"logAfterEditMemoryChange",value:function(){Object(l.c)(l.a.AFTER_EDIT),this.isStartEdit=!1}}]),e}();d([Object(u.Debounce)(500)],h.prototype,"logAfterEditMemoryChange",null)},"3poY":function(e,t,n){"use strict";function i(e,t){var n=e.advancedDomToRep(t);if(!n)return null;var i=n.selStart[2],r=n.selStart[0],o=e.getRep(i),a=c(e,i,r);if(!a.length)return null;var s=a.map(function(e){return o.lines.atIndex(e).lineNode});return{start:s[0],end:s[s.length-1],list:s}}function c(e,t,n){var i=e.getRep(t).lines.atIndex(n);if(!(e.getAttributeOnLine(t,n,"heading")&&i&&i.domInfo&&i.domInfo.isCollapsedHeading()))return[];var r=e.lineTracker.collapseLines;if(!r)return[];var o=r.tracker(t);if(!o)return[];for(var a=o.entries,s=[],c=n;c<a.length&&a[c].output.renderCollapsed&&(!a[c].output.startOfCollapseSection||c===n);c+=1)s.push(c);return s}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c})},"3xnr":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i="outer-placeholder-container"},4:function(e,t){},"4+Yg":function(e,t,n){"use strict";n.d(t,"b",function(){return r});var f=n("Tqb2"),u=function(e){if(!e)return!1;var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value.content,s=!0,c=!1,l=void 0;try{for(var u,d=a.ops[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var h=u.value;if(Object(f.M)(h))return!0}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return!1},d=function(e){if(!e)return!1;var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value.content,s=!0,c=!1,l=void 0;try{for(var u,d=a.ops[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var h=u.value;if(Object(f.G)(h))return!0}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return!1},i=function(e){for(var t=0,n=Object.values(e);t<n.length;t++){var i=n[t],r=!0,o=!1,a=void 0;try{for(var s,c=i[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;return u(l.deletes)||u(l.inserts)}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}}return!1},r=function(e){for(var t=0,n=Object.values(e);t<n.length;t++){var i=n[t],r=!0,o=!1,a=void 0;try{for(var s,c=i[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;return u(l.inserts)&&d(l.inserts)}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}}return!1};t.a=i},"4/Xm":function(e,t,n){"use strict";n.d(t,"a",function(){return v});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("4PSP"),u=n("OX8E"),d=n("rUU8"),h=n("ciJ8"),f=n("DNsP"),p=n("zAQS"),g=n("nVH4"),m=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},v=function(){function t(e){r()(this,t),this.editor=e,this.visible=!1,this.zoneId=null,this.hideToolbarTimer=null,this.editor.on("editorbar:changedSelection",this.handleToolbarChangedSelection),this.editor.on("editorbar:updateToolbarHightlight",this.handleToolbarStatus),u.a.on(d.c.MOUSE_ENTER_SELECTION_POPOVER,this.cleanHideToolbarTimer),u.a.on(d.c.MOUSE_LEAVE_SELECTION_POPOVER,this.hideToolbarDelay)}return a()(t,[{key:"cleanHideToolbarTimer",value:function(){this.hideToolbarTimer&&clearTimeout(this.hideToolbarTimer),this.hideToolbarTimer=null}},{key:"handleToolbarChangedSelection",value:function(e){var t,n,i=e.popupType,r=e.customPopup;i===g.d.CALLOUT_BLOCK?(t=r.visible,n=r.innerZone,this.visible=t,this.zoneId=n):(this.visible=!1,this.zoneId=null)}},{key:"handleToolbarStatus",value:function(){var e,t,n=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).options,i=void 0===n?{}:n;i.selection&&i.selection.innerZone&&((e=Object(p.f)(this.editor,i.selection.innerZone))&&(t=this.editor.getContentState().getAttributes(e.start,e.end).toMap(),this.colorChanged(t)))}},{key:"showToolbarImmediately",value:function(e){var t,n,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=Object(p.f)(this.editor,e);r&&(t=r.start,n=r.end,this.cleanHideToolbarTimer(),this.editor.call("customPopupControl",{zoneId:t.zoneId,status:!0,selStart:[t.line,t.offset],selEnd:[n.line,n.offset],innerZone:e,force:i}))}},{key:"hideToolbarImmediately",value:function(){this.visible&&this.editor.call("customPopupControl",{status:!1})}},{key:"hideToolbarDelay",value:function(){this.hideToolbarTimer=window.setTimeout(this.hideToolbarImmediately,500)}},{key:"selectionChanged",value:function(){var e=this.editor.selection.getSelection().start,t=Object(p.j)(this.editor,e.zoneId),n=this.editor.selection.isCaret();t&&n&&this.showToolbarImmediately(e.zoneId,!0)}},{key:"colorChanged",value:function(e){var t=Object(p.g)(e[h.i.BackgroundColor]),n=Object(p.b)(t,e[h.i.BorderColor]);u.a.emit(f.j,{text:e[h.i.TextColor],border:n?h.q.get(n):void 0,background:Object(p.n)(e[h.i.BackgroundColor],!0)})}},{key:"getCurrentZone",value:function(){return this.zoneId}},{key:"destroy",value:function(){this.editor.off("editorbar:changedSelection",this.handleToolbarChangedSelection),this.editor.off("editorbar:updateToolbarHightlight",this.handleToolbarStatus),u.a.off(d.c.MOUSE_ENTER_SELECTION_POPOVER,this.cleanHideToolbarTimer),u.a.off(d.c.MOUSE_LEAVE_SELECTION_POPOVER,this.hideToolbarDelay)}}]),t}();m([Object(l.Bind)()],v.prototype,"cleanHideToolbarTimer",null),m([Object(l.Bind)()],v.prototype,"handleToolbarChangedSelection",null),m([Object(l.Bind)()],v.prototype,"handleToolbarStatus",null),m([Object(l.Bind)()],v.prototype,"showToolbarImmediately",null),m([Object(l.Bind)()],v.prototype,"hideToolbarImmediately",null),m([Object(l.Bind)()],v.prototype,"hideToolbarDelay",null),m([Object(l.Bind)()],v.prototype,"selectionChanged",null),m([Object(l.Bind)()],v.prototype,"colorChanged",null),m([Object(l.Bind)()],v.prototype,"getCurrentZone",null)},"46iY":function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return E});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("q1tI"),u=n.n(l),d=n("YNKm"),h=n("YWBl"),f=n("7Kxq"),p=n("F9bh"),g=n("y2sV"),m=n("OWch"),v=n("Nl7c"),b=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},y="IGNORE_ITALIC",E=function(){function t(e){var n=this;r()(this,t),this.editor=e,this.className="Italic",this.aceInitialized=function(e,t){n.init(t.editorInfo)},this.aceAttribsToClasses=function(e,t){if("italic"===t.key)return["tag:i"]},this.editor=e,this.init(e)}return a()(t,[{key:"init",value:function(e){var a=this;e.commands.registerAceCommand(d.M,function(e,t,n,i){var r=i.source,o=a.toggleAttribute({attribKey:"italic",attribValue:!0});Object(h.a)({action:"italic",op:o?f.g:f.f,source:r})},{statusKey:"italic-true"})}},{key:"toggleAttribute",value:function(e){var t=e.attribKey,n=e.attribValue,i=e.range,r=e.isSpecialSelection,o=e.isAllHasAttrib,a=i.selStart,s=i.selEnd,c=i.attributeManager;return r?(c.setAttributesOnRange(a,s,[[t,o?"":n]]),o):this.editor.toggleAttributeOnSelection(t,i,n)}},{key:"serialize",value:function(e){return Object(g.P)(e,{tagAttribute:d.M,wrapTag:g.a[d.M]})}},{key:"match",value:function(e){return"italic"===e}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement){var r=t.tagName,o=t.getAttribute("style")||"";if("I"===r||"EM"===r||/\bfont-style:\s*italic\b/i.test(o))return Object(g.H)(n,i,{italic:"true"})}return n}},{key:"render",value:function(e){var t=e.children;return u.a.createElement(g.w,{style:{fontStyle:"italic"}},t)}}]),t}();b([Object(p.a)()],E.prototype,"toggleAttribute",null),b([m.a,Object(v.b)()],E.prototype,"render",null)},"4D8z":function(e,t,n){"use strict";n.d(t,"j",function(){return o}),n.d(t,"q",function(){return a}),n.d(t,"r",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"l",function(){return l}),n.d(t,"m",function(){return u}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return h}),n.d(t,"g",function(){return f}),n.d(t,"w",function(){return p}),n.d(t,"y",function(){return g}),n.d(t,"x",function(){return m}),n.d(t,"z",function(){return v}),n.d(t,"F",function(){return b}),n.d(t,"C",function(){return y}),n.d(t,"v",function(){return E}),n.d(t,"A",function(){return O}),n.d(t,"k",function(){return C}),n.d(t,"u",function(){return k}),n.d(t,"p",function(){return I}),n.d(t,"n",function(){return S}),n.d(t,"f",function(){return T}),n.d(t,"o",function(){return _}),n.d(t,"a",function(){return w}),n.d(t,"E",function(){return j}),n.d(t,"e",function(){return M}),n.d(t,"b",function(){return L}),n.d(t,"D",function(){return R}),n.d(t,"B",function(){return N}),n.d(t,"s",function(){return D}),n.d(t,"c",function(){return x}),n.d(t,"d",function(){return P});var i=n("YNKm"),r=n("rLED"),o=730,a="pc",s=100,c=50,l=20,u=40,d=Object(r.j)()?270:320,h=270,f=20,p=60,g=40,m=24,v=20+(g-12),b=16,y=20,E={paddingLeft:0,paddingRight:0},O=(E.paddingLeft,E.paddingRight,0),C=45,k={ADD_COL_OR_ROW:"click_add_table_range",INSERT_TABLE:"click_add_table",REMOVE_TABLE:"client_delete_table",DRAG_COL_OR_ROW:"client_drag_table_range",REMOVE_COL_OR_ROW:"click_delete_table_range",TABLE_SRCOLL:"client_performance_doc_table_scroll",ADD_COL:"client_performance_doc_table_add_col",ADD_ROW:"client_performance_doc_table_add_row",DELETE_COL_OR_ROW:"client_performance_doc_table_delete_col_or_row",CLICK_COL_HEADER:"client_performance_doc_table_click_col_header",CLICK_ROW_HEADER:"client_performance_doc_table_click_row_header",MOUSE_ENTER:"client_performance_doc_table_horz_mouse_enter",HORZ_RESIZE:"client_performance_doc_table_horz_resize",HORZ_RESIZE_END:"client_performance_doc_table_horz_resize_end",MOUNT_TABLE:"mount_table"},I="insertTable",S="doInsertTable",T={DO_INSERT_TABLE:"DO_INSERT_TABLE",INSERT_TABLE_PICKER:"INSERT_TABLE_PICKER",DO_MERGE_CELL:"DO_MERGE_CELL",DO_UN_MERGE_CELL:"DO_UN_MERGE_CELL"},_=(i.s,i.t,i.u,i.i,i.M,i.db,i.B,i.l,i.h,i.H,i.J,i.c,i.a,i.d,i.G,{OVERLAY_CHANGE:"OVERLAY_CHANGE",CONTEXT_CHANGE:"CONTEXT_CHANGE",CUT:"TABLE_CUT",COPY:"TABLE_COPY",UPDATE_CELL_SELECT:"UPDATE_CELL_SELECT"}),w={COL_WIDTH:"colWidth",MERGE_CELL_ID:"mergeCellID",COL_SPAN:"colspan",ROW_SPAN:"rowspan",COL_MIN_WIDTH:"colMinWidth"},j={MOVE:"move",CLICK:"click",OTHER:""},M={TABLE_FULL_WIDTH:"tableFullWidth",PASTE_CELLS_ONTO_TABLE:"paste-cells-onto-table",TABLE_COL_WIDTH:"tableColWidth",TABLE_CELL_FOCUS:"tableCellFocus",TABLE_DRAG:"tableDrag",ADD_ROW:"addRow",DELETE_ROW:"deleteRow",ADD_COL:"addCol",DELETE_COL:"deleteCol",CHECK_IS_FOCUSED:"checkIsFocused",ADD_LINE_BETWEEN_TABLES:"addLineBetweenTables",TABLE_MERGE_CELL:"tableMergeCell",TABLE_UNMERGE_CELL:"tableUnMergeCell",DELETE_TABLE:"deleteTable",ZONE_FOCUS:"zoneFocus"},L={IFRAME:".block-type-IFRAME_BLOCK",FILE_CARD:".block-type-FILE_CARD_BLOCK.block-viewtype-card",FILE_CARD_PRVIEW:".block-type-FILE_CARD_BLOCK.block-viewtype-preview",LINK_BOOKMARK:".block-type-LINK_BLOCK.block-viewtype-card",POLL:".block-type-POLL_BLOCK",GROUP_CARD:".mention-type_5",JIRA_ISSUE:".jira-issue--card"},R="ace-table-row-select-hover",N="Table:handleHorzResize",D="table-cell-disable-selected-cell",x=["FILE_CARD_BLOCK","CHAT_CARD_BLOCK","DIAGRAM_BLOCK","EQUATION_BLOCK","MINDNOTE_BLOCK","LINK_BLOCK"],P=["POLL_BLOCK"]},"4DL9":function(e,t,n){"use strict";var i=n("lSNA"),E=n.n(i),r=n("J4zp"),O=n.n(r),C=n("q1tI"),k=n.n(C),o=n("pVnL"),a=n.n(o),s=n("QILm"),c=n.n(s),I=function(e){e.styles;var t=c()(e,["styles"]);return k.a.createElement("svg",a()({width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},t),k.a.createElement("path",{clipRule:"evenodd",d:"M6 3.86L1.93 7.93c-.1.1-.25.1-.35 0l-.35-.36a.25.25 0 010-.35L5.65 2.8c.2-.2.5-.2.7 0l4.42 4.42c.1.1.1.26 0 .35l-.35.36c-.1.1-.26.1-.35 0L6 3.86z"}))},S=n("aBgF"),l=n("TSYQ"),T=n.n(l),_=(n("MNj/"),"input-number");function u(i){var r=Object(C.useRef)(0),e=Object(C.useState)(0),t=O()(e,2),o=t[0],a=t[1],n=Object(C.useState)(!1),s=O()(n,2),c=s[0],l=s[1],u=Object(C.useRef)(null),d=Object(C.useRef)(!1),h=Object(C.useRef)(!1),f=function(e){var t,n;e<1||(t=i.formatter,n=i.onValueUpdate,r.current=e,a("function"==typeof t?t(e):e),"function"==typeof n&&n(r.current,o))},p=function(e){(i.checker||function(e){return/^[0-9]*$/.test(e)})(e.target.value)&&(a(e.target.value),r.current=parseInt(e.target.value,10)||r.current)},g=function(){var e="function"==typeof i.transformer?i.transformer("".concat(o).toLowerCase()):parseInt("".concat(o),10);f(e||r.current)},m=function(){l(!0)},v=function(){l(!1),g()},b=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;f(r.current+e),d.current=!0},y=function(e){e.keyCode===S.c.Enter?(g(),i.onEnterKeyUp&&i.onEnterKeyUp(r.current,o)):e.keyCode===S.c.Up?(b(1),e.preventDefault()):e.keyCode===S.c.Down&&b(-1)};return Object(C.useEffect)(function(){u.current&&(d.current&&(u.current.focus(),u.current.setSelectionRange(u.current.value.length,u.current.value.length),d.current=!1),h.current&&(u.current.select(),h.current=!1))}),Object(C.useEffect)(function(){var e=i.defaultValue;f(e||1),h.current=!0},[]),k.a.createElement("div",{className:T()(_,E()({},"".concat(_,"-focus"),c))},k.a.createElement("div",{className:"".concat(_,"-handler-wrap")},k.a.createElement("button",{className:"".concat(_,"-handler ").concat(_,"-handler-up"),onClick:function(){return b(1)}},k.a.createElement(I,null)),k.a.createElement("button",{className:T()("".concat(_,"-handler"),"".concat(_,"-handler-down"),E()({},"".concat(_,"-handler-disabled"),1===r.current)),onClick:function(){return b(-1)}},k.a.createElement(I,{style:{transform:"rotate(180deg)"}}))),k.a.createElement("div",{className:"".concat(_,"-input-wrap")},k.a.createElement("input",{ref:u,className:"".concat(_,"-input"),value:o,onChange:p,onBlur:v,onKeyDown:y,onFocus:m})))}t.a=u},"4Ef3":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return E});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("PJYZ"),h=n.n(d),f=n("7W2i"),p=n.n(f),g=n("q1tI"),m=n.n(g),v=(n("17x9"),n("i8i4")),b=n.n(v),y=n("hbEN"),E=function(e){function t(e){var i;return r()(this,t),(i=c()(this,u()(t).call(this,e))).setNode=function(e){var t=g.Children.only(i.props.children);t.ref&&t.ref(e);var n=e;i.props.customRef&&(n=e[i.props.customRef]),i.node=n&&b.a.findDOMNode(n)},i.changing=!1,i.viewportContentChange=i.viewportContentChange.bind(h()(i)),i.viewportContentChangeEnd=Object(y.default)(i.viewportContentChangeEnd.bind(h()(i)),200),i}return p()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.node.addEventListener("scroll",this.viewportContentChange),window.addEventListener("resize",this.viewportContentChange)}},{key:"componentWillUnmount",value:function(){this.node.removeEventListener("scroll",this.viewportContentChange),window.removeEventListener("resize",this.viewportContentChange)}},{key:"viewportContentChange",value:function(e){this.viewportContentChangeStart(),this.changing=!0,this.props.bus.trigger("viewportContentChange"),this.viewportContentChangeEnd()}},{key:"viewportContentChangeStart",value:function(){this.changing||this.props.bus.trigger("viewportContentChangeStart")}},{key:"viewportContentChangeEnd",value:function(){this.changing=!1,this.props.bus.trigger("viewportContentChangeEnd")}},{key:"render",value:function(){var e=g.Children.only(this.props.children);return Object(g.cloneElement)(e,{ref:this.setNode})}}]),t}(m.a.Component)},"4I7P":function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{}).JuraIssue="JuraIssue",r.JuraFilter="JuraFilter",r.Unknow="Unknow"},"4Jzg":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"12",height:"12",viewBox:"0 0 12 12"},t),c.a.createElement("path",{d:"M3.7 6l4.65-4.65a.5.5 0 10-.7-.7L2.29 6l5.36 5.35a.5.5 0 10.7-.7L3.71 6z",fill:"#1F2329",fillRule:"nonzero"}))}},"4PFL":function(e,t,n){"use strict";n.d(t,"a",function(){return C}),n.d(t,"b",function(){return k});var i=n("o0o1"),s=n.n(i),r=n("yXPU"),o=n.n(r),a=n("RIqP"),c=n.n(a),l=n("lwsE"),u=n.n(l),d=n("W8MJ"),h=n.n(d),f=n("cDf5"),p=n.n(f),g=n("H6oK"),m=n("Hj9z"),v=n("JPM6"),b=n("/spq"),y=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};function E(e){return e.map(function(e){var t=e.commentId,n=e.offsetTop;return{commentId:t||"",thirdPartyHeight:e.offsetHeight,relativeTopToThirdParty:n,quote:e.quote}})}function O(e,t){return"".concat(e,"_").concat(t)}var C=function(){function a(e){var r=this;u()(this,a),this.className="SheetBridge",this.bridge=null,this.hasSetup=!1,this.orphanSheetId=new Map,this.orphanOnCommentBatchUpdate=new Map,this.sheetWidthSettings=new Map,this.maxWidth=null,this.enterTranslate=!1,this.isInHistory=!1,this.membersBeforeSetup=null,this.fetchClientVars=function(t){var n=c()(t);r.orphanSheetId.forEach(function(e){-1===t.indexOf(e)&&n.push(e)}),r.bridge.fetchClientVars(n),r.orphanSheetId.clear()},this.notifyMembersUpdate=function(e){r.bridge?(r.membersBeforeSetup=null,r.bridge.notifyMembersUpdate(e)):r.membersBeforeSetup=e},this.handleBeforeInitBlocksOnly=function(e){if("SHEET_BLOCK"===e.blockType)return r.hasSetup?void 0:r.setupSheetBridgeOnInit(e.blockInfos)},this.handleBeforeUpdateBlock=function(e){var t,n,i;"SHEET_BLOCK"===e.blockType&&e.blockToken&&(n=(t=m.SheetBlock.processToken(e.blockToken)).token,i=t.sheetId,r.hasSetup||r.setupBridge(n,[i]))},this.getSheetBlocks=function(){return r.editor.getMatchedAttributePositionOnSelection(null,function(e,t){return"sheet-id"===e||!(e!==g.BLOCK_DATA_META_BLOCK_PROPS||!t)&&JSON.parse(t).blockType===g.BlockType.SHEET_BLOCK})},this.getOrders=function(){return r.getSheetBlocks().reduce(function(e,t){var n,i,r=t.attrKey,o=t.attrValue;return"sheet-id"===r&&e.push(o),r===g.BLOCK_DATA_META_BLOCK_PROPS&&o&&(!(n=JSON.parse(o)).token||(i=m.SheetBlock.processToken(n.token)).sheetId&&e.push(i.sheetId)),e},[])},this.getMountStatus=function(e){var t=r.editor.plugins.blockPlugin;if(!t||!t.getBlockManager)return!1;var n=r.editor.plugins.blockPlugin.getBlockManager().getBlockCreator(g.BlockType.SHEET_BLOCK);if(!n)return!1;var i=n.getBlockIdBySheetId(e);return i&&r.editor.plugins.blockPlugin.isBlockMounted(i)};var t=e.editor,n=e.isTemplate,i=e.isInHistory,o=e.sheetBlockVersionMap;this.editor=t,this.isTemplate=!!n,this.isInHistory=!!i,this.sheetBlockVersionMap=o}function e(){return t.apply(this,arguments)}var t;return h()(a,[{key:"setupBridge",value:function(e,t){var n,i,r;this.bridge||(n=this.editor,i=this.isTemplate,r=this.isInHistory,this.bridge=new v.a({token:e,editor:n,isTemplate:i,getOrders:this.getOrders,getMountStatus:this.getMountStatus,isInHistory:r})),this.isInHistory?this.loadHistoryVersion():(this.setCommentBatchLoadedAndUpdateToBridge(e),this.setCommentBatchUpdate(),this.fetchClientVars(t),this.checkEnterTranslateMode(),this.membersBeforeSetup&&this.notifyMembersUpdate(this.membersBeforeSetup)),this.iniWidth(),this.hasSetup=!0}},{key:"setCommentBatchUpdate",value:function(){var n=this;this.orphanOnCommentBatchUpdate.forEach(function(e,t){n.bridge.setOnCommentBatchUpdate(t,e)}),this.orphanOnCommentBatchUpdate.clear()}},{key:"setCommentBatchLoadedAndUpdateToBridge",value:function(i){var r=this;this.bridge.setOnSheetCommentLoaded(function(e){var t,n=r.editor.plugins.blockPlugin;n&&n.notifyCommentBatchLoaded&&(t=e.map(function(e){return r.convertSheetCommentList(i,e)}),n.notifyCommentBatchLoaded(t))}),this.bridge.setOnSheetCommentBatchUpdate(function(e){var t,n=r.editor.plugins.blockPlugin;n&&n.notifyCommentBatchUpdated&&(t=e.map(function(e){return r.convertSheetCommentList(i,e)}),n.notifyCommentBatchUpdated(t))})}},{key:"convertSheetCommentList",value:function(e,t){var n=t.sheetId,i=t.commentList;return{token:O(e,n),commentInfos:E(i)}}},{key:"iniWidth",value:function(){var r=this;this.bridge&&null!==this.maxWidth&&this.bridge.setMaxWidth(this.maxWidth),this.sheetWidthSettings.forEach(function(e,t){var n=e.fullWidth,i=e.leftMargin;r.bridge.setWidth(n,i,t)}),this.sheetWidthSettings.clear()}},{key:"checkEnterTranslateMode",value:function(){this.bridge&&this.enterTranslate&&this.bridge.enterTranslateMode()}},{key:"loadHistoryVersion",value:(t=o()(s.a.mark(function e(){var t,n,i,r,o,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],this.bridge&&this.sheetBlockVersionMap&&0<Object.values(this.sheetBlockVersionMap.datas).length)return n=this.sheetBlockVersionMap,i=n.datas,r=n.options,o=Object.values(i)[0],e.next=6,this.bridge.previewHistory(o.firstRev,o.lastRev,{isHighlight:!!r.isHighlight,users:r.users||{}});e.next=7;break;case 6:t=e.sent;case 7:(a=this.editor.plugins.historyChangeSelection)&&a.updateSheetRecord(t||[]);case 9:case"end":return e.stop()}},e,this)})),e)},{key:"locateHistory",value:function(e,t){this.bridge&&this.bridge.locateHistory(e,t)}},{key:"clearHistoryLabel",value:function(e){this.bridge&&this.bridge.clearHistoryLabel(e)}},{key:"handleBinding",value:function(e){var t=this.blockEventEmitter;t[e](g.PluginEventType.BEFORE_INIT_BLOCKS_ONLY,this.handleBeforeInitBlocksOnly),this.editor.pure||(t[e](g.PluginEventType.BEFORE_CREATE_BLOCK,this.handleBeforeUpdateBlock),t[e](g.PluginEventType.BEFORE_UPDATE_BLOCK_DATA,this.handleBeforeUpdateBlock))}},{key:"setupSheetBridgeOnInit",value:function(){var o,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=this.editor.getMatchedAttributePositionOnSelection(null,function(e,t){return"sheet-id"===e||"sheet-token"===e}),a=[];t.forEach(function(e){var t=e.attrKey,n=e.attrValue;"sheet-token"===t&&(o=n),"sheet-id"===t&&a.push(n)}),e.forEach(function(e){var t,n,i,r=e.blockToken;r&&(n=(t=m.SheetBlock.processToken(r)).sheetId,i=t.token,n&&(a.push(n),o=i))}),o&&0<a.length&&this.setupBridge(o,a)}},{key:"onAlinesInited",value:function(){if(!this.hasSetup)return this.setupSheetBridgeOnInit()}},{key:"setBlockEventEmitter",value:function(e){this.blockEventEmitter&&this.handleBinding("off"),this.blockEventEmitter=e,this.handleBinding("on")}},{key:"setOnCommentBatchUpdate",value:function(e,t){this.bridge?this.bridge.setOnCommentBatchUpdate(e,t):this.orphanOnCommentBatchUpdate.set(e,t)}},{key:"registerOrphanSheetId",value:function(e,t){this.bridge||this.orphanSheetId.set(e,t)}},{key:"getUpdateTime",value:function(){return this.bridge?this.bridge.updateTime:0}},{key:"setWidth",value:function(e,t,n){this.bridge?this.bridge.setWidth(e,t,n):this.sheetWidthSettings.set(n,{fullWidth:e,leftMargin:t})}},{key:"setMaxWidth",value:function(e){this.bridge?this.bridge.setMaxWidth(e):this.maxWidth=e}},{key:"enterHistoryMode",value:function(e,t,n,i){var r,o,a;return this.bridge||(r=this.editor,o=this.isTemplate,a=this.isInHistory,this.bridge=new v.a({token:e,editor:r,isTemplate:o,getOrders:this.getOrders,getMountStatus:this.getMountStatus,isInHistory:a})),this.bridge.enterHistoryMode(t,n,i)}},{key:"getRevision",value:function(){return this.bridge?this.bridge.getRevision():Promise.resolve(-1)}},{key:"enterTranslateMode",value:function(){this.bridge?this.bridge.enterTranslateMode():this.enterTranslate=!0}},{key:"exitTranslateMode",value:function(){this.enterTranslate=!1,this.bridge&&this.bridge.exitTranslateMode()}},{key:"pasteSheet",value:function(e,t,n){return this.bridge?this.bridge.pasteSheet(e,t,n):Object(v.g)(e,t,n)}},{key:"getHtmlWhilePastingSheet",value:function(e){return this.bridge?this.bridge.getHtmlWhilePastingSheet(e):Object(v.d)(e)}},{key:"addSheet",value:function(e,t){return this.bridge?this.bridge.addSheet(e,t):Object(v.b)(e,t)}},{key:"getBridge",value:function(){return this.bridge}},{key:"onSheetBlockMount",value:function(e){this.bridge&&this.bridge.sheetBlockDidMount(e)}},{key:"onSheetBlockUnmount",value:function(e){this.bridge&&this.bridge.sheetBlockDidUnmount(e)}},{key:"destory",value:function(){this.handleBinding("off"),this.bridge&&this.bridge.destroy(),Object(v.c)()}}]),a}();function k(i){return{loadDocSheetBridge:function(){return Object(v.f)()},isDocSheetBridgeLoaded:function(){return Object(v.e)()},getSheetBridge:function(){return i.getBridge()},setOnCommentBatchUpdate:function(e,t){return i.setOnCommentBatchUpdate(e,t)},registerOrphanSheetId:function(e,t){return i.registerOrphanSheetId(e,t)},getHtmlWhilePastingSheet:function(e){return i.getHtmlWhilePastingSheet(e)},pasteSheet:function(e,t,n){return i.pasteSheet(e,t,n)},addSheet:function(e,t){return i.addSheet(e,t)},setWidth:function(e,t,n){return i.setWidth(e,t,n)},setMaxWidth:function(e){return i.setMaxWidth(e)},onSheetBlockMount:function(e){return i.onSheetBlockMount(e)},onSheetBlockUnmount:function(e){return i.onSheetBlockUnmount(e)}}}C=y([Object(b.a)(["destory"])],C)},"4RhH":function(e,t,n){"use strict";var i=n("b6qs"),r=n("1PvN"),o=n("zLXu"),a=/\smention-chatId_(\S*)\s/,s=[],c={reset:function(){i.a.reset()},mount:function(e){var t=e.className.match(a);t&&t[1]&&s.push(t[1])},finshApply:function(){Object(o.a)(null,s,0,r.b,"J-doc-history"),s=[]}};t.a=c},"4X5c":function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var i,r=n("lSNA"),o=n.n(r),a=n("Hj9z"),s="/secure/CreateIssueDetails!Init.jspa",c=(i={},o()(i,a.JiraIssueCreator.JIRA_ID.PROJECT,1),o()(i,a.JiraIssueCreator.JIRA_ID.TYPE,2),o()(i,a.JiraIssueCreator.JIRA_ID.SUMMARY,3),o()(i,a.JiraIssueCreator.JIRA_ID.DESC,4),i)},"4fCv":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("q1tI"),r=n.n(i),o=r.a.createElement("svg",{className:"circular",viewBox:"25 25 50 50"},r.a.createElement("circle",{className:"path",cx:"50",cy:"50",r:"20",fill:"none",strokeWidth:"4",strokeMiterlimit:"10"}))},"4jTF":function(e,t,n){"use strict";var i=n("uyKL"),r=n("P438");n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b}),t.c=i.a},"4nzr":function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s="VIEWPORT_READY";n.d(t,"a",function(){return c});var c=function(){function t(e){r()(this,t),this.emit=null,this.emit=e}return a()(t,[{key:"destroy",value:function(){this.emit=null}},{key:"onViewportReady",value:function(e){this.emit&&this.emit.on(s,e)}},{key:"offViewportReady",value:function(e){this.emit&&this.emit.off(s,e)}},{key:"viewportReady",value:function(){this.emit&&this.emit.trigger(s)}}]),t}()},"4xyU":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n("lwsE"),r=n.n(i),o=n("puQj"),s=n.n(o),a=function e(t){var a=this;r()(this,e),this.className="Save",this.aceKeyEvent=function(e,t){if(s.a.mobile)return!1;var n=t.evt,i=t.isTypeForCmdKey,r=t.editorInfo,o=n.which;return!(!i||"s"!==String.fromCharCode(o).toLowerCase()||!n.metaKey&&!n.ctrlKey||!r.getEditStatus())&&(n.preventDefault(),window.localStorage.getItem("bear-save-tips")||(window.localStorage.setItem("bear-save-tips",1),a.editor.call("tips",{type:"saveTips"})),!0)},t&&(this.editor=t)};new a},"56Fm":function(e,t,n){"use strict";n.d(t,"f",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return h}),n.d(t,"e",function(){return f});var i=n("gSGL"),o=n("vFlG"),r=n("kESg"),a=n("Np3H"),s=n("iP/4");function c(){return!s.a.isInVC&&Object(a.a)()}function l(e){return Object(o.a)(e,"aceTable")}function u(e){return!!e[r.k.ZoneType]}function d(e){return Object(i.a)(e)?e.replace(/\n/g,""):""}function h(e){return e?"author-"+e.replace(/[^a-y0-9]/g,function(e){return"."===e?"-":"z"+e.charCodeAt(0)+"z"}):""}function f(e,t,n){var i=n.getContentState().getZoneState(e).getLine(t);if(!i)return!1;var r=i.getAttributes(0,i.length()-1).toMap();return Object(o.a)(r,"list")&&"code1"===r.list}},"58X4":function(e,t,n){"use strict";var u=n("FJEn"),i=n("o0o1"),r=n.n(i),o=n("yXPU"),a=n.n(o),s=n("lwsE"),c=n.n(s),l=n("W8MJ"),d=n.n(l),h=n("1lbP"),f=n("oJoF"),p=(n("bbVt"),function(){function i(e,t){var n=this;c()(this,i),this.editor=e,this.options=t,this.editable=!1,this.draggable=null,this.rxOp=new h.a,this.editor.on(f.c,function(){return n.loadDraggableIfNeeded()})}function e(){return t.apply(this,arguments)}var t;return d()(i,[{key:"loadDraggableIfNeeded",value:(t=a()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.draggable)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,this.rxOp.toPromise(Promise.all([n.e("doc_index_css"),n.e("chunk_adit"),n.e("commons--doc_index_delay--voteEmoji--votePicker"),n.e(16),n.e("commons--doc_index_delay--jira"),n.e("doc_index_delay")]).then(n.bind(null,"4hY2")));case 4:t=e.sent,this.draggable=new t.Draggable(this.editor,this.options),this.editable?this.draggable.enable():this.draggable.disable();case 7:case"end":return e.stop()}},e,this)})),e)},{key:"changesetApply",value:function(e,t){this.draggable&&this.draggable.changesetApply(e,t)}},{key:"pluginReadOnly",value:function(){this.editable=!1,this.draggable&&this.draggable.disable()}},{key:"pluginReadWrite",value:function(){this.editable=!0,this.draggable&&this.draggable.enable()}},{key:"destroy",value:function(e){this.draggable&&(this.draggable.destroy(e),this.draggable=null),this.rxOp.destroy()}}]),i}()),g=n("2ACu"),m=n("xYHj"),v=n("H6oK");function b(e,t){if(Object(m.c)(e,t))return{type:"table",id:e.attributeManager.getAttributeOnLine(t,"aceTable")};if(Object(m.b)(e,t,["sheet-id"]))return{type:"sheet",id:e.attributeManager.getAttributeOnLine(t,"sheet-id")};if(Object(m.l)(e,t))return{type:"image"};if(Object(m.f)(e,t))return{type:"checkbox"};if(Object(m.j)(e,t))return{type:"heading"};if(Object(m.d)(e,t)){var n=e.attributeManager.getAttributeOnLine(t,v.BLOCK_DATA_META_BLOCK_PROPS);if(n){var i=JSON.parse(n),r=i.blockType,o=i.blockId;if(r&&o){var a=r.slice(0,-6).toLowerCase();return"link"===a?{type:i.props.data.linkType,id:o}:{type:a,id:o}}}}return{type:"text"}}function y(e,t){if(t!==u.DEFAULT_REP_ZONE){var n=e.zoneToTableMap[t];if(n){var i=e.tableToLineMap[n];if(i){var r=i.lineNode&&e.domToRep(i.lineNode);if(r)return e.getAttributeOnLine(r.selStart[2],r.selStart[0],"aceTable")}}}}function E(l){var t=null;return l.on("docDraggable:updateHoverLine",function(e){t=e}),new p(l,{draggerCls:["editor-line-trigger","editbar-line__trigger","ace-table-table-select"],getLineByDragger:function(){return t},isDraggableToTop:function(e,t){return e!==t.getDocBody()},onDragFinish:function(e){var t,n,i,r,o,a,s,c;e.success&&e.oldZoneId&&e.oldLine&&e.newZoneId&&e.newLines&&e.newLines.length&&(t=e.oldZoneId,n=e.newZoneId,i=e.newLines,(o=(r=l.getRep(n)).lines.atIndex(i[0]))&&(s=(a=b(r,i[0])).id,c=a.type,Object(g.default)("toggle_attribute",{action:"drag",source:o.text?"block_menu":"a_panel",zone_id:y(l,t)||"",zone:t===u.DEFAULT_REP_ZONE?"default":"table",object_id:s,object_type:c,target_id:y(l,n)||"",target_type:n===u.DEFAULT_REP_ZONE?"default":"table"})))}})}n.d(t,"b",function(){return b}),n.d(t,"c",function(){return y}),n.d(t,"a",function(){return E})},"5J3U":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("QM+C"),c=function(){function t(e){var n=this;r()(this,t),this.isDangerousDelete=function(e){var t=n.editor.getRep();if(t.selStart&&t.selEnd)return t.alltext.slice(t.lines.offsetOfPoint(t.selStart[0],t.selStart[1]),t.lines.offsetOfPoint(t.selEnd[0],t.selEnd[1])).replace(/[\r\n]/g,"").trim().length>=s.THRESHOLD_SHOW_DEL_TIPS},e&&(this.editor=e)}return a()(t,[{key:"aceDoDeleteKey",value:function(e,t){var n=t.evt;this.isDangerousDelete(n)&&this.editor.call("editor:delete_huge_text")}}]),t}()},"5PMV":function(e,rt,ot){"use strict";(function(g){var m,e,t=ot("J4zp"),d=ot.n(t),n=ot("RIqP"),o=ot.n(n),i=ot("o0o1"),h=ot.n(i),r=ot("yXPU"),a=ot.n(r),s=ot("lwsE"),c=ot.n(s),l=ot("W8MJ"),u=ot.n(l),f=ot("a1gu"),v=ot.n(f),p=ot("Nsbk"),b=ot.n(p),y=ot("PJYZ"),E=ot.n(y),O=ot("7W2i"),C=ot.n(O),k=ot("UXvI"),I=ot("3Hq1"),S=ot("OZf9"),T=ot("Fsnq"),_=ot("7EGn"),w=ot("vFlG"),j=ot("lCmp"),M=ot("owWc"),L=ot("fHNB"),R=(ot("QQnO"),ot("q1tI")),N=ot.n(R),D=ot("17x9"),x=ot.n(D),P=ot("HmyT"),B=ot("TSYQ"),U=ot.n(B),z=ot("D7h9"),H=ot("djbN"),F=ot("R/2b"),V=ot("vE74"),W=ot("TNRG"),K=ot("OJOY"),Z=ot("GIL9"),q=ot("lQZd"),Y=ot("n/R6"),J=ot("6jTl"),Q=ot("KfM7"),X=ot("Ahmm"),$=ot("2ACu"),ee=ot("DVUE"),te=ot("FJEn"),ne=(ot("Z7ZV"),ot("H6oK")),ie=ot("iP/4"),re=ot("OX8E"),oe=ot("fQzm"),ae=ot("GdWO"),se=ot("rQ+X"),ce=ot("ZMP9"),le=ot("1dfU"),ue=ot("Cn65"),de=ot("GVmr"),he=ot("zhgJ"),fe=ot("QM+C"),pe=ot("521f"),ge=ot("ywOK"),me=ot("LghI"),ve=ot("AYG9"),be=ot("gfe6"),ye=ot("D28M"),Ee=ot("sLU5"),Oe=ot("zfY2"),Ce=ot("C+Is"),ke=ot("Trbk"),Ie=ot("4nzr"),Se=ot("mHIB"),Te=ot("Ehz1"),_e=ot("/C+9"),we=ot("0cva"),je=ot("+fJc"),Me=ot("xXG4"),Ae=ot("ftdE"),Le=ot("pfvL"),Re=ot("SebV"),Ne=ot("XsFf"),De=ot("rLED"),xe=ot("c/bE"),Pe=ot("oJoF"),Be=ot("2RY6"),Ue=(ot("HWuX"),ot("j1lG")),ze=ot("OMt3"),He=ot("OyiX"),Fe=ot("NnqK"),Ve=ot("MCJU"),We=ot("laI6"),Ke=ot("UY5Z"),Ge=ot("e2rD"),Ze=ot("U6jp"),qe={disconnected:g("common.disconnected_tips"),reconnected:g("common.reconnected_tips"),local_error:g("common.not_support_local_storage"),fatal:g("common.accidents_occurred_and_save"),saveTips:g("etherpad.save_tips"),tooManyRetriesOnOffline:g("error.network_down_too_many_retries")},Ye="bytedance_bear_local_doc",Je="bear_error",Qe="bear_watch_dog",Xe="tooManyRetriesOnOffline",$e=[["ACCEPT_COMMIT","NEW_CHANGES"],["sheet"]],et=function(){};function tt(){Y.a.remove(Xe)}(e=m=m||{})[e.CORE=0]="CORE",e[e.PLUGIN=1]="PLUGIN";var nt={SAVE_STATUS:"saveStatus",CHANNEL_STATE_TIP:"channelStateTip",TIPS:"tips",TOO_MANY_RETRIES_ON_OFFLINE:Xe},it=function(e){function t(e){var p;return c()(this,t),(p=v()(this,b()(t).call(this,e))).viewportObserverController=new Ie.a(re.a),p.oneMinuteTimeout=null,p.watchdog=null,p.watchdogEventEmitter=null,p.requestAnimationFrameIds=[],p.canLeavePage=function(){return!(p.isNeedSaveLocal()&&!Se.a.isDocumentDeleted())},p.handleBeforeUnload=function(e){if(p.reportIfHasDepLoadingBlockBeforeUnload(),p.isNeedSaveLocal()&&!Se.a.isDocumentDeleted()){p.saveUnSyncLocalDomHtml();var t=p.getLeaveWarningMessage();return e.returnValue=!0,t}},p.getVersionByType=function(e){var t=function(){return p.client?p.client.getRev():0},n={ACCEPT_COMMIT:t,ACCEPT_CHANGES:t,sheet:function(){var e=E()(p).editor.plugins.sheetBridge;return e&&e.bridge&&e.bridge.bridge?e.bridge.bridge.sheetManager.baseRev:0}};return n[e]?n[e]():0},p.initSuiteVersion=function(){return p.sendSuiteVersionToFollowSDK($e.map(function(e){return p.getVersionByType(e[0])}))},p.suiteVersionChangeEventBinding=function(e,t){p.editor&&(p.editor[e]("acceptCommit",t),p.editor[e]("newChanges",t)),re.a[e]("BLOCK_COLLAB_VERSION_CHANGE",t)},p.handleSuiteVersionChange=function(e){var n=e.type,i=e.rev,r=p.suiteVersion.slice();$e.forEach(function(e,t){return e.includes(n)&&(r[t]="number"==typeof i?i:0)}),p.sendSuiteVersionToFollowSDK(r)},p.isProfileEnabled=function(){var e=Object(he.c)().editPerformanceProfile;return!0===(void 0===e?{}:e).isEnabled},p.isSameToken=function(){var e,t,n=p.props,i=n.clientVars,r=n.Sync,o=Object(q.g)(),a=i.token;a!==o&&(e=r.memberId,t="docsMain_note_token_unmatch",Object($.default)(t,{urlToken:Object(le.a)(o),clientVarsToken:Object(le.a)(a),memberId:e}),Object(Re.a)(t))},p.shortcut=function(e){Object(Z.a)()&&e.once("paint",function(){window.dispatchEvent(Object(V.b)("docDidRender",{detail:e}))})},p.removeDocSSR=function(){var e=document.querySelector("html");ie.a.isWindows&&Object(ye.f)(e,"windows")&&Object(ye.p)(e,"windows"),Object(Fe.b)({afterRemove:function(){p.editor&&p.editor.call(Ee.a.PC.DOCS.REMOVE_SSR)}})},p.migrateLocalStoreData=function(){var o,e=K.a.getItem(Ye),t=K.a.getItem(Je),n=K.a.getItem(Qe),i=window.User.id,r=function(e){return Object(w.a)(e,i)&&0<Object(T.a)(e[i])},a=Object(j.a)(e,r),s=Object(j.a)(t,r),c=Object(j.a)(n,r),l=[];a&&l.push({tokens:e,key:Ye}),s&&l.push({tokens:t,key:Je}),c&&l.push({tokens:n,key:Qe}),0!==l.length&&(o=[],l.forEach(function(r){Object(S.a)(r.tokens,function(e,t){var n="".concat(r.key,".").concat(t,".").concat(window.User.id),i=K.a.getItem(n);i&&(o.push(W.b.setItem("".concat(r.key,".").concat(t),i)),K.a.removeItem(n))})}),0<o.length&&Promise.all(o).then(W.b.getVersion).then(function(e){Object($.default)("client_local_store_upgrade",{upgrade_ver:e,file_type:"doc",is_first_upgrade:"true",upgrade_status:"success",prev_ver:""})}).catch(function(e){Object(Re.a)(e)}))},p.getInnerDocHtml=function(){if(p.innerdoc){for(var e=p.editor,t="</div>",n=p.innerdoc.cloneNode(!1).outerHTML.slice(0,-t.length),i="".concat(n).concat(e.getHtml()).concat(t),r=(new DOMParser).parseFromString(i,"text/html").body.firstElementChild,o=Array.from(r.querySelectorAll("img")),a=0;a<o.length;a++){var s=o[a],c=s.getAttribute("src"),l=s.getAttribute("data-src");c&&/^(blob|data):/.test(c)&&l&&s.setAttribute("src",l)}return r.outerHTML}},p.reportStorageEstimate=a()(h.a.mark(function e(){var t,n,i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.storage&&navigator.storage.estimate){e.next=2;break}return e.abrupt("return");case 2:return t=function(e){return null==e?-1:e},e.prev=3,e.next=6,navigator.storage.estimate();case 6:n=e.sent,i=n.usageDetails,Object($.default)("dev_storage_estimate",{error:0,quota:t(n.quota),usage:t(n.usage),usagePercent:null!=n.usage&&n.quota?n.usage/n.quota:-1,usageCaches:t(i&&i.caches),usageIndexedDB:t(i&&i.indexedDB),usageServiceWorker:t(i&&i.serviceWorkerRegistrations)}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),Object(Re.a)(e.t0),Object($.default)("dev_storage_estimate",{error:1});case 15:case"end":return e.stop()}},e,null,[[3,11]])})),p.handleInnerError=function(e,t){var n,i,r=e||{},o=r.err,a=void 0===o?null:o,s=r.message,c=void 0===s?"":s,l=r.from,u=void 0===l?"":l,d=r.code,h=void 0===d?-1e3:d,f=e.module;try{p.editor.setEditable(!1),z.default.dispatch(Object(H.b)(!0))}catch(e){console.log("pre oops error")}"fatal"!==window.padStatus&&(n=c||qe.fatal,i="network"===u?n:qe.fatal,console.error(c||qe.fatal),J.a.show({title:g("common.oops"),body:ie.a.isFeishuRooms?g("vc.oops.content"):i,confirmText:ie.a.isFeishuRooms?null:g("common.refresh"),closable:!1,cancelText:"",maskClosable:!1,footerExtra:ie.a.isFeishuRooms?null:N.a.createElement(Q.a,{editor:p.editor}),extraButtons:ie.a.isFeishuRooms?null:[N.a.createElement(ce.ContactUsButton,{key:"contact-us"})],onConfirm:function(){Object(L.a)(!0)}})),window.padStatus="fatal",console.log(JSON.stringify(window.scm)),p.props&&console.log(p.props.Sync.getMemberId()),ie.a.firefox||window.oopsDebugMode||(Object(Re.a)("".concat(t===m.CORE?"docs":"plugin"," oops: ").concat(c,", oops code: ").concat(h)),Object(Re.a)(a),Object($.default)("dev_oops",{category:t===m.CORE?"core":"plugin",from:u,status_code:h,status_name:c,error_message:a instanceof Error?a.message:Object(Le.a)(a),editor_id:p.editor.lineIdPre,plugin_module:f||"",clientDebugInfo:p.editor.plugins.client&&p.editor.plugins.client.getDebugInfo(),minaConfig:Object(De.L)()}),ge.c.renderFail(ge.a.DEV_OOPS),p.editor.plugins.client&&p.editor.plugins.client.destory(),"storage"===u&&p.reportStorageEstimate(),X.a.trackEvent({category:"pad_error_from_".concat(u),action:"pad_error"}),oe.b.count("ee.suite.oops",{source:"network"===u?"backend":"frontend"}),oe.b.count("ee.docs.doc.oops",{code:h.toString(),status_name:c,err_type:t===m.CORE?"core":"plugin",module:f})),-1===[1010,1012,1002,4].indexOf(h)&&oe.b.slaFail()},p.bindEvents=function(){var t,i,e,n,r;p.editor&&(p.editor.on("alert",function(e){var t=e.title,n=void 0===t?g("common.prompt"):t,i=e.message,r=e.confirmText,o=void 0===r?g("common.determine"):r,a=e.onConfirm,s=void 0===a?function(){}:a;J.a.show({title:n,body:i,confirmText:o,closable:!0,cancelText:"",maskClosable:!0,onConfirm:s})}),p.etherpadPluginErrorEvent=function(e){p.handleInnerError(e,m.PLUGIN)},p.etherpadErrorEvent=function(e){e.type&&"changeset"===e.type&&e.editor!==p.editor||p.editor.call("error",e)},re.a.once("EtherpadPlugin:Error",p.etherpadPluginErrorEvent),re.a.on("Etherpad:Error",p.etherpadErrorEvent),re.a.on(Be.d,p.onEnterFullScreen),re.a.on(Be.e,p.onExitFullScreen),p.editor.once("error",function(e){p.handleInnerError(e,m.CORE)}),t=0,i=function(e){"ENGAGEMENT_CURSOR"!==e.type&&("ACCEPT_COMMIT"===e.type&&(t=0),re.a.trigger(Ee.a.PC.DOCS.SYNC_NOTE_META,[e]))},e=Object(De.M)("watchdog_throttle_save_duration",300),n=Object(De.M)("watchdog_unsave_cs_limit",30),r=Object(k.default)(a()(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t++,Object(be.c)()&&n<=t&&(t=0,p.watchdog&&p.watchdog.notifyShouldSaveUIData("NoAcceptCommit"));case 2:case"end":return e.stop()}},e)})),e),p.editor.on("composeUserChangeset",function(){r()}),p.editor.on("saveUserChanges",function(e){var t=e.type,n=e.status;i(e),"local"===t&&"error"===n&&Y.a.show({key:nt.SAVE_STATUS,type:"error",content:qe.local_error,duration:0,closable:!0})}),p.editor.on("channelStateChange",function(e){var t,n,i=e.newState,r=e.moreInfo,o="reconnect"===r;"CONNECTED"===i&&o?(t=qe.reconnected,n="success"):"DISCONNECTED"===i&&"reconnect_timeout"!==r&&(t=qe.disconnected,n="error"),t&&Y.a.show({key:nt.CHANNEL_STATE_TIP,type:n,content:t,duration:o?5e3:0,closable:!o})}),p.editor.on("tips",function(e){var t=e.type,n=qe[t];n&&Y.a.show({key:nt.TIPS,type:"success",content:n,duration:5e3,closable:!0})}),p.editor.on("acceptCommit",i),p.editor.on("sendMessage",i),p.editor.on("newChanges",i),p.editor.on("changeNoteTitle",function(e){var t=e.token,n=e.title;p.props.updateDocTitle({token:t,title:n,type:Object(q.l)()}),re.a.emit("".concat(ke.c,":SUITE_TITLE_CHANGE"),{title:n}),Object(Oe.sendOpendocEvent)(Ce.d.SUITE_TITLE_CHANGE,{title:n})}),p.editor.on("copy",p.collectSecurityAuditCopy),p.editor.on(Xe,function(){tt(),Y.a.show({key:nt.TOO_MANY_RETRIES_ON_OFFLINE,type:"error",content:qe.tooManyRetriesOnOffline,duration:0,closable:!0})}),p.editor.on(te.config.WILL_HANDLE_USER_CHANGESET,function(e){we.d.addLogToUpload(te.config.WILL_HANDLE_USER_CHANGESET,e)}),p.editor.on(te.config.DID_HANDLE_USER_CHANGESET,function(){we.d.addLogToUpload(te.config.DID_HANDLE_USER_CHANGESET)}),p.editor.on(Pe.a,function(){p.viewportObserverController.viewportReady()}),Se.a.register(fe.ENTITY_TYPE.DOC,p.props.noteToken),xe.a.addCanLeavePageHandler(p.canLeavePage),window.addEventListener("online",tt),window.addEventListener("beforeunload",p.handleBeforeUnload))},p.focus=function(){p.innerdoc.focus()},p.onEnterFullScreen=function(){p.toggleFullScreenMode(!0)},p.onExitFullScreen=function(){p.toggleFullScreenMode(!1)},p.toggleFullScreenMode=function(e){e?p.innerdoc&&p.innerdoc.classList.remove("doc-new-layout"):p.innerdoc&&p.innerdoc.classList.add("doc-new-layout")},p.onMouseDown=function(e){var t=e.target;1===e.button&&"A"===t.nodeName.toUpperCase()&&-1!==t.href.indexOf("http")&&window.open(t.href)},p.inEmbed=function(e,t){if(!t)return!1;for(var n=0,i=[".sheet:not(.sheet-pasting)",".".concat(ne.BLOCK_V_TEXT,":not(.sheet-pasting)")];n<i.length;n++){var r=i[n];if(0<Object(P.$)(t).parents(r).length)return!0}return!1},p.collectSecurityAuditCopy=function(){Promise.all([ot.e("commons--PCDocSheetBridge--bear-bitable-external--bear-external--bear-sheet-external--btn_groups--d--dba25785"),ot.e("vendors--doc_collector_security_audit"),ot.e("doc_collector_security_audit")]).then(ot.bind(null,"x6vj")).then(function(e){(0,e.collectSecurityAudit)(e.ISecurityAudit.OperationType.OperationCopyContent)})},p.initSuiteContainerSubscription=function(){},p.profile=new ue.a(function(e,t){Object($.default)(e,Object.assign({},t,{__disable_storage__:1}))}),p}return C()(t,e),u()(t,[{key:"UNSAFE_componentWillMount",value:function(){pe.b.renderDocEditorStart(Date.now())}},{key:"componentDidMount",value:function(){var e,t,n,i,r,o,a,s=this;this.editor&&(t=(e=this.props).clientVars,n=e.Sync,i=e.setEditor,r=e.createSource,o=e.noteToken,a=t.collab_client_vars.rev,this.startTime=+new Date,this.migrateLocalStoreData(),this.innerdoc&&(this.innerdoc.zoneId={value:"0"}),i(this.editor),this.client.setRev(a),this.bindEvents(),n.setEditor(this.editor),this.editor.changesetTracker.setUserChangeNotificationCallback(function(){we.c.addLogToUpload("userChangeNotificationCallback"),s.client.handleUserChanges(!1,!1,!0)}),this.editor.setEditable(this.isEditable),this.logEditable("didMount",!1),Object(ze.a)(r,o,this.startTime),this.isSameToken(),window.editor=this.editor,Object(me.c)(),oe.b.slaSuccess(),this.profile&&this.profile.setGetContext(Object(de.c)(this.editor)),ie.a.isInVC&&(this.initSuiteVersion(),this.suiteVersionChangeEventBinding("on",this.handleSuiteVersionChange)),z.default.dispatch(Object(Me.g)({type:Ae.b.ORIGINAL})),this.fetchAllUsers(),this.bindDocPositionEvents(this.editor))}},{key:"UNSAFE_componentWillUpdate",value:function(){"doc"===Object(q.k)()&&this.migrateLocalStoreData()}},{key:"componentDidUpdate",value:function(e){var t=e.editable,n=e.createSource,i=this.props,r=i.createSource,o=i.noteToken;t!==this.isEditable&&this.logEditable("didUpdate",t),n!==r&&Object(ze.a)(r,o,this.startTime)}},{key:"bindDocPositionEvents",value:function(e){e&&(e.on("renderAboveBegin",this.showToastLoading),e.on("renderAboveFinish",this.hideToastLoading))}},{key:"unbindDocPositionEvents",value:function(e){e&&(e.off("renderAboveBegin",this.showToastLoading),e.off("renderAboveFinish",this.hideToastLoading))}},{key:"showToastLoading",value:function(){Y.a.show({key:"showToastLoading",type:"info",content:g("document.still_loading"),duration:5e3,closable:!1})}},{key:"hideToastLoading",value:function(){Y.a.remove("showToastLoading")}},{key:"logEditable",value:function(e,t){var n,i=pe.b.getRenderDocAllStartTime(),r=pe.b.getFrom(),o=Date.now()-i,a=this.props.editable,s=this.isEditable&&!t;this.editor&&(n=Object(de.a)(this.editor),Object($.default)("doc_update_editable",Object.assign({done:!0,editable:a,source:e,isFirstTime:s,interval:o,from:r},n)))}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.noteToken,n=e.resetClientVars,i=e.destroyEditor;Object(ze.b)(),this.watchdog&&(this.saveUnSyncLocalDomHtml(),this.watchdog.cleanLocalHistoryRecordsIfNeeded(t),this.watchdog.destroy(),this.watchdog=null),this.watchdogEventEmitter&&(this.watchdogEventEmitter.destroy(),this.watchdogEventEmitter=null),this.profile&&this.profile.destroy(),this.client=null,this.innerdoc=null,this.editor&&this.editor.eventEmitter.off("aceCopy",this.collectSecurityAuditCopy);var r=this.editor&&Object(de.a)(this.editor);ge.c.setProfileContext(et),pe.b.setProfileContext(et);var o,a=!0,s=!1,c=void 0;try{for(var l,u=this.requestAnimationFrameIds[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var d=l.value;d&&window.cancelAnimationFrame(d)}}catch(e){s=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw c}}n(),this.editor&&i(this.editor.editorUniqueId),xe.a.removeCanLeavePageHandler(this.canLeavePage),window.removeEventListener("online",tt),window.removeEventListener("beforeunload",this.handleBeforeUnload),re.a.off("Etherpad:Error",this.etherpadErrorEvent),re.a.off("EtherpadPlugin:Error",this.etherpadPluginErrorEvent),re.a.off(Be.d,this.onEnterFullScreen),re.a.off(Be.e,this.onExitFullScreen),ie.a.isInVC&&this.suiteVersionChangeEventBinding("off",this.handleSuiteVersionChange),Se.a.deregister(),Y.a.remove(nt.CHANNEL_STATE_TIP),window.padStatus=null,window.editor=null,r&&(o=Object(de.b)(r,this.statics),null!==this.oneMinuteTimeout&&(Object(ve.c)(ve.a.AFTER_ONE_MINUTE,o),window.clearTimeout(this.oneMinuteTimeout))),delete window.docSSR,we.c.clearLogsToUpload(),we.d.clearLogsToUpload(),this.userManager&&this.userManager.pause(),this.editor&&this.unbindDocPositionEvents(this.editor),this.editor=null}},{key:"fetchAllUsers",value:function(){var e=this.props.noteToken;this.userManager=Object(Ne.a)(),Object(De.G)()&&this.userManager.fetchEditorUsers(this.editor,e)}},{key:"getLeaveWarningMessage",value:function(){return g("editor.leave_page_warning_message")}},{key:"isNeedSaveLocal",value:function(){return this.editor&&this.editor.changesetTracker&&this.editor.changesetTracker.hasUncommittedChanges&&this.editor.changesetTracker.hasUncommittedChanges()}},{key:"saveUnSyncLocalDomHtml",value:function(){this.isNeedSaveLocal()&&this.watchdog&&this.watchdog.notifyShouldSaveUIData("BeforeUnload")}},{key:"reportIfHasDepLoadingBlockBeforeUnload",value:function(){try{if(!this.editor)return;var e=this.editor.plugins.blockPlugin;e&&e.hasDepLoadingBlock&&e.hasDepLoadingBlock()&&Object($.default)("dev_dep_loading_block",{action:"before_unload"})}catch(e){Object(Re.a)(e)}}},{key:"sendSuiteVersionToFollowSDK",value:function(e){this.suiteVersion=e,re.a.emit("".concat(ke.c,":").concat(ke.p),e.join("."))}},{key:"getImageFromAttr",value:function(){if(!this.editor)return null;var e=null,t=function(e){return/(gallery|image-uploaded)/.test(e)};return this.editor.getMatchedAttributePositionOnSelection(e,t)}},{key:"reuseSSRPicNode",value:function(){var o,e,t,s=this;document.querySelector("#ssrBox")&&(Object(De.Q)()?(o=new Map,Object(P.$)("#ssrBox #innerdocbody > div[id^=magicdomid]").each(function(e,t){var n,i,r=Object(P.$)(t).find("img[data-uuid]");r&&r.length&&((n=s.editor.getContentState().getActiveZone().getLine(e))&&(i=n._entry,s.editor.unstable_hydrate(n,t.cloneNode()),r.each(function(e,t){var n=Object(P.$)(t).attr("data-uuid");o.set(n,Object(P.$)(t).attr("src")),s.detectSSRImgLoadStatus(t,i)})))}),(t=(e=this.editor.getPlugin(Ue.K))&&e.getImageStateInstance())&&t.setImageState({reuseSSRImage:o})):requestAnimationFrame(function(){var e=s.getImageFromAttr();if(e){var t=!0,n=!1,i=void 0;try{for(var a,r=function(){var e,t,n=a.value.docPosition,i=n.selStart,r=n.selZone,o=s.editor&&s.editor.getRep(r).lines.atIndex(i[0]);o&&o.isRendered&&(e=o.lineNode,(t=Object(P.$)(e).find(".ssr-reuse"))&&t.length&&t.each(function(e,t){var n=t.id,i=Object(P.$)("#ssrBox #".concat(n));i&&i.length&&(Object(P.$)(t).replaceWith(i),s.detectSSRImgLoadStatus(i.get(0),o))}))},o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0)r()}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}}))}},{key:"detectSSRImgLoadStatus",value:function(e,t){var n=this,i=e.src,r=e.complete,o=(new Date).getTime(),a=function(){e.removeEventListener("load",s),e.removeEventListener("error",c)},s=function(){n.notifySsrImageHeightChange(t),n.collectSSRImageLoadEvent(i,!0,(new Date).getTime()-o),a()},c=function(){n.collectSSRImageLoadEvent(i,!1,(new Date).getTime()-o),a()};r?(this.notifySsrImageHeightChange(t),!(!e.naturalHeight||!e.naturalWidth)?this.collectSSRImageLoadEvent(i,!0,0):this.collectSSRImageLoadEvent(i,!1,0)):(e.addEventListener("load",s),e.addEventListener("error",c))}},{key:"notifySsrImageHeightChange",value:function(e){var t=this;this.editor&&this.editor.once("paint",function(){t.editor&&Object(Ke.b)(t.editor,e)})}},{key:"collectSSRImageLoadEvent",value:function(e,t,n){var i=Object(Ve.a)(e),r=Object(De.Q)()?"doc_ssr_new_image_load_stat":"doc_ssr_image_load_stat";Object($.default)(r,{status:t?"success":"failed",request_origin_time_cost:n.toFixed(4),origin_src:Object(le.a)(e),driveToken:i===We.a.Drive?Object(le.a)(Object(Ve.b)(e)||""):"",image_category:i})}},{key:"permissionChange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return(e&&Object(M.a)(e,function(e,t){return e+t},0))!==(t&&Object(M.a)(t,function(e,t){return e+t},0))}},{key:"collectFirstScreenShowTime",value:function(e){var t,n=this,i=Object(de.c)(e);pe.b.setProfileContext(i),pe.b.setExtraData({editable:this.props.editable?"true":"false"}),ge.c.setProfileContext(i),ge.c.setExtraData({editable:this.props.editable?"true":"false"}),ge.c.updateStageByNextRender(pe.a.RENDER_DOC_EDITOR_SUCCESS,fe.FILE_TYPE.DOC),Object(ge.d)()?(t=requestAnimationFrame(function(){n.docCollectorCollectEnd(Date.now())}),this.requestAnimationFrameIds.push(t)):this.docCollectorCollectEnd(Date.now())}},{key:"docCollectorCollectEnd",value:function(e){pe.b.renderDocEditorEnd(e),pe.b.renderDocEtherpadEnd(e),pe.b.renderDocEnd(e),Ge.a.collectShowFirstScreen()}},{key:"addSceneOpenAfterOneMinute",value:function(t){var n=this;Object(ve.b)(ve.a.AFTER_ONE_MINUTE,this.statics),this.oneMinuteTimeout=window.setTimeout(function(){var e=Object(de.a)(t);Object(ve.c)(ve.a.AFTER_ONE_MINUTE,Object(de.b)(e,n.statics)),n.oneMinuteTimeout=null},6e4)}},{key:"initWatchdog",value:function(l){var e,u=this,t=Object(_e.a)(l,{getMemberId:function(){return u.props.Sync.getMemberId()},getToken:function(){return u.props.noteToken},getStartTime:function(){return u.startTime},getExtra:(e=a()(h.a.mark(function e(){var t,n,i,r,o,a,s,c;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.plugins.sheetBridge,n=l.plugins.bitableBridge,i=u.getBitableTableIds(l),r=t.getRevision(),o=n.getRevisions(i),e.next=7,r;case 7:return a=e.sent,e.next=10,o;case 10:return s=e.sent,c=+new Date,e.abrupt("return",{updateTime:c,sheetVersion:a,bitableVersions:s});case 13:case"end":return e.stop()}},e)})),r),getUIData:function(e){console.log("error happend!");var t=we.c.getLogsToUpload();""===e.detail&&0===t.length&&(e.detail="NoLogs");var n=we.d.getLogsToUpload(),i=[].concat(o()(t),o()(n)).sort(),r=l.plugins.client;return Object($.default)("dev_doc_watch_dog",Object.assign({},e,{logs:i,timeFromStart:Date.now()-u.startTime,rev:r?r.getRev():null})),u.getInnerDocHtml()}}),n=t.watchdog,i=t.watchdogPlugin;function r(){return e.apply(this,arguments)}return this.watchdog=n,this.watchdogEventEmitter=new je.a(l.getInnerContainer(),{handleCCInputEvent:function(){return null},handleCompositionStartImmediatelyAfterInput:function(){return null}}),i}},{key:"getBitableTableIds",value:function(e){var r=[],t=function(e){return e===ne.BLOCK_DATA_META_BLOCK_PROPS};return e.getMatchedAttributePositionOnSelection(null,t).forEach(function(e){var t,n,i=JSON.parse(e.attrValue);i.blockType===ne.BlockType.BITABLE_BLOCK&&(!(t=i.token)||(n=t.split("_")[1])&&r.push(n))}),r}},{key:"render",value:function(){var e,t,n=this,i=this.props,r=i.clientVars,o=i.noteToken,a=i.Sync,s=i.copyable,c=i.registPlugins,l=i.scroller,u=i.renderConfig,d=i.hasCollapse,h=i.updateBusinessStage,f=r.collab_client_vars,p=r.colorPalette,g=r.user_id,m=r.permissions,v=f.rev,b=Object(_.default)(f,"initialAttributedTexts.texts"),y=!1;Object(I.default)(this.props.autoFocus)?b&&(t=/[^*\s]/.test(b[e="0"]),y=b[e]&&!t):y=this.props.autoFocus;var E=document.querySelector(l||".etherpad-container-wrapper");E||console.error("");var O=U()("innerdocbody maindocbody syntax flex doc-new-layout"),C=Object.assign({},u),k=Object(De.q)();return k&&(C.skipAboveRender={renderCount:k}),N.a.createElement(ee.a,{id:"innerdocbody",className:O,role:"application",spellCheck:Object(Te.c)(),contentEditable:"false",editable:this.isEditable,renderConfig:C,domPurifyConfig:{enable:!0,config:{WHOLE_DOCUMENT:!0,FORCE_BODY:!0,ADD_URI_SAFE_ATTR:["xmlns:o","xmlns:x","xmlns:w"],ADD_TAGS:["meta","google-sheets-html-origin","byte-sheet-html-origin","melo-data","mention"],ADD_ATTR:["sheet-word-wrap","xmlns:o","xmlns:x","xmlns:w"],FORBID_TAGS:["noscript"],KEEP_CONTENT:!1}},hasCollapse:d,copyable:s,autoCorrect:"false",resizeStrategy:"iframe",autoFocus:y,clientVars:Object.assign({},f,{rev:v,colorPalette:p,userId:g,permissions:m}),enableVirtualScroll:!Object(Z.a)(),scroller:E,token:o,profile:this.profile,style:this.editorStyle,onInit:function(e){n.editor=e,n.innerdoc=e.getDocBody(),console.log("ssr: editor on mount"),ie.a.isFeed&&Object(me.f)(),n.collectFirstScreenShowTime(e),n.shortcut(e),e&&n.reuseSSRPicNode(),requestAnimationFrame(n.removeDocSSR),Object(ve.d)(),n.statics=Object(de.a)(e),n.addSceneOpenAfterOneMinute(e),n.initSuiteContainerSubscription(),h(F.b.Doc,F.c.EditorMount)},inEmbed:this.inEmbed,registerPlugin:function(e){e.plugins.sync=a,n.client=new ae.b({editor:e,sync:a,clientVars:r.collab_client_vars}),e.plugins.client=n.client,e.collabClient=n.client;var t=n.initWatchdog(e);return e.plugins.watchdog=t,[n.client,t].concat(c(e,!1))},bus:re.a,schema:He.a})}},{key:"isEditable",get:function(){return this.props.editable}},{key:"editorStyle",get:function(){var e,t,n,i,r,o,a,s=this.props.opendocContentConfig,c=Object(_.default)(window,"User.isPDF"),l=Object(Ze.d)(),u={minHeight:c?0:window.innerHeight-(l?68:64),fontFamily:Object(se.a)()};return ie.a.isOpendoc&&s&&(e=s.padding,t=s.maxWidth,e&&(i=(n=d()(e,4))[0],r=n[1],o=n[2],a=n[3],Object(I.default)(a)||(u.paddingLeft=a+"px"),Object(I.default)(r)||(u.paddingRight=r+"px"),Object(I.default)(i)||(u.paddingTop=i+"px"),Object(I.default)(o)||(u.paddingBottom=o+"px")),Object(I.default)(t)||(u.maxWidth=t+"px",u.margin="auto")),u}}]),t}(R.Component);it.displayName="DocsMain",it.contextTypes={openSideBar:x.a.func},rt.a=it}).call(this,ot("2vAP"))},"5TLL":function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),o=n("H6oK"),a=n("Nv5K"),s=[a.a.WordCopySupport,a.a.TencentDocCopySupport,a.a.GDCopySupport,a.a.OneNoteCopySupport,a.a.OneDriveWordCopySupport],c=[o.BlockType.PLACEHOLDER_BLOCK],l=n("GIL9"),u=n("iP/4"),d=n("Ehz1"),h=n("bsrO"),f=n("Cf53"),p=n("rLED"),g=n("TWwi"),m=n("56Fm");function v(){var e,t=!0;return u.a.isOpendoc&&(t=!(!(e=Object(f.a)())||!e.partial.enable)),t}var b=function(){var e=v();return{plugins:[a.a.ContextPreprocess,a.a.TextInputTime,a.a.ScrollFps,a.a.Delete,a.a.Undo,a.a.Redo,a.a.TextNodeDeserializer,a.a.PasteStyleInherit,a.a.BlockElementDeserializer,a.a.PlainTextHandler,a.a.PCList,Object(p.hb)()&&a.a.SmartCompose,a.a.Indent,a.a.Align,a.a.Quote,a.a.PCHeadings,a.a.ViewportObserver,u.a.isInVC&&a.a.DocPosition,a.a.Rect,a.a.Range,a.a.CursorTrack,a.a.AttributePositionManager].concat(r()(s),[a.a.Author,a.a.Line,a.a.Horizontal,a.a.ShortKeyTea,a.a.HyperLinks,a.a.HyperLinksRemoveLink,a.a.HyperLinksBackground,a.a.Simpletags,a.a.Image,a.a.TabKey,a.a.Table,e&&a.a.CommentPlugin,a.a.Bold,a.a.Italic,a.a.Underline,a.a.Strikethrough,a.a.Sheet,a.a.Bitable,a.a.ISVBlock,a.a.Mindnote,a.a.Save,a.a.DocHistory,a.a.Checkbox,a.a.CodeBlock,a.a.Markdown,a.a.MobileEditBarStatusManager,a.a.EditBarManager,a.a.SelectionPopup,a.a.NoteTitlePlugin,a.a.InputCompatible,a.a.HighlightColor,a.a.InlineCode,a.a.DriveUpload,a.a.ReminderLine,a.a.BlockPlugin,a.a.EditorCopy,a.a.SingleLineManage,a.a.SectionNavPlugin,a.a.JumpContent,a.a.Rangecode,a.a.TemplateInline,a.a.TemplateBlock,a.a.PlaceHolder,a.a.TemplateWrap,a.a.TemplateAbstract,a.a.OfflineEditor,a.a.CheckAll,a.a.EditorCopyStyle,a.a.Link2Mention,a.a.TripleClick,a.a.FsController,a.a.DocsRenderTime,a.a.UnsupportFeature,a.a.InserDomLineBetweenPicture,a.a.UserChangeTea,a.a.BackBtn,a.a.LimitEditModeQuantityPlugin,a.a.MemoryMonitor,e&&a.a.SuspensionComment,a.a.FindReplacePlugin,a.a.ReminderPlugin,a.a.FileCardSwitchView,a.a.Placeholder,a.a.ImageRelayPlugin,a.a.SheetBridgePlugin,a.a.BitableBridgePlugin,a.a.MindnoteBridgePlugin,a.a.BlockRenderStatistics,a.a.BlockRenderAutoRender,a.a.ScrollPosition,a.a.AutoCapitalization,a.a.AutoSpace,a.a.DocDraggable,a.a.LoadableInlineDraggable,a.a.LineMenuOperate,a.a.LineMenuPollInsert,a.a.PCDiagram,Object(g.a)()&&a.a.CodeBlockV2,Object(g.a)()&&a.a.CodeBlockLineNum,(Object(p.f)()||Object(l.a)())&&a.a.Callout,a.a.LineHover,Object(d.b)()&&!u.a.isOpendoc&&a.a.GrammarChecker,a.a.UserChangeDetector,a.a.ModalSelectAll,a.a.DocLockerPlugin,a.a.DocTimingHooksPlugin,a.a.LineGuidMonitor,a.a.LastEmptyLinePlaceholder,Object(p.ib)()&&a.a.SmartLink,Object(m.f)()&&a.a.OpAuthor,a.a.LinkToBlock,0<Object(p.q)()&&a.a.AsyncDomLoadingManager,a.a.UploadImgOrVideo]),blocks:[].concat(r()(c),[o.BlockType.AT_USER_BLOCK,o.BlockType.CHAT_CARD_BLOCK,!u.a.isOpendoc&&o.BlockType.FILE_CARD_BLOCK,o.BlockType.REMINDER_BLOCK,o.BlockType.POLL_BLOCK,o.BlockType.IFRAME_BLOCK,o.BlockType.SHEET_BLOCK,o.BlockType.BITABLE_BLOCK,o.BlockType.LINK_BLOCK,o.BlockType.DIAGRAM_BLOCK,(Object(p.u)()||Object(l.a)())&&o.BlockType.MINDNOTE_BLOCK,(Object(h.f)()||Object(l.a)())&&o.BlockType.JIRA_ISSUE_BLOCK,(Object(h.d)()||Object(l.a)())&&o.BlockType.JIRA_FILTER_BLOCK,o.BlockType.EQUATION_BLOCK,(Object(p.w)()||Object(l.a)())&&!u.a.isFeishuRooms&&o.BlockType.ISV_BLOCK])}};function y(){return b()}n.d(t,"a",function(){return y})},"5UUe":function(e,t,n){"use strict";var i=n("o0o1"),E=n.n(i),r=n("yXPU"),O=n.n(r),o=n("lwsE"),C=n.n(o),a=n("W8MJ"),k=n.n(a),s=n("a1gu"),I=n.n(s),c=n("Nsbk"),S=n.n(c),l=n("iWIM"),T=n.n(l),u=n("7W2i"),_=n.n(u),d=n("cDf5"),h=n.n(d),f=n("H6oK"),p=n("Hj9z"),g=n("2IYG"),w=n("SYRc"),j=n("OX8E"),M=n("wAsq"),L=n("1dfU"),R=n("lQZd"),m=function(e){function r(e,t){var o,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return C()(this,r),(o=I()(this,S()(r).call(this))).options={},o.enterFullscreenHandler=function(){Object(M.b)("follower",{space:Object(L.a)(o.token)})},o.exitFullscreenHandler=function(){Object(M.b)("follower",{space:Object(L.a)(Object(R.g)())})},o.previewHistory=function(){var n=O()(E.a.mark(function e(t,n){var i,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.revInfo,r=t.changesets,o.localHistoryChangeset=r,o.revInfo=i,e.next=5,o.checkManagerReady();case 5:if(!o.bitableManager){e.next=12;break}if(e.t0=o.bitableManager,e.t0)return e.next=10,o.bitableManager.previewHistory(t,n);e.next=11;break;case 10:e.t0=e.sent;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),o.getOrders=e,o.blockExtraFunctions=t,o.options=n,o}function t(e){return n.apply(this,arguments)}var n,i,o,a,s,c,l,u,d;function h(e){return i.apply(this,arguments)}function f(e,t){return o.apply(this,arguments)}function p(){return a.apply(this,arguments)}function g(e,t,n,i){return s.apply(this,arguments)}function m(e){return c.apply(this,arguments)}function v(e){return l.apply(this,arguments)}function b(e){return u.apply(this,arguments)}function y(){return d.apply(this,arguments)}return _()(r,e),k()(r,[{key:"destroy",value:(d=O()(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.exitHistoryMode();case 2:return e.abrupt("return",T()(S()(r.prototype),"destroy",this).call(this));case 3:case"end":return e.stop()}},e,this)})),y)},{key:"createBitableManager",value:function(e){return console.log("createBitableManager",this.options.store),new e(this.token,this.getOrders,w.a.EmbeddedInDoc,this.blockExtraFunctions,this.options.store)}},{key:"mountBitable",value:(u=O()(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j.a.on("BitableEnterDocFullScreen",this.enterFullscreenHandler),j.a.on("BitableExitDocFullScreen",this.exitFullscreenHandler),e.next=4,T()(S()(r.prototype),"mountBitable",this).call(this,t);case 4:return n=e.sent,this.options.pure&&this.options.store&&this.options.store.dispatch({type:"BITABLE_SET_IS_PURE_BITABLE",payload:{isPureBitable:!0}}),e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)})),b)},{key:"unmountBitable",value:(l=O()(E.a.mark(function e(t){var n,i=arguments;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=1<i.length&&void 0!==i[1]&&i[1],j.a.off("BitableEnterDocFullScreen",this.enterFullscreenHandler),j.a.off("BitableExitDocFullScreen",this.exitFullscreenHandler),e.abrupt("return",T()(S()(r.prototype),"unmountBitable",this).call(this,t,n));case 4:case"end":return e.stop()}},e,this)})),v)},{key:"setDocWidth",value:(c=O()(E.a.mark(function e(t){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.bitableManager.uiManager.setDocWidth(t);case 5:case"end":return e.stop()}},e,this)})),m)},{key:"enterHistoryMode",value:(s=O()(E.a.mark(function e(t,n,i,r){var o;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBitableManager(t||this.token);case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:o=this.bitableManager.contentManager.dataSource.getSource(),this.bitableManager.uiManager.openHistoryPanel({activeTableId:n,startRev:i,endRev:r,bitableBase:o.base.toJSON(),token:t,recoverTableHistory:this.bitableManager.contentManager.recoverTableHistory});case 6:case"end":return e.stop()}},e,this)})),g)},{key:"exitHistoryMode",value:(a=O()(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=this.bitableManager.uiManager.closeHistoryPanel();case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)})),p)},{key:"locateHistory",value:(o=O()(E.a.mark(function e(t,n){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(!this.bitableManager){e.next=9;break}if(e.t0=this.bitableManager,e.t0)return e.next=7,this.bitableManager.locateHistory(t,n);e.next=8;break;case 7:e.t0=e.sent;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e,this)})),f)},{key:"highlightHistory",value:(i=O()(E.a.mark(function e(t){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(!this.bitableManager){e.next=9;break}if(e.t0=this.bitableManager,e.t0)return e.next=7,this.bitableManager.highlightHistory(t);e.next=8;break;case 7:e.t0=e.sent;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e,this)})),h)},{key:"enterBuffer",value:function(e){this.bitableManager&&this.bitableManager.onDocEnterBuffer(e)}},{key:"leaveBuffer",value:function(e){this.bitableManager&&this.bitableManager.onDocLeaveBuffer(e)}},{key:"clearHistoryLabel",value:(n=O()(E.a.mark(function e(t){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(!this.bitableManager){e.next=9;break}if(e.t0=this.bitableManager,e.t0)return e.next=7,this.bitableManager.clearHistoryLabel(t);e.next=8;break;case 7:e.t0=e.sent;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e,this)})),t)}]),r}(g.a),v=n("/spq"),b=n("KvM/"),y=n("w+Oj"),N=n("lQSh"),D=n("fQzm"),x=n("cPIY"),P=n("Xngv"),B=n("D7h9"),U=n("Nz8i"),z=n("5fBF");n.d(t,"a",function(){return F}),n.d(t,"b",function(){return V});var H=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},F=function(e){function n(e){var a;return C()(this,n),(a=I()(this,S()(n).call(this,e))).className="BitableBridge",a.blockType="BITABLE_BLOCK",a.block=p.DocBitableBlock,a.blockCreatedSource={},a.disableOfflineEditing=function(){a.editor.on("channelStateChange",function(e){var t;a.bridge&&e&&("CONNECTED"===(t=e.newState)?a.bridge.enableEdit():"DISCONNECTED"===t&&a.bridge.disableEdit())})},a.getCreatedSource=function(e,t){var n=[e,t].join("_"),i=a.editor.plugins.blockPlugin.getBlockByToken(n),r=N.b.INSIDE_PAGE;if(a.blockCreatedSource[n])r=a.blockCreatedSource[n];else if(i){var o=i.dataset.initData;if(o)try{r=JSON.parse(unescape(o)||"{}").createSource||N.b.USER_INSERT;a.blockCreatedSource[n]=r}catch(e){console.log("parse init Data Error")}}return{createdSource:r}},a.getOrders=function(){return a.editor.getMatchedAttributePositionOnSelection(null,function(e,t){return!(e!==f.BLOCK_DATA_META_BLOCK_PROPS||!t)&&JSON.parse(t).blockType===a.blockType}).reduce(function(e,t){var n,i,r=t.attrKey,o=t.attrValue;return r===f.BLOCK_DATA_META_BLOCK_PROPS&&o&&(!(n=JSON.parse(o)).token||(i=a.processToken(n.token)).id&&e.push(i.id)),e},[])},a.disableOfflineEditing(),a.blockExtraFunctions={getCreatedSource:a.getCreatedSource},a.bitableBlockVersionMap=e.bitableBlockVersionMap,a}function t(){return i.apply(this,arguments)}var i;return _()(n,e),k()(n,[{key:"setupBridge",value:function(e,t){T()(S()(n.prototype),"setupBridge",this).call(this,e,t),this.isInHistory&&this.loadHistoryVersion()}},{key:"loadHistoryVersion",value:(i=O()(E.a.mark(function e(){var t,n,i,r,o;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],this.bridge&&this.bitableBlockVersionMap)return n=this.bitableBlockVersionMap,i=n.datas,r=n.options,e.next=5,this.bridge.previewHistory({revInfo:i},{isHighlight:!!r.isHighlight,users:r.users||{}});e.next=6;break;case 5:t=e.sent;case 6:(o=this.editor.plugins.historyChangeSelection)&&o.updateBitableRecord(t||[]);case 8:case"end":return e.stop()}},e,this)})),t)},{key:"loadBridgeManager",value:function(e){var t=this.isTemplate?{store:this.createReduxStore(),pure:!0}:{},n=new m(this.getOrders,this.blockExtraFunctions,t);return n.loadBitableManager(e),n}},{key:"addBitable",value:function(){if(this.bridge)return this.bridge.addBitable()}},{key:"getInitBitableCs",value:function(){return Object(g.c)(Number(Object(f.getMemberId)()))}},{key:"getInitKanbanCs",value:function(){return Object(g.d)(Number(Object(f.getMemberId)()))}},{key:"pasteBitable",value:function(e,t,n){return this.bridge?this.bridge.pasteBitable(e,Number(Object(f.getMemberId)()),t):Object(g.g)(e,Number(Object(f.getMemberId)()),n,t)}},{key:"setOnCommentBatchUpdate",value:function(e,t){this.bridge&&this.bridge.setOnCommentBatchUpdate(e,t)}},{key:"getBitablePasteData",value:function(e){return Object(g.b)(e)}},{key:"enterHistoryMode",value:function(e,t,n,i){this.mountBridge().enterHistoryMode(e,t,n,i)}},{key:"getRevisions",value:function(e){return this.mountBridge().getTableRevision(e)}},{key:"exitHistoryMode",value:function(){this.mountBridge().exitHistoryMode()}},{key:"destroy",value:function(){T()(S()(n.prototype),"destroy",this).call(this)}},{key:"enterBuffer",value:function(e){this.bridge&&this.bridge.enterBuffer(e)}},{key:"leaveBuffer",value:function(e){this.bridge&&this.bridge.leaveBuffer(e)}},{key:"mountBridge",value:function(){return this.bridge||(this.bridge=new m(this.getOrders,this.blockExtraFunctions)),this.bridge}},{key:"locateHistory",value:function(e,t){this.bridge&&this.bridge.locateHistory(e,t)}},{key:"clearHistoryLabel",value:function(e){this.bridge&&this.bridge.clearHistoryLabel(e)}},{key:"createReduxStore",value:function(){var e=B.default.getState();return Object(U.createStore)({initialState:e,enhancers:[],extensions:[Object(z.getSagaExtension)()]},Object(x.a)(),Object(P.a)())}}]),n}(b.a);function V(i){return{isBitableBridgeLoaded:function(){return Object(g.e)()},loadBitableBridge:function(){return Object(g.f)()},getBitableBridge:function(){return i.getBridge()},addBitable:function(){return i.addBitable()},pasteBitable:function(e,t){return i.pasteBitable(e,t,!0)},getInitBitableCs:function(){return i.getInitBitableCs()},getInitKanbanCs:function(){return i.getInitKanbanCs()},setWidth:function(e,t,n){return i.setWidth(e,t,n)},setMaxWidth:function(e){return i.setMaxWidth(e)},setDocWidth:function(e){return i.setDocWidth(e)},encodeBitableData:function(e){return y.Base64.encode(e)},decodeBitableData:function(e){return y.Base64.decode(e)},getBitablePasteData:function(e){return i.getBitablePasteData(e)},triggerContentChangeInDoc:function(){return i.editor.eventEmitter.trigger(f.BLOCK_CONTENT_CHANGE)},setOnCommentBatchUpdate:function(e,t){return i.setOnCommentBatchUpdate(e,t)},getLogService:function(){return D.b},onEnterBuffer:function(e){i.enterBuffer(e)},onLeaveBuffer:function(e){i.leaveBuffer(e)}}}F=H([Object(v.a)(["destroy"])],F)},"5Ucn":function(e,Ae,Le){"use strict";Le.r(Ae),function(f){Le.d(Ae,"HyperLinks",function(){return h}),Le.d(Ae,"HyperLinksRemoveLink",function(){return je}),Le.d(Ae,"HyperLinksBackground",function(){return Me});var e,t=Le("lSNA"),y=Le.n(t),n=Le("J4zp"),p=Le.n(n),i=Le("RIqP"),g=Le.n(i),r=Le("o0o1"),S=Le.n(r),o=Le("yXPU"),m=Le.n(o),a=Le("lwsE"),v=Le.n(a),s=Le("W8MJ"),b=Le.n(s),E=Le("7EGn"),c=Le("q1tI"),O=Le.n(c),C=Le("nN3d"),k=Le("D7h9"),T=Le("fHYd"),I=Le("b5gA"),_=Le("qtYV"),w=(Le("CAVi"),Le("YNKm")),j=Le("YWBl"),M=Le("7Kxq"),L=Le("HmyT"),R=Le("dP4c"),l=Le("PyL4"),N=Le.n(l),D=Le("gNEk"),x=Le("QM+C"),P=Le("M8cP"),B=Le("H6oK"),U=Le("FJEn"),z=Le("aBgF"),u=Le("/spq"),H=Le("wq9/"),F=Le("HIeq"),V=Le("EbIy"),W=Le("2ACu"),K=Le("FnDM"),Z=Le("fJND"),d=Le("zhgJ"),q=Le("VIFs"),Y=Le("+FT0"),J=Le("fQzm"),Q=Le("ZLpy"),X=Le("OX8E"),$=Le("toa8"),ee=Le("Rvcf"),te=Le("n/R6"),ne=Le("kmoK"),ie=Le("mRaX"),re=Le("PX10"),oe=Le("bsrO"),ae=Le("LaDK"),se=Le("QbKL"),ce=Le("SGN9"),le=Le("G8Hj"),ue=Le("D28M"),de=Le("yaX4"),he=Le("dDhe"),fe=Le("y2sV"),pe=Le("4jTF"),ge=Le("yGdm"),me=Le("4I7P"),ve=Le("rLED"),be=Le("kESg"),ye=Le("+4eN");Le.d(Ae,"HYPERLINK_POPUP_WIDTH",function(){return ge.d}),Le.d(Ae,"MOIRAE_CATCH_KEY_MAP",function(){return ge.h}),Le.d(Ae,"HYPERLINK_CONTAINER_CLASS",function(){return ge.c}),Le.d(Ae,"ignoreReg",function(){return ge.l}),Le.d(Ae,"EXAMPLE_MAP",function(){return ge.a}),Le.d(Ae,"TITLE_MAP",function(){return ge.j}),Le.d(Ae,"PLACEHOLDER_MAP",function(){return ge.i}),Le.d(Ae,"FEISHU_HELPLINK_MAP",function(){return ge.b}),Le.d(Ae,"LARK_HELPLINK_MAP",function(){return ge.g}),Le.d(Ae,"IFRAME_HOLDER_PREFIX",function(){return ge.e}),Le.d(Ae,"hostnameBlacklist",function(){return ge.k}),Le.d(Ae,"supportsHttpForConversion",function(){return ge.m});var Ee=null,Oe=null,Ce=null,ke=null,Ie="a_panel",Se=Object(d.b)(),Te=/hyperlinks_onboarding_([^\s]+)/;function _e(){ke=null}var we=O.a.createElement("span",{className:"outer-u-container"}),h=Object(u.a)(["initPopUp","addEvents","reset","removeEvents"])(e=function(){function r(e){var I=this;v()(this,r),this.className="HyperLinks",this.handleSave=function(e){var n=T.a.linkInput.val().replace(/^\s+/,"");Object(R.b)(n)&&(n="");var t=T.a.textInput.val(),i=!Object(L.$)(".link-popup__uncollapsed").length,r=i&&I.originText!==t,o=i&&!t?n:t;I.editorInfo.callWithAce(function(e){var t;I.doToggleLinkBackground("link_background"),n&&(I.removeRemoveLinkAttr(),t=e.getRep(),I.doInsertLink(t.zoneId,Object(R.a)(n),null,o,r))},"insertLink",!0,{mergeEvent:"insertLink"}),T.a.hidePopUp(),T.a.linkInput.val(""),T.a.textInput.val("");var a="editorbar"===Ie?"toolbar_hyperlink":Ie;"shortKey"!==a&&Object(W.default)("confirm_mention",{mention_type:"link",panel_source:Ie,line_is_empty:Object(ie.P)(I.editorInfo)});var s={};Object(q.isDocUrl)(n)&&(s.insert_token=Object(K.d)(n),s.insert_type=Object(K.f)(n)),Object(W.default)("client_insert_url",Object.assign({create_source:a,has_text:t&&0<t.length},s))},this.register=function(l){l.registerAceCommand(w.P,function(e,t,n,i){var r,o=i.source,a=l.getRep(),s=l.isCaret,c="shortKey"===o;a&&s(a)&&c&&l.isCaretDisabled?i.isStopPropagation=!1:(I.handleClickLinkButton(),Ie=o,r=c?"keyDown":"mouseclick",Object(j.a)({action:"link",op:M.f,source:o,eventType:r}),Object(L.$)(".comment-line-popup-container").hide(),l.call("hideCommentPopup"))},{statusKey:"url-"})},this.postAceInit=function(e,t){I.context=t,I.initPopUp(),I.removeEvents(),I.addEvents(),I.editorInfo.pure&&(I.removeHistoryLinkEvent(),I.addHistoryLinkEvent())},this.changesetApply=function(){var e;V.default.isShowing()&&(e=Object(L.$)(".".concat(ge.e,"-").concat(ke))[0],V.default.update(e)),_.a.showStatus&&I.closeModifyPopUp()},this.inHyperBtn=function(e){return e&&Object(L.$)("[data-key=link]").get(0)&&Object(L.$)("[data-key=link]").get(0).contains(e)},this.storeSelPosition=function(){var e=I.editorInfo.getRep();I.storeSel={selZone:e.zoneId,selStart:[e.selStart[0],e.selStart[1]],selEnd:[e.selEnd[0],e.selEnd[1]]}},this.setCursorPositionFromStore=function(){var e,t,n,i;I.storeSel&&(t=(e=I.storeSel).selZone,n=e.selStart,i=e.selEnd,I.setWindowSelection(t,n,i),I.clearSelPosition())},this.clearSelPosition=function(){I.storeSel=null},this.handleLinkPopupKeyUp=function(e){T.a.showStatus&&e.keyCode===z.c.Esc&&I.handleClickLinkButton()},this.handleModifyPopupKeyUp=function(e){_.a.showStatus&&e.keyCode===z.c.Esc&&_.a.hidePopUp()},this.handleDocumentMouseDown=function(e){var t,n,i=e.target;!T.a.showStatus||T.a.linkPopUp.get(0).contains(i)||I.inHyperBtn(i)||((t=Object(L.$)('#editbar-line-popover [data-key="link"]').get(0))&&t.contains(i)||(T.a.hidePopUp(),e.data.context.editorInfo.callWithAce(function(e){I.doToggleLinkBackground("link_background")},"insertLink",!0,{mergeEvent:"insertLink"}))),_.a.showStatus&&!_.a.modifyPopUp.get(0).contains(i)&&_.a.hidePopUp(),2!==e.which&&4!==e.button||(n=i.dataset.href)&&0<n.length&&Object(D.d)(e)},this.handleChangeUrlAttribute=function(e,r,t,o){e.editorInfo.callWithAce(function(e){var t,n,i=e.domToRep(r);i&&(n=(t=e.dom).zoneOfRootNode(t.rootNodeOfZoneContaining(r)),I.doInsertLink(n,Object(R.a)(o),i))},"changeUrlAttr",!0)},this.handleClickModify=function(e){var t=e.data,n=t.context,i=t.hyperDom,r=n.editorInfo;I.setHyperDom(r,i);var o=Object(L.$)(Object(L.$)(i).find("a").get(0)).data("href"),a=Object(L.$)(i).text();I.originText=a,_.a.hidePopUp(),I.handleClickLinkButton("url",null,o,a,!0)},this.handleClickDelete=function(e){var t=e.data,n=t.attr,i=t.context,r=t.hyperDom,o=i.editorInfo,a=o.getDocBody(),s=I.setHyperDom(o,r),c=I.linkIdentity(o,s);I.clearSelPosition();var l=o.getRep();a.contains(r)?o.callWithAce(function(e){n?(e.removeAttributeOnDom(l.zoneId,r,n[0]),c&&e.setAttributeOnSelection(l.zoneId,"removeLink",!0,l)):e.setAttributeOnSelection(l.zoneId,"removeLink",!0,l)},"removeAttributeOnDom",!0):console.log("don not in innerbody"),_.a.hidePopUp()},this.handleCloseModifyPopUp=function(){_.a.hidePopUp()},this.setHyperDom=function(e,t){var n=e.dom,i=n.zoneOfRootNode(n.rootNodeOfZoneContaining(t)),r=e.domToRep(t);if(r)return I.editorInfo.activeCaret(),I.setWindowSelection(i,r.selStart,r.selEnd),{zone:i,_rep:r}},this.linkIdentity=function(e,t){if(t){var n=e.getReps()[t.zone],i=t._rep,r=n.lines.atIndex(i.selStart[0]).text;return!!x.LINK_REG.exec(r)}},this.handleMouseEnterModifyPopUp=function(e){Ee&&(clearTimeout(Ee),Ee=null)},this.handleMouseLeaveModifyPopUp=function(e){I.closeModifyPopUp()},this.handleWindowBlur=function(){Oe&&(clearTimeout(Oe),Oe=null),Ce&&(clearTimeout(Ce),Ce=null)},this.handleMouseEnterUrl=function(e){var r=e.currentTarget,o=e.data;Oe=Oe||setTimeout(function(){var e=Object(L.$)(Object(L.$)(r).find("a").get(0)).data("href"),t=/url-(\S+)/.exec(r.className);if(!I.editorInfo.dom.isCurrentContext(I.editorInfo.dom.getRootNodeForDom(r)))return!1;_.a.linkText.text(e),_.a.linkText.attr("title",e);var n=Object(H.a)(r,I.editorInfo);_.a.showPopUp(r,{},n);var i={attr:t,context:o.context,hyperDom:r.parentNode};_.a.modifyPopUp.removeClass("link-popup_hidden"),clearTimeout(Ee),Ee=null,Object(L.$)(".link-modify-submit").one("click",i,I.handleClickModify),Object(L.$)(".link-modify-delete").one("click",i,I.handleClickDelete)},500)},this.handleHyperlinkAndMentionClick=function(e){var t=e.currentTarget,n=Object(L.$)(t).parent().closest('[class*="url"], [class*="mention"]'),i=n.hasClass("mention"),r=n.hasClass("url"),o=n.hasClass("mention-type_1");if(!n.hasClass("mention-type_0"))return(r||o)&&Object(D.b)(e),i&&!o&&(I.props.onLinkClick?I.props.onLinkClick(e):Object(D.d)(e)),!1},this.handleMouseLeaveUrl=function(e){clearTimeout(Oe),Oe=null,Ee=Ee||setTimeout(I.handleCloseModifyPopUp,500)},this.handleClickUrl=function(e){var t=Object(E.default)(e,"target.href","");t&&Object(q.isDocUrl)(t)&&Object(W.default)("client_click_docs_link",{to_file_id:Object(K.d)(t),to_file_type:Object(K.f)(t)})},this.closeModifyPopUp=this.handleMouseLeaveUrl,this.handleClickSubmit=function(e){I.handleSave()},this.formatUrl=function(e){return encodeURI(decodeURI(e))},this.handleDidPaste=function(e){var t=I.editorInfo.getRep().zoneId,n=Object(ye.n)(I.editorInfo,t);n!==be.l.CalloutBlock&&n!==be.l.CodeBlock&&I.editorInfo.once(fe.k.PAINT,function(){I.handleLinkToIframeOrBlock(e)})},this.handleLinkToIframeOrBlock=function(){var t=m()(S.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Date.now(),i=t.UNSAFE_text,r=I.editorInfo.getRep(),o=r.selEnd,a=r.selStart,I.afterPasteInsertRep={selStart:a,selEnd:o},s={rep:I.editorInfo.getRep(),text:i},!ke||Object(Y.a)(I.editorInfo))return e.abrupt("return");e.next=7;break;case 7:if(c=Object(P.b)(i),l=I.props,u=l.parseJiraIssueEnable,d=l.parseJiraFilterEnable,!u&&!d){e.next=18;break}if(h=I.checkJiraUrl(s),h!==me.a.Unknow)return Object(W.default)("client_paste_url",{url_host:c,url_parse_type:"third_party"}),t.linkHandleBy="Jira",e.next=17,I.InsertJiraUrlBlock(s,h,!0,{url_parse_type:"third_party",startTime:n});e.next=18;break;case 17:return e.abrupt("return");case 18:if(I.showOnboarding(s),f=s.text,!(p=Object(B.getBlockCreator)(B.BlockType.IFRAME_BLOCK,I.editorInfo))){e.next=38;break}if(g=p.findSupportCode,m=p.findSupportCodeURL,v=p.generateIframeDataSet,b=p.isSupportUrl,g){e.next=25;break}return e.abrupt("return");case 25:if(y=g(f),!v||!(Object(D.e)(f)&&Se||y||b(f))){e.next=38;break}if(m&&y&&(f=m(y)||f),E=v(f,y),Object(Q.a)(E&&E.props.data.type)){e.next=31;break}return e.abrupt("return");case 31:Object(W.default)("client_paste_url",{url_host:c,url_parse_type:"default_parse"}),t.linkHandleBy="Iframe",O=Object(L.$)(".".concat(ge.e,"-").concat(ke)),C={url:!0},I.isCurrentDocUrl(f.trim())||(C.iframe=I.insertIframe.bind(I,f,p,E),y&&(C.code=!0,C.url=!1)),Se&&Object(Z.a)(f.trim())&&(C.doc=function(){Object(W.default)("click_insert_title",{}),I.editorInfo.hooks.callAll("linkToMention",{editor:I.editorInfo,url:f.trim(),node:O})}),Object(ve.ib)()&&x.HYPERTEXT_URL_REG.test(f)?(k={url:f,targetOrPosition:O[0],handlers:C,hideCallback:_e,logParams:{url_parse_type:"default_parse",startTime:n}},I.editorInfo.call("iframePopupContextToSmartLink",k)):V.default.show(O[0],C,function(){ke=null},{url_parse_type:"default_parse",startTime:n});case 38:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.handleDidPasteWithWrapper=function(){var t=m()(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),t.startTime=n,e.next=4,I.handleDidPaste(t);case 4:I.editorInfo.call("didPastAfterHyperlink",t);case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.handleJiraStartConnect=function(n){pe.c.getInstance().startConnect(pe.b.Jira,function(e){var t=I.checkJiraUrl(n);return e===pe.a.CONNECT_SUCCESS&&I.InsertJiraUrlBlock(n,t)})},this.insertJiraBlock=function(e,t){var n=I.editorInfo,i="filter"===e,r=i?B.BlockType.JIRA_FILTER_BLOCK:B.BlockType.JIRA_ISSUE_BLOCK,o=Object(B.generateBlockDataSet)(Object.assign({blockType:r,creator:Object(B.getBlockCreator)(r,n)},t));n.updateBrowserSelectionFromRep(!0);var a=n.plugins.blockPlugin.getAttrsFromBlockDataSet(o);n.inCallStackIfNecessary("mentionFastIncrop",function(){n.fastIncorp(!0)});var s=Object(L.$)(".".concat(ge.e,"-").concat(ke)),c=I.editorInfo.domToRep(s[0]),l=c.selStart,u=c.selEnd,d=n.getRep().lines.atIndex(u[0]).text.length;u[1]>d&&(u[1]=d),Object(re.d)(n,l,u," ",a),i&&I.onInsertJiraFilterBlock(),I.editorInfo.version.includes(fe.y)||n.updateBrowserSelectionFromRep(!0)},this.handleIframeClickExample=function(e){var t;e.preventDefault(),I.editorInfo.plugins.blockPlugin&&(t=T.a.linkIframeExample.attr("href"),I.insertIframeBlock(t,{example:!0}))},this.handleIframeClickSubmit=function(){var e;I.editorInfo.plugins.blockPlugin&&(e=T.a.linkIframeInput.val(),I.insertIframeBlock(e))},this.handleIframeClickHelp=function(){Object(W.default)("click_iframe_help",{iframe_type:T.a.iframeKey})},this.handleIframeInputKeyDown=function(e){var t;I.editorInfo.plugins.blockPlugin&&e.keyCode===z.c.Enter&&(t=T.a.linkIframeInput.val(),I.insertIframeBlock(t))},this.handleClickLinkButton=function(e,t,n,i,r){var o,a,s,c,l,u=window.getSelection().isCollapsed;I.isCreatedWithoutSelectText=u,T.a.showStatus?(I.editorInfo.callWithAce(function(e){I.doToggleLinkBackground("link_background")},"insertLink",!0,{mergeEvent:"insertLink"}),T.a.hidePopUp(),I.setCursorPositionFromStore()):(o=ge.a[t],a=ge.j[t],s=ge.i[t],c=Object(D.a)(),l=Object(ve.r)()?c[t]:"",setTimeout(function(){T.a.showPopUp({editorInfo:I.editorInfo,isCollapsed:u,type:e,title:a,placeholder:s,exampleLink:o,helpLink:l,link:n,text:i,exsitLink:r,iframeKey:t}),u?I.storeSelPosition():I.editorInfo.callWithAce(function(e){I.doToggleLinkBackground("link_background")},"insertLink",!0,{mergeEvent:"insertLink"}),I.editorInfo.version.includes(fe.y)&&I.editorInfo.once("paint",function(){setTimeout(function(){I.handleInputFocus(T.a,e,u)},0)}),I.handleInputFocus(T.a,e,u)},0))},this.handleInputFocus=function(e,t,n){var i=function(e){return e.get(0).focus()};i("iframe"===t?e.linkIframeInput:n?e.textInput:e.linkInput)},this.handleInputBlur=function(){I.editorInfo.callWithAce(function(e){I.doToggleLinkBackground("link_background")},"insertLink",!0,{mergeEvent:"insertLink"}),setTimeout(function(){T.a.hidePopUp()},100)},this.handleInputKeyDown=function(e){e.keyCode===z.c.Enter&&(Object(L.$)(".link-submit").focus(),I.handleSave(),e.stopPropagation(),e.preventDefault())},this.aceAttribsToClasses=function(e,t){var n=t.key,i=t.value;return/(?:^| )url-(\S+)/.exec(n)||/cellPosition/.exec(n)?"javascript:void(0)"===i?[]:["".concat(n,":").concat(i)]:"removeLink"===n?["removeLink"]:"link_background"===n?["lb"]:Te.test(n)?[n]:void 0},this.aceGetFilterStack=function(e,t){return D.g},this.aceCreateDomLine=function(e,t){var n=t.spanClass,i=t.htmls;0===i.length&&(I.currentURL="",I.processingUrl=!1),ne.a.isWiki()&&ne.a.parseHTML(i);var r=/(?:^| )url-([A-Za-z0-9]*):(\S+)/.exec(n),o=/(^| )url:(\S+)/.exec(n),a=-1<n.indexOf("removeLink"),s=r||o;if(!s)return I.closeUrlSpan(i),[];var c,l,u=r?decodeURIComponent(s[2]):s[2];if(0===u.indexOf("javascript://")&&(u=""),ge.l.test(n)&&u)return t.spanClass=n.replace(s[0],""),void I.closeUrlSpan(i);if(a&&((l=i[c=i.length-1])&&/data-faketext/.test(l)&&/inline/.test(l)?i[c]=l.replace(x.FAKETEXT_SUFFIX,""):t.extraOpenHtml+=x.FAKETEXT_PREFIX,t.extraCloseHtml+=x.FAKETEXT_SUFFIX),u&&!a){u!==I.currentURL&&(I.processingUrl&&t.htmls.push("</span>"),t.htmls.push('<span class="outer-u-container">'),I.currentURL=u),I.processingUrl=!0;var d=N.a.escapeHTMLAttribute(Object(R.a)(u));ne.a.isWiki()&&ne.a.addTask(Object(R.a)(u));var h='<a href="'.concat(d,'"         data-href="').concat(d,'"         target="_blank"         rel="noopener noreferrer"         spellcheck="false">');t.extraOpenTags="".concat(h).concat(t.extraOpenTags),t.extraCloseTags="".concat(t.extraCloseTags,"</a>");var f=n.replace(s[0],"");return t.spanClass="".concat(f," ").concat(r?"url-".concat(s[1]," url"):"manual url"),void(I.editorInfo&&Object(D.e)(u)&&(ke=Object(F.a)(),t.spanClass="".concat(t.spanClass," ").concat(ge.e,"-").concat(ke)))}I.closeUrlSpan(i),t.spanClass=n.replace(s[0],"")},this.acePreWriteDomLineHTML=function(e,t){var n=t.htmls;I.closeUrlSpan(n)},this.aceInitialized=function(e,t){var n=t.editorInfo;(I.editorInfo=n).doToggleLinkBackground=I.doToggleLinkBackground,n.doInsertLink=I.doInsertLink,I.documentAttributeManager=t.documentAttributeManager,I.register(n)},this.doInsertLink=function(i,e,t,n){var r,o,a=4<arguments.length&&void 0!==arguments[4]&&arguments[4],s=I.editorInfo,c=s.getReps()[i],l=t||c,u=c.attributeManager;s.removeMatchedAttributeOnSelection(i,t,"url-"),l.selStart&&l.selEnd&&(r=Object(C.c)(10),o=["url-".concat(r),encodeURIComponent(e)],X.a.emit("invokeCollapse",{zoneId:i,range:{selStart:l.selStart,selEnd:l.selEnd},source:"insert_hyperlinks"}),I.isCreatedWithoutSelectText||a?s.performDocumentReplaceRangeWithAttributes(l.zoneId,l.selStart,l.selEnd,n,[o]):I.setUrilAttrOnRange(l,s,u,o),l.selEnd&&setTimeout(function(){var e=window.getSelection();e.rangeCount&&e.removeAllRanges();var t=Object(L.$)(".etherpad-container-wrapper").scrollTop(),n=g()(l.selEnd);s.focus(t),I.setWindowSelection(i,n,n)},0))},this.doToggleLinkBackground=function(e){I.editorInfo.toggleAttributeOnSelection(e,void 0,void 0,void 0,U.config.LOCAL)},this.pluginReadOnly=function(){I.removeEvents(!1)},this.pluginReadWrite=function(){I.removeEvents(),I.addEvents()},this.aceBeforeCopy=function(e){var t,n=window.getSelection();if(n.getRangeAt?t=n.getRangeAt(0):((t=document.createRange()).setStart(n.anchorNode,n.anchorOffset),t.setEnd(n.focusNode,n.focusOffset)),3===t.endContainer.nodeType){var i=Object(re.c)(t.endContainer,"url"),r=i&&i.classList&&Object.values(i.classList).find(function(e){return e.includes("hyperlink_cellPosition")});if(i&&r)return"".concat(i.outerHTML)}},this.collectContentPre=function(e,t){var n=t.state,i=t.cls,r=t.node,o=t.tname,a=t.cc;if(i&&-1<i.indexOf("removeLink")&&a.doAttrib(n,"removeLink",!0),"a"===o){for(var s=r.parentNode;null!==s&&"span"!==s.tagName.toLocaleLowerCase()&&"body"!==s.tagName.toLocaleLowerCase();)s=s.parentNode;var c,l,u,d,h=s&&s.className,f=h&&-1<h.indexOf("url-"),p=h&&-1<h.indexOf("mention"),g=h&&!f&&-1<h.indexOf("url"),m=r.getAttribute("href"),v="string"==typeof m&&(-1<m.indexOf("javascript:void(0)")||0===m.length);f&&(c=/(?:^| )url-([A-Za-z0-9]*)/.exec(h),l=/(?:^| )(.*):({(.*?)})/.exec(h),u=/(^\s*)|(\s*$)/g,c&&!v?(a.doAttrib(n,c[0].replace(u,""),m),l&&a.doAttrib(n,l[1],l[2])):c&&a.doAttrib(n,c[0].replace(u,""),Object(L.$)(r).data("href")||m)),f||v||p||(d=r.className&&r.className.includes("hyperlink_cellPosition"),g||d||a.doAttrib(n,"url-".concat(Object(C.c)(10)),m))}},this.insertIframeLink=function(e){e.e;var t=e.iframeKey,n=e.createSource;I.createSource=n,I.editorInfo.version.includes(fe.y)&&I.editorInfo.flags.isPerforming?I.editorInfo.once("paint",function(){I.handleClickLinkButton("iframe",t)}):I.handleClickLinkButton("iframe",t)};var t=(this.props=e).editor,n=e.isCommentEditor,i=void 0!==n&&n;this.width=ge.d,this.storeSel=null,this.hyperlinkBtn=null,this.eventNamespace=".link".concat(+new Date),this.preserveEventNamespace=".preserveEvent",this.createSource="",this.isCommentEditor=i,this.isCreatedWithoutSelectText=!0,t&&(this.aceInitialized("",Object.assign({editorInfo:t},t)),this.postAceInit("",Object.assign({editorInfo:t},t)))}function e(e,t){return n.apply(this,arguments)}var n,i,o,t,a,s;function c(e,t){return i.apply(this,arguments)}function l(e,t,n){return o.apply(this,arguments)}function u(){return t.apply(this,arguments)}function d(e){return a.apply(this,arguments)}function h(e){return s.apply(this,arguments)}return b()(r,[{key:"match",value:function(e,t){return e.startsWith("url-")||e.startsWith("url:")}},{key:"removeRemoveLinkAttr",value:function(){var e=this.editorInfo.getRep(),t=this.editorInfo.getAttributesOnSelection(e.zoneId,e,!1);Object.values(t.attribs).some(function(e){var t=p()(e,2),n=t[0],i=t[1];return"removeLink"===n&&"true"===i})&&this.editorInfo.setAttributeOnSelection(e.zoneId,"removeLink","",e)}},{key:"initPopUp",value:function(){Object(he.c)()||(T.a.init(),_.a.init(),V.default.init(this.editorInfo),this.notyPopUp=new I.a,this.$linkPopUpContainer=T.a.getContainer(),this.$modifyPopUpContainer=_.a.getContainer())}},{key:"setWindowSelection",value:function(e,t,n){this.editorInfo.selection.setWithSelection(e,t,n,!1),this.editorInfo.updateBrowserSelectionFromRep()}},{key:"xiguaObtainIframeUrl",value:(s=m()(S.a.mark(function e(t){var n,i,r,o;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props,"xigua"===(i=n.data).type)return r="https://www.ixigua.com/api/public/iframe/convert?url=".concat(i.url),e.prev=4,e.next=7,$.d.get(r,{withCredentials:!1,ignoreInterceptors:!0});e.next=16;break;case 7:"error"===(o=e.sent).data.message&&te.a.error({content:f("airtable-link-not-exist",this.getIframeName("xigua"))}),i.url=o.data.data,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(4),J.b.ravenCatch(e.t0,{extras:{key:ge.h.xigua}}),new Error(e.t0);case 16:case"end":return e.stop()}},e,this,[[4,12]])})),h)},{key:"tiktokObtainIframeUrl",value:(a=m()(S.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props,"tiktok"!==(i=n.data).type)return e.abrupt("return");e.next=4;break;case 4:if(r=i.url,i.url.includes("vt.tiktok.com")||i.url.includes("vm.tiktok.com"))return o=encodeURIComponent(i.url),a="https://www.tiktok.com/node/common/embed?url=".concat(o),e.prev=8,e.next=11,$.d.get(a,{withCredentials:!1,ignoreInterceptors:!0});e.next=21;break;case 11:if(null!==(s=e.sent).data.errMsg)throw new Error("Fetching Tiktok iframe url has failed");e.next=14;break;case 14:r=s.data.body.url,e.next=21;break;case 17:throw e.prev=17,e.t0=e.catch(8),J.b.ravenCatch(e.t0,{extras:{key:ge.h.tiktok}}),new Error(e.t0);case 21:l=/https:\/\/www\.tiktok\.com\/embed\/([^\s]+\/)?(\d+)/i,u=/https:\/\/t\.tiktok\.com\/i18n\/share\/video\/([0-9]+)/i,d=/https:\/\/m\.tiktok\.com\/v\/([0-9]+)/i,h=(c=/https:\/\/www\.tiktok\.com\/@[^\s]+\/video\/(\d+)/i).test(i.url)?c.exec(i.url)[1]:l.test(i.url)?l.exec(i.url)[2]:(d.test(r)?d:u).exec(r)[1],i.url="https://www.tiktok.com/embed/v2/".concat(h);case 27:case"end":return e.stop()}},e,null,[[8,17]])})),d)},{key:"getIframeName",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:T.a.iframeKey;return(Object(ee.a)().find(function(e){return e.dataKey===t})||{}).name}},{key:"isUrlValid",value:function(e){return/https?:\/\/.+/.test(e)}},{key:"insertIframeBlock",value:(t=m()(S.a.mark(function e(){var t,n,i,r,o,a,s,c,l,u,d=arguments;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<d.length&&void 0!==d[0]?d[0]:"",n=1<d.length&&void 0!==d[1]?d[1]:{},i=t.trim(),i=this.formatUrl(i),this.isUrlValid(i)){e.next=6;break}return e.abrupt("return",te.a.error({content:f("airtable-invalid-url")}));case 6:if(r=n.example,o=Object(B.getBlockCreator)(B.BlockType.IFRAME_BLOCK,this.editorInfo)){e.next=10;break}return e.abrupt("return");case 10:if(a=o.generateIframeDataSet(i)){e.next=13;break}return e.abrupt("return",te.a.error({content:f("airtable-insert-failed")}));case 13:return e.prev=13,e.next=16,this.xiguaObtainIframeUrl(a);case 16:return e.next=18,this.tiktokObtainIframeUrl(a);case 18:if(!a){e.next=25;break}this.editorInfo.plugins.blockPlugin.insertBlock(a),s=Object(E.default)(a,"props.data.type",a.props.type),r?Object(W.default)("click_iframe_showexample",{iframe_type:s,create_source:"toolbar"===this.createSource?"toolbar_iframe":this.createSource}):Object(W.default)("client_insert_iframe",{iframe_type:s,create_source:this.createSource}),e.next=37;break;case 25:if(Object(W.default)("client_insert_url",{source:"mention_unsupport_URL",create_source:"toolbar"===this.createSource?"toolbar_iframe":this.createSource,has_text:Boolean(i&&0<i.length)}),this.editorInfo.callWithAce(function(e){var t;i&&(t=e.getRep(),e.doInsertLink(t.zoneId,Object(R.a)(i),null,i))},"insertLink",!0),c=this.editorInfo.getRep(),l=c.lines.atIndex(c.selStart[0])){e.next=32;break}return T.a.hidePopUp(),e.abrupt("return");case 32:if(u=l.lineNode.firstChild){e.next=36;break}return T.a.hidePopUp(),e.abrupt("return");case 36:this.notyPopUp.testUrlAndShowNoty(i,u);case 37:T.a.hidePopUp(),e.next=43;break;case 40:e.prev=40,e.t0=e.catch(13),console.log("[iframe error]: ".concat(e.t0));case 43:case"end":return e.stop()}},e,this,[[13,40]])})),u)},{key:"insertIframe",value:(o=m()(S.a.mark(function e(t,n,i){var r,o,a,s,c,l,u,d;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(W.default)("click_paste_panel",{url_parse_type:"default_parse",option_name:"embed"}),(r=this.beforePasteInsertRep)||(o=Object(L.$)(".".concat(ge.e,"-").concat(ke)),r=this.editorInfo.domToRep(o[0])),a=r.selStart,s=r.zoneId,c=r.selEnd,s&&(c=this.afterPasteInsertRep.selEnd),l=Object(P.b)(t),e.prev=7,e.next=10,this.xiguaObtainIframeUrl(i);case 10:return e.next=12,this.tiktokObtainIframeUrl(i);case 12:this.editorInfo.plugins.blockPlugin.insertBlock(i,{selStart:a,selEnd:c,zoneId:s||a[2]}),u=i.props.data.type,d=/Code$/.test(u)?"code":"link",Object(W.default)("click_insert_webpage",{iframe_type:u,url_host:l,source:d}),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),console.log("[iframe error]: ".concat(e.t0));case 22:case"end":return e.stop()}},e,this,[[7,19]])})),l)},{key:"UNSAFE_editorNormalizePasteNode",value:function(){this.beforePasteInsertRep=Object.assign({},this.editorInfo.getRep())}},{key:"checkJiraUrl",value:function(e){var t=e.rep,n=t.selStart,i=t.zoneId,r=e.text,o="0"!==i,a=!(n.length&&0===n[0]&&"0"===i)&&!this.isCommentEditor,s=Object(oe.h)(),c=a&&Object(oe.j)(r)&&s===ae.a.HAS_CONNECTED,l=this.props,u=l.parseJiraIssueEnable,d=l.parseJiraFilterEnable,h=!o&&c&&d,f=c&&u,p=me.a.Unknow;return h&&Object(oe.k)(r,"filter")?p=me.a.JuraFilter:f&&Object(oe.k)(r,"issue")&&(p=me.a.JuraIssue),p}},{key:"InsertJiraUrlBlock",value:(i=m()(S.a.mark(function e(t,n){var i,r,o,a,s,c=this,l=arguments;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=2<l.length&&void 0!==l[2]&&l[2],r=3<l.length?l[3]:void 0,o=t.text,n===me.a.JuraFilter)return a=function(){var e,t=Object(L.$)(".".concat(ge.e,"-").concat(ke)),n={data:(e=m()(S.a.mark(function e(){var t;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(se.b)(o);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:c.insertJiraBlock("filter",{initData:t,props:{}}),Object(W.default)("click_paste_panel",{url_parse_type:"third_party",option_name:"database"}),c.logInsertJira("isv_jiramaster_filter",o,{jirafilter_type:Object(oe.e)(t.filterId),issue_num:t.issueCount});case 8:case"end":return e.stop()}},e)})),i),url:!0};function i(){return e.apply(this,arguments)}V.default.show(t[0],n,function(){return null},r)},i?a():this.props.editor.once(fe.k.PAINT,a),e.abrupt("return",!0);e.next=9;break;case 9:if(n===me.a.JuraIssue)return e.next=12,Object(se.a)(o);e.next=18;break;case 12:if(s=e.sent){e.next=15;break}return e.abrupt("return");case 15:return this.insertJiraBlock("issue",{initData:s,props:{displayMode:B.BlockDisplayMode.INLINE}}),this.logInsertJira("isv_jiramaster",o),e.abrupt("return",!0);case 18:return e.abrupt("return",!1);case 19:case"end":return e.stop()}},e,this)})),c)},{key:"logInsertJira",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Object(W.default)("client_insert_isvblock",Object.assign({block_type:e,create_source:"paste",jira_type:Object(oe.g)(t)},n))}},{key:"showOnboarding",value:function(e){var t,n,i=this,r=e.text,o=e.rep,a=o.selStart,s=o.zoneId,c=a.length&&0===a[0]&&"0"===s;this.isCommentEditor||c||(t={},this.props.parseJiraFilterEnable&&(t.jira={matcher:function(e){return Object(oe.k)(e,"filter")},guide:le.STEP_TYPES.doc_jira_paste_filter_url,selectorClass:"hyperlinks_onboarding_filter",condition:function(){return Object(oe.h)()===ae.a.WITHIN_JIRA},handler:function(e){return i.handleJiraOnboarding(e)}}),(n=Object.values(t).find(function(e){return e.matcher(r)}))&&n.condition()&&(this.performOnboardingDom(e,n.selectorClass),this.handleOnboardingEvent(n.guide),setTimeout(function(){Object(ce.b)(n.guide),n.handler&&n.handler(e)})))}},{key:"performOnboardingDom",value:function(e,t){var n=this,i=e.rep,r=i.selStart,o=i.selEnd,a=i.zoneId,s=e.text,c=this.editorInfo,l=o[1]-s.length;this.setWindowSelection(a,[r[0],l],o),c.inCallStackIfNecessary("hyperlinks_onboarding",function(){n.doToggleLinkBackground(t)}),this.setWindowSelection(a,o,o)}},{key:"handleOnboardingEvent",value:function(i){var e=function e(t){var n=t.target;Object(ue.l)(n,"callout-box")&&!n.classList.contains("callout-close")||(Object(L.$)(document).off("mousedown",e),Object(L.$)(document).off("keydown",e),Object(ce.a)(i))};Object(L.$)(document).on("mousedown",e),Object(L.$)(document).on("keydown",e)}},{key:"handleJiraOnboarding",value:function(e){var t=this,n=function(){t.offHandleJiraStartConnect=null,t.handleJiraStartConnect(e)};X.a.once("jira_start_connect",n),this.offHandleJiraStartConnect=function(){return X.a.off("jira_start_connect",n)}}},{key:"onInsertJiraFilterBlock",value:function(){k.default.dispatch(Object(de.a)(oe.b)),k.default.dispatch(Object(de.a)(oe.a)),k.default.dispatch(Object(de.a)(le.STEP_TYPES.doc_jira_paste_filter_url))}},{key:"_editorLineStateWillRender",value:function(e,t){var n=t.lineState,i=new fe.E({zoneId:n.getZoneId()});Object(D.f)(n,i),i.ops.length&&(t.lineState=n.compose(i))}},{key:"renderInlineWrapper",value:function(){return we}},{key:"render",value:function(n){var e=n.children,i=n.attributes,t=Object.keys(i);t.forEach(function(e){var t=i[e];/url-(\S+)/.exec(e)&&"javascript:void(0)"!==t&&(n.class+=" ".concat(e,":").concat(t)),"url:"===e&&(n.class+=" ".concat(e).concat(t)),Te.test(e)&&(n.class+=e)});var r=/(?:^| )url-([A-Za-z0-9]*):(\S+)/.exec(n.class),o=/(^| )url:(\S+)/.exec(n.class),a=t.find(function(e){return"removeLink"===e}),s=r||o,c=decodeURIComponent(s[2]);if(0===c.indexOf("javascript://")&&(c=""),ge.l.test(n.class)&&c)return n.spanClass=n.class.replace(s[0],""),e;if(!c||a)return n.class=n.class.replace(s[0],""),e;var l=Object(R.a)(c),u=O.a.createElement("a",{href:l,"data-href":l,target:"_blank",rel:"noopener noreferrer",spellCheck:"false"},e),d=n.class.replace(s[0],"");return n.class="".concat(d," ").concat(r?"url-".concat(s[1]," url"):"manual url"),this.editorInfo&&Object(D.e)(c)&&(ke=Object(F.a)(),n.class="".concat(n.class," ").concat(ge.e,"-").concat(ke)),n.class=n.class.replace(s[0],""),u}},{key:"closeUrlSpan",value:function(e){this.processingUrl&&(this.currentURL="",this.processingUrl=!1,e.push("</span>"))}},{key:"setUrilAttrOnRange",value:function(e,t,i,r){U.RangeHelper.splitSelectionWithClassName(e,t.domToRep,ge.IGNORE_HYPERLINK_CLASS).forEach(function(e){var t=e.selStart,n=e.selEnd;i.setAttributesOnRange(t,n,[r])})}},{key:"reset",value:function(){this.removeEvents(),this.removeHistoryLinkEvent(),V.default.destroy(),this.notyPopUp&&this.notyPopUp.destroy(),T.a.destroy(),_.a.destroy(),this.notyPopUp=null,this.processingUrl=!1,this.currentUrl="",this.$linkPopUpContainer=null,this.$modifyPopUpContainer=null,this.editorInfo=null,this.offHandleJiraStartConnect&&this.offHandleJiraStartConnect()}},{key:"addEvents",value:function(){var e;this.isCommentEditor||(e=this.context,Object(L.$)(this.editorInfo.getInnerContainer()).on("mouseenter".concat(this.eventNamespace),'[class*="url-"], .manual',{context:e},this.handleMouseEnterUrl).on("mouseleave".concat(this.eventNamespace),'[class*="url-"], .manual',this.handleMouseLeaveUrl).on("click".concat(this.eventNamespace),'[class*="url-"], .manual, [class*="mention-link"]',this.handleClickUrl).on("click".concat(this.preserveEventNamespace),'[class*="url"] a, [class*="mention"] a',{context:e},this.handleHyperlinkAndMentionClick).on("mousedown".concat(this.preserveEventNamespace),'[class*="url"] a, [class*="mention-type_1"] a',D.c),_.a.modifyPopUp&&_.a.modifyPopUp.on("mouseenter".concat(this.eventNamespace),{context:e},this.handleMouseEnterModifyPopUp).on("mouseleave".concat(this.eventNamespace),{context:e},this.handleMouseLeaveModifyPopUp).on("keyup".concat(this.eventNamespace),this.handleModifyPopupKeyUp),T.a.linkPopUp&&T.a.linkPopUp.on("blur".concat(this.eventNamespace),{context:e},this.handleInputBlur).on("keyup".concat(this.eventNamespace),this.handleLinkPopupKeyUp).find("input").on("keydown".concat(this.eventNamespace),{context:e},this.handleInputKeyDown),Object(L.$)(".link-submit").on("click".concat(this.eventNamespace),{context:e},this.handleClickSubmit),Object(L.$)(window).on("blur".concat(this.eventNamespace),this.handleWindowBlur),Object(L.$)(document).on("mousedown".concat(this.eventNamespace),{context:e},this.handleDocumentMouseDown),"sheet"!==this.props.type&&(T.a.linkIframeSubmit&&T.a.linkIframeSubmit.on("click".concat(this.eventNamespace),this.handleIframeClickSubmit),T.a.linkIframeInput&&T.a.linkIframeInput.on("keydown".concat(this.eventNamespace),this.handleIframeInputKeyDown),T.a.linkIframeExample&&T.a.linkIframeExample.on("click".concat(this.eventNamespace),this.handleIframeClickExample),T.a.linkIframeHelp&&T.a.linkIframeHelp.off("click".concat(this.eventNamespace),this.handleIframeClickHelp),this.editorInfo.on("insertIframeLink",this.insertIframeLink)),this.editorInfo.on(fe.k.DID_PASTE,this.handleDidPasteWithWrapper))}},{key:"addHistoryLinkEvent",value:function(){this.isCommentEditor||Object(L.$)(this.editorInfo.getInnerContainer()).on("click".concat(this.preserveEventNamespace),'[class*="url"] > a, [class*="mention"] > a',D.d)}},{key:"removeHistoryLinkEvent",value:function(){this.isCommentEditor||Object(L.$)(this.editorInfo.getInnerContainer()).off(this.preserveEventNamespace)}},{key:"serialize",value:function(e){var t,n,i=e.type,r=e.node,o=e.op;return i!==fe.u.LEAF||(t=o.attributes&&Object.keys(o.attributes).find(function(e){return e.includes("url-")}))&&((n=document.createElement("a")).setAttribute("href",decodeURIComponent(o.attributes[t])),n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"),n.appendChild(r),e.node=n),e}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId,r=n;if(t instanceof HTMLElement){var o=t.className,a=t.tagName;if(-1<o.indexOf("removeLink")&&(r=Object(fe.H)(r,i,{removeLink:"true"})),"A"===a){for(var s=t.parentNode;null!==s&&"span"!==s.tagName.toLocaleLowerCase()&&"body"!==s.tagName.toLocaleLowerCase();)s=s.parentNode;var c,l,u,d,h,f=s&&s.className,p=f&&-1<f.indexOf("url-"),g=f&&-1<f.indexOf("mention"),m=f&&!p&&-1<f.indexOf("url"),v=t.href,b="string"==typeof v&&(-1<v.indexOf("javascript:void(0)")||0===v.length);p&&(l=/(^\s*)|(\s*$)/g,(c=/(?:^| )url-([A-Za-z0-9]*)/.exec(f))&&!b?(u=c[0].replace(l,""),r=Object(fe.H)(r,i,y()({},u,v))):c&&(d=c[0].replace(l,""),r=Object(fe.H)(r,i,y()({},d,Object(L.$)(t).data("href")||v)))),p||b||g||m||(h="url-".concat(Object(C.c)(10)),r=Object(fe.H)(r,i,y()({},h,v)))}}return r}},{key:"aceAfterPaste",value:function(){this.beforePasteInsertRep=Object.assign({},this.editorInfo.getRep())}},{key:"afterPasteInsert",value:(n=m()(S.a.mark(function e(t,n){var i,r,o,a,s,c,l,u,d,h,f=this;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.editorInfo.getRep(),r=i.selEnd,o=i.selStart,this.afterPasteInsertRep={selStart:o,selEnd:r},!ke||Object(Y.a)(this.editorInfo))return e.abrupt("return");e.next=4;break;case 4:return a=this.checkJiraUrl(n),e.next=7,this.InsertJiraUrlBlock(n,a);case 7:if(e.sent)return e.abrupt("return");e.next=10;break;case 10:if(this.showOnboarding(n),s=n.text,!(c=Object(B.getBlockCreator)(B.BlockType.IFRAME_BLOCK,this.editorInfo))){e.next=25;break}if(l=c.findSupportCode(s),!(Object(D.e)(s)&&Se||l||c.isSupportUrl(s))){e.next=25;break}if(l&&(s=c.findSupportCodeURL(l)||s),u=c.generateIframeDataSet(s,l),Object(Q.a)(u&&u.props.data.type)){e.next=20;break}return e.abrupt("return");case 20:d=Object(L.$)(".".concat(ge.e,"-").concat(ke)),h={url:!0},this.isCurrentDocUrl(s.trim())||(h.iframe=this.insertIframe.bind(this,s,c,u),l&&(h.code=!0,h.url=!1)),Se&&Object(Z.a)(s.trim())&&(h.doc=function(){Object(W.default)("click_insert_title",{}),f.editorInfo.hooks.callAll("linkToMention",{editor:f.editorInfo,url:s.trim(),node:d})}),V.default.show(d[0],h,_e);case 25:case"end":return e.stop()}},e,this)})),e)},{key:"aceCopy",value:function(e,t){var n=t.html;if(!n||n.includes("hyperlink_cellPosition"))return t;var i=Object(L.$)("<div></div>").html(n);t.html=i.html()}},{key:"removeEvents",value:function(){var e,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.isCommentEditor||((e=Object(L.$)(this.editorInfo.getInnerContainer())).off(this.eventNamespace),Object(L.$)(".link-popup").off(this.eventNamespace).find("input").off(this.eventNamespace),Object(L.$)(".link-modify-popup").off(this.eventNamespace).find("input").off(this.eventNamespace),Object(L.$)(window).off(this.eventNamespace),Object(L.$)(document).off(this.eventNamespace),Object(L.$)(".link-submit").off(this.eventNamespace),Object(L.$)(".link-modify-submit").off("click",this.handleClickModify),this.editorInfo.off(fe.k.DID_PASTE,this.handleDidPasteWithWrapper),this.isCommentEditor||("sheet"!==this.props.type&&(T.a.linkIframeSubmit&&T.a.linkIframeSubmit.off("click".concat(this.eventNamespace)),T.a.linkIframeInput&&T.a.linkIframeInput.off("keydown".concat(this.eventNamespace)),T.a.linkIframeExample&&T.a.linkIframeExample.off("click".concat(this.eventNamespace)),T.a.linkIframeHelp&&T.a.linkIframeHelp.off("click".concat(this.eventNamespace)),this.editorInfo.off("insertIframeLink",this.insertIframeLink)),t&&e.off(this.preserveEventNamespace)))}},{key:"isCurrentDocUrl",value:function(e){var t=this.editorInfo.getDocId(),n=Object(Z.a)(e);return!!n&&(n.token===t&&"doc"===n.type)}}]),r}())||e,je=function(){function e(){v()(this,e)}return b()(e,[{key:"match",value:function(e){return"removeLink"===e}},{key:"render",value:function(e){return e.class+=" removeLink",e.children}}]),e}(),Me=function(){function e(){v()(this,e)}return b()(e,[{key:"match",value:function(e){return"link_background"===e}},{key:"render",value:function(e){return e.class+=" lb",e.children}}]),e}()}.call(this,Le("2vAP"))},"5XQB":function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("hbEN"),c=n("2ACu"),l=n("FnDM"),u=n("GVmr"),d=n("cGQV"),h="SCROLL_POSITION_KEY",f=function(){function t(e){var c=this;r()(this,t),this.editor=e,this.currentRecord=null,this.handleScroll=Object(s.default)(function(){var e,t=Object(l.d)(),n=c.editor.docbody.offsetHeight,i=window.innerHeight,r=c.editor.getScrollTop()||0,o=r+i,a={fromFileId:t,documentHeight:n,windowHeight:i,scrollTop:r,scrollBottom:o,scrollPercentage:Math.min(1,o/n),statistic:Object(u.a)(c.editor)},s=c.currentRecord;(!s||s.scrollPercentage<a.scrollPercentage)&&((e=c.getRecords())[t]=a,c.setRecords(e),c.currentRecord=a)},250),this.initEvents(),this.sendRecords()}return a()(t,[{key:"initEvents",value:function(){window.addEventListener("scroll",this.handleScroll,{capture:!0,passive:!0})}},{key:"unbindEvents",value:function(){window.removeEventListener("scroll",this.handleScroll,{capture:!0})}},{key:"getRecords",value:function(){try{var e=window.localStorage.getItem(h)||"{}";return JSON.parse(e)||{}}catch(e){return{}}}},{key:"setRecords",value:function(e){try{var t=JSON.stringify(e);window.localStorage.setItem(h,t)}catch(e){console.warn("Try to set ls failed",h)}}},{key:"sendRecords",value:function(){var i=this.getRecords();Object.keys(i).forEach(function(e){var t,n=i[e];n&&(t=n.statistic||{},Object(c.collectSuiteEvent)("dev_performance_scroll_position",Object.assign({from_file_id:n.fromFileId,document_height:Object(d.a)(n.documentHeight)?n.documentHeight:-1,window_height:Object(d.a)(n.windowHeight)?n.windowHeight:-1,scroll_bottom:Object(d.a)(n.scrollBottom)?n.scrollBottom:-1,scroll_top:Object(d.a)(n.scrollTop)?n.scrollTop:-1,scroll_percentage:Object(d.a)(n.scrollPercentage)?n.scrollPercentage:-1},t)))}),this.setRecords({})}},{key:"destroy",value:function(){this.unbindEvents()}}]),t}()},"5bIa":function(e,t,n){"use strict";function i(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))}n.d(t,"a",function(){return a});var r="js_test_viewport_vh",o=!1;function a(){var e,t;o||(o=!0,(e=document.createElement("div")).id=r,e.setAttribute("style","height:100vh;position:fixed;left: -10000px;top: -10000px;opacity:0;"),document.body.appendChild(e),(t=window.getComputedStyle(e).height)&&((t=parseInt(t,10))!==window.innerHeight&&(i(),window.addEventListener("resize",i)),document.body.removeChild(e)))}},"5e3X":function(e,t,d){"use strict";var n=d("lSNA"),s=d.n(n),i=d("o0o1"),h=d.n(i),r=d("yXPU"),f=d.n(r),o=d("J4zp"),V=d.n(o),p=d("dYt1"),x=d("0bqa"),a=d("UXvI"),c=d("hbEN"),P=d("CpTu"),u=d("Muja"),l=d("xWuZ"),g=d("OZf9"),W=d("15MJ"),K=d("HmyT"),m=d("Ysvc"),v=d("iP/4"),b=d("XRg5"),y=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=e.target,i=Object(b.createViewer)(n,Object.assign({fullscreen:!0,autohideControls:!1,container:"#editorcontainerbox"},t),b.MODULE_TYPE.DOC_FULLSCREEN);return i.show(),i},E=d("lwsE"),O=d.n(E),C=function e(){var t=this;O()(this,e),this.getItemGalleryIndex=function(e){return parseInt(Object(K.$)(e).closest("[data-gallery-index]").attr("data-gallery-index"),10)},this.getGalleryData=function(){return JSON.parse(t.galleryJSONData)},this.getItems=function(){return t.getGalleryData().items}},k=d("cGQV"),I=d("nN3d"),S=d("2ACu"),T=d("QM+C"),_=d("LghI"),w=d("Ngi8"),j=d("xYHj"),M=d("Z/PY"),L=d("SyrE"),R=d("Trbk"),N=d("zfY2"),D=d("lQZd"),B=d("1dfU"),U=d("wAsq"),z=d("Cf53"),H=d("Mp37"),F=d("HIeq"),Z=d("SebV"),q=d("VklI"),Y=d("H6oK"),J=d("Tqb2"),Q=d("ciJ8"),X=d("D28M");d.d(t,"a",function(){return fe}),d.d(t,"d",function(){return ye}),d.d(t,"c",function(){return Se});var $,ee,te,ne=void 0,ie=!1,re=null,oe=0,ae=!1,se=!1,ce=!v.a.isSafari&&!v.a.isIE,le={},ue=!1,de=null,he="DocImage",fe={OPEN:"OPEN",SWITCH:"SWITCH",CLOSE:"CLOSE"};function pe(){v.a.isOpendoc&&(Object(N.registerOpendocApi)(q.a.closeImageViewer,function(){ee&&ee.hidden(),Object(N.unregisterOpendocApi)(q.a.closeImageViewer)}),Object(q.f)(q.a.closeImageViewer,"rgba(0, 0, 0, 0.85)"))}function ge(){v.a.isOpendoc&&Object(q.d)()}function me(e){var t=function(e){return 0!==e.pageX&&0!==e.pageY};return ve(e)&&t(e)&&(x.a.hasImageChooseStyle()||x.a.hasGalleryChooseStyle())}function ve(e){var t=("IMG"===e.target.tagName?e.target.parentNode:e.target).id;if(t){var n=Object(K.$)("style[data-id=".concat(t,"]"));if($&&n.length&&(1!==n.length||"galleryTempHoverStyle"!==n.attr("id")))return!0}return!1}function be(e){if(!e.shiftKey){var t=e.target,n="IMG"===t.tagName;if(se&&n)return ae?void 0:(ae=!0,void(te=y(e,{hidden:function(){te.destroy(),te=null,ae=!1}})));var i,r=(t&&Array.from(t.classList)||[]).includes("image-container");if(n||r)return $.isContentEditable()&&!me(e)||(i=_e(e.target),ye(i,e),Se(fe.OPEN,i)),Ae(e,t),!1;if(!Object(K.$)(t).parents(".image-container").length){var o=Object(K.$)(t).parents("[id^=magicdomid]").get(0),a=o&&$.domToRep(o);if(a){var s=a.selStart,c=void 0===s?[]:s,l=V()(c,1)[0];if(-1<l)return Me(l,e,this),!1}}}}var ye=function(){var n=f()(h.a.mark(function e(t,n){var i,r,a,o,s,c,l,u=arguments;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=2<u.length&&void 0!==u[2]?u[2]:b.BLOCK_VIEW_TYPE.PICTURE,r=!1,a=we(),o=je(a),s=a.findIndex(function(e){return e.uuid&&e.uuid===t}),de=t,c=function(){var e=f()(h.a.mark(function e(){var o,t,n,i=arguments;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=0<i.length&&void 0!==i[0]&&i[0],t=a.map(function(){var t=f()(h.a.mark(function e(t){var n,i,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.uuid,i=t.src,r={key:n,url:decodeURIComponent(i)},e.t0=o,e.t0)return e.next=6,Object(M.h)(i);e.next=7;break;case 6:r.blob=e.sent;case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),e.next=4,Promise.all(t);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),!v.a.isOpendoc){e.next=24;break}if("outer"===(l=Object(z.b)()).viewer)return e.t0=N.sendOpendocEvent,e.t1=q.c.IMAGE_VIEW,e.next=14,c(l.needBlob);e.next=21;break;case 14:e.t2=e.sent,e.t3=s,e.t4={images:e.t2,index:e.t3},(0,e.t0)(e.t1,e.t4),r=!0,e.next=22;break;case 21:pe();case 22:e.next=34;break;case 24:if(!v.a.isLark||v.a.isLKP||v.a.isInVC){e.next=34;break}return e.t5=_.e,e.next=28,c();case 28:return e.t6=e.sent,e.t7=s,e.t8={images:e.t6,index:e.t7},e.next=33,e.t5.openLarkImageViewer.call(e.t5,e.t8);case 33:r=e.sent;case 34:r||(ae?Oe(t):(ae=!0,(ee=Object(b.createViewer)(o,{initialViewIndex:s<0?0:s,loading:!0,hidden:function(){ae=!1,ee.destroy(),ee=null,ie=!1,ke(),n&&document.body.contains(n.target)&&Ae(n,ne),a.map(function(e){e.blockType&&e.blockType===Y.BlockType.DIAGRAM_BLOCK&&window.URL.revokeObjectURL(e.src)})},report:Ee,errorPlaceholder:W.r,url:function(e){var t=e.getAttribute("data-loaded-src"),n=e.getAttribute("data-src");return t||n||e.src||W.r},highResolutionUrl:function(e){var t=e.getAttribute("data-src"),n=Object(M.p)(t)&&/\/file\/f\//.test(t),i=Object(M.s)(t);return n?t.replace(/\/$/,"~noop"):i?t:null},onImageDataUpdate:function(){ie=!0}},b.MODULE_TYPE.DOC_BODY,i)).show(),window.pcImageViewer=ee));case 35:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),Ee=function(e){e.evtType;var t,n=e.actionType,i=(t={},s()(t,H.UX_ACTION_TYPE.NEXT,1),s()(t,H.UX_ACTION_TYPE.PREV,-1),s()(t,H.UX_ACTION_TYPE.HIDE,null),s()(t,H.UX_ACTION_TYPE.ZOOM_IN,null),s()(t,H.UX_ACTION_TYPE.ZOOM_OUT,null),s()(t,H.UX_ACTION_TYPE.MOVE,null),s()(t,H.UX_ACTION_TYPE.ROTATE,null),s()(t,H.UX_ACTION_TYPE.ORIGINAL_SIZE,null),s()(t,H.UX_ACTION_TYPE.INITIAL_SIZE,null),t);if(void 0!==i[n]){var r=we(),o=r.findIndex(function(e){return e.uuid&&e.uuid===de});if(H.UX_ACTION_TYPE.ZOOM_IN!==n&&H.UX_ACTION_TYPE.ZOOM_OUT!==n&&H.UX_ACTION_TYPE.MOVE!==n&&H.UX_ACTION_TYPE.ROTATE!==n&&H.UX_ACTION_TYPE.ORIGINAL_SIZE!==n&&H.UX_ACTION_TYPE.INITIAL_SIZE!==n){if(i[n]){var a=o+i[n];if(!r[a])return;de=r[a].uuid}else de=null;de||ge(),Se(de?fe.SWITCH:fe.CLOSE,de)}else Te(de)}},Oe=function(t){var e;ee?(de=t,e=we().findIndex(function(e){return e.uuid&&e.uuid===t}),ee.view(e)):ye(t)},Ce=function(e){var t,n,i,r,o=e.actionType,a=e.data;"ImageSync"===o?(n=a.type,i=a.uuid,(r=(t={},s()(t,fe.OPEN,function(){return ye(i)}),s()(t,fe.SWITCH,function(){return Oe(i)}),s()(t,fe.CLOSE,function(){return ee&&ee.hidden()}),t))[n]&&r[n]()):"ImageTransformSync"!==o||void 0!==a.uuid&&a.uuid!==de||(ke(),Ie(a))};function ke(){clearTimeout(re),re=null,oe=0}function Ie(u){re=setTimeout(function(){var e,t,n,i,r,o,a,s,c,l;oe+=1,ie?(e=Object(p.a)(u.imageData),n=(t=u.imageData).left,i=t.top,o=(r=u.containerData).width,a=r.height,c=(s=ee.containerData).width,l=s.height,e.left=n+(c-o)/2,e.top=i+(l-a)/2,ee.imageData=e,ee.renderImage()):oe<10&&Ie(u)},500)}function Se(e,t){e===fe.OPEN?Object(U.b)("follower",{space:t}):e===fe.CLOSE&&Object(U.b)("follower",{space:Object(B.a)(Object(D.g)())}),L.g.emit(R.a,{module:he,actionType:"ImageSync",data:{type:e,uuid:t}}),Te("")}var Te=Object(c.default)(function(e){var t,n;ee&&(t=ee.imageData,n=ee.containerData,L.g.emit(R.a,{module:he,actionType:"ImageTransformSync",data:{uuid:e,imageData:Object(p.a)(t),containerData:Object(p.a)(n)}}))},500);function _e(e){if("IMG"===e.tagName)return e.dataset.uuid;var t=Object(K.$)(e).find("img")[0];return t&&t.dataset&&t.dataset.uuid||null}function we(){var e=null,t=function(e,t){if(v.a.isOpendoc){if("outer"===Object(z.b)().viewer)return/(gallery|image-uploaded)/.test(e)}else if(v.a.isLark&&!v.a.isLKP&&!v.a.isInVC)return/(gallery|image-uploaded)/.test(e);return/(gallery|image-uploaded)/.test(e)||/(dataMetaBlockProps)/.test(e)&&JSON.parse(t).blockType===Y.BlockType.DIAGRAM_BLOCK},n=$.getMatchedAttributePositionOnSelection(e,t).map(function(e){var t={};if("gallery"===e.attrKey)t=e.attrValue&&JSON.parse(e.attrValue);else if("image-uploaded"===e.attrKey){var n=Object(k.c)(e.attrValue);t.items=[n]}else if("dataMetaBlockProps"===e.attrKey){var i=e.attrValue&&JSON.parse(e.attrValue),r=$.plugins.blockPlugin.getBlockById(i.blockId);if(!r||!r.getSvg)return[];try{var o=r.getSvg();if(!o)return[];var a=(a=(new XMLSerializer).serializeToString(o)).replace(/\x08/g,""),s=new Blob([a],{type:"image/svg+xml"});return i.src=URL.createObjectURL(s),i.uuid=i.blockId,[i]}catch(e){return console.log("fail to open viewer for  diagram",e),[]}}return 0<t.items.length&&t.items.forEach(function(e){e.src=Object(M.w)(e)}),t.items});return Object(l.a)(n)}function je(e){var r=document.createElement("div"),o=Object(F.i)($,"imageUpload","getLoadedSrc");return e.forEach(function(e){var t=document.createElement("img"),n=decodeURIComponent(e.src),i=o&&o(e);t.dataset.src=n,t.dataset.uuid=e.uuid,t.dataset.loadedSrc=i||"",r.appendChild(t)}),r}function Me(e,t,n){var i,r,o=t.target,a=$.selection.getPositionForNode(o),s=$.getReps()[a.zone];e<0||e>s.lines.length()-1?Ae(t,n):(i=s.lines.atIndex(e),r=i?i.text.length:0,$.inCallStackIfNecessary("click",function(){$.performSelectionChange(s.zoneId,[e,0],[e,r])}),$.updateBrowserSelectionFromRep())}function Ae(e,t){var n,i,r,o,a,s,c,l;e.preventDefault(),e.stopPropagation(),t&&(n=$.selection.getPositionForNode(e.target),!(i=("IMG"===t.tagName?Object(K.$)(t):Object(K.$)(t).find("img")).attr("data-uuid"))||0!==(r=Object(J.o)({uuid:i},$)).length&&(a=(o=r[0]).start,s=o.end,c={selStart:[a.line,a.offset,a.zoneId],selEnd:[s.line,s.offset,s.zoneId]},l=$.getReps()[n.zone],$.call("galleryImageChoosed",Object(K.$)(e.target).closest(".image-container").attr("id")),Object(u.default)(l.selStart,c.selStart)&&Object(u.default)(l.selEnd,c.selEnd)&&$.inCallStackIfNecessary("click",function(){var e=[c.selEnd[0],c.selEnd[1]+1];$.performSelectionChange(l.zoneId,c.selStart,e)}),$.inCallStackIfNecessary("click",function(){$.performSelectionChange(l.zoneId,c.selStart,c.selEnd)}),l.selStart=c.selStart,l.selEnd=c.selEnd,$.focus(Object(K.$)(".etherpad-container-wrapper").scrollTop()),$.selection.setWithSelection(l.zoneId,l.selStart,l.selEnd,!1),$.updateBrowserSelectionFromRep(!0)))}function Le(){var E,O,C,k,i,r,I,S,T,_,w,j,M,L,R,N=!1,c=!1,D=Object(K.$)("body");function e(e){if($.isContentEditable()){var t=this.getScrollContainer($),n=(I=Object(K.$)(e.target).siblings("img")).parents(".image-uploaded"),i=I.parents(".ace-line");R=t.scrollTop,j=null,_=Object(P.a)(e.target.className.split(" "),function(e){return-1<W.q.indexOf(e)}),S=I.parent().attr("id"),T=[];var r=I.parent().parent().parent().find(".image-container-wrap").toArray(),o=!0,a=!1,s=void 0;try{for(var c,l=r[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=c.value;T.push(u.id)}}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}E=I.width(),O=I.height(),w=n.width(),M=new x.a(I.data("uuid")),N=!0,C=e.pageX,k=e.pageY;for(var d=0,h=[["align-left","left"],["align-center",L="center"],["align-right","right"]];d<h.length;d++){var f=V()(h[d],2),p=f[0],g=f[1];i.hasClass(p)&&(L=g)}i.find(".gallery").hasClass("multi-image")&&(L="left"),["tl","br"].includes(_)?D.addClass("keep-nwse-cursor"):["tr","bl"].includes(_)&&D.addClass("keep-nesw-cursor");try{var m=JSON.parse(n.attr("data-ace-gallery-json")),v=n[0].offsetWidth,b=r.reduce(function(e,t){return e+t.offsetWidth},0);w=E+(v-b-2);var y=m.items.find(function(e){return e.uuid===I[0].dataset.uuid}).scale;y&&(O=E/y)}catch(e){}return e.preventDefault(),!1}}function o(e){var t=e.pageX,n=e.pageY,i=e.target,r=e.scrollTop-R,o=$.dom.zoneOfdom(i);c=!0;var a={width:E,height:O},s={x:t-C,y:n-k+r};if(M.setImageRectByDirection({direction:_,alignment:L,imageSize:a,moveVector:s,imageMaxWidth:w}),!j){for(;i&&i!==document&&(!i.id||!/magicdomid/.test(i.id));)i=i.parentNode;j=i&&i.id}$.hooks.callAll("handleImageResize",{lineKey:j,zoneId:o})}function t(e){var t=this.getScrollContainer($),n=e.target;N&&o({pageX:i,pageY:r,target:n,scrollTop:t.scrollTop})}function n(e){var t=this.getScrollContainer($),n=e.target;i=e.pageX,r=e.pageY,N&&o({pageX:i,pageY:r,target:n,scrollTop:t.scrollTop})}function a(e){j=null,D.removeClass("keep-nwse-cursor"),D.removeClass("keep-nesw-cursor"),Object(K.$)("#".concat(S,"-container-style")).remove(),N=!1,c&&(M.applyImageStyle(S,T),Object(K.$)("#container-wrap-"+S+"-rect-style").remove()),c=!1}return{handleMouseDown:e,handleMouseMove:n,handleMouseUp:a,handleScroll:t}}function Re(e,t){var n,i,r,o,a,s="img-modal-ele",c=e.target.getAttribute("data-src"),l='<img src="'.concat(c,'" id=').concat(s,"/>"),u=document.createElement("div");Object(m.f)()?(i=[],Object(K.$)(".image-container img").each(function(){var e=Object(K.$)(this).attr("data-src");e&&i.push({title:"",src:e})}),T.USE_BLOCK_RENDER&&t.blockRender&&!t.blockRender.allRenderred&&(n=Ne(t.getRep().apool,i.length),i=i.concat(n)),r={title:"",src:c},window.lark.biz.util.openImg({image:r,image_list:i})):(Object(K.$)("#"+s).remove(),o=Object(K.$)(l),u.className="img-modal-container layout-row layout-main-center layout-cross-center",Object(K.$)(u).css({right:0,bottom:0,top:0,left:0,position:"fixed"}),Object(K.$)(u).append(o),Object(K.$)("body").css({overflow:"hidden",height:"100%"}).append(u),a=De(u),Object(K.$)(u).on("touchstart",a),Object(K.$)(u).on("touchend",a),o.on("load",function(){setTimeout(f()(h.a.mark(function e(){var t;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.e("mobile_pinchzoom").then(d.t.bind(null,"Lgpe",7));case 2:t=e.sent,new t.default(o.get(0));case 5:case"end":return e.stop()}},e)})))}))}function Ne(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=e.numToAttrib,r=[],o=0;for(t in i){var a,s,c=i[t];"image-uploaded"===c[0]&&(o<n?o++:(a=/src=([\d\w%.:/]*)/,(s=c[1].match(a))&&r.push({title:"",src:decodeURIComponent(s[1])})))}return r}function De(n){var i;return function(e){var t;"touchstart"===e.type?i=(new Date).getTime():i&&(new Date).getTime()-i<=100&&(Object(K.$)(n).remove(),Object(K.$)("body").css({overflow:"auto",height:"auto"}),t=$.getContainerBox(),Object(K.$)(t).css("padding-bottom","1px"))}}function xe(){return function(e){if(!$.getEditStatus())return e.preventDefault(),e.stopImmediatePropagation(),!1}}function Pe(){var n,i,r=!1,o=function(e,t,n){Object(K.$)(n.getInnerContainer()).blur(),Object(K.$)("body").triggerHandler("innerDomBlur"),Re.call(e,t,n)};return function(e,t){"touchstart"===t.type&&Object(K.$)(t.target).parents(".gallery").length&&(console.log("set timer"),i=setTimeout(function(){e.isEditing()&&Ae(t,t.currentTarget)},100)),"touchstart"===t.type?(r=!1,n=(new Date).getTime()):"touchmove"===t.type?(r=!0,i&&(clearTimeout(i),i=null)):!r&&n&&(new Date).getTime()-n<=100&&(t.preventDefault(),t.isTrigger||(!e.isEditing()||ve(t)?o(this,t,e):Ae(t,t.currentTarget)))}}t.b={handleResizeMove:Object(a.default)(Le,16),handleResizeDown:Le,handleResizeUp:Le,pcImageViewerShown:function(){return!!ee&&ee.isShown},hidePcImageViewer:function(){ee&&ee.hidden()},hiddenPcFullScreenViewer:function(){te&&te.hidden()},handleRemoveImageChoose:function(e){var t="#".concat($.getInnerContainer().id),n=["".concat(t," img"),"".concat(t," .image-container"),"#editbar-text",".viewer-container"];0<Object(K.$)(e.target).closest(n.join(",")).length||x.a.removeImageChooseStyle()},handleMousedown:function(e){var t,n,i,r,o,a,s,c;e.shiftKey&&(e.preventDefault(),e.stopImmediatePropagation(),t=$.selection.getSelStart(),n=$.selection.getPositionForNode(e.target),r=(i=V()(t,2))[0],o=i[1],a=n.line,s=n.col,c=a<r||r===a&&s<o?[n.line,0]:[n.line+1,0],$.selection.setWithSelection("0",t,c,!1),$.updateBrowserSelectionFromRep(!0))},handleDragImage:function(e){var t,n,i;e.preventDefault(),$.isContentEditable()&&(this.dragImageInfo=new C,t=this.dragImageInfo,(n=Object(K.$)(e.target)).parents("#innerdocbody").length&&(t.galleryJSONData=n.closest(".image-uploaded").attr("data-ace-gallery-json"),t.originIndex=t.galleryJSONData&&t.getItemGalleryIndex(e.target),t.galleryJSONData||(t.galleryJSONData=this.compatImageToGallery(n,$),t.compatMode=!0,t.originIndex=0),t.originGallery=t.getGalleryData(),t.originPosition=$.selection.getPositionForNode(e.target),t.cachedGalleryItemData=t.getItems()[this.dragImageInfo.originIndex],t.isDraging=!0,le.windowInnerHeight=window.innerHeight,le.imageSize={width:"".concat(e.target.width,"px"),height:"".concat(e.target.height,"px")},$.plugins.client.disable(),i=Object(K.$)(e.target).closest(".image-container").attr("id"),t.containerId=i,1<t.originGallery.items.length&&$.call("galleryImageChoosed",i),this.updateSelectionToGallery(t),this.initDragCursor(t,e),this.changeOpacity(t,!0),$.call("imageDragged")))},handleDragMove:function(e){if(this.dragImageInfo&&!this.dragImageInfo.isCommitting){this.hideSelectionPopup();var t=this.dragImageInfo;this.scrollIfNeccessary(e,this.dragImageInfo);var n=this.getCursorTarget(t,e);if(n){var i=V()(n,2),r=i[0],o=i[1];if(ue=o,t.isDraging&&Object(K.$)("#innerdocbody").find(r).length){this.removeUnderline();var a,s=$.selection.getPositionForNode(r);if(t.isDropToSameLine=s.line===t.originPosition.line&&s.zone===t.originPosition.zone,t.currentPosition=s,this.isImageLine(s)&&!ue)if(this.isCursorAtBottom(e.originalEvent,r))t.isDropToSameLine&&1<t.originGallery.items.length&&(a=t.currentPosition,t.currentPosition.line=Math.min($.getRep(a.zone).lines.length()-1,a.line)),t.currentGallery=null,t.isDropToSameLine=null,this.removeImageHint(),this.addUnderLineOnNode(r,s);else{var c=this.getDropHintIndex(r,e.originalEvent),l=t.originIndex,u=c;t.isDropToSameLine?l<c&&u--:u=Math.max(u-1,0);var d=Object(K.$)(r).find("img").get(u);if(d&&Object(K.$)(d).attr("data-uuid")===t.originGallery.items[l].uuid)return this.removeImageHint(),void this.stepApplyChangeWhenDrop(t);var h=Object(K.$)(d).closest(".image-uploaded").attr("data-ace-gallery-json")||this.compatImageToGallery(Object(K.$)(d),$);if(t.currentGallery=JSON.parse(h),t.currentGallery.items.length>=W.i&&!t.isDropToSameLine)this.stepApplyChangeWhenDrop(t);else{if(t.currentGallery.items.length<W.i&&!t.isDropToSameLine)t.insertIndex=c;else if(t.isDropToSameLine){if(c-1===t.originIndex||c===t.originIndex)return this.removeImageHint(),void this.stepApplyChangeWhenDrop(t);t.insertIndex=Math.floor(u)}this.removeImageHint(),this.addGalleryHintAtIndex(r,c)}}else this.removeImageHint(),this.addUnderLineOnNode(r,s,ue),t.currentGallery=null}}}},selectTargetImage:function(e){var t,n,i,r,o=Object(J.o)({uuid:e},$);0!==o.length&&(n=(t=o[0]).start,i=t.end,r="image-upload-image-".concat(e),$.call("galleryImageChoosed",r),x.a.addImageChooseStyle(r),$.selection.setSelection({start:n,end:i},!0))},handleDropImage:function(e){var c=this;if(this.dragImageInfo&&!this.dragImageInfo.isCommitting){e.preventDefault();var i,r,t,n,o,a,l,s,u,d,h,f,p,g,O,C,m,k,v,b,y,E,I,S,T,_,w,j,M,L,R,N,D,x,P,B,U,z=16,H=4,F=200;try{this.removeUnderline(),this.hideDragCursor(),this.clearScrollTimer(this.dragImageInfo),this.dragImageInfo.isCommitting=!0,this.holdCommentAttrIfNecessary(this.dragImageInfo),this.changeOpacity(this.dragImageInfo,!1),this.dragImageInfo.isDropToSameLine&&1!==this.dragImageInfo.version?(r=this.dragImageInfo.currentGallery,t=this.dragImageInfo.insertIndex>this.dragImageInfo.originIndex,n=r.items.splice(this.dragImageInfo.originIndex,1)[0],r.items.splice(this.dragImageInfo.insertIndex,0,n),r.items.forEach(function(e,t){c.resetUuidToObject(e),t===c.dragImageInfo.insertIndex&&(o=e.uuid)}),a=this.dragImageInfo.currentPosition,l={line:a.line,zone:a.zone},s=$.getRep(a.zone),u=s.lines.atIndex(a.line),$.callWithAce(function(){var e=[a.line,u.lineMarker],t=[a.line,u.text.length],n=s.attributeManager.getAttributesByKeysOnSelection(["author"],e,t,s);$.performDocumentReplaceRangeWithAttributes(a.zone,e,t," ",n.concat([["gallery",JSON.stringify(r)]]))},"dropImageEvent"),i="drag_left_right",setTimeout(function(){ce?(F=200,c.flexItemAnimation(Object(K.$)("#container-wrap-image-upload-image-".concat(o)).get(0),"in",!0,F,!0,t)):F=0,c.selectTargetImage(o)})):this.dragImageInfo.currentGallery?this.dragImageInfo.currentGallery.items.length<W.i&&(console.log("drop image"),this.dragImageInfo.currentGallery.items.splice(this.dragImageInfo.insertIndex,0,this.dragImageInfo.cachedGalleryItemData),this.dragImageInfo.currentGallery.items.forEach(function(e){c.resetUuidToObject(e)}),d=this.dragImageInfo,h=d.originPosition,f=d.currentPosition,p=$.getRep(f.zone).lines.atIndex(f.line),g=$.getRep(h.zone).lines.atIndex(h.line),l={line:f.line,zone:f.zone},O=this.dragImageInfo.currentGallery.items,C=O.reduce(function(e,t){return e+t.scale},0),k=$.getInnerContainer()["data-last-width"],"0"!==(m=this.dragImageInfo.currentPosition.zone)&&(k=Object(K.$)(".zoneId-"+m)[0].offsetWidth-z),v=function(){var e,t,n=O.length,i=Number.MAX_VALUE,r=null,o=Number.MAX_VALUE,a=!0,s=!1,c=void 0;try{for(var l,u=O[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var d=l.value,h=d.scale/C*(k-H*n),f=h/d.scale;d.currWidth=h+H+"px",d.currHeight=f+"px",d.width=d.currWidth,d.height=d.currHeight,h<i&&(i=h,r=d),f<o&&(o=f)}}catch(e){s=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw c}}if(i<W.m?(e=parseFloat(r.natrualWidth)/parseFloat(r.natrualHeight),t=W.m/e):o<W.m&&(t=W.m),i<W.m||o<W.m){var p=!0,g=!1,m=void 0;try{for(var v,b=O[Symbol.iterator]();!(p=(v=b.next()).done);p=!0){var y=v.value,E=parseFloat(y.natrualWidth)/parseFloat(y.natrualHeight);y.currHeight=y.height=t+"px",y.currWidth=y.width=E*t+H+"px"}}catch(e){g=!0,m=e}finally{try{p||null==b.return||b.return()}finally{if(g)throw m}}}},2===O.length&&v(),2<O.length&&(b=O.reduce(function(e,t){return e+Number.parseFloat(t.currWidth)},0),y=this.dragImageInfo.currentGallery.items[this.dragImageInfo.insertIndex],E=b-Number.parseFloat(y.currWidth),k-E>=W.m+H?(I=k-E-H,y.currWidth=I+H+"px",y.currHeight=I/y.scale+"px",y.width=y.currWidth,y.height=y.currHeight):v()),$.inCallStackIfNecessary("dropImageEvent",function(){var e,t,n,i=[f.line,p.lineMarker],r=[f.line,p.text.length],o=$.getRep(h.zone),a=o.lines.atIndex(h.line),s=o.attributeManager.getAttributesByKeysOnSelection(["author"],[h.line,a.lineMarker],[h.line,a.text.length],o);$.performDocumentReplaceRangeWithAttributes(f.zone,i,r," ",s.concat([["gallery",JSON.stringify(c.dragImageInfo.currentGallery)]])),1===c.dragImageInfo.originGallery.items.length?(e=0<=h.line-1?o.lines.atIndex(h.line-1).text.length:0,t=[h.line-1,e],n=[h.line,g.text.length],$.performDocumentReplaceRangeWithAttributes(h.zone,t,n,""),h.zone===f.zone&&h.line<f.line&&l.line--):1<c.dragImageInfo.originGallery.items.length&&$.spliceGalleryItemsAtLine(h.zone,h.line,c.dragImageInfo.originIndex,1)}),$.once("paint",function(){var e=$.getRep(f.zone).lines.atIndex(l.line).lineNode,t=Object(K.$)(e).find(".image-container")[c.dragImageInfo.insertIndex],n=Object(K.$)(t).attr("id");$.call("galleryImageChoosed",n),i="drag_become_parallel",ce?(F=200,c.flexItemAnimation(t.parentNode,"in",!0,F)):F=0})):!this.dragImageInfo.currentGallery&&this.dragImageInfo.currentPosition&&(S=this.dragImageInfo.originPosition,T=this.dragImageInfo.currentPosition,_=T.line-(ue?1:0),w=S.line,j=$.getRep(T.zone).lines.atIndex(-1===_?0:_),this.resetUuidToObject(this.dragImageInfo.cachedGalleryItemData),this.dragImageInfo.cachedGalleryItemData=Object.assign({},this.dragImageInfo.cachedGalleryItemData,{},le.imageSize),M=JSON.stringify({items:[this.dragImageInfo.cachedGalleryItemData]}),L=this.computeRemoveLineNum(S,T),l={line:_+1,zone:T.zone},1===this.dragImageInfo.originGallery.items.length&&w<_&&S.zone===T.zone&&l.line--,D=(N=(R=$.getRep(S.zone)).lines.atIndex(w)).lineNode,x=N.lineMarker?$.getAttributesOnPosition(S.zone,w,0):[],P=R.attributeManager.getAttributesByKeysOnSelection(["author"],[w,N.lineMarker],[w,N.text.length],R),B=j.lineMarker?$.getAttributesOnPosition(T.zone,_,0):[],1<Object(K.$)(D).find("img").length&&ce?(F=150,U=document.querySelector("#".concat(this.dragImageInfo.containerId)),this.flexItemAnimation(U,"out",!1,F)):F=0,setTimeout(function(){$.callWithAce(function(){$.fastIncorp(!0),_+1===$.getRep(T.zone).alines.length?$.performDocumentReplaceRange(T.zone,[_,j.text.length],[_,j.text.length],"\n"):$.performDocumentReplaceRange(T.zone,[_+1,0],[_+1,0],"\n");var e,t,n,i=B.some(function(e){return"blockquote"===V()(e,1)[0]}),r=x.some(function(e){return"align"===V()(e,1)[0]}),o=$.getContentState().getActiveZone().lines[_+1],a=o&&o.hasLineMarker(),s=[{start:[_+1,a?1:0],end:[_+1,a?1:0],newText:" ",attributes:P.concat([["gallery",M]])}];(i||r)&&(e=x.find(function(e){return"align"===V()(e,1)[0]})||[],(t=B.filter(function(e){var t=V()(e,2),n=t[0];t[1];return"blockquote"===n})).push(e),t.some(function(e){return"lmkr"===V()(e,1)[0]})||t.push(["lmkr","1"]),n={start:[_+1,0],end:[_+1,0],newText:"*",attributes:t},s.unshift(n)),$.performDocumentReplaceMultiRangeWithAttributes(T.zone,s),c.dragImageInfo.compatMode?$.performDelete(L):$.spliceGalleryItemsAtLine(S.zone,L,c.dragImageInfo.originIndex,1)},"dropImageEvent",!0),i="drag_up_down"},F))}catch(e){console.error(e),Object(Z.a)("dragImageEvent Error")}setTimeout(function(){$.plugins.client.enable(),c.collectDragEvent(i);var e=c.dragImageInfo.cachedGalleryItemData.uuid;c.selectTargetImage(e),c.dragImageInfo=null,c.reShowSelectionPopup()},F),this.removeImageHint()}},stepApplyChangeWhenDrop:function(e){e.currentGallery=null,e.isDropToSameLine=null,e.currentPosition=null},holdCommentAttrIfNecessary:function(n){var e,t,i,r,o,a=n.originPosition,s=n.currentPosition;a&&(e=$.getRep(a.zone).lines.atIndex(a.line),t=$.getAttributesOnSelection(a.zone,{selStart:[a.line,0],selEnd:[a.line,e.text.length]},!1),o=[],t.attribs.forEach(function(e){var t=V()(e,2),n=t[0];t[1];-1<n.indexOf("comment-")&&o.push(n)}),n.cachedGalleryItemData.comments=Array.from(new Set(n.cachedGalleryItemData.comments.concat(o))),s&&n.currentGallery&&(i=$.getRep(s.zone).lines.atIndex(s.line),r=$.getAttributesOnSelection(s.zone,{selStart:[s.line,0],selEnd:[s.line,i.text.length]},!1),o=[],r.attribs.forEach(function(e){var t=V()(e,2),n=t[0];t[1];-1<n.indexOf("comment-")&&o.push(n)}),o.length&&n.currentGallery.items.forEach(function(e,t){e.comments=e.comments.concat(o),n.currentGallery.items[t].comments=Array.from(new Set(e.comments))})))},collectDragEvent:function(e){Object(S.default)("client_edit_all_event",{client_edit_all_event_type:"image_edit",client_edit_all_event_subtype:e})},hideSelectionPopup:function(){$.call("hideCommentPopup")},reShowSelectionPopup:function(){$.call("showCommentPopup")},resetUuidToObject:function(e){var t=Object(I.c)(10);$&&$.plugins&&$.plugins.imageUpload.reMarkImageLoadBySsr(e,t),e.uuid=t},updateSelectionToGallery:function(e){$.inCallStackIfNecessary("dropImage",function(){$.performSelectionChange(e.originPosition.zone,[e.originPosition.line,0],[e.originPosition.line,0])}),$.updateBrowserSelectionFromRep()},changeOpacity:function(e,t){var n,i;e.originGallery&&(n=e.originGallery.items[e.originIndex].uuid,i=Object(K.$)("#image-upload-image-".concat(n)),$.getObserver().withoutRecordingMutations(function(){i.css({opacity:t?.5:1}),e.originPosition&&"0"!==e.originPosition.zone&&i.closest(".ace-table-wrapper-outer ").find(".ace-table-toolbars").css({opacity:t?0:""})}))},flexItemAnimation:function(e,t,n,i,r,o){var a=this;$.getObserver().withoutRecordingMutations(function(){r&&a.animteWhenDragLeftRight(e,o,i),e.classList.add("gallery-item-animate-".concat(t))}),n&&setTimeout(function(){$.getObserver().withoutRecordingMutations(function(){e.classList.remove("gallery-item-animate-".concat(t))})},i)},animteWhenDragLeftRight:function(e,t,n){var i=document.createElement("div"),r=e.getAttribute("style");i.setAttribute("style",r),i.setAttribute("class",e.className.concat(" tempGalleryItem")),i.classList.add("gallery-item-animate-out"),t?Object(K.$)(e).closest(".gallery").prepend(i):Object(K.$)(e).closest(".gallery").append(i),setTimeout(function(){$.getObserver().withoutRecordingMutations(function(){i.parentElement.removeChild(i)})},n)},scrollIfNeccessary:function(e,t){var i=this;le.navigationBarHeight||(le.navigationBarHeight=Object(K.$)(".navigation-bar-wrapper").height());var n=le.navigationBarHeight||50,r=Math.max(30,le.windowInnerHeight/10),o=e.originalEvent.pageY-window.pageYOffset,a=le.windowInnerHeight-o<r,s=o-n<r;!a&&!s||t.scrollTimerId||t.isCommitting?a||s||!t.scrollTimerId||(this.removeImageHint(),this.clearScrollTimer(t)):t.scrollTimerId=setInterval(function(){var e,t,n;v.a.isMobile?(e=s?-2:2,window.scrollBy(0,e)):(n=(t=i.getScrollContainer($)).scrollTop,t.scrollTop=s?n-3:n+3),i.removeUnderline()},15)},clearScrollTimer:function(e){e.scrollTimerId&&(window.clearInterval(e.scrollTimerId),e.scrollTimerId=null)},getScrollContainer:function(e){return e&&e.getScrollContainer()},isImageLine:function(e){var t=e.line,n=e.zone,i=$.getRep(n);return Object(j.l)(i,t)},getCursorTarget:function(e,t){var n,o,s=t.originalEvent.pageY-window.pageYOffset,i=t.originalEvent.pageX-window.pageXOffset;if(this.updateDragCursorPos(t.originalEvent.pageX,t.originalEvent.pageY),document.elementsFromPoint)n=document.elementsFromPoint(i,s);else{if(!document.msElementsFromPoint)return console.error("elementsFromPoint"),void Object(Z.a)("elementsFromPoint");n=document.msElementsFromPoint(i,s)}var a=!1,c=function(e,t){var n=$.selection.getPositionForNode(e),i=n.line,r=n.zone,o=$.getRep(r).lines.atIndex(i).text,a=e.getBoundingClientRect();return 1===t&&""===o||Math.abs(s-a.top)<11};return Object(g.a)(n,function(e){if("string"!=typeof e.className)return!0;if(-1<e.className.indexOf("ace-line")){var t,n=Object(K.$)(e).closest(".ace-table-cell");return!n.length||(t=n.find(".ace-line")).first().get(0)===e&&(a=c(t[0],t.length)),o=e,!1}if(-1<e.className.indexOf("ace-table-cell")){var i=Object(K.$)(e).find(".ace-line"),r=i.last().get(0);return 1===i.length&&(a=c(i[0],1)),o=r,!1}}),Object(K.$)(o).find("code").length&&Object(K.$)(o).next().find("code").length||o&&[Q.h.ACE_LINE,Q.h.LINE].some(function(e){return Object(X.f)(o,e)})?null:[o,a]},isCursorInRect:function(e,t,n){return e>n.left&&e<n.right&&t>n.top&&t<n.bottom},addUnderLineOnNode:function(e,t,n){var i,r,o,a,s=t.zone,c=x.a.ace.editorInfo,l=c.getEditStatus(),u=Object(K.$)(e).closest(".ace-line").attr("id");l&&(v.a.isSafari?c.observer.withoutRecordingMutations(function(){n?e.classList.add("tableStyleTopmostLine"):e.classList.add("galleryUnderlineStyle")}):0===Object(K.$)(".underLine-".concat(u)).length&&(i="\n      #innerdocbody #".concat(u,":after {\n        content: ' ';\n        display: block;\n        position: absolute;\n        width: calc(100% - 40px);\n        height: 2px;\n        padding-bottom: 0;\n        background-color: ").concat(w.B500,";\n      }"),r="\n      #innerdocbody #".concat(u," {\n        border-bottom: 2px solid ").concat(w.B500,";\n      }"),o="\n      #innerdocbody #".concat(u," {\n        border-top: 2px solid ").concat(w.B500,";\n      }"),a=v.a.isLark||"0"!==s?r:i,n&&(a=o),Object(K.$)("body").append('\n        <style id="galleryUnderlineStyle" class=\'underLine-'.concat(u,"'>\n        ").concat(a,"\n        .mobile #innerdocbody #").concat(u," {\n          border-width: 2px !important;\n        }\n        </style>\n        "))))},removeUnderline:function(){v.a.isSafari?x.a.ace.editorInfo.observer.withoutRecordingMutations(function(){var e=document.querySelector(".galleryUnderlineStyle, .tableStyleTopmostLine");e&&e.classList.remove("galleryUnderlineStyle","tableStyleTopmostLine")}):Object(K.$)("#galleryUnderlineStyle").remove()},addGalleryHintAtIndex:function(r,o){var e,t=x.a.ace.editorInfo;t.getEditStatus()&&!v.a.isMobile&&(e=!0),e&&t.getObserver().withoutRecordingMutations(function(){var e,t,n,i=r.getElementsByClassName("gallery-drop-hint")[o];i?(i.classList.add("gallery-drop-hint-visible"),e=Object(K.$)(i).closest(".ace-line").find(".image-container-wrap"),Object(g.a)(e,function(e,t){var n=t<o?"left":"right";e.classList.add("gallery-item-scoot-".concat(n))})):(t=r.getElementsByClassName("image-container")[0],n=0===o?"right":"left",t.classList.add("gallery-item-scoot-".concat(n)),t.parentNode.classList.add("compat-gallery-drop-hint-scoot-".concat(n)))})},removeImageHint:function(){$.getObserver().withoutRecordingMutations(function(){var e,t,n,i=document.getElementsByClassName("gallery-drop-hint-visible")[0];i?(i.classList.remove("gallery-drop-hint-visible"),e=Object(K.$)(i).parents(".ace-line").find(".image-container-wrap"),Object(g.a)(e,function(e){e.classList.remove("gallery-item-scoot-left"),e.classList.remove("gallery-item-scoot-right")})):Object(K.$)(".gallery-item-scoot-left").length?((t=Object(K.$)(".gallery-item-scoot-left").get(0)).classList.remove("gallery-item-scoot-left"),t.parentNode.classList.remove("compat-gallery-drop-hint-scoot-left")):Object(K.$)(".gallery-item-scoot-right").length&&((n=Object(K.$)(".gallery-item-scoot-right").get(0)).classList.remove("gallery-item-scoot-right"),n.parentNode.classList.remove("compat-gallery-drop-hint-scoot-right"))})},compatImageToGallery:function(e,t){var n=e.closest(".image-uploaded").attr("class").match(/key=image-[\S]+/),i=n?n[0]:"",r=Object(k.c)(i),o=t.selection.getPositionForNode(e.get(0)),a=t.getAttributesOnPosition(o.zone,o.line,o.col),s=e.get(0).getBoundingClientRect(),c=[];return a.forEach(function(e){var t=e[0];Object(M.o)(t)&&c.push(t)}),JSON.stringify({items:[{attachmentId:"attachment-id-"+r.uuid,type:"image",src:r.src,pluginName:r.pluginName,uuid:r.uuid,naturalWidth:r.width,naturalHeight:r.height,decrypt_key:r.decrypt_key,cdn_url:r.cdn_url,thumbnail_cdn_url:r.thumbnail_cdn_url,webp_thumbnail_cdn_url:r.webp_thumbnail_cdn_url,height:"".concat(s.height,"px"),width:"".concat(s.width,"px"),scale:s.width/s.height,comments:c}]})},isCursorAtBottom:function(e,t){var n=le.cacheRect,i=le.cacheNodeId;(!n||n&&i!==t.id)&&(le.cacheRect=t.getBoundingClientRect(),le.cacheNodeId=t.id);var r=le.cacheRect;return e.pageY<r.bottom&&e.pageY>r.bottom-r.height/10},getDropHintIndex:function(e,t){var n=le.cacheRect,i={x:t.pageX,y:t.pageY},r=Object(K.$)(e).find(".image-uploaded").attr("data-ace-gallery-json"),o=r&&JSON.parse(r),a=n.width,s=n.left,c=Math.max(0,Math.min(i.x-s,a-1));if(o&&1<o.items.length)for(var l=o.items,u=l.length,d=0,h=0;h<l.length;h++){var f=Number.parseFloat(l[h].currWidth);if(c<d+f/2){u=h;break}d+=f}else u=Math.floor(c/a*2);return u},initDragCursor:function(e,t){var n,i,r=document.getElementsByClassName("drag-cursor");r.length?(r[0].setAttribute("style","\n      top: ".concat(t.originalEvent.pageY,"px;\n      left: ").concat(t.originalEvent.pageX,"px;\n    ")),Object(K.$)(r[0]).find("img").attr("src",t.target.src)):((n=document.createElement("div")).className="drag-cursor",(i=new Image).classList.add("gallery-item"),i.setAttribute("unselectable","true"),i.setAttribute("contenteditable","false"),i.setAttribute("style","\n        user-select: none;\n        cursor: auto;\n      "),n.setAttribute("style","\n        top: ".concat(t.originalEvent.pageY,"px;\n        left: ").concat(t.originalEvent.pageX,"px;\n      ")),i.src=t.target.src,n.appendChild(i),document.body.appendChild(n))},updateDragCursorPos:function(e,t){Object(K.$)(".drag-cursor").css({top:t,left:e})},hideDragCursor:function(){var e=document.getElementsByClassName("drag-cursor")[0];e&&e.setAttribute("style","\n      left: -1000px;\n      height: -1000px;\n    ")},reShowDragCursor:function(){Object(K.$)(".drag-cursor").css({display:""})},handleAndroidScroll:function(e){this.dragImageInfo&&this.dragImageInfo.isDraging&&(e.preventDefault(),window.scrollBy(0,0))},computeRemoveLineNum:function(e,t){var n=[e.line,t.line],i=n[0],r=n[1];return e.zone!==t.zone||i<=r?i:i+1},setIsInPresentation:function(e){se=e},unbind:function(){var e=$.getInnerContainer(),t=this.getScrollContainer($);v.a.isMobile?(Object(K.$)(e).off("touchstart",".image-uploaded",this._handleMobileImgTouch),Object(K.$)(e).off("touchmove",".image-uploaded",this._handleMobileImgTouch),Object(K.$)(e).off("touchend",".image-uploaded",this._handleMobileImgTouch)):(Object(K.$)(e).off("click",".image-uploaded",be),Object(K.$)(document).off("dragstart",".image-uploaded",this._handleDragImage),Object(K.$)(document).off("mouseup",this._handleDropImage),Object(K.$)(document).off("mousemove",this._hanldeDragMoveImage),$.off("resetUuid",this.resetUuidToObject),Object(K.$)(e).off("mousedown",".image-uploaded",this._handleMousedown)),Object(K.$)(e).off("click",this.handleRemoveImageChoose),Object(K.$)(document).off("mousemove",this.handleResizeMove),Object(K.$)(document).off("mousedown",".point",this.handleResizeDown),Object(K.$)(document).off("mouseup",this.handleResizeUp),Object(K.$)(document).off("touchmove",this.handleResizeMove),Object(K.$)(document).off("touchstart",".point",this.handleResizeDown),Object(K.$)(document).off("touchend",".point",this.handleResizeUp),Object(K.$)(t).off("scroll",this.handleResizeScroll),Object(K.$)(e).off("paste dragenter dragover dragleave drop",this.modifyHandle),Object(K.$)(document).off("beforeunload unload load",x.a.clearAllImagePreviewer),L.g.off("".concat(R.g,":").concat(he),Ce),this.handleResizeMove.cancel(),this.handleResizeMove=null,this.handleResizeScroll.cancel(),this.handleResizeScroll=null,this.modifyHandle=null,$=null,le={}},bind:function(e){$=e.editorInfo;var t=this.getScrollContainer($),n=Le();this.handleResizeMove=Object(a.default)(n.handleMouseMove.bind(this),16),this.handleResizeDown=n.handleMouseDown.bind(this),this.handleResizeUp=n.handleMouseUp.bind(this),this.handleResizeScroll=Object(a.default)(n.handleScroll.bind(this),16),this.modifyHandle=xe(),this._handleDragImage=this.handleDragImage.bind(this),this._handleMousedown=this.handleMousedown.bind(this),this._hanldeDragMoveImage=Object(a.default)(this.handleDragMove.bind(this),16),this._handleDropImage=this.handleDropImage.bind(this),L.g.on("".concat(R.g,":").concat(he),Ce),Se(fe.CLOSE,null);var i=$.getInnerContainer();v.a.isMobile?(this._handleMobileImgTouch=Pe().bind(this,$),Object(K.$)(i).on("touchstart",".image-uploaded",this._handleMobileImgTouch),Object(K.$)(i).on("touchmove",".image-uploaded",this._handleMobileImgTouch),Object(K.$)(i).on("touchend",".image-uploaded",this._handleMobileImgTouch)):(Object(K.$)(i).on("click",".image-uploaded",be),Object(K.$)(i).on("mousedown",".image-uploaded",this._handleMousedown),Object(K.$)(document).on("dragstart",".image-uploaded",this._handleDragImage),Object(K.$)(document).on("mouseup",this._handleDropImage),Object(K.$)(document).on("mousemove",this._hanldeDragMoveImage),Object(K.$)(t).on("scroll",this.handleResizeScroll),$.on("resetUuid",this.resetUuidToObject)),Object(K.$)(i).on("click",this.handleRemoveImageChoose),Object(K.$)(document).on("mousemove",this.handleResizeMove),Object(K.$)(document).on("mousedown",".point",this.handleResizeDown),Object(K.$)(document).on("touchmove",this.handleResizeMove),Object(K.$)(document).on("touchstart",".point",this.handleResizeDown),Object(K.$)(document).on("touchend",".point",this.handleResizeUp),Object(K.$)(document).on("mouseup",this.handleResizeUp),Object(K.$)(i).on("paste dragenter dragover dragleave drop",this.modifyHandle),Object(K.$)(document).on("beforeunload unload",x.a.clearAllImagePreviewer)},getDragingState:function(){return this.dragImageInfo&&this.dragImageInfo.isDraging}}},"5f2W":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i={owner:null,userPermissions:0,permission:0,ownersWithPerm:[],ownersWithoutPerm:[]}},"5fLR":function(e,t){e.exports=navigator.cdn_host+"/ccm/pc/web/resource/bear/images/image_upload_from_mobile.gif"},"5gSl":function(e,t,n){"use strict";var i=function(e){e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.nativeEvent.stopImmediatePropagation()};t.a=i},"5qEQ":function(e,t,n){"use strict";var i=n("m/+l"),r=n("Wd2d"),o=n("vc5i"),a=n("qYkn"),s=n("5cZX"),c=n("HvQa"),l=n("ZhRG"),u=n("XfSZ"),d=n("jzcD"),h={copyTextWithoutPermission:a.a,updateBusinessStage:c.c},f=function(e){return{token:Object(o.n)(e),haveEditPermission:Object(s.c)(e),otherPermissions:Object(s.u)(e),opendocDirectoryConfig:Object(l.a)(u.a.DIRECTORY)(e),opendocDirectory:Object(l.b)("directory")(e),translated:Object(d.b)(e).status.translated}},p=Object(i.connect)(f,h,null,{withRef:!0})(r.a);t.a=p},"5uCJ":function(e,t,n){},"5wek":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDBweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgNDAgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5UcmlhbmdsZTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSIyLjRfSU3ogYrlpKnpobVf5YWt57G76K+t6Z+z5raI5oGvX+aLluWKqOeKtuaAgSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEzNi4wMDAwMDAsIC0zODMuMDAwMDAwKSIgc3Ryb2tlPSIjMTQxRjMzIiBzdHJva2Utd2lkdGg9IjQiPgogICAgICAgICAgICA8ZyBpZD0iR3JvdXAtNC1Db3B5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMi4wMDAwMDAsIDMyMC4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSJCdWJibGUtMS1Db3B5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MC4wMDAwMDAsIDAuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTMiPgogICAgICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iR3JvdXAtNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjQuMDAwMDAwLCA2My4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yMCwxMS43NzM1OTI1IEw4LjYwODQ5NTI4LDMwIEwzMS4zOTE1MDQ3LDMwIEwyMCwxMS43NzM1OTI1IFoiIGlkPSJUcmlhbmdsZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAuMDAwMDAwLCAyMC4wMDAwMDApIHJvdGF0ZSgtMjcwLjAwMDAwMCkgdHJhbnNsYXRlKC0yMC4wMDAwMDAsIC0yMC4wMDAwMDApICI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},"5ydi":function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"b",function(){return v}),n.d(t,"c",function(){return b}),n.d(t,"a",function(){return y}),n.d(t,"d",function(){return E});var i,r,o=n("lwsE"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("Mpt7"),p=n("658s");(r=i=i||{})[r.NewVersion=1]="NewVersion",r[r.RenameFile=2]="RenameFile",r[r.DeleteVersion=3]="DeleteVersion",r[r.RestoreVersion=4]="RestoreVersion";var g={version:"",edit_uid:"",edit_time:0},m={name:"",size:0,tag:0},v=function(e){function t(){return a()(this,t),c()(this,u()(t).apply(this,arguments))}return h()(t,e),t}(Object(f.Record)(Object.assign({type:i.NewVersion},g,{},m,{data_version:"",is_deleted:!1,user_source:p.a.OTHER}))),b=function(e){function t(){return a()(this,t),c()(this,u()(t).apply(this,arguments))}return h()(t,e),t}(Object(f.Record)(Object.assign({type:i.RenameFile},g,{name:"",source_tag:0}))),y=function(e){function t(){return a()(this,t),c()(this,u()(t).apply(this,arguments))}return h()(t,e),t}(Object(f.Record)(Object.assign({type:i.DeleteVersion},g,{source_tag:0,source_name:""}))),E=function(e){function t(){return a()(this,t),c()(this,u()(t).apply(this,arguments))}return h()(t,e),t}(Object(f.Record)(Object.assign({type:i.RestoreVersion},g,{},m,{source_tag:0,data_version:"",is_deleted:!1})))},"658s":function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{})[r.WEB=0]="WEB",r[r.CLIENT=1]="CLIENT",r[r.ANDRIOD=2]="ANDRIOD",r[r.IOS=3]="IOS",r[r.LARK=4]="LARK",r[r.OTHER=5]="OTHER",r[r.SYNC_DISK=6]="SYNC_DISK",r[r.WPS=7]="WPS"},"69iA":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("zTCG"),c=n("Poi8"),l=function(){function n(e,t){var a=this;r()(this,n),this.editor=e,this.extraClassName=t,this.acePreWriteDomLineHTML=function(e,t){var n;t&&t.info&&((n=t.info.zone)&&Object(c.i)(a.editor,n)&&(t.isPocket=!0))},this.addPocketToLine=function(e,t){var n,i,r=t.lineEntry,o=t.linePocket;a.editor&&r&&((n=r.zone)&&Object(c.i)(a.editor,n)&&(i=a.getIndexFromEntry(r)+1,o.put([{uniqueClass:s.a.CODE_LINE_NUM,mount:function(e){return a.initRender(e,i)}}])))},this.getPocketTypesOfLine=function(e,t){var n=t.lineEntry;if(a.editor&&n){var i=n.zone;if(i&&Object(c.i)(a.editor,i))return s.a.CODE_LINE_NUM}},this.initRender=function(e,t){e.className+=" ".concat(a.extraClassName," ").concat(s.a.CODE_LINE_NUM),e.innerText=String(t)}}return a()(n,[{key:"lineDidUpdate",value:function(e,t){this.updateLines(t.data.lineEntry)}},{key:"lineWillUnmount",value:function(e){this.updateLines(e.lineEntry)}},{key:"processAfterInsertNode",value:function(e,t){this.updateLines(t.entry)}},{key:"getIndexFromEntry",value:function(e){var t=e.lineState;return t?t.index:this.editor.getRep(e.zone).lines.indexOfEntry(e)}},{key:"updateLines",value:function(e){if(e){var t=e.zone;if(t&&Object(c.i)(this.editor,t))for(var n=this.getIndexFromEntry(e),i=this.editor.getRep(t),r=i.lines.length(),o=n;o<r;o++){var a=i.lines.atIndex(o);a&&this.updateLineNum(a,o+1)}}}},{key:"updateLineNum",value:function(e,t){var n;e&&e.lineNode&&((n=e.lineNode.querySelector(".".concat(s.a.CODE_LINE_NUM)))&&(n.innerText=t.toString()))}}]),n}()},"6AXZ":function(e,t,i){"use strict";i.d(t,"b",function(){return o});var r={},n=null;function o(){return n=n||new Promise(function(n,t){i.e("iframe_images").then(i.bind(null,"t4nh")).then(function(e){var t=e.default;Object.keys(t).forEach(function(e){return r[e]=t[e]}),n()},function(e){console.error("load iframe image error",e),t()})})}t.a=r},"6Do3":function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n("o0o1"),a=n.n(i),r=n("pVnL"),s=n.n(r),o=n("yXPU"),c=n.n(o),l=n("q1tI"),u=n.n(l),d=n("i8i4"),h=n.n(d),f=n("D7h9"),p=n("pf04"),g=null;function m(e){return v.apply(this,arguments)}function v(){return(v=c()(a.a.mark(function e(t){var n,i,r,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=function(e){h.a.unmountComponentAtNode(i),t.onClose&&t.onClose(e)},g){e.next=5;break}return e.next=4,Object(p.a)();case 4:g=e.sent.default;case 5:return n=t.boxContainer,i=document.createElement("div"),n.appendChild(i),r=Object.assign({},t,{store:f.default,onClose:o}),e.abrupt("return",new Promise(function(t){var n;h.a.render(u.a.createElement(g,s()({ref:function(e){e&&e.getWrappedInstance&&(n=e.getWrappedInstance()),t(n)}},r)),i)}));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}},"6JVS":function(e,t,n){},"6O0K":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("n/R6"),r=n("SnPR"),o="TOAST_WITH_LOGIN",a="@";function s(e){i.a.remove(o),i.a.error({key:o,closable:!0,content:Object(r.a)(e,a)})}},"6dGb":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"20",height:"20",viewBox:"0 0 20 20"},t),c.a.createElement("path",{d:"M10 8.59l1.41-1.42a1 1 0 111.42 1.42L11.4 10l1.42 1.41a1 1 0 11-1.42 1.42L10 11.4l-1.41 1.42a1 1 0 01-1.42-1.42L8.6 10 7.17 8.59A1 1 0 118.6 7.17L10 8.6zM10 20a10 10 0 110-20 10 10 0 010 20zm0-2a8 8 0 100-16 8 8 0 000 16z",fillRule:"nonzero",fill:"#424E5D"}))}},"6jHd":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"62",height:"62",xmlnsXlink:"http://www.w3.org/1999/xlink"},t),c.a.createElement("defs",null,c.a.createElement("path",{id:"404ac0689f14bedd562f636044c5a684-a",d:"M.86 48.9h51.12V.53H.86z"})),c.a.createElement("g",{transform:"translate(8 8)",fill:"none",fillRule:"evenodd"},c.a.createElement("path",{fill:"#D6DAE1",d:"M.86 41.37h43.18V6.07H.86z"}),c.a.createElement("path",{fill:"#F4F5F9",d:"M37.9 15.04l-3.77 24.24-29.66-4.6 3.77-24.25z"}),c.a.createElement("path",{stroke:"#FFF",strokeWidth:".79",strokeLinecap:"round",strokeLinejoin:"round",d:"M10.85 32.14l2.26-17.51m.69 18.17l2.25-17.52"}),c.a.createElement("path",{d:"M51.64 35.94a15.18 15.18 0 11-30.08-4.1 15.18 15.18 0 0130.08 4.1",fill:"#FFDDDB"}),c.a.createElement("path",{d:"M30.67 27.96l11.57 11.57m0-11.57L30.67 39.53",stroke:"#EE5050",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:".71"}),c.a.createElement("mask",{id:"404ac0689f14bedd562f636044c5a684-b",fill:"#fff"},c.a.createElement("use",{xlinkHref:"#404ac0689f14bedd562f636044c5a684-a"})),c.a.createElement("path",{fill:"#B5BEC8",mask:"url(#404ac0689f14bedd562f636044c5a684-b)",d:"M.86 6.32h12.9V.54H.86z"})))}},"6pAE":function(e,P,B){"use strict";(function(b){B.d(P,"a",function(){return x});var e=B("J4zp"),l=B.n(e),t=B("o0o1"),i=B.n(t),n=B("yXPU"),r=B.n(n),o=B("RIqP"),a=B.n(o),s=B("lwsE"),c=B.n(s),u=B("W8MJ"),d=B.n(u),h=B("3Hq1"),f=B("hbEN"),p=B("UXvI"),g=B("puQj"),m=B.n(g),v=B("HmyT"),y=B("wMxQ"),O=B("TRZa"),C=B("lQZd"),k=B("VI6H"),E=B("H6oK"),I=B("4ngZ"),S=B("D7h9"),T=B("2ACu"),_=B("94ch"),w=B("5gS9"),j=B("QM+C"),M=B("F5vL"),L=B("oJoF"),R=B("kESg"),N=B("+4eN"),D=Object(p.default)(function(e){return Object(T.collectSuiteEvent)("dev_cursor_follow_changeset_list",e)},2e3),x=function(){function n(e,t){var E=this;c()(this,n),this.className="CursorTrack",this.onWindowResize=Object(p.default)(function(){Object.values(E.cursorsViews).forEach(function(e){return e.layout(!0)})},60),this.isReadonly=function(){return!E.editor.getEditStatus()},this.getTotalCursorViews=function(){return Object.keys(E.cursorsViews).reduce(function(e,t){var n=E.cursorsViews[t];return n&&n._cursors?e+Object.keys(n._cursors).length:e},0)},this._sendSelection=function(){var s=[],c=E.editorInfo,n=Object(p.default)(function(e){var t,n,i,r,o,a=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];m.a.mobile||E.isReadonly()||(t=c.getRep(),!e&&Object(O.d)(E.lastSentCursor,t)||Object(O.f)(t)&&(n=t.selStart,i=t.selEnd,r=t.selFocusAtStart,o={type:"ENGAGEMENT_CURSOR",token:Object(C.g)(),memberId:E._getMyMemberId(),cursor_info:{authorId:c.getAuthor(),isActive:a,locationY:0,locationX:0,selZone:t.zoneId,selStart:n,selEnd:i,selFocusAtStart:r}},E.lastSentCursor={selStart:n,selEnd:i,zoneId:t.zoneId,selFocusAtStart:r},s=[],E.editor.plugins.client.sendMessage(o)))},1e3);function e(e,t){return s[0]=s[0]||e,s[1]=s[1]||t,n.apply(void 0,a()(s))}return e.cancel=n.cancel,e},this.aceInitialized=function(e,t){var n=t.editorInfo;E.context.editorInfo=n,E.context.disableLineNum=t.disableLineNum,E.editorInfo=n,E.sendSelection=E._sendSelection(),E._debounceSendSelectionToFixBadCase=Object(f.default)(E.sendSelection,1e3),E.mountCursorsView({el:n.getOuterContainer()}),window.addEventListener("resize",E.onWindowResize),n.on("innerZoneMount",E.mountCursorsView),n.on(L.b,r()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([B.e("doc_index_css"),B.e("chunk_adit"),B.e("commons--doc_index_delay--voteEmoji--votePicker"),B.e(16),B.e("commons--doc_index_delay--jira"),B.e("doc_index_delay")]).then(B.bind(null,"7Go4"));case 2:t=e.sent,E._getAndParseFollowedChangesetListImpl=t.getAndParseFollowedChangesetList;case 4:case"end":return e.stop()}},e)})))},this.mountCursorsView=function(e){var t=e.el,n=e.zoneId,i=void 0===n?"0":n,r=e.className;Object(N.h)(i)&&(t=E.editorInfo.dom.getRootForZone(i)||t);var o=new y.a(Object.assign(E.context,{className:r,isRowMounted:E.isRowMounted.bind(E)}));o.attach(Object(v.$)(t)),E.cursorsViews[i]=o},this.editorSizeChange=function(){try{Object.values(E.cursorsViews).forEach(function(e){return e.layout(!0)})}catch(e){console.log("editor resize change catch",e)}},this.aceSelectionChanged=function(e,t){if(t.editorInfo.flags&&t.editorInfo.flags.contentChanged||!E.isEditorMounted)return!1;E.sendSelection()},this.bufferChanged=function(e,t){try{Object.values(E.cursorsViews).forEach(function(e){return e.layout(!0)})}catch(e){console.log("editor line nodes mounted catch",e)}},this._changesetApply=function(e,t){var n=t.callstack,i=t.isRemote,h=E.selections,f=E.editorInfo,r=Object.keys(h);if(0<r.length){for(var o=Date.now(),p=0,a=E._getAndParseFollowedChangesetList(t),g=a.followedChangesetList,m=a.modifiedZoneMap,s=a.stats,v=E.cursorsViews,c=function(){var o=y[b],e=h[o],a=e.selZone;if(!m.has(a)||!v[a]||v[a].isEmpty())return"continue";var t={chars:e.chars,selFocusAtStart:e.selFocusAtStart},n=g.reduce(function(e,t){var n=t.memberId,i=t.zoneChangesets,r=String(n)===o;return i[a]?(p+=1,E._followSelPosition(i[a],e,r)):e},t),i=n.chars,r=f.selection.lineAndColumnFromChar,s=r(a,i[0]),c=i[0]===i[1]?s:r(a,i[1]),l=Object.assign({selZone:a,selStart:s,selEnd:c},n);h[o]=l;var u=Object(O.a)(l),d=u[0];E._shouldHideCursor(a,d)?v[a].hideCursor(o):v[a].showCursor(o),v[a].updateCursor(o,u,a),f.updateRange(o,a,l)},b=0,y=r;b<y.length;b++)c();m.forEach(function(e,t){var n,i,r=v[t];r&&(n=e.minLine,i=e.memberIdSet,-1!==n&&r.layoutFromLine(n),i.forEach(function(e){return r.activeCursor(e)}))});var l=Date.now()-o;s&&D(Object.assign({},s,{cursorChangesetApplyTotalDuration:l,cursorSelectionCount:r.length,cursorCalcFollowCount:p}))}var u=!i&&n.isCollabChangedSelection;n.docTextChanged&&u&&E._debounceSendSelectionToFixBadCase()},this.changesetApply=function(e,t){try{E.editor.once("paint",function(){setTimeout(function(){E._changesetApply(e,t)})})}catch(e){console.log("cursorTrack apply changeset error",t,e)}},this.invalidMemberId=function(e){return!e||E._getMyMemberId()===e&&(console.error(b("etherpad.received_same_menberId_message")+e),!0)},this.handleImageResize=function(e,t){t.lineKey;var n=t.zoneId;E.cursorsViews[n]&&E.cursorsViews[n].layout(!0)},this.fixPosition=function(e,t){var n=E.editorInfo.getReps()[e].lines,i=n.length(),r=t[0];if(i<=r)return[r=i-1,Math.max(n.atIndex(r).width-1,0)];var o=n.atIndex(r).width;return[r,Math.max(t[1]<o?t[1]:o-1,0)]},this.fixSelection=function(e){var t=E.fixPosition(e.selZone,e.selStart),n=E.fixPosition(e.selZone,e.selEnd),i=!Object(O.c)(t,n)&&e.selFocusAtStart;return{selZone:e.selZone,selStart:t,selEnd:n,selFocusAtStart:i}},this.handleClientMessage_ENGAGEMENT_CURSOR=function(e,t){var n=t.msg;E.invalidMemberId(n.member_id)||E.addUserCursor(n)},this.addUserCursor=function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v=e.member_id+"";Object(k.l)(v)?Object(O.f)(e.cursor_info)&&(n=(t=e.cursor_info).selZone,i=t.selStart,r=t.selEnd,o=t.selFocusAtStart,a=t.isActive,(c=(s=E.editorInfo).getReps()[n])&&0!==c.lines.length()?(l=E.fixSelection({selZone:n,selStart:i,selEnd:r,selFocusAtStart:o}),u=c.lines,l.chars=[u.offsetOfPoint(i[0],i[1]),u.offsetOfPoint(r[0],r[1])],E.selections[v]=l,h=(d=Object(O.a)(l))[0],f=E._shouldHideCursor(n,h),E._shouldHideRange(n,l)?s.removeRange(v,n):s.hasRange(v,n)?s.updateRange(v,n,l):(g=void 0===(p=(Object(k.l)(v)||{}).color_id)?"":p,m=Object(j.getColorById)(g),s.addRange(l,m,v)),E.cursorsViews[n]&&(E.cursorsViews[n].hasCursor(v)||E.cursorsViews[n].addCursor(v,d,n),f?E.cursorsViews[n].hideCursor(v):E.cursorsViews[n].showCursor(v),E.lastZoneOfMembers[v]&&E.lastZoneOfMembers[v]!==n&&E.cursorsViews[E.lastZoneOfMembers[v]]&&E.cursorsViews[E.lastZoneOfMembers[v]].removeCursor(v),E.cursorsViews[n].updateCursor(v,d,n),a&&E.cursorsViews[n].activeCursor(v),E.lastZoneOfMembers[v]=n)):Object(T.collectSuiteEvent)("dev_cursor_plugin",{selZone:n,selStart:i,selEnd:r,selFocusAtStart:o,isActive:a,rev:s.plugins.client.getRev(),isRepExisting:c?1:0})):console.error(b("etherpad.received_not_exist_message")+v)},this.usersInit=function(e,t){t.users.forEach(function(e){e.cursor_info&&E.addUserCursor(e)})},this.handleClientMessage_USER_LEAVE=function(e,t){(t.msg.memberId||t.msg.member_id).forEach(function(e){var t;!e||E.invalidMemberId(e)||Object(h.default)(E.selections[e])||(t=E.selections[e].selZone,E.cursorsViews[t].removeCursor(e),delete E.selections[e],E.editorInfo.removeRange(e,t))})},this.removeUselessCursor=function(e){var t,n=e.members,i=function(t){var e;n.find(function(e){return t===e.member_id})||(e=E.selections[t].selZone,E.cursorsViews[e].removeCursor(t),delete E.selections[t],E.editorInfo.removeRange(t,e))};for(t in E.selections)i(t)},this.reset=function(){for(var e in Object.values(E.cursorsViews).forEach(function(e){return e.detach()}),E.selections){var t=E.selections[e].selZone;E.editorInfo.removeRange(e,t)}E.editorInfo.off("innerZoneMount",E.mountCursorsView),E.editorInfo={},E.context={},E.selections={},E.sendSelection.cancel(),E._debounceSendSelectionToFixBadCase.cancel(),E.onWindowResize.cancel(),window.removeEventListener("resize",E.onWindowResize)},this.fullscreenEntered=function(e){Object.values(E.cursorsViews).forEach(function(e){return e.suspendRendering()})},this.fullscreenExited=function(e){Object.values(E.cursorsViews).forEach(function(e){return e.resumeRendering()})},this.context={},this.selections={},this.lastZoneOfMembers={},this.cursorsViews={},this.isEditorMounted=!1,this._getAndParseFollowedChangesetListImpl=null,e&&(this.editor=e,this.aceInitialized("",Object.assign({editorInfo:e},e,{},t)))}return d()(n,[{key:"_getMyUserName",value:function(){var e=Object(_.a)(S.default.getState()),t=this.editorInfo.getAuthor(),n=e.get(t);return n?n.get("en_name"):""}},{key:"_getMyMemberId",value:function(){return w.b.getInstance().memberId}},{key:"onMount",value:function(){this.isEditorMounted=!0}},{key:"isRowMounted",value:function(e,t){var n=this.editorInfo.blockRender.getLineStatus(e,t);return n&&n.isActive}},{key:"_followSelPosition",value:function(e,t,n){var i=this.editor.changesetHelper,r=t.chars,o=i.characterRangeFollow(e,r[0],r[1],!n),a=l()(o,2),s=a[0],c=a[1];return s===c||n?{selFocusAtStart:!1,chars:[c,c]}:(s=i.characterRangeFollow(e,r[0],r[0]),c=i.characterRangeFollow(e,r[1],r[1],!0),{selFocusAtStart:t.selFocusAtStart,chars:[s[0],c[0]]})}},{key:"_getAndParseFollowedChangesetList",value:function(e){var t=e.extra,n=e.memberId;if(t&&t.changesetList){var i=function(e){if(e.length<=1)return!0;var t=e[0].member_id;return e.every(function(e){return e.member_id===t})},r=t.changesetList,o=t.submittedChanges,a=t.userChanges;if(i(r))n=r[0].member_id;else if(this._getAndParseFollowedChangesetListImpl)return this._getAndParseFollowedChangesetListImpl(this.editor,r,o,a)}var s=this.editor.changesetHelper,c=new Map;return Object(M.b)(c,e.changeset,n),{followedChangesetList:[{memberId:n,zoneChangesets:s.formatCs(e.changeset)}],modifiedZoneMap:c}}},{key:"_shouldHideCursor",value:function(e,t){var n=this._isBlockLine(e,t),i=this._isZoneLine(e,t);return n||i}},{key:"_shouldHideRange",value:function(e,t){var n=l()(t.selStart,1)[0];return n===l()(t.selEnd,1)[0]&&this._isBlockLine(e,n)}},{key:"_isBlockLine",value:function(e,t){var n=this.editorInfo.getRep(e);if(!n.alines)return!1;var i=n.attributeManager.getAllAttributesOnLine(t);if(0<i.filter(function(e){return"sheet-id"===e[0]}).map(function(e){return e[1]}).length)return!0;var r=i.filter(function(e){return e[0]===E.BLOCK_DATA_META_BLOCK_PROPS}).map(function(e){return e[1]}),o=l()(r,1)[0];if(Boolean(o)){var a=JSON.parse(o);return a&&a.props&&a.props.displayMode===E.BlockDisplayMode.INLINE?!1:!0}return!1}},{key:"_isZoneLine",value:function(e,t){var n=this.editorInfo.getRep(e);return!!n.alines&&n.attributeManager.getAllAttributesOnLine(t).some(function(e){var t=l()(e,2),n=t[0],i=t[1];return n===I.d||!(n!==R.k.ZoneType||!R.b.includes(i))})}}]),n}()}).call(this,B("2vAP"))},"716e":function(e,t,n){"use strict";var i,r,o,a;n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),(r=i=i||{}).left="left",r.top="top",r.right="right",r.bottom="bottom",(a=o=o||{}).start="start",a.center="center",a.end="end"},"76Lu":function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("AiBH"),c=n("Hj9z"),l=n("YWBl"),u=n("7Kxq"),d=function(){function t(e){var o=this;r()(this,t),this.editor=e,this.className="LineMenuPollInsert",this.handleInsert=function(e){var t=s.F[s.b.POLL_BLOCK];o.editor.plugins.mention.handleBarBtnClick(s.b.POLL_BLOCK,t,e)},this.handleInsertPollSingle=function(e,t,n,i){var r=i.source;o.handleInsert(c.PollCreator.generateInitData("single")),Object(l.a)({action:"poll",op:u.f,source:r})},this.handleInsertPollMultiple=function(e,t,n,i){var r=i.source;o.handleInsert(c.PollCreator.generateInitData("multiple")),Object(l.a)({action:"poll",op:u.f,source:r})},this.bindEvents()}return a()(t,[{key:"bindEvents",value:function(){this.editor.commands.registerCommand(s.b.POLL_BLOCK_SINGLE,this.handleInsertPollSingle),this.editor.commands.registerCommand(s.b.POLL_BLOCK_MULTIPLE,this.handleInsertPollMultiple)}}]),t}()},"79iT":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n("RIqP"),h=n.n(i),r=n("lSNA"),f=n.n(r),p=n("OIAp"),g=n("chgP"),m=n("nMtL"),v=n("0Hpa"),b=n("njD1"),y=n("5Ucn"),E=n("/2EM"),O=n("bqU8"),C=n("A9Q4"),k=n("bPgG"),I=n("IcLG"),S=n("46iY"),T=n("WtIE"),_=n("TBry"),w=n("3UIW"),j=n("ZuTZ"),M=n("CXkg"),L=n("CJfy"),R=n("QgWq"),N=n("raF6"),D=n("tvAd"),x=n("RooE"),P=n("euE0"),B=n("trzc"),U=n("MEJ+"),z=n("SLR9"),H=n("EIW1"),F=n("gX+J"),V=n("WP/d"),W=n("DKi5"),K=n("mELL"),Z=n("k8MZ"),q=n("CZAk"),Y=n("nyf+"),J=n("jnLa"),Q=n("bf0L"),X=n("OX8E"),o=n("4O8T"),$=n.n(o),ee=n("/kQF"),te=n("LghI"),ne=n("FrgG"),ie=n("EBUI"),re=n("gBrI"),oe=n("qTk9"),ae=n("+I4n"),se=n("4PFL"),ce=n("5UUe"),le=n("KhU0"),ue=n("H6oK"),de=n("Hj9z"),he=n("rLED"),fe=n("gUre"),pe=n("BkG1"),ge=n("PIJw");function a(e,t){var n,i,r=new $.a,o=Object(E.b)({editor:e,eventEmitter:r,newGalleryEnable:Object(he.Q)(),moduleMap:Object(E.a)(),containerCls:e.containerCls,pure:!0}),a=new se.a({editor:e,isInHistory:!0}),s=new ce.a({editor:e,isInHistory:!0}),c=new le.a({editor:e}),l=!(!t||!t.inSideHistory),u=Object(ae.a)(e,{sheetBridgePlugin:a,bitableBridgePlugin:s,mindnoteBridgePlugin:c,historyMode:(n={},f()(n,ue.BlockType.IFRAME_BLOCK,de.HISTORY_MODE.PLACEHOLDER),f()(n,ue.BlockType.POLL_BLOCK,de.HISTORY_MODE.PLACEHOLDER),f()(n,ue.BlockType.JIRA_ISSUE_BLOCK,de.HISTORY_MODE.PLACEHOLDER),f()(n,ue.BlockType.JIRA_FILTER_BLOCK,de.HISTORY_MODE.PLACEHOLDER),f()(n,ue.BlockType.SHEET_BLOCK,de.HISTORY_MODE.PLACEHOLDER),f()(n,ue.BlockType.BITABLE_BLOCK,de.HISTORY_MODE.PLACEHOLDER),f()(n,ue.BlockType.CHAT_CARD_BLOCK,de.HISTORY_MODE.CONTENT),f()(n,ue.BlockType.DIAGRAM_BLOCK,de.HISTORY_MODE.PLACEHOLDER),f()(n,ue.BlockType.MINDNOTE_BLOCK,de.HISTORY_MODE.PLACEHOLDER),f()(n,ue.BlockType.ISV_BLOCK,de.HISTORY_MODE.PLACEHOLDER),n),defaultSupportModules:new Map([].concat(h()(Object(ue.getAllDisableModulesConfig)()),[[ue.PermissionModule,!0],[ue.LoadingModule,!0]])),useSyncRender:!0,options:t,appConfig:l?{concurrency:Number.MAX_VALUE}:{}}),d=[new p.default(e),new g.default(e),new k.a(e),new m.default(e),new w.a(e),new O.c(e),new v.a(e),new fe.a(e),new L.a,new N.a(e),new R.a,new j.a(e),M.b,new b.a(e),new y.HyperLinks({editor:e}),Y.a,o,new C.a(e),Object(J.a)(e),new I.a(e),new S.b(e),new T.b(e),new _.b(e),new D.a(e),new x.b(e),new P.a(e),new B.a(e),new ie.a({editor:e,adaptor:new re.a}),z.c,new U.a(e),new H.a(e),new F.a(e),new V.a(e),new W.a(e),new K.a(e),new Z.a(e),new q.a({editor:e,eventEmitter:X.a}),Q.a,u,a,new ne.a(e),new oe.a(e,{waitForDone:!1})].concat(h()(Object(pe.a)(e,!0)),h()(Object(ge.a)(e)));return Object(te.a)()&&(i=new ee.a(".doc-history-revert__content",""),d.unshift(i)),d}},"7ESD":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=new(function(){function e(){r()(this,e),this.rendererMap={}}return a()(e,[{key:"setupCommentFindProvider",value:function(){var t=this;return this.commentFindProvider?new Promise(function(e){e(t.commentFindProvider)}):n.e("comment_find_provider").then(n.bind(null,"v3vQ")).then(function(e){return t.commentFindProvider=e.commentFindProvider,e.commentFindProvider})}},{key:"setupGlobalCommentFindProvider",value:function(){var t=this;return this.globalCommentFindProvider?new Promise(function(e){e(t.globalCommentFindProvider)}):n.e("g_comment_find_provider").then(n.bind(null,"S5QH")).then(function(e){return t.globalCommentFindProvider=e.globalCommentFindProvider,e.globalCommentFindProvider})}},{key:"triggerFind",value:function(e){this.commentFindProvider&&this.commentFindProvider.triggerFind(e),this.globalCommentFindProvider&&this.globalCommentFindProvider.triggerFind(e)}},{key:"register",value:function(e,t,n,i){this.rendererMap["".concat(e,"-").concat(t,"-").concat(n)]=i}},{key:"unRegister",value:function(e,t,n){delete this.rendererMap["".concat(e,"-").concat(t,"-").concat(n)]}}]),e}())},"7HY0":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("o0o1"),d=n.n(i),r=n("yXPU"),h=n.n(r),o=n("lwsE"),f=n.n(o),a=n("W8MJ"),s=n.n(a),p=n("VN5G"),c=n("paQS"),g=n("wQna"),m=n("QM+C"),l=function(){function u(e){var c=this;f()(this,u),this.wrapperDispatchAction=function(r,o,a){var s=c.requestCommentActions;return r(s.begin(o)),new Promise(function(){var n=h()(d.a.mark(function e(t,n){var i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a();case 3:i=e.sent,r(s.complete(o,i)),t(i),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),n(e.t0),r(s.error(o,e.t0));case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(e,t){return n.apply(this,arguments)}}())},this.requestCommentActions={begin:function(e){return{type:e.type+"_BEGIN",payload:Object.assign({rootType:c.rootType,rootToken:c.rootToken,subCommentToken:c.subCommentToken},e.payload),meta:{previousAction:e}}},complete:function(e,t){var n=e.payload,i=n?Object.assign({},n,{},t):t;return{type:e.type+"_COMPLETE",payload:Object.assign({rootType:c.rootType,rootToken:c.rootToken,subCommentToken:c.subCommentToken},i),meta:{previousAction:e}}},error:function(e,t){return{type:e.type+"_ERROR",error:t,payload:Object.assign({rootType:c.rootType,rootToken:c.rootToken,subCommentToken:c.subCommentToken},e.payload),meta:{previousAction:e}}}};var t,n=e.rootType,i=e.rootToken,r=e.subCommentToken,o=e.enableAutoTranslate,a=e.translateLang,s=e.shouldSetBroadcast,l=e.transEnabled;this.rootType=n,this.rootToken=i,this.subCommentToken=r,this.commentService=Object(p.a)(n,i),m.isAnonymousAccess?s&&(t=g.a.getOrCreate({suiteType:this.rootType,suiteToken:this.rootToken}),this.commentService.setupBroadcast(t)):this.setUpCommentTranslate(o,a,s,l)}return s()(u,[{key:"setUpCommentTranslate",value:function(e,t,n,i){var r;this.commentTranslate=c.a.getOrCreate({suiteType:this.rootType,suiteToken:this.rootToken,subCommentToken:this.subCommentToken,enableAutoTranslate:e,translateLang:t}),n&&(r=!1!==i?(this.commentTranslate=c.a.getOrCreate({suiteType:this.rootType,suiteToken:this.rootToken,subCommentToken:this.subCommentToken,enableAutoTranslate:e,translateLang:t}),this.commentTranslate.getTranslateBroadcast()):(g.a.destroy({suiteType:this.rootType,suiteToken:this.rootToken}),g.a.getOrCreate({suiteType:this.rootType,suiteToken:this.rootToken})),this.commentService.setupBroadcast(r))}},{key:"setCommentTranslateEnableLang",value:function(e,t){this.commentTranslate=c.a.getOrCreate({suiteType:this.rootType,suiteToken:this.rootToken,subCommentToken:this.subCommentToken,enableAutoTranslate:e,translateLang:t}),this.commentTranslate.setCommentTranslateEnableLang(e,t)}},{key:"addTranslateCommentId",value:function(e){this.commentTranslate&&this.commentTranslate.addTranslateCommentId(e)}},{key:"destroy",value:function(){Object(p.b)(this.rootType,this.rootToken,this.subCommentToken)}},{key:"getCommentService",value:function(){return this.commentService}},{key:"getCommentTranslate",value:function(){return this.commentTranslate}}]),u}()},"7I3H":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 48 48"},t),c.a.createElement("path",{d:"M41.18 24a17.18 17.18 0 00-28.53-12.9L10.7 7.74a21 21 0 0131.4 26.92L39.8 30.7v-.01L35.98 24h5.21zM9.96 14.1l3 5.13H7.5a17.2 17.2 0 0030.1 15.27l2.04 3.52A21 21 0 017.9 10.52l2.06 3.57z",fill:"#123",fillRule:"evenodd"}))}},"7Kxq":function(e,t,n){"use strict";n.d(t,"f",function(){return r}),n.d(t,"g",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"e",function(){return l});var i=n("jSUa");n.d(t,"b",function(){return i.a});var r="effective",o="cancel",a="at-uuid_",s="horizontal-line",c=["author","lmkr","lineguid","insertorder"],l={ACE_TABLE:"ACE_TABLE",CODE_BLOCK:"CODE_BLOCK",CALLOUT:"CALLOUT"}},"7NMz":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"12",height:"16",viewBox:"0 0 12 16"},t),c.a.createElement("path",{fill:"none",d:"M1.33 2v12h9.34V2H1.33zM.67.67h10.66c.37 0 .67.3.67.7v13.26c0 .4-.3.7-.67.7H.67a.68.68 0 01-.67-.7V1.37c0-.38.3-.7.67-.7zm2.66 4h1.34a.67.67 0 110 1.33H3.33a.67.67 0 010-1.33zm0 2.66h5.34a.67.67 0 010 1.34H3.33a.67.67 0 010-1.34zm0 2.67h5.34a.67.67 0 010 1.33H3.33a.67.67 0 110-1.33z"}))}},"7P1s":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var o,i=n("lwsE"),r=n.n(i),a=n("W8MJ"),s=n.n(a),c=function(){function e(){r()(this,e),this.delegateHandlersMap={},this.eventHandlerMap={},this.eventOptionMap={},this.id=0}return s()(e,[{key:"genUuid",value:function(){return++this.id}},{key:"delegate",value:function(e,t,n,i){var r={parentSelector:e,childSelector:t,event:n,handler:i,options:4<arguments.length&&void 0!==arguments[4]?arguments[4]:{}},o=this.getEventPath(r),a=this.eventHandlerMap[o],s=this.addHandler(r);return a||this.initEventListener(r),this.removeHandler.bind(this,r,s)}},{key:"initEventListener",value:function(e){var t,n,i=e.parentSelector,r=e.event,o=e.options,a=void 0===o?{}:o,s=document.querySelector(i);s&&(t=this.getEventPath(e),n=this.getEventHandler(e),Object.assign(a,{capture:!0}),this.eventOptionMap[t]=a,s.addEventListener(r,n,a),this.eventHandlerMap[t]=n)}},{key:"getEventHandler",value:function(e){var a=this,s=this.getEventPath(e);return function(t){var e,n=t&&t.target;for(e in a.delegateHandlersMap){var i=e.startsWith(s),r=e.slice(s.length),o=r&&n.matches&&n.matches(r);if(i&&o)return void a.delegateHandlersMap[e].map(function(e){return e&&e.handler}).forEach(function(e){return e&&e(t)})}}}},{key:"addHandler",value:function(e){var t=e.handler,n=this.getDelegatePath(e),i=this.delegateHandlersMap[n]||[],r=this.genUuid();return i.push({id:r,handler:t}),this.delegateHandlersMap[n]=i,r}},{key:"removeHandler",value:function(e,t){var n=this.getDelegatePath(e),i=this.getEventPath(e),r=this.delegateHandlersMap[n];this.delegateHandlersMap[n]=r.filter(function(e){return e.id!==t}),this.isHandlersEmpty(i)&&this.removeEventHandler(e)}},{key:"isHandlersEmpty",value:function(e){if(!e)return!1;var t,n=!0;for(t in this.delegateHandlersMap){var i=this.delegateHandlersMap[t]||[];if(t.startsWith(e)&&0<i.length){n=!1;break}}return n}},{key:"removeEventHandler",value:function(e){var t,n=e.parentSelector,i=e.event,r=this.getEventPath(e),o=this.eventHandlerMap[r],a=document.querySelector(n);a&&o&&(t=this.eventOptionMap[r],a.removeEventListener(i,o,t),this.eventHandlerMap[r]=null,this.eventOptionMap[r]={})}},{key:"getDelegatePath",value:function(e){var t=e.parentSelector,n=e.childSelector;return[t,e.event,n].join("")}},{key:"getEventPath",value:function(e){return[e.parentSelector,e.event].join("")}}]),e}(),l=function(e,t,n,i){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{};return(o=o||new c).delegate(e,t,n,i,r)}},"7ZH0":function(e,t,n){"use strict";var i=n("q1tI"),l=n.n(i),u=n("n/R6"),d=n("Ngi8"),r={show:function(e){var t=e.tip,n=e.type,i=void 0===n?"info":n,r=e.actionText,o=e.handle,a=void 0===o?function(){return null}:o,s=e.positive,c=void 0===s||s;u.a.show({key:"JIRA",type:i,content:l.a.createElement("div",null,c&&l.a.createElement("span",null,t),r&&l.a.createElement("span",{style:{cursor:"pointer",color:d.B500},onClick:a},r),!c&&l.a.createElement("span",null,t))})}};t.a=r},"7pLJ":function(e,t,i){"use strict";i.d(t,"a",function(){return f});var n=i("o0o1"),r=i.n(n),o=i("yXPU"),a=i.n(o),s=i("lwsE"),c=i.n(s),l=i("W8MJ"),u=i.n(l),d=i("1lbP"),h=i("oJoF"),f=function(){function n(e){var t=this;c()(this,n),this.editor=e,this.controller=null,this.rxOp=new d.a,this.editor.on(h.c,function(){return t.loadLimiter()})}function e(){return t.apply(this,arguments)}var t;return u()(n,[{key:"loadLimiter",value:(t=a()(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rxOp.toPromise(Promise.all([i.e("doc_index_css"),i.e("chunk_adit"),i.e("commons--doc_index_delay--voteEmoji--votePicker"),i.e(16),i.e("commons--doc_index_delay--jira"),i.e("doc_index_delay")]).then(i.bind(null,"+iIn")));case 2:t=e.sent,n=t.default,this.controller=new n(this.editor),this.controller.start();case 6:case"end":return e.stop()}},e,this)})),e)},{key:"destroy",value:function(){this.rxOp.destroy(),this.controller&&(this.controller.stop(),this.controller=null)}},{key:"fullscreenEntering",value:function(){this.controller&&this.controller.stop()}},{key:"fullscreenExited",value:function(){this.controller&&this.controller.start()}}]),n}()},"7rIt":function(e,t,n){},"7tiO":function(e,t,n){},"816x":function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var i="image-plugin-upload-trigger-button",r=$("<input name='upload' type='file' multiple='multiple' id='".concat(i,"'  style='display: none' />"));function o(t){0===$("body").find("#".concat(i)).length&&($("body").append(r),t&&r.change(function(e){return t(e),e.target.value="",!1}))}function a(){r&&(r.attr("accept","image/gif, image/jpg, image/jpeg, image/bmp, image/png"),r.trigger("click"))}function s(){var e=$("body").find("#".concat(i));e&&0<e.length&&(e.unbind(),e.remove())}},"85Se":function(e,t,n){},"8Reb":function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("HmyT"),c=n("cDf5"),l=n.n(c),u=n("8dyR"),d=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},h=function(){function e(){r()(this,e),this.queue=new Set}return a()(e,[{key:"add",value:function(e){this.queue.add(e),this.flush()}},{key:"flush",value:function(){var e=this.queue;this.queue=new Set;try{e.forEach(function(e){return e.runGetters()}),e.forEach(function(e){return e.doUpdate()})}finally{e.forEach(function(e){return e.clearCache()})}}}]),e}();d([Object(u.a)()],h.prototype,"flush",null);var f=new h,p=function(){function n(e,t){r()(this,n),this.$node=e,this.queue=t,this.styleToSetMap=new Map,this.styleGetterMap=new Map,this.propCache=new Map}return a()(n,[{key:"css",value:function(e,t){return"function"==typeof t?(this.styleGetterMap.set(e,t),this.styleToSetMap.delete(e)):(this.styleToSetMap.set(e,t),this.styleGetterMap.delete(e)),this.queue.add(this),this}},{key:"width",value:function(){return this.propCache.has(n.WIDTH_KEY)||(this.propCache.set(n.WIDTH_KEY,this.$node.width()),this.queue.add(this)),this.propCache.get(n.WIDTH_KEY)}},{key:"doUpdate",value:function(){var n=this;this.styleToSetMap.forEach(function(e,t){n.$node.css(t,e)})}},{key:"runGetters",value:function(){var n=this;0!==this.styleGetterMap.size&&this.styleGetterMap.forEach(function(e,t){n.styleToSetMap.set(t,e(n.$node))})}},{key:"clearCache",value:function(){this.styleToSetMap.clear(),this.styleGetterMap.clear(),this.propCache.clear()}}]),n}();p.WIDTH_KEY=Symbol("node.width()"),n.d(t,"a",function(){return g});var g=function(){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f;r()(this,i),this.proxies=[];var n=i.styleProxyCache;this.proxies=Array.from(e).map(function(e){return n.has(e)||n.set(e,new p(Object(s.$)(e),t)),n.get(e)})}return a()(i,[{key:"css",value:function(t,n){return this.proxies.forEach(function(e){return e.css(t,n)}),this}},{key:"show",value:function(){return this.proxies.forEach(function(e){return e.css("display","")}),this}},{key:"hide",value:function(){return this.proxies.forEach(function(e){return e.css("display","none")}),this}},{key:"width",value:function(){return 0===this.proxies.length?0:this.proxies[0].width()}}]),i}();g.styleProxyCache=new WeakMap},"8VaN":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i="SET_BOOM_VISIBLE"},"8dyR":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var i=n("QILm"),u=n.n(i),d=n("vJtL");function h(e){var t=!1,n=function(){t||e()};return Promise.resolve().then(n),{cancel:function(){t=!0}}}function f(e,t,n){var i=t.get(e);return t.delete(e),1<i||!n}function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({leading:!1,trailing:!0},e),c=t.leading,l=t.trailing;return function(e,t,n){n.get,n.set;var i=n.value,r=(n.writable,u()(n,["get","set","value","writable"]));if(!Object(d.default)(i))return n;var o=i,a=new WeakMap,s=new WeakMap;return Object.assign({},r,{value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];l&&s.set(this,(s.get(this)||0)+1),a.has(this)?a.get(this).cancel():c&&o.apply(this,n);var r=function(){a.delete(e),l&&f(e,s,c)&&o.apply(e,n)};a.set(this,h(r))}})}}function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({leading:!0,trailing:!0},e),c=t.leading,l=t.trailing;return function(e,t,n){n.get,n.set;var i=n.value,r=(n.writable,u()(n,["get","set","value","writable"]));if(!Object(d.default)(i))return n;var o=i,a=new WeakMap,s=new WeakMap;return Object.assign({},r,{value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];l&&s.set(this,(s.get(this)||0)+1),a.has(this)||(c&&o.apply(this,i),e=function(){a.delete(t),l&&f(t,s,c)&&o.apply(t,i)},a.set(this,h(e)))}})}}},"8hcq":function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("lSNA"),o=n.n(i),r=n("lwsE"),a=n.n(r),s=n("W8MJ"),c=n.n(s),l=n("y2sV"),u="heading",d=function(){function e(){a()(this,e)}return c()(e,[{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement){var r=this.getHeadingType(t);if(r)return Object(l.I)(n,i,o()({},u,r))}return n}},{key:"getHeadingType",value:function(e){var t=/heading (\d+)/.exec(e.dataset.ccpParastyle||"");return t?"h".concat(t[1]):null}}]),e}();new d},"8kCL":function(e,t,n){"use strict";n.d(t,"a",function(){return E});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("O9F5"),c=n("GGin"),l=n("2RY6"),u=n("nN3d"),d=n("OX8E"),h=n("Ngi8"),f=n("Hj9z"),p=n("H6oK"),g=n("kESg"),m=n("4D8z"),v=".block-type-".concat(p.BlockType.ISV_BLOCK);function b(e){return["".concat(e,":not(.canvas-comment):not(.block-comment):not(.").concat(g.e.SPAN,"),\n     ").concat(e,".block-comment .inline-block-placeholder {\n      background-color: ").concat(c.e," !important;\n      border-bottom: 2px solid ").concat(h.Y500," ;\n      padding: 2px 0;\n    }"),"".concat(e,".block-comment:not(.canvas-comment) .block-placeholder:not(.inline-block-placeholder):not(").concat(v,") {\n      outline: 4px solid ").concat(c.e,";\n      border-bottom: none;\n    }"),"".concat(e,".").concat(g.e.SPAN," {\n      padding: 0;\n      border-bottom: none;\n      border-radius: 4px;\n      box-shadow: 0 0 0 4px ").concat(c.e,";\n    }"),".inline-code ".concat(e," {\n      padding-top: 0px !important;\n      padding-bottom: 0px !important;\n      position: relative;\n      border-bottom: 0px !important;\n    }"),".inline-code ".concat(e,":after {\n      content: '';\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: -3px;\n      height: 2px;\n      background: ").concat(h.Y500,";\n    }"),"".concat(e," .").concat(f.RESIZE_MODULE_CLASS," {\n      outline: none !important;\n    }"),"".concat(e," .").concat(f.RESIZE_MODULE_CLASS," .").concat(f.RESIZE_REGION_CLASS," {\n      outline: 6px solid ").concat(c.e,";\n    }"),"".concat(e," .").concat(f.RESIZE_MODULE_CLASS," .").concat(f.RESIZE_REGION_CLASS,":after,\n     ").concat(e,".").concat(g.e.SPAN,"::after,\n     ").concat(e,".block-comment .block-placeholder").concat(m.b.LINK_BOOKMARK,"::after {\n      display: none;\n    }"),"".concat(e," ").concat(v," .block-container {\n      outline: 2px solid ").concat(c.e,";\n      border-color: ").concat(c.e,";\n    }")].map(function(e){return"".concat(l.f," ").concat(e)})}function y(e){var t="2px solid ".concat(h.Y200);return["".concat(e,":not(.canvas-comment):not(.block-comment):not(.").concat(g.e.SPAN,"),\n     ").concat(e,".block-comment .inline-block-placeholder {\n      text-decoration: none;\n      border-bottom: ").concat(t,";\n      padding-bottom: 2px;\n      padding-top: 2px;\n    }"),"".concat(e,".").concat(g.e.SPAN,",\n     ").concat(e,".block-comment .block-placeholder:not(.inline-block-placeholder):not(").concat(v,") {\n      padding-top: 0;\n      padding-bottom: 0;\n      border-bottom: ").concat(t,";\n    }"),"".concat(e,".").concat(g.e.SPAN,",\n     ").concat(e,".block-comment .block-placeholder").concat(m.b.LINK_BOOKMARK," {\n      padding-bottom: 0;\n      border-bottom: 0;\n    }"),"".concat(e,".").concat(g.e.SPAN,"::after,\n     ").concat(e,".block-comment .block-placeholder").concat(m.b.LINK_BOOKMARK,"::after {\n      content: '';\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: -4px;\n      height: 2px;\n      background: ").concat(h.Y200,";\n    }"),".inline-code ".concat(e," {\n      padding-top: 0px !important;\n      padding-bottom: 0px !important;\n      position: relative;\n      border-bottom: 0px !important;\n    }"),".inline-code ".concat(e,":after {\n      content: '';\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: -3px;\n      height: 2px;\n      background: ").concat(h.Y200,";\n    }"),"".concat(e," .").concat(f.RESIZE_MODULE_CLASS," {\n      border-bottom: none !important;\n    }"),"".concat(e," .").concat(f.RESIZE_MODULE_CLASS," .").concat(f.RESIZE_REGION_CLASS,":after {\n      content: '';\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: -6px;\n      height: 2px;\n      background: ").concat(h.Y200,";\n    }"),"".concat(e," ").concat(v," .block-container {\n      border-bottom: ").concat(t,";\n      border-bottom-width: 2px !important;\n    }")].map(function(e){return".maindocbody ".concat(e)})}var E=function(){function e(){r()(this,e),this.highlightedCommentIds=new Map,this.markedCommentIds=new Map}return a()(e,[{key:"removeRulesByCommentId",value:function(e,t){var n=t.get(e);return!!n&&(n.forEach(function(e){s.a.deleteRuleById(e)}),t.delete(e),!0)}},{key:"hasHighlight",value:function(e){return!!this.highlightedCommentIds.get(e)}},{key:"hasCommentMark",value:function(e){return!!this.markedCommentIds.get(e)}},{key:"addCommentMark",value:function(e,t){var i;this.hasCommentMark(e)||(d.a.trigger("updateCommentHighlight",[{commentId:e,actionType:"hasComment",docPositions:t}]),i=[],this.markedCommentIds.set(e,i),y(".comment-local-render-".concat(e)).forEach(function(e,t){var n=Object(u.a)();s.a.insertRule(e,n),i.push(n)}))}},{key:"removeCommentMark",value:function(e,t){this.removeRulesByCommentId(e,this.markedCommentIds)&&d.a.trigger("updateCommentHighlight",[{commentId:e,actionType:"remove",docPositions:t}])}},{key:"addDocHighlight",value:function(e,t){var i;this.hasHighlight(e)||(d.a.trigger("updateCommentHighlight",[{commentId:e,actionType:"focus",docPositions:t}]),i=[],this.highlightedCommentIds.set(e,i),b(".comment-local-render-".concat(e)).forEach(function(e,t){var n=Object(u.a)();s.a.insertRule(e,n),i.push(n)}))}},{key:"removeDocHighlight",value:function(e,t){this.removeRulesByCommentId(e,this.highlightedCommentIds)&&d.a.trigger("updateCommentHighlight",[{commentId:e,actionType:"hasComment",docPositions:t}])}},{key:"addTempDocCommentHighlight",value:function(e){var t=e.commentId;this.hasHighlight(t)||this.addDocHighlight(t,e.docPositions)}},{key:"removeTempDocCommentHighlight",value:function(e){var t=e.commentId,n=e.docPositions;t&&(this.removeRulesByCommentId(t,this.highlightedCommentIds),d.a.trigger("updateCommentHighlight",[{tempCommentId:t,actionType:"remove",docPositions:n}]))}},{key:"addDocHoverHighlight",value:function(e){e.isSubmitted&&this.addDocHighlight(e.commentId,e.docPositions)}},{key:"removeDocHoverHighlight",value:function(e){e.isSubmitted&&this.removeDocHighlight(e.commentId,e.docPositions)}},{key:"removeAllDocHighlight",value:function(){this.highlightedCommentIds.forEach(function(e){e.forEach(function(e){s.a.deleteRuleById(e)})})}},{key:"removeAllCommentMark",value:function(){this.markedCommentIds.forEach(function(e){e.forEach(function(e){s.a.deleteRuleById(e)})})}},{key:"showAllDocHighlight",value:function(){this.highlightedCommentIds.forEach(function(n,e){b(".comment-local-render-".concat(e)).forEach(function(e,t){s.a.insertRule(e,n[t])})})}},{key:"showAllCommentMark",value:function(){this.markedCommentIds.forEach(function(n,e){y(".comment-local-render-".concat(e)).forEach(function(e,t){s.a.insertRule(e,n[t])})})}}]),e}()},"8mZy":function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"i",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return h}),n.d(t,"d",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return m});var s,i,r=n("lSNA"),c=n.n(r),l=n("jp/M"),u=n("QM+C");(i=s=s||{}).Issue="issue",i.Filter="filter";var o=function(e){var t=e.type,n=e.blockToken,i=e.visibleFieldIds,r=e.teaSource,o=e.authState,a=e.baseUrl;return c()({type:l.actionTypes.jira.FETCH_SYNC_JIRA,payload:{type:t,blockToken:n,visibleFieldIds:i,teaSource:r,authState:o,baseUrl:a}},u.REQUEST,{url:t===s.Issue?l.apiUrls.JIRA_ISSUE_SYNC:l.apiUrls.JIRA_FILTER_SYNC,method:l.apiUrls.METHOD.POST,data:{issueID:"",blockToken:n,visibleFieldIds:i}})},a=function(e){return c()({type:l.actionTypes.jira.FETCH_JIRA_ISSUE_INIT_DATA},u.REQUEST,{url:l.apiUrls.JIRA_ISSUE_GET_BY_URL,method:l.apiUrls.METHOD.GET,params:{url:e}})},d=function(){return c()({type:l.actionTypes.jira.FETCH_JIRA_AUTH_STATUS},u.REQUEST,{url:l.apiUrls.FETCH_JIRA_AUTH_STATUS,method:l.apiUrls.METHOD.POST})},h=function(){return{type:l.actionTypes.jira.FETCH_JIRA_AUTH_STATUS_FAIL,payload:{}}},f=function(e){return{type:l.actionTypes.jira.FAKE_SYNC_JIRA_START,payload:{blockToken:e}}},p=function(e){return{type:l.actionTypes.jira.FAKE_SYNC_JIRA_SUCCESS,payload:{blockToken:e}}},g=function(e){return{type:l.actionTypes.jira.FAKE_SYNC_JIRA_FAIL,payload:{blockToken:e}}},m=function(e){return{type:l.actionTypes.jira.FAKE_SYNC_JIRA_END,payload:{blockToken:e}}}},"8qB3":function(e,t,n){"use strict";var i=n("J4zp"),S=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),E=n("3Hq1"),c=n("UXvI"),l=n("hMnB"),L=n.n(l),u=n("YH+F"),O=n("HmyT");function C(t,e,n){var i=e.some(function(e){return Object(u.a)(t,e)});if(n)return i?(Object(O.$)(n).addClass("active"),!0):(Object(O.$)(n).removeClass("active"),!1)}function k(e,t){t?(Object(O.$)(e).removeClass("active"),Object(O.$)(e).addClass("disabled")):Object(O.$)(e).removeClass("disabled")}var I=n("YNKm"),d=n("OZf9"),h=n("/1FC"),T=n("7EGn"),R=n("yEIg"),f=n("/spq"),_=n("2ACu"),w=n("aXiW"),N=n("H6oK"),D=n("FJEn"),j=n("AiBH"),x=n("zhgJ"),P=n("nVH4"),B=n("4D8z"),p=n("cDf5"),g=n.n(p),m=n("Muja"),v=n("q1tI"),b=n.n(v),y=n("D7h9"),M=n("i8i4"),U=n.n(M),z=n("CnBM"),H=n.n(z),F=n("m/+l"),V=n("D28M"),W=n("5ELj"),K=n("OX8E"),Z=n("rWdK"),q=n("kbOD"),Y=n("y2sV"),J=n("Hj9z"),Q=n("ZrCh"),X=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":g()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},$=H()({loader:function(){return Promise.all([n.e("doc_index_css"),n.e(18),n.e(58)]).then(n.bind(null,"LSSq"))},loading:function(){return null}}),ee=function(){function t(e){o()(this,t),this.selStore=null,this.editor=e}return s()(t,[{key:"destroy",value:function(){var e;t.instance&&(this.unbindEvent(),this.toggledBackground(),this.unmountContainer(),this.editor&&(e=this.editor.getScrollTop(),this.editor.focus(e),this.editor=null),this.selectText=void 0,t.instance=null)}},{key:"initContainer",value:function(){var e;this.container||(this.container=document.createElement("div"),(e=document.getElementById("outerdocbody"))&&e.appendChild(this.container))}},{key:"unmountContainer",value:function(){var e;this.container&&(U.a.unmountComponentAtNode(this.container),(e=document.getElementById("outerdocbody"))&&e.removeChild(this.container),this.container=null)}},{key:"bindEvent",value:function(){document.body.addEventListener("mousedown",this.handleMouseDown),this.editor&&this.editor.on("newChanges",this.handleNewChanges)}},{key:"unbindEvent",value:function(){document.body.removeEventListener("mousedown",this.handleMouseDown),this.editor&&this.editor.off("newChanges",this.handleNewChanges)}},{key:"handleMouseDown",value:function(e){Object(V.l)(e.target,"jira-issue-create-popover")||this.hide()}},{key:"handleNewChanges",value:function(){this.render()}},{key:"insertJiraIssueBlock",value:function(){var e,t,n,i,r,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=this.editor;a&&(e=Object(N.generateBlockDataSet)({blockType:N.BlockType.JIRA_ISSUE_BLOCK,creator:J.JiraIssueCreator,props:{viewType:N.ViewTypes.INLINE,displayMode:N.BlockDisplayMode.INLINE},initData:o}),t=this.selStore.selZone,0===(i=this.selStore.selEnd)[0]&&(i=[1,(n=a.getRep().lines.atIndex(1))?n.lineMarker:0]),r={selZone:t,selEnd:i,selStart:i},a.plugins.blockPlugin.insertBlock(e,r))}},{key:"setSelectionStore",value:function(){var e,t=this.editor;t&&(e=t.getRep(),this.selStore={selZone:e.zoneId,selStart:e.selStart,selEnd:e.selEnd})}},{key:"setEditorSelection",value:function(e){var t=e.selZone,n=e.selStart,i=e.selEnd,r=this.editor;r&&(r.selection.setWithSelection(t,n,i,!1),r.version.includes(Y.y)||r.updateBrowserSelectionFromRep())}},{key:"toggledBackground",value:function(){var e,t,n,i=this.editor;i&&(this.isShow&&this.selStore&&this.setEditorSelection(this.selStore),i.inCallStackIfNecessary("jira_add_background",function(){i.toggleAttributeOnSelection("link_background",void 0,void 0,void 0,D.config.LOCAL)}),this.isShow&&this.selStore&&(t=(e=this.selStore).selZone,n=e.selEnd,this.setEditorSelection({selZone:t,selStart:n,selEnd:n}),this.selStore=null))}},{key:"setSelectText",value:function(){var e=this.editor;e&&(this.selectText=Object(q.a)(e,!0).replace(/\n/g,""))}},{key:"closeMentionBox",value:function(){this.setSelectionStore(),K.a.emit("closeMentionBox"),this.setEditorSelection(this.selStore)}},{key:"hide",value:function(){this.destroy(),this.isShow=!1}},{key:"show",value:function(){this.closeMentionBox(),this.toggledBackground(),this.initContainer(),this.setSelectText(),this.render(),this.bindEvent(),this.isShow=!0}},{key:"checkShouldRenderPopover",value:function(){if(!this.isShow)return!0;var e=this.editor,t=this.selStore;if(!e||!t)return!1;var n=e.getRep(),i=t.selZone,r=t.selStart,o=t.selEnd;return n.zoneId!==i||!Object(m.default)(n.selStart,r)||!Object(m.default)(n.selEnd,o)}},{key:"renderConnector",value:function(){var e=function(e){return{jiraAuthStatus:Object(Z.a)(e)}};return Object(F.connect)(e)($)}},{key:"render",value:function(){var e,t,n,i,r;this.checkShouldRenderPopover()&&(this.setSelectionStore(),e=this.insertJiraIssueBlock,(t=this.editor)&&(n={style:Object(Q.b)(t),summary:this.selectText,insertJiraIssueBlock:e,hidePopover:this.hide},i=b.a.createElement(this.renderConnector(),n),r=b.a.createElement(F.Provider,{store:y.default},i),U.a.render(r,this.container)))}}],[{key:"getInstance",value:function(e){return t.instance||(t.instance=new t(e)),t.instance}}]),t}();ee.instance=null,X([Object(W.a)()],ee.prototype,"handleMouseDown",null),X([Object(W.a)()],ee.prototype,"handleNewChanges",null),X([Object(W.a)()],ee.prototype,"insertJiraIssueBlock",null),X([Object(W.a)()],ee.prototype,"hide",null),X([Object(W.a)()],ee.prototype,"show",null);var te,ne=n("jp/M"),ie=n("U6jp"),re=n("iP/4"),oe=n("yFNk"),ae=n("SQ87"),se=n("YWBl"),ce=n("7Kxq"),le=n("DNsP"),ue=n("gq0T"),de=n("+4eN"),he=n("kESg"),fe=n("Guq5");n.d(t,"a",function(){return ye});var pe={RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40},ge=Object.values(pe),me="mindmap_disabled",ve="mindmapDocsEnable",be=function(e,t){return Object(O.$)(".selection-popup [data-key=".concat(t.toLowerCase(),"] button"))},ye=Object(f.a)(["setEventHandlers","aceKeyEvent"])(te=function(){function t(e){var M=this;o()(this,t),this.className="EditBarManager",this.aceInitialized=function(e,t){M.editorInfo=t.editorInfo,M.innerDocBody=Object(O.$)("#innerdocbody"),M.readWrite=!1,M.setEventHandlers()},this.reRenderHandleBarStatus=function(){var e=M.editorInfo.getAttributesOnSelection();e&&e.attribsKey&&M.handleToolbarStatus(M.editorInfo.selection.getZone())},this.handleWindowResize=function(){M.updateLinePopover()},this.updateLinePopover=function(){M.fireCaretLineUpdated(M.editorInfo,!1)},this.triggerBtnCommand=function(e){var t=e.evt,n=e.button,i=e.panelSource,r=e.needMergeCallStack;if("uploader-file-btn"!==t.target.id){var o=Object(O.$)(n).find("button").eq(0),a=Object(O.$)(n).attr("data-key"),s=Object(O.$)(n).attr("data-commandkey")||"",c=Object(O.$)(n).attr("data-commandtype"),l=Object(O.$)(n).attr("data-action");if(!(o.hasClass("hover-trigger")||o.hasClass("disabled")||o.hasClass(me))){var u,d=a===j.b.CHECKBOX&&c?"-button":"";if(Object(w.a)("close_addition_panel").push({action:"click_".concat(a).concat(d)}),"mention"===c){switch(a){case j.b.DRIVE:setTimeout(function(){M.editorInfo.plugins.mention.handleBarBtnClick(a,s,{},t),M.editorInfo.call("editorbar:toggleAButtonVisible",!1)},300);break;case j.b.BITABLE:u={create_source:"toolbar",bitable_view:"grid",field_num:3,record_num:3},Object(w.a)("client_bitable_insert").push(u),Object(_.default)("client_bitable_create",u),K.a.trigger(ne.events.PC.BITABLE.INSERT_GRIDVIEW),M.editorInfo.call("editorbar:toggleAButtonVisible",!1);break;case j.b.KANBAN:u={create_source:"toolbar",bitable_view:"kanban",field_num:3,record_num:3},Object(w.a)("client_bitable_insert").push(u),Object(_.default)("client_bitable_create",u),K.a.trigger(ne.events.PC.BITABLE.INSERT_KANBAN),M.editorInfo.call("editorbar:toggleAButtonVisible",!1);break;case j.b.MINDNOTE:K.a.trigger(ne.events.PC.MINDNOTE.INSERT_MINDNOTE);break;case j.b.JIRA_FILTER_INTRO:u={action:"show_modaldialog",guide_type:"get_feature"},Object(_.default)("jirablock_onboarding",u),M.editorInfo.call("editorbar:showJiraFilterIntro",{});break;default:M.editorInfo.plugins.mention.handleBarBtnClick(a,s,{},t),M.editorInfo.call("editorbar:toggleAButtonVisible",!1)}var h=Object(T.default)(M.editorInfo,"plugins.client");Object(_.default)("toggle_attribute",{rev:h&&h.getRev(),action:l,source:i})}else{var f,p,g,m,v,b,y="comment"===a;a===j.b.INSERTIMAGE||a===j.b.INSERT_IMAGE_OR_VIDEO?setTimeout(function(){M.handleCommand(a,n,y,i),Object(w.a)("client_uploader_image").push({create_source:"toolbar"})},300):a===j.b.EQUATION_BLOCK?(Object(_.default)("toggle_attribute",{action:"insert_tex_block",source:i}),J.equationInsert.insert({editor:M.editorInfo,openInput:!0})):new RegExp(j.b.ISV_BLOCK).test(a)?(f=a.split(":"),p=S()(f,2)[1],Object(_.default)("toggle_attribute",{action:"insert_isv_block",block_type:p,source:i}),Object(J.insertISVBlock)(M.editorInfo,p)):(a!==j.b.LINK&&a!==j.b.INSERTIMAGE_RELAY||M.editorInfo.call("editorbar:toggleAButtonVisible",!1),a!==j.b.JIRA_ISSUE_BLOCK?(a===B.f.DO_MERGE_CELL&&(Object(O.$)(n).find("button").hasClass("active")&&(a=B.f.DO_UN_MERGE_CELL),g=a===B.f.DO_MERGE_CELL?"merge_cells":"unmerge_cells",Object(se.a)({action:g,source:i})),Object(O.$)(":focus").blur(),m="block_menu"===i&&a===j.b.INSERT_CODE_LIST,M.handleCommand(a,n,y,i,r,{extendCodeBlock:m}),"more-btn"===a&&M.editorInfo.focus(void 0,!0)):M.editorInfo&&(ee.getInstance(M.editorInfo).show(),b=(v=M.editorInfo.getRep()).selStart&&v.selEnd&&0===v.selStart[0]&&0===v.selEnd[0]?"title":"text",Object(se.a)({action:"create_jira_issue",op:ce.f,source:i,objectType:b})))}}}},this.handleAPanelBtnClick=function(e){var t=e.currentTarget,n=t&&t.dataset&&t.dataset.key,i=Object(O.$)(t).closest(".editbar-line__popover--type-empty").length?fe.a.A_PANEL:fe.a.BLOCK_MENU,r=Object(O.$)(t).closest(".line-menu--style-btn-list").length;M.editorInfo.inCallStackIfNecessary("APanelTriggerCommand",function(){M.editorInfo.call("editorbar:beforeAPanelTriggerCommand",{dataKey:n,isStyle:r}),M.triggerBtnCommand({evt:e,button:t,panelSource:i,needMergeCallStack:!1}),M.editorInfo.call("editorbar:afterAPanelTriggerCommand",{dataKey:n})},{mergeTarget:"APanelTriggerCommand",mergeEvent:"APanelTriggerCommand"})},this.handleToolbarBtnClick=function(e){var t=e.currentTarget,n="editorbar",i=Object(O.$)(e.currentTarget).parents(".selection-popup");i.length&&i.attr("class").includes("table-cell")&&(n="editorbar_table"),M.triggerBtnCommand({evt:e,button:t,panelSource:n,needMergeCallStack:!1})},this.changesetApply=function(e,t){var n=t.changeset,i=t.editor,r=t.callstack,o=i.changesetHelper,a=r&&r.isCollabChangedSelection,s=i.getRep();if(s.selStart&&s.selEnd){for(var c=S()(s.selStart,2),l=c[0],u=c[1],d=S()(s.selEnd,2),h=d[0],f=d[1],p=s.lines.offsetOfIndex(l)+u,g=s.lines.offsetOfIndex(h)+f,m=o.unpack(n),v=o.opIterator(m[s.zoneId]&&m[s.zoneId].ops),b=!1,y=!1,E=0,O=0;v.hasNext();){var C=v.next(),k=C.lines;E+k<=h&&(b=!0);var I=O+C.chars;I<p||g<O||(y=!0),E+=k,O=I}b&&setTimeout(function(){M.fireCaretLineUpdated(M.editorInfo,a)},0),!i.selection.isCaret()&&y&&M.handleToolbarStatus({source:e,callstackType:r.type}),M.editorInfo.call("editorbar:changesetApply",{changeset:n,isRemote:t.isRemote})}},this.handleDidPaste=function(){M.editorInfo&&M.editorInfo.call("editorbar:toggleAButtonVisible",!1)},this._getLineType=function(e,t){return Object(oe.b)(M.editorInfo,e.zoneId,t)},this._getLinePosition=function(e,t,n,i){var r=e.lines.atIndex(t).lineNode,o=window.getComputedStyle(r),a=parseFloat(o.lineHeight),s=parseFloat(o.paddingTop);if(!Number.isNaN(a)&&!Number.isNaN(s)){var c,l,u,d=r.getBoundingClientRect().top,h=i.getOuterContainer().getBoundingClientRect(),f=h.top,p=h.left,g=a/2-f+s,m={left:-20,top:d+g},v=Object(x.k)(),b=!v||"true"===v.open;n.includes(R.c.ACE_TABLE)&&(c=r.querySelector(".tb-scrollable-content"),l=Object(ae.g)(i.getRect().left),u=c.scrollLeft>l?l:c.scrollLeft,m.left-=u);var y=0;if(![R.c.ALIGN_CENTER,R.c.ALIGN_RIGHT,R.c.BLOCK_QUOTE,R.c.HEADING].some(function(e){return n.includes(e)})&&n.includes(R.c.LIST)){var E=r.querySelector("ol, ul, code");if(!E)return;y=parseInt(getComputedStyle(E).marginLeft),n.includes(R.c.CHECK_LIST)&&(y+=6)}n.includes(R.c.TABLE)&&(b?m.left=M.getPrevCellRightOffsetToContainer(e.zoneId,0!==y):m.left-=20,m.left+=3),m.left+=y,!n.includes(R.c.HEADING)||n.includes(R.c.TABLE)||n.includes(R.c.CODE)||(m.left-=18),n.includes(R.c.CODE)&&(m.top+=3);var O,C,k,I=i.getAttributeOnLine(D.DEFAULT_REP_ZONE,t,N.BLOCK_DATA_META_BLOCK_PROPS),S=I&&Object(N.parseJsonSafely)(I);if(S&&S.blockId){var T,_=i.plugins.blockPlugin.getBlockInfo(S.blockId),w=_&&_.instance;if(w){if(!w.isRendered)return null;!n.includes(R.c.TABLE)&&w.mountPoint&&w.mountPoint.parentElement&&w.mountPoint.parentElement.classList.contains("block-resizable-region")?(T=w.mountPoint.parentElement.getBoundingClientRect(),m.left=T.left-p-30-8,m.top-=10):"SHEET_BLOCK"===w.blockType&&null!=w.rectLeft&&null!=w.leftOffset?(m.top+=2,m.left-=w.rectLeft-30-w.leftOffset):w.mountPoint&&w.mountPoint.firstElementChild&&"placeholder-block"===w.mountPoint.firstElementChild.className?m.top-=21:"JIRA_FILTER_BLOCK"===w.blockType&&(m.top+=17)}}n.includes(R.c.IMAGE)&&(m.top+=8),n.includes(R.c.HEADING)&&n.includes(R.c.ORDER_LIST)&&((C=(O=r.querySelector("li"))&&window.getComputedStyle(O))&&(k=parseFloat(C.lineHeight),Number.isNaN(k)||k===a||(m.top+=(k-a)/2))),n.includes(R.c.HEADING)&&n.includes(R.c.INLINE_CODE)&&(m.top+=3);var j=Object(ie.k)(L.a.href);return j!==ie.b.FEED&&j!==ie.b.ANNOUNCE&&!re.a.isFeed||(m.left+=24),n.includes(R.c.BITABLE)&&(m.top+=12),(n.includes(R.c.BLOCK)||n.includes(R.c.CODE_BLOCK_V2)||n.includes(R.c.CALLOUT_BLOCK))&&(m.top+=8),{relative:m,absolute:Object.assign({},m,{left:m.left+p,top:m.top-g})}}},this.getPrevCellRightOffsetToContainer=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e&&M.editorInfo){var n=Object(O.$)("[data-zone-id=".concat(e,"]"));if(n){var i=n.closest(".tb-scrollable-children").get(0);if(i&&i.parentElement){var r=i.getBoundingClientRect(),o=M.editorInfo.getOuterContainer().getBoundingClientRect(),a=r.left-o.left-60+(t?25:0),s=n.closest("td").get(0);if(!s||!s.previousSibling)return a;var c=n.closest(".tb-scrollable-content").get(0),l=s.getBoundingClientRect(),u=c.getBoundingClientRect();if(l.left>u.right)return a;var d=l.left-o.left-40+(t?5:0);return l.left>r.left+40?d:a}}}},this.fireCaretLineUpdated=function(){},this.aceSelectionChanged=function(e,t){var n,i=t.editorInfo,r=t.callstack;i&&(n=r&&r.isCollabChangedSelection,M.fireCaretLineUpdated(i,n))},this._handleEditorMouseMoveThrottle=Object(c.default)(function(e){M.editorInfo&&M.editorInfo.editable&&M.editorInfo.call("editorbar:updateCaretPosition",{target:Object(V.e)(e.target),x:e.pageX,y:e.pageY,getLineType:M._getLineType,getLinePosition:M._getLinePosition})},50),this.lastMousePos=null,this.handleEditorMouseMove=function(e){var t,n,i=M.lastMousePos;0===e.originalEvent.webkitForce&&i&&i.lastX===e.clientX&&i.lastY===e.clientY||M._handleEditorMouseMoveThrottle(e),0===e.originalEvent.webkitForce&&(t=e.clientX,n=e.clientY,M.lastMousePos={lastX:t,lastY:n})},this.changeHighlightBtnStyle=function(e){var t=Object(ue.e)(e);K.a.emit(le.j,t)},this.handleToolbarStatus=function(){var e,t,n,i,o,a,r,s,c,l,u,d,h,f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},p=f.reps,g=void 0===p?[]:p,m=f.options,v=void 0===m?{}:m,b=f.source,y=(f.callstackType,M.editorInfo);y&&(l={},g.length?g.forEach(function(e){l=Object.assign({},l,{},y.getAttributesOnSelection(e.zoneId,e).attribsKey)}):(e=y.selection.getZone(),n=(t=y.getRep(e)).selStart,i=t.selEnd,v.selection&&(e=v.selection.zoneId,t=y.getRep(e),n=v.selection.selStart,i=v.selection.selEnd),l=t.attributeManager.getAttributesOnSelection(n,i,t).attribsKey),"changesetApply"!==b&&M.changeHighlightBtnStyle(l),o=y.getAllRegistedCommands(),a={},v.popupType===P.d.TABLE_CELL&&("merged"===(r=v.mergeStatus)&&(l["split-cell-true"]=!0),a[B.f.DO_MERGE_CELL]="disabled"===r),s=v.popupType===P.d.IMAGE,c=Object(de.d)(y,[he.l.CodeBlock,he.l.CalloutBlock]),l=Object.assign({},c,{},l),u=!1,Object.keys(o).forEach(function(n){var i,e,r=(o[n].options||{}).statusKey;r&&(i=[I.c,I.a,I.d,I.b].includes(n),(e=document.querySelectorAll(".selection-popup [data-key=".concat(n,"] button"))).length||(e=document.querySelectorAll(".selection-popup [data-key=".concat(n.toLowerCase(),"] button"))),[].forEach.call(e,function(e){var t=r.split(" ");C(l,t,e)&&i&&(u=!0),Object(E.default)(a[n])||k(e,!!a[n])}))}),d=s?"aligncenter":"alignleft",u||!o[d]||(h=be(o[d],d))&&h.addClass("active"),M.hideEditorButtonAfterEnterMindmapDocs())},this.hideEditorButtonAfterEnterMindmapDocs=function(){var r=M.editorInfo.getAllRegistedCommands();Object(d.a)(I.O,function(e,t){var n,i=(e=Object(h.a)(e)?e[0]:e)[ve];void 0===i||i||(n=be(r[t],t),M.enterMindmapDocs?n&&n.addClass(me):n&&n.removeClass(me))});var e,t=be("comment","comment");t.length&&(e=t.parent(".editorbar-btn-wrapper"),M.enterMindmapDocs?(e.addClass(me),e.prev().addClass(me)):(e.removeClass(me),e.prev().removeClass(me)))},this.pluginReadOnly=function(){M.editorInfo.call("editorbar:updateEditable",!1),M.readWrite=!1},this.pluginReadWrite=function(){M.editorInfo.call("editorbar:updateEditable",!0),M.readWrite=!0},this.pluginEnterMindmapDocs=function(){M.enterMindmapDocs=!0},this.pluginExitMindmapDocs=function(){M.enterMindmapDocs=!1},this.reset=function(){M.setEventHandlers(!1),M.editorInfo=null,M.lines=null,M.innerDocBody=null},e&&this.aceInitialized("",Object.assign({editorInfo:e},e))}return s()(t,[{key:"setEventHandlers",value:function(e){var t=!1!==e?"on":"off";Object(O.$)(document)[t]("mousemove",this.handleEditorMouseMove),Object(O.$)(window)[t]("resize",this.handleWindowResize),Object(O.$)(document)[t]("resize",this.reRenderHandleBarStatus),Object(O.$)(document)[t]("click","#editbar [data-key]",this.handleToolbarBtnClick),Object(O.$)(document)[t]("click",".editbar-line-wrapper [data-key]",this.handleAPanelBtnClick),Object(O.$)(document)[t]("click",".outer-editbar-line-wrapper [data-key]",this.handleAPanelBtnClick),Object(O.$)(document)[t]("click",".selection-popup [data-key]",this.handleToolbarBtnClick),this.editorInfo[t]("editorbar:updateToolbarHightlight",this.handleToolbarStatus),this.editorInfo[t]("updateLinePopover",this.updateLinePopover),this.editorInfo[t]("editorbar:keydownTrigger",this.triggerBtnCommand),this.editorInfo[t]("mindmap:entered",this.hideEditorButtonAfterEnterMindmapDocs),this.editorInfo[t]("mindmap:closed",this.hideEditorButtonAfterEnterMindmapDocs),this.editorInfo[t](Y.k.DID_PASTE,this.handleDidPaste)}},{key:"handleCommand",value:function(e,t,n,i){var r=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],o=5<arguments.length?arguments[5]:void 0,a=Object.assign({button:t,source:i,ignoreActiveCaret:n},o);r&&(a.mergeTarget="APanelTriggerCommand",a.mergeEvent="APanelTriggerCommand"),this.editorInfo.triggerCommand(e,a)}},{key:"aceKeyEvent",value:function(e,t){var n=t.evt,i=t.editorInfo,r=document.getElementsByClassName("editbar-line__popover--visible");if(r&&0<r.length&&ge.includes(n.keyCode))return t.preventOtherHooksHandle=!0,n.preventDefault(),!0;var o=[I.eb,I.T,I.p,I.U];if("keydown"===n.type&&this.readWrite){var a=Object(I.gb)(n);if(a&&o.indexOf(a)<0){var s=Object(de.n)(i,t.rep.zoneId),c=he.g[s];if(!c||!c.includes(a))if(i.getAllRegistedCommands()[a]){var l=Object(O.$)("[data-key=".concat(a.toLocaleLowerCase(),"] button"));if(!l.hasClass("disabled")){i.fastIncorp(1);var u={button:l,source:"shortKey",isStopPropagation:!0};return i.triggerCommand(a,u),i.hooks.callAll("aceHotKeyEvent",Object.assign({},t,{name:a})),i.call("editorbar:updatePopOverIcon",a),u.isStopPropagation&&n.stopPropagation(),n.preventDefault(),!0}}}}}}]),t}())||te;new ye},"8wYP":function(e,t,n){"use strict";n.d(t,"c",function(){return L}),n.d(t,"d",function(){return R}),n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return a});var i=n("qAkX"),M="lmkr";function L(e,t){var n=t.numToAttrib;return e.map(function(e){var t=parseInt(e,36);return n[t]||[]})}function R(e,t){var r=t.numToAttrib;return e.reduce(function(e,t){var n=parseInt(t,36),i=r[n];return i&&(e[i[0]]=i[1]),e},{})}function r(e){return e.reduce(function(e,t){return e[t[0]]=t[1],e},{})}function o(e){for(var t=e.changesetHelper,n=e.rep,i=e.selStart,r=e.selEnd,o=e.retainLineMarker,a=void 0!==o&&o,s=n.alines,c=n.lines,l=n.apool,i=i||[0,0],r=r||[s.length-1,c.atIndex(s.length-1).text.length],u=i[0],d=r[0],h=[],f=u;f<=d;f++){for(var p=t.opIterator(s[f]),g=c.atIndex(f),m=f===i[0],v=f===r[0],b=m?i[1]:0,y=v?r[1]:g.text.length,E=0;p.hasNext();){var O=p.next(),C=O.chars,k=O.attribs;if(!((E+=C)<=b)){var I=[f,b],S=void 0,S=y<E?[f,y]:[f,E],T=g.text.slice(b,S[1]),b=E,_=k.split("*").slice(1),w=L(_,l),j=R(_,l);if(!a&&j[M]||h.push({selStart:I,selEnd:S,text:T,attributes:w,attribsNum:_}),y<=b)break}}f!==d&&y===g.text.length&&h.push({selStart:[f,y],selEnd:[f,y],text:"\n",attributes:[],attribsNum:[]})}return h}function a(e,t){var n;return e.hooks&&(n=e.hooks.callAll("collectText",{attributes:t.attributes})),n&&n.length?Object(i.a)(n):t.text}},"8wh8":function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a});var i={},r={},o=function(){return i},a=function(){return r}},"90+h":function(e,t,n){"use strict";n.d(t,"a",function(){return N});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),u=n("Bw5p"),l=n("tAHg"),d=n("4PSP"),h=n("EOrr"),f=n("r0DX"),p=n("mRaX"),g=n("wq9/"),m=n("fUG1"),v=n("q1tI"),b=n.n(v),y=n("i8i4"),E=n.n(y),O=n("D28M"),C=n("f+UN"),k=n("AkIV"),I=n("H6oK"),S=n("kUgE"),T=n("1qho"),_=(n("2Rtb"),n("QM+C")),w=n("FJEn"),j=n("y2sV"),M=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},L="reminder-line-hl",R={TOOLBAR_BTNS:"reminder-toolbar-btns",PLACEHOLDER:"reminder-placeholder"},N=function(){function i(e){var a=this,t=e.editor,n=e.eventEmitter;r()(this,i),this.editable=!1,this.enterFullscreen=!1,this.bling=new T.a({duration:3e3}),this.reuseToolbarPocketLineEntry=[],this.aceShouldPocketReuse=function(e,t){var n=t.oldLineNode,i=t.newLineEntry,r=t.type,o=n.pocket.lineEntry;if(a.isCheckboxEntry(i)&&a.isCheckboxEntry(o))return!!["reminder-toolbar-btns","reminder-placeholder"].includes(r)||void 0},this.addPocketToLine=function(e,t){var n=t.linePocket,i=t.lineEntry;a.isCheckboxEntry(i)&&n.put([{uniqueClass:R.TOOLBAR_BTNS,mount:function(e){E.a.render(b.a.createElement(m.ReminderToolbar),e)},onReuse:function(e){a.reuseToolbarPocketLineEntry.push(e)},unmount:function(e){return E.a.unmountComponentAtNode(e)}},{uniqueClass:R.PLACEHOLDER,mount:function(e){E.a.render(b.a.createElement(m.ReminderPlaceholder),e)},onReuse:function(e,t){a.controller&&e.lineNode&&(a.controller.updateDomLine(t,e.lineNode),a.controller.updatePlaceholder(e.lineNode))},unmount:function(e){return E.a.unmountComponentAtNode(e)}}])},this.getPocketTypesOfLine=function(e,t){var n=t.lineEntry;if(a.isCheckboxEntry(n))return Object.values(R)},this.editor=t,this.controller=new l.a(n),this.reminderController=new h.a(n),this.bindEvents()}return a()(i,[{key:"openEntry",value:function(){return this.editable&&!this.enterFullscreen&&!_.isAnonymousAccess}},{key:"fullscreenEntered",value:function(){this._clearHL(this.hlDom,!0),this.collectBeforeChangeRep(),this.changeOpenEntryStatus("enterFullscreen",!0)}},{key:"fullscreenExited",value:function(){this.changeOpenEntryStatus("enterFullscreen",!1),this._addHL(this.hlDom,!0),this._debounceUpdateRep()}},{key:"pluginReadOnly",value:function(){this.changeOpenEntryStatus("editable",!1,!0)}},{key:"pluginReadWrite",value:function(){this.changeOpenEntryStatus("editable",!0,!0)}},{key:"triggerShowGuide",value:function(){var e,t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.oldLineEntries,r=n.newLineEntries,o=r&&r[0],a=i&&i[0];o&&a&&((e=a.lineNode.firstChild)&&this.isCheckboxDom(e)||!this.isCheckboxEntry(o)||(clearTimeout(this.timeoutId),this.timeoutId=setTimeout(function(){t.showGuide(o.lineNode)},0)))}},{key:"linesWillReplace",value:function(e,t){var n,i,r,o;this.controller&&(n=t.isRemote,i=t.newLineEntries,this.triggerShowGuide(t),n&&(r=this.editor.getRep(),(o=i[0])&&r.selStart&&this.editor.domToRep(o.lineNode).selStart[0]===r.selStart[0]&&this.isCheckboxEntry(o)&&0<o.lineNode.querySelectorAll(".".concat(I.BLOCK_CONTAINER)).length&&this.controller.keyDownEvent({target:o.lineNode,char:"block"})))}},{key:"editorKeyDown",value:function(e,t){var n,i,r,o,a;this.openEntry()&&(n=t.isTypeForCmdKey,i=t.evt,r=t.specialHandled,o=t.rep,n&&i.metaKey&&!Object(k.b)(i)||r||this.controller&&o.selStart&&(a=o.lines.atIndex(o.selStart[0]),this.isCheckboxEntry(a)&&this.controller.keyDownEvent({target:a.lineNode,char:i.key})))}},{key:"toggleEnableClass",value:function(){var e=this.editor.getInnerContainer(),t=Object(O.f)(e,"reminder_enabled");this.openEntry()?t||Object(O.a)(e,"reminder_enabled"):t&&Object(O.p)(e,"reminder_enabled")}},{key:"changeOpenEntryStatus",value:function(e,t){var n=this,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e in this&&(this[e]=t),this.editor.version.includes(j.y)&&!i?this.editor.once("paint",function(){n.toggleEnableClass()}):this.toggleEnableClass()}},{key:"beforeAceSelectionChange",value:function(e,t){var n,i=t.newRep,r=this.editor.getRep();r.selStart&&i.selStart&&(r.zoneId!==i.zoneId||r.selStart[0]!==i.selStart[0])&&((n=document.querySelector("[data-selector=add-reminder]"))&&n.setAttribute("data-selector",""),this.emptyPocketCursorCls(r))}},{key:"aceSelectionChanged",value:function(e,t){var n=this,i=t.rep,r=i.lines.atIndex(i.selEnd[0]);this.isCheckboxEntry(r)?this.editor.selection.isCaret()&&this.showToolbar(r.lineNode,!0):this._clearHL(this.hlDom),this.reuseToolbarPocketLineEntry.forEach(function(e){e&&n.controller&&r!==e&&e.lineNode&&n.controller.hideToolbar(e.lineNode,!0)}),this.reuseToolbarPocketLineEntry.length=0}},{key:"acePreWriteDomLineHTML",value:function(e,t){var n=t.info;n&&(n.lineClass.indexOf("list-checkbox")<0||(t.isPocket=!0))}},{key:"reset",value:function(){this._clearHL(this.hlDom),this.unbindEvents(),this.collectCacheRep=null,this.editor=null,this.bling.destroy(),this.bling=null,this.reuseToolbarPocketLineEntry.length=0,this.controller&&(this.controller.destroy(),this.controller=null),this.reminderController&&(this.reminderController.destroy(),this.reminderController=null)}},{key:"bindEvents",value:function(){this.controller&&(this.controller.onAtUser(this.atUser),this.controller.onGenerateReminder(this.generateReminderBlock),this.controller.onSetReminderProps(this.setReminderProps),this.controller.onShowToolbar(this.showToolbar),this.controller.onHideToolbar(this.hideToolbar),this.controller.onCollectBeforeChangeRep(this.collectBeforeChangeRep),this.controller.onInsertGuide(this.insertGuide),this.reminderController&&(this.reminderController.onClick(this.handleReminderClick),this.reminderController.onMouseEnter(this.handleReminderMouseEnter),this.reminderController.onMouseLeave(this.handleReminderMouseLeave),this.reminderController.onPropsChange(this.handleReminderPropsChange),this.reminderController.onReminderDelete(this.handleReminderDelete)))}},{key:"unbindEvents",value:function(){this.controller&&(this.controller.offAtUser(this.atUser),this.controller.offGenerateReminder(this.generateReminderBlock),this.controller.offSetReminderProps(this.setReminderProps),this.controller.offShowToolbar(this.showToolbar),this.controller.offHideToolbar(this.hideToolbar),this.controller.offCollectBeforeChangeRep(this.collectBeforeChangeRep),this.controller.offInsertGuide(this.insertGuide),this.reminderController&&(this.reminderController.offClick(this.handleReminderClick),this.reminderController.offMouseEnter(this.handleReminderMouseEnter),this.reminderController.offMouseLeave(this.handleReminderMouseLeave),this.reminderController.offPropsChange(this.handleReminderPropsChange),this.reminderController.offReminderDelete(this.handleReminderDelete)))}},{key:"processBeforeInsertNode",value:function(e,t){var n,i,r,o;this.openEntry()&&(n=t.entry,i=t.currentLineIndex,(r=this.editor.getRep()).selStart&&(o=r.selStart[0],void 0!==i&&i===o&&this.isCheckboxEntry(n)?(this._addHL(n.lineNode),this._addClass(n.lineNode)):this._removeClass(n.lineNode)))}},{key:"showGuide",value:function(e){this.controller&&this.controller.showGuide(e)}},{key:"_removeClass",value:function(e){var t=e.querySelector(".ace-line-pocket");t&&Object(O.f)(t,"cursor-in-line")&&Object(O.p)(t,"cursor-in-line")}},{key:"_addClass",value:function(e){var t=e.querySelector(".ace-line-pocket");t&&Object(O.a)(t,"cursor-in-line")}},{key:"emptyPocketCursorCls",value:function(e){var t,n,i=e.lines.atIndex(e.selStart[0]);this.isCheckboxEntry(i)&&(!(t=i.lineNode)||(n=t.querySelector(".ace-line-pocket"))&&Object(O.f)(n,"cursor-in-line")&&(this._removeClass(t),this.controller&&this.controller.hideToolbar(t)))}},{key:"isCheckboxEntry",value:function(e){if(Object(O.f)(e.lineNode,I.IGNORE_LIST_CLASS))return!1;var t=e.lineNode.querySelector("ul");return t?this.isCheckboxDom(t):void 0}},{key:"isCheckboxDom",value:function(e){return Boolean(Object(O.h)(e,["list-done","list-check"]))}},{key:"hideToolbar",value:function(e,t){var n;t&&this.openEntry()&&(n=e,this._isDirtyDom(e)&&(n=this._getSameLine(e)),n&&this._clearHL(n))}},{key:"_isDirtyDom",value:function(e){return!document.querySelector("#".concat(e.id))}},{key:"_getSameLine",value:function(e){var t=Object(O.g)(e,"lineguid");return t?document.querySelector(".".concat(t)):null}},{key:"showToolbar",value:function(e,t){t&&this.openEntry()&&this._addHL(e)}},{key:"_addHL",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.editor.getObserver().withoutRecordingMutations(function(){(n||t.openEntry())&&e&&(t.hlLineKey&&t.hlLineKey===e.id||(t.hlLineKey!==e.id&&t._clearHL(t.hlDom),Object(O.a)(e,L),t.hlLineKey=e.id))})}},{key:"_clearHL",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.editor.getObserver().withoutRecordingMutations(function(){(n||t.openEntry())&&e&&(Object(O.p)(e,L),t.hlLineKey=null)})}},{key:"getReminderPopoverStyle",value:function(e,t){var n=this.editor.getRep(),i=this.getPositionWithReminderId(e,t)||this.getRepPosition(n);return i||{}}},{key:"getPositionWithReminderId",value:function(e,t){var n=document.querySelector("#reminder-block-".concat(e));if(n){var i=Object(p.v)(n,{$boxContainer:$(".reminder"),boxWidth:f.a,horizontalAlign:"center",zoom:Object(g.a)(n,this.editor)});return i.width=f.a,i.height=t,i}}},{key:"setReminderProps",value:function(e,t){var n=this,i=this.editor.getRep(),r=i.selStart,o=i.selEnd,a=i.zoneId;this.reminderController&&this.reminderController.setReminderProps(e,{data:t}),this.editor.once("paint",function(){n.setEditorSelection({selStart:r,selEnd:o,zoneId:a})})}},{key:"getRepPosition",value:function(e){var t=e.lines.atIndex(e.selStart[0]),n=t.getLineRect(),i=t.getCharRect(e.selEnd[1],!1,e.zoneId);return this.getPositionWithLineAndCharRect(n,i)}},{key:"getPositionWithLineAndCharRect",value:function(e,t){var n=e.left+t.left;return{left:n<53?53:n,top:e.top+t.top+t.height/2}}},{key:"insertGuide",value:function(e){var r,t,n,o,a,i,s=e.currentUser,c=this.editor,l=this.editor.getRep();l.selStart&&(r=l.lines.atIndex(l.selStart[0]),t=l.selStart,n=l.selEnd,this.isCheckboxEntry(r)&&(o=t,a=n,c.inCallStackIfNecessary("performSpace",function(){var e;c.fastIncorp(),"*"===r.text&&(e="zh"===Object(S.getLanguage)()?"":"Process mail information. ",c.performDocumentReplaceRangeWithAttributes(c.getRep().zoneId,o,a,e,[["lineguid",Object(p.h)()]]),o=[o[0],o[1]+e.length],a=o);var t=c.plugins.blockPlugin,n=Object(I.generateBlockDataSet)({blockType:I.BlockType.AT_USER_BLOCK,creator:Object(I.getBlockCreator)(I.BlockType.AT_USER_BLOCK,c),props:{data:{mentionNotify:!1,user:Object(u.a)(s,["avatar_url","cn_name","en_name","id","name","type"])}}}),i=t.getAttrsFromBlockDataSet(n);c.performDocumentReplaceRangeWithAttributes(c.getRep().zoneId,o,a," ",i),c.updateBrowserSelectionFromRep(!0)}),i=c.getRep().lines.atIndex(o[0]).lineNode,this.controller&&this.controller.clickAddReminderBtn(i)))}},{key:"atUser",value:function(e){var t,n;this.openEntry()&&(this.updateRepInCell(),t=this.getRepWithLineDom(e),this.setEditorSelection(t),n={editor:this.editor,rep:this.editor.getRep(),source:"reminder"},this.editor.plugins.mention.handleOpenMention(n,{command:"USER"}))}},{key:"getRepWithLineDom",value:function(e){var t,n=this.editor.getRep(),i=Object(O.o)(e,"ace-editor"),r=i&&i.getAttribute("data-zone-id")||w.DEFAULT_REP_ZONE,o=n.selStart[0],a=this.editor.getRep(r).lines.indexOfKey(e.id),s={};return n.zoneId===r&&o===a||(t=this.editor.domToRep(e).selEnd,s.selStart=t,s.selEnd=t,s.zoneId=r),s}},{key:"generateReminderBlock",value:function(e,t,i){var n,r,o=this;this.openEntry()&&(this.updateRepInCell(),n=function(e){var t,n;e.reminderBlockId&&(t=o.calculateHeight(e,"full"),n=o.getReminderPopoverStyle(e.reminderBlockId,t),i(e,n))},r=this.getRepWithLineDom(t),this.setEditorSelection(r),this.reminderController&&this.reminderController.generateBlock({data:e},Object.assign({callback:n},r)))}},{key:"collectBeforeChangeRep",value:function(){var e=this.editor.getRep();this.collectCacheRep={selStart:e.selStart,selEnd:e.selEnd,zoneId:e.zoneId}}},{key:"updateRepInCell",value:function(){this.collectCacheRep&&(this.setEditorSelection(this.collectCacheRep),this.collectCacheRep=null)}},{key:"_debounceUpdateRep",value:function(){this.updateRepInCell()}},{key:"setEditorSelection",value:function(e){e.selStart&&e.selEnd&&(e.selStart=e.selEnd,this.editor.selection.focus(),this.editor.selection.setWithSelection(e.zoneId,e.selStart,e.selEnd,!0),this.editor.selection._updateBrowserSelection(!0))}},{key:"calculateHeight",value:function(e,t){var n=e.userProps,i=e.notCheckboxEntry,r=n?Object.keys(n||{}).length:0,o=0;if("full"===t)return i?o+=2*f.c:r||(o+=f.c),f.d-o;var a=r&&!i?0:f.e;return f.f-a}},{key:"handleReminderClick",value:function(e,t,n){var i,r;!Object(O.l)(n.dom,"mindmap-stage")&&this.openEntry()&&this.controller&&(i=this.calculateHeight(t.data,"full"),r=this.getReminderPopoverStyle(e,i),this.controller.clickReminder(e,t.data,r))}},{key:"handleReminderMouseEnter",value:function(e,t,n){var i,r;this.controller&&(Object(O.l)(n.dom,"doc-history-revert")||Object(O.l)(n.dom,"mindmap-stage")||(i=this.calculateHeight(t.data,"simple"),r=this.getReminderPopoverStyle(e,i),this.controller.hoverReminder(e,t.data,!0,r)))}},{key:"handleReminderMouseLeave",value:function(e,t){this.controller&&this.controller.hoverReminder(e,{},!1,{})}},{key:"handleReminderPropsChange",value:function(e,t){this.controller&&this.controller.propsChange(e,t.data)}},{key:"handleReminderDelete",value:function(e){this.controller&&this.controller.reminderDelete(e)}},{key:"hlDom",get:function(){return this.hlLineKey?document.querySelector("#".concat(this.hlLineKey)):null}}]),i}();M([Object(d.Bind)()],N.prototype,"hideToolbar",null),M([Object(d.Bind)()],N.prototype,"showToolbar",null),M([Object(d.Bind)()],N.prototype,"_addHL",null),M([Object(d.Bind)()],N.prototype,"getReminderPopoverStyle",null),M([Object(d.Bind)()],N.prototype,"setReminderProps",null),M([Object(d.Bind)()],N.prototype,"insertGuide",null),M([Object(d.Bind)()],N.prototype,"atUser",null),M([Object(d.Bind)()],N.prototype,"getRepWithLineDom",null),M([Object(d.Bind)()],N.prototype,"generateReminderBlock",null),M([Object(d.Bind)()],N.prototype,"collectBeforeChangeRep",null),M([Object(C.a)(0)],N.prototype,"_debounceUpdateRep",null),M([Object(d.Bind)()],N.prototype,"handleReminderClick",null),M([Object(d.Bind)()],N.prototype,"handleReminderMouseEnter",null),M([Object(d.Bind)()],N.prototype,"handleReminderMouseLeave",null),M([Object(d.Bind)()],N.prototype,"handleReminderPropsChange",null),M([Object(d.Bind)()],N.prototype,"handleReminderDelete",null)},"90Nm":function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a});var i=n("S5bw"),r=null;function o(){return r=r||new i.a(1)}function a(e){o().next(e)}},"96li":function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{})[r.LOADING=0]="LOADING",r[r.UPLOADING=1]="UPLOADING",r[r.READY=2]="READY",r[r.FAILED=3]="FAILED"},"9BhA":function(e,t,n){"use strict";n.d(t,"g",function(){return o}),n.d(t,"f",function(){return h}),n.d(t,"d",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"a",function(){return g}),n.d(t,"e",function(){return m}),n.d(t,"c",function(){return v});var i=n("hbEN"),a=n("2ACu"),s=n("lG83"),c=n("1dfU"),l=n("mRaX"),u=n("4D8z"),r=n("7Kxq"),d="table",o=Object(i.default)(function(e,t,n,i){Object(a.default)("toggle_attribute",{action:e,eventType:n,object_id:"table_".concat(t),rev:i&&i.getRev()})},200);function h(e,t){Object(a.default)("toggle_attribute",{table_side_is_have_comment:e,block_id:t,block_type:d})}function f(){Object(a.default)(u.u.INSERT_TABLE,{block_id:"",block_type:d,create_source:"paste"})}function p(e){var t=e.from,n=e.rect,i=e.blockId,r=e.fromAPanel,o=e.editor;"shortKey"!==t&&Object(a.default)("confirm_mention",{source:"doc",event_type:"mouseclick",mention_type:Object(s.j)("TABLE"),panel_source:r?"toolbar":"mention_panel",mention_file_type:"",mention_obj_id:Object(c.a)(i),zone:Object(s.l)(),line_is_empty:Object(l.P)(o)}),Object(a.default)(u.u.INSERT_TABLE,{block_id:i,block_type:d,row_num:n.y,col_num:n.x,create_source:r?"toolbar":t})}function g(e,t){Object(a.default)(u.u.REMOVE_TABLE,{block_id:e,block_type:d,source_delete_table:t})}function m(e){var t=e.averageFps,n=e.source,i=e.type;Object(a.default)(i,{source:n,scrollFps:Number(t)})}function v(e){var t=e.lineEntry.getInstanceByName(r.e.ACE_TABLE).getTableId();Object(a.default)(u.u.MOUNT_TABLE,{zone:d,tableId:t})}},"9GRl":function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("cDf5"),u=n.n(l),g=n("3Hq1"),d=n("4PSP"),h=n("l2V6"),f=n("o0o1"),p=n.n(f),m=n("yXPU"),v=n.n(m),b=n("ifKl"),y=n("HmyT"),E=n("OX8E"),O=n("jU1f"),C=n("2ACu"),k=n("hLtC"),I="0",S=function(e,t){var n=e.getRep(I).lines.atIndex(t);return n||t<0&&(n=e.getRep(I).lines.atIndex(0)),n?n.getLineRect().top:void 0},T=function(e,t){var n=e.getRep(I).lines.atIndex(t);if(!n)return 0;var i=n.getCharRect(n.width-1);return i.top+i.height},_=function(e,t){var n=S(e,t);if(!Object(g.default)(n)){var i=T(e,t);return{top:n,height:i,bottom:n+i}}},w=function(e,t,n){var i=n.lineNum,r=n.entryScale,o=n.topLineNum,a=n.topLinePercentage;if(!t)throw Error("scroller is not found");var s=!Object(g.default)(o),c=_(e,s?o:i);if(Object(g.default)(c))throw Error("lineTop is undefined");var l=c.top,u=c.height,d=c.bottom,h=t.offsetHeight;return s?l+u*a:d<h?0:l+u*r-h/2},j=null,M=function(e){e&&clearTimeout(e),e=null},L=function(){var i=v()(p.a.mark(function e(l,u,d){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(o,a){var e=d.lineNum,t=d.topLineNum,n=Object(g.default)(t)?e:t,i=Object(O.c)(l,n);if(!i)return a("selectionRange is null");R(l,n),Object(C.collectSuiteEvent)("vc_doc_position",{selectionRange:JSON.stringify(i)});var r=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:b.default,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:b.default;try{M(e);var r=w(l,u,d);setTimeout(function(){return N(u,r,function(){n(),o()},function(e){i(),a(e)})},16),Object(C.collectSuiteEvent)("vc_doc_position",{scrollTop:r,info:t})}catch(e){a(e)}};try{M(j);var s=setTimeout(function(){l.blockRender.requestRender({async:!1,bufferLine:n}),r(s,"scroll fallback")},2e3);j=s;var c=Object(k.a)(l,"vc-doc-position");l.scrollToSelection(i,{renderAsync:!1,scrollFn:function(){return c(),new Promise(function(e,t){r(s,"editor scroll fn",e,t)})}})}catch(e){a("editor scrollToSelection fail: "+e)}}));case 1:case"end":return e.stop()}},e)}));return function(e,t,n){return i.apply(this,arguments)}}();function R(e,t){var n=e.getRep(I).lines.atIndex(t);if(!n)throw Error("entry is undefined");var i=e.lineTracker.collapseLines&&e.lineTracker.collapseLines.getCollapsedStatusOfLine(I,t);i&&i.renderCollapsed&&!i.startOfCollapseSection&&E.a.emit("invokeCollapse",{dom:n.lineNode,source:"vc"})}function N(e,t,n,i){var r=e.scrollTop,o=222,a=888,s=Math.max(Math.abs(r-t)/3,o);Object(y.$)(e).animate({scrollTop:"".concat(t,"px")},{duration:Math.min(s,a),complete:n,fail:function(){return i("scroll animate fail")}})}function D(e,t,n){var i=_(e,t);if(Object(g.default)(i))return!1;var r=n.scrollTop,o=i.top,a=i.bottom,s=e.getRep(I).lines.length();return 0===t&&1===s||r<=a&&o<=r||a<r&&t===s-1}var x=n("tRMT"),P=n("SyrE"),B=n("Trbk"),U=n("wAsq"),z=n("RQuH"),H=n("bu34");function F(e,t,n,i){var r=i.lineNum,o=i.entryScale,a=i.topLineNum,s=i.topLinePercentage,c=!Object(g.default)(a),l=c?a:r,u=c?s:o,d=S(t,l);if(Object(g.default)(d))return W(e,"lineTop is undefined");var h=d+T(t,l)*u,f=n.scrollTop,p=f+n.offsetHeight;Object(z.a)(h,f-20,p)||0===f&&h<0?V(e):W(e,"expect scroll top is not in view")}function V(e){Object(H.c)(e),Object(C.default)("vcApplyDocScroll",{status:"success"})}function W(e,t){Object(H.a)(e,t),Object(C.default)("vcApplyDocScroll",{status:"fail",info:t})}function K(e,t){Object(H.b)(e,t)}n.d(t,"a",function(){return Y});var Z=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":u()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},q="DocPosition",Y=function(){function t(e){var i=this;a()(this,t),this.editor=e,this.scroll=null,this.positionData={lineNum:0,entryScale:0,topLineNum:0,topLinePercentage:0},this.syncPFPositionToVc=function(e){var t=e.actionType,n=e.data;"Position"===t&&Object(U.b)("presenter",i.calcPosition(n))},this.scroller=e.getScrollContainer(),this.innerContainer=e.getInnerContainer(),Object(x.registerVCModule)({moduleName:q,getCurrentModuleState:function(){return{Position:i.positionData}}}),this.eventBinding("on"),this.scroll=new h.a({editor:e,limit:0,scroller:this.scroller,duration:60,listener:this.sendCurrentDocPosition,immediately:!0,scrollOffset:[0,this.scroller.offsetHeight/2]})}return c()(t,[{key:"reset",value:function(){this.eventBinding("off"),Object(x.unregisterVCModule)(q),this.scroll&&this.scroll.destroy(),this.scroll=null,this.scroller=null,this.innerContainer=null}},{key:"eventBinding",value:function(e){var t=this.editor;t[e]("acceptCommit",this.sendCurrentDocPosition),t[e]("newChanges",this.sendCurrentDocPosition),P.g[e]("".concat(B.g,":").concat(q),this.replayFollowActionHandler),P.g[e]("".concat(B.k,":").concat(q),this.syncPFPositionToVc),Object(C.default)("bind_vc_event",{module:q,operation:e})}},{key:"sendCurrentDocPosition",value:function(e){var t=Array.isArray(e)?e:this.scroll.getLineNumberRange();this.setPositionData(t),P.g.emit(B.i,q),this.logLineIsExpected(),this.sendArrowPosition(),this.sendFeishuReadMeetingPosition()}},{key:"setPositionData",value:function(e){this.positionData.topLineNum=Math.min.apply(Math,r()(e)),this.positionData.lineNum=Math.max.apply(Math,r()(e)),this.positionData.topLinePercentage=this.getLinePercentage(!0),this.positionData.entryScale=this.getLinePercentage(!1)}},{key:"logLineIsExpected",value:function(){this.scroller&&!D(this.editor,this.positionData.topLineNum,this.scroller)&&Object(C.default)("vc_doc_position",{info:"line num is not expected"})}},{key:"sendArrowPosition",value:function(){try{Object(U.b)("follower",this.calcPosition(this.positionData))}catch(e){console.error(e)}}},{key:"sendFeishuReadMeetingPosition",value:function(){var e;this.scroller&&this.innerContainer&&(e=this.innerContainer.offsetHeight-this.scroller.offsetHeight<=0?1:this.scroller.scrollTop/(this.innerContainer.offsetHeight-this.scroller.offsetHeight),P.g.emit("".concat(B.c,":READING_POSITION_CHANGE"),{x:0/window.innerWidth,y:Math.min(Number(e.toFixed(2)),1)}))}},{key:"calcPosition",value:function(e){var t={x:0,y:0};return this.scroll&&this.editor&&this.scroller&&this.innerContainer&&(t.y=w(this.editor,this.scroller,e)/this.innerContainer.offsetHeight),t}},{key:"getLinePercentage",value:function(e){var t=this.editor,n=this.scroller,i=this.positionData,r=i.topLineNum,o=i.lineNum;if(!n)return 0;var a=e?r:o,s=n.scrollTop+(e?0:n.offsetHeight/2);if(Object(g.default)(s))return 0;var c=S(t,a);if(Object(g.default)(c))return 0;var l=T(t,a);return l?(s-c)/l:0}},{key:"replayFollowActionHandler",value:function(e){var t=this,n=e.actionType,i=e.data,r=e.uuid;if("Position"===n){if(!this.scroller)return W(r,"scroller is not found");var o=i;if(this.currentPositionReplayData)return this.pendingPositionData&&K(this.pendingPositionData.uuid,"new-DocPosition-arrived"),void(this.pendingPositionData={data:o,uuid:r,actionType:n});this.currentPositionReplayData=i;var a=function(){var e;t.currentPositionReplayData=void 0,t.pendingPositionData&&(e=t.pendingPositionData,t.pendingPositionData=void 0,t.replayFollowActionHandler(e))};L(this.editor,this.scroller,o).then(function(){t.currentPositionReplayData===i?F(r,t.editor,t.scroller,o):V(r),a()}).catch(function(e){W(r,e),a()})}}}]),t}();Z([Object(d.Bind)()],Y.prototype,"sendCurrentDocPosition",null),Z([Object(d.Bind)()],Y.prototype,"replayFollowActionHandler",null)},"9ajS":function(e,t,n){"use strict";var i=n("lSNA"),y=n.n(i),r=n("J4zp"),E=n.n(r),o=n("o0o1"),f=n.n(o),a=n("yXPU"),s=n.n(a),c=n("lwsE"),u=n.n(c),l=n("W8MJ"),d=n.n(l),h=n("7EGn"),p=n("XIp8"),g=n("TYER"),m=n("UXvI"),O=n("y2sV"),v=n("+om4"),b=function(){function e(){u()(this,e),this._deltas={}}return d()(e,[{key:"get",value:function(e){return this._deltas[e]}},{key:"set",value:function(e,t){return this._deltas[e]=t,this}},{key:"delete",value:function(e){return delete this._deltas[e],this}},{key:"each",value:function(e){for(var t=0,n=Object.entries(this._deltas);t<n.length;t++){var i=E()(n[t],2),r=i[0];e(i[1],r)}}}]),e}(),C=function(){function i(e){u()(this,i),this.zoneType=O.F.Content,this.ops=[];var t=e.zoneId,n=e.ops;this.zoneId=t,n&&0<n.length&&(this.ops=n)}return d()(i,[{key:"delete",value:function(e){return e<=0?this:this.push({delete:e})}},{key:"retain",value:function(e){return e<=0?this:this.push({retain:e})}},{key:"insert",value:function(e){return this.push({insert:e})}},{key:"getLastOp",value:function(){return this.ops[this.ops.length-1]}},{key:"push",value:function(e){var t=this.getLastOp();return t?I(e)&&I(t)?t.delete+=e.delete:k(e)&&k(t)?t.retain+=e.retain:this.ops.push(e):this.ops.push(e),this}},{key:"chop",value:function(){var e=this.getLastOp();return e&&e.retain&&this.ops.pop(),this}}]),i}();function k(e){return"number"==typeof e.retain}function I(e){return"number"==typeof e.delete}function S(e){var o=e.previous,t=e.deltaSet,a=e.current,s=e.changes,c=new b;return t.forEach(function(e){var t,n,i,r=e.zoneId;e.zoneType===O.F.Content?(t=o.getZoneState(r),i=(n=a.getZoneState(r))?t?w(r,s):_(n):T(t),c.set(r,i.chop())):c.set(r,e)}),c}function T(e){return new C({zoneId:e.getZoneId()}).delete(e.length())}function _(e){var t=new C({zoneId:e.getZoneId()});return e.getContent().eachLine(function(e){t.insert(e.ops)}),t}function w(e,t){var s=new C({zoneId:e}),c=0,n=t[e];return n&&n.forEach(function(e){var t=e.start,n=e.inserts,i=void 0===n?[]:n,r=e.deletes,o=(void 0===r?[]:r).length,a=t-c;s.retain(a),s.delete(o),c+=o+a,i.forEach(function(e){s.insert(e.getOps())})}),s}function j(i,e){var r=new O.e;return e.each(function(e){var t=e.zoneId,n=e.zoneType===O.F.Content?M(i.getZoneState(t),e):e;r.add(t,n)}),r}function M(o,e){var t=e.zoneId,a=e.ops,s=new O.E({zoneId:t}),c=0,l=-1,u=o.length();return a.forEach(function(e,i){var t,n,r;e.delete?(l+=e.delete,n=t=o.getLine(l).getOffset().end,(a[i+1]&&a[i+1].insert||l===u-1)&&(n=t-1),s.delete(n-c),c=n):e.retain?(l+=e.retain,r=o.getLine(l).getOffset().end,s.retain(r-c),c=r):e.insert&&e.insert.forEach(function(e){var t=e.insert,n=e.attributes;("\n"!==t||a[i+1]&&a[i+1].insert)&&s.insert(t,n)})}),s.chop()}var L=n("2ACu"),R=n("skFV");function N(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Object(R.v)()&&D("".concat(e," ").concat(t,": "),n);var i=n.rev,r=n.msg,o=n.status,a=n.error,s={rev:i,action:t,status:o,type:n.type,is_stop_apply:n.isStopApply,msg:a?"".concat(r," : ").concat(a.message,"; ").concat(a.stack):r};Object(L.default)("translate_action",s)}function D(e,t){var r=Object.assign({},t);Object.entries(t).forEach(function(e){var t=E()(e,2),n=t[0],i=t[1];i instanceof O.e?r[n]=P(i):i instanceof O.d&&(r[n]=x(i))}),console.log(e,r),r.error&&console.error(r.error)}function x(e){var n={};return e.content.forEach(function(e,t){n[t]={ops:e.content.ops,lines:e.lines}}),n}function P(e){var r={};return Object.entries(e._deltas).map(function(e){var t=E()(e,2),n=t[0],i=t[1];r[n]=i.ops}),r}var B=n("SLjs"),U="[ __TRANS__ originalController ]",z=1e3,H=g.h.NEW_CHANGES,F=g.h.USER_CHANGES,V=g.h.ACCEPT_COMMIT,W=function(){function a(e){var i=this,t=e.docInfo,n=e.onLineChangeCb,r=e.sync,o=e.onStatusChangeCb;u()(this,a),this._stopApply=!1,this.handleNewChanges=function(e){i.currentRev=e.note_revision;var t=Object(O.M)(e.zone_changesets,e.apool);i.setRemoteDelta(i.remoteDelta?i.remoteDelta.compose(t):t),i.checkAndApplyTimer()},this.handleAcceptCommit=function(e){var t;i.currentRev=e.note_revision,i.submittedDelta&&(t=i.remoteDelta?i.remoteDelta.compose(i.remoteDelta.transform(i.submittedDelta,!0)):i.submittedDelta,i.setRemoteDelta(t),i.setSubmittedDelta()),i.checkAndSendToRemote(),i.checkAndApply()},this.checkAndApply=function(){var e=i._stopApply,t=i.remoteDelta;if(N(U,"check_apply",Object.assign({},t,{rev:i.currentRev,isStopApply:e})),!e&&t){i.userDelta&&i.setUserDelta(t.transform(i.userDelta)),i.submittedDelta&&i.setSubmittedDelta(t.transform(i.submittedDelta)),i.setRemoteDelta(),t.forEach(function(e,t){var n=e.zoneType;i.contentState.getZoneState(t)||n!==O.F.Content||i.contentState.addZone(t)});try{i.translatorRev=i.currentRev,i.contentState.apply(t)}catch(e){i.onStatusChangeCb(B.d.SYNC_FAIL,{msg:"origin contentState apply error",error:e})}}},this.checkAndApplyTimer=Object(m.default)(this.checkAndApply,z,{leading:!1}),this.onContentStateChange=function(e){try{var t=S(e);N(U,"content_change",Object.assign({},e,{rev:i.currentRev,lineDeltaSet:t})),i.onLineChangeCb(t,i.currentRev)}catch(e){i.onStatusChangeCb(B.d.SYNC_FAIL,{msg:"origin delta transform lineDelta error",error:e})}},this.token=t.token,this.currentRev=t.rev,this.translatorRev=t.rev,this.onLineChangeCb=n,this.onStatusChangeCb=o,this.contentState=Y(t.contentState),this.contentState.onChange(this.onContentStateChange),this.sync=r,this.sync.on(H,this.handleNewChanges),this.sync.on(V,this.handleAcceptCommit),N(U,"origin_init",{rev:t.rev})}return d()(a,[{key:"destroy",value:function(){this.sync.off(H,this.handleNewChanges),this.sync.off(V,this.handleAcceptCommit),this.onLineChangeCb=void 0}},{key:"performAttrsAtLine",value:function(e,t,n){N(U,"perform_attr",{zone:e,lineNumber:t,attrs:n,rev:this.currentRev,isStopApply:this._stopApply});try{var i=n.reduce(function(e,t){var n=E()(t,2),i=n[0],r=n[1];return e[i]=r,e},{}),r=this.contentState.getZoneState(e).getLine(t),o=r.getOffset(),a=o.start,s=o.end,c=new O.E({zoneId:e}),l=r.hasLineMarker()?a+1:a,u=!0;c.retain(l),c.retain(s-l-(u?1:0),i);var d=new O.e(y()({},c.zoneId,c)),h=this.userDelta||q();this.setUserDelta(h.compose(d)),this.checkAndSendToRemote()}catch(e){this.onStatusChangeCb(B.d.COMMENT_FAIL,{msg:"origin perform_attr error",error:e})}}},{key:"setSubmittedDelta",value:function(e){this.submittedDelta=e||void 0}},{key:"setRemoteDelta",value:function(e){this.remoteDelta=e||void 0}},{key:"setUserDelta",value:function(e){this.userDelta=e||void 0}},{key:"checkAndSendToRemote",value:function(){var e,n,i,a,t,r,o,s=this;!this.submittedDelta&&this.userDelta&&(this.setSubmittedDelta(this.userDelta),e=this.userDelta,this.setUserDelta(),n=e.deltas,i={},a=new v.AttributePool,Object.keys(n).forEach(function(e){var t=s.contentState.getZoneState(e).lines.map(function(e){return e.getModelText()}).join("");i[e]=t,n[e].ops.forEach(function(e){if(e.attributes)for(var t=0,n=Object.entries(e.attributes);t<n.length;t++){var i=E()(n[t],2),r=i[0],o=i[1];a.putAttrib([r,o])}})}),t=Object(O.O)({deltaSet:e,apool:a,texts:i}),r=Object(v.formatCs)(t),o={type:F,baseRev:this.translatorRev,changeset:r[0]||"",zone_changesets:r,apool:a.toJsonableNoCloning(),uuid_v4:Z(),retryTimes:0,token:this.token,member_id:Number(this.sync.memberId),user_ticket:this.sync.io.getTicket(),user_id:window.User.id},this.sync.sendMessage(o.type,o))}},{key:"suspendApply",value:function(){this._stopApply=!0}},{key:"resumeApply",value:function(){this._stopApply=!1,this.checkAndApplyTimer()}}]),a}();function K(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function Z(){var e=(new Date).getTime();return K()+"-"+e}function q(){return new O.e({0:new O.E({zoneId:"0"})})}function Y(e){var t=e.schema,n=e.getContent(),i=new O.e;return n.forEach(function(e,t){i.add(t,e.getContent())}),new O.d({deltaSet:i,schema:t})}var J,Q,X=n("SA+Z"),$=n.n(X),ee=n("RIqP"),te=n.n(ee),ne=n("owWc"),ie=n("FJEn"),re=n("7SOz"),oe=n("HIeq"),ae=n("2spZ"),se=n("H6oK"),ce=n("nN3d"),le=n("toa8"),ue=n("vEhQ"),de="temp_guid",he=function(){function e(){u()(this,e),this.dataMap=y()({},de,{heading:!1,not_need_translate:!0,line_attribs:[]}),this.zoneGuidMap={}}return d()(e,[{key:"addZone",value:function(e){Object(ue.a)(this.zoneGuidMap,[e],[de])}},{key:"eachGuid",value:function(n){for(var i=this,e=function(){var e=E()(o[r],2),t=e[0];e[1].forEach(function(e){n(e,i.getData([e]),t)})},r=0,o=Object.entries(this.zoneGuidMap);r<o.length;r++)e()}},{key:"getGuids",value:function(e){return this.zoneGuidMap[e]}},{key:"getData",value:function(e){return Object(h.default)(this.dataMap,e)}},{key:"updateData",value:function(e,t){Object(ue.a)(this.dataMap,e,t)}},{key:"insertLine",value:function(e,t,n,i){var r=Object(h.default)(this.zoneGuidMap,[e],[]);r.splice(t,0,n),Object(ue.a)(this.zoneGuidMap,[e],r),this.updateData([n],i)}},{key:"addLine",value:function(e,t,n){var i=Object(h.default)(this.zoneGuidMap,[e],[]);i.push(t),Object(ue.a)(this.zoneGuidMap,[e],i),this.updateData([t],n)}},{key:"deleteLine",value:function(e,t,n){var i=this,r=this.zoneGuidMap[e];r&&r.splice(t,n).forEach(function(e){e!==de&&delete i.dataMap[e]})}}]),e}(),fe=n("+4eN");(Q=J=J||{}).SUCCESS="success",Q.FAILURE="failure",Q.CANCEL="cancel",Q.FAIL="fail";var pe,ge,me=function(e,t){var n=e.split(" "),i=E()(n,2),r=i[0],o=i[1];return ie.tableIds.getSortedTableCellIdsByTableIdFromVectorReps(t,{rowId:r,colId:o})},ve="origin",be="[ __TRANS__ transfer ]",ye=function(){function c(e){var n=this,t=e.originEditorData,i=e.context,r=e.translateConfig,o=e.requestConfig,a=e.onChange,s=e.matchNotNeedTransData;u()(this,c),this.data=new he,this.translate=function(e){var t=e.translateParams;return t.text_list.length?Object(re.a)(t,le.d,n.requestConfig):Promise.reject()},this.requestConfig=o,this.context=i,this.displayType=r.display_type,this.srcLang=r.src_lang,this.targetLang=r.target_lang,this.onChangeStatus=a,this.matchNotNeedTransData=s,this.protectedSuppl={A:["dataMetaBlockProps","mention-chatId_","gallery"],B:["mention-link_","mention-token_","mention-type_","mention-uuid_"]},this.setWholeTranslateData(ie.DEFAULT_REP_ZONE,t)}function e(e){return t.apply(this,arguments)}var t,n,i;function r(e){return n.apply(this,arguments)}function o(){return i.apply(this,arguments)}return d()(c,[{key:"resetConfig",value:function(e){this.stopTranslating(),this.targetLang=e.target_lang,this.displayType=e.display_type}},{key:"getOriginalLineText",value:function(e){var t=this.data.getData([e,ve]);return t?Object(re.d)(t):[]}},{key:"getOriginalLineNum",value:function(e,t){return this.data.getGuids(e).indexOf(t)}},{key:"getTranslateLineNum",value:function(e,t){if(this.displayType===B.b.ONLY_TRANSLATION)return t;for(var n=0,i=this.data.zoneGuidMap[e],r=this.data.dataMap,o=0;o<t;o++)n+=r[i[o]][this.targetLang]?2:1;return n}},{key:"setWholeTranslateData",value:function(o,c){var l=this,u=c[o];u&&Object.keys(u).forEach(function(e){var a,s,t=u[e],n=l.generateLineData(t,o),i=n.guid,r=n.lineData;l.data.addLine(o,i,r),t.forEach(function(e){var t=e.attribs,n=Object(fe.i)(t),i=E()(n,2),r=i[0],o=i[1];a=r&&r[1],s=o&&o[1]}),a?me(a,l.context.vectorReps).forEach(function(e){l.setWholeTranslateData(e,c)}):s&&l.setWholeTranslateData(s,c)})}},{key:"translateAllUnTranslateData",value:(i=s()(f.a.mark(function e(){var t,n,i,r,o,a,s,c,l,u,d,h=arguments;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<h.length&&void 0!==h[0]?h[0]:new Set,1<(n=1<h.length&&void 0!==h[1]?h[1]:0))return e.abrupt("return",{msg:J.FAILURE,codes:Array.from(t)});e.next=4;break;case 4:if(n)return e.next=7,Object(ae.c)(500*n);e.next=7;break;case 7:if(i=this.getTranslateGroupGuids(),(r=i.unTranslate).length)return o=this.generateTranslateParams(r),a=this.translateRequest=this.translate(o),e.next=13,a;e.next=21;break;case 13:if(s=e.sent,a.cancel_status)return e.abrupt("return",{msg:J.CANCEL});e.next=16;break;case 16:if(c=s.failure_data,l=s.data,u=s.target_lang,d=s.codes,l.text_list.length&&this.generateGuidsFromAILabTranslateData(l,!0,u),c.text_list.length)return d.forEach(function(e){return t.add(e)}),e.abrupt("return",this.translateAllUnTranslateData(t,n+1));e.next=21;break;case 21:return e.abrupt("return",{msg:J.SUCCESS});case 22:case"end":return e.stop()}},e,this)})),o)},{key:"translateWholeData",value:(n=s()(f.a.mark(function e(t){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.resetConfig(t),this.changeTranslateStatus(B.d.LOADING),e.next=4,this.translateAllUnTranslateData();case 4:if((n=e.sent).msg===J.SUCCESS)return e.abrupt("return",{data:this.genWholeTranslateData()});e.next=7;break;case 7:return e.abrupt("return",{codes:n.codes,data:null,msg:n.msg});case 8:case"end":return e.stop()}},e,this)})),r)},{key:"genWholeTranslateData",value:function(){var r=this;return Object(ne.a)(this.data.zoneGuidMap,function(e,t,n){var i=[];return t.forEach(function(e,t){var n=r.genTranslateLineByGuid(e,String(t));return i.push.apply(i,te()(n))}),e[n]=i,e},{})}},{key:"handleOriginEditorChange",value:(t=s()(f.a.mark(function e(t){var n,i,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.genTempDeltaSet(t),i=n.tempDeltaSet,r=n.changeGuids,this.changeTranslateStatus(B.d.SYNC_LOADING,{guids:r}),e.next=4,this.translateAllUnTranslateData();case 4:if((o=e.sent).msg===J.SUCCESS)return e.abrupt("return",{lineDeltaSet:this.genRealDeltaSet(i)});e.next=7;break;case 7:return e.abrupt("return",{msg:"transfer request error: ".concat(o.msg),codes:o.codes});case 8:case"end":return e.stop()}},e,this)})),e)},{key:"genRealDeltaSet",value:function(o){var a=this;return o.each(function(e,t){var n,i=e.zoneType,r=e.ops;i===O.F.Content&&(n=new C({zoneId:t}),r.forEach(function(e){e.delete?n.delete(e.delete):e.retain?n.retain(e.retain):e.insert&&a.genLinesOps(e.insert).forEach(function(e){n.insert(e)})}),o.set(t,n))}),o}},{key:"genLinesOps",value:function(e){var n=this;return this.genTranslateLineByGuid(e).reduce(function(e,t){return e.push(n.translateLineToOps(t)),e},[])}},{key:"translateLineToOps",value:function(e){var t=e.reduce(function(e,t){var n=t.text,i=t.attribs.reduce(function(e,t){return e[t[0]]=t[1],e},{});return e.push({insert:n,attributes:i}),e},[]);return t.push({insert:"\n"}),t}},{key:"genTempDeltaSet",value:function(i){var d=this,h=[];return i.each(function(e,c){var l,u,t=e.zoneType,n=e.ops;t===O.F.Content&&(l=new C({zoneId:c}),d.data.getGuids(c)||d.data.addZone(c),u=0,n.forEach(function(e){var t,n,i,r,o,a,s;e.delete?(n=(t=d.calculateLineDistance(c,u,u+e.delete)).distance,i=t.centerGuids,h.push.apply(h,te()(i)),l.delete(n),d.data.deleteLine(c,u,e.delete)):e.retain?(r=d.calculateLineDistance(c,u,u+e.retain).distance,l.retain(r),u+=e.retain):e.insert&&(a=(o=d.generateLineData(e.insert,c)).guid,s=o.lineData,d.data.insertLine(c,u,a,s),l.insert(a),u++)}),i.set(c,l))}),{tempDeltaSet:i,changeGuids:h}}},{key:"calculateLineDistance",value:function(e,t,n){for(var i=0,r=this.data.getGuids(e),o=[],a=t;a<n;){var s=r[a];o.push(s);i=this.data.getData([s]).not_need_translate||this.displayType===B.b.ONLY_TRANSLATION?i+1:i+2;a++}return{distance:i,centerGuids:o}}},{key:"generateLineData",value:function(e,t){var n="id-".concat(Object(oe.b)()),u=[["translate-guid",n]],i=e.reduce(function(e,t,n){var i=t.text||t.insert;if(void 0===i&&console.error(be,"generateLineData text is undefined",t),""===(i=i.split("\n")[0]))return e;var r=t.attribs||Object.entries(t.attributes||{}),o=!i.replace(/\*/g,"").length;if(0===n&&o){var a=Object(fe.i)(r),s=E()(a,2),c=s[0],l=s[1];if(!c&&!l)return u.push.apply(u,te()(r.filter(function(e){var t=E()(e,1)[0];return["translate","translate-guid"].indexOf(t)<0}))),e}return e.push({text:i,attribs:r}),e},[]);1===u.length&&u.push(["lmkr","1"]);var r=Object(re.c)(i),o=r.text,a=r.suppl,s=this.matchNotNeedTransData({text:o,suppl:a,line_attribs:u,zoneId:t});return{guid:n,lineData:y()({zone_id:t,line_attribs:u,not_need_translate:s},ve,{text:o,suppl:Object.assign({},a,y()({},n,[[0,Math.max(0,o.length-1)]]))})}}},{key:"genTranslateLineByGuid",value:function(e,t){var n=this.data.getData([e]),i=n[ve],r=n[this.targetLang],o=n.zone_id,a=n.line_attribs,s=Object.assign({},i,{guid:e,zone_id:o,line_attribs:a});t&&(s.line_num=t);var c=this.generateTranslateTexts(s);if(!r)return[c];var l,u,d,h=Object.assign({},s,{},r);this.displayType===B.b.WITH_ORIGINAL&&(u=(l=this.generateWithOriginalSuppl(h)).newSuppl,d=l.newLineAttribs,h.suppl=u,h.line_attribs=[].concat(te()(h.line_attribs),te()(d)));var f=this.generateTranslateTexts(h);return this.displayType===B.b.ONLY_TRANSLATION?[f]:[c,f]}},{key:"generateTranslateTexts",value:function(e){var t=e.text,n=e.suppl,i=e.line_attribs,r=Object.assign({},n),o=this.findIdSuppl(n);o&&delete r[o];var a=Object(re.d)({text:t,suppl:r});return 0<i.length&&a.unshift({text:"*",attribs:te()(i)}),a}},{key:"generateWithOriginalSuppl",value:function(e){var t=e.zone_id,n=e.line_num,i=e.suppl,r=e.line_attribs,o=[["translate","true"]],s=Object.assign({},i);"0"===n&&t===ie.DEFAULT_REP_ZONE&&(r.some(function(e){var t=E()(e,2),n=t[0];t[1];return/^heading/.test(n)})||o.push(["heading","h1"]));var a=this.filterInlineBlockSuppl(i);return a.length&&a.forEach(function(e){var t,n=e.split(","),i=$()(n),r=i[0],o=i.slice(1).join(","),a=Object(se.getBlockPropsFromAttributesMap)(y()({},r,o));a&&(a.blockId=Object(ce.a)(),t="".concat(r,",").concat(JSON.stringify(a)),s[t]=s[e],delete s[e])}),{newLineAttribs:o,newSuppl:s}}},{key:"findIdSuppl",value:function(e){return Object.keys(e).find(function(e){return/^id-/.test(e)})}},{key:"filterInlineBlockSuppl",value:function(e){return Object.keys(e).filter(function(e){return/^dataMetaBlockProps/.test(e)&&/displayMode\"\:\"inline\"/.test(e)})}},{key:"stopTranslating",value:function(){Object(h.default)(this.translateRequest,"cancel",function(){return null})()}},{key:"generateGuidsFromAILabTranslateData",value:function(e){var o=this,a=1<arguments.length&&void 0!==arguments[1]&&arguments[1],s=2<arguments.length?arguments[2]:void 0,c=e.text_list,l=e.suppl,u=[],d=[],h=l.map(function(e){return o.findIdSuppl(e)});return this.data.eachGuid(function(t,e){var n,i=e.not_need_translate,r=h.findIndex(function(e){return e===t});-1!==r||i?i||(n={text:c[r],suppl:l[r]},u.push(t),a&&o.data.updateData([t,s],n)):d.push(t)}),{translateGuids:u,unTranslateGuids:d}}},{key:"generateTranslateParams",value:function(e){var n=this,i=[],r=[];return e.forEach(function(e){var t=n.data.getData([e])[ve];i.push(t.text),r.push(t.suppl)}),{translateParams:{protected_suppl:this.protectedSuppl,src_lang:this.srcLang,target_lang:this.targetLang,text_list:i,suppl:r},guids:e}}},{key:"getTranslateGroupGuids",value:function(){var n=this,i=[];return this.data.eachGuid(function(e,t){t.not_need_translate||t[n.targetLang]||i.push(e)}),{unTranslate:i}}},{key:"changeTranslateStatus",value:function(e,t){this.onChangeStatus(e,t)}}]),c}(),Ee=n("AW8B"),Oe=n("QILm"),Ce=n.n(Oe),ke=n("a1gu"),Ie=n.n(ke),Se=n("Nsbk"),Te=n.n(Se),_e=n("iWIM"),we=n.n(_e),je=n("7W2i"),Me=n.n(je),Ae=n("5gS9"),Le=n("f9b/"),Re=n("77Gt"),Ne=n("QM+C"),De=1e3,xe=2;(ge=pe=pe||{}).USER_NEWINFO="USER_NEWINFO",ge.USER_LEAVE="USER_LEAVE",ge.ROOM_MEMBERS="ROOM_MEMBERS",ge.USER_CHANGES="USER_CHANGES",ge.MESSAGE_CHANNEL="MESSAGE_CHANNEL";var Pe=function(e){function r(e,t){var i;u()(this,r),(i=Ie()(this,Te()(r).call(this,{io:Ae.b.getInstance(),token:e,type:g.d.DOC,requestMessageOptions:{version:xe},registerChannels:function(e){return y()({},Le.a,new g.f(e,{fetchMemberList:function(){return e.fetchMemberInfos()},shouldFetchMemberList:function(){return Object(Re.d)(g.d.DOC,e.token).length<150}}))},logger:{log:L.default}}))).missVersionLimit=De,i.fetchMemberInfos=function(){return Object(Re.b)(i.memberId,i.token,Ne.NUM_SUITE_TYPE.DOC)},i.handleMembersMessageData=function(e){var t=e.count,n=e.members;Object(Re.f)("doc",Object.assign(e,{token:i.token,members:i.assignMemberInfo(e,n),count:t}))},i.handleUserNewInfo=function(e){var t=e.entities,n=Ce()(e,["entities"]),i=Object(h.default)(t,"users",{}),r=Object.assign(n,i[n.user_id],{count:t.users_count});Object(Re.j)("doc",r)},i.handleUserLeave=function(e){Object(Re.i)("doc",e)};var n=i.channels[Le.a];return n.on(g.h.ROOM_MEMBERS,i.handleMembersMessageData),n.on(g.h.USER_NEWINFO,i.handleUserNewInfo),n.on(g.h.USER_LEAVE,i.handleUserLeave),i.on(g.h.ACCEPT_WATCH,i.fetchMemberInfos),i.setClientVars(t),i}return Me()(r,e),d()(r,[{key:"getVersionOfOversize",value:function(e){return e.note_version}},{key:"getVersionOfChangeset",value:function(e){return e.note_revision}},{key:"getChangesets",value:function(e){return e.changeset_list}},{key:"isSelfChangeset",value:function(e){return!1}},{key:"getVersionOfClientVars",value:function(e){return e.collab_client_vars.rev}},{key:"getVersionOfAcceptCommit",value:function(e){return e.note_revision}},{key:"assignMemberInfo",value:function(e,t){var n=Object(h.default)(e,"entities.users",{}),i=Object.assign(t);return i.forEach(function(e){e=Object.assign(e,n[e.suid||e.user_id])}),i}},{key:"destroy",value:function(){we()(Te()(r.prototype),"destroy",this).call(this),Object(Re.g)("doc",this.token)}},{key:"sendMessage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(e!==g.h.USER_CHANGES)return Promise.reject(new Error("not support"));var n=Object(h.default)(window,"current_space_wiki.space_id",0);return this.sendUserChange(Object.assign({type:e,token:this.token},t,{},n?{wiki_space_id:n}:{}))}}]),r}(g.j),Be=n("OX8E"),Ue=n("sLU5"),ze=n("4udo"),He=n("kESg");n.d(t,"a",function(){return Ve});var Fe="[ __TRANS__ Controller ]",Ve=function(){function l(e){var s=this,t=e.token,n=e.originEditor,i=e.translateConfig,r=e.changeCbk;u()(this,l),this.enable=Object(Ee.e)(),this.matchNotNeedTransData=function(e){var t=e.text,n=e.line_attribs,i=e.suppl,r=e.zoneId,o=/list-code|aceTable/,a=new RegExp("aceTable,|".concat(He.k.ZoneType,","));return Object(fe.n)(s.originEditor||s.translateEditor,r)===He.l.CodeBlock||0===t.trim().length||n.some(function(e){return o.test(e.join("-"))})||a.test(Object.keys(i).join(""))},this.initTransfer=function(e){var t=[0,s.originEditor.getContentState().getZoneState(ie.DEFAULT_REP_ZONE).length()-1],n=s.originEditor.translator.getTranslationData(t),i=n.translationData,r=n.context;s.transferData=new ye({originEditorData:i,context:r,translateConfig:e,requestConfig:Ee.f,onChange:s.onTransferStatusChange,matchNotNeedTransData:s.matchNotNeedTransData})},this.handleOriginModelLineChange=function(e,r){s.originModel.suspendApply(),s.readyPromise=s.transferData.handleOriginEditorChange(e).then(function(e){var t=e.lineDeltaSet,n=e.msg,i=e.codes;t?(s.applyToTranslate(t,r),s.changeStatus(B.d.SYNC_FINISH,{title:s.getTranslateTitle()}),s.originModel.resumeApply()):s.changeStatus(B.d.SYNC_FAIL,{msg:"transfer request error: ".concat(n),codes:i})}).catch(function(e){s.changeStatus(B.d.SYNC_FAIL,{msg:"transfer genDelta error: ".concat(e.message),error:e})})},this.applyToTranslate=function(e,t){var i=s.translateEditor.getContentState();e.each(function(e,t){var n=e.zoneType;i.getZoneState(t)||"Z"!==n||i.addZone(t)}),s.fixCommentAttr(e,i);var n=j(i,e);try{N(Fe,"apply_to_translator",{deltaSet:n,rev:t}),i.apply(n,{preventScrolling:!0})}catch(e){return s.changeStatus(B.d.SYNC_FAIL,{msg:"apply to translator error",error:e,deltaSet:n,rev:t})}},this.onTransferStatusChange=function(e,t){s.changeStatus(e,t)},this.onOriginalModelStatusChange=function(e,t){s.changeStatus(e,t)},this.handleSyncEvent=function(e){var t,n=e.data||{},i=n.type,r=n.payload;i&&(0!==We.indexOf(i)&&Be.a.trigger(Ue.a.PC.DOCS.SYNC_NOTE_META,[n]),s.translateEditor&&(t="handleClientMessage_".concat(i),s.translateEditor.hook.callAll(t,{payload:r,msg:n,evt:e})))};var o=n.plugins.client.rev,a=Object.assign({},n.getClientVars(),{rev:o}),c=n.getContentState();this.originInfo={token:t,rev:o,contentState:c,clientVars:a},this.originEditor=n,this._changeCbk=r,this.initTransfer(i)}function e(e){return t.apply(this,arguments)}var t;return d()(l,[{key:"destroy",value:function(){this.sync&&(this.sync.off(g.h.MESSAGE,this.handleSyncEvent),this.sync.destroy())}},{key:"performAttributes",value:function(e,t,n){var i,r;this.enable&&this.translateEditor&&(i=Object(ze.b)(t,this.translateEditor),-1!==(r=this.transferData.getOriginalLineNum(e,i))?this.originModel.performAttrsAtLine(e,r,n):N(Fe,"perform_attr_not_found_lineNum",{zone:e,guid:i}))}},{key:"startTranslate",value:(t=s()(f.a.mark(function e(t){var n,i,r,o,a,s;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.originModel&&this.originModel.suspendApply(),e.next=3,this.transferData.translateWholeData(t);case 3:if(n=e.sent,i=n.data,r=n.codes,o=void 0===r?[]:r,a=n.msg,i){e.next=11;break}return this.changeStatus(B.d.FAIL,{codes:o,msg:"startTranslate error:"+a}),e.abrupt("return");case 11:s=this.getTranslateClientVars(i,this.getContext()),this.changeStatus(B.d.FINISH,{initClientVar:s});case 13:case"end":return e.stop()}},e,this)})),e)},{key:"setTranslateEditor",value:function(e){this.translateEditor=e;var t=this.originInfo,n=t.token,i=t.rev;Object(h.default)(this.originEditor,"plugins.client.sync")&&this.originEditor.plugins.client.destory(),this.sync||(this.sync=new Pe(n,i),this.sync.on(g.h.MESSAGE,this.handleSyncEvent),this.setOriginModel(this.originInfo)),this.changeStatus(B.d.MOUNT,{title:this.getTranslateTitle()}),this.originEditor=null,this.originModel&&this.originModel.resumeApply()}},{key:"setOriginModel",value:function(e){this.enable&&(this.originModel=new W({docInfo:e,onLineChangeCb:this.handleOriginModelLineChange,sync:this.sync,onStatusChangeCb:this.onOriginalModelStatusChange}))}},{key:"waitForReady",value:function(){return this.readyPromise||Promise.resolve()}},{key:"fixCommentAttr",value:function(e,b){e.each(function(e,t){var n=e.zoneType,i=e.ops,r=b.getZoneState(t);if(r&&"Z"===n)for(var o=0,a=0;a<i.length;a++){var s=i[a];if("retain"in s)o+=s.retain;else if("delete"in s){var c=s.delete;if(1<c)return;for(var l=0;l<c;l++){var u=r.getLine(o);if(!u)return;var d=u.getAttributes(0,2).find(function(e){var t=E()(e,2),n=t[0];t[1];return/clientside-comment-local-id/.test(n)});if(d&&i[a+1]&&"insert"in i[a+1]){var h=i[a+1].insert,f=new O.E({ops:h}),p=h.reduce(function(e,t){return e+t.insert.length},0),g=!!h[0].attributes&&h[0].attributes.lmkr?1:0,m=h[h.length-1].insert||"",v=p-g-("\n"===m[m.length-1]?1:0);return void(i[a+1].insert=f.compose((new O.E).retain(g).retain(v,y()({},d[0],d[1]))).ops)}o+=1}}}})}},{key:"changeStatus",value:function(e,t){this.status=e,N(Fe,"change_status",Object.assign({},t,{status:e})),this._changeCbk(e,t)}},{key:"getTranslateClientVars",value:function(e,t){var n=this.originInfo.clientVars,i=(this.originEditor||this.translateEditor).translator.translationDataToClientVars({translationData:e,context:t}),r=i.initialAttributedTexts,o=i.apool;return Object.assign({},n,{initialAttributedTexts:r,apool:o,time:(new Date).getTime()})}},{key:"getOriginalLineText",value:function(e){return this.transferData.getOriginalLineText(e)}},{key:"getTranslateTitle",value:function(){return this.translateEditor.getContentState().getZoneState(ie.DEFAULT_REP_ZONE).getLine(0).getText().trim()}},{key:"getContext",value:function(){var t=this;if(!this.translateEditor)return this.transferData.context;var n=this.translateEditor.vectorReps,i={vectorReps:{},numToAttribs:{}},r=this.translateEditor.getRep(ie.DEFAULT_REP_ZONE).apool,e=Object.keys(n);return e.length&&(i.vectorReps=Object(p.default)(n),e.forEach(function(e){n[e].alines.forEach(function(e){t.translateEditor.changesetHelper.eachAttribNumber(e,function(e){var t=r.getAttribKey(e),n=r.getAttribValue(e);i.numToAttribs[e]=[t,n]})})})),i}}],[{key:"getInstance",value:function(e){return!this.instance&&e&&(this.instance=new l(e),N(Fe,"init")),this.instance}},{key:"destroy",value:function(){this.instance&&this.instance.destroy(),this.instance=null,N(Fe,"destroy")}}]),l}(),We=[g.h.ACCEPT_COMMIT,g.h.USER_CHANGES]},"9g7G":function(e,re,oe){"use strict";(function(i){oe.d(re,"j",function(){return D}),oe.d(re,"i",function(){return x}),oe.d(re,"k",function(){return P}),oe.d(re,"l",function(){return B}),oe.d(re,"f",function(){return K}),oe.d(re,"b",function(){return Z}),oe.d(re,"e",function(){return Q}),oe.d(re,"a",function(){return X}),oe.d(re,"g",function(){return $}),oe.d(re,"c",function(){return te}),oe.d(re,"d",function(){return ne}),oe.d(re,"h",function(){return ie});var r,n,e=oe("o0o1"),l=oe.n(e),t=oe("yXPU"),o=oe.n(t),a=oe("hMnB"),s=oe.n(a),c=oe("HmyT"),u=oe("toa8"),d=oe("1dfU"),h=(oe("iP/4"),oe("AiBH")),f=oe("jp/M"),p=oe("QM+C"),g=oe("mRaX"),m=oe("duSr"),v=oe("hbEN"),b=oe("OZf9"),y=oe("7EGn"),E=oe("vEhQ"),O=oe("m8R6"),C=oe("HA5h"),k=oe("kUgE"),I=oe("HIeq"),S=oe("FnDM"),T=oe("gfe6"),_=oe("lQZd"),w=oe("U6jp"),j=oe("s+vT"),M={},L={},R=30,N={0:"users",1:"notes",3:"notes",5:"chats",6:"groups",8:"notes",11:"notes",12:"notes",15:"notes"},D=function(){var e=Object(w.k)(s.a.href);return e===w.b.ANNOUNCE||e===w.b.FEED};function x(e){var t=c.$.Deferred(),n=Object(m.b)()?"v3":"v2";return r&&r.abort(),(r=u.d.post("/api/mention/recommend.".concat(n,"/"),e,{timeout:1e4,headers:{"Cache-Control":"no-cache,no-store"}})).then(function(d){Object(b.a)(d.data.result_list,function(e){var t,n=e.type,i=e.token,r=parseInt(n),o=N[r];o||(t=h.y[1],d={data:{result_list:[]},message:t});var a=d.data.entities[o][i],s=a.title,c=a.name,l=a.avatar_url;[h.E.SHEET,h.E.FILE,h.E.BITABLE,h.E.BOX,h.E.MINDNOTE,h.E.SLIDE].includes(r)&&(e.content=s||Object(k.getUnnamedTitle)(r)),r===h.E.USER&&(e.content=Object(g.J)(i,d.data.entities.users),e.url=l),r!==h.E.CHAT&&r!==h.E.GROUP||(e.content=c,e.url=l);var u=Object(O.default)(a,["id","title","name","cn_name","en_name","avatar_url"]);Object(C.a)(e,u)}),t.resolve(d)}).catch(function(e){return f.error.STATUS_CODE.CONNECT_ABORT===e.code?t.reject(e):(e={data:{result_list:[]},message:f.error.STATUS_CODE.TIMEOUT!==e.code&&Object(T.c)()?h.y[e.code]:i("etherpad.network_abnormal")},void t.resolve(e))}),t.abort=r.abort.bind(r),t}function P(e){var t=e.chatId,n=e.invitor,i=Object(_.g)();return u.d.post("/api/mention/join.chat/",{token:i,chat_id:t,invitor:n})}function B(e){return u.d.post("/api/mention/join.chat.v2/",{share_token:e})}var U,z=function(e){var t=+new Date;return R<(t-e)/1e3},H=function(e){var t=e.content,n=e.type,i=+new Date+3e4,r=void 0===t||""===t?"All":t,o=e.index_info||"",a=Object(y.default)(M,"".concat(n,".").concat(r,".").concat(o,".result")),s=Object(_.g)(),c=Object(y.default)(M,"".concat(n,".").concat(r,".").concat(o,".fileToken")),l=Object(y.default)(M,"".concat(n,".").concat(r,".").concat(o,".time"),i);return a&&!z(l)&&s===c?a:null},F=!1,V=Object(v.default)(K,400),W=Object(v.default)(Q,400);function K(i,r){var o=Object(_.g)();F=!1;var e=x(i);return e.then(function(e){var t,n;Object(y.default)(e,"data.result_list")&&(t=void 0===i.content||""===i.content?"All":i.content,n=i.index_info||"",Object(E.a)(M,"".concat(i.type,".").concat(t,".").concat(n),{time:+new Date,result:e,fileToken:o})),F||r(e)}),Object.assign({},e,{},V)}var Z=function(e,t){var n=H(e);return n?(U&&(U.abort(),U.cancel()),F=!0,t(n),{abort:function(){}}):U=V(e,t)};function q(e){var t=c.$.Deferred();return n&&n.abort(),(n=u.d.post(f.apiUrls.JIRA_ISSUE_SEARCH,e,{timeout:1e4})).then(function(e){t.resolve(e)}).catch(function(e){return f.error.STATUS_CODE.CONNECT_ABORT===e.code?t.reject(e):(e={data:{result_list:[]},message:f.error.STATUS_CODE.TIMEOUT!==e.code&&Object(T.c)()?h.y[e.code]||e.msg:i("etherpad.network_abnormal"),code:e.code},void t.resolve(e))}),t.abort=n.abort.bind(n),t}var Y,J=function(e){var t=e.keyword,n=+new Date+3e4,i=void 0===t||""===t?"RECENT":t,r=Object(y.default)(L,"".concat(i,".result")),o=Object(y.default)(L,"".concat(i,".time"),n);return r&&!z(o)?r:null};function Q(n,i){F=!1;var e=q(n);return e.then(function(e){var t;Object(y.default)(e,"data.issues.length")&&(t=void 0===n.keyword||""===n.keyword?"RECENT":n.keyword,Object(E.a)(L,"".concat(t),{time:+new Date,result:e})),F||i(e)}),Object.assign({},e,{},W)}var X=function(e,t){var n=J(e);return n?(Y&&(Y.abort(),Y.cancel()),F=!0,t(n),{abort:function(){}}):Y=W(e,t)};function $(e,t,n){return ee.apply(this,arguments)}function ee(){return(ee=o()(l.a.mark(function e(t,n,i){var r,o,a,s,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=i||Object(I.e)(),r=Object(d.a)(t),o=Object(d.a)(i),a=Object(j.a)(),s={interactor:"lark & docs",caller:Object(S.i)().module,interface_name:"/im/gateway 5017 & /api/mention/user.detail.v2",request_id:a,interface_data:JSON.stringify({cryptToken:o,cryptUserId:r})},e.next=7,Promise.all([oe.e("doc_index_css"),oe.e("chunk_adit"),oe.e("commons--doc_index_delay--voteEmoji--votePicker"),oe.e(16),oe.e("commons--doc_index_delay--jira"),oe.e("doc_index_delay")]).then(oe.bind(null,"ZwLK"));case 7:return c=e.sent,e.abrupt("return",c.fetchUserInfo(t,n,i,s));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function te(e){var t={share_tokens:e,source:h.z.DOC,obj_type:f.common.NUM_SUITE_TYPE.DOC,obj_token:Object(_.g)()};return u.d.post("/api/mention/chat.info.v3/",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function ne(e){var t=e.type,n=e.token;return u.d.get(f.apiUrls.GET_META,{params:{type:p.mapFileType2TypeNum[t],token:n}})}function ie(e){var t={chat_id:e,obj_token:Object(_.g)(),obj_type:f.common.NUM_SUITE_TYPE.DOC};return u.d.post("/api/mention/sharetoken/create/",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}).call(this,oe("2vAP"))},"9h4r":function(e,p,g){"use strict";(function(Y){var e=g("pVnL"),J=g.n(e),t=g("lwsE"),r=g.n(t),n=g("W8MJ"),o=g.n(n),Q=g("3Hq1"),i=g("q1tI"),X=g.n(i),$=g("3EEQ"),ee=g("D0c4"),te=g("GGpJ"),ne=g("HmyT"),ie=g("mRaX"),re=g("AiBH"),a=g("OZf9"),s=g("wq9/"),c=g("7P1s"),l=g("D7h9"),oe=g("iP/4"),ae=g("/fVd"),se=g("VI6H"),ce=g("lQZd"),le=g("EQyw"),ue=g("rLED"),u=100,d=500,de=384,he=600,fe=110,pe=48,h=function(){function i(e){r()(this,i);var t=e.e,n=e.editor;this.clientY=t.clientY,this.dom=t.target,this.$dom=Object(ne.$)(t.target),this.editor=n,this.mentionInfoReader=this._createMentionInfoReader(e,this.$dom)}return o()(i,[{key:"_createMentionInfoReader",value:function(e,t){if(e.createMentionInfoReader)return e.createMentionInfoReader(t);var n=t.prop("className");return{getType:function(){return parseInt(Object(ie.K)(n,"mention-type"))},getToken:function(){return Object(ie.K)(n,"mention-token")||t.attr("token")||t.data("token")},getLink:function(){return decodeURIComponent(Object(ie.K)(n,"mention-link"))},getTitle:function(){return t.get(0).textContent}}}},{key:"getDom",value:function(){return this.dom}},{key:"getRect",value:function(){var e=Object(s.a)(this.dom,this.editor);return Object(ie.y)(this.dom,this.clientY,e)}},{key:"getLineHeight",value:function(){return Number.parseInt(getComputedStyle(this.$dom.get(0))["line-height"])}},{key:"canShowPopover",value:function(){return this.$dom.parents("body").length&&!this.$dom.hasClass("popover-disabled")}},{key:"hasNoPermission",value:function(){return!!this.$dom.children("a").hasClass("content-with-lock")}},{key:"isGrantViewAccessDisabled",value:function(){return this.$dom.hasClass("grant-view-access-disabled")}},{key:"getType",value:function(){return this.mentionInfoReader.getType()}},{key:"getToken",value:function(){return this.mentionInfoReader.getToken()}},{key:"getTitle",value:function(){return this.mentionInfoReader.getTitle()}},{key:"getLink",value:function(){return this.mentionInfoReader.getLink()}},{key:"getUserName",value:function(){return this.$dom.data("user-name")}},{key:"isInComment",value:function(){return this.$dom.parent().hasClass("comment-list-item__content")}},{key:"getSourceData",value:function(){return Object(ie.B)(this.$dom)}},{key:"getFallbackBoxContainer",value:function(){return this.$dom.closest(".innerdocbody").parent()}},{key:"isSameAs",value:function(e){return e instanceof i&&this.getDom()===e.getDom()}}]),i}(),f=function(){function t(e){var q=this;r()(this,t),this.getSelectors=function(){if(q.selectors)return q.selectors;var e=[".mention-type_0",".mention"],n=".popover,.mention-popover,.larkw-lark-user-card__action-modal__wrapper,.guide-onboarding-spot",t=q.props.hoverArea,i=void 0===t?".innerdocbody":t,r=[],o=[];return Object(a.a)(i.split(","),function(t){Object(a.a)(e,function(e){r.push("".concat(t," ").concat(e))}),Object(a.a)(n.split(","),function(e){o.push("".concat(t," ").concat(e))})}),r=r.join(","),o=o.join(","),q.selectors={mentionClsWithHoverArea:r,popoverCls:n},q.selectors},this.setMouseMoved=function(){q.isMouseMoved=!0,q.setMouseMoveTimeout&&clearTimeout(q.setMouseMoveTimeout),q.setMouseMoveTimeout=setTimeout(function(){q.isMouseMoved=!1},40),q.checkIfHidePopover()},this.clearHideTimeout=function(e){q.hoverTimeout&&clearTimeout(q.hoverTimeout)},this.delayShowPopOver=function(e){e.stopImmediatePropagation(),q.delayShowPopOverTarget(function(){return new h({e:e,editor:q.props.editor,createMentionInfoReader:q.props.createMentionInfoReader})})},this.delayShowPopOverTarget=function(e,t){(q.isMouseMoved||t)&&q.canShowPopover&&(q.isDisablePopover()||(q.delayShowPopOverTimeout=setTimeout(function(){q.showPopover(e())},d)))},this.setCanShowPopover=function(e){(q.canShowPopover=e)||q.closePopOver()},this.showPopover=function(e){if(!q.popOver&&e.canShowPopover()){var t=e.hasNoPermission(),n=e.isGrantViewAccessDisabled(),i=q.props,r=i.displayLargePopover,o=i.from,a=q.props.container,s="notification"===o,c=e.getType(),l=e.getToken(),u=e.getTitle();ae.a.embedObjPermissionManager||ae.a.createEmbedObjPermissionManager();var d,h,f,p,g=ae.a.embedObjPermissionManager,m=re.E.USER,v=re.E.FILE,b=re.E.SHEET,y=re.E.BITABLE,E=re.E.MINDNOTE,O=re.E.BOX,C=re.E.SLIDE,k=re.E.WIKI;q.popOverTarget&&!q.popOverTarget.isSameAs(e)&&q.closePopOver(),q.hoverTimeout&&clearTimeout(q.hoverTimeout),q.popOverTarget=e,Object(se.x)()&&c===m&&(h="sheet"===(d=Object(ce.k)()),f="file"===d,p=e.isInComment(),(h||f)&&p&&(a=".doc-position"));var I,S,T,_,w,j=320,M=500,L=M,R="doc",N={},D=c===v;if(!D&&c!==b&&c!==y&&c!==E&&c!==O&&c!==C&&c!==k||(R+=" shortcut",R+=D?" docs":" sheet",M=L=378,j=D?344:348),t&&(I=g.getOwnerByToken(l),S=he,Object(ue.s)()?I&&(_="",_=I.get("can_apply_perm")?(T=Object(se.p)(I,I.get("name")),[Y("permission.embed.contact_author"),T,Y("common.owner"),Y("permission.embed.share_tips_5"),Y("permission.embed.apply_btn")].join("")):Y("permission.embed.share_tips_external_cannot_apply_permission"),j=S<(w=Object(ie.k)([_],fe))?S:w,L=3*(M=pe)):j=de),c===m){if(oe.a.isOpendoc)return;R+=" mention-profile "+(q.props.className||""),Object(se.x)()&&(R+=" mention-profile--docs"),N={horizontalAlign:"left",flatDom:!0,gap:10,coverNavBar:!0,closeContainerBottom:!0,$boxContainer:Object(ne.$)("body")}}var x=Object(ne.$)(a);x.length||(x=Object(ne.$)(e.getFallbackContainer()));var P=e.getRect(),B=Object(se.x)()&&c===m?Object(ie.j)(P,{gap:10,$boxContainer:s?Object(ne.$)("body"):void 0,coverNavBar:!s}):Object(ie.w)(P,Object.assign({horizontalAlign:"center",boxWidth:j,boxMaxHeight:L,boxMinHeight:M,gap:8,$boxContainer:x,coverNavBar:!1,lineHeight:e.getLineHeight(),getFallbackBoxContainer:function(){return e.getFallbackBoxContainer()}},N)),U=e.getSourceData(),z=Object(ie.F)(B),H=Object(ie.D)(U),F=U.source,V={className:R,style:z,container:x.get(0),handlePopOverEnter:function(){q.cancelHide()},handlePopOverLeave:function(){q.hidePopover()}};switch(c){case m:var W,K=e.getUserName()||"";Object(se.x)()?(W=Object(Q.default)(B.bottom)?"top":"bottom",V.component=X.a.createElement(ee.default,J()({closePopover:q.closePopOver,grantViewAccessDisabled:n},{token:l,displayLargePopover:r,sourceString:H,source:F,name:K},{editor:q.props.editor,triangle:W}))):(V.component=X.a.createElement(ee.default,J()({closePopover:q.closePopOver},{token:l,sourceString:H,source:F,name:K},{editor:q.props.editor})),V.container=document.body);break;case v:case b:case y:case E:case O:case C:case k:if(Object(le.b)(c))return;var Z=e.getLink();V.component=X.a.createElement(te.default,J()({token:l,type:c,sourceString:H,title:u,link:Z,embedObjShareEnable:Object(ue.s)(),disableAddEmbedObj:q.props.disableAddEmbedObj},{closePopover:q.closePopOver}));break;default:return}q.popOver=new $.default(V)}},this.closePopOver=function(){q.popOver&&(q.popOver.close(),q.popOver=null),q.popOverTarget&&(q.popOverTarget=null)},this.destory=function(){q.delayShowPopOverTimeout&&clearTimeout(q.delayShowPopOverTimeout),q.hoverTimeout&&clearTimeout(q.hoverTimeout),q.justCancelHideTimeout&&clearTimeout(q.justCancelHideTimeout),q.closePopOver(),document.body.removeEventListener("mousemove",q.setMouseMoved,{passive:!0}),q.undelegateMouseList.forEach(function(e){return e&&e()}),q.undelegateMouseList=null},this.hidePopover=function(e){q.hidePopoverImpl({checkJustCancelHide:!1})},this.hidePopoverFromAsyncCall=function(){q.hidePopoverImpl({checkJustCancelHide:!0})},this.hidePopoverImpl=function(e){q.delayShowPopOverTimeout&&clearTimeout(q.delayShowPopOverTimeout),e.checkJustCancelHide&&q.hasJustCanceledHide()||q.popOver&&q.popOverTarget&&(q.hoverTimeout&&clearTimeout(q.hoverTimeout),q.hoverTimeout=setTimeout(q.closePopOver,u))},this.props=e,this.undelegateMouseList=[],this.bindEvents(),this.isMouseMoved=!1,this.canShowPopover=!0}return o()(t,[{key:"bindEvents",value:function(){var e=this.getSelectors(),t=e.mentionClsWithHoverArea,n=e.popoverCls,i={passive:!0};document.body.addEventListener("mousemove",this.setMouseMoved,i);var r=[{parent:"body",child:t,event:"mouseenter",handle:this.delayShowPopOver.bind(this),eventOptions:i},{parent:"body",child:t,event:"mouseleave",handle:this.hidePopover.bind(this),eventOptions:i},{parent:"body",child:n,event:"mouseenter",handle:this.clearHideTimeout.bind(this),eventOptions:i},{parent:"body",child:n,event:"mouseleave",handle:this.hidePopover.bind(this),eventOptions:i}],s=[];r.map(function(e){var t=e.parent,n=e.child,i=e.event,r=e.handle,o=e.eventOptions,a=Object(c.a)(t,n,i,r,o);a&&s.push(a)}),this.undelegateMouseList=s}},{key:"checkIfHidePopover",value:function(){var e,t,n,i;this.popOver&&this.popOverTarget&&(this.popOverTarget instanceof h?this.props.editor&&(e=this.props.editor.getDocBody(),t=Object(ne.$)(this.popOverTarget.getDom()),n=Object(ne.$)(e).find(t).length,i=t.parents(".comment-list").length,(0===n&&0===i||1===i&&t&&!t.hasClass("mention"))&&this.hidePopover()):this.popOverTarget.canShowPopover()||this.hidePopover())}},{key:"isDisablePopover",value:function(){var e=l.default.getState().appState.translate;return e.status.translated&&2===e.config.display_type}},{key:"cancelHide",value:function(){var e=this;this.hoverTimeout&&clearTimeout(this.hoverTimeout),this.justCancelHideTimeout&&clearTimeout(this.justCancelHideTimeout),this.justCancelHideTimeout=setTimeout(function(){e.justCancelHideTimeout=void 0},u)}},{key:"hasJustCanceledHide",value:function(){return!!this.justCancelHideTimeout}}]),t}();p.a=f}).call(this,g("2vAP"))},"9hjO":function(e,M,L){"use strict";(function(a){L.d(M,"a",function(){return j});var e=L("o0o1"),p=L.n(e),t=L("yXPU"),o=L.n(t),n=L("lwsE"),r=L.n(n),i=L("W8MJ"),s=L.n(i),c=L("a1gu"),l=L.n(c),u=L("Nsbk"),d=L.n(u),h=L("7W2i"),f=L.n(h),g=L("y2sV"),m=L("QM+C"),v=L("HIeq"),b=L("M8cP"),y=L("eXiC"),E=L("q1tI"),O=L.n(E),C=(L("eYgS"),L("4fCv")),k=L("YNKm"),I=L("2ACu"),S=L("xYHj"),T=L("8H9L"),_=L("n/R6"),w=L("oJoF"),j=function(e){function t(e){var f;return r()(this,t),(f=l()(this,d()(t).call(this))).handleDidPasteAfterHyperLink=function(){var t=o()(p.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(f.insertionHelper&&f.service&&f.iframePopup){e.next=2;break}return e.abrupt("return");case 2:if(n=t.deltaSet,i=t.linkHandleBy,r=t.UNSAFE_text,o=t.startTime,i||f.insertionHelper.isHandledByOtherLinks(n))return e.abrupt("return");e.next=5;break;case 5:if(Object(T.b)()||Object(T.c)(f.editor)||!f.uuidAndUrl)return Object(I.default)("client_paste_url",{url_host:Object(b.c)(r),url_parse_type:"no_parse"}),e.abrupt("return");e.next=8;break;case 8:return a=Object(T.d)(f.uuidAndUrl),s=a.url,e.next=11,f.service.checkCanUrlExtract(s);case 11:if(c=e.sent,Object(I.default)("client_paste_url",{url_host:Object(b.c)(r),url_parse_type:c?"default_parse":"no_parse"}),c){e.next=15;break}return e.abrupt("return");case 15:if((l=f.editor.getEntities([[y.d,f.uuidAndUrl]])).length){e.next=18;break}return e.abrupt("return");case 18:if(u=l[0].end,d=f.insertionHelper.getPopUpPosition(f.editor,u)){e.next=22;break}return e.abrupt("return");case 22:h={title:f.insertLinkTitle,bookmark:f.insertBookMark,url:!0},f.iframePopup.show(d,h,function(){f.uuidAndUrl=null},{url_parse_type:"default_parse",startTime:o||Date.now()});case 24:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),f.render=function(e){var t=e.children,n=e.attributes;if(n[y.a]){var i=Object(T.d)(n[y.a]).url;if(i&&f.insertionHelper)return f.insertionHelper.renderLoading(i)}else if(n[y.f])return e.class="".concat(e.class," client-link-title-loading"),O.a.createElement("span",null,t,C.a);return t},f.insertBookmarkByAPanel=function(){var n=o()(p.a.mark(function e(t,n){var i,r,o;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(f.insertionHelper){e.next=2;break}return e.abrupt("return",!1);case 2:if(m.HYPERTEXT_URL_REG.test(t)){e.next=5;break}return _.a.error({content:a("CreationDoc_Docs_WebBookmark_WrongLink_Toast")}),e.abrupt("return",!1);case 5:return i=Date.now(),r=f.editor,o="".concat(Object(v.a)()).concat(y.g).concat(t),f.uuidAndUrl=o,f.insertionHelper.addBookmarkHolder(r,o),e.next=12,f.insertBookMark&&f.insertBookMark(n,i);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),f.handleIframePopupContext=function(){var t=o()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(f.service&&f.iframePopup&&f.insertBookMark&&f.insertLinkTitle){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,f.service.checkCanUrlExtract(t.url);case 4:e.sent&&(t.handlers.title=f.insertLinkTitle,t.handlers.bookmark=f.insertBookMark),f.iframePopup.show(t.targetOrPosition,t.handlers,t.hideCallback,t.logParams);case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),f.editor=e,f.editor.on(w.c,function(){return f.loadInsertionContext()}),f.removeEvents(),f.addEvents(),f}function n(){return i.apply(this,arguments)}var i;return f()(t,e),s()(t,[{key:"loadInsertionContext",value:(i=o()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([L.e("doc_index_css"),L.e("chunk_adit"),L.e("commons--doc_index_delay--voteEmoji--votePicker"),L.e(16),L.e("commons--doc_index_delay--jira"),L.e("doc_index_delay")]).then(L.bind(null,"EbIy"));case 2:return this.iframePopup=e.sent.default,this.iframePopup.init(this.editor),e.next=6,Promise.all([L.e("doc_index_css"),L.e("chunk_adit"),L.e("commons--doc_index_delay--voteEmoji--votePicker"),L.e(16),L.e("commons--doc_index_delay--jira"),L.e("doc_index_delay")]).then(L.bind(null,"+eCM"));case 6:return this.insertionHelper=e.sent,e.next=9,Promise.all([L.e("doc_index_css"),L.e("chunk_adit"),L.e("commons--doc_index_delay--voteEmoji--votePicker"),L.e(16),L.e("commons--doc_index_delay--jira"),L.e("doc_index_delay")]).then(L.bind(null,"RHU8"));case 9:e.t0=e.sent.SmartLinkService,this.service=new e.t0;case 11:case"end":return e.stop()}},e,this)})),n)},{key:"destroy",value:function(){this.removeEvents(),this.iframePopup&&this.iframePopup.destroy()}},{key:"addEvents",value:function(){var l=this;this.editor.on("didPastAfterHyperlink",this.handleDidPasteAfterHyperLink),this.editor.on("iframePopupContextToSmartLink",this.handleIframePopupContext),this.editor.commands.registerCommand(k.j,function(){var r=o()(p.a.mark(function e(t,n,i,r){var o,a,s,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(o=n).selection.getSelection(),s=o.getContentState().getActiveZone().getLine(a.start.line)){e.next=5;break}return e.abrupt("return");case 5:return s._entry.getLineRect(),e.next=8,Promise.all([L.e("doc_index_css"),L.e("chunk_adit"),L.e("commons--doc_index_delay--voteEmoji--votePicker"),L.e(16),L.e("commons--doc_index_delay--jira"),L.e("doc_index_delay")]).then(L.bind(null,"nYw7"));case 8:c=e.sent,(0,c.showBookmarkPopup)(o,l.insertBookmarkByAPanel),Object(I.default)("toggle_attribute",{action:"bookmark",source:"a_panel"});case 12:case"end":return e.stop()}},e)}));return function(e,t,n,i){return r.apply(this,arguments)}}(),{statusKey:"url-"})}},{key:"removeEvents",value:function(){this.editor.off("didPastAfterHyperlink",this.handleDidPasteAfterHyperLink),this.editor.off("iframePopupContextToSmartLink",this.handleIframePopupContext)}},{key:"editorWillPaste",value:function(e){var t=e.deltaSet,n=e.zoneId,i=e.event,r=this.editor;if(Object(T.b)()||Object(T.c)(r)||Object(S.o)(r))return t;var o=Object(T.e)(i);if(!o)return t;var a=t.get(n);return a.zoneType!==g.F.Content||(this.uuidAndUrl="".concat(Object(v.a)()).concat(y.g).concat(o[0]),t.replace(n,Object(T.a)(a,o[0],this.uuidAndUrl))),t}},{key:"match",value:function(e){return-1<[y.a,y.f].indexOf(e)}},{key:"insertBookMark",get:function(){return!!(this.insertionHelper&&this.service&&this.uuidAndUrl)&&this.insertionHelper.insertBookMark(this.editor,this.uuidAndUrl,this.service)}},{key:"insertLinkTitle",get:function(){return!!(this.insertionHelper&&this.service&&this.uuidAndUrl)&&this.insertionHelper.insertLinkTitle(this.editor,this.uuidAndUrl,this.service)}}]),t}(g.p)}).call(this,L("2vAP"))},"9oD+":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i="doc_image"},"A+1H":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("n3ZB"),r=n("SGN9"),o=n("G8Hj"),a=n("D7h9"),s=n("OJOY"),c=n("wSsa"),l=function(){var e=Object(i.i)(a.default.getState()),t=(s.a.getItem(c.c)||{}).hasShow;return!!(Object(r.n)(e,o.STEP_TYPES.whats_new_notice_guide)||Object(r.n)(e,o.STEP_TYPES.whats_new_notice_guide_v2)||t)}},A1RT:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("J4zp"),a=n.n(i),r=n("lwsE"),o=n.n(r),c=n("QM+C"),l="client_performance_doc_delete_keydown_to_paint",u="client_performance_doc_return_keydown_to_paint",d="client_performance_doc_keydown_to_paint",h="client_performance_doc_composition_end_to_paint",f="keydown",p=[17,18,91,93,38,40,37,39,16],g=8,m=13,v=1,b=.2,y=100,s=function e(t){var s=this;o()(this,e),this.profileState=new Map,this.resetProfileState=function(){[l,u,d,h].forEach(function(e){var t={totalKeyCodes:0,inStateKeyCodes:0,inState:!1};s.profileState.set(e,t)})},this.bindKeyDownEvent=function(){var e=s.editor.getDocBody();e&&e.addEventListener("keydown",s.handleKeyDown,{capture:!0,passive:!0})},this.unbindKeyDownEvent=function(){var e=s.editor.getDocBody();e&&e.removeEventListener("keydown",s.handleKeyDown,{capture:!0})},this.handleKeyDown=function(e){var t,n,i,r,o,a;s.editor.profile&&(t=e.type,n=e.keyCode,-1<p.indexOf(n)||t===f&&(i=s.profileState.get(l),r=s.profileState.get(u),s.editor.getInInternationalComposition()||(o=n===m,n!==g||i.inState||(s.startProfile(l),i.inState=!0),o&&!r.inState&&(s.startProfile(u),r.inState=!0)),(a=s.profileState.get(d)).inState||(s.startProfile(d),a.inState=!0),[i,r,a].forEach(function(e){e.inState&&e.inStateKeyCodes++})))},this.aceBeforeCompositionEnd=function(e,t){var n;s.editor.profile&&(n=s.profileState.get(h),s.startProfile(h),n.inState=!0)},this.aceAfterCompositionEnd=function(e,t){var n,i,r;s.editor.profile&&(n=s.profileState.get(h),r=(i=t.evt.originalEvent)&&i.data?i.data:"",n.inStateKeyCodes+=r.length)},this.startProfile=function(e){var t={isComposeAcceptable:!1,beforeEnd:s.handleBeforeEnd,beforeSend:s.handleBeforeSend,conditionSampleRate:function(e){var t=e.usedTime;return y<t?v:b}};s.editor.profile.start(e),[u,l].includes(e)&&s.editor.profile.pushData(e,{lineType:s.getLineType()}),s.editor.profile.endByNextRender(e,t)},this.getLineType=function(){try{for(var e=s.editor.getRep(),t=e.attributeManager.getAttributesOnLine(e.selStart[0]),n=0;n<t.length;n++){var i=a()(t[n],2),r=i[0],o=i[1];if("heading"===r)return"heading";if("list"===r)return/([a-z]+)([0-9]+)/.exec(o)[1];if("blockquote"===r)return"blockquote";if("gallery"===r)return"gallery"}}catch(e){console.error(e)}return""},this.handleBeforeEnd=function(e){var t=s.profileState.get(e);t.totalKeyCodes+=t.inStateKeyCodes,t.inStateKeyCodes=0,t.inState=!1},this.handleBeforeSend=function(e){var t=s.profileState.get(e),n=t.totalKeyCodes;t.totalKeyCodes=t.inStateKeyCodes;var i=s.editor.getRep(),r=!(!c.USE_BLOCK_RENDER||!c.USE_BLOCK_RENDER.fiber);return{unmount:!(!c.USE_BLOCK_RENDER||!c.USE_BLOCK_RENDER.unmount),key_code_count:n,is_fiber:r,zoneId:i.zoneId,is_lazy_block:!0}},this.reset=function(e,t){s.resetProfileState(),s.unbindKeyDownEvent()},this.editor=t,this.resetProfileState(),this.bindKeyDownEvent()}},A9Q4:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=(n("5uCJ"),n("y2sV")),c=function(){function t(e){r()(this,t),this.className="TabKey"}return a()(t,[{key:"renderLine",value:function(e){var t,n=e.lineState,i=e.children;return n.getLineAttributes().toMap()["text-indent"]&&(t=e.lineClass?" ":"",e.lineClass+="".concat(t,"text-indent")),i}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;return t instanceof HTMLElement&&-1<t.className.indexOf("text-indent")?Object(s.I)(n,i,{"text-indent":"true"}):n}}]),t}();new c},ABxt:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24"},t),c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("path",{d:"M12.03 18.24l2.02-1.98h4.15c.03 0 .05-.02.05-.05V5.8a.05.05 0 00-.05-.05H5.8a.05.05 0 00-.05.05v10.41c0 .03.02.05.05.05h4.15l2.02 1.98h.06z",stroke:"#2B2F36",strokeWidth:"1.5"}),c.a.createElement("rect",{fill:"#2B2F36",x:"8",y:"10",width:"8",height:"1.5",rx:".4"})))}},AH9Y:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("2ACu"),c=n("VI6H"),l=n("vc5i"),u=n("D7h9"),d="viewEditorsPreference",h=function(){function e(){r()(this,e)}return a()(e,[{key:"getPreferenceStatus",value:function(){var e=this.getUserPreference(),t=Object(l.n)(u.default.getState());if(e.hasOwnProperty(t))return e[t]}},{key:"removeCurrentPreference",value:function(){var e=Object(l.n)(u.default.getState()),t=this.getUserPreference();try{delete t[e]}catch(e){Object(s.default)("dev_doc_view_editors_preference_storage_fail",{action:"remove",err:e})}this.setUserPreference(t)}},{key:"addCurrentPreference",value:function(e){var t=Object(l.n)(u.default.getState()),n=this.getUserPreference();n[t]=e,this.setUserPreference(n)}},{key:"setUserPreference",value:function(e){try{var t=localStorage.getItem(d),n=t?JSON.parse(t):{};n[Object(c.c)().get("id")]=e,localStorage.setItem(d,JSON.stringify(n))}catch(e){Object(s.default)("dev_doc_view_editors_preference_storage_fail",{action:"set",err:e})}}},{key:"getUserPreference",value:function(){try{var e=localStorage.getItem(d),t=(e?JSON.parse(e):{})[Object(c.c)().get("id")];return t?t:{}}catch(e){return{}}}}]),e}();t.a=new h},ALb8:function(e,t,n){"use strict";n.d(t,"g",function(){return i}),n.d(t,"j",function(){return r}),n.d(t,"k",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return h}),n.d(t,"b",function(){return f});var i="REMINDER_GENERATE_BLOCK",r="REMINDER_PLUGIN_SET_PROPS",o="REMINDER_PROPS_CHANGE",a="REMINDER_BLOCK_CLICK",s="REMINDER_BLOCK_MOUSE_ENTER",c="REMINDER_BLOCK_MOUSE_LEAVE",l="REMINDER_CLICK",u="REMINDER_DELETED",d="REMINDER_MOUSE_ENTER",h="REMINDER_MOUSE_LEAVE",f="REMINDER_BLOCK_DELETED"},APdQ:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzAiIGhlaWdodD0iMzAiPgogICAgPGRlZnM+CiAgICAgICAgPHBhdGggaWQ9ImEiIGQ9Ik0xNS4xMDYuMTM5TDguNTYgNy4xOTNhLjI0Mi4yNDIgMCAwIDAtLjA2LjIxM2MuMDk3LjQ2Ny0uMDM2Ljk3MS0uNCAxLjMzNGExLjQ3MiAxLjQ3MiAwIDAgMS0yLjA5OC0uMDIyTC4yOSAxNC40MTRhLjg0OC44NDggMCAwIDAtLjI0Ny42NjRsLjU2MiA3LjQ5OCA2LjExMyA2LjA5NmEuNTEyLjUxMiAwIDAgMCAuODUzLS4yMThMMTUuNzA2LjQ2OWEuMzUzLjM1MyAwIDAgMC0uMzQ1LS40NDVjLS4wOSAwLS4xOC4wMzUtLjI1NS4xMTV6Ii8+CiAgICAgICAgPHBhdGggaWQ9ImMiIGQ9Ik0xNS4xMDYuMTM5TDguNTYgNy4xOTNhLjI0Mi4yNDIgMCAwIDAtLjA2LjIxM2MuMDk3LjQ2Ny0uMDM2Ljk3MS0uNCAxLjMzNGExLjQ3MiAxLjQ3MiAwIDAgMS0yLjA5OC0uMDIyTC4yOSAxNC40MTRhLjg0OC44NDggMCAwIDAtLjI0Ny42NjRsLjU2MiA3LjQ5OCA2LjExMyA2LjA5NmEuNTEyLjUxMiAwIDAgMCAuODUzLS4yMThMMTUuNzA2LjQ2OWEuMzUzLjM1MyAwIDAgMC0uMzQ1LS40NDVjLS4wOSAwLS4xOC4wMzUtLjI1NS4xMTV6Ii8+CiAgICAgICAgPHBhdGggaWQ9ImUiIGQ9Ik0yOC41MDcuMDYxTC40NDMgOC4xNzNhLjUxLjUxIDAgMCAwLS4yMi44NWw2LjExNCA2LjA5NiA3LjUyLjU2MWEuODU0Ljg1NCAwIDAgMCAuNjY2LS4yNDdsNS43MTItNS42OTZhMS40NjIgMS40NjIgMCAwIDEtLjAyMi0yLjA5MiAxLjQ3IDEuNDcgMCAwIDEgMS4zMzctLjQuMjQ0LjI0NCAwIDAgMCAuMjE0LS4wNTlMMjguODM4LjY2Yy4yNDUtLjIyNi4wNjctLjYxMS0uMjMzLS42MTFhLjM3NS4zNzUgMCAwIDAtLjA5OC4wMTN6Ii8+CiAgICAgICAgPHBhdGggaWQ9ImciIGQ9Ik0yOC41MDcuMDYxTC40NDMgOC4xNzNhLjUxLjUxIDAgMCAwLS4yMi44NWw2LjExNCA2LjA5NiA3LjUyLjU2MWEuODU0Ljg1NCAwIDAgMCAuNjY2LS4yNDdsNS43MTItNS42OTZhMS40NjIgMS40NjIgMCAwIDEtLjAyMi0yLjA5MiAxLjQ3IDEuNDcgMCAwIDEgMS4zMzctLjQuMjQ0LjI0NCAwIDAgMCAuMjE0LS4wNTlMMjguODM4LjY2Yy4yNDUtLjIyNi4wNjctLjYxMS0uMjMzLS42MTFhLjM3NS4zNzUgMCAwIDAtLjA5OC4wMTN6Ii8+CiAgICA8L2RlZnM+CiAgICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGZpbGw9IiMzOEYiIGQ9Ik0yOS4zMzkgMS4yMTdMMjIuNzkzIDguMjdhLjI0Mi4yNDIgMCAwIDAtLjA2LjIxNGMuMDk3LjQ2Ni0uMDM2Ljk3LS40IDEuMzMzLS41OC41OC0xLjUyNi41NzEtMi4wOTgtLjAyMmwtNS43MTIgNS42OTZhLjg0OS44NDkgMCAwIDAtLjI0Ny42NjRsLjU2MiA3LjQ5OSA2LjExMyA2LjA5NWEuNTEyLjUxMiAwIDAgMCAuODUzLS4yMThMMjkuOTQgMS41NDdjLjA5NS0uMzU1LS4zNS0uNi0uNi0uMzMiLz4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNC4yMzMgMS4wNzgpIj4KICAgICAgICAgICAgPG1hc2sgaWQ9ImIiIGZpbGw9IiNmZmYiPgogICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjYSIvPgogICAgICAgICAgICA8L21hc2s+CiAgICAgICAgICAgIDxwYXRoIGZpbGw9IiMzMjg4RkYiIGQ9Ik0xNi4xNjYtMS4xMTFMOC41NyA3LjA3NWEuMjQyLjI0MiAwIDAgMC0uMDYuMjEzYy4wOTguNDczLS4wMzcuOTg0LS40MDUgMS4zNWExLjQ4OCAxLjQ4OCAwIDAgMS0yLjEyMS0uMDIxTC0uMDcgMTQuNjUzbC41OTggNy45NzMgNi43OTkgNi43OCA4Ljg0LTMwLjUxN3oiIG1hc2s9InVybCgjYikiLz4KICAgICAgICA8L2c+CiAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQuMjMzIDEuMDc4KSI+CiAgICAgICAgICAgIDxtYXNrIGlkPSJkIiBmaWxsPSIjZmZmIj4KICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI2MiLz4KICAgICAgICAgICAgPC9tYXNrPgogICAgICAgICAgICA8cGF0aCBmaWxsPSIjMDA1REUwIiBkPSJNMTYuMDc1LS45MDZMOC41NjEgNy4xOTNhLjI0Mi4yNDIgMCAwIDAtLjA2LjIxM2MuMDk2LjQ2Ny0uMDM3Ljk3MS0uNCAxLjMzNGExLjQ3MiAxLjQ3MiAwIDAgMS0yLjA5OS0uMDIyTC4wNTIgMTQuNjVhLjExOS4xMTkgMCAwIDAtLjAzNC4wOTNsLjU4NyA3LjgzMkwxNS43NTgtLjIxOWwuMzE3LS42ODd6IiBtYXNrPSJ1cmwoI2QpIi8+CiAgICAgICAgPC9nPgogICAgICAgIDxwYXRoIGZpbGw9IiNGRkYiIGQ9Ik0yOC44MzguNzE4bC03LjA3NCA2LjUyNmEuMjQzLjI0MyAwIDAgMS0uMjE0LjA2IDEuNDcxIDEuNDcxIDAgMCAwLTEuMzM3LjM5OWMtLjU4MS41OC0uNTczIDEuNTIyLjAyMiAyLjA5M2wtNS43MTIgNS42OTZhLjg1NC44NTQgMCAwIDEtLjY2Ni4yNDZsLTcuNTItLjU2TC4yMjQgOS4wOGEuNTEuNTEgMCAwIDEgLjIxOS0uODVMMjguNTA3LjExOWMuMzU2LS4wOTUuNjAxLjM1LjMzMS41OTkiLz4KICAgICAgICA8Zz4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAuMDU4KSI+CiAgICAgICAgICAgICAgICA8bWFzayBpZD0iZiIgZmlsbD0iI2ZmZiI+CiAgICAgICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjZSIvPgogICAgICAgICAgICAgICAgPC9tYXNrPgogICAgICAgICAgICAgICAgPHBhdGggZmlsbD0iIzQ2RUJENSIgZD0iTTMwLjA5Mi0uMzk4bC04LjIxIDcuNTc0YS4yNDMuMjQzIDAgMCAxLS4yMTQuMDYxIDEuNDg3IDEuNDg3IDAgMCAwLTEuMzU0LjQwMyAxLjQ3OCAxLjQ3OCAwIDAgMCAuMDIyIDIuMTE2bC02LjA1NCA2LjAzNi03Ljk5NS0uNTk3LTYuNzk4LTYuNzc4TDMwLjA5Mi0uMzk4eiIgbWFzaz0idXJsKCNmKSIvPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLjA1OCkiPgogICAgICAgICAgICAgICAgPG1hc2sgaWQ9ImgiIGZpbGw9IiNmZmYiPgogICAgICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI2ciLz4KICAgICAgICAgICAgICAgIDwvbWFzaz4KICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9IiMwMEQwQjYiIGQ9Ik0yOS44ODYtLjMwN2wtOC4xMjIgNy40OTNhLjI0My4yNDMgMCAwIDEtLjIxNC4wNiAxLjQ3MSAxLjQ3MSAwIDAgMC0xLjMzNy4zOTljLS41ODEuNTc5LS41NzMgMS41MjIuMDIyIDIuMDkybC01Ljk1IDUuOTMzYS4xMi4xMiAwIDAgMS0uMDkzLjAzNWwtNy44NTUtLjU4NkwyOS4xOTcuMDA5bC42ODktLjMxNnoiIG1hc2s9InVybCgjaCkiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg=="},AYG9:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"d",function(){return d}),n.d(t,"b",function(){return h}),n.d(t,"c",function(){return f});var i,r,o=n("LrQZ"),a=n("2ACu"),s=n("FnDM"),c=n("SebV");function l(e){try{Object(a.default)("quickjs_sdk_error",{quick_sdk_error_name:e.name,quick_sdk_error_msg:e.message,quick_sdk_error_stack:e.stack})}catch(e){Object(c.a)(e)}}(r=i=i||{}).DOC_PAGE_OPEN="docs_page_open",r.AFTER_SCROLL="after_scroll",r.AFTER_EDIT="doc_scene_after_edit",r.ADD_COMMENT="doc_scene_add_comment",r.BACK_HOME="doc_scene_back_home",r.AFTER_ONE_MINUTE="doc_scene_open_after_one_minute";var u=function(e){var t=e.eventName,n=e.data;Object(a.default)(t,n)};try{"undefined"!=typeof XMLHttpRequest&&Object(o.d)({eventRecordHandler:u,errorHandler:l})}catch(e){l(e)}function d(e){try{Object(o.c)(i.DOC_PAGE_OPEN,{file_type:e||Object(s.f)()})}catch(e){l(e)}}function h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};try{Object(o.a)(e,Object.assign({},t))}catch(e){l(e)}}function f(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};try{Object(o.b)(e,t)}catch(e){l(e)}}},AcDe:function(e,t,n){"use strict";var i=n("J4zp"),d=n.n(i),r=n("lwsE"),a=n.n(r),o=n("W8MJ"),s=n.n(o),c=n("a1gu"),l=n.n(c),u=n("Nsbk"),h=n.n(u),f=n("7W2i"),p=n.n(f),g=n("XIp8"),m=n("Muja"),v=n("q1tI"),y=n.n(v),b=n("uQON"),E=n("skFV"),O=n("TSYQ"),C=n.n(O),k=n("HIeq"),I=n("Ye3z"),S=n("n67m"),T=function(){function o(e){var t=e.userList,n=e.docsList,i=e.replyId,r=e.onPermissionChange;a()(this,o),this.userList=new Set,this.embedObjList=new Map,this.embedTokenList=new Set,this.permissionMap=new Map,this.replyId=i,this.onPermissionChange=r,S.a.addInstance(i,this),0<t.length&&(S.a.initUserManager(),this.initUsers(t)),0<n.length&&(S.a.initEmbedObjManager(),this.initDocs(n))}return s()(o,[{key:"getHavePermissions",value:function(){return 0<this.userList.size&&this.getPermissions("users"),0<this.embedTokenList.size&&this.getPermissions("docs"),0<this.permissionMap.size?this.permissionMap:null}},{key:"getPermissions",value:function(e){var t=S.a.getPermissions(e);if(t&&0<Object.keys(t).length)for(var n in t){var i=this.getTokenList(e);if(!i)return;if(i.has(n)){if(!t[n])return;var r=t[n],o=r.readable,a=r.cantRead;"users"===e&&this.permissionMap.set(n,o),"docs"===e&&this.permissionMap.set(n,!a)}}}},{key:"destory",value:function(){S.a.removeUsers(Array.from(this.userList)),S.a.removeDocs(Array.from(this.embedObjList.values())),S.a.delete(this.replyId)}},{key:"initUsers",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;this.userList.add(a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}S.a.initUsers(e)}},{key:"initDocs",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=a.token;this.embedTokenList.add(s),this.embedObjList.set(s,a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}S.a.initDocs(e)}},{key:"changeEmbedObjList",value:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.token;t.push(c),this.embedObjList.set(c,s)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}this.changeTokenList("docs",t)}},{key:"changeUserList",value:function(e){this.changeTokenList("users",e)}},{key:"getTokenList",value:function(e){return"users"===e?this.userList:"docs"===e?this.embedTokenList:null}},{key:"changeTokenList",value:function(e,t){var n,i,r,o=this,a=this.getTokenList(e);a&&(n=Object(I.a)(Array.from(a),t),i=[],r=[],n.forEach(function(e){(o.userList.has(e)?r:i).push(e)}),0<r.length&&("users"===e&&this.removeUsers(r),"docs"===e&&this.removeDocs(r)),0<i.length&&("users"===e&&this.addUsers(i),"docs"===e&&this.addDocs(i)),this.getHavePermissions()&&this.onPermissionChange(this.permissionMap))}},{key:"addUsers",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;this.userList.add(a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}S.a.addUsers(e)}},{key:"removeUsers",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;this.userList.delete(a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}S.a.removeUsers(e)}},{key:"addDocs",value:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.embedTokenList.add(s);var c=this.embedObjList.get(s);c&&t.push(c)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}S.a.addDocs(t)}},{key:"removeDocs",value:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.embedTokenList.delete(s);var c=this.embedObjList.get(s);c&&(t.push(c),this.embedObjList.delete(s))}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}S.a.removeDocs(t)}},{key:"handlePermissionChange",value:function(e){var l=this,u=!1;e.forEach(function(e){var t,n,i=e.permission,r=e.userId,o=e.token,a=r||o||"",s=r?"users":o?"docs":"",c=l.getTokenList(s);c&&c.has(a)&&(u=!0,i?(t=i.readable,n=i.cantRead,r?l.permissionMap.set(a,t):o&&l.permissionMap.set(a,!n)):l.permissionMap.set(a,!1))}),u&&this.onPermissionChange(this.permissionMap)}}]),o}(),_=n("nN3d"),w=n("Mpt7"),j=n("rFy5"),M=n("7ESD"),L=n("kOe7"),R=n("VI6H"),N=n("QM+C"),D=n("KiYW"),x=n("fRrQ"),P=n("rLED"),B=(n("NWgW"),n("gNEk")),U=n("5gSl"),z=function(e){function i(e){var u;a()(this,i),(u=l()(this,h()(i).call(this,e))).selections=[],u.handlePermissionChange=function(e){var t=new Map,n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=d()(o.value,2),c=s[0],l=s[1];t.set(c,l)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}u.setState({permissionMap:t})},u.getIconUrl=function(e){var t=JSON.parse(e),n=t.type,i=t.key,r=t.fs_unit;return Object(P.n)()&&n===N.NUM_CUSTOM_ICON_TYPE.IMAGE?Object(D.e)({key:i,fs_unit:r}):""},u.handleLinkClick=function(e){Object(B.b)(e.nativeEvent),Object(b.n)(),Object(U.a)(e)},u.getElement=function(e){u.element=e};var t=u.handleNodeList(),n=u.initPermisionMap(t);return u.state={nodeList:t,permissionMap:n||new Map},u.initTextHighLightList(),u}return p()(i,e),s()(i,[{key:"initTextHighLightList",value:function(){var e=this.props,t=e.replyId,n=e.commentId,i=e.isTranslateContent;M.a.register(n,t,i,this)}},{key:"componentDidUpdate",value:function(e){var t=this,n=e.content,i=e.entities,r=this.props,o=r.content,a=r.entities,s=r.isTranslateContent,c=r.commentId,l=r.replyId;[c!==e.commentId,l!==e.replyId,s!==e.isTranslateContent].includes(!0)&&(M.a.unRegister(e.commentId,e.replyId,e.isTranslateContent),M.a.register(c,l,s,this)),(o!==n||i&&a&&a.users&&i.users&&!Object(w.is)(a.users,i.users))&&this.setState({nodeList:this.handleNodeList()},function(){t.updateUserList()})}},{key:"componentWillUnmount",value:function(){this.selections=[],this.contentManager&&this.contentManager.destory(),this.contentManager=null;var e=this.props,t=e.replyId,n=e.commentId,i=e.isTranslateContent;M.a.unRegister(n,t,i)}},{key:"highlight",value:function(t){var e=this.selections.find(function(e){return Object(m.default)(Object.assign({},e,{isSelected:!1}),Object.assign({},t,{isSelected:!1}))});if(e){if(e.isSelected===t.isSelected)return;e.isSelected=t.isSelected}else this.selections.push(Object(g.default)(t));this.setState({nodeList:this.handleNodeList()})}},{key:"clearHighlight",value:function(t){if(!t)return this.selections=[],void this.setState({nodeList:this.handleNodeList()});var e=this.selections.findIndex(function(e){return Object(m.default)(Object.assign({},e,{isSelected:!1}),Object.assign({},t,{isSelected:!1}))});-1<e&&(this.selections.splice(e,1),this.setState({nodeList:this.handleNodeList()}))}},{key:"updateUserList",value:function(){var e=this.state.nodeList,t=this.props.embedObjShareEnable,o=[],a=[];e.forEach(function(e){var t,n,i=e.type,r=e.token;"mentionDefaultUser"===i&&o.push(r),"mentionLink"===i&&(t=e.mentionType,n=e.content,a.push({type:L.c[t],title:n,token:r}))}),this.contentManager&&(0<o.length&&this.contentManager.changeUserList(o),t&&0<a.length&&this.contentManager.changeEmbedObjList(a))}},{key:"initPermisionMap",value:function(e){var t=this.props,n=t.replyId,i=t.embedObjShareEnable,o=[],a=[];if(e.forEach(function(e){var t,n,i=e.type,r=e.token;"mentionDefaultUser"===i&&o.push(r),"mentionLink"===i&&(t=e.mentionType,n=e.content,a.push({type:L.c[t],title:n,token:r}))}),0<o.length||0<a.length){var r=Object(_.a)();this.contentManager=new T({replyId:n+r,userList:o,docsList:i?a:[],onPermissionChange:this.handlePermissionChange});var s=this.contentManager.getHavePermissions();if(s)return s}return null}},{key:"getHighlightContent",value:function(e){var a=this.props.content;if(!e||!e.length)return a;var t,s="",c=0;return e.map(function(e){var t=e.ranges,o=e.isSelected;t.map(function(e){var t=e.startIndex,n=e.endIndex,i=e.content,r=a.slice(c,t);r&&(s+=r),s+='<highlight isOn="'.concat(o,'">').concat(i,"</highlight>"),c=n})}),c<a.length&&(t=a.slice(c),s+=t),s}},{key:"handleAtNode",value:function(e){var t=e.href,n=e.type,i=e.token,r=e.content,o=e.icon,a="mention mention-type_".concat(n," mention-token_").concat(i),s="";t&&(a+=" mention-link_".concat(encodeURIComponent(t)),s="_blank"),o&&(a+=" mention-icon_".concat(o)),(Object(R.n)(i)||Object(R.j)())&&(a+=" popover-disabled");var c=Object(E.h)(),l=new RegExp("[^<>]+(".concat(c.map(function(e){return e.replace(/\./g,"\\.")}).join("|"),")[^<>]+")),u=t&&l.test(t)?t:"javascript:void(0)",d=Object(j.a)(r),h=t?"mentionLink":"mentionDefaultUser";return Object(P.G)()&&"mentionDefaultUser"===h&&"@"===d[0]&&(d=d.slice(1)),{type:h,content:d,className:a,token:i,mentionType:n,href:u,target:s,icon:o,children:Object(b.c)(d)}}},{key:"handleTextNode",value:function(e){var o=Object(j.a)(e),t=Object(b.e)(o);if(t.length<=0)return Object(b.g)(o);o=(o=o.replace(/<highlight isOn="([\s\S]*?)">/gi,"")).replace(/<\/highlight>/gi,"");var n,a=[],s=0;return t.forEach(function(e){var t=e.startIndex,n=e.endIndex,i=e.url,r=o.slice(s,t);r&&a.push(Object(b.g)(r)),a.push(Object(b.f)(i)),s=n}),s<o.length&&(n=o.slice(s),a.push(Object(b.g)(n))),a}},{key:"handleNodeList",value:function(){var e,t,a=this,s=this.getHighlightContent(this.selections),c=[],n=Object(b.b)(s),l=0;return n.forEach(function(e){var t,n=e.startIndex,i=e.endIndex,r=s.slice(l,n);r&&(t=a.handleTextNode(r),c=c.concat(t));var o=a.handleAtNode(e);c.push(o),l=i}),l<s.length&&(e=s.slice(l),t=this.handleTextNode(e),c=c.concat(t)),c}},{key:"getMention",value:function(){var g=this,e=this.state,t=e.nodeList,m=e.permissionMap,v=this.props.embedObjShareEnable,b=function(e){return e.children?e.children.map(function(e,t){var n=e.content,i=e.type,r=e.className;return"text"===i?y.a.createElement("span",{key:t},n):"highlight"===i?y.a.createElement("span",{key:t,className:r},n):null}):e.content};return t.map(function(e,t){var n=g.props.grantViewAccessDisabled,i=e.type,r=e.className,o=e.token,a=e.href,s=e.target,c=e.icon;if(o&&"mentionDefaultUser"===i){var l=Object(k.d)(),u=!1===m.get(o),d=C()(r,{"at-self-highlight":o===l,"at-no-readble":!0!==n&&u,"grant-view-access-disabled":!0===n,"at-user-disabled":u,"at-user-text":!0});return Object(P.G)()?y.a.createElement("div",{className:"inline-block-placeholder block-type-AT_USER_BLOCK"},y.a.createElement("a",{href:"javascript:void(0)",key:t,className:d,"data-token":o,target:s},y.a.createElement("span",null,y.a.createElement(x.a,{userId:o}),b(e)))):y.a.createElement("span",{key:t,className:d,"data-token":o},y.a.createElement("a",{href:"javascript:void(0)",target:s},b(e)))}if(o&&"mentionLink"===i){var h=!1===m.get(o),f=c?g.getIconUrl(c):"",p=C()("comment",{"content-with-lock":v&&h,"content-with-icon":c&&f});return y.a.createElement("span",{key:t,className:r,"data-token":o},y.a.createElement("a",{href:a,target:s,className:p,onClick:g.handleLinkClick},c&&f&&y.a.createElement("i",{style:{backgroundImage:"url(".concat(f,")")},className:"mention-doc-icon"}),b(e)))}return"text"===i?y.a.createElement("span",{key:t},b(e)):"link"===i?y.a.createElement("span",{key:t},y.a.createElement("a",{href:a,rel:"noopener noreferrer",target:s,className:r,onClick:g.handleLinkClick},b(e))):null})}},{key:"render",value:function(){var e=this.props,t=e.contentCls,n=e.contentStyle,i=e.isEdit,r=C()(t,{"comment-list-item__content-edit":i,"new-mention-ui":Object(P.G)()});return y.a.createElement("div",{ref:this.getElement,className:r,style:n},y.a.createElement("span",null,this.getMention()),this.props.children)}}]),i}(v.Component);t.a=z},Ae4K:function(e,t,i){"use strict";var d={};i.r(d),i.d(d,"CancelTokenSource",function(){return _.CancelTokenSource}),i.d(d,"setEnvConfigs",function(){return x}),i.d(d,"CancelToken",function(){return U}),i.d(d,"getShouldUseNearbyDriveAPI",function(){return H}),i.d(d,"request",function(){return ne}),i.d(d,"post",function(){return re}),i.d(d,"postUrlEncoded",function(){return oe}),i.d(d,"postFormData",function(){return ae}),i.d(d,"importPostFormData",function(){return ce}),i.d(d,"importGet",function(){return le});var c,l,r,b=i("BAjd"),n=i("RIqP"),f=i.n(n),o=i("J4zp"),k=i.n(o),a=i("o0o1"),I=i.n(a),s=i("yXPU"),p=i.n(s),u=i("lwsE"),h=i.n(u),g=i("W8MJ"),m=i.n(g),v=i("a1gu"),y=i.n(v),E=i("Nsbk"),O=i.n(E),C=i("7W2i"),S=i.n(C),T=i("7EGn"),_=i("vYB2"),w=i.n(_),j=i("Qyje"),M=i.n(j),L=i("95pV"),R=i("TJya"),N=i("qkt2"),D=i("EAIz");function x(e){var t=e.defaultNearbyDriveAPI,n=e.driveStreamAPIHost,i=e.isNearbyDriveAPIEnabled;c=t,l=n,r=i}var P=w.a.create({withCredentials:!0});Object(L.a)(P);var B=function(e){return"".concat(P.defaults.baseURL).concat(e).replace(/(?:^.*\/\/[^\/]+\/)|(?:\/*(?:\?.*)?$)/g,"").replace(/\//g,".")},U=w.a.CancelToken,z=!1;function H(){return!z&&r&&c}var F,V,W=20,K=16e3,Z=2e3;(V=F=F||{}).INCREASE="increase",V.REDUCE="reduce";var q=new Map,Y=new Map;function J(e,t){var n=q.get(e),i=n||0;t===F.INCREASE?i=n?Math.min(K,2*n):Z:t===F.REDUCE&&(i=n&&Z<n?n/2:0),q.set(e,i)}function Q(e){Y.delete(e)}function X(e){var t=Y.get(e),n=t?t+1:1;Y.set(e,n)}function $(e){X(e),J(e,F.INCREASE)}function ee(e){Q(e),J(e,F.REDUCE)}function te(e){var t=e.match(/^https?\:\/\/[^\/?#]*([^?#]*).*$/);return t&&t[1]?t[1]:e}var ne=function(){var t=p()(I.a.mark(function e(t){var n,i,r,o,a,s;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=te(t.url),e.prev=1,i=q.get(n))return e.next=6,Object(N.i)(i);e.next=6;break;case 6:return e.next=8,P(t);case 8:if(r=e.sent,0!==(o=r.data).code)throw{response:r};e.next=12;break;case 12:return ee(n),e.abrupt("return",o.data);case 16:if(e.prev=16,e.t0=e.catch(1),!e.t0.response||429!==e.t0.response.status){e.next=24;break}if((a=Y.get(n))&&W<=a)throw e.t0.response.data;e.next=22;break;case 22:return $(n),e.abrupt("return",ne(t));case 24:if(s=401===Object(T.default)(e.t0,"response.status")||Object(T.default)(e.t0,"response.data.code")===b.i,l&&s&&H()&&t.url.includes(c))return z=!0,t.url=t.url.replace("https://".concat(c),l),e.abrupt("return",ne(t));e.next=29;break;case 29:if(ee(n),e.t0.response){e.next=32;break}throw new Error("Network Error");case 32:throw e.t0.response.data;case 33:case"end":return e.stop()}},e,null,[[1,16]])}));return function(e){return t.apply(this,arguments)}}(),ie=function(){var i=p()(I.a.mark(function e(t,n,i){var r;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object.assign({},Object(R.a)(),{"x-command":B(t)},i?i.headers:null),e.t0=D.e,e.t0)return e.t1=Object,e.t2=r,e.next=7,Object(D.c)();e.next=9;break;case 7:e.t3=e.sent,e.t1.assign.call(e.t1,e.t2,e.t3);case 9:return e.abrupt("return",ne(Object.assign({},i,{url:t,method:"post",headers:r,data:n})));case 10:case"end":return e.stop()}},e)}));return function(e,t,n){return i.apply(this,arguments)}}(),re=function(e,t,n){return ie(e,t,n)},oe=function(e,t,n){return ie(e,M.a.stringify(t),Object.assign({},n,{headers:Object.assign({"Content-Type":"application/x-www-form-urlencoded"},n?n.headers:null)}))},ae=function(e,t,n){return ie(e,t,Object.assign({},n,{headers:Object.assign({"Content-Type":"multipart/form-data"},n?n.headers:null)}))},se=function(){var t=p()(I.a.mark(function e(t){var n,i;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P(t);case 3:return n=e.sent,i=n.data,e.abrupt("return",i);case 8:if(e.prev=8,e.t0=e.catch(0),e.t0.response){e.next=12;break}throw new Error("Network Error");case 12:throw e.t0.response.data;case 13:case"end":return e.stop()}},e,null,[[0,8]])}));return function(e){return t.apply(this,arguments)}}(),ce=function(e,t,n){return se(Object.assign({},n,{url:e,method:"post",headers:Object.assign({"x-command":B(e),"Content-Type":"multipart/form-data"},n?n.headers:null),data:t}))},le=function(e,t,n){return se(Object.assign({},n,{url:e,method:"get",headers:Object.assign({"x-command":B(e)},n?n.headers:null),params:t}))},ue=i("gfe6"),de=i("QM+C"),he=i("D7h9"),fe=i("5cZX"),pe=function(){function n(e){var c=this;h()(this,n),this.tasks=[],this.events=[],this._retry=!1,this.defaults={simultaneousUploads:3,dragOverClass:"dragover",throttleProgressCallbacks:1,prepareTarget:b.b.PREPARE,testTarget:b.b.CHUNK_CHECK,uploadTarget:b.b.CHUNK_UPLOAD,finishTarget:b.b.FINISH,xhrTimeout:0,clearInput:!0,setChunkTypeFromFile:!1,fastModeEnabled:!1,getMountPoint:function(){return""},shouldAddToRecents:!0,getParentToken:function(){return""},createDirectory:function(){return Promise.resolve("")},uploadChunk:function(){return Promise.resolve("")},uploadMergedChunk:function(){return Promise.resolve("")},minFileSize:1,minFileSizeErrorCallback:function(e,t){alert(e.name+" is too small, please upload files larger than "+Object(N.a)(c.getOpt(b.l.minFileSize))+".")},maxFileSize:void 0,maxFileSizeErrorCallback:function(e,t,n){alert(e.name+" is too large, please upload files less than "+Object(N.a)(c.getOpt(b.l.maxFileSize))+".")},fileType:[],fileTypeErrorCallback:function(e,t){alert(e.name+" has type not allowed, please upload files of type "+c.getOpt(b.l.fileType)+".")},emptyDirectoryCallback:function(e){alert(e.name+"contains no file")},importableType:[],directoryNotImportableCallback:function(e){alert(e.name+"cannot be imported")},preferMergedChunks:!0,isImportUploadMixedEnabled:!1},this.onDrop=function(e){var t,n,i,r,o,a,s;c.triggerDragSideEffects(e,!1),e.preventDefault(),Object(fe.h)(he.default.getState())!==de.FOLDER_PERMISSION.READABLE?e.dataTransfer&&(n=(t=e.dataTransfer).items,i=t.files,n&&n[0]&&"string"===n[0].kind||(n||i)&&(r=n||i,a=(o=c.opts).importUploadMixedModePredicator,s=o.onImportUploadMixedTask,"function"==typeof a&&a(r,e)&&"function"==typeof s?s(r,e):c.loadFiles(r,e))):console.info("Current folder is read-only.")},this.onDragLeave=function(e){e.currentTarget&&c.triggerDragSideEffects(e,!1)},this.onDragOverEnter=function(e){e.preventDefault();var t=e.dataTransfer;t&&(t.types.indexOf&&0<=t.types.indexOf("Files")?(e.stopPropagation(),t.dropEffect="copy",t.effectAllowed="copy",c.triggerDragSideEffects(e,!0)):(t.dropEffect="none",t.effectAllowed="none"))},this.triggerDragSideEffects=function(e,t){c.toggleDragOverClass(e,t),c.triggerDragHandler(t)},this.toggleDragOverClass=function(e,t){var n=c.getOpt(b.l.dragOverClass);t?e.currentTarget.classList.add(n):e.currentTarget.classList.remove(n)},this.triggerDragHandler=function(e){var t=e?c.getOpt(b.l.onDragStart):c.getOpt(b.l.onDragEnd);t&&t()},this.processItem=function(e,t,n){if(!e)return null;if(e instanceof File||e.isFile)return at(e,c,t,n);var i=n&&n.isImport;return rt(e,c,t,{isImport:i})},this.onOnline=function(){c.fire(b.k.online),(c.pausedByOffline||c.filesAddedWhenOffline)&&(c.upload(!0),c.pausedByOffline=!1,c.filesAddedWhenOffline=!1)},this.onOffline=function(){c.fire(b.k.offline),c.isUploading&&(c.pausedByOffline=!0,c.pauseAll())},this.handleDropEvent=function(e){c.onDrop(e)},this.handleChangeEvent=function(e){var t=e.target;c.loadFiles(t.files,e),t.value=""},this.supported=Boolean(FileList&&File&&Blob&&Blob.prototype.slice),this.opts=e||{};var t=this.opts;x({defaultNearbyDriveAPI:t.defaultNearbyDriveAPI,driveStreamAPIHost:t.driveStreamAPIHost,isNearbyDriveAPIEnabled:t.isNearbyDriveAPIEnabled})}function e(){return t.apply(this,arguments)}var t,i;function r(e,t,n){return i.apply(this,arguments)}return m()(n,[{key:"getOpt",value:function(e){var t=this;if(Array.isArray(e)){var n={};return e.forEach(function(e){n[e]=t.getOpt(e)}),n}return(void 0!==this.opts[e]?this.opts:this.defaults)[e]}},{key:"on",value:function(e,t){this.events.push(e.toLowerCase(),t)}},{key:"fire",value:function(e){for(var t=e.toLowerCase(),n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(var o=0;o<=this.events.length;o+=2)this.events[o]===t&&this.events[o+1].apply(this,i),"catchall"===this.events[o]&&this.events[o+1].apply(null,[e].concat(i));"fileerror"===e?this.fire(b.k.error,i[1],i[0]):"fileprogress"===e&&this.fire(b.k.progress)}},{key:"processDirectory",value:function(e,t,n){return rt(e,this,t,n)}},{key:"loadFiles",value:(i=p()(I.a.mark(function e(t,n,i){var r,o,a,s,c,l,u,d,h,f,p,g,m;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i&&i.isDirectory,!t||0===t.length&&!r)return e.abrupt("return");e.next=3;break;case 3:if(this.fire(b.k.beforeAdd),o=Array.from(t).map(function(e){return e instanceof DataTransferItem?e.webkitGetAsEntry():e}),r&&1===o.length&&""===o[0].webkitRelativePath&&(r=!1),a=[],s=i&&i.versionInfo,c=i&&i.parentToken,r)return l=i&&i.isImport,e.t0=a,e.next=14,this.processDirectory(o,n,{isImport:l,parentToken:c});e.next=18;break;case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=49;break;case 18:d=!(u=!0),h=void 0,e.prev=21,f=o[Symbol.iterator]();case 23:if(u=(p=f.next()).done){e.next=35;break}return g=p.value,m=void 0,m=i&&"function"==typeof i.jobTypePredicator?i.jobTypePredicator(g)===b.j.Import:i&&i.isImport,e.t2=a,e.next=30,this.processItem(g,n,{isImport:m,versionInfo:s,parentToken:c,jobTypePredicator:i?i.jobTypePredicator:void 0});case 30:e.t3=e.sent,e.t2.push.call(e.t2,e.t3);case 32:u=!0,e.next=23;break;case 35:e.next=41;break;case 37:e.prev=37,e.t4=e.catch(21),d=!0,h=e.t4;case 41:e.prev=41,e.prev=42,u||null==f.return||f.return();case 44:if(e.prev=44,d)throw h;e.next=47;break;case 47:return e.finish(44);case 48:return e.finish(41);case 49:this.appendTaskQueue(a,n);case 50:case"end":return e.stop()}},e,this,[[21,37,41,49],[42,,44,48]])})),r)},{key:"appendTaskQueue",value:function(e,t){var n,i=e.filter(function(e){return e});(n=this.tasks).push.apply(n,f()(i)),this.fire(b.k.tasksAdded,i,t),Object(ue.c)()||(this.filesAddedWhenOffline=!0)}},{key:"uploadNextChunk",value:(t=p()(I.a.mark(function e(){var t,n,i,r,o,a;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!(t=!0),i=void 0,e.prev=3,r=this.tasks[Symbol.iterator]();case 5:if(t=(o=r.next()).done){e.next=15;break}return a=o.value,e.next=9,a.upload();case 9:if(e.sent)return e.abrupt("return",!0);e.next=12;break;case 12:t=!0,e.next=5;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),n=!0,i=e.t0;case 21:e.prev=21,e.prev=22,t||null==r.return||r.return();case 24:if(e.prev=24,n)throw i;e.next=27;break;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return this.tasks.every(function(e){return e.completed})&&this.fire(b.k.complete),e.abrupt("return",!1);case 32:case"end":return e.stop()}},e,this,[[3,17,21,29],[22,,24,28]])})),e)},{key:"assignBrowse",value:function(e,t){var i=this,r=t.isDirectory,o=t.allowMultiple,a=t.isImport;(e=Object(N.f)(e)).forEach(function(e){var t;"INPUT"===e.tagName&&"file"===e.type?t=e:((t=document.createElement("input")).setAttribute("type","file"),t.style.display="none",e.addEventListener("click",function(){t.style.opacity=0,t.style.display="block",t.focus(),t.click(),t.style.display="none"},!1),e.appendChild(t)),o?t.setAttribute("multiple","multiple"):t.removeAttribute("multiple"),r?t.setAttribute("webkitdirectory","webkitdirectory"):t.removeAttribute("webkitdirectory");var n=i.getOpt(b.l.fileType);void 0!==n&&1<=n.length?t.setAttribute("accept",n.map(function(e){return(e=e.replace(/\s/g,"").toLowerCase()).match(/^[^.][^/]+$/)&&(e="."+e),e}).join(",")):t.removeAttribute("accept"),t.addEventListener("change",function(e){i.loadFiles(e.target.files,e,{isImport:a,isDirectory:r}),i.getOpt(b.l.clearInput)&&(e.target.value="")},!1)})}},{key:"assignDrop",value:function(e){var t=this;(e=Object(N.f)(e)).forEach(function(e){e.addEventListener("dragover",t.onDragOverEnter,!1),e.addEventListener("dragenter",t.onDragOverEnter,!1),e.addEventListener("dragleave",t.onDragLeave,!1),e.addEventListener("drop",t.onDrop,!1)})}},{key:"unAssignDrop",value:function(e){var t=this;(e=Object(N.f)(e)).forEach(function(e){e.removeEventListener("dragover",t.onDragOverEnter),e.removeEventListener("dragenter",t.onDragOverEnter),e.removeEventListener("dragleave",t.onDragLeave),e.removeEventListener("drop",t.onDrop)})}},{key:"setNetworkCheck",value:function(e){e?(window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)):(window.removeEventListener("online",this.onOnline),window.removeEventListener("offline",this.onOffline))}},{key:"upload",value:function(e){if(Object(ue.c)()&&(!this.isUploading||this._retry)){this._retry=!1,e&&this.tasks.forEach(function(e){return e.resume()}),this.fire(b.k.uploadStart);for(var t=this.getOpt(b.l.simultaneousUploads),n=0;n<t;n++)this.uploadNextChunk()}}},{key:"pauseAll",value:function(){this.tasks.forEach(function(e){e.abort(),e.pause(!0)}),this.fire(b.k.pauseAll)}},{key:"pause",value:function(t){var e=this.tasks.find(function(e){return e.uuid===t});e?(e.abort(),e.pause(!0),this.fire(b.k.pause,e)):console.error("Cannot find file with uuid:",t)}},{key:"retry",value:function(t){var e;Object(ue.c)()&&(this._retry=!0,(e=this.tasks.find(function(e){return e.uuid===t}))?e.retry():console.error("Cannot find file with uuid:",t))}},{key:"retryAll",value:function(e){var t=this;e&&0!==e.length&&e.forEach(function(e){t.retry(e)})}},{key:"rePending",value:function(t){var e;Object(ue.c)()&&((e=this.tasks.find(function(e){return e.uuid===t}))?(e.resume(),this.fire(b.k.pending,e)):console.error("Cannot find file with uuid:",t))}},{key:"rePendingAll",value:function(e){var t=this;e&&0!==e.length&&(e.forEach(function(e){t.rePending(e)}),this.isUploading||this.upload())}},{key:"cancel",value:function(t){var e=this.tasks.find(function(e){return e.uuid===t});e?(e.cancel(),this.fire(b.k.cancel,e)):console.error("Cannot find file with uuid:",t)}},{key:"cancelAll",value:function(){for(var e=this.tasks.length-1;0<=e;e--)this.tasks[e].cancel();this.fire(b.k.cancelAll)}},{key:"progress",value:function(){var n=0,i=0;return this.tasks.forEach(function(e){var t=e.size;n+=e instanceof ut?e.sizeProgress*t:e.progress*t,i+=t}),0<i?n/i:0}},{key:"uploadedSize",value:function(){return this.tasks.reduce(function(e,t){return t instanceof ut?e+t.sizeProgress*t.size:e+t.progress*t.size},0)}},{key:"addFile",value:function(e,t,n){this.loadFiles([e],t,n)}},{key:"addFiles",value:function(e,t,n){this.loadFiles(e,t,n)}},{key:"removeTask",value:function(e){for(var t=this.tasks.length-1;0<=t;t--)this.tasks[t]===e&&this.tasks.splice(t,1)}},{key:"getFromUniqueIdentifier",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=this.tasks[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;if(a instanceof ut){var s=a.getFromUniqueIdentifier(e);if(s)return s}else if(a.uuid===e)return a}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return null}},{key:"getSize",value:function(){return this.tasks.reduce(function(e,t){return e+t.size},0)}},{key:"isUploading",get:function(){return this.tasks.some(function(e){return e.isUploading})}}]),n}(),ge=function(){function o(e){var t,n=e.uploaderObj,i=e.rootTask,r=e.parentToken;h()(this,o),this.uploaderObj=n,i?this.rootTask=i:(t=n.getOpt(b.l.getParentToken),this.parentToken=r||t())}return m()(o,[{key:"getOpt",value:function(e){return this.uploaderObj.getOpt(e)}},{key:"fire",value:function(e){for(var n=this,t=arguments.length,i=new Array(1<t?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return Array.isArray(e)||(e=[e]),e.forEach(function(e){var t;return(t=n.uploaderObj).fire.apply(t,[e].concat(i))})}},{key:"parentToken",set:function(e){this._parentToken=e},get:function(){return this._parentToken}},{key:"rootTask",set:function(e){this._rootTask=e},get:function(){return this._rootTask||this}},{key:"isTask",get:function(){return this.rootTask===this}}]),o}(),me=function(e){function c(e){var t,n=e.uploaderObj,i=e.file,r=e.uuid,o=e.rootTask,a=e.parentToken,s=e.isJobTypeDeterminedByPredicator;return h()(this,c),(t=y()(this,O()(c).call(this,{uploaderObj:n,rootTask:o,parentToken:a}))).error=!1,t.paused=!1,t.resumed=!1,t.file=i,t.uuid=r,t.isJobTypeDeterminedByPredicator=!!s,t}return S()(c,e),m()(c,[{key:"checkRootTaskProgress",value:function(){this.rootTask instanceof dt&&this.rootTask.checkTaskProgress()}},{key:"pause",value:function(e){this.paused=void 0===e?!this.paused:e}},{key:"resume",value:function(){this.pause(!1),this.resumed=!0}},{key:"isPaused",get:function(){return this.paused}},{key:"name",get:function(){return this.file?this.file.name:""}},{key:"type",get:function(){return this.file?this.file.type:""}},{key:"size",get:function(){return this.file?this.file.size:0}}]),c}(ge),ve=me,be=i("cDf5"),ye=i.n(be),Ee=i("PJYZ"),Oe=i.n(Ee),Ce=[b.e.PENDING,b.e.ERROR],ke=function(e){function r(e){var n;h()(this,r),(n=y()(this,O()(r).call(this,e))).chunks=[],n.cachedChunks=[],n.startTime=0,n.timeCost=0,n.chunkEvent=function(e,t){switch(e){case b.c.PROGRESS:if(n.paused)break;n.fire([b.k.fileProgress,b.k.collectReport],n.rootTask,t);break;case b.c.ERROR:n.abort(),n.markError(),n.cachedChunks=n.chunks,n.chunks=[],n.fire([b.k.taskError,b.k.collectReport],Oe()(n),Object.assign({},"object"===ye()(t)?t:null,{type:b.o.ChunkError})),n.isTask||n.checkRootTaskProgress();break;case b.c.SUCCESS:if(n.error||!n.chunks||0===n.chunks.length)return;n.fire([b.k.fileProgress,b.k.collectReport],n.rootTask,Object.assign({},"object"===ye()(t)?t:null,{type:b.o.ChunkSuccess})),n.readyToFinish&&n.finish(t);break;case b.c.RETRY:n.isTask&&n.fire(b.k.taskRetry,Oe()(n));break;case b.c.REPORT_ERROR:n.fire(b.k.collectReport,n.rootTask,Object.assign({},"object"===ye()(t)?t:null,{type:b.o.ChunkError}))}},n._prevProgress=0;var t=e.versionInfo;t&&(n.fileToken=t.fileToken,n.memberId=t.memberId,n.versionUpload=!0);var i=n.getOpt(b.l.getMountPoint);return n.mountPoint=i(),n}function t(e){return n.apply(this,arguments)}var n,i,o;function a(e){return i.apply(this,arguments)}function s(){return o.apply(this,arguments)}return S()(r,e),m()(r,[{key:"upload",value:(o=p()(I.a.mark(function e(){var t,n,i,r,o,a;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(ue.c)()){e.next=2;break}return e.abrupt("return",!1);case 2:return this._bootstrapKickedOff||(this._bootstrapKickedOff=!0,this._bootstrapTask=this.bootstrap()),e.next=5,this._bootstrapTask;case 5:if(this.paused)return e.abrupt("return",!1);e.next=7;break;case 7:this.resumed&&(this.markStartTime(),this.resumed=!1),n=!(t=!0),i=void 0,e.prev=11,r=this.chunks[Symbol.iterator]();case 13:if(t=(o=r.next()).done){e.next=23;break}if(a=o.value,Ce.includes(a.status()))return e.next=19,a.send();e.next=20;break;case 19:return e.abrupt("return",!0);case 20:t=!0,e.next=13;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(11),n=!0,i=e.t0;case 29:e.prev=29,e.prev=30,t||null==r.return||r.return();case 32:if(e.prev=32,n)throw i;e.next=35;break;case 35:return e.finish(32);case 36:return e.finish(29);case 37:return e.abrupt("return",!1);case 38:case"end":return e.stop()}},e,this,[[11,25,29,37],[30,,32,36]])})),s)},{key:"retry",value:function(){Object(ue.c)()&&(this.paused&&(this.cachedChunks=this.chunks),this._bootstrapTask=this.bootstrap(!0),this.isTask&&this.uploaderObj.upload(),this.pause(!1))}},{key:"abort",value:function(){var t=0;this.chunks.forEach(function(e){e.status()===b.e.UPLOADING&&(e.abort(),t++)}),this.isTask&&0<t&&this.fire(b.k.fileProgress,this),this.addTimeCost()}},{key:"cancel",value:function(){var t=this,e=this.chunks;this.chunks=[],e.forEach(function(e){e.status()===b.e.UPLOADING&&(e.abort(),t.uploaderObj.uploadNextChunk())}),this.isTask&&(this.uploaderObj.removeTask(this),this.fire(b.k.fileProgress,this))}},{key:"bootstrap",value:(i=p()(I.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.abort(),this.error=!1,this.markStartTime(),this.resumed=!1,t&&this.cachedChunks&&0<this.cachedChunks.length)return this.chunks=this.cachedChunks,this.cachedChunks=[],this.readyToFinish&&this.finish(""),e.abrupt("return");e.next=9;break;case 9:if(i="",e.prev=10,void 0===this.parentToken)throw new Error("Mount node token unspecified");e.next=13;break;case 13:return i=Object(N.d)(),e.next=16,re(this.getOpt(b.l.prepareTarget),Object(N.g)({name:this.name,mount_node_token:this.parentToken,mount_point:this.mountPoint,size:this.size,file_token:this.fileToken}),{headers:Object.assign({"x-request-id":i,"x-tt-trace-id":i},D.e?Object(D.d)():{})});case 16:n=e.sent,e.next=26;break;case 19:return e.prev=19,e.t0=e.catch(10),this.markError(),this.fire(b.k.collectReport,this,{type:b.o.FilePrepareError,reqId:i,msg:e.t0.message}),this.isTask?this.fire(b.k.taskError,this,{type:b.o.FilePrepareError,isIllegal:e.t0&&e.t0.code===b.h}):this.checkRootTaskProgress(),e.t0&&e.t0.code===b.g&&(this.fire(b.k.usageLimitReached,b.m.upload),this.uploaderObj.pauseAll()),e.abrupt("return");case 26:if(r=n.block_size,o=n.num_blocks,a=n.upload_id,s=n.option_block_size,this.chunkSize=r,this.totalChunks=o,this.uploadId=a,this.suggestedChunkSize=s,0===this.totalChunks)return this.finish(""),e.abrupt("return");e.next=34;break;case 34:if(this.chunks=[],this._prevProgress=0,c={uploaderObj:this.uploaderObj,fileObj:this,callback:this.chunkEvent},this.shouldUseMergedChunks)for(l=this.suggestedChunkSize/this.chunkSize,u=Math.ceil(this.totalChunks/l),d=0;d<u;d++)this.chunks.push(new $e(Object.assign({},c,{chunkSize:this.chunkSize,offset:d,numOfChunks:l})));else for(h=0;h<this.totalChunks;h++)this.chunks.push(new Je(Object.assign({},c,{chunkSize:this.chunkSize,offset:h})));case 38:case"end":return e.stop()}},e,this,[[10,19]])})),a)},{key:"markStartTime",value:function(){this.startTime=Date.now()}},{key:"markError",value:function(){this.error=!0,this.addTimeCost()}},{key:"addTimeCost",value:function(){this.startTime&&(this.timeCost+=Date.now()-this.startTime,this.startTime=0)}},{key:"finish",value:(n=p()(I.a.mark(function e(t){var n,i,r;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="",e.prev=1,n=Object(N.d)(),i=this.getOpt(b.l.shouldAddToRecents),e.next=6,re(this.getOpt(b.l.finishTarget),Object(N.g)({upload_id:this.uploadId,num_blocks:this.totalChunks,member_id:this.memberId,push_open_history_record:this.isTask&&i?null:0}),{headers:{"x-request-id":n,"x-tt-trace-id":n}});case 6:(r=e.sent).file_token&&(this.fileToken=r.file_token,this.fileVersion=r.version,this.fileDataVersion=r.data_version,this.addTimeCost(),this.reportFileSuccess(),this.isTask?this.fire(b.k.taskSuccess,this,t):this.checkRootTaskProgress()),e.next=17;break;case 10:e.prev=10,e.t0=e.catch(1),this.cachedChunks=this.chunks,this.markError(),this.fire(b.k.collectReport,this,{type:b.o.FileFinishError,reqId:n,msg:e.t0.message}),this.isTask?this.fire(b.k.taskError,this,{type:b.o.FileFinishError}):this.checkRootTaskProgress(),e.t0&&e.t0.code&&this.fire(b.k.fileError,e.t0.code);case 17:case"end":return e.stop()}},e,this,[[1,10]])})),t)},{key:"reportFileSuccess",value:function(){var e=this.size,t=this.timeCost,n=e&&t?Math.round(e/t*1e3):void 0;this.fire(b.k.collectReport,this,{type:b.o.FileSuccess,fileSize:e,timeCost:t,uploadSpeed:n})}},{key:"setRootTaskUploadingChunk",value:function(e){this.isTask||(this.rootTask.uploadingChunk=e)}},{key:"pushRootTaskUploadedChunk",value:function(e){this.isTask||this.rootTask.uploadedChunks.push(e)}},{key:"progress",get:function(){if(this.error)return 1;var t=0,n=!1;return this.chunks.forEach(function(e){e.status()===b.e.ERROR&&(n=!0),t+=e.progress(!0)}),t=n||.99999<t?1:t,t=Math.max(this._prevProgress,t),n||(this._prevProgress=t),t}},{key:"isUploading",get:function(){var e=this.progress,t=this.chunks.some(function(e){return e.status()===b.e.UPLOADING}),n=Boolean(0<e&&e<1&&!this.error&&!this.paused);return t||n}},{key:"completed",get:function(){return!!this.fileVersion&&this.readyToFinish}},{key:"shouldUseMergedChunks",get:function(){if(!this.uploaderObj.getOpt(b.l.preferMergedChunks)||!this.suggestedChunkSize)return!1;var e=this.suggestedChunkSize/this.chunkSize;return e===Math.round(e)}},{key:"readyToFinish",get:function(){return!!this.uploadId&&!this.chunks.some(function(e){return e.status()!==b.e.SUCCESS})}}]),r}(me),Ie=function(){function s(e){var n=this,t=e.uploaderObj,i=e.fileObj,r=e.offset,o=e.chunkSize,a=e.callback;h()(this,s),this.size=0,this.uploading=!1,this.reqId="",this.timeCost=0,this.aborted=!1,this.cancel=null,this.onUploadProgress=function(e){var t=Date.now()-n.lastProgressCallback;t>1e3*n.uploaderObj.getOpt(b.l.throttleProgressCallbacks)&&(n.reportProgressMetric(e.loaded-n.lastReportedLoaded,t),n.lastProgressCallback=Date.now(),n.lastReportedLoaded=e.loaded),n.loaded=e.loaded||0},this.setCancelToken=function(e){return n.cancel=e},this.uploaderObj=t,this.fileObj=i,this.fileObjSize=i.size,this.offset=r,this.callback=a,this.chunkSize=o,this.chunkType=this.uploaderObj.getOpt(b.l.setChunkTypeFromFile)?this.fileObj.file.type:"",this.loaded=0,this.lastReportedLoaded=0}return m()(s,[{key:"triggerNext",value:function(e,t){this.uploading=!1,this.callback(e,this.getMessage(t)),this.uploaderObj.uploadNextChunk()}},{key:"reportProgressMetric",value:function(e,t){0<e&&this.callback(b.c.PROGRESS,{metric:!0,diffSize:e,diffTime:t})}},{key:"reportError",value:function(e){this.callback(b.c.REPORT_ERROR,this.getMessage(e))}},{key:"abort",value:function(){this.cancel&&(this.cancel(),this.cancel=null,this.aborted=!0)}},{key:"status",value:function(){return this.uploading?b.e.UPLOADING:this.loaded?b.e.SUCCESS:this.aborted?b.e.ABORT:this.cancel?b.e.ERROR:b.e.PENDING}},{key:"getMessage",value:function(e){var t=this.size,n=this.timeCost,i=t&&n?Math.round(t/n*1e3):void 0,r={offset:this.offset,status:this.status(),responseData:this.responseData||"",reqId:this.reqId,chunkSize:t,timeCost:n,uploadSpeed:i};return e&&(r.msg=e),r}},{key:"progress",value:function(e){var t=e?this.size/this.fileObjSize:1;switch(this.status()){case b.e.SUCCESS:case b.e.ERROR:return+t;case b.e.PENDING:return 0;default:return this.loaded/this.size*t}}},{key:"loadedSize",get:function(){return this.loaded}}]),s}(),Se=i("2spZ"),Te=i("iP/4");function _e(e){return crypto.subtle.digest("SHA-256",e).then(je)}function we(e){return Ae(new Uint8Array(e)).toString()}function je(e){for(var t=new Uint8Array(e),n="",i=0,r=t.byteLength;i<r;i++)n+=String.fromCharCode(t[i]);return btoa(n)}function Me(e){for(var t=new Uint8Array(e.length),n=0,i=e.length;n<i;++n)t[n]=255&e.charCodeAt(n);return t}function Ae(e){e="string"==typeof e?Me(e):e;for(var t=new Uint32Array([1,0,e.length,0,0,65521,5552,0]),n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],c=t[6];0<r;){for(a=c<r?c:r,r-=a;i+=n+=e[o++],--a;);n%=s,i%=s}return(i<<16|n)>>>0}var Le,Re,Ne={calcSHA256Async:_e,calcADLER32:we},De={HASH_ADLER32:"adler32",HASH_AND_CHECKSUM:"hash_and_checksum",HASH_SHA256:"sha256"},xe=new Map;function Pe(){return Be.apply(this,arguments)}function Be(){return(Be=p()(I.a.mark(function e(){var t,n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.e("boxWorker").then(i.t.bind(null,"TD40",7));case 3:t=e.sent,n=t.default,(Le=new n).onmessage=Ue,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Failed to load box.worker.js",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}function Ue(e){var t,n=e.data,i=n.callerId,r=n.content,o=n.errorMsg;xe.has(i)&&(t=xe.get(i),xe.delete(i),o?t.reject(new Error(o)):t.resolve(r))}function ze(){return+new Date+Math.random()}function He(e,t,n,i){return Fe.apply(this,arguments)}function Fe(){return(Fe=p()(I.a.mark(function e(t,n,i,r){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Le){e.next=5;break}return Re=Re||Pe(),e.next=4,Re;case 4:Re=null;case 5:Le.postMessage({callerId:t,type:n,content:i}),xe.set(t,r);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ve=function(r){return function(n){var i=ze();return new Promise(function(e,t){He(i,r,n,{resolve:e,reject:t})})}},We=Ve(De.HASH_SHA256);function Ke(e){return Te.a.isEdge?Ne.calcSHA256Async(e):We(e)}var Ge,Ze,qe=Ve(De.HASH_ADLER32),Ye=Ve(De.HASH_AND_CHECKSUM),Je=function(e){function n(e){var t;return h()(this,n),(t=y()(this,O()(n).call(this,e))).startByte=t.offset*t.chunkSize,t.endByte=Math.min(t.fileObjSize,(t.offset+1)*t.chunkSize),t.size=t.endByte-t.startByte,t.doUploadChunk=t.uploaderObj.getOpt(b.l.uploadChunk),t}function t(e,t){return i.apply(this,arguments)}var i,r,o,a;function s(e){return r.apply(this,arguments)}function c(e){return o.apply(this,arguments)}function l(){return a.apply(this,arguments)}return S()(n,e),m()(n,[{key:"send",value:(a=p()(I.a.mark(function e(){var t,n,i,r,o;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.uploading=!0,t=this.fileObj.file.slice(this.startByte,this.endByte,this.chunkType),e.next=4,this.calcHashAndChecksum(t);case 4:return n=e.sent,i=n.hash,r=n.checksum,o=this.size,e.next=10,this.checkChunkExistence({hash:i,checksum:r,size:o});case 10:if(!e.sent){e.next=16;break}this.loaded=this.size,this.triggerNext(b.c.SUCCESS),e.next=18;break;case 16:return e.next=18,this.uploadChunk({sliceData:t,checksum:r,size:o},b.d);case 18:case"end":return e.stop()}},e,this)})),l)},{key:"checkChunkExistence",value:(o=p()(I.a.mark(function e(t){var n,i,r,o,a,s;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.hash,i=t.checksum,r=t.size,this.uploaderObj.getOpt(b.l.fastModeEnabled)){e.next=4;break}return e.abrupt("return",!1);case 4:return e.prev=4,o=Date.now(),e.next=8,re(this.uploaderObj.getOpt(b.l.testTarget),{upload_id:this.fileObj.uploadId,seq:this.offset,hash:n,checksum:i,size:r});case 8:return a=e.sent,this.timeCost=Date.now()-o,s=Boolean(a.exist),e.abrupt("return",s);case 14:return e.prev=14,e.t0=e.catch(4),e.abrupt("return",!1);case 17:case"end":return e.stop()}},e,this,[[4,14]])})),c)},{key:"calcHashAndChecksum",value:(r=p()(I.a.mark(function e(t){var n,i,r,o;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(N.h)(t);case 2:if(n=e.sent,Te.a.isEdge)return e.next=6,Ke(n);e.next=12;break;case 6:return i=e.sent,e.next=9,qe(n);case 9:r=e.sent,e.next=17;break;case 12:return e.next=14,Ye(n);case 14:o=e.sent,i=o.hash,r=o.checksum;case 17:return e.abrupt("return",{hash:i,checksum:r});case 18:case"end":return e.stop()}},e)})),s)},{key:"uploadChunk",value:(i=p()(I.a.mark(function e(t,n){var i,r,o,a,s,c;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.sliceData,r=t.checksum,o=t.size,e.prev=1,this.callback(b.c.PROGRESS),this.fileObj.setRootTaskUploadingChunk(this),this.reqId=Object(N.d)(),a=Date.now(),this.lastProgressCallback=a,e.next=9,this.doUploadChunk({request:d,uploadId:this.fileObj.uploadId,offset:this.offset,checksum:r,sliceData:i,reqId:this.reqId,onUploadProgress:this.onUploadProgress,setCancelToken:this.setCancelToken});case 9:s=e.sent,this.cancel=null,c=Date.now(),this.timeCost=c-a,this.responseData=s,0===this.loaded&&this.reportError("Incorrect loaded value"),this.loaded=o,this.reportProgressMetric(o-this.lastReportedLoaded,c-this.lastProgressCallback),this.fileObj.pushRootTaskUploadedChunk(this),this.triggerNext(b.c.SUCCESS),e.next=40;break;case 21:if(e.prev=21,e.t0=e.catch(1),this.loaded=0,this.lastReportedLoaded=0,!Object(N.e)()||this.aborted){e.next=37;break}if(0<n)return this.reportError(e.t0.message),e.next=30,Object(Se.c)(1e3);e.next=34;break;case 30:return e.next=32,this.uploadChunk({sliceData:i,checksum:r,size:o},n-1);case 32:e.next=35;break;case 34:this.triggerNext(b.c.ERROR,e.t0.message);case 35:e.next=40;break;case 37:this.aborted=!1,this.uploading=!1,this.cancel=null;case 40:return e.prev=40,this.fileObj.setRootTaskUploadingChunk(null),e.finish(40);case 43:case"end":return e.stop()}},e,this,[[1,21,40,43]])})),t)}]),n}(Ie),Qe=i("QILm"),Xe=i.n(Qe),$e=function(e){function a(e){var t,n=e.numOfChunks,i=Xe()(e,["numOfChunks"]);h()(this,a);var r=(t=y()(this,O()(a).call(this,i))).chunkSize*n;t.startByte=t.offset*r,t.endByte=Math.min(t.fileObjSize,(t.offset+1)*r),t.size=t.endByte-t.startByte,t.actualNumOfSubChunks=Math.ceil(t.size/t.chunkSize),t.startSubChunkIndex=t.offset*n,t.uploadedSubChunkIndices=[];var o=Boolean(navigator.serviceWorker&&navigator.serviceWorker.controller);return t.strategy=o?"simple":"optimized",t.doUploadMergedChunk=t.uploaderObj.getOpt(b.l.uploadMergedChunk),t}function t(e){return n.apply(this,arguments)}var n,i,r;function o(e){return i.apply(this,arguments)}function s(){return r.apply(this,arguments)}return S()(a,e),m()(a,[{key:"send",value:(r=p()(I.a.mark(function e(){var t,n,i,r=arguments;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:b.d,e.prev=1,this.uploading=!0,n=this.seqList,e.next=6,this.getPendingSliceData(n);case 6:return i=e.sent,e.next=9,this.uploadChunk(Object.assign({},i,{seqList:n}));case 9:e.next=30;break;case 11:if(e.prev=11,e.t0=e.catch(1),this.loaded=0,this.lastReportedLoaded=0,!Object(N.e)()||this.aborted){e.next=27;break}if(0<t)return this.reportError(e.t0.message),e.next=20,Object(Se.c)(1e3);e.next=24;break;case 20:return e.next=22,this.send(t-1);case 22:e.next=25;break;case 24:this.triggerNext(b.c.ERROR,e.t0.message);case 25:e.next=30;break;case 27:this.aborted=!1,this.uploading=!1,this.cancel=null;case 30:return e.prev=30,this.fileObj.setRootTaskUploadingChunk(null),e.finish(30);case 33:case"end":return e.stop()}},e,this,[[1,11,30,33]])})),s)},{key:"uploadChunk",value:(i=p()(I.a.mark(function e(t){var n,i,r,o,a,s,c,l,u=this;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.blob,i=t.checksums,r=t.size,o=t.seqList,this.callback(b.c.PROGRESS),this.fileObj.setRootTaskUploadingChunk(this),this.reqId=Object(N.d)(),a=Date.now(),this.lastProgressCallback=a,e.next=8,this.doUploadMergedChunk({request:d,uploadId:this.fileObj.uploadId,offset:this.offset,size:r,checksums:i,seqList:o,chunkSize:this.chunkSize,sliceData:n,reqId:this.reqId,onUploadProgress:this.onUploadProgress,setCancelToken:this.setCancelToken});case 8:if(s=e.sent,this.cancel=null,c=Date.now(),this.timeCost=c-a,this.responseData=s,0===this.loaded&&this.reportError("Incorrect loaded value"),this.loaded=r,this.reportProgressMetric(r-this.lastReportedLoaded,c-this.lastProgressCallback),(l=s&&s.success_seq_list)&&l.forEach(function(e){u.uploadedSubChunkIndices.includes(e)||u.uploadedSubChunkIndices.push(e)}),this.uploadedSubChunkIndices.length!==this.actualNumOfSubChunks)throw s;e.next=20;break;case 20:this.fileObj.pushRootTaskUploadedChunk(this),this.triggerNext(b.c.SUCCESS);case 22:case"end":return e.stop()}},e,this)})),o)},{key:"getPendingSliceData",value:(n=p()(I.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f=this;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getByteRanges(t),i=n.map(function(e){var t=k()(e,2),n=t[0],i=t[1];return f.fileObj.file.slice(n,i,f.chunkType)}),e.next=4,Promise.all(i.map(N.h));case 4:return r=e.sent,o=r.reduce(function(e,t){return e+t.byteLength},0),e.next=8,Promise.all(r.map(qe));case 8:if(a=e.sent,1===i.length)return e.abrupt("return",{blob:i[0],size:o,checksums:a});e.next=11;break;case 11:if("simple"===this.strategy)return s=n[0][0],c=n[n.length-1][1],l=this.fileObj.file.slice(s,c,this.chunkType),e.abrupt("return",{blob:l,size:o,checksums:a});e.next=16;break;case 16:return u=new Uint8Array(o),d=0,r.forEach(function(e){var t=new Uint8Array(e);u.set(t,d),d+=e.byteLength}),h=new Blob([u]),e.abrupt("return",{blob:h,size:o,checksums:a});case 21:case"end":return e.stop()}},e,this)})),t)},{key:"getByteRanges",value:function(e){var t=this;return e.map(function(e){return[e*t.chunkSize,Math.min(t.endByte,(e+1)*t.chunkSize)]})}},{key:"totalSubChunkIndices",get:function(){var n=this;return new Array(this.actualNumOfSubChunks).fill(null).map(function(e,t){return n.startSubChunkIndex+t})}},{key:"seqList",get:function(){var t=this;return"simple"===this.strategy?this.totalSubChunkIndices:this.totalSubChunkIndices.filter(function(e){return!t.uploadedSubChunkIndices.includes(e)})}}]),a}(Ie),et=100,tt=function(e){function t(){return h()(this,t),y()(this,O()(t).apply(this,arguments))}function n(e){return i.apply(this,arguments)}var i,r,o;function a(e){return r.apply(this,arguments)}function s(){return o.apply(this,arguments)}return S()(t,e),m()(t,[{key:"upload",value:(o=p()(I.a.mark(function e(){var t,n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(ue.c)()||this.error||this.paused||this.uploading||this.converting||this.finished)return e.abrupt("return",!1);e.next=2;break;case 2:if(e.prev=2,t=Object(N.d)(),this.ticket){e.next=8;break}return e.next=7,this.uploadFileToParser(t);case 7:this.ticket=e.sent;case 8:return e.next=10,this.getParserResult(this.ticket);case 10:return this.finished=!0,this.isTask?this.fire(b.k.taskSuccess,this):this.checkRootTaskProgress(),e.abrupt("return",!0);case 15:return e.prev=15,e.t0=e.catch(2),(n=this.uploading?b.o.ImportUploadError:this.converting?b.o.ImportParseError:null)&&this.fire(b.k.collectReport,this,{type:n,reqId:t,msg:e.t0.message}),Object(ue.c)()&&(this.error=!0,this.isTask?n&&this.fire(b.k.taskError,this,{type:n}):this.checkRootTaskProgress()),this.uploading=!1,this.converting=!1,e.abrupt("return",!1);case 23:return e.prev=23,this.uploaderObj.uploadNextChunk(),e.finish(23);case 26:case"end":return e.stop()}},e,this,[[2,15,23,26]])})),s)},{key:"uploadFileToParser",value:(r=p()(I.a.mark(function e(t){var n,i,r,o,a,s=this;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.cancelSource=U.source(),this.uploading=!0,(n=new FormData).append("name",this.name),n.append("type",this.type),n.append("size",String(this.size)),n.append("parent_token",this.parentToken),n.append("file",this.file),i=b.n.includes(this.type)?b.a:"",r=i?{"x-command":i}:{},e.next=12,ce(b.b.IMPORT_UPLOAD,n,{cancelToken:this.cancelSource.token,onUploadProgress:function(e){var t=e.loaded,n=e.total;s._progress=0===n?1:t/n,s.fire(b.k.fileProgress,s)},headers:Object.assign({"x-request-id":t,"x-tt-trace-id":t},r)});case 12:if(o=e.sent,a=o.ticket){e.next=17;break}throw this.fire(b.k.fileError,o.code),new Error(o);case 17:return this.uploading=!1,e.abrupt("return",a);case 19:case"end":return e.stop()}},e,this)})),a)},{key:"getParserResult",value:(i=p()(I.a.mark(function e(t){var n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Import task ticket not returned");case 2:this.checkTimes=0,this.converting=!0;case 4:if(this.checkTimes<et)return e.next=7,Object(N.i)(0===this.checkTimes?1e3:3e3);e.next=16;break;case 7:return e.next=9,le(b.b.IMPORT_STATUS,{ticket:t});case 9:if((n=e.sent)&&void 0!==n.code)return 0===n.code?(this.fileToken=Object(T.default)(n,"tokens.0",""),n.warningCode&&this.fire(b.k.fileWarning,n.warningCode)):n.code===b.g?this.fire(b.k.usageLimitReached,b.m.import):this.fire(b.k.fileError,{type:this.type||Object(N.c)(this.name)||"",code:n.code}),e.abrupt("break",16);e.next=13;break;case 13:this.checkTimes+=1,e.next=4;break;case 16:if(this.fileToken){e.next=18;break}throw new Error("Check import task result failed");case 18:this.converting=!1;case 19:case"end":return e.stop()}},e,this)})),n)},{key:"retry",value:function(){Object(ue.c)()&&(this.abort(),this.error=!1,this.uploaderObj.upload(this.paused))}},{key:"abort",value:function(){this.isUploading&&(this.cancelSource&&this.cancelSource.cancel(),this.uploading=!1,this.converting=!1,this.checkTimes=et,this.isTask&&this.fire(b.k.fileProgress,this))}},{key:"cancel",value:function(){this.abort(),this.isTask&&(this.uploaderObj.uploadNextChunk(),this.uploaderObj.removeTask(this))}},{key:"progress",get:function(){return this.error?1:this._progress}},{key:"isUploading",get:function(){return this.uploading||this.converting}},{key:"completed",get:function(){return this.finished}}]),t}(me),nt=tt;function it(t){return new Promise(function(e){t.file(e)})}function rt(e,t,n,i){return ot.apply(this,arguments)}function ot(){return(ot=p()(I.a.mark(function e(t,n,i,r){var o,a,s,c,l,u;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=r&&r.rootTask,a=r&&r.parentPath,s=r&&r.parentToken,c=r&&r.isImport,l=Object(N.b)(Array.isArray(t)?t[0]:t),u=new dt({input:t,uploaderObj:n,uuid:l,rootTask:o,parentPath:a,parentToken:s,isImport:c}),e.next=8,u.init(i);case 8:if(o){e.next=18;break}if(!c||u.totalFiles===u.totalRawFiles){e.next=14;break}if(n.getOpt(b.l.directoryNotImportableCallback)(u),0===u.totalFiles)return e.abrupt("return",null);e.next=14;break;case 14:if(0===u.totalFiles)return n.getOpt(b.l.emptyDirectoryCallback)(u),e.abrupt("return",null);e.next=18;break;case 18:return u.isTask&&n.fire(b.k.taskAdded,u,i),e.abrupt("return",u);case 20:case"end":return e.stop()}},e)}))).apply(this,arguments)}function at(e,t,n,i){return st.apply(this,arguments)}function st(){return(st=p()(I.a.mark(function e(t,n,i,r){var o,a,s,c,l,u,d,h,f,p,g,m,v;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof File)){e.next=4;break}e.t0=t,e.next=7;break;case 4:return e.next=6,it(t);case 6:e.t0=e.sent;case 7:if(o=e.t0,a=n.getOpt([b.l.minFileSize,b.l.maxFileSize,b.l.maxImportFileSize,b.l.minFileSizeErrorCallback,b.l.maxFileSizeErrorCallback,b.l.fileType,b.l.fileTypeErrorCallback,b.l.importableType]),s=o.name,c=o.type,r&&r.rootTask&&/^(\~\$|\.)/g.test(s))return e.abrupt("return",null);e.next=13;break;case 13:if(!(0<a.fileType.length)){e.next=28;break}l=!1,e.t1=I.a.keys(a.fileType);case 16:if((e.t2=e.t1()).done){e.next=25;break}if(u=e.t2.value,a.fileType[u]=a.fileType[u].replace(/\s/g,"").toLowerCase(),d=(a.fileType[u].match(/^[^.][^/]+$/)?".":"")+a.fileType[u],s.substr(-1*d.length).toLowerCase()===d||-1!==d.indexOf("/")&&(-1!==d.indexOf("*")&&c.substr(0,d.indexOf("*"))===d.substr(0,d.indexOf("*"))||c===d))return l=!0,e.abrupt("break",25);e.next=23;break;case 23:e.next=16;break;case 25:if(l){e.next=28;break}return a.fileTypeErrorCallback(o),e.abrupt("return",null);case 28:if(!((h=r&&r.isImport)&&0<a.importableType.length)){e.next=33;break}if(a.importableType.includes(c)||a.importableType.includes(Object(N.c)(s))){e.next=33;break}return e.abrupt("return",null);case 33:if(void 0!==a.minFileSize&&o.size<a.minFileSize)return a.minFileSizeErrorCallback(o),e.abrupt("return",null);e.next=36;break;case 36:if(f=a.maxFileSize,p=Ge.upload,h&&(f=a.maxImportFileSize,p=Ge.import),void 0!==f&&o.size>f)return a.maxFileSizeErrorCallback(o,p,f),e.abrupt("return",null);e.next=42;break;case 42:return g=Object(N.b)(o),m={file:o,uploaderObj:n,uuid:g||"",rootTask:r&&r.rootTask,parentToken:r&&r.parentToken,isJobTypeDeterminedByPredicator:r&&"function"==typeof r.jobTypePredicator},(v=h?new tt(m):new ke(Object.assign({},m,{versionInfo:r&&r.versionInfo}))).isTask&&n.fire(b.k.taskAdded,v,i),e.abrupt("return",v);case 47:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ct(e){return e.webkitRelativePath}(Ze=Ge=Ge||{})[Ze.import=1]="import",Ze[Ze.upload=2]="upload";var lt=-1,ut=function(e){function l(e){var a,t=e.input,n=e.parentPath,i=e.parentToken,r=e.uploaderObj,o=e.uuid,s=e.rootTask,c=e.isImport;return h()(this,l),(a=y()(this,O()(l).call(this,{uploaderObj:r,parentToken:i,rootTask:s}))).uploadedChunks=[],a.uploadingChunk=null,a.paused=!1,a.bootstrapError=!1,a.bootstrapping=!1,a.subDirectories=[],a.files=[],a.rawFileCount=0,a._size=lt,a.parseFile=function(e){var t=ct(e),n=a.parentPath||"".concat(a.dirName,"/"),i=e.name.replace(/\\/g,"/"),r=t.replace(n,"").replace(i,"").split("/"),o=1<r.length;return{isDirectory:o,parentPath:o?"".concat(n).concat(r[0],"/"):"",file:e}},Array.isArray(t)?a.directoryFiles=t:a.directoryEntry=t,a.uuid=o,a.parentPath=n||"",a.isImport=c||!1,a.createDirectory=r.getOpt(b.l.createDirectory),a}function t(){return n.apply(this,arguments)}var n,i,r;function o(e){return i.apply(this,arguments)}function a(){return r.apply(this,arguments)}return S()(l,e),m()(l,[{key:"init",value:function(e){return this.directoryEntry?this.initByDirectoryEntry(e):this.initByDirectoryFiles(e)}},{key:"upload",value:(r=p()(I.a.mark(function e(){var t,n,i,r,o,a,s,c,l,u,d,h;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(N.e)()){e.next=2;break}return e.abrupt("return",!1);case 2:if(this.bootstrapped){e.next=5;break}return e.next=5,this.bootstrap();case 5:if(this.paused)return e.abrupt("return",!1);e.next=7;break;case 7:if(this.bootstrapped){e.next=9;break}return e.abrupt("return",!1);case 9:n=!(t=!0),i=void 0,e.prev=12,r=this.subDirectories[Symbol.iterator]();case 14:if(t=(o=r.next()).done){e.next=24;break}return a=o.value,e.next=18,a.upload();case 18:if(e.sent)return e.abrupt("return",!0);e.next=21;break;case 21:t=!0,e.next=14;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(12),n=!0,i=e.t0;case 30:e.prev=30,e.prev=31,t||null==r.return||r.return();case 33:if(e.prev=33,n)throw i;e.next=36;break;case 36:return e.finish(33);case 37:return e.finish(30);case 38:c=!(s=!0),l=void 0,e.prev=41,u=this.files[Symbol.iterator]();case 43:if(s=(d=u.next()).done){e.next=55;break}if(h=d.value,this.paused)return e.abrupt("return",!1);e.next=47;break;case 47:return e.next=49,h.upload();case 49:if(e.sent)return e.abrupt("return",!0);e.next=52;break;case 52:s=!0,e.next=43;break;case 55:e.next=61;break;case 57:e.prev=57,e.t1=e.catch(41),c=!0,l=e.t1;case 61:e.prev=61,e.prev=62,s||null==u.return||u.return();case 64:if(e.prev=64,c)throw l;e.next=67;break;case 67:return e.finish(64);case 68:return e.finish(61);case 69:return e.abrupt("return",!1);case 70:case"end":return e.stop()}},e,this,[[12,26,30,38],[31,,33,37],[41,57,61,69],[62,,64,68]])})),a)},{key:"pause",value:function(n){this.subDirectories.forEach(function(e){e.pause(n)}),this.files.forEach(function(e,t){e.pause(n)}),this.paused=void 0===n?!this.paused:n}},{key:"resume",value:function(){this.pause(!1)}},{key:"abort",value:function(){var t=0;this.subDirectories.forEach(function(e){e.isUploading&&(e.abort(),t++)}),this.files.forEach(function(e){e.isUploading&&(e.abort(),t++)}),0<t&&this.fire(b.k.taskProgress,this.rootTask)}},{key:"cancel",value:function(){this.files.forEach(function(e){e.isUploading&&e.abort()}),this.files=[],this.subDirectories.forEach(function(e){e.isUploading&&e.abort()}),this.subDirectories=[],this.uploaderObj.removeTask(this),this.fire(b.k.taskProgress,this.rootTask)}},{key:"retry",value:function(){Object(N.e)()&&(this.paused=!1,this.bootstrapError?this.upload():(this.subDirectories.forEach(function(e){e.paused&&e.pause(!1),e.error&&e.retry()}),this.files.forEach(function(e){e.isPaused&&e.pause(!1),e.error&&e.retry()}),this.isTask&&this.uploaderObj.upload()))}},{key:"checkTaskProgress",value:function(){var e,t,n;this.isTask?this.paused||(n=(e=this.finishedFiles)+this.failedFiles<(t=this.totalFiles)?b.k.taskProgress:e===t?b.k.taskSuccess:b.k.taskError,this.fire(n,this.rootTask)):console.error("ERR - unexpected code execution.")}},{key:"getFromUniqueIdentifier",value:function(t){var e=this.files.find(function(e){return e.uuid===t});if(e)return e;var n=!0,i=!1,r=void 0;try{for(var o,a=this.subDirectories[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.getFromUniqueIdentifier(t);if(s)return s}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return null}},{key:"readEntries",value:function(d,e){var h=this;return new Promise(function(u){e.readEntries(function(){var t=p()(I.a.mark(function e(t){var n,i,r,o,a,s,c,l;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=!(n=!0),r=void 0,e.prev=3,o=t[Symbol.iterator]();case 5:if(n=(a=o.next()).done){e.next=26;break}if((s=a.value).isDirectory)return e.next=10,rt(s,h.uploaderObj,d,{rootTask:h.rootTask,isImport:h.isImport});e.next=14;break;case 10:(c=e.sent)&&h.subDirectories.push(c),e.next=23;break;case 14:if(s.isFile)return e.next=17,at(s,h.uploaderObj,d,{rootTask:h.rootTask,isImport:h.isImport});e.next=22;break;case 17:(l=e.sent)&&h.files.push(l),h.rawFileCount++,e.next=23;break;case 22:console.warn("Invalid FileSystemEntry encountered:",s);case 23:n=!0,e.next=5;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(3),i=!0,r=e.t0;case 32:e.prev=32,e.prev=33,n||null==o.return||o.return();case 35:if(e.prev=35,i)throw r;e.next=38;break;case 38:return e.finish(35);case 39:return e.finish(32);case 40:u(0<t.length);case 41:case"end":return e.stop()}},e,null,[[3,28,32,40],[33,,35,39]])}));return function(e){return t.apply(this,arguments)}}())})}},{key:"initByDirectoryEntry",value:function(r){var o=this;return new Promise(function(){var t=p()(I.a.mark(function e(t){var n,i;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.directoryEntry.createReader(),e.next=3,o.readEntries(r,n);case 3:i=e.sent;case 4:if(i)return e.next=7,o.readEntries(r,n);e.next=10;break;case 7:i=e.sent,e.next=4;break;case 10:t(void 0);case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())}},{key:"initByDirectoryFiles",value:(i=p()(I.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.directoryFiles){e.next=2;break}return e.abrupt("return");case 2:this.setDirName(),n=new Map,i=this.directoryFiles.map(this.parseFile),o=!(r=!0),a=void 0,e.prev=8,s=i[Symbol.iterator]();case 10:if(r=(c=s.next()).done){e.next=26;break}if(l=c.value,u=l.isDirectory,d=l.parentPath,h=l.file,!u){e.next=18;break}(f=n.get(d)||[]).push(h),n.set(d,f),e.next=23;break;case 18:return e.next=20,at(h,this.uploaderObj,t,{rootTask:this.rootTask,isImport:this.isImport});case 20:(p=e.sent)&&this.files.push(p),this.rawFileCount++;case 23:r=!0,e.next=10;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(8),o=!0,a=e.t0;case 32:e.prev=32,e.prev=33,r||null==s.return||s.return();case 35:if(e.prev=35,o)throw a;e.next=38;break;case 38:return e.finish(35);case 39:return e.finish(32);case 40:m=!(g=!0),v=void 0,e.prev=43,b=n[Symbol.iterator]();case 45:if(g=(y=b.next()).done){e.next=54;break}return E=k()(y.value,2),d=E[0],O=E[1],e.next=49,rt(O,this.uploaderObj,t,{rootTask:this.rootTask,isImport:this.isImport,parentPath:d});case 49:(C=e.sent)&&this.subDirectories.push(C);case 51:g=!0,e.next=45;break;case 54:e.next=60;break;case 56:e.prev=56,e.t1=e.catch(43),m=!0,v=e.t1;case 60:e.prev=60,e.prev=61,g||null==b.return||b.return();case 63:if(e.prev=63,m)throw v;e.next=66;break;case 66:return e.finish(63);case 67:return e.finish(60);case 68:case"end":return e.stop()}},e,this,[[8,28,32,40],[33,,35,39],[43,56,60,68],[61,,63,67]])})),o)},{key:"bootstrap",value:(n=p()(I.a.mark(function e(){var t,n,i;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.parentToken)throw new Error("Mount node token unspecified");e.next=2;break;case 2:if(this.bootstrapping)return e.abrupt("return");e.next=4;break;case 4:t=4,this.bootstrapping=!0;case 6:if(0,n="",this.bootstrapped)return e.abrupt("break",39);e.next=10;break;case 10:return e.prev=10,n=Object(N.d)(),e.next=14,this.createDirectory({request:d,parentToken:this.parentToken,rootToken:this.rootTask.parentToken,name:this.name,reqId:n});case 14:if(i=e.sent,this.bootstrapped)return this.fire(b.k.collectReport,this.rootTask,{type:b.o.FolderCreateError,msg:"createDirectory when bootstrapped"}),e.abrupt("break",39);e.next=18;break;case 18:if(i)return this.bootstrapped=!0,this.bootstrapError=!1,this.setChildrenParentToken(i),e.abrupt("break",39);e.next=23;break;case 23:throw new Error("no new directory token");case 26:if(e.prev=26,e.t0=e.catch(10),this.fire(b.k.collectReport,this.rootTask,{type:b.o.FolderCreateError,reqId:n,msg:e.t0.message}),0==t--)return this.bootstrapError=!0,this.fire(b.k.taskError,this.rootTask,{type:b.o.FolderCreateError}),e.abrupt("break",39);e.next=33;break;case 33:return e.next=35,Object(N.i)(1e3);case 35:if(this.paused)return e.abrupt("break",39);e.next=37;break;case 37:e.next=6;break;case 39:this.bootstrapping=!1;case 40:case"end":return e.stop()}},e,this,[[10,26]])})),t)},{key:"setDirName",value:function(){var e,t=this.directoryFiles;t&&0!==t.length&&(this.parentPath?this.dirName=this.parentPath.replace(/\/$/,"").split("/").pop():(e=ct(t[0]),this.dirName=e.split("/")[0]))}},{key:"setChildrenParentToken",value:function(t){this.selfToken=t,this.files.forEach(function(e){return e.parentToken=t}),this.subDirectories.forEach(function(e){return e.parentToken=t})}},{key:"recursiveGetCount",value:function(n,i){return this.files.reduce(function(e,t){return t[n]?e+1:e},0)+this.subDirectories.reduce(function(e,t){return e+t[i]},0)}},{key:"totalFiles",get:function(){return this.subDirectories.reduce(function(e,t){return e+t.totalFiles},this.files.length)}},{key:"totalRawFiles",get:function(){return this.subDirectories.reduce(function(e,t){return e+t.totalRawFiles},this.rawFileCount)}},{key:"finishedFiles",get:function(){return this.recursiveGetCount("completed","finishedFiles")}},{key:"failedFiles",get:function(){return this.recursiveGetCount("error","failedFiles")}},{key:"failedFileNames",get:function(){var e=[],t=!0,n=!1,i=void 0;try{for(var r,o=this.subDirectories[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;a.error&&e.push.apply(e,f()(a.failedFileNames))}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}var s=!0,c=!1,l=void 0;try{for(var u,d=this.files[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var h=u.value;h.error&&e.push(h.name)}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}return e}},{key:"progress",get:function(){var e=this.files.find(function(e){return e.isUploading});if(e)return e.progress;var t=this.subDirectories.find(function(e){return e.isUploading});return t?t.progress:1}},{key:"sizeProgress",get:function(){var e=this.uploadedChunks.reduce(function(e,t){return e+t.size},0),t=0;return this.uploadingChunk&&(t=this.uploadingChunk.loadedSize),(e+t)/this.size}},{key:"isUploading",get:function(){return this.files.some(function(e){return e.isUploading})||this.subDirectories.some(function(e){return e.isUploading})}},{key:"completed",get:function(){return this.files.every(function(e){return e.completed})&&this.subDirectories.every(function(e){return e.completed})}},{key:"error",get:function(){return this.bootstrapError||this.files.some(function(e){return e.error})||this.subDirectories.some(function(e){return e.error})}},{key:"name",get:function(){return this.directoryEntry?this.directoryEntry.name:this.dirName||""}},{key:"type",get:function(){return b.f}},{key:"size",get:function(){if(this._size>lt)return this._size;var e=this.files.reduce(function(e,t){return e+t.size},0);return this._size=this.subDirectories.reduce(function(e,t){return e+t.size},e),this._size}}]),l}(ge),dt=ut;i.d(t,"a",function(){return ve}),i.d(t,"b",function(){return nt}),i.d(t,"d",function(){return pe}),i.d(t,"e",function(){return qe})},Ahmm:function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),o=n("hMnB"),a=n.n(o),s={trackPV:function(e,t){return!!s.checkAble()&&(window.ga("set",{page:e||a.a.pathname,title:t||document.title}),window.ga("send",{hitType:"pageview"}),!0)},trackEvent:function(e){if(!s.checkAble())return!1;var t,n=e.category,i=e.action,r=e.label,o=e.value,a=e.hitCallback;return n&&i&&"event"!==n&&(t={hitType:"event",eventCategory:n,eventAction:i,eventLabel:r||"",eventValue:o||1,hitCallback:function(e){if(e){var t=!1,n=function(){t||(t=!0,e())};return setTimeout(n,1e3),n}}(a)},window.ga("send",t)),!0},trackData:function(e){return!!s.checkAble()&&(e.forEach(function(e){window.ga("set",e)}),!0)},create:function(e){if(!s.checkAble())return!1;var t=[{trackingId:e.trackingId||"UA-103569331-1",cookieDomain:e.cookieDomain||"auto",name:e.name}].concat(r()(e.value)),n=Object.assign.apply(Object,[{}].concat(r()(t)));return window.ga("create",n),!0},getAll:function(){return!!s.checkAble()&&(window.ga(function(){e=window.ga.getAll()}),e);var e},checkAble:function(){return!!window.ga}};t.a=s},AiBH:function(e,ie,re){"use strict";(function(e){re.d(ie,"B",function(){return g}),re.d(ie,"t",function(){return m}),re.d(ie,"v",function(){return v}),re.d(ie,"A",function(){return b}),re.d(ie,"z",function(){return y}),re.d(ie,"C",function(){return E}),re.d(ie,"k",function(){return O}),re.d(ie,"q",function(){return C}),re.d(ie,"x",function(){return k}),re.d(ie,"w",function(){return _}),re.d(ie,"G",function(){return R}),re.d(ie,"d",function(){return N}),re.d(ie,"c",function(){return D}),re.d(ie,"e",function(){return P}),re.d(ie,"g",function(){return B}),re.d(ie,"f",function(){return U}),re.d(ie,"o",function(){return z}),re.d(ie,"a",function(){return H}),re.d(ie,"m",function(){return F}),re.d(ie,"y",function(){return V}),re.d(ie,"r",function(){return W}),re.d(ie,"s",function(){return K}),re.d(ie,"p",function(){return Z}),re.d(ie,"b",function(){return q}),re.d(ie,"F",function(){return Y}),re.d(ie,"n",function(){return J}),re.d(ie,"u",function(){return Q}),re.d(ie,"l",function(){return X}),re.d(ie,"i",function(){return $}),re.d(ie,"j",function(){return ee}),re.d(ie,"h",function(){return te}),re.d(ie,"D",function(){return ne});var t=re("RIqP"),n=re.n(t),i=re("lSNA"),r=re.n(i),o=re("QM+C"),a=re("FZl3");re.d(ie,"E",function(){return a.a});var s,c,l,u=re("bsrO"),d=re("duSr"),h=re("rLED"),f=re("iP/4"),p=re("VI6H"),g="tableRegisterZoneEnd",m={RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,ESC:27,BACKSPACE:8,TAB:9,AT:50,DELETE:46,FAKE_CODE:229,SHIFT:16,CTRL:17,ALT:18,TRANSFORM:20,META_L:91,META_R:93,X:88},v=(s={},r()(s,a.a.FILE,o.NUM_FILE_TYPE.DOC),r()(s,a.a.SHEET,o.NUM_FILE_TYPE.SHEET),r()(s,a.a.BITABLE,o.NUM_FILE_TYPE.BITABLE),r()(s,a.a.MINDNOTE,o.NUM_FILE_TYPE.MINDNOTE),r()(s,a.a.BOX,o.NUM_FILE_TYPE.FILE),r()(s,a.a.SLIDE,o.NUM_FILE_TYPE.SLIDE),r()(s,a.a.WIKI,o.NUM_FILE_TYPE.WIKI),s),b=(c={},r()(c,o.NUM_FILE_TYPE.DOC,a.a.FILE),r()(c,o.NUM_FILE_TYPE.SHEET,a.a.SHEET),r()(c,o.NUM_FILE_TYPE.BITABLE,a.a.BITABLE),r()(c,o.NUM_FILE_TYPE.MINDNOTE,a.a.MINDNOTE),r()(c,o.NUM_FILE_TYPE.FILE,a.a.BOX),r()(c,o.NUM_FILE_TYPE.SLIDE,a.a.SLIDE),r()(c,o.NUM_FILE_TYPE.WIKI,a.a.WIKI),c),y={DOC:0,DOC_COMMENT:1,SHEET:2,SHEET_COMMENT:3,BITABLE:4,OPEN_DOC:6,BOX_COMMENT:9,MINDNOTE:10,MINDNOTE_COMMENT:11},E={LARK:0},O={PREV:4,AFTER:2},C={NOT_SELECTABLE_TYPE:"no-select",USER:"USER",DOCUMENT:Object(h.gb)()?"FILE-SHEET-BITABLE-MINDNOTE-BOX":"FILE-SHEET-BITABLE-MINDNOTE-BOX-SLIDE",ALL:Object(h.gb)()?"USER-FILE-SHEET-BITABLE-MINDNOTE-BOX":"USER-FILE-SHEET-BITABLE-MINDNOTE-BOX-SLIDE",CHAT:"CHAT",GROUP:"GROUP",USER_GROUP:"USER-GROUP",DRIVE:"DRIVE",SLIDE:"SLIDE",UPLOAD:"UPLOAD",JIRA_BLOCK:"JIRA_BLOCK",JIRA_ISSUE_BLOCK:"JIRA_ISSUE_BLOCK",JIRA_FILTER_BLOCK:"JIRA_FILTER_BLOCK",JIRA_FILTER_INTRO:"JIRA_FILTER_INTRO",UPLOADER_FILE:"UPLOADER_FILE",REACTION_BLOCK:"REACTION_BLOCK",INSERT_SHEET:"INSERT_SHEET",INSERT_TABLE:"INSERT_TABLE",INSERT_MINDNOTE:"INSERT_MINDNOTE",INSERT_KANBAN:"INSERT_KANBAN",INSERT_BITABLE:"INSERT_BITABLE",POLL_BLOCK:"POLL_BLOCK",IFRAME_BLOCK:"IFRAME_BLOCK",EQUATION_BLOCK:"EQUATION_BLOCK",ISV_BLOCK:"ISV_BLOCK",CALLOUT_BLOCK:"CALLOUT_BLOCK"},k={ASIDE:[C.USER,C.DOCUMENT,C.ALL,C.GROUP,C.CHAT,C.USER_GROUP,C.JIRA_ISSUE_BLOCK],TYPE:[a.a.USER,a.a.GROUP]},I=564,S=540,T=327,_=Object(d.b)()?360:419,w=313,j=116,M=function(){return[{type:C.ALL,content:e("doc.search.filter.all"),boxSize:_,asideSize:j},{type:C.DOCUMENT,content:e("doc.mention.doc"),boxSize:_,asideSize:j},{type:C.USER,content:e("common.people"),boxSize:_,asideSize:j}]},L=function(){return[{type:C.DRIVE,content:e("etherpad.Drive"),boxSize:_,asideSize:j,noList:!0,hidden:f.a.isOpendoc},{type:C.CHAT,content:e("etherpad.lark.group.card"),boxSize:_,asideSize:j},{type:C.INSERT_TABLE,content:e("common.table"),boxSize:w,asideSize:j,noList:!0},{type:C.INSERT_SHEET,content:e("common.sheet"),boxSize:w,asideSize:j,noList:!0},{type:C.INSERT_BITABLE,content:Object(p.x)()?e("doc.a-panel.bitable.single-product"):e("doc.a-panel.bitable"),boxSize:T,asideSize:j,noList:!0,hidden:!1},{type:C.INSERT_KANBAN,content:Object(p.x)()?e("doc.a-panel.kanban.single-product"):e("doc.a-panel.kanban"),boxSize:327,asideSize:j,noList:!0,hidden:!1},{type:C.POLL_BLOCK,content:e("block.poll"),boxSize:_,asideSize:j,noList:!0,noRequest:!0,isAlpha:!0},{type:C.JIRA_BLOCK,content:e("doc.jira.jira"),boxSize:_,asideSize:j,noList:!0,noRequest:!0,hidden:!Object(u.f)()||!Object(u.d)()},{type:C.JIRA_FILTER_BLOCK,content:e("doc.jira.jira_filter"),boxSize:S,asideSize:j,title:e("doc.jira.insert_jira_filter"),autoHeight:!0,noRequest:!0,noList:!0,hidden:!0},{type:C.JIRA_ISSUE_BLOCK,content:e("doc.jira.jira_issue"),boxSize:I,asideSize:j,title:e("doc.jira.recent_jira_issue"),hidden:!0},{type:C.IFRAME_BLOCK,content:e("block.iframe_add_embeds"),boxSize:_,asideSize:j,noList:!0,noRequest:!0}]},R=function(){return[{type:C.NOT_SELECTABLE_TYPE,content:e("etherpad.memtioned")}].concat(n()(M()),[{type:C.NOT_SELECTABLE_TYPE,content:e("etherpad.insert")}],n()(L()))},N=[C.INSERT_TABLE,C.INSERT_SHEET,C.INSERT_BITABLE,C.INSERT_KANBAN],D=[C.DRIVE],x=[C.CHAT],P=R().filter(function(e){return!x.includes(e.type)}),B={UNKNOWN_STATE:0,ACTIVE:1,EXPIRED:2,DEACTIVED:3},U={joined:e("etherpad.initiate_conversation"),unjoined:e("etherpad.join_group_chat")},z="hold-when-replace",H={DOC:0,COMMENT:1,WHOLE_COMMENT:2},F="DRIVE",V={1:e("etherpad.server_abnormal"),2:e("error.args_error"),3:e("error.object_not_found"),4:e("error.no_permission"),5:e("warn.login_required_tips"),6:e("error.request_timeout")},W={1:e("etherpad.insert_chatcard_failed"),4e3:e("etherpad.insert_chatcard_failed_not_in_group"),4011:e("etherpad.insert_chatcard_failed_unshare_setting"),4014:e("etherpad.insert_chatcard_failed_only_master"),4015:e("etherpad.join_group_failed_forbidden"),4019:e("etherpad.insert_chatcard_failed_disappeared")},K={1:e("etherpad.join_group_failed_need_verification"),2:e("etherpad.join_group_failed_invitation"),4011:e("etherpad.join_group_failed_invalid"),4012:e("etherpad.join_group_failed_already_in"),4013:e("etherpad.join_group_failed_limited"),4014:e("etherpad.join_group_failed_invitation"),4015:e("etherpad.join_group_failed_forbidden"),4017:e("etherpad.join_group_failed_organization"),4018:e("etherpad.join_group_failed_dissolved"),4019:e("etherpad.join_group_failed_no_found"),4023:e("etherpad.join_group_failed_unshare"),4034:e("etherpad.join_group_failed"),4037:e("etherpad.join_group_failed_organization"),5016:e("etherpad.join_group_failed_dissolved"),5020:e("etherpad.join_group_failed_need_verification"),1000002:e("etherpad.join_group_failed_unshare")},Z={YOUTUBE:"YOUTUBE",BILIBILI:"BILIBILI",YOUKU:"YOUKU",AIRTABLE:"AIRTABLE",BAIDUMAP:"BAIDUMAP",AUTONAVI:"AUTONAVI",GMAPS:"GMAPS",XIGUA:"XIGUA",TIKTOK:"TIKTOK",FIGMA:"FIGMA",MODAO:"MODAO",CANVA:"CANVA",CODEPEN:"CODEPEN",JINSHUJU:"JINSHUJU",FEISHU_SURVEY:"FEISHU_SURVEY",LARK_SURVEY:"LARK_SURVEY"},q={COPY_ANCHOR_LINK:"copy-anchor-link",LINE_COPY:"line-copy",LINE_CUT:"line-cut",LINE_DELETE:"line-delete",DOCUMENT:"file-sheet-bitable-mindnote-box",DRIVE:"drive",INSERT_TABLE:"insertTable",SHEET:"sheet",KANBAN:"kanban",BITABLE:"bitable",MINDNOTE:"mindnote",USER:"user",CHAT:"chat",POLL_BLOCK_SINGLE:"poll_block_single",POLL_BLOCK_MULTIPLE:"poll_block_multiple",LINK:"link",BOOKMARK:"bookmark",DIAGRAM:"diagram",DIAGRAM_FLOWCHART:"diagram_flowchart",DIAGRAM_UML:"diagram_uml",JIRA_BLOCK:"jira_block",JIRA_ISSUE_BLOCK:"jira_issue",JIRA_FILTER_BLOCK:"jira_filter",JIRA_FILTER_INTRO:"jira_filter_intro",CHECKBOX:"checkbox",INSERTIMAGE:"insertimage",IMAGE:"image",YOUTUBE:"youtube",BILIBILI:"bilibili",YOUKU:"youku",AIRTABLE:"airtable",BAIDUMAP:"baidumap",AUTONAVI:"autonavi",GMAPS:"gmaps",XIGUA:"xigua",TIKTOK:"tiktok",FIGMA:"figma",MODAO:"modao",CANVA:"canva",CODEPEN:"codepen",JINSHUJU:"jinshuju",FEISHU_SURVEY:"feishu_survey",LARK_SURVEY:"lark_survey",INSERTIMAGE_RELAY:"insertimage_relay",INSERT_CODE_LIST:"insertcodelist",EQUATION_BLOCK:"equation_block",ISV_BLOCK:"isv_block_insert",ISV_BLOCK_REFRESH:"isv_block_refresh",ISV_DEBUG_CREATOR:"isv_debug_creator",ISV_DEBUG_BLOCK:"isv_debug_block",CALLOUT_BLOCK:"callout_block",INSERT_IMAGE_OR_VIDEO:"insertImageOrFile"},Y=(l={},r()(l,q.DOCUMENT,C.DOCUMENT),r()(l,q.DRIVE,C.DRIVE),r()(l,q.INSERT_TABLE,C.INSERT_TABLE),r()(l,q.MINDNOTE,C.INSERT_MINDNOTE),r()(l,q.SHEET,C.SHEET),r()(l,q.KANBAN,C.KANBAN),r()(l,q.BITABLE,C.BITABLE),r()(l,q.USER,C.USER),r()(l,q.CHAT,C.CHAT),r()(l,q.POLL_BLOCK,C.POLL_BLOCK),r()(l,q.JIRA_ISSUE_BLOCK,C.JIRA_ISSUE_BLOCK),r()(l,q.JIRA_FILTER_BLOCK,C.JIRA_FILTER_BLOCK),r()(l,q.JIRA_BLOCK,C.JIRA_BLOCK),r()(l,q.JIRA_FILTER_INTRO,C.JIRA_FILTER_INTRO),r()(l,q.EQUATION_BLOCK,C.EQUATION_BLOCK),r()(l,q.CALLOUT_BLOCK,C.CALLOUT_BLOCK),l),J="ERROR",Q={CLICK_EMBED_QUICK_SHARE:"click_embed_quick_share",CLICK_EMBED_QUICK_APPLY:"click_embed_quick_apply",SHOW_EMBED_QUICK_SHARE_TIP:"show_embed_quick_share_tip"},X="draggable:dragstatuschange",$="clientside-chatcard",ee="data-clientside-chatcard-props",te="clientside-chatCardProps",ne="ToggleClassInEmbedObj"}).call(this,re("2vAP"))},AkIV:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return l});var i=n("D7h9"),r=n("yaX4"),o=n("G8Hj"),a=n("n3ZB");function s(e){return e&&(e.tagName||"").toLowerCase()}function c(e){return e.metaKey&&86===e.keyCode}function l(e){var t=i.default.getState();!1===Object(a.i)(t).getIn([e,o.STEP_STATE.DONE])&&i.default.dispatch(Object(r.d)(e))}},ApcK:function(e,t,n){},AqxG:function(e,t,n){},AvAw:function(e,t,n){"use strict";n.r(t);var i=n("RIqP"),s=n.n(i),r=n("o0o1"),c=n.n(r),o=n("yXPU"),l=n.n(o),a=n("lwsE"),u=n.n(a),d=n("W8MJ"),h=n.n(d),f=n("lSNA"),p=n.n(f),g=n("BeL+"),w=n("AiBH"),j=n("PyL4"),m=n("Ns/6"),M=n("mRaX"),v=n("U5G9"),b=n("XVMX"),y=n("5cZX"),E=n("IyQe"),O=n("vc5i"),C=n("ZGZ5"),k=n("D7h9");n("n3ZB"),n("m1/u"),n("jp/M"),n("G8Hj");function I(){var e=k.default.getState(),t=Object(O.n)(e),n=Object(O.f)(e),i=n&&n.get("type"),r=Object(C.a)(e),o=r&&r.get("id"),a=Object(y.j)(e);return{fileType:i,fileToken:t,userId:o,isShareable:Object(E.getUserPermissions)(a.toJS()).shareable}}var S,L=n("8wYP"),R=n("H6oK");n.d(t,"NotifyType",function(){return T}),n.d(t,"MentionNotificationQueue",function(){return P});var T,_,N=Object(v.b)({module:v.a.MENTION}),D=(S={},p()(S,w.E.USER,m.a),p()(S,w.E.GROUP,m.c),S);function x(t){return new Promise(function(e){return window.setTimeout(e,t)})}(_=T=T||{})[_.BOT=1]="BOT";var P=function(){function e(){u()(this,e),this.queue=[],this.users=[],this.groups=[],this.decisionSet=new Set}function t(e){return n.apply(this,arguments)}var n,i,r;function o(){return i.apply(this,arguments)}function a(e,t,n){return r.apply(this,arguments)}return h()(e,[{key:"getShareInfo",value:function(){return I()}},{key:"calTextAndCollectMentionFromRep",value:function(C,e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=t.source||w.z.DOC_COMMENT,k=e.apool,i=t.mentionOptions,r=(i&&i.notifyOptions?i.notifyOptions:{}).useMention,o=void 0!==r&&r,a=Object(L.b)({changesetHelper:N,rep:e}),I=[],S="",T="",_=[];a.forEach(function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f=Object(M.q)(e.attribsNum,k),p=Object(L.a)(e.attributes),g=Object(R.isBlockAttributes)(p),m=f["mention-token"],v=f["mention-link"],b=f["mention-notify"],y=f["mention-sharePermHeldBack"],E=f["mention-icon"],O=Object(L.e)(C,e);T+=O,m?(t=Number.parseInt(f["mention-type"]),n=decodeURIComponent(v),t!==w.E.USER&&t!==w.E.GROUP||(n="",i=O.startsWith("@")?O.slice(1):O,_.push({targetName:i,name:i,token:m,type:t,shouldNotifyLark:b,sharePermHeldBack:y})),t===w.E.USER&&I.push(m),S+='<at type="'.concat(t,'" href="').concat(n,'" token="').concat(m,'"').concat(E?" icon='"+E+"'":"",">").concat(Object(j.escapeHTML)(O),"</at>")):(r="",!g||(o=Object(R.getBlockPropsFromAttributesMap)(p))&&o.blockType===R.BlockType.AT_USER_BLOCK&&(a=O.startsWith("@")?O.slice(1):O,o.props&&o.props.data&&o.props.data.user&&(c=(s=o.props.data).user,u=void 0!==(l=s.mentionNotify)&&l,h=void 0!==(d=s.sharePermHeldBack)&&d,_.push({targetName:a,name:a,token:c.id,type:w.E.USER,shouldNotifyLark:u.toString(),sharePermHeldBack:h.toString()}),r='<at type="'.concat(w.E.USER,'" href="" token="').concat(c.id,'">').concat(Object(j.escapeHTML)(O),"</at>"),I.push(c.id))),S+=r||Object(j.escapeHTML)(O||""))});var s,c=this.getTokens(_),l=c.toUsers,u=c.toGroup;return n!==w.z.DOC_COMMENT&&n!==w.z.SHEET&&n!==w.z.SHEET_COMMENT&&n!==w.z.MINDNOTE&&n!==w.z.MINDNOTE_COMMENT&&n!==w.z.BOX_COMMENT&&(o?(s=i&&i.notifyParams||{},this.addUserMentionV2(l,s)):this.addUserMention(l,n)),this.addGroupMention(u,n,T),{html:S,mentionTokenList:I}}},{key:"register",value:function(e,t,n){var i=this,r=this.createDecision(e,t,n);this.decisionSet.add(r),r.finally(function(){return i.decisionSet.delete(r)})}},{key:"createDecision",value:(r=l()(c.a.mark(function e(t,n,i){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.race([n,x(i)]);case 2:e.sent===b.b.CANCELED&&this.removeTargetToNotify(t);case 4:case"end":return e.stop()}},e,this)})),a)},{key:"addUserMention",value:function(e,t){var n;0!==e.length&&(n=this.getShareInfo(),this.queue.push({type:w.E.USER,config:{to_user:Object(g.a)(e),note_token:n.fileToken,source:t,target:w.C.LARK,from_user:n.userId}}))}},{key:"addGroupMention",value:function(e,t,n){var i;0!==e.length&&(i=this.getShareInfo(),this.queue.push({type:w.E.GROUP,config:{entities:{group_chats:Object(g.a)(e).map(function(e){return{id:e,text:n}})},source:t,target:w.C.LARK,token:i.fileToken}}))}},{key:"addUserMentionV2",value:function(e,n,i,r){var o=this;e.forEach(function(e){var t={id:e,query:n};i&&(t.append_hash=i),r&&(t.notify_type=r),o.users.push(t)})}},{key:"addGroupMentionV2",value:function(e,t){var n=this;e.forEach(function(e){n.groups.push({id:e,query:t})})}},{key:"sendMentionNotifications",value:(i=l()(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s()(this.decisionSet),this.decisionSet.clear(),e.next=4,Promise.all(t);case 4:return this.removeTargetToNotify(this.getShareInfo().userId),n=s()(this.queue),this.queue=[],e.abrupt("return",Promise.all(n.map(function(e){var t=e.type,n=e.config;return D[t](n)})));case 8:case"end":return e.stop()}},e,this)})),o)},{key:"sendMentionNotifications2",value:(n=l()(c.a.mark(function e(t){var n,i,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s()(this.decisionSet),this.decisionSet.clear(),e.next=4,Promise.all(n);case 4:if(i=this.getShareInfo(),this.removeTargetToNotify(i.userId),r=s()(this.groups),o=s()(this.users),this.groups=[],this.users=[],0===r.length&&0===o.length)return e.abrupt("return");e.next=12;break;case 12:return e.abrupt("return",D[w.E.GROUP]({source:t,token:i.fileToken,target:w.C.LARK,entities:{group_chats:r,users:o}}));case 13:case"end":return e.stop()}},e,this)})),t)},{key:"removeTargetToNotify",value:function(s){this.queue=this.queue.reduce(function(e,t){var n,i,r,o=t.type,a=t.config;return o===w.E.USER?((n=Object.assign({},a)).to_user=n.to_user.filter(function(e){return e!==s}),0<n.to_user.length&&e.push({type:o,config:n})):o===w.E.GROUP?0<(r=(i=Object.assign({},a)).entities.group_chats.filter(function(e){var t=e.id;return s!==t})).length&&(i.entities=Object.assign({},i.entities,{group_chats:r}),e.push({type:o,config:i})):e.push({type:o,config:a}),e},[]),this.users=this.users.filter(function(e){return e.id!==s}),this.groups=this.groups.filter(function(e){return e.id!==s})}},{key:"getTokens",value:function(e){var t=[],n=[];return e.forEach(function(e){"true"===e.shouldNotifyLark&&"true"!==e.sharePermHeldBack&&(e.type===w.E.USER?t:n).push(e.token)}),{toUsers:t,toGroup:n}}}]),e}();t.default=new P},"B+y1":function(e,t,n){},B8Xq:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var h=n("iP/4");function i(e){var t=e.clipboardData;if(!t)return!1;var n=t.types,i=t.items,r=void 0===i?[]:i,o=JSON.stringify(n),a=1===n.length&&"Files"===n[0],s=2===n.length&&/("text\/plain","Files"|"Files","text\/plain")/.test(o),c=2===n.length&&/"text\/html","Files"|"Files","text\/html"/.test(o),l=h.a.isSafari&&/"Files","text\/uri-list"/.test(o);if(a||s||c||l){var u=Array.prototype.slice.call(r).filter(function(e){return"file"===e.kind}),d=u.filter(function(e){return 0===e.type.indexOf("image/")});return d.length===u.length&&0<d.map(function(e){return e.getAsFile()}).filter(function(e){return!!e}).length}return!1}},BAjd:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"k",function(){return i}),n.d(t,"m",function(){return o}),n.d(t,"l",function(){return f}),n.d(t,"c",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"d",function(){return b}),n.d(t,"o",function(){return p}),n.d(t,"j",function(){return m}),n.d(t,"f",function(){return y}),n.d(t,"g",function(){return E}),n.d(t,"h",function(){return O}),n.d(t,"i",function(){return C}),n.d(t,"a",function(){return k}),n.d(t,"n",function(){return I});var i,r,o,a,s=n("VIFs"),c={CHUNK_CHECK:Object(s.prependAPI)("/api/box/upload/block/check/"),CHUNK_UPLOAD:Object(s.prependDriveStreamAPI)("/api/box/stream/upload/block/"),FINISH:Object(s.prependAPI)("/api/box/upload/finish/"),PREPARE:Object(s.prependAPI)("/api/box/upload/prepare/"),IMPORT_UPLOAD:Object(s.prependAPI)("/api/parser/uploadfile/"),IMPORT_STATUS:Object(s.prependAPI)("/api/parser/getresult/")};(r=i=i||{}).beforeAdd="beforeAdd",r.cancel="cancel",r.cancelAll="cancelAll",r.complete="complete",r.error="error",r.taskProgress="taskProgress",r.fileProgress="fileProgress",r.fileError="fileError",r.fileWarning="fileWarning",r.taskAdded="taskAdded",r.taskError="taskError",r.taskRetry="taskRetry",r.tasksAdded="tasksAdded",r.taskSuccess="taskSuccess",r.pause="pause",r.pauseAll="pauseAll",r.progress="progress",r.uploadStart="uploadStart",r.offline="offline",r.online="online",r.usageLimitReached="usageLimitReached",r.collectReport="collectReport",r.pending="pending",(a=o=o||{}).upload="upload",a.import="import";var l,u,d,h,f={clearInput:"clearInput",dragOverClass:"dragOverClass",fileType:"fileType",importableType:"importableType",fileTypeErrorCallback:"fileTypeErrorCallback",finishTarget:"finishTarget",getParentToken:"getParentToken",createDirectory:"createDirectory",uploadChunk:"uploadChunk",uploadMergedChunk:"uploadMergedChunk",getMountPoint:"getMountPoint",maxFileSize:"maxFileSize",maxImportFileSize:"maxImportFileSize",maxFileSizeErrorCallback:"maxFileSizeErrorCallback",minFileSize:"minFileSize",minFileSizeErrorCallback:"minFileSizeErrorCallback",fastModeEnabled:"fastModeEnabled",emptyDirectoryCallback:"emptyDirectoryCallback",directoryNotImportableCallback:"directoryNotImportableCallback",prepareTarget:"prepareTarget",setChunkTypeFromFile:"setChunkTypeFromFile",simultaneousUploads:"simultaneousUploads",testTarget:"testTarget",throttleProgressCallbacks:"throttleProgressCallbacks",uploadTarget:"uploadTarget",xhrTimeout:"xhrTimeout",onDragStart:"onDragStart",onDragEnd:"onDragEnd",shouldAddToRecents:"shouldAddToRecents",preferMergedChunks:"preferMergedChunks"};(u=l=l||{}).ERROR="error",u.PROGRESS="progress",u.RETRY="retry",u.SUCCESS="success",u.REPORT_ERROR="report_error",(h=d=d||{}).ERROR="error",h.PENDING="pending",h.SUCCESS="success",h.UPLOADING="uploading",h.ABORT="abort";var p,g,m,v,b=3;(g=p=p||{}).ChunkError="ChunkError",g.ChunkSuccess="ChunkSuccess",g.FileFinishError="FileFinishError",g.FilePrepareError="FilePrepareError",g.FileSuccess="FileSuccess",g.FolderCreateError="FolderCreateError",g.ImportUploadError="ImportUploadError",g.ImportParseError="ImportParseError",(v=m=m||{}).Upload="upload",v.Import="import",v.Exit="Exit";var y="directory-a47de874",E=11001,O=10009,C=90002007,k="api.sheet.parser.uploadfile",I=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"]},BMm3:function(e,t,n){"use strict";n.d(t,"d",function(){return d}),n.d(t,"c",function(){return h}),n.d(t,"a",function(){return f}),n.d(t,"b",function(){return r});var i=n("J4zp"),c=n.n(i),a=n("X4VC"),u=n("FJEn").Changeset.numToString,d=function(e,t){return e.chars[1]===t.chars[0]&&e.selZone===t.selZone},h=function(e,t){return Object.assign({},e,{selEnd:t.selEnd,chars:[e.chars[0],t.chars[1]]})},f=function(e,t,n){var i=c()(n,2),r=i[0],o=i[1],a=e.selection.lineAndColumnFromChar(t,r),s=r-o==1?[a[0],a[1]+1]:e.selection.lineAndColumnFromChar(t,o);return{selStart:a,selEnd:s,selZone:t,chars:[r,o]}},r=function(s,e,t,n){var c=[],r=s.getReps(),l=s.getRepManager().apool.getAttribNum("".concat(e,",").concat(t));if(null==l)return c;var o=new RegExp("\\*".concat(u(l),"[+\\*|]"));return(n||Object(a.a)(s,!0)).forEach(function(a){var i,t,e=r[a];e&&(i=0,t=e.alinesWidth,e.alines.forEach(function(n,e){o.test(n)&&function(){for(var t=s.changesetHelper.opIterator(n),o=i,e=function(){var e=t.next(),r=o+e.chars;s.changesetHelper.eachAttribNumber(e.attribs,function(e){var t,n,i;e===l&&(t=c.length-1,n=c[t],i=f(s,a,[o,r]),n&&d(n,i)?c[t]=h(n,i):c.push(i))}),o=r};t.hasNext();)e()}(),i+=t[e]}))}),c}},BkG1:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n("M/LR"),r=n("69iA"),o=(n("t3UV"),n("TWwi"));function a(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return Object(o.a)()?[new i.a(e,t),new r.a(e)]:[]}},BmYl:function(e,n,i){"use strict";(function(d){i.d(n,"a",function(){return t});var e=i("J4zp"),h=i.n(e),f=i("q1tI"),p=i.n(f),g=i("UlbS"),m=i("nVH4");function t(t){var e=Object(f.useRef)(null),n=Object(f.useState)(!1),i=h()(n,2),r=i[0],o=i[1],a=t.getNumberRect(),s=Object.assign({},a,{position:"absolute",cursor:"pointer",zIndex:1}),c=Object(f.useCallback)(function(e){e.stopPropagation()},[]),l=function(e){o(!0),t.onMouseOver&&t.onMouseOver(e)},u=function(e){o(!1),t.onMouseLeave&&t.onMouseLeave(e)};return Object(f.useEffect)(function(){return e.current&&e.current.addEventListener("click",c),function(){e.current&&e.current.removeEventListener("click",c)}},[e.current]),p.a.createElement(g.Tooltip,{title:d("doc.list.set_the_number"),placement:"top",showDelay:300,visible:r},p.a.createElement("div",{className:m.b,style:s,ref:e,"data-magicdomid":t.magicDomId,onMouseOver:l,onMouseLeave:u,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp}))}}).call(this,i("2vAP"))},Bog0:function(e,_,w){"use strict";(function(n){w.d(_,"a",function(){return T});var e=w("lwsE"),i=w.n(e),t=w("W8MJ"),r=w.n(t),o=w("a1gu"),a=w.n(o),s=w("Nsbk"),c=w.n(s),l=w("7W2i"),u=w.n(l),d=w("UXvI"),h=w("q1tI"),f=w.n(h),p=w("zhgJ"),g=w("JWfN"),m=w("Muja"),v=w("OX8E"),b=w("QM+C"),y=w("aXiW"),E=w("2ACu"),O=w("kUgE"),C=w("7NMz"),k=w("sLU5"),I=w("5dbN"),S=(w("dcjY"),"empty-text-placeholder"),T=function(e){function t(e){var o;return i()(this,t),(o=a()(this,c()(t).call(this,e))).placeholderShow=!1,o.needHideTemplate=!1,o.calcFirstLinePositionThrottle=Object(d.default)(function(){var e=o.state,t=e.firstLinePos,n=e.visible,i=t,r=o.calcFirstLinePosition();!Object(m.default)(r,i)&&n&&o.setState({firstLinePos:r})},300),o.handlePluginReadOnly=function(){o.state.visible&&o.setState({visible:!1})},o.handlePluginReadWrite=function(){o.state.visible||o.setState({visible:!0})},o.handleDocEmpty=function(){var e=o.props.editor,t=o.state.firstLinePos,n=o.calcFirstLinePosition();o.placeholderShow&&Object(m.default)(n,t)||o.setState({visible:e.getInnerContainer().classList.contains("docbody--write"),firstLinePos:n})},o.setPlaceholderRef=function(e){(o.placeholderRef=e)&&o.setState({offsetWidth:e.offsetWidth})},o.setTemplateBtnRef=function(e){(o.templateBtnRef=e)&&o.setState({btnOffsetWidth:e.offsetWidth})},o.handleMoreTemplateClick=function(){Object(E.default)("toggle_attribute",{action:"show_more_template"}),Object(g.a)({test_id:"7",user_group:Object(p.i)()}),Object(y.a)("click_template_entrance").push({source:"docs_placeholder_template",module:"Doc"}),Object(y.a)("create_from_template_center").push({source:"docs_placeholder_template"}),o.props.callTemplateCenter({objType:b.ENTITY_TYPE.DOC,allowSuiteTypes:Object(I.isUnderWiki)()?[b.ENTITY_TYPE.DOC]:void 0,onCreate:function(e){var t=e.obj_token;v.a.emit(k.a.PC.DOCS.TEMPLATE.INSERT,[t])}})},o.renderTemplateBtn=function(e){return f.a.createElement("div",{className:"".concat(S,"__template-btn"),style:Object.assign({},e),onClick:o.handleMoreTemplateClick,ref:o.setTemplateBtnRef},f.a.createElement(C.a,null),f.a.createElement("span",null,n("common.template")))},o.renderUsingText=function(e){return f.a.createElement("div",{className:"".concat(S,"__text"),style:Object.assign({},e,{marginLeft:4})},f.a.createElement("span",null,n("doc.body_placeholder_using")))},o.state={offsetWidth:0,btnOffsetWidth:0,visible:e.editor.getInnerContainer().classList.contains("docbody--write"),firstLinePos:o.calcFirstLinePosition()},v.a.on(k.a.PC.DOCS.PLACEHOLDER.DOC_EMPTY,o.handleDocEmpty),v.a.on(k.a.PC.DOCS.PLACEHOLDER.READ_ONLY,o.handlePluginReadOnly),v.a.on(k.a.PC.DOCS.PLACEHOLDER.READ_WRITE,o.handlePluginReadWrite),o}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.calcFirstLinePositionThrottle,!1)}},{key:"componentDidUpdate",value:function(e,t){var n,i;this.needHideTemplate&&0<document.querySelectorAll(".".concat(S,"__template-btn")).length&&(this.needHideTemplate=!1,v.a.emit(k.a.PC.DOCS.TEMPLATE.PERFORM_HIDE_ANIMATION)),this.props.isTemplateVisible===e.isTemplateVisible&&this.props.canEdit===e.canEdit||!this.placeholderRef||(n=this.placeholderRef.offsetWidth,i=this.templateBtnRef?this.templateBtnRef.offsetWidth:0,this.state.offsetWidth===n&&this.state.btnOffsetWidth===i||this.setState({offsetWidth:n,btnOffsetWidth:i}),e.isTemplateVisible&&!this.props.isTemplateVisible&&(this.needHideTemplate=!0))}},{key:"componentWillUnmount",value:function(){v.a.off(k.a.PC.DOCS.PLACEHOLDER.DOC_EMPTY,this.handleDocEmpty),v.a.off(k.a.PC.DOCS.PLACEHOLDER.READ_ONLY,this.handlePluginReadOnly),v.a.off(k.a.PC.DOCS.PLACEHOLDER.READ_WRITE,this.handlePluginReadWrite),window.removeEventListener("resize",this.calcFirstLinePositionThrottle,!1)}},{key:"calcFirstLinePosition",value:function(){var e=this.props.editor,t=e.getRep().lines.atIndex(1);if(!t||!t.isActive)return null;var n=t.lineNode,i=e.getOuterContainer(),r=window.getComputedStyle(n),o=r.lineHeight,a=r.paddingTop,s=parseFloat(o||""),c=parseFloat(a||""),l=n.getBoundingClientRect(),u=i.getBoundingClientRect();return{left:0,top:l.top-u.top+s/2+c}}},{key:"calcPlaceholerTextPosition",value:function(){var e=this.state.firstLinePos;if(!e)return null;var t=e.left,n=e.top,i=this.props.editor.getInnerContainer(),r=window.getComputedStyle(i).paddingLeft;return{left:t+parseFloat(r||""),top:n}}},{key:"calcTemplateBtnPosition",value:function(e){if(!e)return null;var t=e.left,n=e.top;return{left:t+this.state.offsetWidth,top:n}}},{key:"calcUsingTextPosition",value:function(e){if(!e)return null;var t=e.left,n=e.top,i=this.state;return{left:t+i.offsetWidth+i.btnOffsetWidth,top:n}}},{key:"render",value:function(){var e=this.calcPlaceholerTextPosition(),t=this.calcTemplateBtnPosition(e),n=this.calcUsingTextPosition(e);return this.state.visible&&e&&t&&n?(this.placeholderShow=!0,f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"".concat(S,"__text"),style:Object.assign({},e),ref:this.setPlaceholderRef},f.a.createElement("span",null,this.placeholderContent)),this.shouldRenderTemplateBtn&&this.renderTemplateBtn(t),this.shouldRenderTemplateBtn&&this.isJapaneseUser&&this.renderUsingText(n))):(this.placeholderShow=!1,null)}},{key:"displayPlaceholderWithSelect",get:function(){return this.props.isShowBlankDocPlaceholder}},{key:"placeholderContent",get:function(){var e=this.props.customBodyPlaceholder;return e||(this.displayPlaceholderWithSelect?n("doc.body_placeholder_with_select"):n("doc.body_placeholder_default"))}},{key:"shouldRenderTemplateBtn",get:function(){return!this.props.customBodyPlaceholder&&this.displayPlaceholderWithSelect}},{key:"isJapaneseUser",get:function(){return O.LANG_MAP.ja}}]),t}(h.Component)}).call(this,w("2vAP"))},BpSZ:function(e,t,n){"use strict";function i(e){return!!e.match(r)}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r});var r=/^\s*data:([a-z]+\/([a-z]+)(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i},"Bq+3":function(e,Z,q){"use strict";(function(p){var e,t=q("RIqP"),ne=q.n(t),n=q("lSNA"),O=q.n(n),i=q("o0o1"),ie=q.n(i),r=q("yXPU"),w=q.n(r),o=q("lwsE"),a=q.n(o),s=q("W8MJ"),c=q.n(s),l=q("hbEN"),re=q("7EGn"),k=q("dtwz"),oe=q("HmyT"),j=q("6Do3"),ae=q("2ACu"),se=q("lG83"),g=q("OZf9"),M=q("Bw5p"),ce=q("fujP"),u=q("Z0Cl"),d=q("vJtL"),le=q("jVwk"),ue=q("1dfU"),L=q("iP/4"),h=q("TSYQ"),I=q.n(h),f=q("/spq"),R=q("wq9/"),de=q("uwMH"),he=q("aXiW"),S=q("Cy2Z"),fe=q("OX8E"),T=q("QM+C"),N=q("lQZd"),_=q("PyL4"),pe=q("XNb2"),m=q("9g7G"),v=q("KiYW"),D=q("ouE1"),b=q("whZn"),ge=q("jp/M"),y=q("q1tI"),x=q.n(y),me=q("mRaX"),E=q("duSr"),ve=q("PX10"),be=q("AiBH"),ye=q("7Kxq"),P=q("/fVd"),B=q("HIeq"),U=q("Wc+A"),z=q("n/R6"),Ee=q("y2sV"),H=q("H6oK"),Oe=q("SGN9"),Ce=q("A+1H"),C=q("bsrO"),F=q("LaDK"),ke=q("Yspk"),V=q("kmoK"),Ie=Object(E.b)(),W=["mention-type","mention-link","mention-token","mention-id","mention-tempId","mention-chatId","mention-chatToken","mention-icon"],K=Object(f.a)(["showMentionBox","handleConfirm"])(e=function(){function i(e){var C=this;a()(this,i),this.setCustomIconEnableFG=function(e){C.customIconEnable=e},this.setMentionFileManager=function(e){(C.mentionFileManager=e)&&C.editor.on(Ee.k.PAINT,C.notifyMentionListChange)},this.notifyMentionListChange=function(){var e=C.mentionFileManager;e&&e.isNeedResortLine&&C.debounceNotifyMentionListChange()},this.debounceNotifyMentionListChange=Object(l.default)(function(){var e,t=C.mentionFileManager,n=C.props.controller;n&&t&&(e=C.mentionFileManager.getAllMentionObjects(C.editor),n.mentionFileListChange(e))},200),this.UNSAFE_editorNormalizePasteNode=function(e){var t,n=e.data.node,i=Object(oe.$)(n),r=i.find(".mention");r.length&&(Object(g.a)(r,function(e){var t=Object(me.h)();e.className=e.className.replace(/mention-tempId_\S*/,"").replace(/mention-uuid_\w+/,"mention-uuid_".concat(t))}),t=C.editor.selection.getSelection().start.line,C.lastPasteLineNum=t);var o=i.find(".".concat(be.i));o.length&&Object(g.a)(o,function(e){var t=Object(oe.$)(e).attr(be.j);try{var n,i=C.editor.clipboard.getPasteInfo(),r=i.pasteFrom,o=i.pasteTimes;"cut"===r&&1===o?(Object(oe.$)(e).removeAttr(be.j),Object(oe.$)(e).attr(H.DATA_META_BLOCK_PROPS,t),Object(oe.$)(e).removeClass("".concat(be.i," ignore-collect"))):(n=Object(H.generateBlockDataSet)(JSON.parse(t)),Object(oe.$)(e).attr(be.j,JSON.stringify(n)))}catch(e){throw new Error("[Chatcard]: clientside-props parse error.")}})},this.updateClientSideChatCardProps=function(e){return e.reduce(function(e,t){if(t instanceof Ee.E){var n=t.reduce(function(e,t){var n,i,r,o=Object.assign({},t.attributes);return t.insert&&t.attributes&&t.attributes.dataMetaBlockProps&&(i=(n=JSON.parse(t.attributes.dataMetaBlockProps)).blockType,r=n.props,T.isAnonymousAccess||i!==H.BlockType.CHAT_CARD_BLOCK||(o[be.h]=JSON.stringify(Object(H.generateBlockDataSet)({blockType:i,props:r})),delete o.dataMetaBlockProps)),e.insert(t.insert,o)},new Ee.E({zoneId:t.zoneId}));return e.concat(n)}return e.concat(t)},new Ee.e)},this.editorWillPaste=function(e){var t=e.isInternalPaste,n=e.deltaSet;return t?(n=C.updateClientSideChatCardProps(n)).reduce(function(e,t){if(t instanceof Ee.E){var n=Object(Ee.N)(t,function(e){return e.key.startsWith("mention-uuid_")},function(){return{key:"mention-uuid_".concat(Object(me.h)()),value:"true"}});return e.concat(n)}return e.concat(t)},new Ee.e):n},this.changesetApply=function(e,t){var n=t.editor,i=function(){if(C.mentionBox&&!Object(oe.$)(".".concat(ye.a).concat(C.uuid)).length)return C.mentionBox.close(),void(C.mentionBox=null);!n.getSelectedRep()||C.keywords&&C.keywords.length||D.c.show(n,C.placeholderText)};t.editor.version.includes(Ee.y)?t.editor.once("paint",i):i()},this.aceAttribsToClasses=function(e,t){var n=t.key,i=t.value;if(n!==D.a||D.c.getEnable())return-1<W.indexOf(n)?"".concat(n,"_").concat(i):/mention/.test(n)||/at-(.+)/.test(n)?n:void 0},this.match=function(e){return!(e===D.a&&!D.c.getEnable())&&!!(-1<W.indexOf(e)||/mention/.test(e)||/at-(.+)/.test(e))},this.render=function(e){var t,n=e.attributes,i=e.insert,r="";for(t in n){var o=n[t];t===D.a&&!D.c.getEnable()||(-1<W.indexOf(t)&&(r+="".concat(r?" ":"").concat(t,"_").concat(o)),(/mention/.test(t)||/at-(.+)/.test(t))&&(r+=(r?" ":"")+t))}var a=C.customIconEnable;if(/(^| )mention-token|mention-chatId/.test(r)){var s,c=Object(me.e)(r),l=c.type,u=c.link,d=c.token,h=c.icon,f=u&&decodeURIComponent(u)||"";switch(f&&V.a.isWiki()&&V.a.addTask(f),parseInt(l)){case be.E.GROUP:case be.E.USER:return parseInt(l)===be.E.USER&&d===C.ownerId&&(v="at-self-highlight"),e.class=I()(r,"mention",v),x.a.createElement("a",{href:"javascript:void(0)",contentEditable:"false"},e.children);case be.E.CHAT:s="".concat(T.isAnonymousAccess?Object(me.V)():Object(me.W)({url:f})),v="ignore-dom ".concat(S.a.join(" ")),e.class=I()(r,"mention",v);var p="single-line mention-chat-card ignore-attr-heading";return e.lineClass+=" ".concat(p," ").concat(S.b.join(" ")),x.a.createElement("span",{dangerouslySetInnerHTML:{_html:s}});default:var g=C.props.embedObjShareEnable,m=!(!g||!P.a.getInstance())&&!!P.a.cantReadFiles[d],v="".concat(T.isAnonymousAccess?"popover-disabled":""),b={token:d,type:be.v[l],title:i};g&&!P.a.isEmptyStash()&&P.a.completeInStash(b);var y=C.mentionFileManager;y&&y.completeInStash(Object.assign({},b,{link:u}));var E=m?"content-with-lock":"",O=e.children;return a&&h&&(E+=" content-with-icon",O=x.a.createElement(x.a.Fragment,null,x.a.createElement("i",{style:{backgroundImage:"url(".concat(C.getIconUrl(h),")")},className:"mention-doc-icon ".concat(v)}),e.children)),e.class=I()(r,"mention",v),x.a.createElement(Ee.l,{"data-fake-text":i},x.a.createElement("a",{href:f,"data-href":f,rel:"noopener noreferrer",target:"_blank",contentEditable:"false",className:E,onDragStart:C.onDragStart},O))}}else r&&!e.mark&&(e.mark=!0,e.class=r);return e.children},this.onDragStart=function(e){e.preventDefault()},this.handleDidPaste=function(e){var t=e.deltaSet.reduce(function(e,t){if(!(t instanceof Ee.E))return e;var n=[];return t.forEach(function(e){e.insert&&e.attributes&&e.attributes[be.h]&&n.push(e.attributes[be.h])}),e.concat(n)},[]);Object(g.a)(t,function(e){C.replaceClientsideChatCard(JSON.parse(e))})},this.handleTableResize=function(){D.c.show(C.editor,C.placeholderText)},this.replaceClientsideChatCard=function(){var t=w()(ie.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(re.default)(t,["props","data","chatId"]),i=Object(re.default)(t,["blockId"]),e.prev=2,e.next=5,Object(m.h)(n);case 5:o=e.sent,r=o.data.Token,e.next=16;break;case 9:return e.prev=9,e.t0=e.catch(2),a=e.t0.code,s=Object(re.default)(e.t0,["data","RespCode"])||a,c=be.r[s]||p("etherpad.insert_chatcard_failed"),z.a.show({type:"error",closable:!0,content:c}),e.abrupt("return");case 16:if(t.props.data.chatToken=r,l=[["dataMetaBlockProps",JSON.stringify(t)]],u=C.getClientsideChatCardRange(C.editor,i)){e.next=21;break}return e.abrupt("return");case 21:d=u.selStart,h=u.selEnd,f=u.selZone,C.editor.inCallStackIfNecessary("replaceChatCard",function(){C.editor.fastIncorp(),C.editor.performDocumentReplaceRangeWithAttributes(f,d,h," ",l),C.editor.updateBrowserSelectionFromRep()});case 23:case"end":return e.stop()}},e,null,[[2,9]])}));return function(e){return t.apply(this,arguments)}}(),this.getClientsideChatCardRange=function(e,n){var i=be.h,t=function(e,t){return Boolean(e===i&&JSON.parse(t).blockId===n)},r=e.getMatchedAttributePositionOnSelection(null,t)[0];return r?r.docPosition:null},this.aceAfterCompositionEnd=function(e){for(;C.taskQueue.length;){var t=C.taskQueue.pop();Object(d.default)(t)&&t()}},this.processBeforeInsertNode=function(e,t){var n,i=t.entry,r=t.cls;/(^| )mention-token|mention-chatId/.test(r)&&(n=Object(me.e)(r).type,parseInt(n)===be.E.CHAT&&(i.domInfo.lineManagerType="mention_chat"))},this.bufferChanged=function(e,t){C.props.embedObjShareEnable&&C.embedMentionManager.handleBufferChanged(C.editor,t)},this.editorAlinesDidSplice=function(e,t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y=C.mentionFileManager,E=C.props.embedObjShareEnable;(E||y)&&(n=t.currentState,r=(i=t.prevState).numToAttrib,o=i.alinesSplice,a=n.numToAttrib,s=n.alinesSplice,c=n.alinesAttribs,u=(l=function(e){return Object(k.a)(me.I,Object(me.m)(e))})(o)(r),d=l(s)(a),h=Object(me.H)(u),f=Object(me.H)(d),p=Object(me.Z)(h,f),m=!!(g=Object(me.Z)(f,h)).length,v=!!p.length,E&&(m&&P.a.addTokenInStash(g),v&&P.a.removeFromStash(p),C.embedMentionManager.processAddTokensFromNewLine({hasAddTokens:m,alinesAttribs:c})),y&&(m&&y.addTokenInStash(g),v&&y.removeFromStash(p),b=m||v,y.spliceLineInZone({preTokenLists:u,curTokenLists:d,context:t,isMentionListChange:b})))},this.linesWillReplace=function(e,t){C.embedMentionManager.handleLinesWillReplace(t)},this.aceCreateDomLine=function(e,t){var n=t.spanClass,i=t.attrObj,r=C.customIconEnable;if(/(^| )mention-token|mention-chatId/.test(n)){var o,a,s,c,l=Object(me.e)(n),u=l.type,d=l.link,h=l.token,f=l.icon,p=d&&decodeURIComponent(d)||"",g=Object(me.X)(C._preventXss(p));switch(parseInt(u)){case be.E.GROUP:case be.E.USER:b='<a href="javascript:void(0)" contenteditable="false">',o="</a>",parseInt(u)===be.E.USER&&h===C.ownerId&&(s="at-self-highlight");break;case be.E.CHAT:a="".concat(T.isAnonymousAccess?Object(me.V)():Object(me.W)({url:p})),s="ignore-dom ".concat(S.a.join(" ")),c="single-line mention-chat-card ignore-attr-heading ".concat(S.b.join(" ")),t.editable=!1;break;default:var m=C.props.embedObjShareEnable,v=!(!m||!P.a.getInstance())&&!!P.a.cantReadFiles[h],b='<a href="'.concat(g,'"data-href="').concat(g,'"\n            rel="noopener noreferrer" target="_blank" contenteditable="false"\n            class="').concat(v?"content-with-lock":""," ").concat(r&&f?"content-with-icon":"",'">');r&&f&&(b+='<i style="background-image:url('.concat(C.getIconUrl(f),')" class="mention-doc-icon" ></i>')),o="</a>",s="".concat(T.isAnonymousAccess?"popover-disabled":"");var y={token:h,type:be.v[u],title:C.decodeText(t.text)};m&&!P.a.isEmptyStash()&&P.a.completeInStash(y);var E=C.mentionFileManager;E&&E.completeInStash(Object.assign({},y,{link:d}))}a?t.rawHtml=a:(t.extraOpenTags="".concat(t.extraOpenTags).concat(Ee.B).concat(b),t.extraCloseTags="".concat(o).concat(t.extraCloseTags),C.editor.version.includes(Ee.y)||(t.extraOpenHtml=ge.common.OLD_FAKETEXT_PREFIX,t.extraCloseHtml=ge.common.OLD_FAKETEXT_SUFFIX)),t.spanClass=I()(n,"mention",s),t.attributes=Object.assign({},t.attributes,O()({},Ee.m,t.text)),C.editor.version.includes(Ee.y)||(t.attributes=Object.assign({},t.attributes,{"data-faketext":t.text})),c&&(t.lineClass="".concat(t.lineClass," ").concat(c))}i.chatCardProps&&(t.extraOpenTags="<span class=".concat(be.i,"\n      ").concat(be.j,'="').concat(Object(_.escapeHTML)(i.chatCardProps),'">'),t.extraCloseTags="</span>")},this.getIconUrl=function(e){var t=JSON.parse(e),n=t.type,i=t.key,r=t.fs_unit;return n===T.NUM_CUSTOM_ICON_TYPE.IMAGE?Object(v.e)({key:i,fs_unit:r}):""},this.decodeText=function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x2F;":"/"},n=/&amp;|&lt;|&gt;|&quot;|&#x27;|&#x2F;/gm;return e&&e.replace(n,function(e){return t[e]||e})},this.aceBeforeCopy=function(e){var t,n=window.getSelection();if(n.getRangeAt?t=n.getRangeAt(0):((t=document.createRange()).setStart(n.anchorNode,n.anchorOffset),t.setEnd(n.focusNode,n.focusOffset)),3===t.endContainer.nodeType){var i=Object(ve.c)(t.endContainer,"mention-type_".concat(be.E.USER));if(i){var r=Object(ve.c)(i,"j-block-container");return r?"".concat(r.outerHTML,"<span> </span>"):"".concat(i.outerHTML,"<span> </span>")}}},this.collectContentPre=function(e,t){var n,r,i,o,a,s,c=t.tname,l=t.node,u=t.cc,d=t.state,h=t.cls;if("a"===c){for(;l&&"span"!==c&&"body"!==c;)l=l.parentNode,c=(Object(re.default)(l,"tagName")||"").toLocaleLowerCase();var f=l&&l.className;f&&-1<f.indexOf("mention")&&Object(g.a)(f.split(" "),function(e){var t;/mention/.test(e)&&"mention"!==e&&(0===e.indexOf("mention-icon")?(t=e.substring("mention-icon_".length),u.doAttrib(d,"mention-icon",t)):u.doAttrib(d,e))})}"span"===c&&h&&-1<h.indexOf("at-holder")&&Object(g.a)(h.split(" "),function(e){/at-(.+)/.test(e)&&u.doAttrib(d,e)}),h&&-1<h.indexOf(be.i)&&(n=Object(oe.$)(l).attr(be.j),u.doAttrib(d,be.h,n),r=d.attribs,i=d.attribString,o=t.cc.apool,a=["author","lineguid",be.h],s=Object.keys(r).reduce(function(e,t){if(a.includes(t)||t.includes("comment"))return e;var n=[t,r[t]].join(","),i=o.attribToNum[n].toString(36);return e.replace(/\*[\da-z]+/g,function(e){return e==="*".concat(i)?"":e})},i),u.lines.appendText(" ",s))},this.afterPasteInsert=function(e,t){var n=t.pasteDataWrapper,i=Object(oe.$)(n).find(".".concat(be.i));i.length&&Object(g.a)(i,function(e){var t=Object(oe.$)(e).attr(be.j);C.replaceClientsideChatCard(JSON.parse(t))})},this.acePaste=function(e,t){var n,i=t.e,r=t.pasteDataWrapper,o=Object(oe.$)(r),a=o.find(".mention");a.length&&(Object(g.a)(a,function(e){var t=Object(me.h)();e.className=e.className.replace(/mention-tempId_\S*/,"").replace(/mention-uuid_\w+/,"mention-uuid_".concat(t))}),n=C.editor.getRep().lines.indexOfKey(i.target.closest(".ace-line").id),C.lastPasteLineNum=n,i.stopImmediatePropagation(),i.preventDefault());var s=o.find(".".concat(be.i));s.length&&Object(g.a)(s,function(e){var t=Object(oe.$)(e).attr(be.j);try{var n=Object(H.generateBlockDataSet)(JSON.parse(t));Object(oe.$)(e).attr(be.j,JSON.stringify(n))}catch(e){throw new Error("[Chatcard]: clientside-props parse error.")}})},this.deleteMentionIfNecessary=ve.a,this.moveCursorIfNecessary=ve.b,this.pushTaskQueue=function(e){C.taskQueue.push(e)},this._getExtendedAttribs=function(){var e=C.editor,t=e.getRep().zoneId,n=Object(re.default)(e.getAttributesOnSelection(t),"attribs")||[];return n=Object(u.a)(n,function(e){var t=e[0];return-1<["backcolor","bold","italic","underline","inline-code","strikethrough",D.b].indexOf(t)||Object(me.M)(t)})},this._preventXss=function(e){var t=e.trim();return C.isValidScheme(t,T.allowProtocolSchemes)?Object(_.escapeHTML)(t):""},this.isValidScheme=function(e,t){return!(!e||!t)&&new RegExp("^(".concat(t.join("|"),"):")).test(e)},this.isMentionBoxVisible=function(){return C.mentionBox&&C.mentionBox.isVisiable()},this.destory=function(){C.mentionShare&&C.mentionShare.destroy(),C.mentionShare=null,C.embedMentionManager.destroy(),C.taskQueue=[],C.debounceNotifyMentionListChange.cancel(),C.editor&&(C.editor.off("asyncNotifyCallback",C.pushTaskQueue),C.editor.off("colHorzResize",C.handleTableResize),C.editor.off(Ee.k.DID_PASTE,C.handleDidPaste),C.editor.off(Ee.k.PAINT,C.notifyMentionListChange))};var t=e.editor;this.props=e,this.editor=t,this.ownerId=Object(B.d)(),this.taskQueue=[],this.lastPasteLineNum=null,this.isHoverPopup=!1,this.hidePopupTimeoutId=0,t&&(t.on("asyncNotifyCallback",this.pushTaskQueue),t.on("colHorzResize",this.handleTableResize),t.on(Ee.k.DID_PASTE,this.handleDidPaste)),this.mentionShare=new U.a;var n=this.props.embedObjShareEnable?P.a:null;this.embedMentionManager=new b.a(n)}function e(e,t,n){return r.apply(this,arguments)}var r,o;function t(e,t,n){return o.apply(this,arguments)}return c()(i,[{key:"updateKeywords",value:function(e,t){e||"compositionend"!==t.type||D.c.show(this.editor,this.placeholderText),this.keywords=e,this.mentionBox&&this.mentionBox.mounted&&this.mentionBox.setState({keywords:e,type:"search"})}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId,r=n;if(t instanceof HTMLElement){var o,a,s=t.className,c=t.tagName,l=c;if("A"===c){for(;t&&"SPAN"!==l&&"BODY"!==l;)t=t.parentNode,l=Object(re.default)(t,"tagName")||"";var u=t.className||"";-1<u.indexOf("mention")&&Object(g.a)(u.split(" "),function(e){var t;/mention/.test(e)&&"mention"!==e&&(r=0===e.indexOf("mention-icon")?(t=e.substring("mention-icon_".length),Object(Ee.H)(r,i,{"mention-icon":t})):Object(Ee.H)(r,i,O()({},e,"true")))})}"SPAN"===l&&-1<s.indexOf("at-holder")&&Object(g.a)(s.split(" "),function(e){/at-(.+)/.test(e)&&(r=Object(Ee.H)(r,i,O()({},e,"true")))}),-1<s.indexOf(be.i)&&(o=Object(oe.$)(t).attr(be.j),a=new Ee.e,r.forEach(function(e,t){var n;a=t===i&&e instanceof Ee.E?(n=new Ee.E({zoneId:i}).insert(" ",O()({},be.h,o)),a.concat(n)):a.concat(e)}),r=a)}return r}},{key:"serialize",value:function(e){var t=e.type,n=e.node,i=e.op;if(!i)return e;var r,o,a,s=Object(me.r)(i.attributes);return t===Ee.u.LEAF&&s["mention-link"]&&(r=decodeURIComponent(s["mention-link"]),(o=document.createElement("span")).classList.add("mention"),Object.keys(i.attributes).forEach(function(e){return e.includes("mention")&&o.classList.add(e)}),(a=document.createElement("a")).setAttribute("rel","noopener noreferrer"),a.setAttribute("href",r),a.dataset.href=r,a.href=r,a.appendChild(n),o.appendChild(a),e.node=o),e}},{key:"showMentionBox",value:(o=w()(ie.a.mark(function e(a,s,c){var t,l,u,d,n,h,f,p,g,i,m,r,v,o,b,y,E,O,C,k,I,S,T=this,_=arguments;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=3<_.length&&void 0!==_[3]?_[3]:"@",l=a.rep,u=a.editor,d=s.uuid,this.uuid=d,n=this.props,h=n.type,f=n.boxWidth,p=n.container,g=n.source,i=n.notify,m=void 0===i||i,r=n.mentionBoxParams,v=void 0===r?{}:r,o=n.openDocParams,b=void 0===o?{}:o,y="reminder"===a,E=c.command===be.q.JIRA_ISSUE_BLOCK,D.c.setEnable((Ie||E)&&"doc"===h),c.command?(O=c.command===be.F[be.b.USER]?"@":me.c,this.createBlankDom(a,d,O,l.selStart,!0),s.command=c.command):(this.keywords=t.substr(1),C="".concat(ye.a).concat(d),k=this._getExtendedAttribs(u),I=[["at-holder",!0],[C,!0],[D.b,!0]].concat(ne()(k)),Object(ve.e)(u,[l.selStart[0],l.selStart[1]-t.length],l.selEnd,t,I)),S=function(){var e=w()(ie.a.mark(function e(){var t,n,i,r,o;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(oe.$)(p),n=Object(oe.$)(".".concat(ye.a).concat(d)),i=Object(R.a)(n.get(0),u),r=Object(me.v)(n,Object.assign({boxWidth:f,$boxContainer:t,zoom:i,bottomGap:16},Object(M.a)(v))),o=Object(me.F)(r),L.a.modernIE&&(o.height=me.d.boxMinHeight+"px"),T.mentionBox&&T.mentionBox.close(),e.next=9,Object(j.a)(Object.assign({style:o,boxType:h,notify:m,openDocParams:b,token:window.bestPracticeToken||Object(me.u)(),objType:Object(N.l)(),boxContainer:t.get(0),source:g},s,{rep:l,container:p,boxWidth:f,onConfirm:function(e){return T.handleConfirm(e,a,s)},editor:u,onAsideClick:function(){u.updateBrowserSelectionFromRep(!0),u.inCallStackIfNecessary("editorRefocus",function(){u.fastIncorp()})},onClose:function(e){s.command&&T.deleteBlankChar(u,d,e),T.mentionBox=null}}));case 9:T.mentionBox=e.sent,T.placeholderState=D.c.show(u,T.placeholderText),Object(ae.default)("open_mention",{action:Object(re.default)(c,"data.type"),source:y?"checkbox":h,eventType:Object(re.default)(c,"e.type")||"keydown",targetId:"",targetClass:"",zone:Object(se.l)(l)});case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),a.editor.version.includes(Ee.y)?a.editor.once("paint",S):S();case 11:case"end":return e.stop()}},e,this)})),t)},{key:"deleteBlankChar",value:function(e,t,n){var i,r,o,a,s,c,l,u,d;n||(i="".concat(ye.a).concat(t),r=this._getExtendedAttribs(e),e.inCallStackIfNecessary("collectMentionText",function(){e.fastIncorp()}),o="".concat(ye.a).concat(t),(a=Object(pe.a)(e,o))&&(s=this.getTextOnSelection(e,a),c=a.selStart,l=a.selEnd,u=a.selZone,d=[{start:c,end:l,newText:Object(me.f)(s),attributes:[["at-holder",!0],[i,!0]].concat(r)}],e.callWithAce(function(e){e.fastIncorp(),e.dom?e.performDocumentReplaceMultiRangeWithAttributes(u,d):e.performDocumentReplaceMultiRangeWithAttributes(d),e.version.includes(Ee.y)||e.updateBrowserSelectionFromRep(!0)},"filterChar",!0)))}},{key:"getTextOnSelection",value:function(e,t){if(!e)return"";var n=t.selStart,i=t.selEnd,r=t.selZone,o=e.getRep(r).lines.atIndex(n[0]).lineMarker,a=e.getRep(r).lines.atIndex(i[0]).lineMarker,s=Object.assign({},t,{selStart:[n[0],n[1]-o],selEnd:[i[0],i[1]-a]}),c=e.getTextAndAttrsOnSelection(s),l=c.length-1,u="";return c.forEach(function(e,t){var n=e.text,i=t===l&&/\n/.test(n);n&&!i&&(u+=n)}),u}},{key:"createBlankDom",value:function(e,t,n,i,r){var o=e.rep,a=e.editor,s="".concat(ye.a).concat(t),c=this._getExtendedAttribs(a);a.inCallStackIfNecessary("createBlankDom",function(){a.fastIncorp(),Object(ve.e)(a,i,o.selEnd,n,[["at-holder",!0],[s,!0],[D.b,!0]].concat(c),r)},!0)}},{key:"handleConfirm",value:(r=w()(ie.a.mark(function e(t,n,i){var r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k,I,S,T,_,w,j,M,L,R,N,D,x,P,B,U,z,H,F,V,W,K,Z,q,Y,J,Q,X,$,ee,te=this;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.editor,o=n.rep,a=i.uuid,s=i.isAPanelPoll,c=t.data,l=t.fromNotification,u=t.isClick,d=t.mentionUuid,h=t.logParams,f=c.type,p=c.token,g=c.url,m=c.shouldNotifyLark,v=c.content,b=c.icon_key,y=c.icon_type,E=c.icon_fsunit,O=this.props.type,C="reminder"===n,k="".concat(ye.a).concat(a),I=Object(pe.b)(r,k),r.version.includes(Ee.y)||r.updateBrowserSelectionFromRep(!0),Object(ce.default)(c))return e.abrupt("return");e.next=13;break;case 13:if(!I){e.next=98;break}S=Object(re.default)(t,"data.type"),T="",e.t0=S,e.next=e.t0===be.E.FILE?19:e.t0===be.E.SHEET?21:e.t0===be.E.BITABLE?23:e.t0===be.E.MINDNOTE?25:e.t0===be.E.BOX?27:e.t0===be.E.SLIDE?29:e.t0===be.E.BLOCK?31:e.t0===be.E.JIRA_FILTER?33:35;break;case 19:return T="doc",e.abrupt("break",35);case 21:return T="sheet",e.abrupt("break",35);case 23:return T="bitable",e.abrupt("break",35);case 25:return T="mindnote",e.abrupt("break",35);case 27:return T="file",e.abrupt("break",35);case 29:return T="slide",e.abrupt("break",35);case 31:return T=Object(re.default)(t,"data.pollType"),e.abrupt("break",35);case 33:return T="jira_filter",e.abrupt("break",35);case 35:_=Object(re.default)(t,"data.source"),w=Ie&&this.placeholderState?this.placeholderState:{},Object(he.a)("confirm_mention").report(Object.assign({source:C?"checkbox":O,event_type:u||S===be.E.BLOCK?"mouseclick":"keydown",mention_type:Object(se.j)(S),mention_sub_type:T,panel_source:i.command||i.isAPanelPoll?"a_panel":"mention_panel",mention_obj_id:Object(ue.a)(p),mention_notification_status:m&&m.toString(),zone:Object(se.l)(o),uuid:d,recommend_source:Object(me.s)(_),line_is_empty:Object(me.P)(r)},h,{},w)),de.c[f]&&de.b.markAsDone(de.c[f]),l&&Object(ae.default)("click_confirm_mention_btn",{source:O,confirm_mention_btn_type:l,mention_type:Object(se.k)(S),mention_obj_id:Object(ue.a)(p),mention_notification_status:m&&m.toString()}),r.inCallStackIfNecessary("mentionFastIncrop",function(){r.fastIncorp(!0)}),f===be.E.USER&&Object(ae.default)("debug_mention_at_user",{stage:"after:fastIncorp"}),j=Object(oe.$)(".".concat(ye.a).concat(a)),M=I?r.domToRep(j.get(0)):{},L=v,R=" ",N=[["at-holder",0],[k,0],["mention-type_".concat(f),!0],["mention-link_".concat(encodeURIComponent(g)),!0]],D=this._getExtendedAttribs(r),x=r.plugins.blockPlugin,e.t1=f,e.next=e.t1===be.E.USER?52:e.t1===be.E.CHAT?56:e.t1===be.E.GROUP?61:e.t1===be.E.JIRA_FILTER?67:e.t1===be.E.BLOCK?72:e.t1===be.E.INLINE_BLOCK?75:78;break;case 52:return R=" ",N=x.getAttrsFromBlockDataSet(t.data.dataSet),N=[].concat(ne()(D),ne()(N)),e.abrupt("break",84);case 56:return P=M.selStart,(B=M.selEnd)&&x.insertBlock(t.data.dataSet,{selStart:P,selEnd:B,zoneId:P[2]}),this.mentionBox&&this.mentionBox.close(!0),this.mentionBox=null,e.abrupt("return");case 61:return N.push(["mention-tempId_".concat(a),!0]),N.push(["mention-token_".concat(p),!0]),"doc"!==O&&N.push(["mention-notify_".concat(m),!0]),R="@".concat(L),N=N.concat(D),e.abrupt("break",84);case 67:return U=o.selStart[0],z=o.lines.atIndex(U),H=z.width,F=z.lineMarker,R=2<H-F?Object(le.a)(o,null,M):" ",N=x.getAttrsFromBlockDataSet(t.data.dataSet),e.abrupt("break",84);case 72:return R=Object(le.a)(o,null,M),N=x.getAttrsFromBlockDataSet(t.data.dataSet),e.abrupt("break",84);case 75:return R=" ",N=x.getAttrsFromBlockDataSet(t.data.dataSet),e.abrupt("break",84);case 78:return N.push(["mention-uuid_".concat(a),!0]),N.push(["mention-token_".concat(p),!0]),b&&N.push(["mention-icon",JSON.stringify({type:y,key:b,fs_unit:E})]),R=L,N=N.concat(D),e.abrupt("break",84);case 84:if(V=Object(pe.a)(r,k)){e.next=87;break}return e.abrupt("return");case 87:W=V.selStart,K=V.selEnd,Z=r.getRep().lines.atIndex(K[0]).text.length,K[1]>Z&&(K[1]=r.getRep().lines.atIndex(K[0]).text.length),N.some(function(e){return"lineguid"===e[0]})||(q=o.attributeManager.findAttributeOnLine(W[0],"lineguid"),N.push(["lineguid",q||Object(ke.b)()])),fe.a.emit("invokeCollapse",{zoneId:o.zoneId,range:{selStart:W,selEnd:K}}),Object(ve.d)(r,W,K,R,N,s),f!==be.E.FILE&&f!==be.E.SHEET&&f!==be.E.BITABLE&&f!==be.E.MINDNOTE&&f!==be.E.SLIDE||(Y=be.v[f],J={uuid:a,container:this.props.container,editor:r,token:p,suiteType:Y,title:R},Q=this.props.embedObjShareEnable,X=function(){Q&&te.mentionShare&&te.mentionShare.showPopover(J)},r.version.includes(Ee.y)?r.once("paint",X):X()),f===be.E.CHAT||f===be.E.BLOCK?($=o.selStart[0]+1,"\n"!==R.slice(-1)&&$<o.lines.length()&&r.inCallStackIfNecessary("insertChatPerformRepChange",function(){r.dom?r.performSelectionChange(o.zoneId,[$,0],[$,0]):r.performSelectionChange([$,0],[$,0])})):f!==be.E.INLINE_BLOCK&&f!==be.E.USER||(r.inCallStackIfNecessary("insertInlineBlockPerformRepChange",function(){r.performSelectionChange(o.zoneId,o.selStart,o.selEnd)}),f===be.E.USER&&(ee=[W[0],W[1]+R.length],Object(ve.f)(r,ee,ee,D),f===be.E.USER&&Object(ae.default)("debug_mention_at_user",{stage:"after:performSpace"}))),f!==be.E.FILE&&f!==be.E.SHEET&&f!==be.E.BITABLE&&f!==be.E.MINDNOTE&&f!==be.E.SLIDE&&f!==be.E.BOX||"full_comment"===O||"part_comment"===O||!Object(Ce.a)()||Object(Oe.b)(ge.onboarding.STEP_TYPES.doc_relation_graph_guide);case 98:i.isAPanelPoll||(this.mentionBox&&this.mentionBox.close(!0),this.mentionBox=null);case 99:case"end":return e.stop()}},e,this)})),e)},{key:"placeholderText",get:function(){return this.mentionBox&&this.mentionBox.state.activeMentionType===be.q.JIRA_ISSUE_BLOCK?Object(C.h)()===F.a.HAS_CONNECTED?p("explorer.search"):"":p("doc.mention.placeholder")}}]),i}())||e;Z.a=K}).call(this,q("2vAP"))},Brof:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return y});var a,i,r=n("o0o1"),s=n.n(r),o=n("yXPU"),c=n.n(o),l=n("lwsE"),u=n.n(l),d=n("W8MJ"),h=n.n(d),f=n("2ACu"),p=n("AESI"),g=n("toa8"),m=n("1dfU");function v(e){var t=setTimeout(function(){clearTimeout(t),e()},0)}function b(e,t){console["exception"!==e&&"faild"!==e?"log":"error"]("save_external_img_".concat(e),t),Object(f.default)("save_external_img_".concat(e),t)}(i=a=a||{})[i.LOST=-4]="LOST",i[i.LIMIT=-3]="LIMIT",i[i.TIMEOUT=-2]="TIMEOUT",i[i.CANCEL=-1]="CANCEL",i[i.DOING=0]="DOING",i[i.DONE=1]="DONE",i[i.FAILED=2]="FAILED",i[i.EXCEPT=3]="EXCEPT";var y=function(){function o(){u()(this,o),this.taskPool={},this.checkHandle=null}return h()(o,[{key:"_handleCheck",value:function(e,t,n){var i=this.taskPool[e];t===a.DOING&&i.count--,i.count||(t=a.TIMEOUT),t!==a.DOING&&(delete this.taskPool[e],v(function(){return i.callback(t,n)}),b("finish",{imgCode:e,stat:t,imgToken:n,count:i.count}))}},{key:"check",value:function(){var i=this,r=Object.keys(this.taskPool).slice(0,o.TASK_LIMIT+1);return Object(g.d)({url:p.BOX_IMAGE_CHECK,method:"post",headers:{"Content-Type":"application/json"},data:{code_list:r}}).then(function(e){var t=e.data;if(!Array.isArray(t))return Promise.reject(new Error("response.data is not a Array"));var n=t.reduce(function(e,t){return e[t.image_code]=t,e},{});return r.forEach(function(e){var t=n[e]||{image_status:a.LOST};i._handleCheck(e,t.image_status,t.token)}),Promise.resolve()}).catch(function(e){b("exception",e),r.forEach(function(e){return i._handleCheck(e,a.DOING)})})}},{key:"polling",value:function(){var t=this;!this.checkHandle&&Object.keys(this.taskPool).length&&(this.checkHandle=setTimeout(c()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(t.checkHandle),e.next=3,t.check();case 3:t.checkHandle=null,t.polling();case 5:case"end":return e.stop()}},e)})),o.CHECK_TIME))}},{key:"limit",value:function(e,t){Object.keys(this.taskPool).length<=o.TASK_LIMIT||(b("faild",{src:e,err:new Error("external image save limmit")}),v(function(){return t(a.LIMIT)}))}},{key:"newTask",value:function(e,n,i){var r=this;b("start",{src:Object(m.a)(n)}),this.limit(n,i),Object(g.d)({url:p.BOX_IMAGE_CREATE,method:"post",headers:{"Content-Type":"application/json"},data:{url:n,mount_node_token:e,mount_point:"doc_image"}}).then(function(e){var t=e.data.image_code;r.taskPool[t]={imgCode:t,count:o.CHECK_COUNT,callback:i},b("created",{src:n,imgCode:t}),r.polling()}).catch(function(e){b("faild",{src:n,err:e}),v(function(){return i(a.CANCEL)})})}},{key:"destroy",value:function(){var n=this;clearTimeout(this.checkHandle),this.checkHandle=null,Object.keys(this.taskPool).forEach(function(e){var t=n.taskPool[e];console.warn("save_external_img_destroy",{imgCode:t.imgCode}),v(function(){return t.callback(a.CANCEL)})}),this.taskPool={}}}]),o}();y.CHECK_TIME=1e3,y.CHECK_COUNT=120,y.TASK_LIMIT=9},BzeS:function(e,t,n){},CA4f:function(e,t,n){},CAVi:function(e,t,n){},CHKa:function(e,t,n){"use strict";var i=n("J4zp"),E=n.n(i),r=n("o0o1"),U=n.n(r),o=n("yXPU"),a=n.n(o),s=n("lwsE"),c=n.n(s),l=n("W8MJ"),u=n.n(l),z=n("XIp8"),d=n("TNkj"),h=n("OZf9"),f=n("7EGn"),p=n("+exY"),g=n("D7h9"),m=n("vE74"),H=n("2ACu"),v=n("1dfU"),b=n("wd/R"),y=n.n(b),O=n("toa8"),C=n("AESI"),F=n("SebV"),k=n("jp/M"),I=n("OX8E"),V=n("dQBc"),W=n("lQZd"),S=document.getElementById("J_suite_loading_dom");function T(){S&&(S.style.display="none")}function _(){T();var e=Object(W.g)(),t=V.i[e+"-docs_result_code"];console.info("token data".concat(JSON.stringify(V.i))),console.info("fileopen hideloading"),window.lark&&window.lark.biz.util.hideLoading(),t||I.a.trigger(k.events.MOBILE.DOCS.Statistics.renderEnd)}var w="USER_CHANGES",j=n("QYVc"),M=n("1vGr"),L=n("IyQe"),R=n("5cZX"),K=n("TRtO"),N=n("gfe6"),D=n("TYER"),Z=n("FJEn");n.d(t,"a",function(){return B});var x=M.d,P=M.c,q=M.b,Y=M.a,J=15e3,Q=10,X="zone_changesets",B=function(){function t(e){var B=this;c()(this,t),this.isDestroyed=!1,this.storageError=null,this.onPaint=function(){var e=B.editor.getDocId();!B.isDestroyed&&e&&e===Object(W.g)()&&_()},this.setDataAndHandleError=function(e){return Object(p.b)(e).catch(function(e){Object(H.collectSuiteEvent)("dev_offline_setData_fail",{error:e}),B.storageError=e})},this.onMount=function(){window.dispatchEvent(Object(m.b)("hideGlobalLoading")),B.restore()},this.currentDate=function(){return y()().format("YYYY-MM-DD")},this.isDateOldThanTodayDeltaDay=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:20;try{return new Date(B.currentDate()).getTime()-new Date(e).getTime()>864e5*t}catch(e){console.log("compare date error",e)}return!1},this.restore=function(){var i=B.editor;i.setContentEditableLock(!0),Object(p.c)({forbidden:Object(j.a)()});var r=Object(W.g)();console.info("restore local data"),Object(H.collectSuiteEvent)("dev_offline_restore"),Object(p.a)({key:V.b}).then(function(t){var e,n=[];for(e in Object(H.collectSuiteEvent)("dev_offline_restore_then"),t.data)1===t.data[e]&&n.push(B.restoreSubmittedAndUserChangeData(r,e,t.data));n.push(B.restoreSubmittedAndUserChangeData(r)),Promise.all(n).catch(function(e){Object(H.collectSuiteEvent)("dev_offline_restore_promise_all_error",{err:e}),console.warn("offline promise all error: ",e)}).finally(function(){var e=t.data||{};return e["".concat(i.getEditorUniqueId(),"_").concat(B.currentDate())]=1,Object(H.collectSuiteEvent)("dev_offline_restore_save_uniqid"),B.setDataAndHandleError({key:V.b,data:e})})}).catch(function(e){Object(H.collectSuiteEvent)("dev_offline_get_changes_map_error",{err:e}),console.warn("offline get changes map error: ",e),B.storageError=e}).finally(function(){B.isDestroyed||B.editor.getDocId()===Object(W.g)()&&B.editor.setContentEditableLock(!1)})},this.restoreSubmittedAndUserChangeData=function(D,x,P){return new Promise(function(j,M){var L=B.editor.changesetHelper,R=x?"".concat(V.d,"_").concat(x):V.d,N=x?"".concat(V.l,"_").concat(x):V.l;if(N===B.editor.plugins.client.getUserChangesKey()||R===B.editor.plugins.client.getCommittedChangesKey())return j({code:0,uniqId:x});Promise.all([Object(p.a)({key:R}),Object(p.a)({key:N})]).then(function(){var t=a()(U.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k,I,S,T,_,w;return U.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.info("restore local data response"),B.isDestroyed||D!==Object(W.g)())return e.abrupt("return",M("restore error token"));e.next=3;break;case 3:if(t[0].code||t[1].code){e.next=107;break}if(t[0].data||t[1].data){e.next=7;break}return x&&B.isDateOldThanTodayDeltaDay(B.getDateString(x))&&delete P[x],e.abrupt("return",j({code:0,uniqId:x}));case 7:if(n=Object(z.default)(t[0].data)||{},i=Object(z.default)(t[1].data)||{},!0===n.isBroken||!0===i.isBroken)return console.warn("some local data is broken"),e.abrupt("return",j({code:0,uniqId:x}));e.next=12;break;case 12:if(r=function(e){Object(H.collectSuiteEvent)("sendSumittedChangeset_failed_set_all_data_broken",{error:e}),n.isBroken=!0,i.isBroken=!0,B.setDataAndHandleError({key:R,data:n}),B.setDataAndHandleError({key:N,data:i})},$(t[0]),$(t[1]),o=t[0].data||{},a=t[1].data||{},s=o.baseRev,c=o.uuid_v4,l=o.changeset,u=a.changeset,o[X]&&(l=L.toString(o[X]),u=L.toString(a[X])),e.prev=21,l){e.next=29;break}return B.setDataAndHandleError({key:R,data:null,token:D,needSync:!1}),i.isBroken=!0,B.setDataAndHandleError({key:N,data:i}),window.lark&&window.lark.biz.util.syncComplete({objToken:D}),Object(H.collectSuiteEvent)("dev_offline_data_lost_X_but_saved_Y"),e.abrupt("return",j({code:0,uniqId:x}));case 29:if(d=L.unpack(l),h=d[0].newLen,p=0,a&&u&&(f=L.unpack(u),p=f[0].newLen),p<=0&&(B.setDataAndHandleError({key:N,data:null}),u=""),h<=0)return B.setDataAndHandleError({key:R,data:null}),e.abrupt("return",j({code:0,uniqId:x}));e.next=37;break;case 37:return u&&(a.apool=new Z.AttributePool(B.editor).fromJsonable(a.apool)),o.apool=new Z.AttributePool(B.editor).fromJsonable(o.apool),g=a.baseRev,m=(new Date).getTime(),e.prev=41,e.next=44,B.fetchChangesetAcceptedStatus(D,c,s);case 44:v=e.sent,e.next=51;break;case 47:return e.prev=47,e.t0=e.catch(41),console.error("doc try commit api return error"),e.abrupt("return",M(new Error("doc try commit api return error")));case 51:if(b=(new Date).getTime(),y=b-m,Object(H.collectSuiteEvent)("dev_fetch_try_commit",{use_time:y}),!0!==(E=v.data).has_commit){e.next=88;break}if(s===g&&u){e.next=62;break}return B.setDataAndHandleError({key:R,data:null}),B.setDataAndHandleError({key:N,data:null}),console.log("delete has commited X and old Y, send nothing"),Object(H.collectSuiteEvent)("dev_offline_data_lost_Y"),e.abrupt("return",j({code:0,uniqId:x}));case 62:if((O=E.change_sets)&&O.length<=1e3&&!E.over_size)return e.prev=64,C=(new Date).getTime(),k=B.batchFollowOfflineChanges(O,o,a),(I=B.sendSumittedChangeset(k,V.k))&&I.then&&I.then(function(){B.setDataAndHandleError({key:R,data:null}),B.setDataAndHandleError({key:N,data:null}),console.log("delete has commited X , send only Y")}).catch(function(e){r(e)}),S=(new Date).getTime(),T=S-C,Object(H.collectSuiteEvent)("dev_offline_batch_follow_offline_changes",{use_time:T,changeset_length:O.length}),e.abrupt("return",j({code:0,uniqId:x}));e.next=85;break;case 76:return e.prev=76,e.t1=e.catch(64),console.error(e.t1),Object(F.a)("follow restore local data error:"+JSON.stringify(e.t1)),Object(H.collectSuiteEvent)("dev_offline_follow_error",{reason:e.t1}),r(e.t1),e.abrupt("return",M(e.t1));case 83:e.next=88;break;case 85:console.warn("offline debug: fetch try commit over size, X will be repeat"),Object(H.collectSuiteEvent)("dev_offline_fetch_try_commit_over_size"),Object(F.a)("offline debug: fetch try commit over size");case 88:if(s===g&&B.editor.changesetHelper.composable(d,f))return(_=B.sendComposedChangeset(o,a))&&_.then&&_.then(function(){B.setDataAndHandleError({key:R,data:null}),B.setDataAndHandleError({key:N,data:null}),console.log("delete compose data")}).catch(function(e){r(e)}),e.abrupt("return",j({code:0,uniqId:x}));e.next=95;break;case 95:u&&(Object(H.collectSuiteEvent)("dev_offline_danger_offline_user_changes_saved_locally"),i.isBroken=!0,B.setDataAndHandleError({key:N,data:i}));case 96:return(w=B.sendSumittedChangeset(o,V.k))&&w.then&&w.then(function(){B.setDataAndHandleError({key:R,data:null}),B.setDataAndHandleError({key:N,data:null}),console.log("delete submitted data")}).catch(function(e){r(e)}),e.abrupt("return",j({code:0,uniqId:x}));case 101:e.prev=101,e.t2=e.catch(21),K.a.error("restore local data error :"+JSON.stringify(e.t2)),M(e.t2),console.error(e.t2),Object(H.collectSuiteEvent)("dev_offline_restore_local_data_error",{reason:e.t2});case 107:case"end":return e.stop()}},e,null,[[21,101],[41,47],[64,76]])}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){Object(H.collectSuiteEvent)("dev_offline_restore_submitted_err",{token:Object(v.a)(D)}),M(e)})})},this.moveOpsToNewPool=function(e,t){var n=e.apool,i=e.zone_changesets,r=B.editor.changesetHelper,o=new Z.AttributePool(B.editor).fromJsonable(n),a="";n&&(o=new Z.AttributePool(B.editor).fromJsonable(n),a=r.moveOpsToNewPool(r.toString(i),o,t));var s=a?r.toObject(a):i;return Object.assign({},e,{changeset:s[0],zone_changesets:s,apool:t})},this.unzipAttribs=function(e){var t=/.*?(\|)[a-z0-9]+\+[a-z0-9]+/g,n=e.match(t),r=[];return Object(h.a)(n,function(e){var t,n=/.*?(\|)([a-z0-9]+)\+[a-z0-9]+/g.exec(e)||"1",i=parseInt(n[2],36);1===i?r.push(e):(t=e.replace(/\|([a-z0-9]+)\+([a-z0-9]+)/,"|1+1"),r.push(t),r=r.concat(Object(d.a)(new Array(i-1),"*0|1+1")))}),r},this.inverse=function(e,t,n){var i,r=t.initialAttributedTexts,o=t.apool,p=r.attribs,g=r.text,m=r.rows,v=r.cols,a=o.numToAttrib,s=B.editor.changesetHelper,c="aceTable",l=[];for(i in a)a[i][0]===c&&l.push(a[i][1]);var b={},y={};l.forEach(function(e){var t=e.split(" "),n=E()(t,2),i=n[0],r=n[1],o=p[i];b[i]={alines:[o],forRow:!0,vectorIds:v[r]};var a=p[r];b[r]={alines:[a],forRow:!1,vectorIds:m[i]};for(var s=v[r],c=m[i],l=0,u=s.length;l<u;l++)for(var d=function(e,t){var n="x".concat(c[e],"x").concat(s[l]),i=g[n]||"\n",r=i.split("\n");y[n]={alines:p[n]&&B.unzipAttribs(p[n])||["*0|1+1"],alltext:i,lines:{get:function(e){return r[e]+"\n"},length:function(){return r.length-1}}}},h=0,f=c.length;h<f;h++)d(h,f)});var u=(g[0]||"\n").split("\n");return y[0]={alines:[],lines:{get:function(e){return u[e]+"\n"},length:function(){return u.length-1}},zoneId:0},s.inverseOnRep(e,y,b,n)},this.haveWritePermission=function(){var e=g.default.getState(),t=Object(R.j)(e),n=t&&t.toJS()||[],i=0<n.length?n:Object(f.default)(B.editor.getClientVars(),"permissions");return(Object(L.getUserPermissions)(i)||{}).editable},this.sendComposedChangeset=function(e,t){if(Object(H.collectSuiteEvent)("dev_offline_send_compose_cs"),!B.haveWritePermission())return K.a.info("offline send submit no permission");var n=B.editor.changesetHelper,i=e.zone_changesets,r=e.apool,o=e.baseRev,a=t.uuid_v4,s=new Z.AttributePool(B.editor).fromJsonable(r),c=B.moveOpsToNewPool(t,s).zone_changesets,l=n.toString(i),u=n.compose(l,n.toString(c),s),d=n.toObject(u);return B.sendSumittedChangeset({changeset:d[0]||"",zone_changesets:d,baseRev:o,apool:s,member_id:V.k,uuid_v4:a},V.k)},this.retryPromise=function(e,o){var a=[x,P,q,Y];return new Promise(function(i,r){(function t(n){if(0===n)return console.log("[collab debug]: retryPromise failed 3 times"),r("retryPromise failed 3 times");console.log("[collab debug]: retryPromise",n),e().then(function(e){return e&&e.data&&0===e.data.code&&(e.data.type===D.h.ACCEPT_COMMIT||e.data.type===D.h.NEW_CHANGES)?(B.editor.plugins.sync.io.sendHeartbeats(),i(e)):e&&e.data&&a.includes(e.data.code)?void setTimeout(function(){return t(n-1)},1e3*(o+1-n)):r("retryPromise failed wrong code")}).catch(function(e){Object(H.collectSuiteEvent)("[collab debug]: retryPromise error",{reason:e}),setTimeout(function(){return t(n-1)},1e3*(o+1-n))})})(o)})},this.sendSumittedChangeset=function(e,t){if(!B.haveWritePermission())return K.a.info("offline send submit no permission");Object(H.collectSuiteEvent)("dev_offline_send_submitted_cs");var n=B.editor.changesetHelper,i=e.zone_changesets,r=e.baseRev,o=e.apool,a=e.uuid_v4,s=new Z.AttributePool(B.editor),c=n.moveOpsToNewPool(n.toString(i),o,s),l=n.toObject(c);if(e){var u={type:w,baseRev:r,changeset:l[0]||"",zone_changesets:l,apool:s.toJsonable(),member_id:t,uuid_v4:a,retryTimes:0};return B.retryPromise(function(){return B.editor.plugins.client.sendMessageUnHandleErrors(u,!1)},3)}},this.compose=function(e,t,n){var i=B.editor.changesetHelper,r=e.zone_changesets,o=t.zone_changesets;return i._compose(i.toString(r),i.toString(o),n)},this.retryCommitChangeset=function(e){if(null===B.storageError)if(B.retryTimer)B.editor.log("retryCommitChangeset is waitting last timer");else if(e.retryTimes=(e.retryTimes||0)+1,e&&Number(e.onlineRetryTimes)>V.f)B.editor.log("retryCommitChangeset over times");else{"online"===Object(f.default)(B,"editor.plugins.sync.io.state")&&(e.onlineRetryTimes=(e.onlineRetryTimes||0)+1);var t=Math.min(2e3*e.retryTimes,J);if(e.retryTimes>=Q&&!Object(N.c)())return e.retryTimes===Q&&B.editor.call("tooManyRetriesOnOffline",e.retryTimes),void Object(H.collectSuiteEvent)("dev_offline_retry",{retryTimes:e.retryTimes});B.retryTimer=window.setTimeout(function(){B.editor.log("[collab debug]: retry by retryTimer"),B.editor.plugins.client.sendMessage(e,!0),B.retryTimer=null},e.force?0:t)}else B.editor.fatal(B.storageError,"storage","offline setData fail",-1e3)},this.submittedChangesetFollowed=function(e,t){var n=t.changeset,i=t.baseRev,r=t.apool,o=t.uuid_v4,a=B.editor.plugins.client.getCommittedChangesKey();B.setDataAndHandleError({key:a,data:{changeset:n,baseRev:i,apool:r.toJsonable?r.toJsonable():r,uuid_v4:o}})},this.userChangesetFollowed=function(e,t){var n=t.changeset,i=t.baseRev,r=t.apool,o=t.uuid_v4,a=B.editor.plugins.client.getUserChangesKey();B.setDataAndHandleError({key:a,data:{changeset:n,baseRev:i,apool:r.toJsonable?r.toJsonable():r,uuid_v4:o}})},this.batchFollowOfflineChanges=function(e,n,i){return e.forEach(function(e){var t=B.followOfflineChanges(e,n,i);n=t.followedSubmittedChanges,i=t.followedUserChanges}),i.baseRev+=1,i},this.followOfflineChanges=function(e,t,n){var i=new Z.AttributePool(B.editor),r=B.editor.changesetHelper,o=e.zone_changesets,a=e.note_revision,s=e.apool,c=t.zone_changesets,l=t.apool,u=t.uuid_v4,d=n.zone_changesets,h=n.uuid_v4,f=n.apool,p=r.moveOpsToNewPool(r.toString(c),l,i),g=r.moveOpsToNewPool(r.toString(d),f,i),m=r.moveOpsToNewPool(r.toString(o),new Z.AttributePool(B.editor).fromJsonableNoCloning(s),i),v=p,b=r.follow(m,v,!1,i),y=r.follow(v,m,!0,i),E=r.prepareForWire(B.editor,b,i),O=r.toObject(E.translated),C={baseRev:a,changeset:O[0],apool:E.pool,uuid_v4:u,member_id:V.k,zone_changesets:O},k=r.follow(y,g,!0,i),I=r.prepareForWire(B.editor,k,i),S=r.toObject(I.translated);return{followedSubmittedChanges:C,followedUserChanges:{baseRev:a,changeset:S[0],apool:I.pool,uuid_v4:h,member_id:V.k,zone_changesets:S}}},this.destory=function(){B.isDestroyed=!0,B.retryTimer&&clearTimeout(B.retryTimer),B.messageSender&&B.messageSender.cancle&&B.messageSender.cancle(),B.submittedSender&&B.submittedSender.cancle&&B.submittedSender.cancle(),B.offlineCreate&&B.offlineCreate.destory(),B.retryTimer=null,B.messageSender=null,B.submittedSender=null},e&&(this.editor=e,this.editor.plugins.offline=this),this.messageSender=null}return u()(t,[{key:"getDateString",value:function(e){try{return e.split("_")[1]}catch(e){console.log("getDateString error",e)}return""}},{key:"getSubmittedAndUserData",value:function(){return Object(p.a)({key:V.b}).then(function(e){var t,r={},n=function(t){var e=t,n=e?"".concat(V.d,"_").concat(e):V.d,i=e?"".concat(V.l,"_").concat(e):V.l;Promise.all([Object(p.a)({key:n}),Object(p.a)({key:i})]).then(function(e){""===e[0].data&&""===e[1].data||(r[t]={committedCS:e[0],userCs:e[1]})})};for(t in e.data)n(t);return r})}},{key:"fetchChangesetAcceptedStatus",value:function(e,t,n){var i=new FormData;return i.append("token",e),i.append("uuid_v4",t),i.append("base_revision",String(n)),Object(H.collectSuiteEvent)("dev_fetch_try_commit_params",{token:Object(v.a)(e),uuid_v4:t,base_revision:n}),O.d.post(C.DOC_TRY_COMMIT,i,{headers:{"Content-Type":"multipart/form-data"}})}}]),t}();function $(e){e.data&&!e.data[X]&&e.data.changeset&&(e.data[X]={0:e.data.changeset})}},CJfy:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n("lSNA"),I=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),S=n("Nwwt"),T=n("nN3d"),_=n("y2sV"),c=["h1","h2","h3","h4","h5","h6","h7","h8"],l=/Mso(List|Normal)/,u=/mso-list/,d=/h(\d+)/,h=/white-space: pre-wrap;/,f=function(){function e(){o()(this,e),this.className="WordCopySupport",this.collectContentLineText=function(e,t){var n=t.node,i=t.state,r=t.text,o=i.inMsSchemas,a=i.inMsSchemasEnSpan,s=n.parentNode&&n.parentNode.className||"",c=n.parentNode&&n.parentNode.tagName||"",l=!n.textContent.trim();return o&&(l&&("UL"===c||"OL"===c)||l&&s&&"ace-line"===s)?[""]:a?[r.replace(/[|]/g,'"').replace(/[|]/g,"'")]:void 0},this.msReg=l,this.msListReg=u,this.headingReg=d,this.whiteSpaceReg=h}return s()(e,[{key:"getLevel",value:function(e){var t=/level(\d+)/.exec(e);return t?parseInt(t[1]):-1}},{key:"ccRegisterBlockElements",value:function(){return c}},{key:"convertCharToNum",value:function(e){for(var t="a".charCodeAt(),n=e.length,i=0,r=0;r<n-1;++r)i+=(n-1-r)*(e[r].charCodeAt()-t+1)*26;return i+=e[n-1].charCodeAt()-t}},{key:"converRomanToNum",value:function(e){for(var t=e.toUpperCase(),n=0,i=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],r=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],o=0;o<=i.length;o++)for(;0===t.indexOf(r[o]);)n+=i[o],t=t.replace(r[o],"");return n}},{key:"convertToNum",value:function(e,t){var n=t%3,i=e.substring(0,e.length-1);return 0===n?this.converRomanToNum(i):1===n?parseInt(i,10):2===n?this.convertCharToNum(i):-1}},{key:"findListNode",value:function(e){var t=[e],n=0,i=0;if(!e.children)return e;for(;n<=i;){var r=t[n];if(r.style.cssText&&this.whiteSpaceReg.exec(r.style.cssText))return r;t=t.concat(Array.prototype.slice.call(r.children)),n+=1,i+=r.children.length}return e}},{key:"getStart",value:function(e,t){var n=this.findListNode(e);if(-1===t)return-1;var i=((i=n.firstElementChild&&n.firstElementChild.firstElementChild&&n.firstElementChild.firstElementChild.textContent)||"").replace(/(^\s*)|(\s*$)/g,"");return n.removeChild(n.firstElementChild),1<i.length?this.convertToNum(i,t):-1}},{key:"checkMsType",value:function(e,t){return"div"===e&&-1<t.innerHTML.indexOf("OfficeDocument")}},{key:"deserialize",value:function(e){for(var t=e.node,n=e.deltaSet,i=e.zoneId,r=!1,o=!1,a=t||null;a;){if(a instanceof HTMLElement){var s=a.tagName;if(this.checkMsType(s.toLowerCase(),a)){r=!0;break}"SPAN"===s&&"EN-US"===a.lang&&(o=!0)}a=a.parentNode}if(t&&t.nodeType===Node.TEXT_NODE){var c=t.parentNode&&t.parentNode instanceof Element&&t.parentNode.className||"",l=t.parentNode&&t.parentNode instanceof Element&&t.parentNode.tagName||"",u=!(t.textContent||"").trim();if((u&&("UL"===l||"OL"===l)||u&&c&&"ace-line"===c)&&r){var d=new _.e;return n.forEach(function(e,t){d=t===i?d.concat(new _.E({zoneId:i})):d.concat(e)}),d}if(o){var h=new _.e;return n.forEach(function(e,t){var n;h=t===i?(n=e.reduce(function(e,t){var n,i=t.insert;return"string"==typeof i&&(n=i.replace(/[|]/g,'"').replace(/[|]/g,"'"),e.insert(n)),e},new _.E({zoneId:i})),h.concat(n)):h.concat(e)}),h}}if(t instanceof HTMLElement){var f=t.tagName,p=t.getAttribute("style")||"",g=n;if(r){var m,v,b=this.headingReg.exec(f.toLowerCase());b&&(m=Number.parseInt(b[1],10),v="h".concat(m<4?m:3),g=Object(_.I)(g,i,{heading:v}));var y,E=Object(S.a)(t);if(E&&(y="url-".concat(Object(T.c)(10)),g=Object(_.H)(g,i,I()({},y,E))),"P"===f&&this.msListReg.exec(p)){var O="",C=this.getLevel(p),k=this.getStart(t,C);if(-1===C)return g;O=-1!==k?(g=Object(_.I)(g,i,{start:String(k)}),"number".concat(C)):"bullet".concat(C),g=Object(_.I)(g,i,{list:O})}}return g}return n}}]),e}();new f},CO9V:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("OX8E"),a=n("8VaN"),s=function e(){r()(this,e),this.setVisible=function(e){o.a.trigger(a.a,[e])}};t.a=s},CRWC:function(e,t){e.exports='<div class=\'link-modify-popup link-popup_hidden layout-row\'>\n  <div class=\'link-popup__input-group\'>\n    <div class=\'link-row\'>\n      <span class=\'link-modify-text\'></span>\n      <button class=\'link-modify-submit\'>\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path fill-rule="evenodd" clip-rule="evenodd"\n            d="M5.7 16.1556H8.36982L16.3111 8.21413C16.584 7.94127 16.5845 7.49905 16.3124 7.22548L13.9072 4.80759C13.6338 4.53423 13.1906 4.53423 12.9172 4.80759L12.4235 5.30127L12.4255 5.30321L5 12.7858V15.4556C5 15.8422 5.3134 16.1556 5.7 16.1556ZM13.191 6.68287L14.3557 7.85371L13.4407 8.78301L12.282 7.62434L13.191 6.68287ZM12.211 10.1155L10.9942 8.89865L6.83025 13.144L8.00656 14.3221H8.00841L12.211 10.1155ZM18.65 17.4983H5.35C5.1567 17.4983 5 17.6662 5 17.8733V18.6233C5 18.8304 5.1567 18.9983 5.35 18.9983H18.65C18.8433 18.9983 19 18.8304 19 18.6233V17.8733C19 17.6662 18.8433 17.4983 18.65 17.4983Z"\n            fill="#2B2F36" />\n        </svg>\n      </button>\n      <button class=\'link-modify-delete\'>\n        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path fill-rule="evenodd" clip-rule="evenodd"\n            d="M8.37748 6.29106C8.11269 6.07492 7.82608 5.90419 7.52691 5.77786L7.28945 6.07343L9.62187 8.4257C9.48219 7.61492 9.06179 6.84962 8.37748 6.29106ZM8.58786 11.6298L7.59364 10.6271L5.82694 12.8262C5.09775 13.7338 3.77665 13.8738 2.87617 13.1388C1.9757 12.4038 1.83685 11.0722 2.56604 10.1645L3.8239 8.59877C3.61452 8.27921 3.47608 7.90561 3.43362 7.49843L3.37325 6.91948L1.47907 9.27726C0.263754 10.79 0.495176 13.0094 1.99597 14.2344C3.49675 15.4594 5.69859 15.2262 6.91391 13.7134L8.58786 11.6298ZM6.49041 5.26759L8.17247 3.17384C8.90166 2.26618 10.2228 2.12622 11.1232 2.86123C12.0237 3.59623 12.1626 4.92787 11.4334 5.83553L10.1755 7.40125C10.3849 7.72082 10.5233 8.09441 10.5658 8.50159L10.6262 9.08054L12.5203 6.72276C13.7357 5.21 13.5042 2.9906 12.0034 1.76559C10.5027 0.54058 8.30082 0.773849 7.08551 2.28661L5.49619 4.26491L6.49041 5.26759ZM4.34643 7.35226L6.79459 9.82125L6.47251 10.2222C6.17334 10.0958 5.88672 9.9251 5.62193 9.70897C4.87543 9.09964 4.44299 8.24429 4.34643 7.35226Z"\n            fill="#2B2F36" />\n          <rect width="1.61544" height="17.0519" rx="0.633111"\n            transform="matrix(0.703905 -0.710294 0.703905 0.710294 0.430176 2.5976)" fill="#2B2F36" />\n        </svg>\n      </button>\n    </div>\n  </div>\n</div>\n'},CVSs:function(e,t,n){"use strict";n.r(t),n.d(t,"setFailedServices",function(){return r}),n.d(t,"clearFailedServices",function(){return o});var i=n("jp/M"),r=function(e){return{type:i.actionTypes.service.SET_FAILED_SERVICES,payload:e}},o=function(e){return{type:i.actionTypes.service.CLEAR_FAILED_SERVICES,payload:e}}},CXkg:function(e,t,n){"use strict";n.d(t,"a",function(){return Line});var i=n("lSNA"),k=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),c=n("cDf5"),l=n.n(c),I=n("Yspk"),u=n("PyL4"),f=n.n(u),d=n("4PSP"),h=n("y2sV"),p=n("dIhn"),g=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},m="0",S="lineguid",v=function(){function e(){o()(this,e),this.guidMap=new Map}return s()(e,[{key:"getGuidOfLine",value:function(e){if(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e.getOps()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;if(a&&a.attributes&&a.attributes.lineguid)return a.attributes.lineguid}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}return""}},{key:"isDuplicate",value:function(e){var t=this.getGuidOfLine(e),n=this.guidMap.get(t);return n&&1<n.length}},{key:"add",value:function(e){var t=this.getGuidOfLine(e),n=this.guidMap.get(t);n?-1===n.indexOf(e)&&n.push(e):this.guidMap.set(t,[e])}},{key:"remove",value:function(e){var t,n=this.getGuidOfLine(e),i=this.guidMap.get(n);!i||-1<(t=i.indexOf(e))&&i.splice(t,1)}},{key:"destroy",value:function(){this.guidMap=new Map}}]),e}(),Line=function(){function Line(e){var C=this;o()(this,Line),this.guidManager=new v,this.guidManagerInitialized=!1,this.handleContentChange=function(t){var e=C.editor;if(e.isEditable()&&(C.initGuidManagerIfNecessary(),Object.keys(t.changes).forEach(function(e){t.changes[e].forEach(function(e){var t=e.deletes,n=e.inserts;t.forEach(function(e){C.guidManager.remove(e)}),n.forEach(function(e){C.guidManager.add(e)})})}),!(t.options.extra&&t.options.extra.fixLineguid||t.options&&t.options.isRemote))){for(var n=t.deltaSet,i=t.changes,r=new h.e,O=!1,o=function(){var e=s[a],v=n.get(e);if("Z"!==v.zoneType)return"continue";var b=C.editor.getContentState().getZoneState(e);if(b.isEmpty())return"continue";var y=void 0,E=0;i[e].forEach(function(e){var t=e.inserts,n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s,c,l,u,d,h,f,p,g=o.value,m=g.index;b.getLine(m)===g&&(c=(s=g.getOps())[s.length-1],l=C.guidManager.isDuplicate(g),(c.attributes&&!c.attributes.lineguid||!c.attributes||l)&&(y=y||v.create({zoneId:v.zoneId,zoneType:v.zoneType}),d=(u=g.getOffset()).end,h=u.start,f="",f=!l&&C.guidManager.getGuidOfLine(g)||Object(I.b)(),y.retain(d-E-1).retain(1,k()({},S,f)),(p=v.create({zoneId:v.zoneId,zoneType:v.zoneType})).retain(h).retain(g.length()-1,k()({},S,"")),y=y.compose(p),l&&C.guidManager.remove(g),E=d,O=!0))}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}),y&&r.add(y.zoneId,y)},a=0,s=Object.keys(i);a<s.length;a++)o();O&&C.editor.getContentState().apply(r,{normalize:!1,extra:{fixLineguid:!0}})}},this.destroy=function(){Object(p.a)(C.idleCallback),C.guidManager.destroy()},e&&e.editor&&(this.editor=e.editor,this.editor.on("contentchange",this.handleContentChange));var t=this.editor;t&&t.version&&t.version.includes(h.y)&&(this.idleCallback=Object(p.b)(function(){C.initGuidManagerIfNecessary()}))}return s()(Line,[{key:"initGuidManagerIfNecessary",value:function(){var s=this,e=this.editor;e.isEditable()&&!this.guidManagerInitialized&&(e.getContentState().content.forEach(function(e){if("Z"===e.type){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;s.guidManager.add(a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}}),this.guidManagerInitialized=!0)}},{key:"renderLine",value:function(e){var t=e.lineState,n=e.children,i=t.getEntities([[S,void 0]]),r={},o=!0,a=!1,s=void 0;try{for(var c,l=i[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=c.value;r["".concat(S,"-").concat(u.attributes[S])]=!0}}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}var d,h=Object.keys(r);return 0<h.length&&(d=e.lineClass?" ":"",e.lineClass+="".concat(d,"locate ").concat(f.a.escapeHTML(h.join(" ")))),n}},{key:"editorWillPaste",value:function(e){var n=new h.e;e.deltaSet.forEach(function(e){var t;e instanceof h.E?(t=e.reduce(function(e,t){if(!t.insert.includes("\n")||t.attributes&&t.attributes[S])e.ops.push(t);else{var n=t.insert,i="";for(t.attributes&&t.attributes[S]&&delete t.attributes[S];0<n.length;){var r=n.includes("\n"),o=n.split("\n",1)[0],i=n.substring(o.length+1),n=o;e.insert(n,t.attributes),n=i,r&&e.insertEnter(Object.assign({},t.attributes,k()({},S,Object(I.b)())))}}return e},new h.E({zoneId:e.zoneId})),n.add(t.zoneId,t)):n.add(e.zoneId,e)}),e.deltaSet=n}},{key:"editorWillApplyChange",value:function(e){var t=e.deltaSet,n=e.options;return n&&n.isRemote||t.forEach(function(e){"Z"===e.zoneType&&e.forEach(function(e){e.insert===h.f&&(e.attributes&&!e.attributes[S]?e.attributes[S]=Object(I.b)():e.attributes||(e.attributes=k()({},S,Object(I.b)())))})}),e.deltaSet}},{key:"aceEditEvent",value:function(e,t){var n,o,a,s,i=t.callstack,c=t.editorInfo;c.version.includes(h.y)||i.docTextChanged&&i.domClean&&"idleWorkTimer"===i.type&&c.isEditable()&&c.lineTracker.lineGuidLines&&(!(n=c.lineTracker.lineGuidLines.getTracker(m))||(o=n.dirtyRangeStarts).length&&(a=Object(I.a)(c,m),s=c.getReps()[m],o.forEach(function(e,t){var n=[["lineguid",Object(I.b)()]],i=[e,0],r=0===t?[0,0]:[o[t-1]+1,0];c.changesetHelper.buildKeepRange(s,a,r,i),a.keep(s.alinesWidth[e],1,n,s.apool)}),c.performDocumentApplyChangeset(a.toString())))}}]),Line}();g([Object(h.J)(9998)],Line.prototype,"editorWillPaste",null),g([Object(h.J)(1e4),Object(d.Bind)()],Line.prototype,"editorWillApplyChange",null),t.b=new Line(null)},CZAk:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i,r=n("J4zp"),c=n.n(r),o=n("RIqP"),l=n.n(o),a=n("lwsE"),s=n.n(a),u=n("W8MJ"),d=n.n(u),h=(n("gaI2"),n("7EGn")),f=n("Wy5O"),p=n("/spq"),g=n("PI5S"),m=n("H6oK"),C=n("FJEn"),v=n("TgJx"),b=Object(p.a)(["bind","unbind","reset","viewportChange"])(i=function(){function n(e){var O=this,t=e.editor;e.eventEmitter,e.pure;s()(this,n),this.fileIdChanges={},this.isFullscreenPageMode=!1,this.getDriveFileId=function(e){var t=e.lineNode.querySelector(".block-type-FILE_CARD_BLOCK");if(t){var n=t.getAttribute("data-meta-block-props");try{var i=JSON.parse(n);return Object(h.default)(i,"props.data.fileId")}catch(e){return null}}return null},this.linesWillReplace=function(e,t){var n=t.oldLineEntries,i=t.newLineEntries,r=[],o=[];n&&n.forEach(function(e){var t=O.getDriveFileId(e);t&&r.push(t)}),i&&i.forEach(function(e){var t=O.getDriveFileId(e);t&&o.push(t)});var a=Object(f.a)(r,o),s=Object(f.a)(o,r);[].concat(l()(a.map(function(e){return[e,-1]})),l()(s.map(function(e){return[e,1]}))).forEach(function(e){var t=c()(e,2),n=t[0],i=t[1];O.fileIdChanges[n]=O.fileIdChanges[n]||0,O.fileIdChanges[n]+=i})},this.setBlockScreenVisible=function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y=e.instance,E=e.options;null===O.screenData&&(t=O.editor.getScrollTop(),i=(n=O.editor.plugins.viewportObserver).getLineRange(t,1),r=n.getLineRange(t,7),o=n.getVisibleZones(i),O.screenData={lineRange:i,unvisibleLineRange:r,rangeZoneIds:o}),E&&y.setScreenVisible&&(O.isFullscreenPageMode?y.setScreenVisible(!0):(a=E.zoneId,s=E.key,l=(c=O.screenData).lineRange,u=c.unvisibleLineRange,d=c.rangeZoneIds,a===C.DEFAULT_REP_ZONE?(h=O.editor.getRep(a).lines.indexOfKey(s),f=O.editor.blockRender.getLineStatus(a,h),p=l.overViewLineNu,g=l.underViewLineNu,m=u.overViewLineNu,v=u.underViewLineNu,p<=h&&h<=g?(b=f.isActive,y.setScreenVisible(b)):(v<=h||h<=m)&&y.setScreenVisible(!1)):d.some(function(e){return e===a})&&y.setScreenVisible(!0)))},this.iteratorBlocks=function(i,r,o){O.editor.plugins.blockPlugin&&O.editor.plugins.blockPlugin.blockInfos.forEach(function(e,t){var n=e.instance;n.blockType===m.BlockType.FILE_CARD_BLOCK&&(i[n.blockId]?r:o).apply(O,[e,t])})},t&&(this.editor=t,this.bind())}return d()(n,[{key:"unbind",value:function(){this.editor.off("tableDidRender",this.handleTableRender)}},{key:"bind",value:function(){this.editor.on("tableDidRender",this.handleTableRender),this.uploaderPool=Object(g.b)(this.editor)}},{key:"handleTableRender",value:function(){}},{key:"reset",value:function(){this.unbind(),this.editor=null,this.uploaderPool=null,Object(g.a)()}},{key:"changesetApply",value:function(e,t){var i=this;this.uploaderPool&&Object.entries(this.fileIdChanges).forEach(function(e){var t=c()(e,2),n=t[0];t[1]<0&&i.uploaderPool.cancelUploading(n)}),this.fileIdChanges={}}},{key:"fullscreenModeChanged",value:function(e,t){var n=t.mode;this.isFullscreenPageMode=n===v.a.PAGED}},{key:"viewportChange",value:function(e,t){t.visibleRangeInMainZone;this.screenData=null;try{this.iteratorBlocks([],function(){return null},this.setBlockScreenVisible)}catch(e){console.error("",e)}}}]),n}())||i},Cf53:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"c",function(){return l});var r=n("D7h9"),o=n("ZhRG"),a=n("XfSZ"),i=function(){var e=r.default.getState();return Object(o.b)("image")(e)||Object(o.a)(a.a.IMAGE)(e)},s=function(){return Object(o.a)(a.a.COMMENT)(r.default.getState())},c=function(){var e=r.default.getState();return Object(o.b)("sidebar")(e)||Object(o.a)(a.a.SIDEBAR)(e)},l=function(e){var t=r.default.getState(),n=Object(o.a)(a.a.MORE_MENU)(t);if(n){var i=n.items[e+"Enable"];return void 0===i||i}return!0}},Cn65:function(e,t,n){"use strict";var i=n("lwsE"),s=n.n(i),c=n("hbEN"),l=5e3,u=1,d=function(){},h=function(i){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];try{i.call.apply(i,[null].concat(t))}catch(e){console.error("profile error",t)}}},f=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return e<0||1<=e||Math.random()<e},r=function e(t){var O=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};s()(this,e),this.handleRequestAnimationFrame=function(){O.eventsToReportInNextRender.forEach(function(e,i){e.forEach(function(e){var t=e.event,n=e.options;O.endEvent(i,t,n)})}),O.rqFId=null,O.eventsToReportInNextRender.clear()},this.handleVisibilityChange=function(){"visible"!==document.visibilityState&&null!==O.rqFId&&(window.cancelAnimationFrame(O.rqFId),O.eventsToReportInNextRender.clear())},this.endEvent=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=n.minimumUsedTime,r=n.beforeEnd,o=t.startTime,a=t.extraData,s=performance.now()-o;(!i||i<s)&&(r&&r.call(null,e),O.report(e,{usedTime:s,extraData:a,options:n})),O.clearEvent(e)},this.clearEvent=function(e){O.events.delete(e)},this.report=function(e,t){var n=O.dataToSend.get(e);void 0===n&&(n=[]);var i,r=n.length-1,o=n[r],a=n,s=t.usedTime,c=t.extraData,l=t.options,u=void 0===l?{}:l,d=u.isComposeAcceptable,h=void 0===d||d,f=u.conditionSampleRate,p=u.sampleRate,g=u.beforeSend,m=h&&o&&void 0===o.extraData&&void 0===c,v=p,b=s,y=1;m&&(b=s+o.usedTime,y=o.count+1),"function"!=typeof f||"number"==typeof(i=f({usedTime:b,count:y,extraData:c}))&&(v=i);var E={usedTime:b,count:y,sampleRate:v,extraData:c,beforeSend:g};m?a[r]=E:a.push(E),O.dataToSend.set(e,a),O.debounceSend()},this.send=function(){var d=O.getContext.call(null)||{};O.dataToSend.forEach(function(e,u){e.forEach(function(e){var t,n,i,r=e.usedTime,o=e.count,a=e.extraData,s=e.beforeSend,c=e.sampleRate,l=void 0===c?O.sampleRate:c;f(l)&&(i=a||{},s&&(t=s.call(null,u),(a||t)&&(n=t||{},i=Object.assign({},i,{},n))),O.log.call(null,u,Object.assign({count:o,time:r,avg_time:r/o},i,{},d)))}),O.dataToSend.delete(u)})},this.setGetContext=function(e){O.getContext=e},this.start=h(function(e){O.events.set(e,{startTime:performance.now()})}),this.pushData=h(function(e,t){var n,i,r=O.events.get(e);void 0!==r?(n=r.extraData||{},i=Object.assign({},n,{},t),O.events.set(e,{startTime:r.startTime,extraData:i})):console.error("push data to haven't started event: ".concat(e))}),this.end=h(function(e,t){var n=O.events.get(e);void 0!==n?O.endEvent(e,n,t):console.error("end event before start: ".concat(e))}),this.endByNextRender=h(function(e,t){var n,i=O.events.get(e);void 0!==i?(n=O.eventsToReportInNextRender.get(e)||[],O.eventsToReportInNextRender.set(e,n.concat({event:i,options:t})),null===O.rqFId&&(O.rqFId=window.requestAnimationFrame(O.handleRequestAnimationFrame)),O.clearEvent(e)):console.error("end event before start: ".concat(e))}),this.destroy=h(function(){null!==O.rqFId&&window.cancelAnimationFrame(O.rqFId),0<O.dataToSend.size&&O.send(),O.log=d,O.getContext=d,O.events.clear(),O.dataToSend.clear(),O.eventsToReportInNextRender.clear()}),this.log=t,this.events=new Map,this.dataToSend=new Map,this.eventsToReportInNextRender=new Map;var i=n.debounceInterval,r=n.sampleRate,o=void 0===r?u:r,a=void 0!==i?i:l;this.debounceSend=Object(c.default)(this.send,a),this.getContext=d,this.rqFId=null,this.sampleRate=o,document.addEventListener("visibilitychange",this.handleVisibilityChange)};t.a=r},Cy2Z:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return f});var i=n("p3Wu"),r=n("H6oK"),o=n("IcLG"),a=n("46iY"),s=n("SLR9"),c=n("WtIE"),l=n("TBry"),u=n("hJmJ"),d=n("DNsP"),h=[r.IGNORE_HYPERLINK_CLASS,r.IGNORE_LINE_BACKGROUND_CLASS,o.b,a.a,s.a,c.a,l.a,d.l],f=[i.a,u.b]},"D+Jz":function(e,b,y){"use strict";(function(c){y.d(b,"a",function(){return i}),y.d(b,"b",function(){return v});var e=y("RIqP"),l=y.n(e),r=y("CpTu"),u=y("7EGn"),s=y("fRsX"),t=y("rLED"),o=y("Fw02"),d=y("QM+C"),n=y("t6I4"),a=Object(t.K)("doc_template_v3_corporate_enabled");function i(e){var t=[],n=[];return Object(s.d)()===s.a.LEFT_RIGHT?(f(t,n,e),h(t),g(t,n,e)):(g(t,n,e),p(t,n,e),h(t)),m(t,n,e),{tabs:t,totalTemplates:n}}function h(e){var t=Object(o.a)(),n=Object(r.a)(t,{obj_type:d.NUM_SUITE_TYPE.DOC}),i=Object(r.a)(t,{obj_type:d.NUM_SUITE_TYPE.SHEET});n&&!Object(r.a)(e,{obj_type:d.NUM_SUITE_TYPE.DOC})&&e.push(n),i&&!Object(r.a)(e,{obj_type:d.NUM_SUITE_TYPE.SHEET})&&e.push(i)}function f(e,s,t){var n=(Object(u.default)(t,"tabs")||[]).reduce(function(t,e){var n=e.categories,i=e.recents;if(i){var r=2,o=1;switch(i.obj_type){case d.NUM_SUITE_TYPE.DOC:case d.NUM_SUITE_TYPE.MINDNOTE:r=1,o=2}var a=i.templates.map(function(e){return Object.assign({},e,{is_recent:!0})});a.unshift({cover_token:"",cover_width:r,cover_height:o,name:c("template_v3_blank"),obj_type:i.obj_type,obj_token:"",is_create_new:!0,id:0}),n.unshift({name:c("template_v3_recommended"),templates:a,is_recent:!0}),n.forEach(function(e){t[e.name]||(t[e.name]=[]),s.push.apply(s,l()(e.templates)),t[e.name]=t[e.name].concat(e.templates)})}return t},Object.create(null)),i=Object.keys(n).map(function(e){return{name:e,templates:n[e],is_recent:e===c("template_v3_recommended")}});e.push({tabTypeKey:"gallery",name:c("explorer.v3.template_gallery"),categories:i})}function p(e,s,t){var n=Object(u.default)(t,"tabs")||[];e.push.apply(e,l()(n.reduce(function(e,t){var n=t.categories,i=t.recents;if(i){var r=2,o=1;switch(i.obj_type){case d.NUM_SUITE_TYPE.DOC:case d.NUM_SUITE_TYPE.MINDNOTE:r=1,o=2}var a=i.templates.map(function(e){return Object.assign({},e,{is_recent:!0})});a.unshift({cover_token:"",cover_width:r,cover_height:o,name:c("template_v3_blank"),obj_type:i.obj_type,obj_token:"",is_create_new:!0,id:0}),n.unshift({name:c("template_v3_recommended"),templates:a,is_recent:!0}),n.forEach(function(e){s.push.apply(s,l()(e.templates||[]))}),e.push(Object.assign({},t,{obj_type:t.recents.obj_type,tabTypeKey:d.mapTypeNumToFileType[t.recents.obj_type],categories:n}))}return e},[])))}function g(e,t,n){var i,r,o,a;s.b&&(i=(Object(u.default)(n,"custom.own")||[]).map(function(e){return Object.assign({},e,{is_custom:!0,can_share:!0,can_delete:!0})}),r=(Object(u.default)(n,"custom.share")||[]).map(function(e){return Object.assign({},e,{is_custom:!0,can_share:!0,can_delete:!0})}),o=Object(u.default)(n,"custom.users")||{},a=Object.assign(Object.create(null),o),r.forEach(function(e){e.from_user_name=Object(u.default)(a,[e.from_user_id,"name"])}),e.push({tabTypeKey:"custom",name:c("explorer.v3.template_custom"),categories:[{name:c("explorer.v3.my_templates"),templates:i,type:"own"},{name:c("explorer.v3.templates_shared"),templates:r,type:"share"}]}),t.push.apply(t,l()(i).concat(l()(r))))}function m(e,t,n){var i,r,o;a&&(i=(Object(u.default)(n,"corporate.tenant")||[]).map(function(e){return Object.assign({},e,{is_corporate:!0})}),r=(Object(u.default)(n,"corporate.organization")||[]).map(function(e){return Object.assign({},e,{is_corporate:!0})}),o=[].concat(l()(i),l()(r)),e.push({tabTypeKey:"corporate",name:c("explorer.v3.template_corporate"),categories:[{name:c("explorer.v3.corporate_tenant"),templates:o,type:"tenant"}],hideCategories:!0}),t.push.apply(t,l()(o)))}function v(){return"true"===Object(n.d)(location.href).hideTemplate}}).call(this,y("2vAP"))},D0c4:function(e,t,n){"use strict";n.r(t);var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n.n(f),g=n("m/+l"),m=n("CnBM"),v=n.n(m),b=n("5cZX"),y=n("D7h9"),E=n("Jdee"),O=n("vc5i"),C=n("UAY2"),k=n("MUo5"),I=n("VI6H"),S=n("Mpt7"),T=function(){return p.a.createElement("div",{className:"layout-main-center layout-cross-center layout-row popover-loading"},p.a.createElement(C.a,null))},_=v()({loader:function(){return Promise.all([n.e("doc_index_css"),n.e("commons--home_banner--reaction--user_profile--whats_new_request"),n.e("commons--reaction--user_profile"),n.e("vendors--user_profile"),n.e("user_profile")]).then(n.bind(null,"6Sv6"))},loading:T}),w=function(e,t){var n=t.token;return{suiteShareable:Object(b.x)(e),userPermission:Object(E.a)(e,n),currentSuite:Object(O.f)(e)||S.default.fromJS({}),fileOwner:Object(b.Y)(e),isSingleProduct:Object(I.x)()}},j={bulkSetUserPermission:k.bulkSetUserPermission,bulkAskOwner:k.bulkAskOwner},M=Object(g.connect)(w,j)(_),L=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return h()(t,e),a()(t,[{key:"render",value:function(){return p.a.createElement(g.Provider,{store:y.default},p.a.createElement(M,Object.assign({},this.props)))}}]),t}(f.Component);t.default=L},D1oa:function(e,t,n){"use strict";function i(e){for(var t=e.length,n=new Uint8Array(t),i=0;i<t;i++)n[i]=e.charCodeAt(i);return n.buffer}function r(e){return String.fromCharCode.apply(null,new Uint8Array(e))}n.d(t,"c",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var o="image/png";function a(e){var t=s(e),n=new DataView(e),i=new Blob([n],{type:t||o});return{blobUrl:URL.createObjectURL(i),mime:t}}function s(e){for(var t=e.slice(0,4),t=new Uint8Array(t),n=[],i=0;i<t.byteLength;i++)n.push(t[i].toString(16));return c(n.join("").toUpperCase())}function c(e){switch(e){case"89504E47":return"image/png";case"47494638":return"image/gif";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":case"FFD8FFE2":case"FFD8FFE3":case"FFD8FFE8":return"image/jpeg";case"52494646":return"image/webp";default:return""}}},D28M:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"p",function(){return o}),n.d(t,"n",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"h",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"q",function(){return d}),n.d(t,"l",function(){return h}),n.d(t,"b",function(){return f}),n.d(t,"o",function(){return p}),n.d(t,"j",function(){return g}),n.d(t,"m",function(){return m}),n.d(t,"k",function(){return v}),n.d(t,"d",function(){return b}),n.d(t,"r",function(){return E}),n.d(t,"i",function(){return O}),n.d(t,"e",function(){return C});var i=n("nVH4");function r(t){for(var e,n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t.classList?i.forEach(function(e){return t.classList.add(e)}):t.getAttribute&&(e=(t.getAttribute("class")||"").split(" ").filter(function(e){return!i.includes(e)}).concat(i).join(" "),t.setAttribute("class",e))}function o(t){for(var e,n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t.classList?i.forEach(function(e){return t.classList.remove(e)}):t.getAttribute&&(e=(t.getAttribute("class")||"").split(" ").filter(function(e){return!i.includes(e)}).join(" "),t.setAttribute("class",e))}function a(e){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:document).querySelector(e)}function s(e,t){return e.classList?e.classList.contains(t):!!e.getAttribute&&(e.getAttribute("class")||"").split(" ").some(function(e){return e===t})}function c(e,t){return e.classList?Array.from(e.classList).find(function(e){return 0===e.indexOf(t)}):!!e.getAttribute&&(e.getAttribute("class")||"").split(" ").find(function(e){return 0===e.indexOf(t)})}function l(e,t){for(var n=!1,i=0;i<t.length;i++)c(e,t[i])&&(n=!0);return n}function u(e){var t=document.createElement("style");return t.appendChild(document.createTextNode(e)),t}function d(e){var t;!e||(t=e.parentNode)&&t.removeChild(e)}function h(e,t){for(;e;){if(s(e,t))return!0;e=e.parentNode}return!1}function f(e,t){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function p(e,t){for(;e;){if(s(e,t))return e;e=e.parentNode}return null}function g(e){var t=e.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function m(e){return e.previousElementSibling||e.previousSibling}function v(e){return e.nextElementSibling||e.nextSibling}function b(e,t){if(!e)return null;for(var n=e,i=0;n!==t&&null!==n;){i+=n.offsetTop;var r=n.offsetParent||y(n);if(!(r instanceof HTMLElement))return console.error(r,"is not HTMLElement"),null;n=r}return i}function y(e){return e&&e.classList.contains("ace-line-collapsed")?e.parentNode:null}function E(e,t){var n=b(e,t);null!==n&&(t.scrollTop=n)}function O(e){return!!e.setAttribute}function C(e){return e instanceof HTMLElement&&-1!==e.className.indexOf(i.b)&&e.dataset.magicdomid&&document.getElementById(e.dataset.magicdomid)||e}},D6hs:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("EVdn"),c=n.n(s),l=n("Q3NX"),u=function(){function e(){r()(this,e),this.className="modalSelectAll",this.handleKeydown=function(e){var t;!e.metaKey||"a"!==e.key||d(document.activeElement)||(t=c()('div[data-sel="spark-popup"]:visible,\n        .modal-select-all')[0])&&(t.parentElement&&Object(l.a)(t.parentElement),e.preventDefault(),e.stopImmediatePropagation())},c()(document.body).on("keydown",this.handleKeydown)}return a()(e,[{key:"destroy",value:function(){c()(document.body).off("keydown",this.handleKeydown)}}]),e}();function d(e){return!!e&&(["INPUT","TEXTAREA"].includes(e.tagName)||Boolean(e.getAttribute("contentEditable")))}},DCy2:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),c=n("UXvI"),l=n("HmyT"),s=n("MXQz"),u=n("fp5s"),d=n("EOxA"),h=n("TRZa"),f="ep-ranges",p=Object(s.a)(function(){return Object(l.$)('<div class="'.concat(f,'"></div>'))[0]}),g=function(){function t(e){r()(this,t),this._context=e,this._groups=new Map,this._rangeIdToGroupIdMap=new Map,this._groupOptions=new Map,this._outerContainer=null,this._root=null}return a()(t,[{key:"_nextRangeId",value:function(){return this._rangeId=Object(u.a)(),this._rangeId}},{key:"attach",value:function(e,t){var n=this;this._outerContainer=e,this._groups.forEach(function(e){return n._attachRangeGroupView(e)})}},{key:"addRange",value:function(e,t,n,i,r){var o,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"main";if(Object(h.b)(e))return null;this._groups.has(a)||(o=new d.a(this._context,this._groupOptions.get(a)),this._groups.set(a,o),this._attachRangeGroupView(o));var s=this._groups.get(a).addRange(e,t,n,i,r);return s&&this._rangeIdToGroupIdMap.set(s,a),s}},{key:"_attachRangeGroupView",value:function(e){var t;null!==this._outerContainer&&(null===this._root&&(0<(t=this._outerContainer.find("> .".concat(f))).length?this._root=t:(this._root=Object(l.$)(p().cloneNode(!0)),this._context.className&&this._root.addClass(this._context.className),"0"===this._context.zoneId&&this._root.addClass("main-ep-ranges"),this._outerContainer.append(this._root))),e.attach(this._root))}},{key:"updateRange",value:function(e,t,n,i){var r;null!=e&&this._rangeIdToGroupIdMap.has(e)&&(r=this._rangeIdToGroupIdMap.get(e),this._groups.get(r).updateRange(e,t,n,i))}},{key:"applyChangeset",value:function(t){this._groups.forEach(function(e){return e.applyChangeset(t)})}},{key:"getRange",value:function(e){var t=this._rangeIdToGroupIdMap.get(e);return this._groups.get(t).getRange(e)}},{key:"hasRange",value:function(e){return this._rangeIdToGroupIdMap.has(e)}},{key:"removeRange",value:function(e){var t,n;null!=e&&this._rangeIdToGroupIdMap.has(e)&&(t=this._rangeIdToGroupIdMap.get(e),(n=this._groups.get(t)).removeRange(e),this._rangeIdToGroupIdMap.delete(e),0===n.getAllRangeIds().length&&this.removeGroup(t))}},{key:"removeGroup",value:function(e){var t,n=this;this._groups.has(e)&&((t=this._groups.get(e)).getAllRangeIds().forEach(function(e){return n._rangeIdToGroupIdMap.delete(e)}),this._groups.delete(e),t.detach()),this._groupOptions.delete(e),0===this._groups.size&&null!==this._root&&(this._root.remove(),this._root=null)}},{key:"setGroupOptions",value:function(e,t){this._groupOptions.set(e,t),this._groups.has(e)&&this._groups.get(e).setOptions(t)}},{key:"layout",value:function(t){this._groups.forEach(function(e){return e.layout(t)})}},{key:"detach",value:function(){var n=this;this._groups.forEach(function(e,t){return n.removeGroup(t)}),this._groups.clear(),this._rangeIdToGroupIdMap.clear(),this._groupOptions.clear(),this._outerContainer=null}}]),t}();n.d(t,"a",function(){return m});var m=function(){function t(e){var s=this;r()(this,t),this.className="Range",this.aceInitialized=function(e,t){var n=t.editorInfo;s.context=t,s.editorInfo=t.editorInfo,s.rangesViews={},s.lastZoneOfMember={},s.mountRangesView({el:n.getOuterContainer()}),n.ace_getRange=s.getRange,n.ace_addRange=s.addRange,n.ace_updateRange=s.updateRange,n.ace_removeRange=s.removeRange,n.ace_hasRange=s.hasRange,n.getRange=s.getRange,n.addRange=s.addRange,n.updateRange=s.updateRange,n.removeRange=s.removeRange,n.hasRange=s.hasRange,window.addEventListener("resize",s.onWindowResize),s.editorInfo.on("innerZoneMount",s.mountRangesView)},this.forceLayout=function(){try{Object.values(s.rangesViews).forEach(function(e){return e.layout(!0)})}catch(e){console.log("editor resize change catch",e)}},this.onWindowResize=Object(c.default)(this.forceLayout,60),this.bufferChanged=function(e,t){s.forceLayout()},this._changesetApply=function(e,t){var n,i=t.changeset,r=t.insertsAfterSelection,o=s.editorInfo.changesetHelper;r||(n=o.formatCs(i),Object.keys(n).forEach(function(e){var t=n[e];t&&s.rangesViews[e]&&s.rangesViews[e].applyChangeset(t)}))},this.changesetApply=function(e,t){try{s._changesetApply(e,t)}catch(e){console.log("range apply changeset error",t)}},this.reset=function(){Object.values(s.rangesViews).forEach(function(e){return e.detach()}),window.removeEventListener("resize",s.onWindowResize),s.editorInfo.off("innerZoneMount",s.mountRangesView),s.editor=null,s.editorInfo=null,s.context=null,s.rangesViews={},s.lastZoneOfMember={}},this.editorSizeChange=function(){s.forceLayout()},this.handleImageResize=function(e,t){var n=t.zoneId;s.rangesViews[n]&&s.rangesViews[n].layout(!0)},this.handleSheet=function(){s.forceLayout()},this.mountRangesView=function(e){var t=e.el,n=e.zoneId,i=void 0===n?"0":n,r=e.className,o=new g(Object.assign(s.context,{className:r,isRowMounted:s.isRowMounted.bind(s),zoneId:i}));o.attach(Object(l.$)(t),i),s.rangesViews[i]=o},this.getRange=function(e,t){var n=t||s.editorInfo.selection.getZone();if(null!==e&&s.rangesViews[n])return s.rangesViews[n].getRange(e)},this.addRange=function(e,t,n,i,r,o){var a=e.selZone;return s.rangesViews[a]?(s.resetLastRange(n,a),s.lastZoneOfMember[n]=a,s.rangesViews[a].addRange(e,t,n,i,r,o)):null},this.resetLastRange=function(e,t){s.lastZoneOfMember[e]&&s.lastZoneOfMember[e]!==t&&s.rangesViews[s.lastZoneOfMember[e]]&&s.rangesViews[s.lastZoneOfMember[e]].removeRange(e)},this.updateRange=function(e,t,n,i,r){var o=t||s.editorInfo.selection.getZone();s.resetLastRange(e,o),null!=e&&s.rangesViews[o]&&s.rangesViews[o].updateRange(e,n,i,r)},this.hasRange=function(e,t){var n=t||s.editorInfo.selection.getZone();if(null!=e&&s.rangesViews[n])return s.rangesViews[n].hasRange(e)},this.removeRange=function(e,t){var n=t||s.editorInfo.selection.getZone();null!=e&&s.rangesViews[n]&&s.rangesViews[n].removeRange(e)},e&&(this.editor=e,this.aceInitialized("",Object.assign({editorInfo:e},e)))}return a()(t,[{key:"isRowMounted",value:function(e,t){var n=this.editorInfo.blockRender.getLineStatus(e,t);return n&&n.isActive}},{key:"removeGroup",value:function(t){Object.values(this.rangesViews).forEach(function(e){return e.removeGroup(t)})}},{key:"setGroupOptions",value:function(t,n){Object.values(this.rangesViews).forEach(function(e){return e.setGroupOptions(t,n)})}}]),t}();new m},DGTj:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n("J4zp"),d=n.n(i),r=n("RIqP"),h=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("H6oK"),f=n("y2sV"),p=!1,u=!1,g=!1,m=function(){function n(e){var t=this;a()(this,n),this.editor=e,this.wordBreakRegex=/^[`!@#$%^&*()+{}|:"<>[\];',.\\=\s\-/]$/,this.wordPrevBreakRegex=/^[\s\-\\"'[({#$`]$/,this.wordNextBreakRegex=/^[\s\-\\"'()[\]{}?,.!;:_@#%&*]$/,this.shouldAddPrevSpaceRegex=/^[a-zA-Z0-9~!%^&*)+|\]}\\,.:;?<>=]$/,this.shouldAddNextSpaceRegex=/^[a-zA-Z0-9~$^<>`+|=]$/,this.handleCopy=function(){var e=t.editor.getRep();t.checkAutoSpaceEnable(e)},this.handleCut=function(){var e=t.editor.getRep();t.checkAutoSpaceEnable(e),t.removeExtraSpace(e)},this.aceCopy=function(){var e=t.editor.getRep();t.checkAutoSpaceEnable(e)},this.aceCut=function(){var e=t.editor.getRep();t.checkAutoSpaceEnable(e),t.removeExtraSpace(e)},this.editor.on(f.k.COPY,this.handleCopy),this.editor.on(f.k.CUT,this.handleCut)}return c()(n,[{key:"isLineBlockOrImage",value:function(e,t){try{var n=this.editor.getAllAttributesOnLine(e,t),i=n.find(function(e){return"gallery"===e[0]}),r=n.find(function(e){return"dataMetaBlockProps"===e[0]&&e[1]}),o=r&&JSON.parse(r[1]).props.displayMode===l.BlockDisplayMode.INLINE;return i||r&&!o}catch(e){return!1}}},{key:"getExtendAttributes",value:function(e){return h()(e.filter(function(e){return["underline","backcolor","strikethrough"].includes(e[0])}))}},{key:"isSelStartLineStart",value:function(e){return e.lines.isStartOfLine(e.selStart[0],e.selStart[1])}},{key:"isSelEndLineEnd",value:function(e){return e.lines.isEndOfLine(e.selEnd[0],e.selEnd[1])}},{key:"isPrevCharLineMarker",value:function(e){var t=e.lines.atIndex(e.selStart[0]);return 0!==t.lineMarker&&t.lineMarker===e.selStart[1]}},{key:"shouldAddPrevSpace",value:function(e){var t=e.selStart,n=e.lines.atIndex(t[0]).text[t[1]-1];return!u&&!this.isPrevCharLineMarker(e)&&this.shouldAddPrevSpaceRegex.test(n)}},{key:"shouldAddNextSpace",value:function(e){var t=e.selEnd,n=e.lines.atIndex(t[0]).text[t[1]];return!g&&this.shouldAddNextSpaceRegex.test(n)}},{key:"removeExtraSpace",value:function(e){var t,n,i,r,o,a,s,c,l=e.selStart,u=e.selEnd,d=e.zoneId;l&&u&&(l[0]!==u[0]||l[1]!==u[1])&&(l[0]===u[0]&&this.editor.isImageLine(e.zoneId,l[0])||(t=e.lines.atIndex(l[0]),n=e.lines.atIndex(u[0]),i=t.text[l[1]-1],r=n.text[u[1]],o=this.isSelStartLineStart(e)||this.wordPrevBreakRegex.test(i),a=this.isSelEndLineEnd(e)||this.wordNextBreakRegex.test(r),s=h()(l),c=h()(u)," "===r&&o&&!this.isLineBlockOrImage(d,u[0])?c[1]+=1:" "===i&&a&&!this.isLineBlockOrImage(d,l[0])&&--s[1],this.editor.version.includes(f.y)?this.editor.selection.setSelection({start:{line:l[0],offset:l[1],zoneId:d},end:{line:u[0],offset:u[1],zoneId:d}},!0):(this.editor.selection.setWithSelection(e.zoneId,s,c),this.editor.updateBrowserSelectionFromRep(!0))))}},{key:"checkAutoSpaceEnable",value:function(e){var t,n,i,r,o=e.selStart,a=e.selEnd,s=e.zoneId;o&&a&&(t=e.lines.atIndex(o[0]),n=e.lines.atIndex(a[0]),u=" "===t.text[o[1]],g=" "===n.text[a[1]-1],i=(this.isSelStartLineStart(e)||this.wordBreakRegex.test(t.text[o[1]-1])||u)&&!this.isLineBlockOrImage(s,o[0]),r=(this.isSelEndLineEnd(e)||this.wordBreakRegex.test(n.text[a[1]])||g)&&!this.isLineBlockOrImage(s,a[0]),p=i&&r)}},{key:"editorWillPaste",value:function(e){var t=e.deltaSet,n=e.zoneId,i=e.isInternalPaste;if(!p||!i)return t;var r,o,a,s,c=t,l=this.editor.getRep(),u=function(e){return e.reduce(function(e,t){var n=d()(t,2),i=n[0],r=n[1];return e[i]=r,e},{})};return this.shouldAddPrevSpace(l)&&(r=l.attributeManager.getAttributesOnPosition(l.selStart[0],l.selStart[1]),o=new f.E({zoneId:n}).insert(" ",u(this.getExtendAttributes(r))).concat(c.get(n)),c=c.replace(n,o)),this.shouldAddNextSpace(l)&&(a=l.attributeManager.getAttributesOnPosition(l.selEnd[0],this.isSelEndLineEnd(l)?l.selEnd[1]:l.selEnd[1]+1),s=new f.E({zoneId:n}).concat(c.get(n)).insert(" ",u(this.getExtendAttributes(a))),c=c.replace(n,s)),c}},{key:"beforePaste",value:function(e,t){var n,i,r,o,a;p&&0!==t.pasteTimes&&(i=(n=this.editor.getRep()).selStart,r=n.selEnd,o=n.zoneId,i&&r&&this.shouldAddPrevSpace(n)&&(a=n.attributeManager.getAttributesOnPosition(i[0],i[1]),this.editor.performDocumentReplaceRangeWithAttributes(o,i,i," ",this.getExtendAttributes(a)),this.editor.selection.setWithSelection(o,[i[0],i[1]+1],[r[0],i[0]===r[0]?r[1]+1:r[1]]),this.editor.updateBrowserSelectionFromRep(!0)))}},{key:"afterPaste",value:function(e,t){var n,i,r,o,a;p&&0!==t.pasteTimes&&(i=(n=this.editor.getRep()).selStart,r=n.selEnd,o=n.zoneId,i&&r&&this.shouldAddNextSpace(n)&&(a=n.attributeManager.getAttributesOnPosition(r[0],this.isSelEndLineEnd(n)?r[1]:r[1]+1),this.editor.performDocumentReplaceRangeWithAttributes(o,r,r," ",this.getExtendAttributes(a))))}},{key:"aceKeyEvent",value:function(e,t){var n,i=t.evt;i.ctrlKey||i.shiftKey||i.altKey||i.metaKey||"Backspace"!==i.key&&"Delete"!==i.key||(n=this.editor.getRep(),this.removeExtraSpace(n))}},{key:"destroy",value:function(){this.editor.off(f.k.COPY,this.handleCopy),this.editor.off(f.k.CUT,this.handleCut)}}]),n}()},DIyy:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("zAQS"),p=n("PcuH"),g=n("kESg"),m=n("ciJ8"),v=n("xYHj"),b=new(function(e){function t(){var e;return r()(this,t),(e=c()(this,u()(t).apply(this,arguments))).zoneType=g.l.CalloutBlock,e}return h()(t,e),a()(t,[{key:"getZoneId",value:function(e,t,n){return Object(f.h)(e,t,n)}},{key:"getDefaultZoneAttrs",value:function(){return Object(f.i)()}},{key:"getZoneAttrsByZoneId",value:function(e,t){return Object(f.e)(e,t)||this.getDefaultZoneAttrs()}},{key:"isUnsupportLine",value:function(e,t){return Object(v.a)(e,t,m.c)||Object(v.c)(e,t)||Object(v.m)(e,t)}},{key:"afterInsertZone",value:function(e,t){Object(f.m)(t)}},{key:"convertToCalloutBlock",value:function(e,t,n){this.convertToZone(e,t,n)}}]),t}(p.a));p.a.registerTransformer(g.l.CalloutBlock,b),t.a=b},DJKl:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a});var i=n("jp/M"),r=function(e){return{type:i.actionTypes.commentReaction.SET_COMMENT_REACTION,payload:e}},o=function(e){return{type:i.actionTypes.commentReaction.SET_COMMENT_REACTION_ENTITIES,payload:e}},a=function(e){return{type:i.actionTypes.commentReaction.SET_COMMENT_REACTION_LOAD_STATUS,payload:e}}},DKi5:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("YNKm"),l=n("nVH4"),c=(n("Uizi"),n("y2sV")),u=function(){function t(e){var c=this;r()(this,t),this.regist=function(e){e.registerAceCommand(s.TEMPLATEWRAP,function(e,t){t.doInsertTemplateWrap()},{statusKey:null})},this.aceInitialized=function(e,t){c._editorInfo=t.editorInfo,c._editorInfo.doInsertTemplateWrap=c.doInsertTemplateWrap,c.regist(c._editorInfo)},this.aceKeyEvent=function(e,t){var n=t.evt,i=t.editorInfo,r=t.isTypeForSpecialKey,o=n.keyCode,a=n.type,s=i.getRep();return"keydown"===a&&(!!r&&(o===l.c.RETURN&&(c.isTemplateWrapLine(s.zoneId,s.selStart[0])||c.isTemplateWrapLine(s.zoneId,s.selEnd[0])?(n.preventDefault(),!0):void 0)))},this.doInsertTemplateWrap=function(){var e=c._editorInfo,t=e.getRep(),n=t.selStart[0];e.setAttributeOnLine(t.zoneId,n,"template","wrap")},this.aceAttribsToClasses=function(e,t){if("template"===t.key)return"template-".concat(t.value)},this.aceDomLineProcessLineAttributes=function(e,t){var n=t.spanClass;/(?:^| )template-wrap/.exec(n)&&(t.lineClass+=" template-wrap",t.processedMarker=!0)},e&&this.aceInitialized("",Object.assign({editorInfo:e},e))}return a()(t,[{key:"reset",value:function(){this._editorInfo=null}},{key:"isTemplateWrapLine",value:function(e,t){return"wrap"===this._editorInfo.getAttributeOnLine(e,t,"template")}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement&&-1<t.className.indexOf("template-wrap"))return Object(c.I)(n,i,{template:"wrap"});return n}}]),t}();new u},DNsP:function(e,t,n){"use strict";n.d(t,"i",function(){return E}),n.d(t,"j",function(){return O}),n.d(t,"b",function(){return k}),n.d(t,"o",function(){return I}),n.d(t,"d",function(){return S}),n.d(t,"k",function(){return T}),n.d(t,"h",function(){return _}),n.d(t,"e",function(){return w}),n.d(t,"a",function(){return j}),n.d(t,"p",function(){return M}),n.d(t,"n",function(){return L}),n.d(t,"g",function(){return R}),n.d(t,"t",function(){return N}),n.d(t,"f",function(){return D}),n.d(t,"m",function(){return x}),n.d(t,"q",function(){return B}),n.d(t,"r",function(){return U}),n.d(t,"u",function(){return z}),n.d(t,"c",function(){return H}),n.d(t,"l",function(){return F}),n.d(t,"s",function(){return V});var i,r,o,a,s,c,l,u=n("lSNA"),d=n.n(u),h=n("RIqP"),f=n.n(h),p=n("J4zp"),g=n.n(p),m=n("/GXw"),v=n("1dfU"),b=n("H6oK"),y=n("EDbJ"),E="highlight",O="HIGHLIGHT_BTN_STYLE_CHANGE";(l=c=c||{}).TEXT="TEXT",l.BACKGROUND="BACKGROUND";var C={COLOR_PINK_LIGHT_BACKGROUND:"COLOR_PINK_LIGHT_BACKGROUND",COLOR_ORANGE_LIGHT_BACKGROUND:"COLOR_ORANGE_LIGHT_BACKGROUND",COLOR_YELLOW_LIGHT_BACKGROUND:"COLOR_YELLOW_LIGHT_BACKGROUND",COLOR_GREEN_LIGHT_BACKGROUND:"COLOR_GREEN_LIGHT_BACKGROUND",COLOR_BLUE_LIGHT_BACKGROUND:"COLOR_BLUE_LIGHT_BACKGROUND",COLOR_PURPLE_LIGHT_BACKGROUND:"COLOR_PURPLE_LIGHT_BACKGROUND",COLOR_GRAY_LIGHT_BACKGROUND:"COLOR_GRAY_LIGHT_BACKGROUND",COLOR_PINK_DARK_BACKGROUND:"COLOR_PINK_DARK_BACKGROUND",COLOR_ORANGE_DARK_BACKGROUND:"COLOR_ORANGE_DARK_BACKGROUND",COLOR_YELLOW_DARK_BACKGROUND:"COLOR_YELLOW_DARK_BACKGROUND",COLOR_GREEN_DARK_BACKGROUND:"COLOR_GREEN_DARK_BACKGROUND",COLOR_BLUE_DARK_BACKGROUND:"COLOR_BLUE_DARK_BACKGROUND",COLOR_PURPLE_DARK_BACKGROUND:"COLOR_PURPLE_DARK_BACKGROUND",COLOR_GRAY_DARK_BACKGROUND:"COLOR_GRAY_DARK_BACKGROUND",COLOR_PINK_TEXT:"COLOR_PINK_TEXT",COLOR_ORANGE_TEXT:"COLOR_ORANGE_TEXT",COLOR_YELLOW_TEXT:"COLOR_YELLOW_TEXT",COLOR_GREEN_TEXT:"COLOR_GREEN_TEXT",COLOR_BLUE_TEXT:"COLOR_BLUE_TEXT",COLOR_PURPLE_TEXT:"COLOR_PURPLE_TEXT",COLOR_GRAY_TEXT:"COLOR_GRAY_TEXT",COLOR_CLEAR:"COLOR_CLEAR"},k=new Map([[C.COLOR_PINK_LIGHT_BACKGROUND,m.N],[C.COLOR_ORANGE_LIGHT_BACKGROUND,Object(y.a)(m.z,.8)],[C.COLOR_YELLOW_LIGHT_BACKGROUND,Object(y.a)(m.V,.8)],[C.COLOR_GREEN_LIGHT_BACKGROUND,Object(y.a)(m.i,.8)],[C.COLOR_BLUE_LIGHT_BACKGROUND,Object(y.a)(m.b,.7)],[C.COLOR_PURPLE_LIGHT_BACKGROUND,Object(y.a)(m.G,.7)],[C.COLOR_GRAY_LIGHT_BACKGROUND,Object(y.a)(m.s,.8)],[C.COLOR_PINK_DARK_BACKGROUND,m.P],[C.COLOR_ORANGE_DARK_BACKGROUND,m.B],[C.COLOR_YELLOW_DARK_BACKGROUND,m.Y],[C.COLOR_GREEN_DARK_BACKGROUND,m.k],[C.COLOR_BLUE_DARK_BACKGROUND,Object(y.a)(m.d,.55)],[C.COLOR_PURPLE_DARK_BACKGROUND,Object(y.a)(m.I,.55)],[C.COLOR_GRAY_DARK_BACKGROUND,m.t]].map(function(e){var t=g()(e,2),n=t[0],i=t[1];return[n,Object(y.a)(i)]})),I=new Map([[C.COLOR_PINK_TEXT,m.S],[C.COLOR_ORANGE_TEXT,m.E],[C.COLOR_YELLOW_TEXT,m.cb],[C.COLOR_GREEN_TEXT,m.n],[C.COLOR_BLUE_TEXT,m.g],[C.COLOR_PURPLE_TEXT,m.L],[C.COLOR_GRAY_TEXT,m.v]].map(function(e){var t=g()(e,2),n=t[0],i=t[1];return[n,Object(y.a)(i)]})),S="COLOR_CLEAR",T=new Map([].concat(f()(k),f()(I),[[S,"clear"]])),_=new Set(f()(T.values())),w=d()({COLOR_PINK:"colorPink",COLOR_ORANGE:"colorOrange",COLOR_YELLOW:"colorYellow",COLOR_BLUE:"colorBlue",COLOR_GREEN:"colorGreen",COLOR_PURPLE:"colorPurple"},S,"colorClear"),j={BACKGROUND:"backcolor",TEXT:"textcolor",CLEAR:"highlight_cancel"},M=(i={},d()(i,j.TEXT,"color"),d()(i,j.BACKGROUND,"background-color"),i),L=(r={},d()(r,j.BACKGROUND,"rgba(0,0,0,0)"),d()(r,j.TEXT,Object(y.a)(m.x)),o={},d()(o,j.BACKGROUND,"white"),d()(o,j.TEXT,m.x),o),R=(a={},d()(a,j.TEXT,"foreColor"),d()(a,j.BACKGROUND,"backColor"),a),N=["rgb(213, 229, 245)","#d5e5f5","rgb(255, 166, 166)","#ffa6a6",m.R,m.D,m.m,m.f,m.K,m.z,m.i,m.s,m.P,m.B,m.ab,m.k,m.t,m.Z,Object(y.a)(m.d,.55),Object(y.a)(m.I,.55),Object(y.a)(m.cb,.8),Object(y.a)(m.G,.7),Object(y.a)(m.b,.7)],D=(s={},d()(s,w.COLOR_PINK,["rgba(255, 188, 178, 1)","#ffbcb2","rgb(255, 188, 178)"]),d()(s,w.COLOR_ORANGE,["rgba(255, 211, 126, 1)","#ffd37e","rgb(255, 211, 126)"]),d()(s,w.COLOR_YELLOW,["rgba(255, 243, 98, 1)","#fff362","rgb(255, 243, 98)"]),d()(s,w.COLOR_BLUE,["rgba(167, 206, 255, 1)","#a7ceff","rgb(167, 206, 255)"]),d()(s,w.COLOR_GREEN,["rgba(176, 253, 167, 1)","#b0fda7","rgb(176, 253, 167)"]),d()(s,w.COLOR_PURPLE,["rgba(223, 176, 255, 1)","#dfb0ff","rgb(223, 176, 255)"]),s),x=Object(v.a)(window.User.id)+"_HIGHLIGHT_COLOR_KEY_V2",P="COLOR_YELLOW_LIGHT_BACKGROUND",B={background:k.get(P)},U=JSON.stringify(B),z=w.COLOR_YELLOW,H=(D[z][1],D[w.COLOR_PINK][0],"bgcolor-wrap-padding"),F="IGNORE_BACKGROUND_COLOR",V=[b.BlockType.SHEET_BLOCK,b.BlockType.BITABLE_BLOCK,b.BlockType.CHAT_CARD_BLOCK,b.BlockType.POLL_BLOCK,b.BlockType.FILE_CARD_BLOCK]},DOYj:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 48 48"},t),c.a.createElement("path",{d:"M22.24 16h3.56L32 32h-3.53l-1.6-3.98h-5.63L19.58 32H16l6.24-16zM22 24h3l-1.47-4L22 24z",fill:"#123",fillRule:"evenodd"}))}},DVUE:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n.n(f),g=n("y2sV");function m(e){e.text=e.texts||e.text,delete e.texts}var v=function(e){function n(e){var t;return r()(this,n),(t=c()(this,u()(n).call(this,e))).initClientVars=e.clientVars,m(e.clientVars.initialAttributedTexts),window.getScrollContainer=function(){return document.querySelector("body")},window.getDocbody=function(){return document.getElementById("innerdocbodyWrap")},t}return h()(n,e),a()(n,[{key:"getEditorText",value:function(){return""}},{key:"getSegmentArray",value:function(){return[]}},{key:"replaceEditorValue",value:function(){}},{key:"setSelectionToLastCharacter",value:function(){}},{key:"render",value:function(){return p.a.createElement(g.i,Object.assign({},this.props,{data:this.initClientVars}))}}]),n}(f.Component)},DdIq:function(e,t,n){},DgHK:function(e,t,n){"use strict";n.d(t,"b",function(){return p}),n.d(t,"a",function(){return s});var i=n("QILm"),u=n.n(i),r=n("xA8S"),o=n("A2D6"),a=n("FnDM"),d=n("TJya"),h=n("VIFs"),f=n("toa8"),p=function(e){return{xhrFields:{withCredentials:!0},headers:{"Request-Id":e,"x-tt-trace-id":e,"X-CSRFToken":Object(o.b)("_csrf_token")||"","F-Version":window&&window.rv_rev||"","X-Request-Id":e,Context:"request_id=".concat(e,";")+"os=".concat(Object(a.k)(),";app_version=").concat(Object(a.b)(),";")+"os_version=".concat(Object(a.l)(),";platform=").concat(Object(a.p)()),Env:Object(r.a)()},dataFilter:function(e,t){return e}}};function s(e){var t=e.requestId,n=e.headers,i=u()(e,["requestId","headers"]),r=p(t),o=r.headers,a=u()(r,["headers"]),s=Object.assign({},Object(d.a)(e),{},o,{},n),c=Object.assign({},a,{},i,{url:Object(h.prependAPI)(e.url)}),l=Object.assign({},{headers:s},c);return Object(f.d)(l)}},Di24:function(e,t,n){"use strict";var i=n("lSNA"),j=n.n(i),r=n("J4zp"),M=n.n(r),h=n("SebV"),f=n("y2sV"),L=n("j1lG"),R=n("nN3d"),N=n("+Xq6"),o=n("M8cP"),D=n("Z/PY"),a=n("vE74"),s=n("0bqa"),c=n("o0o1"),l=n.n(c),u=n("yXPU"),d=n.n(u),p=n("lwsE"),g=n.n(p),m=n("W8MJ"),v=n.n(m),b=n("QM+C"),y=n("iP/4"),E=n("toa8"),O=n("lQZd"),C=function(){function n(e,t){g()(this,n),this.isDriveUpload=!1,this.src=e,this.aborted=!1,this.isDriveUpload=t}function e(){return t.apply(this,arguments)}var t;return v()(n,[{key:"start",value:function(){return this._start(),this}},{key:"success",value:function(e){return this.successHandler=e,this}},{key:"fail",value:function(e){return this.errorHandler=e,this}},{key:"abort",value:function(){this.aborted=!0,this.xhr&&this.xhr.abort()}},{key:"progress",value:function(e){return this.progressHandler=e,this}},{key:"_start",value:(t=d()(l.a.mark(function e(){var t,n,i,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.src,e.next=4,k(t);case 4:if(n=e.sent,this.aborted)return e.abrupt("return");e.next=7;break;case 7:if(n){e.next=9;break}throw new Error("fail to convert base64 to file");case 9:return i=this.isDriveUpload?"/api/box/stream/upload/all/":"/api/file/upload/",e.next=12,this.uploadImage(i,n,this.progressHandler.bind(this));case 12:if(r=e.sent,this.aborted)return e.abrupt("return");e.next=15;break;case 15:this.successHandler(r),e.next=23;break;case 18:if(e.prev=18,e.t0=e.catch(0),this.aborted)return e.abrupt("return");e.next=22;break;case 22:this.errorHandler(e.t0);case 23:case"end":return e.stop()}},e,this,[[0,18]])})),e)},{key:"uploadImage",value:function(e,n,i){var t,r=this,o=new FormData,a=Object(O.g)();return this.isDriveUpload?(t="name=".concat(n.name,"&mount_node_token=").concat(a,"&mount_point=doc_image")+"&push_open_history_record=1&size=".concat(n.size),e+="".concat(/\?/.test(e)?"&":"?").concat(t)):(o.append("token",a),o.append("obj_type",b.NUM_SUITE_TYPE.DOC.toString(10)),o.append("type",n.type),o.append("lastModifiedDate",n.lastModifiedDate||""),o.append("size",n.size.toString(10)),o.append("name",n.name)),o.append("file",n,S()?n.name:void 0),this.xhr=E.d.post(e,o,{headers:{"Content-Type":"multipart/form-data;"},timeout:9e4,onUploadProgress:function(e){var t=e.loaded/(e.total||n.size);i(t)}}),this.xhr.then(function(e){return Object(D.n)("success",n.size,n.name),{data:e.data,file:n,src:r.src}}).catch(function(e){throw Object(D.n)("fail",n.size,n.name),new Error(e.msg)})}}]),n}();function k(e){if(0===e.indexOf("data:"))try{var t=/^data:image\/([a-z-+.]+);base64,([\S]+)/.exec(e);if(null===t)return;var n=t[1];if(S()){var i=I(t[2],t[1]);return i.name="image.".concat(t[1]),i}return fetch(e).then(function(e){return e.blob()}).then(function(e){return new File([e],"file-"+Date.now()+"."+n,{type:"image/".concat(n)})}).catch(function(e){console.log(e)})}catch(e){console.error(e)}}function I(e,t,n){t=t||"",n=n||512;for(var i=atob(e),r=[],o=0;o<i.length;o+=n){for(var a=i.slice(o,o+n),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a.charCodeAt(c);var l=new Uint8Array(s);r.push(l)}return new Blob(r,{type:t})}function S(){return y.a.isEdge||y.a.isIE}var x=n("xNNw"),P=n("qkt2"),B=n("Tqb2"),U=n("OMpt");n.d(t,"b",function(){return _}),n.d(t,"a",function(){return w}),n.d(t,"c",function(){return Z});var z=function(e,t){var n;t&&/^(http|https):\/\//gi.test(t)&&((n=Object(o.d)(t))&&e("doc_collect_image",{image_hostname:n.hostname,image_protocol:n.protocol}))},H=function(e,t){return/^blob:/gi.test(t)?(e.getInnerContainer().dispatchEvent(Object(a.b)("custom-compatible-safari-paste",{detail:t})),!0):!!/^file/gi.test(t)},F=function(i){setTimeout(function(){var e=i.getRep(),t=e.lines.length()-1,n=e.selStart[0]+1;t<n&&(n=t),i.selection.setWithSelection(e.zoneId,[n,0],[n,0],!1),i.updateBrowserSelectionFromRep(!0),s.a.removeImageChooseStyle(),s.a.removeGalleryChoosedStyle()})},V=function(e){var t,n,i,r,o=e.style.width&&e.style.height&&!isNaN(parseFloat(e.style.width))&&!isNaN(parseFloat(e.style.height))?(t=e.style.width,e.style.height):e.dataset.width&&e.dataset.height?(t=e.dataset.width,e.dataset.height):(i=e.width||"",r=e.height||"",e.getAttribute("width")&&e.getAttribute("height")||(e.removeAttribute("width"),e.removeAttribute("height")),t=e.width,o=e.height,n=!t||!o,t=t||i||e.style.width||e.dataset.width||"",o||r||e.style.height||e.dataset.height||"");return[t,o,n]},W=function(e,t,n,i){var r,o,a,s=e.tasks;return e.editable&&/^data:/.test(i)?(r&&delete s[r],r=Object(R.c)(10),o={src:i},a=new C(i,t),o.task=a,s[r]=o,i=""):r=n.getAttribute("data-task")||"",{taskId:r,task:a}},K=function(e,t,n,i,r,o,a,s,c){if(Object(D.t)(n)){var l=i.getAttribute("data-external-id"),u=l||Object(R.c)(10);return l||c(n,{externalId:u,uuid:r,width:o,height:a,noSiz:s}),["image-previewer",t+"&externalLoading=true&externalId=".concat(u)]}return[e,t]},T=function(e,t){var n=t.log,i=t.needReplaceTokenMap,r=t.editor,o=t.uuidCertainly,a=t.driveImageEnable,s=t.saveExternalImage,c=e.getAttribute("data-src")||e.src,l=e.getAttribute("data-suite"),u=!1,d=e.dataset.fileToken||"";if(l)var h=Object(N.d)(l),f=h.originSrc,d=h.fileToken,c=(f=f.replace(/~noop\/$/,""))||c;else if(Object(D.s)(c))return n("doc_error_paste_drive_image",{src:c}),null;if(u=d&&i&&i[d],z(n,c),H(r,c))return null;F(r);var p=o(e),g=V(e),m=M()(g,3),v=m[0],b=m[1],y=m[2],E=W(t,a,e,c),O=E.taskId,C=E.task,k="&uuid=".concat(p,"&pluginName=imageUpload&height=").concat(b,"&width=").concat(v),I=O?(k+="&taskId=".concat(O),"image-previewer"):(k="src=".concat(encodeURIComponent(c)).concat(k,"&fileToken=").concat(d),u?"clientside-image-uploaded":"image-uploaded"),S=K(I,k,c,e,p,v,b,y,s),T=M()(S,2),_=T[0],w=T[1];return C&&Object(x.a)(t,C,O,y,v,b,p,r),j()({},_,w)},_=function(e,t,n,i,r){var o=t,a=T(e,r);if(!a)return o;var s=new f.E({zoneId:n});return s.insert(L.B,a),o=t.concat(s)},w=function(e,t,n,i,r){var o,a=t;try{var s=$(e).closest(".image-uploaded").attr("data-ace-gallery-json");s&&(o=JSON.parse(s))}catch(e){Object(h.a)("[EDITOR][GALLERY]: try to CC gallery failed: ".concat(e.message))}if(!o)return a;var c=!1;o.items.forEach(function(e){e.uuid=Object(R.c)(10)+(new Date).getTime(),i||(e.comments=[]),e.file_token&&r&&r[e.file_token]&&(c=!0)});var l=c?"clientside-gallery":"gallery",u=j()({},l,JSON.stringify(o)),d=new f.E({zoneId:n});return d.insert(L.B,u),a=t.concat(d)},Z=function(e,S,T){var _=Object(O.g)(),w=[],j={};return e.ops.forEach(function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k,I;e.attributes&&(e.attributes[L.K]||e.attributes[L.M])&&(t=e.attributes.suiteData,delete e.attributes.suiteData,n=!!t&&Object(N.d)(t),i=n&&n.objToken===_,r=i&&S,e.attributes[L.K]?(o=!1,(a=Object(D.C)(e.attributes[L.K]))&&a.items&&(a.items&&a.items.forEach(function(e){e.uuid=Object(P.b)(null),e.comments=r?e.comments:[];var t=e.file_token;!i&&t&&(w.push(t),j[t]=n,o=!0)}),s=o?L.c:L.K,delete e.attributes[L.K],e.attributes[s]=JSON.stringify(a))):(c=Object(B.p)(L.M,e.attributes[L.M]))&&0!==c.length&&(delete e.attributes[L.M],d=(u=(l=c[0]).size).displayWidth,h=u.displayHeight,f=l.token,p=l.imageCategory,g=l.originSrc,m=Object(U.c)(i,p),b=(v=M()(m,2))[0],y=v[1],E=!h||!d,C={uuid:O=Object(P.b)(null),height:h,width:d,src:g,fileToken:f||""},I=p===L.D.Drive?(b&&(j[f]=n,w.push(f)),q(b,C,null)):y?(k=Object(R.c)(10),T(g,{externalId:k,uuid:O,width:d,height:d,noSiz:E}),q(!0,C,{externalId:k})):q(!1,C,null),e.attributes=Object.assign({},e.attributes,{},I)))}),{zoneDelta:e,fileTokenList:w,fileTokenToSuiteMap:j}},q=function(e,t,n){var i,r=t.uuid,o=t.height,a=t.width,s=t.src,c=t.fileToken,l="&uuid=".concat(r,"&pluginName=imageUpload&height=").concat(o,"&width=").concat(a),l="src=".concat(encodeURIComponent(s)).concat(l,"&fileToken=").concat(c),u=e?"clientside-image-uploaded":"image-uploaded";return n&&(i=n.externalId,u="image-previewer",l+="&externalLoading=true&externalId=".concat(i)),j()({},u,l)}},EBUI:function(e,t,n){"use strict";n.d(t,"a",function(){return _});var i=n("lSNA"),a=n.n(i),r=n("J4zp"),f=n.n(r),o=n("lwsE"),s=n.n(o),c=n("W8MJ"),l=n.n(c),u=n("cDf5"),d=n.n(u),p=n("Muja"),h=(n("DdIq"),n("F9bh")),g=n("HmyT"),m=n("DNsP"),v=n("gq0T"),b=n("Zss7"),y=n.n(b),E=n("2ACu"),O=n("y2sV"),C=n("+4eN"),k=n("EDbJ"),I=n("5Ucn"),S=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},T="ignore-pre-highlight",_=function(){function i(e){var h=this,t=e.editor,n=e.adaptor;s()(this,i),this.colorList=Object(v.d)(),this.aceInitialized=function(e){h.regist(e)},this.regist=function(e){e.commands.registerCommand(m.i,function(e,t,n,i){var o=i.source,r=i.button,a=i.value,s=r&&Object(g.$)(r).attr("data-color")||a||"",c=h.adaptor.getHighlightAttributes({colorData:s,source:o},t);c&&(Object(p.default)(h.lastUsedColors,c)?h.sendCollectorData(o,{action:"highlight_default"}):(h.lastUsedColors=c,h.sendCollectorData(o,{action:"highlight_switch_color"})),c.forEach(function(e){var t=f()(e,2),n=t[0],i=t[1];h.toggleAttribute({attribKey:n,attribValue:i});var r=h.getCollectorParams({attribKey:n,attribValue:i});h.sendCollectorData(o,r)}))},{statusKey:"".concat(m.a.BACKGROUND," ").concat(m.a.TEXT)})},this.collectContentPre=function(e,t){var n=t.styl,i=t.state,r=t.node,o=t.tname;h.getColorAttribPairs(n,r,o).forEach(function(e){t.cc.doAttrib(i,e[0],e[1])})},this.UNSAFE_editorNormalizePasteNode=function(e){var t,n,i=e.data.node;i&&(t=Object(g.$)(i).find(".ace-line"),n=Object(g.$)(i).find("span"),Object(v.h)(t.get(0))?t.addClass(T):n.each(function(){if(Object(v.h)(this))return n.addClass(T),!1}))},this.editorWillPaste=function(e){var i=e.deltaSet,r=e.zoneId,t=h.editor.getRep(r);if(!t||!t.selStart)return i;var n=h.editor.getAttributesOnPosition(r,t.selStart[0],t.selStart[1]),u=n.find(function(e){var t=f()(e,2),n=t[0];t[1];return n===m.a.TEXT}),d=n.find(function(e){var t=f()(e,2),n=t[0];t[1];return n===m.a.BACKGROUND});if(!u&&!d)return i;var o=i.get(r);if(!o.ops[0]||!o.ops[0].insert||o.ops[0].insert.startsWith("\n"))return i;i.forEach(function(e){var t,c,l,n;e instanceof O.E&&e.zoneId===r&&(t=!1,e.forEach(function(e){e.attributes&&(e.attributes[m.a.TEXT]||e.attributes[m.a.BACKGROUND]||e.attributes["temp-ignore-color"])&&(t=!0)}),t||(c=u&&h.colorList.has(u[1]),l=d&&h.colorList.has(d[1]),n=e.reduce(function(e,t){var n=t.attributes||{};if(n.lmkr)return e.ops.push(t),e;for(var i=Object.assign({},n),r=t.insert,o="";0<r.length;){var a=r.includes("\n"),s=r.split("\n",1)[0],o=r.substring(s.length+1),r=s;c&&!n[m.a.TEXT]&&(i[m.a.TEXT]=u[1]),l&&!n[m.a.BACKGROUND]&&(i[m.a.BACKGROUND]=d[1]),e.insert(r,i),r=o,a&&e.insertEnter(n)}return e},new O.E({zoneId:e.zoneId})),i.replace(e.zoneId,n)))})},this.acePaste=function(e,t){var n,i,r,o=t.pasteDataWrapper;!o&&t.html&&(o=(new DOMParser).parseFromString(t.html,"text/html").body),o&&(n=Object(g.$)(o).find(".ace-line"),i=Object(g.$)(o).find("span:not(.j-block-container *)"),r=!1,Object(v.h)(n.get(0))?(n.addClass(T),r=!0):i.each(function(){if(Object(v.h)(this))return i.addClass(T),!(r=!0)}),r&&Object(g.$)(o).find("."+I.HYPERLINK_CONTAINER_CLASS).find("span").removeClass(T))},this.aceCreateDomLine=function(e,t){var n,i,r,o,a,s,c=t.spanClass,l=c.includes(m.a.BACKGROUND),u=c.includes(m.a.TEXT);(l||u)&&(Object(v.j)(c)||(n=[m.a.BACKGROUND],u&&!h.isNotAllowTextColor(c)&&n.push(m.a.TEXT),i=Object.values(n).map(function(e){return Object(v.c)(e)}),o=(r=h.getClassAndStyle(c,i)).cls,a=r.extraClass,s=r.style,t.spanClass="".concat(o," ").concat(a.join(" ")),t.attributes=Object.assign({},t.attributes,{style:s.join(" ")})))},t&&(this.editor=t,this.aceInitialized(t),this.adaptor=n)}return l()(i,[{key:"doSupportComposeColor",value:function(){return this.adaptor.doSupportComposeColor()}},{key:"onMount",value:function(e,t){this.adaptor.bindEvent&&this.adaptor.bindEvent(t.editor)}},{key:"reset",value:function(e,t){this.adaptor.destroy&&this.adaptor.destroy(t.editorInfo),this.editor=null}},{key:"getCollectorParams",value:function(e){var t=e.attribKey,n=e.attribValue;if(Object(k.c)(n)){var i=y()(n);return{action:t,color_value:i.toHexString()+" "+i.getAlpha()}}return{action:m.a.CLEAR}}},{key:"aceAttribsToClasses",value:function(e,t){var n=t.key,i=t.value;return Object(k.c)(i)?n===m.a.BACKGROUND?["".concat(m.a.BACKGROUND,":").concat(Object(k.a)(i))]:n===m.a.TEXT?["".concat(m.a.TEXT,":").concat(i)]:[]:[]}},{key:"toggleAttribute",value:function(e){var t=e.attribKey,n=e.attribValue,i=e.range,r=e.isSpecialSelection;e.isAllHasAttrib;if(!i)return!1;var o=this.editor,a=i.selStart,s=i.selEnd,c=i.attributeManager;if(!o||!a||!s)return!1;try{var l=this.getSettingAttribPairs(t,n);return o.isCaret()?this.execCommand(l):(r?c.setAttributesOnRange(a,s,l):this.processNormalSelection(o,l,i),!0)}catch(e){return Object(E.default)("toggle_attribute_failed",{attribute_key:t,attribute_value:n,message:JSON.stringify(e)}),console.info("toggle highlight color failed",e),!1}}},{key:"sendCollectorData",value:function(e,t){Object(E.default)("toggle_attribute",Object.assign({},t,{source:e,zone:Object(C.m)()}))}},{key:"processNormalSelection",value:function(r,e,o){r.inCallStackIfNecessary("toggleHighlight",function(){r.fastIncorp(),e.forEach(function(e){var t=f()(e,2),n=t[0],i=t[1];i?r.toggleAttributeOnSelection(n,o,i):r.setAttributeOnSelection(o.zoneId,n,i,o)})})}},{key:"execCommand",value:function(e){return e.forEach(function(e){var t,n,i=f()(e,2),r=i[0],o=i[1],a=o||m.n[r],s=Object(v.k)();s&&(t=s.background,n=s.text,r===m.a.BACKGROUND&&Object(k.a)(t)===o&&(a=m.n[r]),r===m.a.TEXT&&Object(k.a)(n)===o&&(a=m.n[r])),document.execCommand(m.g[r],!1,a)}),!0}},{key:"getSettingAttribPairs",value:function(e,t){var n=this.doSupportComposeColor();switch(e){case m.a.BACKGROUND:return[[m.a.BACKGROUND,t]].concat(n?[]:[[m.a.TEXT,""]]);case m.a.TEXT:return[[m.a.TEXT,t]].concat(n?[]:[[m.a.BACKGROUND,""]]);case m.a.CLEAR:return[[m.a.BACKGROUND,""],[m.a.TEXT,""]];default:throw new RangeError("invalid attribute key: ".concat(e))}}},{key:"getColorAttribPairs",value:function(e,t,s){var n,i,c=this,l=3<arguments.length&&void 0!==arguments[3]&&arguments[3],u=[];return"font"!==s||(n=t.getAttribute("color"))&&(i=Object(k.a)(n),u.push([m.a.TEXT,i])),t.className.includes(T)&&(u.push([m.a.TEXT,""]),u.push([m.a.BACKGROUND,""])),e&&e.split(";").forEach(function(t){t=Object(v.b)(t);var e,n,i,r,o,a=Object.entries(m.p).find(function(e){return 0===t.indexOf(e[1])});a&&(n=(e=f()(a,2))[0],"color"!==(i=e[1])||"a"!==s?(r=Object(v.c)(i).exec(t))&&(o=Object(k.a)(r[3]),c.colorList.has(o)?u.push([n,o]):l&&u.push(["temp-ignore-color","true"])):l&&u.push(["temp-ignore-color","true"]))}),u}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,o=e.zoneId;if(t instanceof HTMLElement){var i=t.tagName,r=t.getAttribute("style");return this.getColorAttribPairs(r,t,i.toLowerCase(),!0).filter(function(e){var t=f()(e,2);t[0];return!!t[1]}).reduce(function(e,t){var n=f()(t,2),i=n[0],r=n[1];return Object(O.H)(e,o,a()({},i,String(r)))},n)}return n}},{key:"serialize",value:function(e){var t=e.type,n=e.node,i=e.op;if(i&&i.attributes){var r=i.attributes[m.a.TEXT],o=i.attributes[m.a.BACKGROUND];if(t===O.u.LEAF&&(r||o)){var a=document.createElement("span");return a.appendChild(n),a.style[m.p[m.a.TEXT]]=r,a.style[m.p[m.a.BACKGROUND]]=o,Object.assign(e,{node:a})}}return e}},{key:"editorWillApplyChange",value:function(e){return e.deltaSet.forEach(function(e){e instanceof O.E&&e.forEach(function(e){e.attributes&&e.attributes["temp-ignore-color"]&&delete e.attributes["temp-ignore-color"]})}),e.deltaSet}},{key:"isNotAllowTextColor",value:function(e){return["url","mention"].some(function(t){return e.split(" ").some(function(e){return e.startsWith(t)})})}},{key:"match",value:function(e){return e===m.a.BACKGROUND||e===m.a.TEXT}},{key:"render",value:function(e){var t=e.attributes,n=e.children,i={},r=[];return Object(v.a)(t)||(t[m.a.BACKGROUND]&&this.handleClassAndStyle(m.a.BACKGROUND,t[m.a.BACKGROUND],r,i),t[m.a.TEXT]&&this.handleClassAndStyle(m.a.TEXT,t[m.a.TEXT],r,i),e.class="".concat(e.class," ").concat(r.join(" ")),e.style=Object.assign({},e.style,{},i)),n}},{key:"handleClassAndStyle",value:function(e,t,n,i){var r;Object(k.c)(t)&&(r=Object(k.a)(t),i[m.p[e]]=r,n.push("".concat(m.p[e],"-").concat(r)),e===m.a.BACKGROUND&&n.push(m.c))}},{key:"getClassAndStyle",value:function(e,t){var o=[],a=[],n=e;return t.forEach(function(e){n=n.replace(e,function(e,t,n,i){var r=m.p[n]+":"+i+";";return o.push(r),n===m.a.BACKGROUND&&a.push(m.c),a.push(m.p[n]+"-"+i),""})}),{cls:n,extraClass:a,style:o}}},{key:"aceSelectionChanged",value:function(){this.adaptor.handleSelectionChanged&&this.adaptor.handleSelectionChanged()}}]),i}();S([Object(h.a)()],_.prototype,"toggleAttribute",null),t.b=_},EEMT:function(e,t,n){"use strict";var i=n("o0o1"),a=n.n(i),r=n("yXPU"),o=n.n(r),s=n("lSNA"),c=n.n(s),l=n("lwsE"),u=n.n(l),d=n("W8MJ"),h=n.n(d),f=n("a1gu"),p=n.n(f),g=n("Nsbk"),m=n.n(g),v=n("7W2i"),b=n.n(v),y=n("Poi8"),E=n("PmjA"),O=n("7Kxq"),C=n("YWBl"),k=n("kESg"),I=n("PcuH"),S=n("Zda9"),T=new(function(e){function t(){var e;return u()(this,t),(e=p()(this,m()(t).apply(this,arguments))).zoneType=k.l.CodeBlock,e}function n(e,t,n){return i.apply(this,arguments)}var i;return b()(t,e),h()(t,[{key:"getZoneId",value:function(e,t,n){return Object(y.f)(e,t,n)}},{key:"getDefaultZoneAttrs",value:function(e){var t=(e||{}).lang,n=void 0===t?"":t,i=Object(y.k)(n),r={};return c()(r,E.f,i),c()(r,E.g,String(!!n)),c()(r,E.h,String(Object(S.e)())),r}},{key:"getZoneAttrsByZoneId",value:function(e,t){var n={};return c()(n,E.f,Object(y.m)(e,t)),c()(n,E.g,Object(y.l)(e,t)),c()(n,E.h,String(Object(y.n)(e,t))),n}},{key:"isUnsupportLine",value:function(e,t){return Object(y.o)(e,t)}},{key:"convertRangeToCodeBlock",value:function(e,t,n,i){this.convertRangeToZone(e,t,n,{lang:i})}},{key:"convertToCodeBlock",value:(i=o()(a.a.mark(function e(t,n,i){var r,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.plugins.codeBlockV2,e.next=3,r.loading();case 3:o=this.convertToZone(t,n,i),Object(C.a)({action:E.a,op:o?O.g:O.f,source:n});case 5:case"end":return e.stop()}},e,this)})),n)}]),t}(I.a));I.a.registerTransformer(k.l.CodeBlock,T),t.a=T},EIW1:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),l=n("HmyT"),s=n("YNKm"),b=n("nVH4"),y=n("YH+F"),c=n("FJEn"),u=(n("1cTk"),n("y2sV")),d=n("jp/M"),h=c.utils.isFakeNode,f=c.utils.nodeText,E=[b.c.LEFT,b.c.RIGHT],p="template-inline",g=function(){function t(e){var v=this;r()(this,t),this.regist=function(e){e.registerAceCommand(s.TEMPLATEINLINE,function(e,t){t.doInsertTemplate()},{statusKey:null})},this.handleMouseDownOnMagicDom=function(e){var t,n,i,r,o,a,s=Object(l.$)(e.currentTarget),c=s.find(".template-inline");0<c.length&&(t=c.get(0),n=c.offset().left+t.offsetWidth,i=t.offsetHeight,e.clientX<n&&e.offsetY<i&&(e.preventDefault(),r=s.index(),o=v._editorInfo.getRep(),a=f(t),v._editorInfo.selection.setWithSelection(o.zoneId,[r,a.length+o.lines.atIndex(r).lineMarker],[r,a.length+o.lines.atIndex(r).lineMarker],!1),v._editorInfo.updateBrowserSelectionFromRep()))},this.aceKeyEvent=function(e,t){if(!v.isTemplate)return!1;var n=t.evt,i=t.editorInfo,r=t.isTypeForSpecialKey,o=n.keyCode,a=n.type,s=i.getFastSelection(),c=s.selStart,l=s.selEnd,u=s.selZone,d=c[0]===l[0]&&c[1]===l[1],h=i.getReps()[u];if("keydown"===a&&d&&h.lines.isStartOfLine(c[0],c[1])){var f=c[0],p=h.lines.atIndex(f),g=i.getAttributesOnSelection(h.zoneId,{selStart:[c[0],p.lineMarker],selEnd:[c[0],p.text.length]});if(Object(y.a)(g.attribsKey,"template-inline"))return n.preventDefault(),!0}if(o===b.c.BACKSPACE&&"keydown"===a&&r)return v.doDeleteKey(n);if(-1<E.indexOf(o)&&"keydown"===a&&r){var m=i.getFastSelection();return v.getNextPosition(m,o).ctr?(n.preventDefault(),!0):!1}},this.getNextPosition=function(e,t){var n={ctr:!1,point:null},i=v._editorInfo.getReps()[e.selZone],r=1,o=e.selEnd;if(t===b.c.LEFT&&(r=-1,o=e.selStart,i.lines.isStartOfLine(o[0],o[1])))return n;if(t===b.c.RIGHT&&i.lines.isEndOfLine(o[0],o[1]))return n;var a=o[1]+r,s=o[0],c=i.lines.atIndex(s);a<c.lineMarker?a=0===s?c.lineMarker:(--s,i.lines.atIndex(s).text.length):a>c.text.length&&(a=s===i.lines.length()-1?c.text.length:(s+=1,i.lines.atIndex(s).lineMarker));var l=[s,a];if(!v._editorInfo.getAttributesOnPosition(i.zoneId,l[0],l[1]).some(function(e){return e[0]===p}))return n;var u=v._editorInfo.getPointForLineAndChar(l),d=f(u.node).length;if(!d)return n;var h=1===r?d:-d;return{ctr:!0,point:[s,a=o[1]+h]}},this.doDeleteKey=function(e){var t=v._editorInfo;if(!t.selection.isCaret())return!1;var n=t.getRep();if(n.lines.isStartOfLine(n.selStart[0],n.selStart[1]))return!1;var i=[n.selStart[0],n.selStart[1]-1],r=t.getPointForLineAndChar(i);return!!h(r.node)&&(!!f(r.node).length&&(e.preventDefault(),!0))},this.aceAttribsToClasses=function(e,t){if(t.key===p)return v.isTemplate=!0,p},this.reset=function(){v.removeEvent()},this._editorInfo=null,e&&this.aceInitialized("",Object.assign({editorInfo:e},e))}return a()(t,[{key:"aceInitialized",value:function(e,t){var n=t.editorInfo.getClientVars();this.isTemplate=n&&n.is_template,this.isTemplate&&this.bindEvent(),this._editorInfo=t.editorInfo,this._editorInfo.doInsertTemplate=this.doInsertTemplate,this.regist(this._editorInfo)}},{key:"bindEvent",value:function(){Object(l.$)("#innerdocbody").delegate('div[id^="magicdomid"]',"mousedown",this.handleMouseDownOnMagicDom)}},{key:"removeEvent",value:function(){Object(l.$)("#innerdocbody").undelegate('div[id^="magicdomid"]',"mousedown",this.handleMouseDownOnMagicDom)}},{key:"aceCreateDomLine",value:function(e,t){var n,i,r=t.spanClass,o=t.text;-1<r.indexOf(p)&&(n="".concat(d.FAKETEXT_PREFIX,'<span contenteditable="false" data-faketext="').concat(o,'" class="template-inline-context">'),i="</span>".concat(d.FAKETEXT_SUFFIX),t.extraOpenTags="".concat(t.extraOpenTags).concat(n),t.extraCloseTags="".concat(i).concat(t.extraCloseTags))}},{key:"doInsertTemplate",value:function(){var e=this._editorInfo.selection.getZone();this._editorInfo.setAttributeOnSelection(e,p,"true")}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;return t instanceof HTMLElement&&-1<t.className.indexOf("template-inline-context")?Object(u.H)(n,i,{"template-inline":"true"}):n}}]),t}();new g},EMUX:function(e,v,b){"use strict";(function(n){var e=b("lwsE"),i=b.n(e),t=b("W8MJ"),r=b.n(t),o=b("a1gu"),a=b.n(o),s=b("Nsbk"),c=b.n(s),l=b("7W2i"),u=b.n(l),d=b("q1tI"),h=b.n(d),f=b("OX8E"),p=b("sLU5"),g=b("n/R6"),m=function(e){function t(){var e;return i()(this,t),(e=a()(this,c()(t).apply(this,arguments))).onClick=function(e){g.a.remove("history"),f.a.emit(p.a.PC.DOCS.HISTORY.TOGGLE,e,"undo_toast")},e}return u()(t,e),r()(t,[{key:"render",value:function(){return h.a.createElement("div",null,n("history.undo_toast_content"),h.a.createElement("a",{className:"history-undo-toast-entry",onClick:this.onClick},n("common.see_history_lowercase")))}}]),t}(h.a.Component);v.a=h.a.createElement(m,null)}).call(this,b("2vAP"))},EOrr:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("ALb8"),c=function(){function t(e){r()(this,t),this.emit=e}return a()(t,[{key:"destroy",value:function(){this.emit=null}},{key:"on",value:function(e,t){this.emit.on(e,t)}},{key:"off",value:function(e,t){this.emit.off(e,t)}},{key:"trigger",value:function(e,t){this.emit.trigger(e,t)}},{key:"onGenerateBlock",value:function(e){this.on(s.g,e)}},{key:"offGenerateBlock",value:function(e){this.off(s.g,e)}},{key:"generateBlock",value:function(e,t){this.trigger(s.g,[e,t])}},{key:"onSetReminderProps",value:function(e){this.on(s.j,e)}},{key:"offSetReminderProps",value:function(e){this.off(s.j,e)}},{key:"setReminderProps",value:function(e,t){this.trigger(s.j,[e,t])}},{key:"onPropsChange",value:function(e){this.on(s.k,e)}},{key:"offPropsChange",value:function(e){this.off(s.k,e)}},{key:"propsChange",value:function(e,t){this.trigger(s.k,[e,t])}},{key:"onClick",value:function(e){this.on(s.e,e)}},{key:"offClick",value:function(e){this.off(s.e,e)}},{key:"click",value:function(e,t,n){this.trigger(s.e,[e,t,n])}},{key:"onMouseEnter",value:function(e){this.on(s.h,e)}},{key:"offMouseEnter",value:function(e){this.off(s.h,e)}},{key:"mouseEnter",value:function(e,t,n){this.trigger(s.h,[e,t,n])}},{key:"onMouseLeave",value:function(e){this.on(s.i,e)}},{key:"offMouseLeave",value:function(e){this.off(s.i,e)}},{key:"mouseLeave",value:function(e,t){this.trigger(s.i,[e,t])}},{key:"onReminderDelete",value:function(e){this.on(s.f,e)}},{key:"offReminderDelete",value:function(e){this.off(s.f,e)}},{key:"reminderDelete",value:function(e){this.trigger(s.f,[e])}}]),t}()},EOxA:function(e,t,n){"use strict";var i,r,o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("HmyT"),u=n("J4zp"),y=n.n(u),d=n("MXQz"),h=n("fujP"),f=n("U+yc"),p=n.n(f),g=(n("qSBL"),n("8dyR")),L=n("8Reb"),m=n("OvDQ"),v=n("vE74"),b=n("iP/4"),E=n("Ngi8"),R=n("H6oK"),O=n("lIbB"),N=n("Poi8"),C=n("y2sV"),D=n("zTCG"),x=b.a.isEdge||b.a.modernIE?I:k,P=30,B=60;function k(e,t){if(e.top<t.height)return e;var n=e.height/2-6;return e.top=Math.ceil(e.top-n),e.height=e.height+n,e}function I(e,t){return e}var S={None:0,FromStart:1,ToEnd:2,Whole:3},T=Object(d.a)(function(){return Object(l.$)(Object(v.j)('\n    <div class="ep-row">\n      <div class="ep-row__head"></div>\n      <div class="ep-row__body"></div>\n      <div class="ep-row__tail"></div>\n    </div>\n  '))[0]}),_=(i=Object(g.b)({leading:!1}),r=function(){function n(e){a()(this,n),this._context=e;var t=T().cloneNode(!0);this._root=Object(l.$)(t),this._head=Object(l.$)(t.querySelector(".ep-row__head")),this._body=Object(l.$)(t.querySelector(".ep-row__body")),this._tail=Object(l.$)(t.querySelector(".ep-row__tail")),this._parent=null,this.mountManager=new m.a(this)}return c()(n,[{key:"draw",value:function(e){(e||this._drawInvalid)&&(new L.a(this._root.children()).css("background-color",this._color||"".concat(E.B200)),this._drawInvalid=!1)}},{key:"layout",value:function(){if(this.mountManager.mountIfNeeded()){var e=this._row,t=this.zone,n=this._context.editorInfo,i=n.getRep(t),r=i.lines.atIndex(e);if(r){var o=this.startColumn,a=this.endColumn;this.fromStart()&&(o=r.lineMarker),this.toEnd()&&(a=r.text.length),o=Math.max(o,r.lineMarker);var s=new L.a(this._root),c=new L.a(this._head),l=new L.a(this._body),u=new L.a(this._tail);if(a<=o)s.hide();else{var d,h,f,p,g,m,v,b,y,E,O,C,k=r.isFullWidth,I=r.getCharRect(0),S=x(r.getCharRect(o,!1,t),I),T=x(r.getCharRect(a-1,!0,t),I),_=r.getLineRect(t);k?(d=r.fullWidthNode,h=r.lineNode.parentNode.getBoundingClientRect(),d.classList.contains(R.BLOCK_PLACEHOLDER)?(p=(f=n.plugins.blockPlugin).tryGetBlockIdForNode(r.fullWidthNode),g=f.getBlockInfo(p).instance.leftOffset,m=d.style.width,v=parseInt(m)-g,S.left=-(h.left-g-P)):(b=d.getBoundingClientRect(),y=d.parentNode.getBoundingClientRect(),E=b.left,O=y.right,C=E<B?h.left-B:h.left-E,S.left=-(C+20),v=E<B?O-B:O-E)):(v=new L.a([r.lineNode.parentNode]).width(),this._fixRect(n,i,e,r,_,S,T));var w,j=_.top;if(Object(N.i)(n,t)&&(j-=(w=this._root.parent()[0])&&w.offsetTop-D.c||0),s.css("top",j).css("padding-left",_.left).css("max-width",v+20).show(),c.css("height",S.height).css("margin-top",S.top).css("margin-left",S.left),T.top-S.top<.1*S.height)return k?c.css("width",v):c.css("width",T.left-S.left),u.hide(),void l.hide();c.css("width","auto"),u.css("width",T.left).css("height",T.height);var M=T.top-S.top-S.height;if(M<=6)return u.css("height",T.height+M).show(),void l.hide();u.show(),l.css("height",M).show()}}}}},{key:"_fixRect",value:function(e,t,n,i,r,o,a){var s,c=t.attributeManager.findAttributeOnLine(n,"list");if(c&&"number"===c.replace(/\d{1,}$/,"")){var l=i.lineNode.querySelector("li");if(l){var u=Number.parseInt(window.getComputedStyle(l).paddingLeft,10)+l.getBoundingClientRect().left-Object(O.b)(e,t.zoneId).left,d=r.left-u;return r.left-=d,o.left+=d,void(a.left+=d)}}Boolean(t.attributeManager.findAttributeOnLine(n,"text-indent"))&&(s=Number.parseInt(window.getComputedStyle(i.lineNode).textIndent,10),r.left-=s,o.left+=s,a.left+=s);var h,f=i.lineMarker;Object(O.e)()&&Object(O.c)(t,n,f)&&(h=Object(O.a)(e,i,f),r.left-=h,o.left+=h,a.left+=h);var p,g,m=!e.version.includes(C.y),v=this.endColumn===i.text.length||this.toEnd();m&&v&&Object(O.d)(e,t,n,i)&&(g=(p=i.lineNode.querySelectorAll("span.".concat(R.INLINE_BLOCK_PLACEHOLDER)))&&p[p.length-1].getBoundingClientRect().width,a.left+=g)}},{key:"setRow",value:function(e){this._row!==e&&(this._row=e,this._root.attr("data-line-number",e))}},{key:"setType",value:function(e){this.type!==e&&(this.type=e)}},{key:"setZone",value:function(e){this.zone!==e&&(this.zone=e)}},{key:"setColor",value:function(e){this._color!==e&&(this._color=e,this._drawInvalid=!0)}},{key:"fromStart",value:function(){return!!(this.type&S.FromStart)}},{key:"toEnd",value:function(){return!!(this.type&S.ToEnd)}},{key:"setStartColumn",value:function(e){this.startColumn=e}},{key:"setEndColumn",value:function(e){this.endColumn=e}},{key:"hide",value:function(){new L.a(this._root).hide()}},{key:"show",value:function(){new L.a(this._root).show()}},{key:"isRowMounted",value:function(){return-1!==this._row&&this._context.isRowMounted(this.zone,this._row)}},{key:"shouldMount",value:function(){return this.isRowMounted()}},{key:"attach",value:function(e){this._parent!==e&&(this.mountManager.unmountIfNeeded(),this._parent=e,this.mountManager.mountIfNeeded())}},{key:"mountImpl",value:function(){var e=this;if(this._parent)return this._parent._root.append(this._root),function(){e._root.remove()}}},{key:"detach",value:function(){this.mountManager.unmountIfNeeded(),this._parent=null}}]),n}(),p()(r.prototype,"layout",[i],Object.getOwnPropertyDescriptor(r.prototype,"layout"),r.prototype),r),w=n("TRZa"),j=Object(d.a)(function(){return Object(l.$)(Object(v.j)('<div class="ep-range" style="pointer-events: none"></div>'))[0]}),M=function(){function t(e){a()(this,t),this._context=e,this._root=Object(l.$)(j().cloneNode()),this._rows={}}return c()(t,[{key:"draw",value:function(e){if(e||this._drawInvalid){var t,n=this._rows;for(t in n){var i=n[t];i.setColor(this._color),i.draw(e)}this._drawInvalid=!1}}},{key:"layout",value:function(e){if(e||this._layoutInvalid){if(this._layoutInvalid=!1,!Object(w.e)(this._range))return this.clearRows(),this._empty=!0,void(this._listeners&&this._listeners.onRangeEmpty&&this._listeners.onRangeEmpty(this._root.attr("data-id")));var t,n=this._range,i=n.selStart,r=n.selEnd,o=n.selZone,a=this._context.editorInfo.getReps()[o];a&&(t=a.lines,this._chars=[t.offsetOfPoint(i[0],i[1]),t.offsetOfPoint(r[0],r[1])],this._empty=!1,this._updateRows(e))}}},{key:"setId",value:function(e){this._root.attr("data-id",e)}},{key:"setRange",value:function(e){Object(w.d)(this._range,e)||(this._range=e,this._layoutInvalid=!0)}},{key:"setColor",value:function(e){this._color!==e&&(this._color=e,this._drawInvalid=!0)}},{key:"setListeners",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._listeners=e}},{key:"addClasses",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];Object(h.default)(e)||this._root.addClass(e.join(" "))}},{key:"removeClasses",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];Object(h.default)(e)||this._root.removeClass(e.join(" "))}},{key:"applyChangeset",value:function(e){var t=this._range&&this._range.selZone,n=this._context.editorInfo.changesetHelper;if(!this._empty&&t){var i,r=n.formatCs(e);for(i in r){var o,a,s,c=r[i],l=this._chars,u=this._context.editorInfo,d=n.characterRangeFollow(c,l[0],l[1]),h=y()(d,2),f=h[0],p=h[1];f===p?(o=u.selection.lineAndColumnFromChar(t,p),this.setRange({selStart:o,selEnd:o,selZone:t})):(f=n.characterRangeFollow(c,l[0],l[0]),p=n.characterRangeFollow(c,l[1],l[1],!0),a=u.selection.lineAndColumnFromChar(t,f[0]),s=u.selection.lineAndColumnFromChar(t,p[0]),this.setRange({selStart:a,selEnd:s,selZone:t})),this.layout(!0)}}}},{key:"_updateRows",value:function(e){for(var t,n,i=this._range,r=this._rows,o=this._context,a={},s=i.selStart,c=i.selEnd,l=i.selZone,u=y()(s,2),d=u[0],h=u[1],f=y()(c,2),p=f[0],g=f[1],m=d;m<=p;m++){var v=r[m]||new _(o);(a[m]=v).setZone(l),v.setRow(m),v.setColor(this._color),m!==d&&m!==p?v.setType(S.Whole):m===d&&m===p?(v.setType(S.None),v.setStartColumn(h),v.setEndColumn(g)):m===d?(v.setType(S.ToEnd),v.setStartColumn(h)):(v.setType(S.FromStart),v.setEndColumn(g)),v.attach(this)}for(t in r)r[t]&&!a[t]&&r[t].detach();for(n in this._rows=a){var b=a[n];b.layout(e),b.draw()}}},{key:"clearRows",value:function(){var e,t=this._rows;for(e in t)t[e].detach();this._rows=[]}},{key:"attach",value:function(e){e._root.append(this._root)}},{key:"detach",value:function(){this.clearRows(),this._root.remove()}}]),t}(),U=n("fp5s"),z=n("OX8E"),H=n("sLU5"),F=n("GGin");n.d(t,"a",function(){return V});var V=function(){function i(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};a()(this,i),this._context=e,this._ranges={},this._options={useDefaultLayoutStrategy:!0,className:""},this.updateLayout=function(){Object.values(t._ranges).forEach(function(e){return e&&e.layout(!0)})},this._options=Object.assign({},this._options,{},n),this._root=Object(l.$)('<div class="ep-range-group '.concat(this._options.className,'"></div>'))}return c()(i,[{key:"_nextRangeId",value:function(){return Object(U.a)()}},{key:"bindEvents",value:function(){z.a.on(F.d,this.updateLayout),z.a.on(H.a.PC.DOCS.SECTION_NAV.ON_LINE_ENTRY_CHANGE,this.updateLayout),z.a.on("blockPositionUpdate",this.updateLayout)}},{key:"removeEvents",value:function(){z.a.off(F.d,this.updateLayout),z.a.off(H.a.PC.DOCS.SECTION_NAV.ON_LINE_ENTRY_CHANGE,this.updateLayout),z.a.off("blockPositionUpdate",this.updateLayout)}},{key:"attach",value:function(e){e.append(this._root),this.bindEvents()}},{key:"addRange",value:function(e,t,n,i,r){if(Object(w.b)(e))return null;var o=new M(this._context);return n=n||this._nextRangeId(),o.setId(n),o.setRange(e),o.setColor(t),o.setListeners(i),o.addClasses(r),(this._ranges[n]=o).layout(),o.draw(),o.attach(this),n}},{key:"updateRange",value:function(e,t,n,i){var r;null==e||(r=this._ranges[e])&&(t&&r.setRange(t),void 0!==n&&r.setColor(n),void 0!==i&&(0<i.toRemove.length&&r.removeClasses(i.toRemove),0<i.toAdd.length&&r.addClasses(i.toAdd)),r.layout(),r.draw())}},{key:"applyChangeset",value:function(e){if(this._options.useDefaultLayoutStrategy){var t,n=this._ranges;for(t in n){var i=n[t];i&&i.applyChangeset(e)}}}},{key:"getRange",value:function(e){return this._ranges[e]}},{key:"getAllRangeIds",value:function(){return Object.keys(this._ranges)}},{key:"hasRange",value:function(e){return!!this._ranges[e]}},{key:"removeRange",value:function(e){var t;null==e||(t=this._ranges[e])&&(delete this._ranges[e],t.detach())}},{key:"layout",value:function(e){if(this._options.useDefaultLayoutStrategy){var t,n=this._ranges;for(t in n){var i=n[t];i&&i.layout(e)}}}},{key:"setOptions",value:function(e){this._options=e}},{key:"detach",value:function(){this.removeEvents(),this._ranges={},this._root.remove(),this._root=Object(l.$)('<div class="ep-range-group '.concat(this._options.className,'"></div>'))}}]),i}()},EbIy:function(e,L,R){"use strict";R.r(L),function(e){R.d(L,"IframePopup",function(){return j});var t=R("lwsE"),n=R.n(t),i=R("W8MJ"),r=R.n(i),a=R("HmyT"),l=R("2ACu"),o=(R("vpf3"),R("TS0X")),s=R.n(o),c=R("dXj0"),u=R.n(c),d=R("ScS1"),h=R.n(d),f=R("e+wO"),p=R.n(f),g=R("LEGm"),m=R.n(g),v=R("gt4j"),b=R.n(v),y=R("aBgF"),E=R("SGN9"),O=R("G8Hj"),C="iframe-confirm-popup",k=".".concat(C,"__item"),I="."+C,S=".doc-popup-container",T=140,_=40,w='<div class="'.concat(C," ").concat(C,'--hidden" tabindex=-1>\n    <div class="').concat(C,'__header">').concat(e("CreationDoc_Docs_WebBookmark_DisplayAs_Title"),'</div>\n    <div class="').concat(C,'__content">\n      <div class="').concat(C,"__item ").concat(C,'__doc">').concat(e("iframe.insert_title"),'</div>\n      <div class="').concat(C,"__item ").concat(C,'__title">\n        <img src="').concat(u.a,'">\n        ').concat(e("CreationDoc_Docs_WebBookmark_DisplayAs_Title_Button"),'\n      </div>\n      <div class="').concat(C,"__item ").concat(C,'__bookmark">\n        <img src="').concat(s.a,'">\n        ').concat(e("CreationDoc_Docs_WebBookmark_DisplayAs_Bookmark_Button"),'\n      </div>\n      <div class="').concat(C,"__item ").concat(C,'__iframe">\n        <img src="').concat(h.a,'">\n        ').concat(e("CreationDoc_Docs_WebBookmark_DisplayAs_Embed_Button"),'\n      </div>\n      <div class="').concat(C,"__item ").concat(C,'__data">\n        <img src="').concat(m.a,'">\n        ').concat(e("doc.a-panel.bitable.single-product"),'\n      </div>\n      <div class="').concat(C,"__item ").concat(C,'__url">\n        <img src="').concat(p.a,'">\n        ').concat(e("CreationDoc_Docs_WebBookmark_DisplayAs_Link_Button"),'\n      </div>\n      <div class="').concat(C,"__item ").concat(C,'__code">\n        <img src="').concat(b.a,'">\n        ').concat(e("iframe.insert_as_code"),"\n      </div>\n    </div>\n</div>\n"),j=function(){function e(){var i=this;n()(this,e),this.showing=!1,this.referenceCount=0,this.hide=function(){Object(E.a)(O.STEP_TYPES.doc_smartlink_paste_title,O.STEP_TYPES.doc_smartlink_paste_bookmark),i.unbindEvents(),i.showing=!1,i.popup.addClass(C+"--hidden"),i.shownItems&&i.shownItems.removeClass("active"),i.logParam=null,i.activeItem=null,i.shownItems=null,i.hideCallback&&i.hideCallback()},this.handleClick=function(e){var t=e.target,n=Object(a.$)(t).closest(k);i.handleConfirm(n)},this.handleMouseEnter=function(){i.activeItem&&i.activeItem.removeClass("active")},this.handleClickOutside=function(e){var t=e.target;Object(a.$)(t).closest(".callout-smartlink").length||i.hide()},this.handleKeyDown=function(e){switch(e.keyCode){case y.c.Down:i.preventAndStopEvent(e),i.switchActiveItem("down");break;case y.c.Up:i.preventAndStopEvent(e),i.switchActiveItem("up");break;case y.c.Enter:i.preventAndStopEvent(e),i.handleConfirm(i.activeItem);break;default:i.hide()}}}return r()(e,[{key:"init",value:function(e){this.referenceCount++,Object(a.$)(I).length||(this.container=Object(a.$)(S),this.editorInfo=e,Object(a.$)(w).appendTo(this.container),this.popup=Object(a.$)(I),this.eventBinding("on"),this.listItems={doc:this.popup.find(".".concat(C,"__doc")),iframe:this.popup.find(".".concat(C,"__iframe")),data:this.popup.find(".".concat(C,"__data")),url:this.popup.find(".".concat(C,"__url")),code:this.popup.find(".".concat(C,"__code")),title:this.popup.find(".".concat(C,"__title")),bookmark:this.popup.find(".".concat(C,"__bookmark"))})}},{key:"destroy",value:function(){this.referenceCount--,0===this.referenceCount&&(this.unbindEvents(),this.eventBinding("off"),delete this.container,delete this.popup,delete this.listItems,delete this.hideCallback,delete this.editorInfo,this.activeItem=null,this.shownItems=null)}},{key:"eventBinding",value:function(e){this.popup[e]("click",this.handleClick),this.popup[e]("mouseenter",this.handleMouseEnter)}},{key:"isShowing",value:function(){return this.showing}},{key:"computePosition",value:function(e,t){var n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=this.editorInfo.docbody.offsetWidth-_-n.width,o=T<r?0:T-r,a=n.left+n.width-i.left-o;return-T<a&&(a=-T),{top:n.top+n.height-i.top,left:a}}},{key:"update",value:function(e){var t=this.computePosition(e,this.container[0]),n=t.top,i=t.left;this.popup.css({top:"".concat(n,"px"),left:"".concat(i,"px")})}},{key:"show",value:function(e,t,n,i){var r=this;this.logParam=i,this.hideCallback=n,this.handlers=t;var o,a=e instanceof HTMLElement?r.computePosition(e,r.container[0]):e,s=a.top,c=a.left;this.popup&&(this.popup.css({top:"".concat(s,"px"),left:"".concat(c,"px")}),this.showing=!0,o=C+"--hidden",Object.keys(this.listItems).forEach(function(e){r.handlers[e]?r.popup.find(".".concat(C,"__").concat(e)).removeClass(o):r.popup.find(".".concat(C,"__").concat(e)).addClass(o)}),this.shownItems=this.popup.find("".concat(k,":not(.").concat(o,")")),this.activeItem=this.shownItems.first().addClass("active"),this.popup.removeClass(o),this.bindEvents(),Object(l.default)("show_paste_panel",{url_parse_type:this.logParam.url_parse_type||"default_parse",waiting_time:Date.now()-this.logParam.startTime,option_num:Object.keys(this.handlers).length}),Object(E.b)(O.STEP_TYPES.doc_smartlink_paste_title,O.STEP_TYPES.doc_smartlink_paste_bookmark))}},{key:"switchActiveItem",value:function(e){var t,n,i,r,o;this.shownItems&&this.activeItem&&(n=(t="up"===e)?-1:1,i=this.shownItems.index(this.activeItem),this.activeItem.removeClass("active"),r=i+n,o=this.shownItems.length-1,t&&r<0&&(r=o),!t&&o<r&&(r=0),this.activeItem=Object(a.$)(this.shownItems[r]).addClass("active"))}},{key:"handleConfirm",value:function(n){var i=this;if(!n)return this.hide();n.hasClass("".concat(C,"__url"))?(this.logParam&&Object(l.default)("click_paste_panel",{url_parse_type:this.logParam.url_parse_type,option_name:"link"}),Object(l.default)("click_insert_link")):n.length&&Object.keys(this.handlers).forEach(function(e){var t;!n.hasClass("".concat(C,"__").concat(e))||"function"==typeof(t=i.handlers[e])&&t()}),this.hide()}},{key:"preventAndStopEvent",value:function(e){e.preventDefault(),e.stopImmediatePropagation()}},{key:"bindEvents",value:function(){Object(a.$)(window).on("click",this.handleClickOutside),window.addEventListener("keydown",this.handleKeyDown,!0)}},{key:"unbindEvents",value:function(){Object(a.$)(window).off("click",this.handleClickOutside),window.removeEventListener("keydown",this.handleKeyDown,!0)}}]),e}(),M=new j;L.default=M}.call(this,R("2vAP"))},EdOg:function(e,t,n){"use strict";n.r(t);var i,r,o,a,s=n("ANjH"),c=n("lSNA"),l=n.n(c),u=n("6SzI"),d=n("b9hN"),h=Object(u.handleActions)((i={},l()(i,d.a.FETCH_CLIENT_VARS_SUCCESS,function(e,t){return t.payload||e}),l()(i,d.a.RESET_CLIENT_VARS,function(e,t){return null}),l()(i,d.a.SET_CLIENT_VARS,function(e,t){return t.payload||e}),l()(i,d.a.CHANGE_TOKEN,function(e,t){if(t.payload&&e){var n=t.payload;return Object.assign({},e,{token:n})}return e}),i),null),f=Object(u.handleActions)((r={},l()(r,d.a.SET_EDITOR,function(e,t){return t.payload}),l()(r,d.a.DESTROY_EDITOR,function(e,t){return null}),r),null),p=Object(u.handleActions)((o={},l()(o,d.a.SET_TITLE_BLANK,function(e,t){return t.payload}),l()(o,d.a.SET_TITLE_AND_BODY_BLANK,function(e,t){var n=t.payload.title;return void 0===n?e:n}),o),!1),g=Object(u.handleActions)((a={},l()(a,d.a.SET_BODY_BLANK,function(e,t){return t.payload}),l()(a,d.a.SET_TITLE_AND_BODY_BLANK,function(e,t){var n=t.payload.body;return void 0===n?e:n}),a),!1),m=Object(u.handleActions)(l()({},d.a.TOGGLE_FULLSCREEN,function(e,t){return t.payload}),!1),v=Object(u.handleActions)(l()({},d.a.SET_RENDERED,function(e,t){return t.payload}),!1),b=Object(s.combineReducers)({clientVars:h,editor:f,isTitleBlank:p,isBodyBlank:g,isFullscreenMode:m,isDocRendered:v}),y=n("hLHa");function E(){return{id:"doc",reducerMap:{doc:Object(s.combineReducers)({etherpad:b,jira:y.a})}}}n.d(t,"getDocModule",function(){return E})},Ehz1:function(e,E,O){"use strict";(function(o){O.d(E,"c",function(){return f}),O.d(E,"b",function(){return p}),O.d(E,"a",function(){return b}),O.d(E,"d",function(){return y});var c=O("D7h9"),e=O("rLED"),t=O("skFV"),n=O("toa8"),a=O("2ACu"),i=O("9La2"),s=O("n/R6"),l=O("VIFs"),u=O("jp/M"),d=O("5cZX"),r=function(a){var s=f();return c.default.subscribe(function(){var e,t=a.plugins.grammarChecker,n=c.default.getState(),i=1===n.appState.userSettings.get("lang_correction_perm"),r=Object(d.c)(n),o=i&&r;t&&(t.setAbleToCheck(o),(e=h(o))!==s&&(s=e,a.docbody.setAttribute("spellcheck",e)))})};function h(e){return e?"false":"true"}function f(){return h(p())}function p(){return Object(t.v)()||Object(e.D)()}function g(e,t){var n=t.vid,i=t.model,r=t.requestId,o=t.offset;Object(a.collectSuiteEvent)("sdk_gec_result_operation",{action:e,rule_id:t.rule.id,category_id:t.rule.category,vid:n,model:i,request_id:r,offset:o})}function m(t){return{mountPointSelector:".etherpad-container",request:n.d,translate:o,getUserLanguage:function(){return window.User.language},events:{show:function(e){g("correction_show",e)},click:function(e){g("correction_click",e)},replace:function(e){g("apply",e)},ignore:function(e){g("ignore",e)},disable:function(e){g("disable",e),v(t)},update:function(e){g("update",e)}},unSubscribeGrammarCheckerStatus:r(t)}}function v(i){var r=!1;Object(n.d)({url:u.apiUrls.SET_LANG_CORRECTION,method:u.apiUrls.METHOD.POST,headers:{"Content-Type":"application/json"},data:{enable_ai_error_correction:r},baseURL:Object(l.prependPureAPI)("")}).then(function(e){var t,n;0===e.data.status?((t=i.plugins.grammarChecker)&&t.destroy(),n=h(r),i.docbody.setAttribute("spellcheck",n),s.a.success({content:o("docs.text_correction.disable_succ_tips")})):s.a.error({content:o("settings.setting_fail")})}).catch(function(){s.a.error({content:o("settings.setting_fail")})})}function b(e){return p()?[new i.a(e,m(e))]:[]}var y=function(e){return new i.a(e,m(e))}}).call(this,O("2vAP"))},EjhX:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"d",function(){return d});var i=n("CnBM"),r=n.n(i),o=n("5TLL"),a=n("H6oK"),s=r()({loader:function(){return Promise.resolve().then(n.bind(null,"hjKP"))},loading:function(){return null}}),c=r()({loader:function(){return Promise.all([n.e("doc_index_css"),n.e("chunk_adit"),n.e("commons--doc_index_delay--jira"),n.e(18),n.e("vendors--jira"),n.e("jira")]).then(n.bind(null,"iX0f"))},loading:function(){return null}}),l=r()({loader:function(){return Promise.all([n.e("doc_index_css"),n.e("chunk_adit"),n.e("commons--doc_index_delay--jira"),n.e(18),n.e("vendors--jira"),n.e("jira")]).then(n.bind(null,"n5Qk"))},loading:function(){return null}}),u=r()({loader:function(){return Promise.all([n.e("doc_index_css"),n.e("chunk_adit"),n.e("commons--doc_index_delay--jira"),n.e(18),n.e("vendors--jira"),n.e("jira")]).then(n.bind(null,"2kJ3"))},loading:function(){return null}});function d(){var e=Object(o.a)().blocks;e.includes(a.BlockType.FILE_CARD_BLOCK)&&s.preload(),e.includes(a.BlockType.JIRA_ISSUE_BLOCK)&&(c.preload(),u.preload()),(e.includes(a.BlockType.JIRA_ISSUE_BLOCK)||e.includes(a.BlockType.JIRA_FILTER_BLOCK))&&l.preload()}},El0g:function(e,t,n){},EpUM:function(e,t,n){},EupG:function(e,t,n){"use strict";var i=n("yG8O"),o=n.n(i),r=n("lwsE"),a=n.n(r),s=n("W8MJ"),c=n.n(s),l=n("U+yc"),u=n.n(l),h=(n("1ABj"),n("7EGn")),f=n("OZf9"),p=n("UXvI"),g=n("HmyT"),m=n("aPFL"),v=(n("Vtm6"),n("H6oK")),b=n("Hj9z");function y(e){var t,n=(Array.prototype.slice.call(e&&e.classList||[""])||[""]).join(" "),i=/sheet-id-(\S*)/.exec(n),r=/sheet-token-(\S*)/.exec(n),o=i&&i[1],a=r&&r[1],s=Object(v.getBlockDataSet)(e);return s&&(o=(t=b.SheetBlock.processToken(s.token)).sheetId||o,a=t.token||a),{id:o,token:a}}var d,E,O,C,k,I=n("IyQe"),S=n("y2sV"),T=n("YWBl"),_=n("iP/4"),w=n("7Kxq"),j=n("nVH4"),M=n("U5G9"),L=n("YNKm"),R=n("D7h9"),N=n("djbN"),D=n("vE74"),x=n("2ACu"),P=n("/spq"),B=n("xYHj"),U=n("q1tI"),z=n.n(U);n.d(t,"a",function(){return F});var H=Object(M.b)({module:M.a.SHEET}),F=(d=Object(P.a)(["bindEvent","removeEvent","log"]),E=Object(S.J)(0),d((C=function(){function r(e){var t,d=this,n=e.editor,i=e.sheetBridgePlugin;a()(this,r),this.className="Sheet",this.lineNodesRendered=function(e,t){var n=t.data.lineEntries,r=d.sheetSpanClsCollect.length;0!==r&&(Object(f.a)(n,function(e){if(e){for(var t=e.lineNode,n=0;n<d.sheetSpanClsCollect.length;++n){var i=".sheet.sheet-id-".concat(d.sheetSpanClsCollect[n]);t.querySelector(i)&&(e.domInfo.lineManagerType="sheet",r--)}return 0!==r&&void 0}}),d.sheetSpanClsCollect=[])},this.aceInitialized=function(e,t){d.tablePicker=new m.a(t),d.editorInfo=t.editorInfo,window.addEventListener("resize",d._handleWindowResize),d.editorInfo.registerAceCommand(L.V,function(e,t,n,i){d.handleClick(i),Object(T.a)({action:L.V,op:w.f,source:"editorbar"})},{statusKey:null})},this.postAceInit=function(e,t){d.bindEvent();var n=Object(h.default)(d.editorInfo.getClientVars(),"permissions");Object(I.getUserPermissions)(n).editable&&window.setTimeout(function(){var e=d.editorInfo.getRep(),t=e.alines,h=e.apool,f=e.lines,p=[];t.forEach(function(e,t){for(var n=!1,i=H.opIterator(e),r=f.atIndex(t).lineMarker,o=0;i.hasNext();){var a=i.next(),s=a.chars,c=o,l=c+s,n=n||H.attribsAttributeValue(a.attribs,"list",h),u=H.attribsAttributeValue(a.attribs,"sheet-id",h),d=o!==r;!(1===a.lines)&&u&&(d||n)&&(p.push({start:[t,c],end:[t,c],newText:"\n"}),p.push({start:[t,l],end:[t,l],newText:"\n"})),o+=s}}),0<p.length&&(d.editorInfo.makeNondoableEvent("sheet_at_doc_patch",function(){d.editorInfo.performDocumentReplaceMultiRangeWithAttributes(p)}),d.log("dev_sheet_at_doc_patch",{count:p.length}))})},this.handleWindowResize=function(){d._fullscreenEntering||(d.fullscreenOptions&&d.updateSheetsByFullscreenOptions(),d.editorInfo&&d.editorInfo.hooks.callAll("handleSheet"))},this.handleOffline=function(){d.setSheetEditable(!1)},this.handleOnline=function(){d.setSheetEditable(!0)},this.handleAfterSheetResize=function(e){var t,n=d.editorInfo,i=e.detail.sheetId,r=Object(g.$)(n.getInnerContainer()).find(".sheet-id-".concat(i)).first();r.length&&(t=r.offset().top,n.call("afterSheetResize",{top:t}))},this.setSheetEditable=function(e){R.default.dispatch(Object(N.b)(!e))},this.editorDoDelteKey=function(e,t){var n=t.editor,i=t.breakLoop,r=t.lineMarker,o=t.col,a=t.prevLineEntry,s=t.theLine;if(!(r<o)){var c=Object(h.default)(a,"domInfo.node.children.0",""),l=Object(g.$)(c);if(l.hasClass("sheet")){n.performDocumentReplaceRange([s-1,0],[s,0],"");var u=y(l.get(0));return d.sheetBridgePlugin.getBridge().deleteSheet(u.id),i(),!0}}},this.aceSelectionChanged=function(e,t){var n=t.rep,i=t.editorInfo,r=n.selStart[0];Object(B.q)(n,r)?(i.call("sheetSelect",!0),window.dispatchEvent(Object(D.b)("pad:sheetSelect",{detail:{isSelect:!0}}))):(i.call("sheetSelect",!1),window.dispatchEvent(Object(D.b)("pad:sheetSelect",{detail:{isSelect:!1}})))},this.getNextCursorPosition=function(e){var t=d.editorInfo,n=j.c.LEFT,i=j.c.RIGHT,r=j.c.DOWN,o=j.c.UP;t.fastIncorp();var a=t.getRep();if(!a.selStart)return!1;if(!t.selection.isCaret())return!1;var s,c=a.selStart,l=0,u=0;if(e===n){if(0===c[0])return!1;if(!a.lines.isStartOfLine(c[0],c[1]))return!1;s=c[0]-1,l=-2,u=0}if(e===o){if(0===c[0])return!1;s=c[0]-1,l=-2,u=0}if(e===i){if(c[0]===a.lines.length()-1)return!1;if(!a.lines.isEndOfLine(c[0],c[1]))return!1;s=c[0]+1,l=2,u=1}if(e===r){if(c[0]===a.lines.length()-1)return!1;s=c[0]+1,l=2,u=1}return!!Object(B.q)(a,s)&&{direct:l,position:u}},o()(this,"editorWillCopy",k,this),this.setNextCursorPosition=function(e,t){var n,i,r,o,a=d.editorInfo,s=a.getSelection(),c={selStart:a.getLineAndCharForPoint(s.startPoint),selEnd:a.getLineAndCharForPoint(s.endPoint)};c.selStart&&(n=a.getRep(),i=c.selStart[0]+e,r=n.lines.atIndex(i),o=t?r.lineMarker:r.text.length,a.selection.setWithSelection(n.zoneId,[i,o],[i,o],!1),a.updateBrowserSelectionFromRep())},this.handleDocumentMousedown=function(e){d.tablePicker.display&&(g.$.contains(d.tablePicker.tablePicker&&d.tablePicker.tablePicker.get(0),e.target)||d.tablePicker.hide())},this.handleClickHighlight=function(){var e=d.tablePicker.handleClickHighLight(),t=d.editorInfo.getRep(),n=t.selStart,i=t.selEnd;d.editorInfo.callWithAce(function(e){e.fastIncorp(),e.performDocumentReplaceMultiRangeWithAttributes([{start:n,end:i,newText:"\n",attributes:[]}]),e.updateBrowserSelectionFromRep(!0)},"insert-sheet",!0),Object(b.insertSheetBlock)(d.editor,{rowCount:e.y,colCount:e.x})},this.datasetMap=new Map,this.handleClick=function(e){d.tablePicker.toggleDisplay(e)},this.reset=function(){d.fullscreenEntering=!1,delete d.editor,delete d.editorInfo,window.removeEventListener("resize",d._handleWindowResize),removeEventListener("online",d.handleOnline),removeEventListener("offline",d.handleOffline),removeEventListener("afterSheetResize",d.handleAfterSheetResize),document.removeEventListener("mousedown",d.handleDocumentMousedown),d.tablePicker.highlight.off("click",d.handleClickHighlight),d.tablePicker.destory(),d.tablePicker=null},this.collectCommentTargetType=function(e,t){var n=t.node;if(-1<Object(h.default)(n,"children[0].className","").indexOf("sheet-id-"))return"sheet"},this.editorSizeChange=function(e,t){d._handleWindowResize()},this.fullscreenEntering=function(e){d._fullscreenEntering=!0},this.fullscreenEntered=function(e,t){d._fullscreenEntering=!1,d.fullscreenOptions=t,d.updateSheetsByFullscreenOptions();var n=d.sheetBridgePlugin.getBridge();n&&n.freeze()},this.fullscreenModeChanged=function(e,t){d.fullscreenOptions=t,d.updateSheetsByFullscreenOptions()},this.fullscreenExited=function(e){var t=d.sheetBridgePlugin.getBridge();d.fullscreenOptions=null,t&&(t.unfreeze(),t.setZoom(1),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){t.syncVirtualScroll()})}))},this.fullscreenPageChanged=function(e,t){var n=t.prevLineDoms,i=t.nextLineDoms,r=d.sheetBridgePlugin.getBridge();d.forEachLineDom(n,function(e){r.suspend(e)}),d.forEachLineDom(i,function(e){r.wakeup(e)})},this.beforePastInsert=function(e,t){var n=t.editorInfo,i=t.rep,r=t.insertHtml;/sheet-placeholder/.test(r)&&n.inCallStackIfNecessary("startNewLine",function(){n.performDocumentReplaceRange(i.selStart,i.selEnd,"\n")})},this.inSheet=!1,this.info={},this.sheetSpanClsCollect=[],this._handleWindowResize=Object(p.default)(this.handleWindowResize,300),this.fullscreenOptions=null,this._fullscreenEntering=!1,n&&(this.editor=n,t=Object.assign({editorInfo:n},n),this.aceInitialized("",t),this.postAceInit("",t),addEventListener("online",this.handleOnline),addEventListener("offline",this.handleOffline),addEventListener("afterSheetResize",this.handleAfterSheetResize)),this.sheetBridgePlugin=i}return c()(r,[{key:"log",value:function(e,t){Object(x.collectSuiteEvent)(e,t)}},{key:"bindEvent",value:function(){this.removeEvent(),document.addEventListener("mousedown",this.handleDocumentMousedown),this.tablePicker.highlight.on("click",this.handleClickHighlight)}},{key:"removeEvent",value:function(){document.removeEventListener("mousedown",this.handleDocumentMousedown),this.tablePicker.highlight.off("click",this.handleClickHighlight)}},{key:"updateSheetsByFullscreenOptions",value:function(){var e,t;!this.fullscreenOptions||(e=this.sheetBridgePlugin.getBridge())&&(e.setZoom(this.fullscreenOptions.zoom),(t=this.fullscreenOptions.size())&&e.setSize(t.width,t.height+1))}},{key:"forEachLineDom",value:function(e,i){e.forEach(function(e){var t,n=e.querySelector(".sheet");!n||(t=y(n).id)&&i(t)})}},{key:"handlePrintSheetDom",value:function(e){var t,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=this.sheetBridgePlugin.getBridge();i&&(t=n?i.wakeup:i.suspend,n?this.forEachLineDom(e,function(e){t(e)}):this.syncVirtualScroll())}},{key:"match",value:function(e){return!!/sheet-placeholder/.test(e)||!!["sheet-token","sheet-id"].includes(e)}},{key:"render",value:function(e){var t,n="";for(t in e.attributes){var i=e.attributes[t];/sheet-placeholder/.test(t)&&(n+="".concat(n?" ":"","sheet-placeholder-").concat(i," sheet-placeholder")),"sheet-token"===t&&(n+="".concat(n?" ":"","sheet-token-").concat(i)),"sheet-id"===t&&(n+="".concat(n?" ":"","sheet-id-").concat(i," sheet"),this.sheetSpanClsCollect.push(i))}if(!n)return e.children;if(e.mark)return e.children;if(e.class="".concat(e.class," ").concat(n),n.indexOf("sheet-id")<0)return e.children;var r=V(n),o=r.sheetId,a=r.sheetToken;if(!o||!a)return e.children;e.mark=!0;var s="".concat(a[1],"_").concat(o[1]),c=this.datasetMap.get(s);this.editor.getMatchedAttributePositionOnSelection(null,function(e,t){var n;return"dataMetaBlockProps"!==e||!t||(n=JSON.parse(t)).blockId===o[1]&&(c=n),!1}),c||((c=Object(v.generateBlockDataSet)({blockType:v.BlockType.SHEET_BLOCK})).token=s,this.editor.plugins.blockPlugin.initBlocksOnly([c]),this.datasetMap.set(s,c)),e.class+=" block-id-".concat(c.blockId," block-placeholder"),e.lineClass+=" single-line j-block-container ignore-attr-heading";var l=_.a.mobile?"100%":"730px",u=_.a.mobile?"100%":"160px",d=this.editor.plugins.blockPlugin.getBlockByDataSet(c),h=this.editor.getRep(e.zoneId).lines.atIndex(e.index);return h&&this.editor.plugins.blockPlugin.registerInstanceToEntry(h,d),z.a.createElement(S.l,null,z.a.createElement("span",{className:e.class,"data-meta-block-props":JSON.stringify(c)},z.a.createElement("span",{className:"block-autonomous-region dom-pass-empty-check ignore-collect",tabIndex:"-1",contentEditable:"false"},z.a.createElement("div",{className:"block-loading"},z.a.createElement("div",{className:"block-mode",style:{width:l,height:u}},z.a.createElement("div",{className:"block-spin"},z.a.createElement("span",{className:"rectangle-1"},z.a.createElement("span",null)),z.a.createElement("span",{className:"circle"}),z.a.createElement("span",{className:"rectangle-2"},z.a.createElement("span",null))))))))}}]),r}(),k=u()(C.prototype,"editorWillCopy",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var t=this;return function(e){e.deltaSet.forEach(function(e){e instanceof S.E&&e.forEach(function(e){e.attributes&&e.attributes["sheet-id"]&&e.attributes["sheet-token"]&&t.datasetMap.has("".concat(e.attributes["sheet-token"],"_").concat(e.attributes["sheet-id"]))&&(e.attributes[v.BLOCK_DATA_META_BLOCK_PROPS]=JSON.stringify(t.datasetMap.get("".concat(e.attributes["sheet-token"],"_").concat(e.attributes["sheet-id"]))),delete e.attributes["sheet-id"],delete e.attributes["sheet-token"])})})}}}),O=C))||O);function V(e){return e?{sheetId:/sheet-id-(\S*)/.exec(e),sheetToken:/sheet-token-(\S*)/.exec(e)}:{}}},EzSe:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return h});var i=n("L9Vw"),r=n("2ACu"),o=n("iP/4"),a=n("VIFs"),s="link_clicked",c=function(e){if(o.a.isFeed)return e;var t={logParams:{location:i.SECURE_LINK_LOG.CCM_DOCS}};return Object(i.getSecureLink)(e,t)},l=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:i.SECURE_LINK_LOG.CCM_DOCS;o.a.isFeed||Object(r.default)(s,{scene:i.SECURE_LINK_LOG.CCM_DOCS,location:e})};function u(e,t){var n;Object(a.isDocUrl)(e)?window.open(t):o.a.isChrome?window.open(t,"_blank","noopener"):(n=window.open(t,"_blank"))&&(n.opener=null)}function d(e){u(e,c(e)),l()}function h(e){o.a.isFeed&&u(e,e);var t={logParams:{location:i.SECURE_LINK_LOG.DOCS_SDK_COMMENT}};u(e,Object(i.getSecureLink)(e,t)),l(i.SECURE_LINK_LOG.DOCS_SDK_COMMENT)}},F4ZU:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("TNRG"),r={getStorage:function(){return i.a},getLegacyDataStorage:function(){return i.b},hash:n("1dfU").a}},F5vL:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return a});var i=n("FJEn"),r=n("SebV"),o=null;function l(){return o||(o=new i.ChangesetHelper.ChangesetHelper).setErrorHandler(function(e){return Object(r.a)(e)}),o}function a(o,e,a){var s=l(),c=s.unpack(e);Object.keys(c).forEach(function(e){o.has(e)||o.set(e,{minLine:-1,memberIdSet:new Set});var t,n=o.get(e),i=c[e],r=s.opIterator(i.ops);r.hasNext()&&(t=r.next(),-1===n.minLine?n.minLine=t.lines:n.minLine=Math.min(t.lines,n.minLine)),n.memberIdSet.add(a)})}},F9bh:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("RIqP"),C=n.n(i),k=n("FJEn");function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},y=e.checkAttributeApplied,E=e.ignoreAttrs,t=e.includeTitle,O=void 0!==t&&t;return function(e,t,n){var b=n.value;n.value=function(i){var r=this,o=this.editor,e=i.attribKey,t=i.attribValue,n=i.dRep,a=[],s=y||o.isRangesHaveAttributeApplied,c=o.managers.getLineManagerWithSpecialSelection();if(n)a.push(Object.assign({},o.getRep(n.zoneId),{},n));else if(c&&c.getSelectedZonesWithVisible)c.getSelectedZonesWithVisible().forEach(function(e){var t=o.getRep(e),n=t.lines.length()-1,i=t.lines.atIndex(n).width-1;a.push(Object.assign({},t,{alines:t.alines,alltext:t.alltext,apool:t.apool,zoneId:e,selStart:[0,0],selEnd:[n,i]}))});else{var l=o.getRep(),u=l.selStart,d=l.selEnd,h=l.zoneId;if(!O&&l.zoneId===k.DEFAULT_REP_ZONE&&0===u[0]){if(0===d[0])return;var f=[1,0],p=C()(u),g=0===d[0]&&C()(d);o.selection.setWithSelection(h,f,g?f:d),o.updateBrowserSelectionFromRep(!0)}a.push(l)}var m,v=s(a,e,t,E);return a.forEach(function(e){var t=!(!c||!c.getSelectedZonesWithVisible),n=Object.assign({},i,{range:e,isAllHasAttrib:v,isSpecialSelection:t});b.call(r,n)}),p&&(m=o.getRep(),o.selection.setWithSelection(m.zoneId,p,g||m.selEnd),o.updateBrowserSelectionFromRep(!0)),v}}}},FEfn:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("XIp8");function r(t,e){var n=null;try{n=JSON.parse(t,e)}catch(e){n=Object(i.default)(t)}return n}},FGOA:function(e,t,n){"use strict";var r,a=n("HmyT"),o=n("1dfU"),s=n("skFV"),c=n("2ACu"),l=n("U6jp"),i=0,u=800,d={init:function(){i||d.bindEvent(),i++},destory:function(){--i||d.unbindEvent()},bindEvent:function(){d.handleEventBinding("on")},unbindEvent:function(){d.handleEventBinding("off")},handleEventBinding:function(e){Object(a.$)(document)[e]("openLark",".js-open-lark",d.handleOpenLark),Object(a.$)(document)[e]("click",".js-open-lark",d.handleOpenLark),Object(a.$)(window)[e]("blur beforeunload",d.handleBlur)},handleOpenLark:function(e){var t=Object(a.$)(e.currentTarget),n=t.data("id"),i=t.data("source"),r=t.data("type"),o=t.data("is-cross-tenant");d.openLark(n,i,r,o)},handleBlur:function(e){r&&clearTimeout(r),r=null},isOpenCurrentChat:function(e){return l.r&&Object(l.o)()&&String(e)===Object(l.i)()},openLark:function(e,t,n,i){this.isOpenCurrentChat(e)||(d.handleBlur(),r=setTimeout(function(){var e=Object(s.s)();window.open(e.downloadLark)},u),Object(l.x)(e)),Object(c.default)("click_chat_btn",{source:t||"doc",chat_type:"6"===n?"group":"0"===n?"P2P":"chat",mention_obj_id:Object(o.a)(e),is_external:i})}};t.a=d},FI0B:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"10",height:"11",viewBox:"0 0 10 11"},t),c.a.createElement("path",{d:"M3.84 10.9l4.98-4.53a.5.5 0 000-.74L3.84 1.1a.5.5 0 00-.84.37v9.06a.5.5 0 00.84.37z",fillRule:"evenodd"}))}},FKAX:function(e,t,n){"use strict";n.d(t,"b",function(){return B}),n.d(t,"a",function(){return z});var i=n("o0o1"),a=n.n(i),r=n("yXPU"),s=n.n(r),o=n("lwsE"),c=n.n(o),l=n("W8MJ"),u=n.n(l),d=n("cDf5"),h=n.n(d),f=n("pZbs"),p=n("UXvI"),g=n("hbEN"),m=n("hMnB"),v=n.n(m),b=n("zfY2"),y=n("FJEn"),E=n("Hj9z"),O=n("sLU5"),C=n("/spq"),k=n("OX8E"),I=n("v5fw"),S=n("4PSP"),T=n("iP/4"),_=n("C+Is"),w=n("jJw9"),j=n("hjac"),M=n("jU1f"),L=n("1qho"),R=n("rxZW"),N=n("MZhh"),D=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},x=O.a.PC.DOCS.SECTION_NAV,P=y.RepManager.DEFAULT_REP_ZONE,B="SectionNav",U="client_performance_doc_collect_dir_entries",z=function(){function t(e){var h=this;c()(this,t),this.editor=e,this.className=B,this.noFirstSelectionChanged=!1,this.sectionContentReady=!1,this.initiallyCollectEntriesTimer=new I.a,this.setScrollTopTimer=new I.a,this.lineNumberArray=[],this.lineNumberEntityMap={},this.bling=new L.a({duration:1e3}),this.headingSelZoneId=P,this.lockScrollToActive=!1,this.enterPageScrollIntoHeading=function(){h.noFirstSelectionChanged=!0},this.getHeadingAttrPositionList=function(){return h.editor.getMatchedAttributePositionOnSelection(null,function(e){return"heading"===e})},this.getListCodeAttrPositionList=function(){return h.editor.getMatchedAttributePositionOnSelection(null,function(e,t){return"list"===e&&0===t.indexOf("code")})},this.buildInitHeadingData=function(){h.addNoteTitle();var e=h.getHeadingAttrPositionList(),r=h.getListCodeAttrPositionList().reduce(function(e,t){var n=t.docPosition,i=n.selZone,r=n.selStart;return i&&h.isHeadingSelZone(i)&&(e[r[0]]=!0),e},{});e.forEach(function(e){var t=e.docPosition,n=t.selZone,i=t.selStart[0];0<i&&n&&h.isHeadingSelZone(n)&&!r[i]&&h.buildHeadingLineNumberData(i)}),h.sortLineNumberArray()},this.editorAlinesDidSplice=function(e,t){h.recordHeadingChanges(t)},this.cleanLineEntityMap=function(){h.emitCollectHeading()},this.onScroll=Object(p.default)(function(){var e,s,c,t,n;h.lockScrollToActive||(e=h.editor.getScrollContainer())&&(s=e.scrollTop,c=h.editor.getReps()[0],(n=void 0!==(t=h.lineNumberArray.find(function(e,t){var n=t+1;if(n>=h.lineNumberArray.length)return!0;var i=h.lineNumberArray[t],r=h.lineNumberArray[n];if(!h.lineNumberEntityMap[i].text)return!1;var o=c.lines.atIndex(r);if(o&&o.lineNode){var a=o.getLineRect().top;return Math.floor(a-s)>=N.a}return!1}))?h.lineNumberEntityMap[t]:null)?k.a.emit(x.ON_NEW_ACTIVE_GUID,n.guid):k.a.emit(x.ON_NEW_ACTIVE_GUID,null))},500),this.onSectionNavComponentReady=function(){var e;h.sectionContentReady&&(h.emitCollectHeading(),e=v.a.hash.slice(1),k.a.emit(x.ON_NEW_ACTIVE_GUID,e))},this.onBlockResize=Object(p.default)(function(){k.a.emit(x.ON_LINE_ENTRY_CHANGE)},200),this.onResize=Object(p.default)(function(){k.a.emit(x.ON_RESIZE)},200),this.checkSectionNavState=function(){k.a.emit("showAbstractIfNecessary")},this.opendocAnchorJump=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];h.onScrollTop(e,t)},this.onScrollTop=function(){var t=s()(a.a.mark(function e(t){var n,i,r,o=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(1<o.length&&void 0!==o[1])||o[1],2<o.length&&void 0!==o[2]&&o[2],h.setLockScrollToActive(),i=function(){var e=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h.clearLockScrollToActive();case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),r=Object(M.f)(h.editor,t)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Object(M.i)({editor:h.editor,offsetTop:N.a,selection:r,animate:n,complete:i,source:"directory"});case 9:Object(M.g)(h.editor,r,!0);case 10:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.setLockScrollToActive=function(){h.lockScrollToActive=!0},this.clearLockScrollToActive=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.setScrollTopTimer.sleep(500);case 2:h.onScroll.cancel(),h.lockScrollToActive=!1;case 4:case"end":return e.stop()}},e)})),this.emitCollectHeading=Object(g.default)(function(){var e=new Set,t=[],n=!0,i=!1,r=void 0;try{for(var o,a=h.lineNumberArray[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=Object.assign({},h.lineNumberEntityMap[s]),l=c.attrMap.lineguid;l&&!e.has(l)||(l=h.generateLineGuid(c.lineNum)),c.guid=l,e.add(l),h.lineNumberEntityMap[s].guid=l;var u=h.buildLineEntry(c);c.text&&t.push(u)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}k.a.emit(x.ON_NEW_ENTRIES,t);var d=0<t.length&&(t[0].title&&1<t.length||!t[0].title);k.a.emit(x.ON_SHOWING_STATE_CHANGE,d)},100)}return u()(t,[{key:"onMount",value:function(){this.initHeadingData(),this.bindEvents(),Object(R.a)()?this.editor.on(O.a.PC.DOCS.REMOVE_SSR,this.enterPageScrollIntoHeading):this.enterPageScrollIntoHeading(),T.a.isOpendoc&&Object(b.registerOpendocApi)(_.b.anchorJump,this.opendocAnchorJump)}},{key:"aceSelectionChanged",value:function(e,t){this.noFirstSelectionChanged&&this.changeHistoryHash()}},{key:"changesetApply",value:function(){var n=this;this.editor.once("paint",function(){Object.keys(n.lineNumberEntityMap).forEach(function(e){var t=n.lineNumberEntityMap[e];t&&t.dirty&&(t.dirty=!1,t.text=n.getLineText(t.lineNum))})})}},{key:"changesetApplyAsync",value:function(){this.cleanLineEntityMap()}},{key:"editorSizeChange",value:function(e,t){var n=t.prev,i=t.next;n.width!==i.width&&this.onResize()}},{key:"initHeadingData",value:function(){this.editor.getReps()[this.headingSelZoneId]&&(this.sectionContentReady||(this.logStartEntityCollect(),this.buildInitHeadingData(),this.emitCollectHeading(),this.logEndEntityCollect(),this.sectionContentReady=!0))}},{key:"sortLineNumberArray",value:function(){this.lineNumberArray=this.lineNumberArray.sort(function(e,t){return e<t?-1:1})}},{key:"isHeadingSelZone",value:function(e){return this.headingSelZoneId===e}},{key:"buildHeadingLineNumberData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this.editor.getReps()[0].alines[e];this.lineNumberArray.push(e),this.lineNumberEntityMap[e]=Object.assign({lineNum:e,aline:n,attrMap:this.getLineAttrMap(this.headingSelZoneId,e),text:this.getLineText(e),dirty:!1},t)}},{key:"addNoteTitle",value:function(){this.buildHeadingLineNumberData(0,{title:!0})}},{key:"getLineAttrMap",value:function(e,t){return this.editor.getAllAttributesOnLine(e,t).reduce(function(e,t){return e[t[0]]=t[1],e},{})}},{key:"logStartEntityCollect",value:function(){this.editor.profile&&this.editor.profile.start(U)}},{key:"logEndEntityCollect",value:function(){this.editor.profile&&this.editor.profile.end(U)}},{key:"buildLineEntry",value:function(e){var t=e.attrMap,n=e.title?"heading-h1":"heading-".concat(t.heading),i=t.list&&0===t.list.indexOf("number")&&t.start||null,r=n,o=t.list?"list-".concat(t.list):null;return Object.assign({},e,{type:n,olStart:i,cls:r,olCls:o})}},{key:"recordHeadingChanges",value:function(e){var t,n,i,r=e.start,o=e.deleteCount,a=e.currentState;"0"===e.zoneId&&(this.logStartEntityCollect(),t=Object(f.a)(this.lineNumberArray,r),this.removeDeleteLines(t,r+o-1),n=this.addHeadingLines(a,r,t),i=a.alinesSplice.length-o,this.rebuildHeadingArrayAndMap(t,n,i),this.logEndEntityCollect())}},{key:"removeDeleteLines",value:function(n,i){this.lineNumberArray=this.lineNumberArray.filter(function(e,t){return t<n||i<e})}},{key:"addHeadingLines",value:function(e,a,s){var c,l=this,u={};return e&&e.alinesSplice.length&&(c=e.alinesSplice,e.alinesAttribs.forEach(function(e,t){var n=a+t,i=c[t],r=e.reduce(function(e,t){return e[t[0]]=t[1],e},{}),o=r.heading&&!(r.list&&0===r.list.indexOf("code"));0!==n&&!o||(l.lineNumberArray.splice(s+Object.keys(u).length,0,n),u[n]={lineNum:n,aline:i,attrMap:r,dirty:!0,text:"",title:0===n,guid:r.lineguid||l.generateLineGuid(n)})})),u}},{key:"rebuildHeadingArrayAndMap",value:function(e,t,n){if(0!==n){var i=e+Object.keys(t).length;if(0<n)for(var r=this.lineNumberArray.length-1;i<=r;r--)this.rebuildLineNumberItem(r,n);else for(var o=i;o<this.lineNumberArray.length;o++)this.rebuildLineNumberItem(o,n)}Object.assign(this.lineNumberEntityMap,t)}},{key:"rebuildLineNumberItem",value:function(e,t){var n=this.lineNumberArray[e],i=n+t;this.lineNumberArray[e]=i,this.lineNumberEntityMap[i]=this.lineNumberEntityMap[n],this.lineNumberEntityMap[i].lineNum=i,delete this.lineNumberEntityMap[n]}},{key:"changeHistoryHash",value:function(){var e=this.editor.selection.currentSelection.start,t=this.editor.getRep(e.zone),n=this.editor.getAttributesOnSelection(e.zone,t),i=!0,r=!1,o=void 0;try{for(var a,s=n.attribs[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value;if(/^url-/.test(c[0]))if(Object(w.parseAnchorUrl)(c[1]).isCurDocAnchor)return;if(/^mention-link_/.test(c[0])){var l=decodeURIComponent(c[0].slice(13));if(Object(w.parseAnchorUrl)(l).isCurDocAnchor)return}}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}var u,d="";t.attributeManager.findAttributeOnLine(e.line,"heading")&&(u=this.editor.getRep(e.zone).lines.atIndex(e.line),d=this.getActiveGuid(u.lineNode.className,e.line,e.zone)),v.a.hash.substr(1)!==d&&Object(j.a)(d)}},{key:"updateNavActiveGuid",value:function(e){k.a.emit(x.ON_NEW_ACTIVE_GUID,e)}},{key:"bindEvents",value:function(){var e=this.editor.getScrollContainer();e&&e.addEventListener("scroll",this.onScroll,{passive:!0}),k.a.on(x.ON_SECTION_NAV_READY,this.onSectionNavComponentReady),k.a.on(x.ON_SCROLL_TO_ACTIVE_LINE,this.onScrollTop),this.editor.plugins.blockPlugin&&(this.editor.plugins.blockPlugin.event.on(E.BLOCK_RESIZE_EVENT_NAME.ING,this.onBlockResize),this.editor.plugins.blockPlugin.event.on(E.BLOCK_RESIZE_EVENT_NAME.INIT,this.onBlockResize),this.editor.plugins.blockPlugin.event.on(E.BLOCK_RESIZE_EVENT_NAME.COMMENT_OVERLAY_CHANGE,this.onBlockResize))}},{key:"reset",value:function(){this.editor.off(O.a.PC.DOCS.REMOVE_SSR,this.enterPageScrollIntoHeading);var e=this.editor.getScrollContainer();e&&e.removeEventListener("scroll",this.onScroll),k.a.off(x.ON_SECTION_NAV_READY,this.onSectionNavComponentReady),k.a.off(x.ON_SCROLL_TO_ACTIVE_LINE,this.onScrollTop),this.editor.plugins.blockPlugin&&this.editor.plugins.blockPlugin.event.off(E.BLOCK_RESIZE_EVENT_NAME.ING,this.onBlockResize),this.initiallyCollectEntriesTimer.cancel(),this.setScrollTopTimer.cancel(),this.onScroll.cancel(),this.onResize.cancel(),this.bling.destroy(),this.bling=null}},{key:"getLineText",value:function(e){var t=this.editor.getRep(this.headingSelZoneId).lines.atIndex(e);return t?this.editor.getTextAndAttrsOnSelection({selStart:[e,0],selEnd:[e,t.text.length],selZone:"0"}).reduce(function(e,t){return e+("\n"===t.text?"":t.text)},""):""}},{key:"generateLineGuid",value:function(e){return"line-".concat(e)}},{key:"getActiveGuid",value:function(e,t,n){return n===P&&this.lineNumberEntityMap[t]?this.lineNumberEntityMap[t].guid:this.makeGuid(e,t)}},{key:"makeGuid",value:function(e,t){var n=/lineguid-(\S+)/.exec(e);return n?n[1]:"line-".concat(t)}}]),t}();D([Object(S.Bind)(),Object(S.Debounce)(200)],z.prototype,"changeHistoryHash",null),z=D([Object(C.a)(["bindEvents","reset"])],z)},FVmk:function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"e",function(){return c});var u=n("y2sV"),d=n("Tqb2"),h=n("ZKUE");function i(e,t){var n=e.start,i=n.zoneId,r={start:{line:n.line+1,offset:0,zoneId:i},end:{line:n.line+1,offset:0,zoneId:i}};t.selection.setSelection(r)}function r(e,t){return t.getEntities(e).some(function(e){var t=e.attributes;return Object.keys(t).some(d.J)})}var o=function(e,t){var n=e.start,i=e.end,r=n.zoneId,o=t.getContentState().getZoneState(r),a=o.getLine(n.line),s=o.getLine(i.line);return a&&s?{start:Object(d.L)(a),end:Object(d.L)(s)}:{start:!1,end:!1}},a=function(e,t,n){var i,r,o,a=t.start,s=t.end,c=t.isBackward,l=a.zoneId,u=e.start,d=e.end,h=a,f=s,p=!1;u&&(i=n.getContentState().getZoneState(l).getLine(a.line-1),r=a.line,o=a.offset,i&&(r=a.line-1,o=i.length()),h={line:r,offset:o,zoneId:l},p=!0);var g=n.getContentState().getZoneState(l),m=s.line===g.length()-1;d&&!m&&(f={line:s.line+1,offset:0,zoneId:l},p=!0),p&&n.selection.setSelection({start:h,end:f,isBackward:c},!0)},s=function(e,t,n){var i,r,o;o="zoneId"in e?(i=e.zoneId,r=e.line,t.getContentState().getZoneState(i).getLine(r)):e;var a,s,c,l=Object(d.w)(o);l&&(a=l.start,s=l.end,t.selection.setSelection({start:a,end:s},!0),c=Object(d.T)([l]),Object(h.a)(n,c.pop().uuid))},c=function(e,t){var n,i,r=t.getContentState(),o=e.start,a=o.line,s=o.zoneId,c=r.getZoneState(s),l=c.getLine(a);l&&1===l.length()&&(n=l.getOffset().start,c.length()-1===a&&--n,i=new u.E({zoneId:l.getZoneId()}).retain(n).delete(1),r.apply(i))}},FrgG:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("4PSP"),u=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},d=function(){function t(e){var n=this;r()(this,t),this.aceInitialized=function(e,t){n.editor=t.editorInfo},e&&this.aceInitialized("",{editorInfo:e})}return a()(t,[{key:"reset",value:function(){this.scrollEl&&this.scrollEl.removeEventListener("scroll",this.triggerFileCardContentVisible)}},{key:"onMount",value:function(){this.scrollEl=this.editor.getScrollContainer(),this.scrollEl&&this.scrollEl.addEventListener("scroll",this.triggerFileCardContentVisible)}},{key:"changesetApplyAsync",value:function(){this.triggerFileCardContentVisible()}},{key:"triggerFileCardContentVisible",value:function(){this.editor&&this.editor.call("onCheckFileCardContentVisible")}}]),t}();u([Object(l.Bind)(),Object(l.Debounce)(250)],d.prototype,"triggerFileCardContentVisible",null)},FsMz:function(e,t,n){"use strict";var i,r;n.d(t,"e",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"f",function(){return l}),(r=i=i||{}).High="High",r.Low="Low";var o="AES-CBC",a="AES-GCM",s="0",c="cover",l=6e4},Fw02:function(e,v,b){"use strict";(function(t){b.d(v,"a",function(){return h});var e,n,i=b("RIqP"),r=b.n(i),o=b("lSNA"),a=b.n(o),s=b("bPB8"),c=b("fRsX"),l=b("QM+C"),u=b("vY9h"),d=(Object.assign(Object.create(null),(e={},a()(e,l.NUM_SUITE_TYPE.DOC,t("template.v3.objtype.doc")),a()(e,l.NUM_SUITE_TYPE.SHEET,t("template.v3.objtype.sheet")),a()(e,l.NUM_SUITE_TYPE.MINDNOTE,t("template.v3.objtype.mindnote")),e)),Object.assign(Object.create(null),(n={},a()(n,u.a.ALL_TYPES,t("explorer.v3.meta_filter_menu_item.all")),a()(n,l.NUM_SUITE_TYPE.DOC,t("doc.search.filter.doc")),a()(n,l.NUM_SUITE_TYPE.SHEET,t("doc.search.filter.sheet")),a()(n,l.NUM_SUITE_TYPE.MINDNOTE,t("doc.search.filter.mindnote")),n))),h=function(){var e=[];return Object(c.d)()===c.a.LEFT_RIGHT?(f(e),g(e)):(g(e),p(e)),m(e),e};function f(e){e.push({tabTypeKey:"gallery",name:t("explorer.v3.template_gallery"),categories:[{name:t("template_v3_recommended"),is_recent:!0,templates:Object(s.a)([{cover_width:1,cover_height:2,name:t("template_v3_blank"),obj_type:l.NUM_SUITE_TYPE.DOC,obj_token:"",is_create_new:!0},{cover_width:2,cover_height:1,name:t("template_v3_blank"),obj_type:l.NUM_SUITE_TYPE.SHEET,obj_token:"",is_create_new:!0},c.e&&{cover_width:1,cover_height:2,name:t("template_v3_blank"),obj_type:l.NUM_SUITE_TYPE.MINDNOTE,obj_token:"",is_create_new:!0}])}]})}function p(e){e.push.apply(e,r()(Object(s.a)([{obj_type:l.NUM_SUITE_TYPE.DOC,tabTypeKey:l.mapTypeNumToFileType[l.NUM_SUITE_TYPE.DOC],name:d[l.NUM_SUITE_TYPE.DOC],categories:[{name:t("template_v3_recommended"),is_recent:!0,templates:[{cover_width:1,cover_height:2,name:t("template_v3_blank"),obj_type:l.NUM_SUITE_TYPE.DOC,obj_token:"",is_create_new:!0}]}]},{obj_type:l.NUM_SUITE_TYPE.SHEET,tabTypeKey:l.mapTypeNumToFileType[l.NUM_SUITE_TYPE.SHEET],name:d[l.NUM_SUITE_TYPE.SHEET],categories:[{name:t("template_v3_recommended"),is_recent:!0,templates:[{cover_width:2,cover_height:1,name:t("template_v3_blank"),obj_type:l.NUM_SUITE_TYPE.SHEET,obj_token:"",is_create_new:!0}]}]},c.e&&{obj_type:l.NUM_SUITE_TYPE.MINDNOTE,tabTypeKey:l.mapTypeNumToFileType[l.NUM_SUITE_TYPE.MINDNOTE],name:d[l.NUM_SUITE_TYPE.MINDNOTE],categories:[{name:t("template_v3_recommended"),is_recent:!0,templates:[{cover_width:1,cover_height:2,name:t("template_v3_blank"),obj_type:l.NUM_SUITE_TYPE.MINDNOTE,obj_token:"",is_create_new:!0}]}]}])))}function g(e){c.b&&e.push({name:t("explorer.v3.template_custom"),tabTypeKey:"custom",categories:[{name:t("explorer.v3.my_templates"),templates:[],type:"own"},{name:t("explorer.v3.templates_shared"),templates:[],type:"share"}]})}function m(e){c.f&&e.push({tabTypeKey:"corporate",name:t("explorer.v3.template_corporate"),categories:[{name:t("explorer.v3.corporate_tenant"),templates:[],type:"tenant"}],hideCategories:!0})}}).call(this,b("2vAP"))},G2xZ:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"h",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"i",function(){return h}),n.d(t,"e",function(){return f});n("lSNA"),n("7EGn"),n("QM+C");var i=n("IQB2"),r=(n("GGX4"),n("b9hN")),o=function(e){return{type:r.a.SET_CLIENT_VARS,payload:e}},a=function(){return{type:r.a.RESET_CLIENT_VARS}},s=function(e){var t=e.editorUniqueId;return i.a.set(t,e),{type:r.a.SET_EDITOR,payload:t}},c=function(e){return i.a.delete(e),{type:r.a.DESTROY_EDITOR}},l=function(e){return{type:r.a.SET_TITLE_BLANK,payload:e}},u=function(e){return{type:r.a.SET_BODY_BLANK,payload:e}},d=function(e){return{type:r.a.SET_TITLE_AND_BODY_BLANK,payload:e}},h=function(e){return{type:r.a.TOGGLE_FULLSCREEN,payload:e}},f=function(e){return{type:r.a.SET_RENDERED,payload:e}}},G7AY:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 16 16"},t),c.a.createElement("g",{transform:"translate(-6 -4)",fill:"none",fillRule:"evenodd"},c.a.createElement("rect",{stroke:"#F1F2F3",x:".5",y:".5",width:"74",height:"23",rx:"11.5"}),c.a.createElement("path",{d:"M6 4h16v16H6z"}),c.a.createElement("path",{d:"M14 9.86l-4.07 4.07c-.1.1-.25.1-.35 0l-.35-.36a.25.25 0 010-.35l4.42-4.42c.2-.2.5-.2.7 0l4.42 4.42c.1.1.1.26 0 .35l-.35.36c-.1.1-.26.1-.35 0L14 9.86z",fill:"#646A73"})))}},GACP:function(e,t,n){"use strict";n.r(t);var i=n("q1tI"),r=n.n(i),o=function(e){var i=e.children&&r.a.Children.toArray(e.children),t=e.name,n=i?t.split(/(\$\{[0-9]+})/g).map(function(e){var t=/\$\{([0-9]+)}/.exec(e);if(t){var n=parseInt(t[1],10)-1;return i[n]}return e}):t;return e.noWrapper?r.a.createElement(r.a.Fragment,null,n):r.a.createElement("span",null,n)};n.d(t,"I18n",function(){return o})},GEp8:function(e,t,n){"use strict";var i=n("lwsE"),o=n.n(i),r=n("W8MJ"),s=n.n(r),v=n("FJEn"),a=n("lSNA"),c=n.n(a),l=n("J4zp"),h=n.n(l),u=n("QILm"),f=n.n(u),d=n("RIqP"),p=n.n(d),g=n("U5G9"),b=n("okfw"),y=Object(g.b)({module:g.a.HISTORY}),E="=",O="+",C="-",m=function(){function r(){var m=this;o()(this,r),this.setClientVars=function(e){var t=e.initialAttributedTexts,n=e.apool;m.clientVars=Object.assign({},t,{pool:n})},this.setEditor=function(e){m.editor=e},this.setHooks=function(e){m.hooks=e},this.handleChange=function(e){var t=m.mergeChanges(e),n=t.filter(function(e){return e.type===k});return m.setChanges(n),t},this.getLine=function(e){return m.lines[e]||(m.lines[e]={alines:["|1+1"],zoneId:e})},this.addAuthorToChangeset=function(e){var t,n={},i=m.editor.getRepManager().apool,r=e.userId,o=e.changeset;for(t in y.formatCs(o)){var a=y.addAttributesToChangesetByOp(b.a.deleteAuthorInfo(o,t,i),t,i,[["author",r]],["+"]);n[t]=a}return y.formatCsFromObj(n)},this.setChanges=function(e){var n,i,r,t;e&&0<e.length&&(i=m.editor.getRepManager().apool,r=[],e.forEach(function(t){var e;t.type===k&&(r.find(function(e){return e===t.userId})||r.push(t.userId),e=m.addAuthorToChangeset(t),n=n?y.compose(n,e,i):e)}),t=1===r.length?r[0]:"",m.changes=[{userId:t,changeset:n}].concat(p()(e)))},this.mergeChanges=function(e){if(!e)return[];var u=[],d=m.editor.getRepManager().apool,t=e.map(function(e){var t=e.type,n=e.meta_id,i=e.user_id,r=e.revision,o=(e.content,f()(e,["type","meta_id","user_id","revision","content"]));if(t!==k)return Object.assign({type:t,metaId:n,userId:i,revision:r},o);var a=m.parseChangeContent(e.content),s=a.cs,c=a.apool,l=y.moveOpsToNewPool(s,c,d);return u=[].concat(p()(u),p()(m.collectByAttributeName("image-uploaded",c))),{type:t,changeset:l,userId:i,metaId:n,revision:r}}),n=[],n=m.merge(t,function(e){var t=e.zoneId,n=e.mutateApool,i=e.lastChange,r=e.curChange,o=m.getLine(t).alines,a=i&&i.userId===r.userId,s=m.pureImageUploadedCS(r.changeset[t],n,t),c=m.isChangeTextCS(r.changeset[t],o,n,t);return a||s||!c});return n=m.merge(n,function(e){var t=e.zoneId,n=e.mutateApool,i=(e.lastChange,e.curChange),r=m.getLine(t).alines;return!m.isChangeTextCS(i.changeset[t],r,n,t)}),m.collectByAttributeName("image-placeholder",d).forEach(function(e){var t=h()(e,3),n=(t[0],t[1]),i=t[2],r=n.match(/uuid=(\w+)/),o=u.find(function(e){var t=e[1].match(/uuid=(\w+)/);return!(!r||!t||r[1]!==t[1])});o?(o[1]=o[1]+"&history=true",d.numToAttrib[i]=["image-uploaded",o[1]],d.attribToNum["".concat(o[0],",").concat(o[1])]=i):d.numToAttrib[i]=["",""]}),n},this.initLines=function(){var e,t=m.editor.getRepManager().apool,n=m.clientVars,i=n.pool,r=n.text,o=n.attribs;for(e in m.lines={},r){var a=r[e],s=o[e],c=b.a.getInitAlines(a,s,i,t);m.getLine(e).alines=c}},this.merge=function(e,d){var h=m.editor.getRepManager().apool;m.initLines();var f=[],p=[],g=-1;return e.forEach(function(n){if(n.type===k){var i,r,e=n.changeset,t=n.metaId,o=n.revision,a=y.formatCs(e),s=y._unpack(e),c=f[g],l=!0;for(i in s)"Z"===s[i].itemType?function(){var e=d({zoneId:i,mutateApool:h,lastChange:c,curChange:Object.assign({},n,{changeset:a})}),t=m.getLine(i).alines;y.mutateAttributionLines(a[i],function(){return t},h),m.getLine(i).alines=t,e||(l=!1)}():c&&c.userId===n.userId||(l=!1);if(l)return c?void(f[g]=Object.assign({},c,{changeset:y.compose(c.changeset,e,h),metaId:t,revision:o})):void p.push({changeset:e});p.forEach(function(e){var t=e.changeset;r=r?y.compose(r,t,h):t});var u=r?y.compose(r,e,h):e;f.push(Object.assign({},n,{changeset:u})),p=[],g=f.length-1}else f.push(n)}),f},this.renderPrev=function(e){var t=m.changes,n=m.curIndex-1,i=0===n?null:t[n],r=m.changes[m.curIndex];m.applyChangesToBase(r.inverseDiffChangeset),i&&(i.inverseChangeset||m.addChangesetsToChange(i),m.applyChangesToBase(i.inverseChangeset),m.applyFinishChanges(i.diffChangeset)),m.curIndex=n},this.renderNext=function(){var e,t=m.changes,n=m.curIndex+1,i=t[n];i&&(i.diffChangeset||m.addChangesetsToChange(i),e=i.diffChangeset,m.applyFinishChanges(e),0===m.curIndex&&(m.replaying=!0),m.curIndex=n),0===t.length&&m.hooks.callAll("changesetRender_finishApply",{root:m.root,ace:{editorInfo:m.editor}})},this.applyFinishChanges=function(e){var t=m.editor.getRepManager().apool;m.editor.changesetTracker.applyChangesToBase(e,t),m.hooks.callAll("changesetRender_finishApply",{root:m.root,ace:{editorInfo:m.editor}})},this.applyChangesToBase=function(e){m.hooks.callAll("changesetRender_beforeApply",{root:m.root});var t=m.editor.getRepManager().apool;m.editor.changesetTracker.applyChangesToBase(e,t)},this.removeDiff=function(e){var t,n=m.changes,i=!e;if(i){if(m.replaying)return;t=n[0]}else t=e;t.inverseDiffChangeset||m.addChangesetsToChange(t);var r=t.inverseDiffChangeset,o=t.changeset,a=m.editor.getRepManager().apool,s=r;i||(s=y.compose(r,o,a)),m.applyChangesToBase(s)},this.addDiff=function(e){e.inverseChangeset||m.addChangesetsToChange(e);var t=e.inverseChangeset,n=e.diffChangeset,i=m.editor.getRepManager().apool,r=y.compose(t,n,i);m.applyChangesToBase(r)},this.isChangeTextCS=function(e,t,n,i){for(var r=b.a.unpack(e,i),o=y.opIterator(r.ops),a=0;o.hasNext();){var s=o.next();if(s.opcode===O||s.opcode===C){var c=y.attribsAttributeValue(s.attribs,"lmkr",n),l=s.opcode===C&&m.isDeleteOnLineMarker([a,a+s.chars],t,n);if(!c&&!l&&s.lines!==s.chars)return!0}s.opcode!==C&&s.opcode!==E||(a+=s.chars)}return!1},this.isDeleteOnLineMarker=function(e,t,n){for(var i=0,r=h()(e,2),o=r[0],a=r[1],s=0;s<t.length-1;s++)for(var c=y.opIterator(t[s]);c.hasNext();){var l=c.next();if(i<=o&&l.chars+i>=a)return y.attribsAttributeValue(l.attribs,"lmkr",n);i+=l.chars}return!1},this.pureImageUploadedCS=function(e,t,n){for(var i,r=b.a.unpack(e,n),o=y.opIterator(r.ops),a=0,s=0;o.hasNext();){var c=o.next();y.eachAttribNumber(c.attribs,function(e){"image-uploaded"===t.getAttribKey(e)&&(i=!0)}),c.opcode===O?s+=c.chars:c.opcode===C&&(a+=c.chars)}return i&&1===a&&1===s},this.deleteAuthorInfo=function(e,t,n){for(var i=b.a.unpack(e,t),r=y.opIterator(i.ops),o=y.opAssembler(),a=i.itemType,s=function(){var e=r.next(),t=[];y.eachAttribNumber(e.attribs,function(e){"author"!==n.getAttribKey(e)&&t.push(y.numToString(e))}),e.attribs=0<t.length?"*".concat(t.join("*")):"",o.append(e)};r.hasNext();)s();return y._pack(c()({},t,{itemType:a,oldLen:i.oldLen,newLen:i.newLen,ops:o.toString(),charBank:i.charBank}))},this.collectByAttributeName=function(n,e){var i=e.numToAttrib,r=[];return Object.keys(i).forEach(function(e){var t=i[e];t&&t[0]===n&&r.push([t[0],t[1],Number(e)])}),r},this.addChangesetsToChange=function(e){var t=m.editor.getRepManager(),n=t.reps,i=t.apool,r=m.editor.getVectorReps(),o=e.changeset,a=e.userId;e.diffChangeset=b.a.computeDiffChangeset(o,a,n,r,i),e.inverseDiffChangeset=b.a.inverseChangeset(e.diffChangeset,n,r,i),e.inverseChangeset=b.a.inverseChangeset(o,n,r,i)},this.parseChangeContent=function(e){var t=JSON.parse(e),n=t.zone_changesets_str,i=t.changeset_str,r=t.changeset_apool,o=JSON.parse(r);return{cs:y.formatCsFromObj(n)||i,apool:(new v.AttributePool).fromJsonable(o)}},this.unpack=function(e,t){return y.unpack(e)[t]},this.curIndex=-1,this.changes=[],this.replaying=!1,this.lines={}}return s()(r,null,[{key:"init",value:function(e){var t=new r,n=e.clientVars,i=e.root;return t.root=i,t.setClientVars(n),t}}]),r}();n.d(t,"a",function(){return k});var k=1,I=function(){function a(){var m=this;o()(this,a),this.asyncOperatingTimers=[],this.setScrollToEditDom=function(e){m.scrollToEditDom=e},this.setEditor=function(e){var t=m.clientVars.changes;m.docReplay.setEditor(e);var n=m.docReplay.handleChange(t);m.setChanges(n)},this.setHooks=function(e){m.docReplay.setHooks(e)},this.setDocReplay=function(e){m.docReplay=e},this.setClientVars=function(e){m.clientVars=e},this.setInitClientVars=function(e){var t=JSON.parse(e[0].content),n=t.pool,i=t.attributed_texts,r=t.table_meta,o=t.text,a=t.attribs,s=JSON.parse(i),c=JSON.parse(r),l=s.texts,u=s.attribs,d=c.cols,h=c.rows,f=c.attribs,p=Object.assign({},l,{0:o}),g={initialAttributedTexts:{attribs:Object.assign({},u,{},f,{0:a}),cols:d,rows:h,text:p},apool:(new v.AttributePool).fromJsonable(JSON.parse(n))};m.initClientVars=g},this.setChanges=function(e){m.changes=e},this.renderOverview=function(){var e=setTimeout(function(){m.docReplay.renderNext(),m.scrollToEditDom()});m.asyncOperatingTimers.push(e)},this.renderNext=function(){var e,t,n=m.curIndex,i=m.changes,r=i[n],o=i[n+1];o&&(e=-1===m.curIndex,o.type===k&&(t=setTimeout(function(){!e&&r.type!==k||m.docReplay.removeDiff(r),m.docReplay.renderNext(),m.scrollToEditDom()}),m.asyncOperatingTimers.push(t)),m.curIndex++)},this.renderPrev=function(){var e,t,n,i=m.curIndex,r=m.changes,o=r[i],a=r[i-1];a&&((e=a.type===o.type)||o.type!==k||(t=setTimeout(function(){for(var e,t=i-1;0<=t;t--){var n=r[t];if(n.type===k){e=n;break}}m.docReplay.removeDiff(e),m.docReplay.renderPrev(),m.scrollToEditDom()}),m.asyncOperatingTimers.push(t)),a.type===k&&(e?(n=setTimeout(function(){m.docReplay.renderPrev(),m.scrollToEditDom()}),m.asyncOperatingTimers.push(n)):m.docReplay.addDiff(a)),m.curIndex--)},this.curIndex=-1}return s()(a,[{key:"destroy",value:function(){this.asyncOperatingTimers.forEach(function(e){e&&window.clearTimeout(e)})}}],[{key:"create",value:function(e){var t=new a,n=e.root,i=e.clientVars,r=e.scrollToEditDom,o=i.snapshots;return t.setInitClientVars(o),t.setDocReplay(m.init({root:n,clientVars:t.initClientVars})),t.setClientVars(i),t.setScrollToEditDom(r),t}}]),a}();t.b=I},GGpJ:function(e,X,$){"use strict";$.r(X),function(m){var e=$("lwsE"),r=$.n(e),t=$("W8MJ"),n=$.n(t),i=$("a1gu"),o=$.n(i),a=$("Nsbk"),c=$.n(a),s=$("7W2i"),l=$.n(s),u=($("TaAU"),$("q1tI")),v=$.n(u),b=$("UAY2"),d=($("17x9"),$("TSYQ")),y=$.n(d),E=$("9g7G"),h=$("mRaX"),f=$("6dGb"),p=$("n6KG"),g=$.n(p),O=$("AiBH"),C=$("nHtH"),k=$("QM+C"),I=$("GBY4"),S=$.n(I),T=$("UlbS"),_=$("+/Fj"),w=$("XMIC"),j=$("MUo5"),M=$("m/+l"),L=$("D7h9"),R=$("YO6O"),N=$("jp/M"),D=$("2ACu"),x=$("NtTV"),P=$("r5mi"),B=$("/fVd"),U=$("VI6H"),z=$("IyQe"),H=$("5cZX"),F=$("1dfU"),V={permission:{Icon:_.a,msg:m("shortcut.no_access_tips"),msgExternal:m("permission.embed.external_cannot_apply_permission")},error:{Icon:f.a,msg:m("shortcut.loading_fail_tips")},notPreviewable:{Img:g.a}},W=320,K=320,Z=function(e){return{embedObjPermissions:Object(H.y)(e)}},q={openModal:w.c,sendSuitePermissionRequest:j.sendSuitePermissionRequest},Y=function(e){function i(e){var s;r()(this,i),(s=o()(this,c()(i).call(this,e))).loadDocInfo=function(){var e=s.props,r=e.token,o=e.sourceString;Object(E.d)({type:s.objTypeString,token:r}).then(function(e){var t,n,i;s.mounted&&(n=(t=e.data).edit_time,i=t.title,Object(h.Y)(o,!1,"file",r),s.setState({editTime:n,title:i}))})},s.loadShortcutImage=function(){var e=s.props,t=e.token,n=e.link,i=Date.now();s.getImageSrc(s.objTypeString,t,n).then(function(e){var t=e&&e.src,n=e&&e.isIcon;s.setShortState({status:!0,startRequestTime:i,src:t,isIcon:n})},function(e){if(e&&e.specialSuite)s.setShortState({status:!1,startRequestTime:i,specialSuiteInfo:e.info,reason:JSON.stringify(e.info)});else{if(Boolean(e&&e.noPermitted))return s.setShortState({status:!1,startRequestTime:i,errType:"permission",reason:"no permission"}),void s.setState({hasNoPermissionByShortCutImage:!0});s.objTypeString!==k.FILE_TYPE.FILE?s.setShortState({status:!1,startRequestTime:i,errType:"error",reason:"error"}):s.setShortState({status:!1,startRequestTime:i,errType:"notPreviewable",reason:"not previewable"})}})},s.handleApplyEmbedObjPermission=function(){var e=s.props,t=e.sendSuitePermissionRequest,n=e.token,i=e.type,r=e.closePopover,o=O.v[i]||i,a="";s.owner&&(a=Object(U.p)(s.owner,s.owner.get("name"))),t(n,o,k.PERMISSION.READABLE,"",a),Object(D.default)("click_embed_quick_apply",{from:"hover"}),r&&r()},s.handleOpenEmbedShareModal=function(){var e=s.props,t=e.openModal,n=e.token,i=e.title,r=e.closePopover,o=e.type,a={token:n,type:O.v[o]||o,title:i,permission:s.embedObjPermission};Object(h.L)(O.u.CLICK_EMBED_QUICK_SHARE,{from:"hover"}),t(N.ui.MODAL_TYPES.EMBED_SHARE,{embedObj:a}),r&&r()},s.getImageSrc=function(e,t,n){var i,r={sourceForLog:k.FILE_PREVIEW_SOURCE_FOR_LOG.docPopover,fileToken:t,fileType:k.mapFileType2TypeNum[e],clientHeight:W,clientWidth:K};return!n||e!==k.FILE_TYPE.MINDNOTE||(i=new S.a(n).hash)&&1<i.length&&(r.hash=encodeURIComponent(i.slice(1))),Object(x.d)(r)};var t=s.hasNoPermission;s.state=Object.assign({loaded:t,errType:t?"permission":"",specialSuiteInfo:null,hasNoPermissionByShortCutImage:!1},e),s.isNeedFetchEmbedPerm=!1;var n=e.type;return s.objTypeString=s.getObjTypeString(n),s}return l()(i,e),n()(i,[{key:"componentDidMount",value:function(){var e=this.props,t=e.embedObjShareEnable,n=e.disableAddEmbedObj;t&&!n&&(B.a.addEmbedObj([{num:1,obj:this.embedObject}]),B.a.sendEmbedObjsToManager([this.embedObject])),this.mounted=!0,this.hasNoPermission||(this.loadDocInfo(),this.loadShortcutImage())}},{key:"componentWillUnmount",value:function(){this.props.disableAddEmbedObj||B.a.removeEmbedObj([{num:1,obj:this.embedObject}]),this.mounted=!1,this.isNeedFetchEmbedPerm&&(B.a.fetchEmbedObjsPerm(),this.isNeedFetchEmbedPerm=!1)}},{key:"getObjTypeString",value:function(e){var t=O.v[e]||e;return k.mapTypeNumToFileType[t]}},{key:"setShortState",value:function(e){var t=e.errType,n=e.specialSuiteInfo,i=e.src,r=e.isIcon,o=e.status,a=e.reason,s=e.startRequestTime,c=this.props,l=c.token,u=c.sourceString;this.setState({loaded:!0,errType:t,src:i,isIcon:r,specialSuiteInfo:n}),Object(h.S)({status:o,source:u,type:this.objTypeString,token:l,reason:a,cost_time:Date.now()-s})}},{key:"arrayBufferToBase64",value:function(e){for(var t="",n=new Uint8Array(e),i=n.byteLength,r=0;r<i;r++)t+=String.fromCharCode(n[r]);return window.btoa(t)}},{key:"renderError",value:function(){var e=this.state,t=e.errType,n=e.hasNoPermissionByShortCutImage,i=this.props.embedObjShareEnable,r=this.owner,o=this.embedObjPermission,a=V[t];if("notPreviewable"===t){var s=a.Img;return v.a.createElement("section",{className:"mention-pop"},v.a.createElement("div",{className:"short-cut__notPreviewable layout-row"},v.a.createElement("img",{src:s,className:"short-cut__img"})),this.renderBottomBar())}var c=a.msgExternal,l=a.Icon,u=a.msg;if("permission"===t&&i)if(o&&r){if(r&&r.get("can_apply_perm")){var d=Object(U.p)(r,r.name);return v.a.createElement("section",{className:"mention-pop"},v.a.createElement("div",{className:"short-cut__error"},v.a.createElement("div",{className:"short-cut__error__permission"},v.a.createElement("i",null,v.a.createElement(l,null)),v.a.createElement("span",{className:"permission-text"},m("permission.embed.contact_author"),v.a.createElement(R.default,{className:"cooperater-user-popover",source:"permission_request",token:r.get("id"),name:d,trigger:"hover",placement:"lb",usePopover:!0},v.a.createElement("a",{className:"permission-request-owner"},d+m("permission.embed.owner"))),m("permission.embed.share_tips_5"))),v.a.createElement(T.Button,{onClick:this.handleApplyEmbedObjPermission,type:"primary"}," ",m("permission.embed.apply_btn")," ")))}r&&!r.get("can_apply_perm")&&(u=c)}else{this.isNeedFetchEmbedPerm=!0;var h=V.error,l=h.Icon,u=h.msg;n&&(l=V.permission.Icon,u=V.permission.msg)}return v.a.createElement("div",{className:"short-cut__error layout-cross-center layout-row"},v.a.createElement("i",{className:"short-cut__icon"},v.a.createElement(l,null)),v.a.createElement("p",{className:"short-cut__msg"},u))}},{key:"renderBottomBar",value:function(){var e=this.state.editTime;return e?v.a.createElement("div",{className:"mention-pop__time"},m("shortcut.last_update_time"),Object(C.a)(e)):null}},{key:"handleImageLoaded",value:function(e){URL.revokeObjectURL(e)}},{key:"handleImageError",value:function(e,t,n,i){Object(D.default)("mention_snapshot_src_error",{src:Object(F.a)(e),source:t,mention_type:i,mention_obj_id:Object(F.a)(n)}),URL.revokeObjectURL(e)}},{key:"render",value:function(){var e=this,t=this.state,n=t.loaded,i=t.src,r=t.isIcon,o=t.errType,a=t.specialSuiteInfo,s=this.props,c=s.embedObjShareEnable,l=s.sourceString,u=s.token,d=s.type,h=this.embedObjPermission,f=h&&h.canInvite,p=!Object(E.j)();if(!n)return v.a.createElement("div",{className:"layout-main-center layout-cross-center layout-row popover-loading"},v.a.createElement(b.a,null));if(o)return this.renderError();var g=y()("mention-pop__shortcut",{"mention-pop__shortcut-default-icon":r});return v.a.createElement("section",{className:"mention-pop"},v.a.createElement("div",{className:g},i&&v.a.createElement("img",{onLoad:function(){return e.handleImageLoaded(i)},onError:function(){return e.handleImageError(i,l,u,d)},src:i}),a&&v.a.createElement(P.a,{className:"mention-snapshot-special_suite",code:a.code})),p&&f&&c&&v.a.createElement("div",{className:"mention-pop__quick-share"},v.a.createElement("div",{className:"share-notify"},v.a.createElement(_.a,{className:"permission-warning-icon"}),v.a.createElement("span",{className:"warning-text"},m("permission.embed.share_tips_2"))),v.a.createElement(T.Button,{type:"primary",onClick:this.handleOpenEmbedShareModal},m("permission.embed.share_btn"))),this.renderBottomBar())}},{key:"embedObject",get:function(){var e=this.props,t=e.token,n=e.type,i=e.title;return{token:t,type:O.v[n]||n,title:i}}},{key:"embedObjPermission",get:function(){var e=this.props,t=e.embedObjPermissions,n=e.token,i=t&&t.get(n);return i?Object(z.embedObjPermission2Booleans)(i.get("permission")):null}},{key:"hasNoPermission",get:function(){var e=this.embedObjPermission;return!!e&&e.cantRead}},{key:"owner",get:function(){var e=this.props,t=e.embedObjPermissions,n=e.token,i=t&&t.get(n);return i?i.get("owner"):null}}]),i}(u.Component);Y.defaultProps={embedObjShareEnable:!1};var J=Object(M.connect)(Z,q)(Y),Q=function(e){function t(){return r()(this,t),o()(this,c()(t).apply(this,arguments))}return l()(t,e),n()(t,[{key:"render",value:function(){return v.a.createElement(M.Provider,{store:L.default},v.a.createElement(J,this.props))}}]),t}(u.Component);X.default=Q}.call(this,$("2vAP"))},GM7c:function(e,t,n){},GVmr:function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var r=n("QM+C"),i=function(e){var t,n=e.getReps(),i=0;for(t in n){var r=n[t];i+=r.alltext.length-r.alines.length}return i},o=function(d){var e=d.getRep(),h={},f=0,p=0;e.apool.eachAttrib(function(e,t){var n,i,r,o,a,s,c,l,u;"dataMetaBlockProps"===e&&t?(i=(n=JSON.parse(t)).blockType.toLowerCase(),r=n.blockType+"_COUNT",h[r]||(h[r]=0),h[r]++):"gallery"===e?i="gallery":"image-uploaded"===e?i="image":"aceTable"===e?(i="table",o=d.plugins,a=d.vectorReps,!o.table||(s=o.table.getRowAndColIdFromTableValue(t))&&(c=s.rowId,l=s.colId,u=o.table.getSortedTableCellIdsByTableIdFromVectorReps(a,{rowId:c,colId:l}),p+=u.length)):/comment-id/.test(e)&&(i="comment"),i&&(h[i]||(h[i]=0),h[i]++),f++});var t=e.alines.length,n=!(!r.USE_BLOCK_RENDER||!r.USE_BLOCK_RENDER.fiber),i=!(!r.USE_BLOCK_RENDER||!r.USE_BLOCK_RENDER.unmount);return Object.assign({unmount:i,is_fiber:n,is_lazy_block:!0,total_attributes:f,all_table_cell_num:p},h,{total_text_lines:t})},a=function(t){return function(){var e=o(t);return Object.assign({total_text:i(t)},e)}};function s(e,t){return{total_text_lines_delta:e.total_text_lines-t.total_text_lines,all_table_cell_num_delta:e.all_table_cell_num-t.all_table_cell_num,gallery_delta:(e.gallery||0)-(t.gallery||0)}}},GdWO:function(e,t,r){"use strict";var n=r("o0o1"),o=r.n(n),i=r("yXPU"),a=r.n(i),s=r("lwsE"),c=r.n(s),l=r("W8MJ"),u=r.n(l),d=r("cDf5"),h=r.n(d),f=r("yIs4"),p=r("NZ+B"),g=r("Bw5p"),m=r("7EGn");function v(e){if(!e)return{};var t=e.user_id,n=e.user_name;return{color_id:e.color_id,user_name:n,user_id:t,avatar_url:e.avatar_url,member_id:e.member_id,suid:e.suid}}var b=r("+exY"),T=r("dQBc"),y=r("+hmC"),E=function(){function n(e,t){c()(this,n),this.type=y.b.DOC,this.msgQueue=[],this.collabQueue=e,this.fireHandler=t}return u()(n,[{key:"sendNextCS",value:function(e){var n=this,t=this.msgQueue.shift();return this.fireHandler(t),new Promise(function(e,t){n.resolveFunc=e,n.rejectFunc=t})}},{key:"resolve",value:function(){this.resolveFunc&&this.resolveFunc(!0)}},{key:"clearHandler",value:function(){this.rejectFunc=null,this.resolveFunc=null}},{key:"reject",value:function(){this.rejectFunc&&(this.rejectFunc(!1),this.clearHandler())}},{key:"push",value:function(e){this.msgQueue.push(e),this.collabQueue.push(this.type)}}]),n}(),_=r("FJEn"),O=r("1vGr"),C=r("ahx2"),w=r("lQZd"),k=r("SebV"),I=r("mHIB"),j=r("1dfU"),M=r("2ACu"),S=r("e3py"),L=r("rLED"),R=r("TYER"),N=r("oJoF"),D=r("1lbP");r.d(t,"a",function(){return re}),r.d(t,"c",function(){return ce});var x=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},P=O.e,B=Object(L.M)("doc_client_duration",500),U=Object(L.L)("doc_abnormal_user_action"),z=15e3,H=8e3+B,F=2e3+B,V=R.h.USER_CHANGES,W=R.h.ACCEPT_COMMIT,K=R.h.NEW_CHANGES,Z=R.h.ERROR,q=R.h.MESSAGE,Y=Object(L.L)("doc_not_oops_types")||[],J=Object(L.L)("doc_not_oops_codes")||[],Q="online",X="offline",$="CONNECTING",ee="DISCONNECTED",te="client_performance_doc_handle_user_changes",ne=-1002,ie=-1001,re=-1e3,oe=function(){function i(e){var S=this;c()(this,i),this.messageSended=null,this.hasUserChangeWhenDisabled=!1,this.storageError=!1,this.lineConflictCollector=null,this.rxOp=new D.a,this.setDataAndHandleError=function(e){return Object(b.b)(e).catch(function(e){return S.editor.changesetTracker.submittedChangeset?void S.editor.fatal(e,"storage","Client setData fail",re):(!1===S.storageError&&Object(M.collectSuiteEvent)("dev_client_setData_fail",{error:e}),void(S.storageError=!0))})},this.onMount=function(){addEventListener("online",S.handleOnline)},this.aceKeyEvent=function(){S.handleResetUserAction()},this.handleResetUserAction=function(){S.setUserLastAction({startTimeStamp:ae(),sendMessageTimes:0})},this.setUserLastAction=function(e){S.userLastAction=e},this.setRev=function(e){S.rev=e},this.getRev=function(){return S.rev},this.getLastSaveLocalTime=function(){return S.lastSaveLocalTime},this.disable=function(){S.engineSyncBuffer.frozen(),S.disabled=!0,S.hasUserChangeWhenDisabled=!1},this.enable=function(){S.engineSyncBuffer.deFrozen();var e=S.hasUserChangeWhenDisabled;S.disabled=!1,S.hasUserChangeWhenDisabled=!1,S.dequeue(),S.handleUserChanges(!0,!1,e)},this.handleChannelChange=function(e,t){var n=S.netState,i=S.setChannelState,r=n===X&&e===Q,o=n===Q&&e===X;S.netState=e,r?i("CONNECTED","reconnect"):o&&i(ee,"io-net-offline")},this.setMessageSended=function(e){S.messageSended=e},this.setChannelState=function(e,t){var n,i,r,o,a=S.editor;e!==S.channelState&&(S.channelState=e,a.call("channelStateChange",{type:"channelStateChange",newState:e,moreInfo:t,state:S.channelState})),"CONNECTED"===e&&"reconnect"===t&&(r=(i=(n=a.changesetTracker)?n.getSubmittedChanges():{}).changeset,o=i.apool,null===r&&null===o&&a.call("acceptCommit",{type:W,oldRev:S.rev,rev:S.rev}))},this.handleOnline=function(){S.messageSended&&(S.sendMessage(S.messageSended,!0),S.editor.log("[collab debug]: retry by handleOnline"),Object(M.collectSuiteEvent)("dev_client_handleOnline_retry")),S.handleUserChanges()},this.getCommittedChangesKey=function(){return S.committedChangesKey||(S.committedChangesKey="".concat(T.d,"_").concat(S.editor.getEditorUniqueId(),"_").concat(S.editor.plugins.offline.currentDate()),S.committedChangesKey)},this.getUserChangesKey=function(){return S.userChangesKey||(S.userChangesKey="".concat(T.l,"_").concat(S.editor.getEditorUniqueId(),"_").concat(S.editor.plugins.offline.currentDate()),S.userChangesKey)},this.handleMessageFromServer=function(e){var t,n,i,r,o,a,s,c;e?(t=Object.assign({},Object(g.a)(e,["type","code","request_id"]),{storageError:S.storageError}),"DOC"===e.type?(n=S.editor,(i=e.data).token===n.getDocId()?i.token===Object(w.g)()&&n.mounted?(i.user_info=i.payload=v(i),r=i.type,o=i.payload,a=r?"client_performance_doc_".concat(r.toLocaleLowerCase()):"",n.profile&&a&&n.profile.start(a),s=i.changeset_list,Object(M.default)("dev_client_handle_message",{wrapInfo:t,innerInfo:Object(g.a)(i,["type","code","version","note_revision","uuid_v4","baseRev"]),changesetListInfo:s?s.map(function(e){return e.note_revision}):[]}),c="handleClientMessage_".concat(r),n.call(c,{data:i.user_info,type:r,msg:i}),n.hook.callAll(c,{payload:o,msg:i,evt:e}),n.profile&&a&&n.profile.end(a,{minimumUsedTime:20})):Object(M.default)("dev_client_handle_message_return",{wrapInfo:t,msgToken:Object(j.a)(i.token),getToken:Object(j.a)(Object(w.g)()),editorMounted:n.mounted}):i.token&&Object(M.default)("dev_client_handle_message_token_not_equal_docId",{wrapInfo:t,msgToken:Object(j.a)(i.token)})):Object(M.default)("dev_client_handle_message_no_doc",{wrapInfo:t})):Object(M.default)("dev_client_handle_message_without_evt")},this.processNewChangeItem=function(e,t){try{Object(L.h)()&&S.isCommitting()&&S.messageSended&&S.LoableLineConflictCollector&&(S.lineConflictCollector||(S.lineConflictCollector=new S.LoableLineConflictCollector(S.editor,S.messageSended)),S.lineConflictCollector&&S.lineConflictCollector.compareAndRecordMsg(e))}catch(e){console.log(e)}var n=S.editor,i=S.rev;S.csQueue.resolve();var r,o,a,s,c=e.apool,l=e.zone_changesets,u=e.member_id,d=n.changesetHelper,h=e.note_revision,f=t&&0<t.length&&{changesetList:t,submittedChanges:S.editor.changesetTracker.getSubmittedChanges(),userChanges:S.editor.changesetTracker.getUserChangeset()};Object(L.g)()&&n.isFocus()&&(o=(r=n.selection.getSelection())&&r.toPosition()),n.changesetTracker.applyChangesToBase(d.formatCsFromObj(l),c,h,u,f),Object(L.g)()&&n.isFocus()&&r&&(s=(a=n.selection.getSelection()).toPosition(),a&&o&&s&&S.compareAndCollectRangeChange({beforeApplySelection:r,afterApplySelection:a,beforeApplyPosition:o,afterApplyPosition:s})),S.setRev(h),console.log("pos apply cs version ".concat(h,", now version this ").concat(S.rev));try{n.call("newChanges",{type:K,oldRev:i,rev:h}),n.hook.callAll("newChanges",{type:K,msg:e})}catch(e){console.error(e),Object(k.a)("client call newChanges error")}},this.compareAndCollectRangeChange=function(e){var t=e.beforeApplySelection,n=e.afterApplySelection,i=e.beforeApplyPosition,r=e.afterApplyPosition;t.start.offset===n.start.offset&&i.len===r.len||Object(M.default)("doc_character_range_follow",{is_range_change:i.len!==r.len?1:0,is_range:0<i.len?1:0})},this.processAcceptCommitData=function(e){S.engineSyncBuffer.consume();var t=S.rev,n=S.editor,i=e.note_revision,r=e.hasOwnProperty("apool")?e.apool:e.changeset_apool;S.setDataAndHandleError({key:S.getCommittedChangesKey(),needSync:!1,data:null}),n.changesetTracker.applyPreparedChangesetToBase(i,r),S.setRev(i),S.csQueue.resolve(),S.messageSended=null,console.log("post handleAccept rev is ".concat(S.rev));try{n.call("acceptCommit",{type:W,oldRev:t,rev:i})}catch(e){console.error(e),Object(k.a)("client call acceptCommit error")}},this.handleNewChangesItem=function(e){console.log("pre apply cs version ".concat(e.note_revision,", now version this ").concat(S.rev)),S.shouldEnqueue()?S.msgQueue.push(Object.assign({},e,{type:K})):S.pipeToBuffer(e)},this.pipeToBuffer=function(e){S.engineSyncBuffer.pipe(e)},this.handleAcceptCommit=function(e){if(console.log("pre handleAccept rev is ".concat(S.rev,", msg rev is ").concat(e.note_revision)),S.shouldEnqueue())S.msgQueue.push(Object.assign({},e,{type:W}));else{S.processAcceptCommitData(e),S.handleUserChanges();try{Object(L.h)()&&S.lineConflictCollector&&(S.lineConflictCollector.sendTea(e),S.lineConflictCollector=null)}catch(e){console.log(e)}}},this.handleError=function(e){Object(M.default)("dev_client_handle_error",e),S.csQueue.reject();var t=e.code,n=e.msg;if(e.type===R.e.CLIENT_ERROR)return S.editor.fatal(new Error(n),"collab",n,t),void Object(M.collectSuiteEvent)("dev_client_frontend_error");S.handleErrorMessageFromServer(e)},this.handleErrorMessageFromServer=function(e){var t,n,i,r=e.code,o=e.msg,a=e.requestType;void 0===r||(t=S.editor.getDocId())===Object(w.g)()&&(P.includes(r)&&a===V&&(S.setDataAndHandleError({key:S.getCommittedChangesKey(),data:null,token:t}),S.setDataAndHandleError({key:S.getUserChangesKey(),data:null,token:t})),S.shouldIgnoreError(r)||S.isNotOopsRequestType(a)||(i=(n=C.ERROR_CODE_MAP[r])?n.warningText:o,S.editor.fatal(new Error(i),"network",i,r)))},this.handleUserChanges=function(){var e=S.editor;e.profile&&e.profile.start(te),S._handleUserChanges.apply(S,arguments),e.profile&&e.profile.end(te,{minimumUsedTime:20})},this._handleUserChanges=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(S.disabled)return!0===n&&(S.hasUserChangeWhenDisabled=!0),void Object(M.collectSuiteEvent)("dev_client_disabled",{disabled:S.disabled,isFromUserChange:n});var i,r,o=S.editor,a=S.channelState,s=S.initialStartConnectTime,c=S.setChannelState,l=S.lastCommitTime,u=o.changesetTracker.getUserChangeset(),d=o.changesetTracker.getSubmittedChanges().changeset,h=o.changesetHelper,f=u.changeset;if(n&&null!==f&&(o.hooks.callAll("watchdogWillHandleUserChangeset"),o.call(_.config.DID_HANDLE_USER_CHANGESET)),e||f&&!h.isIdentity(f)||t||d&&!h.isIdentity(d))if(Object(w.g)()===o.getDocId()){if(!o.getInInternationalComposition()){S.isCommitting()&&!h.isIdentity(f)&&(r={changeset:(i=h.formatCs(f))[0]||"",zone_changesets:i,apool:u.apool,uuid_v4:u.uuid_v4},S.lastSaveLocalTime=Date.now(),S.setDataAndHandleError({key:S.getUserChangesKey(),memberId:S.sync.memberId,data:Object.assign({baseRev:S.rev},r)}));var p={rev:S.rev,timestamp:ae()};if(a===$)return ae()-s>z?(c(ee,"initsocketfail"),p.branch="connecting_init_socket_fail"):(S.timeout(S.handleUserChanges,1e3),p.branch="connecting_check_again"),void o.call("sendUserChangeMsg",p);var g=ae();if(S.isCommitting()){if(o.mounted){if(S.isCommitting()&&(e||H<g-l)){if(S.editor&&S.editor.call("saveUserChanges",{type:"local",status:"success",rev:S.rev}),S.messageSended&&Number(S.messageSended.onlineRetryTimes)>T.f)return S.editor.log("collab online retry overtimes and stop"),void S.triggerRetryOops();p.force=e,p.lastCommitTime=l,p.currentTime=g,S.messageSended?(console.log("[collab debug]: retry by _handleUserChanges",e,g-l),S.editor.plugins.offline&&S.editor.plugins.offline.retryCommitChangeset(S.messageSended),S.lastCommitTime=g,p.branch="retry_commit_changeset",p.changeset=se(S.messageSended.changeset),p.retrytimes=S.messageSended.retryTimes?S.messageSended.retryTimes+1:1):p.branch="retry_commit_changeset_messageSended_is_null"}else S.isCommitting()&&F<g-l?(S.editor&&S.editor.call("saveUserChanges",{type:"local",status:"success",rev:S.rev}),S.timeout(S.handleUserChanges,3e3),p.branch="slow_commit_check"):(S.timeout(S.handleUserChanges,3e3),p.branch="retry_commit_check");o.call("sendUserChangeMsg",p)}}else{var m=l+B;if(g<m)return S.timeout(S.handleUserChanges,m-g),p.branch="earliest_commit",void o.call("sendUserChangeMsg",p);var v,b,y,E,O,C,k=o.changesetTracker.prepareUserChangeset(),I=k&&k.changeset;console.log("[CLIENT:HANDLEUSERCHANGE]"),I&&!h.isIdentity(I)&&(S.lastCommitTime=g,v=h.formatCs(I),b={type:V,baseRev:S.rev,changeset:v[0]||"",zone_changesets:v,apool:k.apool,uuid_v4:k.uuid_v4,retryTimes:0},S.messageSended=b,S.sendMessage(b),E=(y=S.userLastAction).sendMessageTimes,O=y.startTimeStamp,S.setUserLastAction({startTimeStamp:O,sendMessageTimes:E+1}),S.tiggerAbnormalUserActionOopsIfNecessary(),(C=S.editor.plugins.offline&&S.editor.plugins.offline.submittedSender)&&C.cancel&&C.cancel(),S.setDataAndHandleError({key:S.getCommittedChangesKey(),needSync:!0,data:b}),S.timeout(S.handleUserChanges,3e3),p.branch="normal_commit_changeset",p.changeset=se(b.changeset),o.call("sendUserChangeMsg",p))}}}else Object(M.collectSuiteEvent)("dev_client_token_is_wrong",{getDocId:Object(j.a)(o.getDocId()),getToken:Object(j.a)(Object(w.g)())});else Object(M.collectSuiteEvent)("dev_client_handle_user_change_return",{force:e,isComposition:t})},this.timeout=function(e,t){S.handleUserChangesTimer&&clearTimeout(S.handleUserChangesTimer),S.handleUserChangesTimer=window.setTimeout(e,t)},this.dequeue=function(){var e=S.msgQueue;if(0!==e.length){for(var t=0;t<e.length;t++){var n=e[t],i=n.note_revision;e[t+1]&&e[t+1].note_revision!==i+1?Object(M.collectSuiteEvent)("dequeue_all_msgs_wrong_msgRev"):(Object(M.collectSuiteEvent)("dev_client_apply_by_dequeue",{type:n.type,disableValue:S.disabled,msgQueueLength:e.length,msgRev:i,state:S.isCommitting()}),n.type===W?S.processAcceptCommitData(n):n.type===K&&S.pipeToBuffer(n))}S.msgQueue=[]}},this.sendMessage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if("USER_CHANGES"!==e.type||t)return S._sendMessage(e,!t);S.csQueue.push(e)},this._sendMessage=function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=S.sync,i=S.editor;return t=S.fixMessage(t),e&&i.call("sendMessage",t),"USER_CHANGES"!==Object(m.default)(t,"type")||Object(m.default)(t,"uuid_v4")||(Object(k.a)("DOC_ERROR: USER_CHANGES_NO_UUID_V4"),Object(M.collectSuiteEvent)("dev_user_changes_no_uuid_v4")),n.sendMessage(t.type,t).catch(function(e){throw S.editor&&S.editor.hook.callAll("sendMessageError",{error:e,msg:t}),e})},this.sendMessageUnHandleErrors=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=S.sync,i=S.editor;return e=S.fixMessage(e),t&&i.call("sendMessage",e),n._sendMessage(e.type,e)},this.fixMessage=function(e){var t=S.editor,n=S.sync;return e.token=t.getDocId(),e.member_id=Number(e.member_id||n.memberId),e.user_ticket=n.getTicket(),e.user_id=t.getAuthor(),"USER_CHANGES"===e.type&&S.tryFixBlockAttrs(e),e},this.triggerRetryOops=function(){S.editor.fatal(new Error("collab retry overtimes"),"collab","collab retry overtimes",ie)},this.getDebugInfo=function(){var e=S.editor,t=S.sync,n=S.msgQueue,i=S.messageSended;return{messageSended:Object(g.a)(i,["uuid_v4","retryTimes","onlineRetryTimes","baseRev"]),client:Object.assign({msgQueueLength:n.length,isComposition:e.getInInternationalComposition()},Object(g.a)(S,["disabled","rev","channelState","netState"])),storage:Object(g.a)(S,["userChangesKey","committedChangesKey","storageError"]),io:{state:Object(m.default)(e,"plugins.sync.io.state")},sync:Object(g.a)(t,["version","_receiveClientVars","_isFetching"]),syncBuffer:Object.assign({},Object(g.a)(S.engineSyncBuffer,["runningMode","isFreezing"]),{versionRange:S.engineSyncBuffer&&S.engineSyncBuffer.getBufferVersionRange()})}},this.triggerBrowserPluginsOops=function(e){S.editor.fatal(e,"collab","abnormal user action",ne),S.destory()},this.destory=function(){removeEventListener("online",S.handleOnline),S.sync.unregisterChannelChange(S.handleChannelChange),S.sync.off(q,S.handleMessageFromServer),S.sync.off(K,S.handleNewChangesItem),S.sync.off(W,S.handleAcceptCommit),S.sync.off(Z,S.handleError),S.sync.destroy(),delete S.editor,delete S.sync,S.msgQueue=[],S.collabQueue.unregisterCSQueue(S.csQueue),delete S.collabQueue,delete S.csQueue,S.handleUserChangesTimer&&clearTimeout(S.handleUserChangesTimer),S.destroySyncBuffer(),S.rxOp.destroy()};var t=e.editor,n=e.sync;this.editor=t,this.sync=n,this.msgQueue=[],this.channelState=Q,this.lastCommitTime=0,this.netState="online",this.initialStartConnectTime=0,this.lastSaveLocalTime=0,n.on(K,this.handleNewChangesItem),n.on(W,this.handleAcceptCommit),n.on(q,this.handleMessageFromServer),n.on(Z,this.handleError),this.editor.on(N.c,a()(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.rxOp.toPromise(Promise.all([r.e("doc_index_css"),r.e("chunk_adit"),r.e("commons--doc_index_delay--voteEmoji--votePicker"),r.e(16),r.e("commons--doc_index_delay--jira"),r.e("doc_index_delay")]).then(r.bind(null,"LF2d")));case 2:t=e.sent,S.LoableLineConflictCollector=t.LineConflictCollector;case 4:case"end":return e.stop()}},e)}))),this.handleResetUserAction(),n.registerChannelChange(this.handleChannelChange),this.collabQueue=new y.c(this.editor),this.csQueue=new E(this.collabQueue,this._sendMessage),this.collabQueue.registerCSQueue(this.csQueue),this.disabled=!1,this.initSyncBuffer()}return u()(i,[{key:"isCommitting",value:function(){return null!==this.messageSended}},{key:"shouldEnqueue",value:function(){return this.editor.getInInternationalComposition()||!0===this.disabled}},{key:"shouldIgnoreError",value:function(e){return!!J.includes(e)||e===C.STATUS_CODE.NOTE_DELETED&&I.a.isEnabled()}},{key:"isNotOopsRequestType",value:function(e){return Y.includes(e)}},{key:"aceAfterCompositionStart",value:function(){this.engineSyncBuffer.frozen()}},{key:"aceAfterCompositionEnd",value:function(){this.engineSyncBuffer.deFrozen(),this.dequeue()}},{key:"tryFixBlockAttrs",value:function(e){if(e.apool&&e.apool.numToAttrib)for(var t in e.apool.numToAttrib){var n,i=e.apool.numToAttrib[t];i&&"dataMetaBlockProps"===i[0]&&i[1]&&((n=JSON.parse(i[1])).initData&&(n.initData=unescape(n.initData),i[1]=JSON.stringify(n)))}}},{key:"tiggerAbnormalUserActionOopsIfNecessary",value:function(){var e=U||{},t=Object(f.default)(e.maxSendMessageTimes)?e.maxSendMessageTimes:100,n=Object(f.default)(e.commitDurationMultiple)?e.commitDurationMultiple:4,i=!Object(p.a)(e.oopsEnable)||e.oopsEnable,r=ae()-this.userLastAction.startTimeStamp;this.userLastAction.sendMessageTimes>=t&&(this.userLastAction.sendMessageTimes===t&&Object(M.collectSuiteEvent)("dev_client_abnormal_user_action_times",this.userLastAction.sendMessageTimes),r/this.userLastAction.sendMessageTimes<=B*n&&i&&this.triggerBrowserPluginsOops(new Error("Abnormal user action more than ABNORMAL_USER_ACTION_TIMES")))}}]),i}(),oe=x([S.a],oe);t.b=oe;function ae(){return(new Date).getTime()}function se(e){if(!e)return"";var t=e.indexOf("|");return e.substring(0,t)}function ce(e){e.text=e.texts||e.text,delete e.texts}},GdfX:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("cDf5"),p=n.n(f),g=n("q1tI"),m=n.n(g),v=n("o0o1"),b=n.n(v),y=n("yXPU"),E=n.n(y),O=n("3Hq1"),C=n("YsUP"),k=n("TSYQ"),I=n.n(k),S=n("gQL9"),T=n.n(S),_=n("5wek"),w=n.n(_),j=n("4PSP"),M=(n("eKYS"),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a}),L=1,R=function(e){function n(){var e;return r()(this,n),(e=c()(this,u()(n).apply(this,arguments))).id="".concat(e.props.url).concat(L++),e.btnWidth=16,e.controlWidthWithoutProgressBar=81+e.btnWidth/2,e.controlWidth=e.props.width-e.controlWidthWithoutProgressBar,e.storeIsPlayingOnControlTouch=!1,e.currentTime=0,e.duration=e.props.duration/1e3,e.error=null,e.state={isPlaying:!1,progress:0},e}function t(){return i.apply(this,arguments)}var i;return h()(n,e),a()(n,[{key:"componentDidMount",value:function(){this.handleProgressLeft(),window.addEventListener("resize",this.handleProgressLeft)}},{key:"componentWillUnmount",value:function(){delete n.pool[this.id],window.removeEventListener("resize",this.handleProgressLeft)}},{key:"handleControlPressStart",value:function(){this.storeIsPlayingOnControlTouch=this.state.isPlaying,this.pause()}},{key:"handleAudioCanPlay",value:function(){n.pool[this.id]=this}},{key:"handleControlPressMove",value:function(e){e.preventDefault();var t=e.touches||e.changedTouches||e,n=(t[0]||t).clientX;this.setBtnPosition(n)}},{key:"handleControlPressEnd",value:function(){this.storeIsPlayingOnControlTouch&&this.play()}},{key:"handleProgressLeft",value:function(){var e=this.progressRef&&this.progressRef.getBoundingClientRect();this.progressLeft=e&&e.left}},{key:"handleControlClick",value:function(e){this.storeIsPlayingOnControlTouch=this.state.isPlaying,this.pause(),this.setBtnPosition(e.clientX),this.storeIsPlayingOnControlTouch&&this.play()}},{key:"setBtnPosition",value:function(e){var t,n;this.progressLeft&&(t=e-this.progressLeft,t=Math.max(0,t),n=(t=Math.min(this.controlWidth,t))/this.controlWidth*100,this.setProgress(n))}},{key:"handleTimeUpdate",value:function(){var e=(isNaN(this.audioNode.duration)||this.audioNode.duration===1/0?this:this.audioNode).duration,t=this.audioNode.currentTime/e*100;if(100===t)return this.setState({isPlaying:!1}),this.pause(),void this.setProgress(0);this.setProgress(t)}},{key:"play",value:(i=E()(b.a.mark(function e(){var t=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.error)return e.abrupt("return",this.fireError());e.next=2;break;case 2:if(Object(C.a)(this.currentTime))return e.abrupt("return");e.next=4;break;case 4:return this.audioNode.currentTime=this.currentTime,e.prev=5,e.next=8,this.audioNode.play();case 8:e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(5),e.abrupt("return",this.fireError(e.t0.message));case 13:this.setState({isPlaying:!0}),setTimeout(function(){for(var e in n.pool)e!==t.id&&n.pool[e].stop()}),this.props.logger.logPlayAudioComment();case 16:case"end":return e.stop()}},e,this,[[5,10]])})),t)},{key:"pause",value:function(){this.audioNode.pause(),this.setState({isPlaying:!1})}},{key:"stop",value:function(){this.setProgress(0),this.setState({isPlaying:!1}),this.audioNode.pause(),this.audioNode.currentTime=0}},{key:"togglePlay",value:function(){var e=this.props.onLine;if(!Object(O.default)(e)&&!e)return this.fireError();this.state.isPlaying?this.pause():this.play()}},{key:"setProgress",value:function(e){var t=this.props.onLine;(Object(O.default)(t)||t)&&(this.currentTime=this.duration*e/100,this.setState({progress:e}))}},{key:"parseDuration",value:function(e){e=0===e?this.props.duration/1e3:e;var t=Math.floor(e/60),n=Math.floor(e%60);return{minutes:t,seconds:n=n<10?"0".concat(n):n}}},{key:"handleAudioLoadFail",value:function(){this.error="audio load error"}},{key:"fireError",value:function(e){this.props.handleCaptureError&&(e=e||this.error,this.props.handleCaptureError(e))}},{key:"render",value:function(){var t=this,e=this.props,n=e.url,i=e.isMove,r=this.state,o=r.progress,a=r.isPlaying,s=(a?T:w).a,c=this.controlWidth*(o/100),l=c-this.btnWidth/2,u={transform:"translateX(".concat(l,"px)")},d={width:"".concat(c,"px")},h=I()("audio-control-btn",{"audio-control-btn-highlight":i||a}),f=this.parseDuration(this.duration*(o/100)),p=f.minutes,g=f.seconds;return m.a.createElement("div",{className:"audio-container",style:{width:this.props.width}},m.a.createElement("audio",{src:n,className:"audio",onTimeUpdate:this.handleTimeUpdate,onCanPlay:this.handleAudioCanPlay,onError:this.handleAudioLoadFail,preload:"none",ref:function(e){return t.audioNode=e}}),m.a.createElement("div",{className:"audio-control-container"},m.a.createElement("img",{src:s,alt:"xxx",className:"audio-play-btn",onClick:this.togglePlay}),m.a.createElement("div",{className:"audio-control",style:{width:this.controlWidth},onClick:this.handleControlClick},m.a.createElement("div",{className:h,style:u,ref:function(e){return t.controlBtnRef=e}}),m.a.createElement("div",{className:"audio-control-progress",ref:function(e){return t.progressRef=e}},m.a.createElement("div",{className:"audio-control-progress-played",style:d}))),m.a.createElement("div",{className:"audio-played-time"},"".concat(p,":").concat(g))))}}]),n}(g.PureComponent);R.pool={},M([Object(j.Bind)()],R.prototype,"handleControlPressStart",null),M([Object(j.Bind)()],R.prototype,"handleAudioCanPlay",null),M([Object(j.Bind)()],R.prototype,"handleControlPressMove",null),M([Object(j.Bind)()],R.prototype,"handleControlPressEnd",null),M([Object(j.Bind)()],R.prototype,"handleProgressLeft",null),M([Object(j.Bind)()],R.prototype,"handleControlClick",null),M([Object(j.Bind)()],R.prototype,"handleTimeUpdate",null),M([Object(j.Bind)()],R.prototype,"stop",null),M([Object(j.Bind)()],R.prototype,"togglePlay",null),M([Object(j.Bind)()],R.prototype,"handleAudioLoadFail",null);var N=R,D=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},x={1:125,2:140,3:155,4:170,5:185,6:200},P=function(e){function t(){var e;return r()(this,t),(e=c()(this,u()(t).apply(this,arguments))).isMouseDown=!1,e.state={isMove:!1},e}return h()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.bindEvents()}},{key:"componentWillUnmount",value:function(){this.unBindEvents()}},{key:"bindEvents",value:function(){this.baseAudioRef&&(document.addEventListener("mousedown",this.handleControlMouseDown),document.addEventListener("mousemove",this.handleControlMouseMove),document.addEventListener("mouseup",this.handleControlMouseUp))}},{key:"unBindEvents",value:function(){this.baseAudioRef&&(document.removeEventListener("mousedown",this.handleControlMouseDown),document.removeEventListener("mousemove",this.handleControlMouseMove),document.removeEventListener("mouseup",this.handleControlMouseUp))}},{key:"handleControlMouseDown",value:function(e){var t=this.baseAudioRef;t&&e.target===t.controlBtnRef&&(this.setState({isMove:!0}),t.handleControlPressStart())}},{key:"handleControlMouseMove",value:function(e){this.baseAudioRef&&this.state.isMove&&this.baseAudioRef.handleControlPressMove(e)}},{key:"handleControlMouseUp",value:function(e){var t=this.baseAudioRef;t&&(this.setState({isMove:!1}),e.target===t.controlBtnRef&&t.handleControlPressEnd())}},{key:"render",value:function(){var t=this,e=x[Math.ceil(this.props.duration/1e3/10)],n=this.props,i=n.duration,r=n.url,o={logPlayAudioComment:function(){}};return m.a.createElement(N,{ref:function(e){return t.baseAudioRef=e},duration:i,url:r,width:e,isMove:this.state.isMove,logger:o})}}]),t}(g.Component);D([Object(j.Bind)()],P.prototype,"handleControlMouseDown",null),D([Object(j.Bind)()],P.prototype,"handleControlMouseMove",null),D([Object(j.Bind)()],P.prototype,"handleControlMouseUp",null);t.a=P},Geka:function(e,t,n){},GixS:function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"j",function(){return r}),n.d(t,"g",function(){return o}),n.d(t,"h",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return h});var i="table-toolbar-perf-adaptor",r="table-will-delete-cell",o=3,a=19,s=14,c=30,l=30,u=-5,d=1,h=0},GlHY:function(e,t,n){"use strict";var i=n("Ngi8"),r={wrapper:{position:"relative",border:"solid 1px ".concat(i.N300),backgroundColor:i.N100,display:"block",width:"100%",height:"100%"},content:{position:"absolute",top:0,left:0,bottom:0,right:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},contentRetryable:{cursor:"pointer"},loadFailureIcon:{maxWidth:54,maxHeight:54,height:"60%",width:"60%"},descriptionText:{color:i.N900,marginTop:24,fontSize:14,lineHeight:"20px",display:"flex",whiteSpace:"normal"},descriptionBtn:{paddingLeft:2,color:i.B500,cursor:"pointer"}};t.a=r},GuAe:function(e,t,n){"use strict";var i=n("q1tI"),a=n.n(i),r=n("TSYQ"),s=n.n(r),c=n("UlbS"),o=function(e){var t=e.list;return a.a.createElement("ul",{className:"comment-more-dropdown"},t.map(function(t){if(!t.visible)return null;var n=t.children,i=t.onClick;if(n){var e=function(){var e="layout-row layout-cross-center item";return a.a.createElement(a.a.Fragment,null,a.a.createElement("ul",{className:"navigation-bar__translate"},Object.keys(n).map(function(t){return a.a.createElement("li",{key:t,className:e,onClick:function(e){return i(e,t)}},a.a.createElement("span",null,n[t]))})),a.a.createElement("div",{className:"comment-item-menu-popover__left"}))},r="layout-row layout-cross-center layout-row-createFile item item-arrow-right";return a.a.createElement(c.Popover,{key:t.id,className:"comment-item-menu-popover",placement:"left",arrow:!1,gap:4,hideDelay:500,adjustPlacements:["bottomLeft"],content:e()},a.a.createElement("li",{className:r},a.a.createElement("span",null,t.text)))}var o=s()("layout-row layout-cross-center layout-row-createFile item",t.className);return a.a.createElement("li",{className:o,onClick:function(e){return t.onClick(e)},key:t.id},t.text)}))};t.a=o},Guq5:function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{}).A_PANEL="a_panel",r.BLOCK_MENU="block_menu"},"H3z/":function(e,t,n){},H6Gw:function(e,t,n){"use strict";var i=n("lwsE"),a=n.n(i),r=n("W8MJ"),s=n.n(r),o=n("a1gu"),c=n.n(o),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("hMnB"),p=n.n(f),g=n("q1tI"),m=(n("17x9"),n("c/bE")),v=function(e){function o(){var e,r;a()(this,o);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(r=c()(this,(e=u()(o)).call.apply(e,[this].concat(n)))).canLeavePage=function(){return!r.props.hasUnSaveData()},r.handleBeforeUnload=function(e){if(r.props.hasUnSaveData()){var t=r.props.getUnSaveTip();return e.returnValue=t}},r.defaultHandleHistoryChange=function(e){if(e.pathname!==p.a.pathname){var t=r.props,n=t.hasUnSaveData,i=t.getUnSaveTip;return n()?i():void 0}},r}return h()(o,e),s()(o,[{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",this.handleBeforeUnload),this.setSoftRoutingBlock(!0),m.a.addCanLeavePageHandler(this.canLeavePage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload),this.setSoftRoutingBlock(!1),m.a.removeCanLeavePageHandler(this.canLeavePage)}},{key:"setSoftRoutingBlock",value:function(e){this.props.allowSoftRouting||(e?this.blockSoftRouting():this.unblockSoftRouting())}},{key:"blockSoftRouting",value:function(){var e=this.props.history;0===o.blockFns.length&&(o.removeBlockListener=e.block(function(){for(var e=o.blockFns,t=0;t<e.length;t++){var n=e[t].apply(void 0,arguments);if(n)return n}})),o.blockFns.push(this.handleHistoryChange)}},{key:"unblockSoftRouting",value:function(){var e,t,n=this;this.props.allowSoftRouting||(e=o.blockFns,t=o.removeBlockListener,o.blockFns=e.filter(function(e){return e!==n.handleHistoryChange}),o.blockFns.length<=0&&t())}},{key:"render",value:function(){if(this.props.children){var e=g.Children.only(this.props.children);return Object(g.cloneElement)(e)}return null}},{key:"handleHistoryChange",get:function(){return this.props.handleHistoryChange||this.defaultHandleHistoryChange}}]),o}(g.Component);v.defaultProps={allowSoftRouting:!1},v.blockFns=[],v.removeBlockListener=function(){},t.a=v},"HJz/":function(e,m,v){"use strict";(function(l){var e=v("lwsE"),n=v.n(e),t=v("W8MJ"),i=v.n(t),r=v("a1gu"),o=v.n(r),a=v("Nsbk"),s=v.n(a),c=v("7W2i"),u=v.n(c),d=v("q1tI"),h=v.n(d),f=v("svPQ"),p=v("r06y"),g=function(e){function t(){var c;return n()(this,t),(c=o()(this,s()(t).apply(this,arguments))).handleCheckboxChange=function(e){(0,c.props.onChange)({shouldNotify:e.target.checked})},c.renderCheckbox=function(){var e=c.props,t=e.showCheckbox,n=e.shouldNotify,i=e.checkboxDisabled;return t?h.a.createElement(f.a,{style:{marginRight:8},disabled:i,checked:n,onChange:c.handleCheckboxChange}):null},c.renderUser=function(){var e=c.props,t=e.users,i=e.lang;if(!t)return null;var n=Object.values(t),r=n.length,o=35,a=0,s=!1;return h.a.createElement("p",{className:"user-text"},h.a.createElement("span",null,l("reminder.popover.remind"),""),n.map(function(e,t){var n="",n=i===p.a.EN?e.en_name||e.name||e.cn_name||n:e.name||e.cn_name||e.en_name||n;return a+=n.length,o<a&&!s?(s=!0,h.a.createElement("span",{className:"user-text--end",key:t},"...",l("reminder.popover.lastPeople",r-t))):s?null:h.a.createElement("span",{key:t},n,t!==r-1?"":null)}))},c}return u()(t,e),i()(t,[{key:"render",value:function(){return h.a.createElement("div",{className:"reminder-popover-user-wrapper"},h.a.createElement("div",{className:"row"},this.renderCheckbox(),this.renderUser()))}}]),t}(h.a.Component);m.a=g}).call(this,v("2vAP"))},HWuX:function(e,t,n){},HcED:function(e,t,n){"use strict";function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("a");t.style="display: none",t.setAttribute("id","tempAnchorForOpenLinkInNewTab"),t.setAttribute("href",e),t.setAttribute("target","_blank"),document.getElementById("tempAnchorForOpenLinkInNewTab")||document.body.appendChild(t),t.click(),document.body.removeChild(t)}n.d(t,"a",function(){return i})},HiAM:function(e,t,n){"use strict";n.d(t,"a",function(){return L}),n.d(t,"b",function(){return R}),n.d(t,"c",function(){return o});var i=n("J4zp"),k=n.n(i),I=n("UXvI"),S=n("q1tI"),T=n.n(S),_=n("toa8"),w=n("96li"),r=n("8wh8"),j=n("1dfU"),M=n("2ACu"),L="comment-image-cover",R="comment-image-placeholder",N=Object(r.b)(),D=function(e){var t=e.token&&N[e.token]?N[e.token]:e.coverSrc||e.src;return t},o=function(e){var c=e.imageItem,n=e.canEdit,t=e.onClick,i=e.onMouseDown,r=e.onLoad,l=e.onError,o=e.imageStatus,a=e.canLoadCover,s=D(c),u=Object(S.useState)(0===s.indexOf("blob:")),d=k()(u,2),h=d[0],f=d[1],p=Object(S.useState)(!1),g=k()(p,2),m=g[0],v=g[1],b=Object(S.useState)(s),y=k()(b,2),E=y[0],O=y[1],C=Object(S.useCallback)(function(){var r=!1,o=0,e=setTimeout(function(){r=!0},1e4),a=function(){s.cancel(),clearTimeout(e)},t=function(){_.d.get(E,{responseType:"blob"}).then(function(e){var t,n,i;e&&e.data&&e.data instanceof Blob?"application/json"===(t=e.data).type?((n=new FileReader).readAsText(t,"utf-8"),n.onload=function(){var e;"string"==typeof n.result?(90002004===(e=JSON.parse(n.result)).code?r?(O(c.src),v(!0),a()):s():90002006===e.code?(O(c.src),v(!0),a()):l(),Object(M.default)("dev_comment_image",{status:"downloadCoverFailed",image_token:c.token?Object(j.a)(c.token):"",reason:n.result})):l()},n.onerror=function(){l()}):(i=URL.createObjectURL(e.data),O(i),a(),c.token&&(N[c.token]=i,Object(M.default)("dev_comment_image",{status:"downloadCoverSuccess",image_token:Object(j.a)(c.token),duration:(new Date).getTime()-o})),f(!0)):l()}).catch(function(e){console.error(e),l()})},s=Object(I.default)(t,1e3,{leading:!0});return-1!==E.indexOf("blob:")||n||(o=(new Date).getTime(),s()),function(){s.cancel(),clearTimeout(e)}},[E,c]);return Object(S.useEffect)(function(){var e=null;return a&&(e=C()),function(){e&&e()}},[]),Object(S.useEffect)(function(){var e=null;return a&&(e=C()),function(){e&&e()}},[a]),Object(S.useEffect)(function(){var e;c.coverSrc&&(e=D(c),O(e))},[c.token]),o===w.a.READY||o===w.a.UPLOADING||o===w.a.LOADING&&(h||m)?T.a.createElement("img",{className:L,src:E,onMouseDown:i,onClick:t,onLoad:r,onError:l}):T.a.createElement("span",{className:R,"data-src":E})}},HjLD:function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{}).Readable="readable",r.Editable="editable"},HmyT:function(e,t,n){"use strict";n.r(t),n.d(t,"jQuery",function(){return i}),n.d(t,"$",function(){return i});var i=n("EVdn");(window.jQuery=window.$=i).expr.cacheLength=1},"I4N/":function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var i=n("FnDM"),r=n("AiBH");function o(e){var t=e.source,n=e.isWhole;return t===r.z.DOC?"doc":t===r.z.SHEET?"sheet":n?"full_comment":"part_comment"}function a(e){var t="full_comment"===e||"part_comment"===e;return"doc"===Object(i.f)()?t?r.z.DOC_COMMENT:r.z.DOC:t?r.z.SHEET_COMMENT:r.z.SHEET}},IESS:function(e,t,n){"use strict";n.d(t,"a",function(){return w});var i=n("QILm"),s=n.n(i),r=n("o0o1"),c=n.n(r),o=n("yXPU"),a=n.n(o),l=n("lwsE"),u=n.n(l),d=n("W8MJ"),h=n.n(d),f=n("Bw5p"),p=n("K9Ia"),g=n("p0ib"),m=n("kERW"),v=n("p0Sj"),b=n("15JJ"),y=n("67Y/"),E=n("ad02"),O=n("0mNj"),C=n("EVj1"),k=n("ucr6"),I=n("VI8A"),S=n("1lbP"),T=n("iP/4"),_=n("5dbN"),w=function(){function i(e){var t=this;u()(this,i),this.props=e,this.rxOp=new S.a,this.fileChange$=new p.a,this.isAllNecessaryDataLoaded$=new p.a,this.afterAnimationFrame=new I.a;var n=this.fileChange$.pipe(Object(v.a)(void 0),Object(b.a)(function(){return t.isAllNecessaryDataLoaded$.pipe(Object(S.b)(function(e){return!0===e}))}));Object(g.a)(n,this.isUrlSearchChanged$).pipe(this.rxOp.takeUntil()).subscribe(function(){return t.scrollToSystemReactionMessage()})}function e(){return t.apply(this,arguments)}var t,n;function r(){return n.apply(this,arguments)}return h()(i,[{key:"scrollToSystemReactionMessage",value:(n=a()(c.a.mark(function e(){var t,n,i,r,o,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getSystemCommentIdReplyId(),n=t.commentId,i=t.replyId,this.removeSystemReactionId(),n&&i)return e.next=5,this.props.scrollToCommentMessageReply({commentId:n,replyId:i},void 0);e.next=6;break;case 5:return e.abrupt("return");case 6:if(null===(r=this.getSystemReactionMessageId()))return e.abrupt("return");e.next=9;break;case 9:if((o=this.props.getCommentMessageMap()).has(r)){e.next=12;break}return e.abrupt("return");case 12:return a=o.get(r),e.next=15,this.props.scrollToCommentMessageReply(a,r);case 15:case"end":return e.stop()}},e,this)})),r)},{key:"destroy",value:function(){this.rxOp.destroy(),this.fileChange$.complete(),this.isAllNecessaryDataLoaded$.complete(),this.afterAnimationFrame.cancel()}},{key:"hasSystemReactionMessage",value:function(){return Boolean(this.getSystemReactionMessageId())}},{key:"shouldHandleSystemReactionMessageId",value:function(e,t){return T.a.isFeed&&"push"===e&&t||!T.a.isFeed&&t?t:null}},{key:"getSystemReactionMessageId",value:function(){var e=Object(C.l)(k.a.location.search),t=e.sourceType,n=e.last_doc_message_id,i=this.shouldHandleSystemReactionMessageId(t,n);return i||null}},{key:"getSystemCommentIdReplyId",value:function(){var e=Object(C.l)(k.a.location.search);return{commentId:e.comment_id,replyId:e.reply_id}}},{key:"removeSystemReactionId",value:(t=a()(c.a.mark(function e(){var t,n,i,r,o,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(C.l)(k.a.location.search),n=t.last_doc_message_id,i=t.comment_id,r=t.reply_id,o=s()(t,["last_doc_message_id","comment_id","reply_id"]),i&&r)return k.a.replace({search:Object(C.d)(o)}),e.abrupt("return");e.next=4;break;case 4:a=Object(_.locateRoute)().isSlide,this.shouldHandleSystemReactionMessageId(o.sourceType,n)&&!a&&k.a.replace({search:Object(C.d)(o)});case 7:case"end":return e.stop()}},e,this)})),e)},{key:"isUrlSearchChanged$",get:function(){return Object(m.a)(function(e){return k.a.listen(function(){return e()})},function(e,t){return t()}).pipe(Object(v.a)(void 0),Object(y.map)(function(){return Object(f.a)(k.a.location,"pathname","search")}),Object(E.distinctUntilChanged)(function(e,t){return e.pathname!==t.pathname||e.search===t.search}),Object(O.a)(1))}}]),i}()},IGcA:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("FJEn"),c=function(){function n(e){var t=this;r()(this,n),this.editor=e,this.className="UserChangeDetector",this.handleChangeset=function(e){e.applyingNonUserchanges||!t.editor.changesetTracker.hasChangesetNeedToCollab(e.cs)||t.editor.changesetHelper.isIdentity(e.cs)||t.editor.call(s.config.WILL_HANDLE_USER_CHANGESET,s.config.UserChangesetType.perform)},this.handleDirtydomWithoutChangeset=function(){t.editor.call(s.config.DID_HANDLE_USER_CHANGESET)},this.editor.on(s.config.READY_TO_PERFORM_CHANGESET,this.handleChangeset),this.editor.on(s.config.DIRTYDOM_WITHOUT_CHANGESET,this.handleDirtydomWithoutChangeset)}return a()(n,[{key:"destroy",value:function(){this.editor.off(s.config.READY_TO_PERFORM_CHANGESET,this.handleChangeset),this.editor.off(s.config.DIRTYDOM_WITHOUT_CHANGESET,this.handleDirtydomWithoutChangeset)}}]),n}()},IQA7:function(e,t,n){},IQRI:function(e,t){e.exports='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g id="-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="icon_global_maybe_nor">\n            <rect id="bg" fill-rule="nonzero" x="0" y="0" width="24" height="24"></rect>\n            <path d="M12,4 C16.418278,4 20,7.581722 20,12 C20,16.418278 16.418278,20 12,20 C7.581722,20 4,16.418278 4,12 C4,7.581722 7.581722,4 12,4 Z M12,5.45454545 C8.38504527,5.45454545 5.45454545,8.38504527 5.45454545,12 C5.45454545,15.6149547 8.38504527,18.5454545 12,18.5454545 C15.6149547,18.5454545 18.5454545,15.6149547 18.5454545,12 C18.5454545,8.38504527 15.6149547,5.45454545 12,5.45454545 Z M12,14.9090909 C12.4016616,14.9090909 12.7272727,15.234702 12.7272727,15.6363636 C12.7272727,16.0380253 12.4016616,16.3636364 12,16.3636364 C11.5983384,16.3636364 11.2727273,16.0380253 11.2727273,15.6363636 C11.2727273,15.234702 11.5983384,14.9090909 12,14.9090909 Z M11.8967187,7.63636364 C12.761226,7.63636364 13.4794066,7.84571757 14.0512821,8.26443171 C14.6231575,8.68314585 14.9090909,9.3034538 14.9090909,10.1253742 C14.9090909,10.6293819 14.784772,11.0539052 14.5361305,11.3989566 C14.3907709,11.6083137 14.1115316,11.8758215 13.6984042,12.2014881 L13.2910167,12.5213376 C13.069152,12.6958018 12.9218819,12.8993403 12.8492021,13.1319593 C12.8466543,13.1401365 12.8441462,13.1492184 12.841678,13.159205 C12.7460124,13.5462633 12.3987054,13.8181818 12,13.8181818 C11.6105931,13.8181818 11.2949165,13.5025052 11.2949165,13.1130983 C11.2949165,13.0844627 11.2966609,13.0558538 11.3001763,13.0274348 C11.3347807,12.7447356 11.3710557,12.5556825 11.4090013,12.4602754 C11.5084579,12.21021 11.764746,11.9223483 12.1778734,11.5966818 L12.5967366,11.2652014 C12.7344457,11.1605229 13.4440479,10.6608353 13.4440479,10.2184213 C13.4440479,9.77600721 13.366978,9.61328303 13.1448487,9.37047768 C12.9227194,9.12767232 12.4226907,9.0495168 11.9713107,9.0495168 C11.5275813,9.0495168 11.1483997,9.16735539 10.9628749,9.46588307 C10.8769486,9.60414697 10.8066857,9.7516454 10.7560092,9.90213545 C10.7459866,9.9318988 10.7365386,9.96552197 10.7276652,10.003005 C10.6760882,10.2208395 10.4994429,10.3826799 10.2846967,10.4197364 L10.1905834,10.4277773 L10.1905834,10.4277773 L9.60002309,10.4277773 L9.60002309,10.4277773 C9.34492086,10.4277773 9.13811965,10.2209761 9.13811965,9.96587386 C9.13811965,9.94391 9.13968624,9.9219741 9.14278116,9.90022936 C9.14699864,9.8708528 9.15126034,9.84417499 9.15556625,9.82019595 C9.29733964,9.03067798 9.6563961,8.45006258 10.2327416,8.07833747 C10.6841216,7.78368677 11.238775,7.63636364 11.8967187,7.63636364 Z" id="fill-area" fill="#646A73"></path>\n        </g>\n    </g>\n</svg>\n'},IU78:function(e,t,n){},Ibn6:function(e,t,n){"use strict";function i(){var e=!1,t={get passive(){e=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch(e){}return e}t.a=i()},IcLG:function(e,t,n){"use strict";n.d(t,"b",function(){return y}),n.d(t,"a",function(){return E});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("q1tI"),u=n.n(l),d=n("YWBl"),h=n("7Kxq"),f=n("YNKm"),p=n("F9bh"),g=n("y2sV"),m=n("Nl7c"),v=n("OWch"),b=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},y="IGNORE_BOLD",E=function(){function t(e){var a=this;r()(this,t),this.editor=e,this.className="Bold",this.aceInitialized=function(e,t){a.init(t.editorInfo)},this.init=function(e){e.commands.registerAceCommand(f.i,function(e,t,n,i){var r=i.source,o=a.toggleAttribute({attribKey:"bold",attribValue:!0});Object(d.a)({action:"bold",op:o?h.g:h.f,source:r})},{statusKey:"bold-true"})},this.aceAttribsToClasses=function(e,t){return"bold"===t.key?["tag:b"]:[]},this.editor=e,this.init(e)}return a()(t,[{key:"toggleAttribute",value:function(e){var t=e.attribKey,n=e.attribValue,i=e.range,r=e.isSpecialSelection,o=e.isAllHasAttrib,a=i.selStart,s=i.selEnd,c=i.attributeManager;return r?(c.setAttributesOnRange(a,s,[[t,o?"":n]]),o):this.editor.toggleAttributeOnSelection(t,i,n)}},{key:"match",value:function(e){return"bold"===e}},{key:"isBoldElement",value:function(e){var t=e.tagName,n=e.getAttribute("style")||"";return"B"===t||"STRONG"===t||/\bfont-weight:\s*bold\b/i.test(n)}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;return t&&t instanceof HTMLElement&&this.isBoldElement(t)?Object(g.H)(n,i,{bold:"true"}):n}},{key:"serialize",value:function(e){return Object(g.P)(e,{tagAttribute:"bold",wrapTag:g.a.bold})}},{key:"render",value:function(e){var t=e.children;return u.a.createElement(g.w,{style:{fontWeight:"bold"}},t)}}]),t}();b([Object(p.a)()],E.prototype,"toggleAttribute",null),b([v.a,Object(m.b)()],E.prototype,"render",null)},IrCn:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("lwsE"),r=n.n(i),c=n("FJEn"),l=n("iP/4"),o=function e(t){var s=this;r()(this,e),this.changesetApply=function(e,t){!t.isRemote&&s.editor.isEditable()&&s.addLastEmptyLineIfNecessary()},this.addLastEmptyLineIfNecessary=function(){var e,t,n,i,r,o,a=s.editor;a&&(t=(e=a.getContentState().getZoneState(c.DEFAULT_REP_ZONE)).lines.length-1,i=(n=e.getLine(t)).isEmpty(),r=n.length()-1,i&&0!==t||(o=[t,r],a.performDocumentReplaceRangeWithAttributes(c.DEFAULT_REP_ZONE,o,o,"\n",[["lineguid",Object(c.genGuid)()]],!0),0===t&&l.a.isLark&&l.a.isFeed&&(a.selection.setWithSelection(c.DEFAULT_REP_ZONE,[1,0],[1,0]),a.selection.updateBrowserSelectionFromRep(!0))))},t&&(this.editor=t)}},It3V:function(e,t,n){},J21X:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("ucr6"),u=n("4PSP"),d=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},h="",f=function(){function t(e){r()(this,t),this.needReminderCount=0,this.unsavedTip=e.unsavedTip||h,window.addEventListener("beforeunload",this.handleBeforeUnload)}return a()(t,[{key:"addReminder",value:function(){var t=this;this.needReminderCount++,1<this.needReminderCount||(this.unblock=l.a.block(function(e){if(e.pathname!==window.location.pathname)return t.unsavedTip}))}},{key:"removeReminder",value:function(){this.needReminderCount=Math.max(0,this.needReminderCount-1),0===this.needReminderCount&&this.unblock&&this.unblock()}},{key:"handleBeforeUnload",value:function(e){0<this.needReminderCount&&(e.preventDefault(),e.returnValue=this.unsavedTip)}},{key:"destroy",value:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload),this.needReminderCount=0,this.unblock&&this.unblock()}}]),t}();d([u.Bind],f.prototype,"handleBeforeUnload",null)},JO1u:function(e,t,i){"use strict";i.d(t,"b",function(){return g}),i.d(t,"a",function(){return v}),i.d(t,"c",function(){return E});var n=i("o0o1"),r=i.n(n),o=i("yXPU"),a=i.n(o),s=i("MXQz"),c=i("F2jy"),l=i("rlTC"),u=i("kUgE"),d=i("iP/4"),h=i("VIFs"),f=i("skFV"),p=i("U6jp"),g=Object(s.a)(a()(r.a.mark(function e(){var t,n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(u.getLocale)().replace("-","_"),n=Object(h.getDomainConfig)("domain"),d.a.isLark)return e.next=5,Object(p.h)("env");e.next=6;break;case 5:i=e.sent;case 6:Object(c.d)({env:{locale:t,appVersion:"3.36.0",isOverseaPkg:i&&i.isOverseaRaw},domains:{1:[n.lark_api],2:[n.lark_file],9:[n.passport],63:[n.applink]}});case 7:case"end":return e.stop()}},e)}))),m=new Map,v=function(){var t=a()(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=b(t),m.has(t)){e.next=6;break}return e.next=4,i("0zrf")("./"+t);case 4:n=e.sent,m.set(t,{emoji:n.default});case 6:return e.abrupt("return",m.get(t));case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),b=function(e){return["ru-RU","it-IT","de-DE","id-ID","hi-IN","en-US","es-ES","ja-JP","th-TH","fr-FR","zh-CN","pt-BR","ko-KR","vi-VN"].includes(e)?e:"en-US"},y=function(){return!!l.a.isOverseaPkg},E=function(){return(d.a.isLark?y:Object(f.y))()}},JPM6:function(e,t,B){"use strict";B.d(t,"f",function(){return q}),B.d(t,"e",function(){return c}),B.d(t,"a",function(){return l}),B.d(t,"g",function(){return u}),B.d(t,"d",function(){return d}),B.d(t,"b",function(){return h}),B.d(t,"c",function(){return f});var n=B("lwsE"),U=B.n(n),i=B("W8MJ"),z=B.n(i),r=B("o0o1"),H=B.n(r),o=B("yXPU"),F=B.n(o),a=B("NVF8"),V=B("rLED"),W=B("D7h9"),K=B("2ACu"),s=null,Z=null,q=function(){var e=F()(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=s||new Promise(function(t,n){(Object(V.pb)()?Object(a.a)("sheet").then(function(e){return e.bridge()}):Promise.all([B.e("sheet_packages--faster"),B.e("doc_index_css"),B.e("commons--PCDocSheetBridge--bear-bitable-external--bear-external--bear-sheet-external--btn_groups--d--dba25785"),B.e("commons--PCDocSheetBridge--bear-bitable-external--bear-sheet-external--btn_groups--create-by-templa--5eb3c3ae"),B.e("commons--PCDocSheetBridge--btn_groups--sheet-template-preview--spread--template-spreadsheet--utils_store"),B.e("PCDocSheetBridge")]).then(B.bind(null,"Iioh"))).then(function(e){Z=e.PCDocSheetBridge,t()},function(e){console.error("load PCDocSheetBridge error",e),n(e)})}),e.abrupt("return",s);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),c=function(){return!!Z},l=function(){function n(e){var i=this;U()(this,n),this.bridge=null,this.sheetEnterBufferWithoutBridge=new Set,this.loadPromise=null,this.pasteSheet=function(e,t,n){if(!i.bridge)throw new Error("sheet bridge not ready");return i.bridge.pasteSheet(e,t,n)},this.getHtmlWhilePastingSheet=function(e){if(!i.bridge)throw new Error("sheet bridge not ready");return i.bridge.getHtmlWhilePastingSheet(e)},this.wakeup=function(e){if(i.bridge)return i.bridge.wakeup(e)},this.suspend=function(e){if(i.bridge)return i.bridge.suspend(e)};var t=Date.now();this.loadPromise=Promise.all([Z?Promise.resolve():q(),this.loadSheetAsyncModule()]).then(function(){i.logLoadPerf("success",t),i.bridge=new Z(e)},function(e){throw i.logLoadPerf("error",t),e})}function e(e){return t.apply(this,arguments)}var t,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y;function E(e){return i.apply(this,arguments)}function O(e,t){return r.apply(this,arguments)}function C(e,t,n){return o.apply(this,arguments)}function k(e){return a.apply(this,arguments)}function I(e,t){return s.apply(this,arguments)}function S(e,t,n){return c.apply(this,arguments)}function T(e,t){return l.apply(this,arguments)}function _(){return u.apply(this,arguments)}function w(){return d.apply(this,arguments)}function j(e){return h.apply(this,arguments)}function M(e){return f.apply(this,arguments)}function L(e){return p.apply(this,arguments)}function R(e){return g.apply(this,arguments)}function N(e){return m.apply(this,arguments)}function D(e){return v.apply(this,arguments)}function x(){return b.apply(this,arguments)}function P(e){return y.apply(this,arguments)}return z()(n,[{key:"highlightHistory",value:(y=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:this.bridge.highlightHistory(t);case 4:case"end":return e.stop()}},e,this)})),P)},{key:"loadSheetAsyncModule",value:(b=F()(H.a.mark(function e(){var t,n,i;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([B.e("commons--PCDocSheetBridge--bear-bitable-external--bear-external--bear-sheet-external--btn_groups--d--dba25785"),B.e("sheet_module")]).then(B.bind(null,"pZkr"));case 2:t=e.sent,n=t.getSheetModule(),i=W.default.addModule(n),this.sheetModuleRemoveHandler=i.remove;case 6:case"end":return e.stop()}},e,this)})),x)},{key:"logLoadPerf",value:function(e,t){Object(K.collectSuiteEvent)("sheet_performance_stage",{stage:"load_doc_sheet_resource",type:e,time_cost:Date.now()-t,isSheetGarrEnable:Object(V.pb)()?1:0})}},{key:"waitUntilBridgeReady",value:function(){if(!this.bridge)return this.loadPromise}},{key:"fetchClientVars",value:(v=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.fetchClientVars(t));case 4:case"end":return e.stop()}},e,this)})),D)},{key:"mountSheet",value:(m=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.mountSheet(t));case 4:case"end":return e.stop()}},e,this)})),N)},{key:"setOnSheetCommentLoaded",value:(g=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.setOnSheetCommentLoaded(t));case 4:case"end":return e.stop()}},e,this)})),R)},{key:"setOnSheetCommentBatchUpdate",value:(p=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.setOnSheetCommentBatchUpdate(t));case 4:case"end":return e.stop()}},e,this)})),L)},{key:"unmountSheet",value:(f=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.unmountSheet(t));case 4:case"end":return e.stop()}},e,this)})),M)},{key:"unmountSheetData",value:(h=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.unmountSheetData(t));case 4:case"end":return e.stop()}},e,this)})),j)},{key:"destroy",value:(d=F()(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sheetEnterBufferWithoutBridge.clear(),this.bridge){e.next=4;break}return e.next=4,this.waitUntilBridgeReady();case 4:return this.sheetModuleRemoveHandler(),e.abrupt("return",this.bridge.destroy());case 6:case"end":return e.stop()}},e,this)})),w)},{key:"enterTranslateMode",value:(u=F()(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:if(this.bridge)return e.abrupt("return",this.bridge.enterTranslateMode());e.next=5;break;case 5:case"end":return e.stop()}},e,this)})),_)},{key:"exitTranslateMode",value:function(){if(this.bridge)return this.bridge.exitTranslateMode()}},{key:"handleCopy",value:function(e){return this.bridge?this.bridge.handleCopy(e):""}},{key:"getSearchResult",value:function(e,t){return this.bridge?this.bridge.getSearchResult(e,t):[]}},{key:"highlightSearchItem",value:function(e,t,n){this.bridge&&this.bridge.highlightSearchItem(e,t,n)}},{key:"clearSearchResult",value:function(e,t){this.bridge&&this.bridge.clearSearchResult(e,t)}},{key:"replaceSearchItem",value:function(e,t){this.bridge&&this.bridge.replaceSearchItem(e,t)}},{key:"setWidth",value:function(e,t,n){if(this.bridge)return this.bridge.setWidth(e,t,n)}},{key:"setMaxWidth",value:function(e){if(this.bridge)return this.bridge.setMaxWidth(e)}},{key:"setSize",value:function(e,t){if(this.bridge)return this.bridge.setSize(e,t)}},{key:"setZoom",value:function(e){if(this.bridge)return this.bridge.setZoom(e)}},{key:"setOnCommentBatchUpdate",value:(l=F()(H.a.mark(function e(t,n){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:this.bridge.setOnCommentBatchUpdate(t,n);case 4:case"end":return e.stop()}},e,this)})),T)},{key:"freeze",value:function(){if(this.bridge)return this.bridge.freeze()}},{key:"unfreeze",value:function(){if(this.bridge)return this.bridge.unfreeze()}},{key:"enterHistoryMode",value:function(e,t,n){if(this.bridge)return this.bridge.enterHistoryMode(e,t,n)}},{key:"getRevision",value:function(){return this.bridge?this.bridge.getRevision():Promise.resolve(-1)}},{key:"addSheet",value:function(e,t){if(!this.bridge)throw new Error("sheet bridge not ready");return this.bridge.addSheet(e,t)}},{key:"pasteSheetByActions",value:function(e){if(!this.bridge)throw new Error("sheet bridge not ready");return this.bridge.pasteSheetByActions(e)}},{key:"delSheet",value:function(e){if(this.bridge)return this.bridge.delSheet(e)}},{key:"syncVirtualScroll",value:function(e){if(this.bridge)return this.bridge.syncVirtualScroll(e)}},{key:"updateSheetSelectionState",value:function(e,t){if(this.bridge)return this.bridge.updateSheetSelectionState(e,t)}},{key:"updateHighlight",value:function(e,t){if(this.bridge)return this.bridge.updateHighlight(e,t)}},{key:"findMention",value:(c=F()(H.a.mark(function e(t,n,i){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.findMention(t,n,i));case 4:case"end":return e.stop()}},e,this)})),S)},{key:"getAllMention",value:function(){if(this.bridge)return this.bridge.getAllMention()}},{key:"getComments",value:function(e){return this.bridge?this.bridge.getComments(e):[]}},{key:"getActiveComments",value:function(e){return this.bridge?this.bridge.getActiveComments(e):[]}},{key:"getResolvedComments",value:function(e){return this.bridge?this.bridge.getResolvedComments(e):[]}},{key:"startNewComment",value:function(e,t,n){if(!this.bridge)throw new Error("sheet bridge not ready");return this.bridge.startNewComment(e,t,n)}},{key:"saveComment",value:function(e,t,n){if(!this.bridge)throw new Error("sheet bridge not ready");return this.bridge.saveComment(e,t,n)}},{key:"removeComment",value:function(e,t){if(this.bridge)return this.bridge.removeComment(e,t)}},{key:"removeTempComment",value:function(e,t){if(this.bridge)return this.bridge.removeTempComment(e,t)}},{key:"addHighlight",value:function(e,t){if(this.bridge)return this.bridge.addHighlight(e,t)}},{key:"removeHighlight",value:function(e,t){if(this.bridge)return this.bridge.removeHighlight(e,t)}},{key:"activateComment",value:function(e,t){if(this.bridge)return this.bridge.activateComment(e,t)}},{key:"deactivateComment",value:function(e,t){if(this.bridge)return this.bridge.deactivateComment(e,t)}},{key:"resolveComment",value:function(e,t){if(!this.bridge)throw new Error("sheet bridge not ready");return this.bridge.resolveComment(e,t)}},{key:"reopenComment",value:function(e,t){if(!this.bridge)throw new Error("sheet bridge not ready");return this.bridge.reopenComment(e,t)}},{key:"getQuoteType",value:function(e,t){if(this.bridge)return this.bridge.getQuoteType(e,t)}},{key:"findComment",value:function(e,t){if(!this.bridge)throw new Error("sheet bridge not ready");return this.bridge.findComment(e,t)}},{key:"setResolvedCommentIds",value:function(e,t){if(this.bridge)return this.bridge.setResolvedCommentIds(e,t)}},{key:"setCommentData",value:(s=F()(H.a.mark(function e(t,n){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.setCommentData(t,n));case 4:case"end":return e.stop()}},e,this)})),I)},{key:"takeScreenShot",value:(a=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.takeScreenShot(t));case 4:case"end":return e.stop()}},e,this)})),k)},{key:"sheetBlockDidMount",value:function(e){this.bridge&&(this.bridge.sheetBlockDidMount(e),this.tryDelBuffers(e)&&this.bridge.sheetBlockEnterBuffer(e))}},{key:"sheetBlockDidUnmount",value:function(e){this.bridge&&(this.bridge.sheetBlockDidUnmount(e),this.tryDelBuffers(e))}},{key:"sheetBlockEnterBuffer",value:function(e){this.bridge?this.bridge.sheetBlockEnterBuffer(e):this.sheetEnterBufferWithoutBridge.add(e)}},{key:"sheetBlockLeaveBuffer",value:function(e){this.bridge?this.bridge.sheetBlockLeaveBuffer(e):this.tryDelBuffers(e)}},{key:"tryDelBuffers",value:function(e){return!!this.sheetEnterBufferWithoutBridge.has(e)&&(this.sheetEnterBufferWithoutBridge.delete(e),!0)}},{key:"previewHistory",value:(o=F()(H.a.mark(function e(t,n,i){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.previewHistory(t,n,i));case 4:case"end":return e.stop()}},e,this)})),C)},{key:"locateHistory",value:(r=F()(H.a.mark(function e(t,n){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.locateHistory(t,n));case 4:case"end":return e.stop()}},e,this)})),O)},{key:"clearHistoryLabel",value:(i=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.clearHistoryLabel(t));case 4:case"end":return e.stop()}},e,this)})),E)},{key:"notifyMembersUpdate",value:(t=F()(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=3;break}return e.next=3,this.waitUntilBridgeReady();case 3:return e.abrupt("return",this.bridge.notifyMembersUpdate(t));case 4:case"end":return e.stop()}},e,this)})),e)},{key:"updateTime",get:function(){return this.bridge&&this.bridge.updateTime||0}}]),n}(),u=function(e,t,n){return Z.pasteSheetWithoutBridge(e,t,n)},d=function(e){return Z.getHtmlWhilePastingSheetWithoutBridge(e)},h=function(e,t){return Z.addSheetWithoutBridge(e,t)},f=function(){return Z&&Z.clearStashedAction()}},JQ5T:function(e,c,l){"use strict";(function(n){var e=l("J4zp"),f=l.n(e),t=l("1Cge"),p=l("q1tI"),g=l.n(p),m=l("y2sV"),i=l("domO"),r=l.n(i),v=l("GlHY"),b=l("gviE"),o=l("j1lG"),a=function(e){var t=e.id,n=e.handleRetry,i=e.imageAttrib.size,r=i.displayHeight,o=i.displayWidth,a=Object(b.a)(),s=f()(a,1)[0],c=C({height:r,width:o}),l=!c&&s,u=Object(p.useCallback)(function(){s&&"function"==typeof n&&n()},[n,s]),d=s?g.a.createElement(E,{id:t,reload:u}):g.a.createElement(O,null),h=Object.assign({},v.a.content,l?v.a.contentRetryable:{});return g.a.createElement(m.l,{style:v.a.wrapper},g.a.createElement(m.z,{style:h,onClick:l?u:void 0},g.a.createElement(y,null),c?d:null))};function y(){return g.a.createElement(m.n,{style:v.a.loadFailureIcon,src:r.a})}function E(e){var t=e.reload;return g.a.createElement(m.z,{style:v.a.descriptionText},n("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast11",""),g.a.createElement("a",{style:v.a.descriptionBtn,onClick:t},n("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast12")))}function O(){return g.a.createElement(m.z,{style:v.a.descriptionText},n("CreationDoc_Docs_Add_Image_Tips"))}c.a=Object(t.a)(a);var s=function(e){if("number"==typeof e)return e;if("string"==typeof e&&/px$/.test(e))return+e.replace("px","");throw new TypeError("[image plugin] LoadFailView: wrong value to transform number")},C=function(e){try{var t=e.width,n=e.height,i=s(t),r=s(n);return o.O<=i&&o.N<=r?!0:!1}catch(e){return!1}}}).call(this,l("2vAP"))},JWfN:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var i=n("7EGn"),r=n("2ACu"),o={status_name:"success",is_editor:!1,module:"",test_id:"",send_remark:"",message_template:"",message_detail:"",user_group:"",user_group_detail:""},a=function(e){Object(r.default)("client_frontend_trial",Object.assign({},o,{},e))},s=function(e){var t={A:{msgDetail:"",msgTemplate:"201",userGroup:["201"],userGroupDetail:""},B:{msgDetail:"",msgTemplate:"201",userGroup:["200"],userGroupDetail:""}};a({module:"sheet",test_id:"2",send_remark:"sheet",message_template:Object(i.default)(t,"".concat(e,".msgTemplate")),message_detail:Object(i.default)(t,"".concat(e,".msgDetail")),user_group:Object(i.default)(t,"".concat(e,".userGroup")),user_group_detail:Object(i.default)(t,"".concat(e,".userGroupDetail"))})}},JXNz:function(e,t,n){"use strict";var i=n("wMhR");t.a=i.a},"Ja9/":function(e,t,n){"use strict";var r,i,o=n("J4zp"),le=n.n(o),ue=n("q1tI"),de=n.n(ue),a=n("lSNA"),Y=n.n(a),s=n("1Cge"),c=n("TSYQ"),J=n.n(c),Q=n("y2sV"),l=n("lwsE"),d=n.n(l),u=n("W8MJ"),h=n.n(u),f=n("a1gu"),p=n.n(f),g=n("Nsbk"),m=n.n(g),v=n("PJYZ"),b=n.n(v),y=n("7W2i"),E=n.n(y),O=n("UXvI"),C=n("/GXw"),k={topLeft:{top:"-10px",left:"-10px",cursor:"nwse-resize"},topRight:{top:"-10px",right:"-10px",cursor:"nesw-resize"},bottomLeft:{bottom:"-10px",left:"-10px",cursor:"nesw-resize"},bottomRight:{bottom:"-10px",right:"-10px",cursor:"nwse-resize"}};(i=r=r||{}).topLeft="topLeft",i.topRight="topRight",i.bottomLeft="bottomLeft",i.bottomRight="bottomRight";var I,S,T,_,w,j=function(e){function n(){var t;return d()(this,n),(t=p()(this,m()(n).apply(this,arguments))).onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return E()(n,e),h()(n,[{key:"render",value:function(){var e=this.props.direction;return de.a.createElement("div",{style:Object.assign({position:"absolute",userSelect:"none",width:"16px",height:"16px",border:"2px solid white",borderRadius:"50%",backgroundColor:C.f,pointerEvents:"auto"},k[e]),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart})}}]),n}(de.a.PureComponent);(T=S=S||{}).Top="top",T.Right="right",T.Bottom="bottom",T.Left="left",(w=_=_||{}).Left="left",w.Center="center",w.Right="right";var M=function(e,t){return new RegExp(e,"i").test(t)},L=function(e,t){return e&&t?(t+e)/t:1},R=function(e,t){return e&&t?(t+e)/t:1},N=(I={},Y()(I,_.Left,function(e,t){var n=e.deltaX,i=e.deltaY;return t===r.topRight&&(i=0),t===r.bottomLeft&&(n=0),{deltaX:n,deltaY:i}}),Y()(I,_.Center,function(e,t){var n=e.deltaX,i=e.deltaY;return n*=2,t!==r.topLeft&&t!==r.topRight||(i=0),{deltaX:n,deltaY:i}}),Y()(I,_.Right,function(e,t){var n=e.deltaX,i=e.deltaY;return t===r.topLeft&&(i=0),t===r.bottomRight&&(n=0),{deltaX:n,deltaY:i}}),I),X=function(e){function t(e){var u;return d()(this,t),(u=p()(this,m()(t).call(this,e))).computeMaxScale=function(){var e=u.state.original,t=e.width,n=e.height,i=u.props.maxSize,r=void 0===i?{}:i,o=r.width,a=r.height,s=o?o/t:null,c=a?a/n:null;return s&&c?Math.min(s,c):s||c},u.resizable=null,u.ref=function(e){e&&(u.resizable=e)},u.onResizeStart=function(e,t){var n=le()(u.props.resizeState,2),i=(n[0],n[1]);u.maxScale=u.computeMaxScale(),e.preventDefault(),e.stopPropagation();var r=0,o=0;e.nativeEvent instanceof window.MouseEvent?(r=e.nativeEvent.clientX,o=e.nativeEvent.clientY):e.nativeEvent instanceof window.TouchEvent&&(r=e.nativeEvent.touches[0].clientX,o=e.nativeEvent.touches[0].clientY),u.bindEvents();var a={original:{x:r,y:o,width:u.size.width,height:u.size.height},direction:t};u.setState(a),u.props.onResizeStart&&u.resizable&&u.props.onResizeStart(u.resizable,b()(u),a),i(!0)},u.throttleResizing=Object(O.default)(function(e){var t,n,i;le()(u.props.resizeState,1)[0]&&u.resizable&&u.window&&(u.window.TouchEvent&&e instanceof u.window.TouchEvent&&(e.preventDefault(),e.stopPropagation()),t=(e instanceof u.window.MouseEvent?e:e.touches[0]).clientX,n=(e instanceof u.window.MouseEvent?e:e.touches[0]).clientY,i=u.calculateNewSize(t,n),u.props.onImageSizeChange(i))},16),u.onMouseMove=u.throttleResizing,u.getDeltaByDirection=function(e,t){var n=u.state,i=n.original,r=n.direction,o=i.x,a=i.y,s=0,c=0;return M(S.Left,r)&&(s=o-e),M(S.Right,r)&&(s=e-o),M(S.Top,r)&&(c=a-t),M(S.Bottom,r)&&(c=t-a),{deltaX:s,deltaY:c}},u.calculateScale=function(e){var t=u.state.original,n=t.width,i=t.height,r=e.deltaX,o=e.deltaY;if(!r)return R(o,i);if(!o)return L(r,n);return o*n<r*i?L(r,n):R(o,i)},u.calculateNewSize=function(e,t){var n=u.state,i=n.original,r=n.direction,o=u.props.alignment,a=i.width,s=i.height,c=N[o](u.getDeltaByDirection(e,t),r),l=u.getMaxMinScale(u.calculateScale(c));return{width:Math.round(a*l),height:Math.round(s*l)}},u.onMouseUp=function(){var e=le()(u.props.resizeState,2),t=e[0],n=e[1];t&&u.resizable&&(u.throttleResizing.flush(),u.props.onResizeStop&&u.props.onResizeStop(u.resizable,b()(u),u.state),u.unbindEvents(),n(!1))},u.state={width:u.props.size.width,height:u.props.size.height,direction:r.topLeft,original:{x:0,y:0,width:0,height:0}},u}return E()(t,e),h()(t,[{key:"bindEvents",value:function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))}},{key:"unbindEvents",value:function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))}},{key:"getMaxMinScale",value:function(e){var t=this.maxScale||1/0,n=this.minScale||-1/0;return Math.max(Math.min(t,e),n)}},{key:"renderResizer",value:function(t,e){var n=this,i=this.props,r=i.direction,o=i.size,a=i.isAlignFull;if(!e)return null;var s=Object.keys(r).map(function(e){return!1!==r[e]&&t?de.a.createElement(j,{key:e,direction:e,onResizeStart:n.onResizeStart}):null}),c={position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"2px solid ".concat(C.f),pointerEvents:"none",zIndex:1};return a&&Object.assign(c,o),de.a.createElement("span",{className:"image-resizer-container",style:c},s)}},{key:"render",value:function(){var e=this.props,t=e.enable,n=e.selected,i={position:"relative",display:"inline-block",verticalAlign:"middle",height:"100%",width:"100%",lineHeight:"0"},r=de.a.Children.map(this.props.children,function(e){return e?de.a.cloneElement(e,{style:Object.assign({},e.props.style,{width:"100%",height:"100%"})}):null});return de.a.createElement("div",{ref:this.ref,style:i},r,this.renderResizer(t,n))}},{key:"window",get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null}},{key:"size",get:function(){var e,t,n,i=0,r=0;return this.resizable&&this.window&&(e=this.resizable.offsetWidth,t=this.resizable.offsetHeight,"relative"!==(n=this.resizable.style.position)&&(this.resizable.style.position="relative"),i="auto"!==this.resizable.style.width?this.resizable.offsetWidth:e,r="auto"!==this.resizable.style.height?this.resizable.offsetHeight:t,this.resizable.style.position=n),{width:i,height:r}}},{key:"minScale",get:function(){var e=this.state.original,t=e.width,n=e.height,i=this.props.minSize,r=void 0===i?{}:i,o=r.width,a=r.height,s=o?o/t:null,c=a?a/n:null;return s&&c?Math.max(s,c):s||c}}]),t}(de.a.PureComponent);X.defaultProps={enable:!1,selected:!1,alignment:_.Left,maxWidth:5e3,minWidth:50,direction:{topLeft:!0,topRight:!0,bottomLeft:!0,bottomRight:!0}};var D,he=n("j1lG"),x=n("Ngi8"),P=function(e,t){return{boxSizing:"content-box",width:"100%",height:"100%",position:"absolute",pointerEvents:"none",top:-e,left:-e,border:"".concat(e,"px solid ").concat(t),zIndex:1}},B={hoverBorder:P(2,x.B200),linePopoverBorder:P(1,x.B500)},U=n("OX8E"),$=function(e){var t=e.style,n=e.hovered,i=e.attribs,r=Object(ue.useState)(!1),o=le()(r,2),a=o[0],s=o[1];if(Object(ue.useEffect)(function(){var e=function(e){var t=e.uuids,n=e.status;t.includes(i.uuid)&&s("primary"===n)};return U.a.on(he.P,e),function(){U.a.off(he.P,e)}},[]),!n&&!a)return null;var c=Object.assign({},a?B.linePopoverBorder:B.hoverBorder,t||{});return de.a.createElement("div",{style:c})},z={wrapper:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:0,top:0,zIndex:100},shadowBg:{backgroundColor:"rgba(0, 0, 0, 0.75)"},barContainer:{userSelect:"none",maxWidth:150,width:"80%",display:"flex"},barCover:{width:"100%",height:8,borderRadius:8,backgroundColor:x.N200},barContent:{display:"block",width:0,height:"100%",background:x.B500,borderRadius:8}},H=function(e){var t=z.wrapper,n=z.shadowBg,i=z.barContent,r=z.barContainer,o=z.barCover,a=e.showShadowBg?Object.assign({},t,{},n):t,s=Object.assign({},i,{width:"".concat(100*e.progress,"%")});return de.a.createElement(Q.l,{style:a},de.a.createElement(Q.z,{style:r},de.a.createElement(Q.z,{style:o},de.a.createElement(Q.z,{style:s}))))},ee=Object(s.a)(H),F=n("J54a"),V=n("h6Hi"),W=n.n(V),K=n("0xAR"),Z=n.n(K),q=n("qxQb"),te=n.n(q),ne=s.a.keyframes({"100%":{transform:"rotate(360deg)"}},"rotate"),ie=s.a.keyframes({"0%":{strokeDasharray:"1, 200",strokeDashoffset:0},"50%":{strokeDasharray:"89, 200",strokeDashoffset:"-35px"},"100%":{strokeDasharray:"89, 200",strokeDashoffset:"-124px"}},"dash"),re={wrapperBg:{background:x.N200},wrapperBgWithTransparent:{background:te()(x.N1000,.6)},wrapper:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:100},loading:{width:30,height:30},circular:{position:"absolute",top:0,left:0,bottom:0,right:0,width:"50px",height:"50px",margin:"auto",maxWidth:"90%",maxHeight:"90%",animation:"x 2s linear infinite",animationName:ne},path:{strokeDasharray:"1, 200",strokeDashoffset:0,stroke:x.N400,strokeLinecap:"round",animation:"x 1.5s ease-in-out infinite",animationName:ie},pathInGif:{stroke:x.N00},icon:{position:"absolute",maxWidth:"90%",maxHeight:"90%"}},oe=Object(s.a)(function(e){var t=e.isGif,n=re.path;return t&&(n=Object.assign({},n,re.pathInGif)),de.a.createElement("svg",{style:re.circular,viewBox:"25 25 50 50"},de.a.createElement("circle",{style:n,cx:"50",cy:"50",r:"20",fill:"none",strokeWidth:"4",strokeMiterlimit:"10"}))}),ae=Object(s.a)(function(e){var t=Object.assign({},re.wrapper,e.status===he.E.LoadingWithPreview?re.wrapperBgWithTransparent:re.wrapperBg,e.style);return de.a.createElement(Q.l,{"data-selector":e["data-selector"]},de.a.createElement(F.a,{style:t},de.a.createElement(oe,null)))}),se=(D={},Y()(D,he.E.GifPreLoading,de.a.createElement(Q.n,{style:re.icon,src:Z.a})),Y()(D,he.E.GifLoading,de.a.createElement(oe,{isGif:!0})),D),ce=Object(s.a)(function(e){var t=se[e&&e.status];return t?de.a.createElement(Q.l,{"data-selector":e["data-selector"],style:Object.assign({},re.wrapper,e.style)},de.a.createElement(Q.n,{style:re.icon,src:W.a}),de.a.createElement(F.a,{style:re.wrapper},t)):null}),fe=function(e){var t;switch(e.status){case he.E.Loading:case he.E.LoadingWithPreview:t=de.a.createElement(ae,Object.assign({},e,{"data-selector":he.y}));break;case he.E.GifPreLoading:case he.E.GifLoading:t=de.a.createElement(ce,Object.assign({},e,{"data-selector":he.y}));break;default:t=null}return t},pe=n("JQ5T").a,ge=n("Tgf/"),me=n("GGin"),ve={base:{height:"100%",width:"100%",display:"inline-block"},highlighted:{backgroundColor:me.f,outline:"4px solid ".concat(me.f)},marked:{position:"absolute",width:"100%",top:"100%",height:"2px",backgroundColor:me.f},position:{position:"absolute",top:0,left:0}},be=n("TgJx"),ye=function(i,e,n){var t=Object(ue.useState)(!1),r=le()(t,2),o=r[0],a=r[1],s=Object(ue.useState)(!1),c=le()(s,2),l=c[0],u=c[1],d=Object(ue.useRef)(0);Object(ue.useEffect)(function(){if(n){var e=function(e){var t=e.uuid,n=e.highlight;i===t&&(n?d.current++:d.current=Math.max(0,d.current-1),0<d.current?a(!0):a(!1))},t=function(e){var t=e.uuid,n=e.mark;i===t&&u(n)};return n.hasMark(i)&&u(!0),U.a.on(he.q.IMAGE_SET_HIGHLIGHT,e),U.a.on(he.q.IMAGE_UPDATE_MARK,t),function(){U.a.off(he.q.IMAGE_SET_HIGHLIGHT,e),U.a.off(he.q.IMAGE_UPDATE_MARK,t)}}},[i,n,d]);var h=e.fullscreenMode===be.a.PAGED;return[!h&&o,!h&&l]},Ee=function(e){var t=e.children,n=e.uuid,i=e.galleryComment,r=e.imageState,o=e.isNeedPositioning,a=ye(n,r,i),s=le()(a,2),c=s[0],l=s[1],u=Object.assign({},ve.base,c?ve.highlighted:{},o?ve.position:{});return de.a.createElement("div",{className:"image-highlight-wrapper",style:u},t,l&&de.a.createElement("div",{style:ve.marked}))},Oe=function(e){var t=e.children,n=e.aspectRatio,i=n?{display:"inline-block",verticalAlign:"top",width:"100%",height:0,paddingTop:1/n*100+"%"}:{};return de.a.createElement("div",{className:"image-view-placeholder",style:i},t)},Ce=n("15MJ"),ke=function(e,t){var n=function(e){return"number"==typeof e?e:"string"==typeof e&&e.endsWith("px")?parseFloat(e):0};return{width:n(e),height:n(t)}};function Ie(e,t){if(t){var n=t.width,i=t.height,r=t.maxWidth,o=void 0===r?1/0:r,a=t.maxHeight,s=void 0===a?1/0:a;return{width:Math.min(n,o),height:Math.min(i,s)}}var c=e.displayWidth,l=e.displayHeight,u=ke(c,l),d=u.width,h=u.height;return{width:d||Ce.m,height:h||Ce.m}}function Se(e,t){var n=e||t,i=Object(ue.useState)(n),r=le()(i,2),o=r[0],a=r[1];return Object(ue.useEffect)(function(){a(n)},[n.width]),{imageSize:o,setCurrentSize:a}}function Te(e){var t,n=e.isBigGif,i=e.isGifFetching,r=e.isCoverFetching,o=e.coverSrc,a=e.gifSrc,s=e.isOnLoading,c=e.isLocalLoading,l=e.loadingShowPreview,u=e.category,d=(he.E.Initial,i||r),h=u===he.D.Drive;return c?l?he.E.LoadingWithPreview:he.E.Loading:n&&h?(t=i||a&&s,r||!a&&s?he.E.Loading:a||!o||i?t?he.E.GifLoading:he.E.Finished:he.E.GifPreLoading):d||s?he.E.Loading:he.E.Finished}function _e(e){return-1===[he.E.Initial,he.E.Finished].indexOf(e)}var we=function(e){var t=e.src,n=e.loadingStatus,i=e.isImageError,r=e.resizeState,o=e.attribs,a=e.imageState,s=e.handleImageErrorRetry,c=e.onResizeStart,l=e.onResizeStop,u=e.onClickImage,d=e.selected,h=e.onSelection,f=e.onDeselect,p=e.onSelect,g=e.alignFullStyle,m=e.hovered,v=e.onMouseEnter,b=e.onMouseLeave,y=e.onMouseDown,E=e.galleryComment,O=a.isReadOnly,C=a.editorWidth,k=a.imageSizeMap,I=o.uuid,S=o.size,T=o.uploading,_=o.uploadProgress,w=o.originSrc,j=k.get(I),M=Ie(S,j),L=h?{"data-image-on-selection":"true"}:{},R=_e(n),N=Se(g,M),D=N.imageSize,x=N.setCurrentSize,P=D.width,B=D.height,U=J()(Y()({},he.x,R)),z=a.lastUploadedImageUuid===I?Y()({},he.t,he.u):{},H=g?D:{},F=T||R,V=O||F,W=!O&&!g&&!F,K=j?j.maxWidth:C,Z=Object.assign({},ge.a.image,H,S.aspectRatio?ge.a.position:{}),q=Object(ue.useCallback)(function(e){V&&e.preventDefault()},[O,F]);return de.a.createElement(Q.l,Object.assign({className:he.r,onDeselect:f,onSelect:p},L,{style:Object.assign({},ge.a.container,{width:P,height:g?B:void 0,cursor:d||m&&O?"zoom-in":void 0})}),de.a.createElement(X,{enable:W,isAlignFull:!!g,selected:!O&&d,maxSize:{width:K},minSize:{width:he.I,height:he.I},size:g||M,onResizeStart:c,onResizeStop:l,onImageSizeChange:x,resizeState:r},de.a.createElement(Oe,{aspectRatio:S.aspectRatio},de.a.createElement(Ee,{uuid:o.uuid,isNeedPositioning:!!S.aspectRatio,galleryComment:E,imageState:a},de.a.createElement($,{hovered:m,style:H,attribs:o}),T?de.a.createElement(ee,{progress:_,showShadowBg:!0}):R&&de.a.createElement(fe,{status:n,style:Z}),i?de.a.createElement(pe,{handleRetry:s,imageAttrib:o}):de.a.createElement(Q.n,Object.assign({className:V?"":he.s,style:Z,src:decodeURIComponent(t),"data-src":w,"data-uuid":I,"data-selector":U},z,{onClick:u,onMouseDown:y,onMouseEnter:v,onMouseLeave:b,onDragStart:q}))))))},je=Object(s.a)(we);function Me(t,n,e,i){return Object(ue.useEffect)(function(){var e;t&&((e=new Image).onload=function(){n({isOnLoading:!1,isLoadError:!1,isOnLoaded:!0})},e.onerror=function(){n({isOnLoading:!1,isLoadError:!0,isOnLoaded:!0})},e.src=t,n({isOnLoading:!0,isLoadError:!1,isOnLoaded:!1}))},[t,e]),function(){n({isOnLoading:!0,isLoadError:!1,isOnLoaded:!1}),i()}}function Ae(){var e=Object(ue.useState)({isOnLoading:!0,isLoadError:!1,isOnLoaded:!1}),t=le()(e,2),n=t[0],i=t[1];return Object.assign({},n,{setOnloadStatus:i})}var Le=n("rLED"),Re=n("FsMz"),Ne=n("Tqb2"),De=n("Z/PY");function xe(e,n){var t=Object(ue.useState)(!1),i=le()(t,2),r=i[0],o=i[1],a=Object(ue.useState)(!1),s=le()(a,2),c=s[0],l=s[1],u=Object(ue.useState)(null),d=le()(u,2),h=d[0],f=d[1],p=Object(ue.useState)(null),g=le()(p,2),m=g[0],v=g[1],b=Object(ue.useState)(null),y=le()(b,2),E=y[0],O=y[1],C=e.uuid,k=e.fileSize,I=e.mimeType,S=e.imageCategory,T=e.token,_=e.size,w=Object(Ne.I)(I),j=w&&k>=Object(Le.R)(),M=Object(Ne.a)(e),L=function(i){return function(e){var t=i?l:o,n=i?v:f;e&&e.src&&n(e.src),e&&e.fetchCdnLogStatus&&O(e.fetchCdnLogStatus),t(!1)}},R=M&&!c&&!r&&!(w?m:h);return{isBigGif:j,shouldFetchCdn:M,isGifFetching:c,isCoverFetching:r,fetchingImageResource:Object(ue.useCallback)(function(e){var t;R&&T&&(t={isHD:!!e||Object(De.q)(_.displayWidth,_.displayHeight),category:S,token:T,uuid:C},(e?l:o)(!0),n.fetch(t,{priority:Re.e.High},L(e)))},[C,R,S,T,w,_,n,De.q]),coverSrc:h,gifSrc:m,fetchLogStatus:E}}function Pe(e,t){var n=Object(ue.useRef)(!1);return t.demandLoadImages.has(e)&&!n.current&&(n.current=!0),n.current}function Be(e){var t=Object(ue.useRef)();return!t.current&&e&&(t.current=e),t.current}function Ue(e,t){return t.inViewImages.has(e)}var ze=n("gviE"),He=2;function Fe(e,t,n){var i=e.uuid,r=e.mimeType,o=Object(Ne.I)(r),a=Object(ze.a)(),s=le()(a,1)[0],c=Object(ue.useState)(null),l=le()(c,2),u=l[0],d=l[1],h=Object(ue.useState)(!1),f=le()(h,2),p=f[0],g=f[1],m=Object(ue.useState)(0),v=le()(m,2),b=v[0],y=v[1],E=Ue(i,t);return s&&o&&n?(n&&!u&&!p&&b<He&&(g(!0),y(b+1),Object(Ne.g)(n).then(function(e){d(e),g(!1)}).catch(function(e){g(!1)})),E?n:u):null}function Ve(){var e=Object(ue.useState)(0),t=le()(e,2),n=t[0],i=t[1];return{retryCount:n,recordImageErrorRetry:Object(ue.useCallback)(function(){i(function(e){return e+1})},[])}}var We=n("2ACu"),Ke=n("lQZd"),Ge=n("1dfU"),Ze=n("NbI8");function qe(e){var t=e.token,n=Object(Ke.g)();Object(We.default)(Ze.g,{file_token:Object(Ge.a)(t),page_token:Object(Ge.a)(n)})}function Ye(e,t,n){var i=e.originSrc,r=e.intermediateSrc,o=e.mimeType,a=e.uuid,s=e.needSaveExternal,c=e.needSaveDriveImage,l=e.needTransformToGallery,u=e.loadingShowPreview,d=e.imageCategory,h=Object(Ne.I)(o),f=n.isSkipLoading,p=n.reuseSSRImage,g=n.loadedSrcMap.get(a),m=Be(r),v=m||g,b=Pe(a,n),y=xe(e,t),E=y.isBigGif,O=y.shouldFetchCdn,C=y.isGifFetching,k=y.isCoverFetching,I=y.fetchingImageResource,S=y.coverSrc,T=y.gifSrc,_=y.fetchLogStatus,w=Ve(),j=w.retryCount,M=w.recordImageErrorRetry,L=O&&!v&&!(0<j),R=h&&!E;Object(ue.useEffect)(function(){L&&b&&I(R)},[L,R,I,b]);var N=L?h&&T||S:v||i,D=Fe(e,n,T||m),x=Ae(),P=x.isOnLoading,B=x.isLoadError,U=x.isOnLoaded,z=x.setOnloadStatus,H=Me(N,z,j,M),F=Te({isBigGif:E,isGifFetching:C,isCoverFetching:k,coverSrc:S,gifSrc:T,isOnLoading:P,isLocalLoading:s||c||l,loadingShowPreview:u,category:d}),V=D||N||Ce.p,W=p&&p.get(a),K=!!W,Z=f||K;return Z&&(V=W||i||"",F=he.E.Finished),Object(ue.useEffect)(function(){Z&&z({isOnLoading:!1,isLoadError:!1,isOnLoaded:!0})},[Z]),{src:V,fetchLogStatus:_,loadingStatus:F,isImageError:B,isOnLoading:P,isOnLoaded:U,retryCount:j,handleGifIconClick:function(){!m&&E&&!K&&(I(!0),qe(e))},imageErrorRetry:H}}var Je=n("UY5Z"),Qe=function(e,t,n,i){var r=n.showPopup,o=n.hidePopupDelay,a=n.hidePopupImmediately,s=Object(ue.useCallback)(function(){i||r(t)},[t,i]),c=Object(ue.useCallback)(function(){i||o()},[i]);return Object(ue.useEffect)(function(){e||a()},[e]),[s,c]},Xe=function(e,t,n){Object(ue.useEffect)(function(){n&&e&&n.setSelectedImageUUID(t)},[e,n])},$e=n("2RY6");function et(e){var t=e&&e.getRect();if(t)return t;var n=document.querySelector("#innerdocbody");return n&&n.getBoundingClientRect()}var tt=function(e){var t=e.isAlignFull,n=e.inFullScreenMode,i=e.bodyWidth,r=e.aspectRatio,o=e.editor;if(!t)return null;var a=(n?i/$e.g:i)-2*he.A,s=et(o),c=(s&&s.left||0)+he.h,l=-(n?c/$e.g:c);return{width:a,height:r?a/r:"100%",transform:"translate(".concat(l,"px)")}},nt=function(e){var t=e.isAlignFull,n=e.inFullScreenMode,i=e.bodyWidth,r=e.aspectRatio,o=e.editor;return Object(ue.useMemo)(function(){return tt({isAlignFull:t,inFullScreenMode:n,bodyWidth:i,aspectRatio:r,editor:o})},[t,n,i,r,o])},it=function(e){return"full"===e.getLineAttributes().toMap().align};function rt(e,o){try{if(!e)throw new Error("No image wrapper ref");var t=Object(Ne.v)(e),a=o.selection.getSelection(),n=o.getContentState().getEntities(a),s=Object(Ne.r)(n),c=Object(Ne.q)(n),i=s.find(function(e){return e.uuid===t});i&&(i.size.displayHeight=e.clientHeight,i.size.displayWidth=e.clientWidth);var l=s.map(Ne.f);o.inCallStackIfNecessary("performImageStyle",function(){var e=a.toPosition(),t=e.start,n=e.len,i=e.zoneId,r=new Q.E({zoneId:i});r.retain(t).delete(n),l.forEach(function(e,t){var n;r.insert(" ",(n={},Y()(n,he.K,e),Y()(n,"author",c[s[t].uuid]),n))}),o.getContentState().apply(r),o.selection.setSelection(a)})}catch(e){console.error("[Image plugin] Resize error",e)}}var ot=function(e){var t=e.imageState,n=e.uuid,i=e.loadedSrc,r=t.loadedSrcMap;i!==Ce.p&&r.set(n,i||"")},at=n("ZKUE");function st(e,t,n){var i=Object(ue.useState)(!1),r=le()(i,2),o=r[0],a=r[1];return{isFirstSelected:o,selectCurrentImage:Object(ue.useCallback)(function(){a(!t),t||Object(at.a)(n,e)},[t,n,e,at.a,a])}}var ct=n("SfZW"),lt=function(){function e(){d()(this,e),this.params={decrypt_necessary:!1,request_cdn_necessary:!1},this.timer=new ct.a}return h()(e,[{key:"collect",value:function(e){Object.assign(this.params,e)}},{key:"logLoadImageStart",value:function(){this.timer.start("loadImage")}},{key:"logLoadImageEnd",value:function(){var e=this.timer.end("loadImage");this.collect({load_time_cost:e})}},{key:"logDisplayImageStart",value:function(){this.timer.start("displayImage")}},{key:"logDisplayImageEnd",value:function(){var e=this.timer.end("displayImage");this.collect({display_time_cost:e})}},{key:"upload",value:function(){Object(We.default)(Ze.a,this.params)}},{key:"destroy",value:function(){this.params={},this.timer.clear()}}]),e}(),ut=new(function(){function e(){d()(this,e),this.collectorMap=new Map}return h()(e,[{key:"get",value:function(e){var t=this.collectorMap.get(e);return!t&&(t=new lt,this.collectorMap.set(e,t)),t}},{key:"delete",value:function(e){var t=this.collectorMap.get(e);this.collectorMap.delete(e),t&&t.destroy()}},{key:"destroy",value:function(){this.collectorMap.forEach(function(e){return e.destroy()})}}]),e}());function dt(e,t){var n=e.uuid,i=e.mimeType,r=e.fileSize,o=e.imageCategory,a=Object(Ke.g)();Object(ue.useEffect)(function(){var e=ut.get(n);e&&e.collect({mime_type:i,origin_size:r,image_category:o,page_token:Object(Ge.a)(a),retryTimes:t})},[n,t])}function ht(e){var t=e.uuid;Object(ue.useEffect)(function(){var e=ut.get(t);e&&e.logDisplayImageStart()},[t])}function ft(e,n,i){var r=e.uuid,t=e.token,o=void 0===t?"":t,a=e.originSrc;Object(ue.useEffect)(function(){var e=n===he.E.Finished||n===he.E.GifPreLoading,t=ut.get(r);t&&e&&(t.logDisplayImageEnd(),t.collect({load_fail:i,token:Object(Ge.a)(o),origin_src:Object(Ge.a)(a)}),t.upload())},[r,n,i])}function pt(e,t){var n=e.uuid;Object(ue.useEffect)(function(){var e=ut.get(n);e&&t&&e.logLoadImageStart()},[n,t])}function gt(e,t,n){var i=e.uuid;Object(ue.useEffect)(function(){var e=ut.get(i);e&&!t&&n&&e.logLoadImageEnd()},[i,t,n])}function mt(e,t){var n=e.uuid;Object(ue.useEffect)(function(){var e=ut.get(n);e&&t&&e.collect(t)},[n,t])}function vt(e){Object(ue.useEffect)(function(){return function(){ut.delete(e)}},[])}function bt(e,t){var n=t.isOnLoading,i=t.isOnLoaded,r=t.loadingStatus,o=t.isImageError,a=t.fetchLogStatus;dt(e,t.retryCount),ht(e),pt(e,n),mt(e,a),gt(e,i,n),ft(e,r,o),vt(e.uuid)}var yt=n("v6N1"),Et=function(u,d){return Object(ue.useCallback)(function(e,t,n){var i,r=u.uuid,o=n.original.width,a=d.selection.getSelection().start,s=a.zoneId,c=a.line,l=Object(Ne.x)(s,c,d);!l||(i=Object(yt.b)(l,s,d).get(r))&&(t.maxScale=i.maxWidth/o)},[u,d])},Ot=function(e){var t=e.attribs,n=e.previewModule,i=e.uploadModule,r=e.fetchModule,o=e.editor,a=e.lineState,s=e.onDragMouseDown,c=e.externalSaverModule,l=e.galleryComment,u=e.imageStateInstance,d=e.selectionPopupManager,h=e.imageState,f=e.setPreventAutoFixSelection,p=e.batchSelectImage,g=t.uuid,m=t.size,v=t.uploading,b=h.hoveredImageUuid,y=h.bodyWidth,E=h.isReadOnly,O=h.fullscreenMode,C=h.selectedImageSet,k=h.onSelectionImageSet,I=C.has(g),S=k.has(g),T=Object(Je.a)(o,a,g),_=le()(T,1)[0],w=st(g,I,u),j=w.isFirstSelected,M=w.selectCurrentImage,L=Ye(t,r,h),R=L.src,N=L.loadingStatus,D=L.fetchLogStatus,x=L.isImageError,P=L.isOnLoading,B=L.isOnLoaded,U=L.retryCount,z=L.handleGifIconClick,H=L.imageErrorRetry;ot({imageState:h,uuid:g,loadedSrc:R});var F=_e(N),V=v||F,W=Object(ue.useState)(!1),K=le()(W,1)[0],Z=Qe(S,g,d,K),q=le()(Z,2),Y=q[0],J=q[1];Xe(I,g,l);var Q=Object(ue.useCallback)(function(e){!n||!E&&(E||j)||V||(n.open(g),e.stopPropagation())},[E,g,n,j,V]),X=Object(ue.useCallback)(function(e){Q(e),z&&z()},[z,Q]),$=Object(ue.useCallback)(function(e){V||(M(),s&&s(g))},[g,V,M,s]);Object(ue.useEffect)(function(){return function(){i&&i.cancel&&i.cancel(g),c&&c.stopTask(g)}},[]),bt(t,{isOnLoading:P,isOnLoaded:B,loadingStatus:N,isImageError:x,fetchLogStatus:D,retryCount:U});var ee=function(e){f(!0),e&&rt(e,o),Object(at.a)(u,g),f(!1)},te=Et(t,o),ne=Object(ue.useCallback)(function(){p.deselectOnSelection(g)},[g,p]),ie=Object(ue.useCallback)(function(){p.selectOnSelection(g)},[g,p]),re=it(a),oe=m.aspectRatio,ae=m.displayHeight,se=O===be.a.NON_PAGED,ce=nt({isAlignFull:re,inFullScreenMode:se,bodyWidth:y,aspectRatio:oe,editor:o});return Object(ue.useEffect)(function(){N===he.E.Finished&&_()},[N,ce,ae]),de.a.createElement(je,{src:R,loadingStatus:N,isImageError:x,hovered:b===g,selected:I,onSelection:S,onDeselect:ne,onSelect:ie,attribs:t,onResizeStart:te,onResizeStop:ee,galleryComment:l,alignFullStyle:ce,handleImageErrorRetry:H,onMouseDown:$,onClickImage:X,onMouseEnter:Y,onMouseLeave:J,imageState:h,resizeState:W})},Ct=n("RIqP"),kt=n.n(Ct),It=new Set(["hoveredImageUuid","lastUploadedImageUuid"]),St=new Set(["demandLoadImages","inViewImages","selectedImageSet","onSelectionImageSet"]),Tt=new Set(["imageSizeMap","loadedSrcMap","reuseSSRImage"]),_t=new Set([].concat(kt()(It),kt()(St),kt()(Tt))),wt=function(e,t,n,i){var r=!0,o=!1,a=void 0;try{for(var s,c=n[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;if(i(e[l],t[l]))return!0}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return!1},jt=[function(e,t,n){var i=e.uuid;return wt(t,n,It,function(e,t){return i===e&&t!==i||i!==e&&t===i})},function(e,t,n){var i=e.uuid;return wt(t,n,St,function(e,t){return e.has(i)&&!t.has(i)||!e.has(i)&&t.has(i)})},function(e,t,n){var i=e.uuid;return wt(t,n,Tt,function(e,t){return e.has(i)&&e.get(i)!==t.get(i)||!e.has(i)&&t.has(i)})},function(e,t,n){for(var i=0,r=Object.keys(t);i<r.length;i++){var o=r[i];if(!_t.has(o)&&n[o]!==t[o])return!0}return!1}],Mt=function(t,n){var e=Object(ue.useRef)(n),i=e.current;return jt.some(function(e){return e(t,n,i)})?e.current=n:i},At=function(e){var t=e.imageStateInstance,n=e.attribs,i=e.attributeStr,r=e.lineState,o=(0,t.useImageState)(),a=le()(o,1)[0],s=Mt(n,a);return Object(ue.useMemo)(function(){return de.a.createElement(Ot,Object.assign({},e,{imageState:s}))},[s,i,r])};t.a=At},Jdee:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(e,t){return e.appState.permissionUserMap[t]}},Jmo2:function(e,t,n){"use strict";n.d(t,"a",function(){return g}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return y});var i=n("AiBH"),r="select-all",o="tab",a="shift-tab",s="shift-up",c="shift-left",l="shift-down",u="shift-right",d="delete-paragraph",h="esc",f="shift-enter",p="copy",g="paste",m="cut",v="save",b={A:65,B:66,C:67,D:68,E:69,F:70,S:83,V:86,X:88},y=[{action:"delete",keyCode:i.t.BACKSPACE},{action:r,keyCode:b.A,isCtrlOrCmd:!0},{action:o,keyCode:i.t.TAB},{action:a,keyCode:i.t.TAB,isShift:!0},{action:s,keyCode:i.t.UP,isShift:!0},{action:l,keyCode:i.t.DOWN,isShift:!0},{action:c,keyCode:i.t.LEFT,isShift:!0},{action:u,keyCode:i.t.RIGHT,isShift:!0},{action:d,keyCode:i.t.BACKSPACE,isCtrlOrCmd:!0},{action:h,keyCode:i.t.ESC},{action:f,keyCode:i.t.RETURN,isShift:!0},{action:p,keyCode:b.C,isCtrlOrCmd:!0},{action:g,keyCode:b.V,isCtrlOrCmd:!0},{action:m,keyCode:b.X,isCtrlOrCmd:!0},{action:v,keyCode:b.S,isCtrlOrCmd:!0}]},Jn5N:function(e,m,v){"use strict";v.r(m),function(i,e){var t,n,r,o,s,a,c,l,u,d,h,f=v("J4zp"),k=v.n(f),p=v("cDf5"),g=v.n(p);n=window,r=function(C,e,t){return e("dollar-third",[],function(){var e=C.__dollar||C.jQuery||C.Zepto||v("HmyT").jQuery;if(!e)throw new Error("jQuery or Zepto not found!");return e}),e("dollar",["dollar-third"],function(e){return e}),e("promise-third",["dollar"],function(e){return{Deferred:e.Deferred,when:e.when,isPromise:function(e){return e&&"function"==typeof e.then}}}),e("promise",["promise-third"],function(e){return e}),e("base",["dollar","promise"],function(m,e){var i,t,n,r,o,a,s,c,l,u,d,h,f,p=function(){},g=Function.call;function v(e){return function(){return g.apply(e,arguments)}}function b(e,t){return function(){return e.apply(t,arguments)}}function y(e,t){for(var n=e;n;){if("string"==typeof n.className&&-1<n.className.indexOf(t))return!0;n=n.parentNode}return!1}function E(e,t){var n=e.target;if(t){var i=!1,r=!0,o=!1,a=void 0;try{for(var s,c=t[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value,u=!0,d=!1,h=void 0;try{for(var f,p=m(l).toArray()[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var g=f.value;if(m.contains(g,n)){i=!0;break}}}catch(e){d=!0,h=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw h}}if(i)break;if(y(e.target,l.substring(1))){i=!0;break}}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return i}return!1}function O(e){var t;return Object.create?Object.create(e):((t=function(){}).prototype=e,new t)}return{version:"0.1.5",$:m,Deferred:e.Deferred,isPromise:e.isPromise,when:e.when,browser:(a=navigator.userAgent,s={},c=a.match(/WebKit\/([\d.]+)/),l=a.match(/Chrome\/([\d.]+)/)||a.match(/CriOS\/([\d.]+)/),u=a.match(/MSIE\s([\d\.]+)/)||a.match(/(?:trident)(?:.*rv:([\w.]+))?/i),d=a.match(/Firefox\/([\d.]+)/),h=a.match(/Safari\/([\d.]+)/),f=a.match(/OPR\/([\d.]+)/),c&&(s.webkit=parseFloat(c[1])),l&&(s.chrome=parseFloat(l[1])),u&&(s.ie=parseFloat(u[1])),d&&(s.firefox=parseFloat(d[1])),h&&(s.safari=parseFloat(h[1])),f&&(s.opera=parseFloat(f[1])),s),os:(t=navigator.userAgent,n={},r=t.match(/(?:Android);?[\s\/]+([\d.]+)?/),o=t.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/),r&&(n.android=parseFloat(r[1])),o&&(n.ios=parseFloat(o[1].replace(/_/g,"."))),n),inherits:function(e,t,n){var i;return"function"==typeof t?(i=t,t=null):i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},m.extend(!0,i,e,n||{}),i.__super__=e.prototype,i.prototype=O(e.prototype),t&&m.extend(!0,i.prototype,t),i},noop:p,bindFn:b,isIgnoreEvent:E,log:C.console?b(console.log,console):p,nextTick:function(e){setTimeout(e,1)},slice:v([].slice),guid:(i=0,function(e){for(var t=(+new Date).toString(32),n=0;n<5;n++)t+=Math.floor(65535*Math.random()).toString(32);return(e||"wu_")+t+(i++).toString(32)}),formatSize:function(e,t,n){var i;for(n=n||["B","K","M","G","TB"];(i=n.shift())&&1024<e;)e/=1024;return("B"===i?e:e.toFixed(t||2))+i}}}),e("mediator",["base"],function(e){var t,r=e.$,o=[].slice,a=/\s+/;function s(e,t,n,i){return r.grep(e,function(e){return e&&(!t||e.e===t)&&(!n||e.cb===n||e.cb._cb===n)&&(!i||e.ctx===i)})}function c(e,n,i){r.each((e||"").split(a),function(e,t){i(t,n)})}function l(e,t){for(var n,i=!1,r=-1,o=e.length;++r<o;)if(!1===(n=e[r]).cb.apply(n.ctx2,t)){i=!0;break}return!i}return t={on:function(e,t,i){var r,o=this;return t&&(r=this._events||(this._events=[]),c(e,t,function(e,t){var n={e:e};n.cb=t,n.ctx=i,n.ctx2=i||o,n.id=r.length,r.push(n)})),this},once:function(e,t,i){var r=this;return t&&c(e,t,function(t,n){var e=function e(){return r.off(t,e),n.apply(i||r,arguments)};e._cb=n,r.on(t,e,i)}),r},off:function(e,t,n){var i=this._events;return i&&(e||t||n?c(e,t,function(e,t){r.each(s(i,e,t,n),function(){delete i[this.id]})}):this._events=[]),this},trigger:function(e){var t,n,i;return this._events&&e?(t=o.call(arguments,1),n=s(this._events,e),i=s(this._events,"all"),l(n,t)&&l(i,arguments)):this}},r.extend({installTo:function(e){return r.extend(e,t)}},t)}),e("uploader",["base","mediator"],function(e,r){var o=e.$;function n(e){this.options=o.extend(!0,{},n.options,e),this._init(this.options)}return n.options={},r.installTo(n.prototype),o.each({upload:"start-upload",stop:"stop-upload",getFile:"get-file",getFiles:"get-files",addFile:"add-file",addFiles:"add-file",sort:"sort-files",removeFile:"remove-file",cancelFile:"cancel-file",skipFile:"skip-file",retry:"retry",isInProgress:"is-in-progress",makeThumb:"make-thumb",md5File:"md5-file",getDimension:"get-dimension",addButton:"add-btn",predictRuntimeType:"predict-runtime-type",refresh:"refresh",disable:"disable",enable:"enable",reset:"reset"},function(e,t){n.prototype[e]=function(){return this.request(t,arguments)}}),o.extend(n.prototype,{state:"pending",_init:function(e){var t=this;t.request("init",e,function(){t.state="ready",t.trigger("ready")})},option:function(e,t){var n=this.options;if(!(1<arguments.length))return e?n[e]:n;o.isPlainObject(t)&&o.isPlainObject(n[e])?o.extend(n[e],t):n[e]=t},getStats:function(){var e=this.request("get-stats");return e?{successNum:e.numOfSuccess,progressNum:e.numOfProgress,cancelNum:e.numOfCancel,invalidNum:e.numOfInvalid,uploadFailNum:e.numOfUploadFailed,queueNum:e.numOfQueue,interruptNum:e.numofInterrupt}:{}},trigger:function(e){var t=[].slice.call(arguments,1),n=this.options,i="on"+e.substring(0,1).toUpperCase()+e.substring(1);return!(!1===r.trigger.apply(this,arguments)||o.isFunction(n[i])&&!1===n[i].apply(this,t)||o.isFunction(this[i])&&!1===this[i].apply(this,t)||!1===r.trigger.apply(r,[this,e].concat(t)))},destroy:function(){this.request("destroy",arguments),this.off()},request:e.noop}),e.create=n.create=function(e){return new n(e)},e.Uploader=n}),e("runtime/runtime",["base","mediator"],function(t,e){var i=t.$,r={},o=function(e){for(var t in e)if(e.hasOwnProperty(t))return t;return null};function a(e){this.options=i.extend({container:document.body},e),this.uid=t.guid("rt_")}return i.extend(a.prototype,{getContainer:function(){var e,t,n=this.options;return this._container||(e=i(n.container||document.body),(t=i(document.createElement("div"))).attr("id","rt_"+this.uid),t.css({position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),e.append(t),e.addClass("webuploader-container"),this._container=t,this._parent=e,t)},init:t.noop,exec:t.noop,destroy:function(){this._container&&this._container.remove(),this._parent&&this._parent.removeClass("webuploader-container"),this.off()}}),a.orders="html5,flash",a.addRuntime=function(e,t){r[e]=t},a.hasRuntime=function(e){return!!(e?r[e]:o(r))},a.create=function(e,t){var n;if(t=t||a.orders,i.each(t.split(/\s*,\s*/g),function(){if(r[this])return n=this,!1}),!(n=n||o(r)))throw new Error("Runtime Error");return new r[n](e)},e.installTo(a.prototype),a}),e("runtime/client",["base","mediator","runtime/runtime"],function(o,e,a){var s,i;function t(t,n){var i,e,r=o.Deferred();this.uid=o.guid("client_"),this.runtimeReady=function(e){return r.done(e)},this.connectRuntime=function(e,t){if(i)throw new Error("already connected!");return r.done(t),"string"==typeof e&&s.get(e)&&(i=s.get(e)),(i=i||s.get(null,n))?(o.$.extend(i.options,e),i.__promise.then(r.resolve),i.__client++):((i=a.create(e,e.runtimeOrder)).__promise=r.promise(),i.once("ready",r.resolve),i.init(),s.add(i),i.__client=1),n&&(i.__standalone=n),i},this.getRuntime=function(){return i},this.disconnectRuntime=function(e){i&&(i.__client--,(i.__client<=0||e)&&(s.remove(i),delete i.__promise,i.destroy()),i=null)},this.exec=function(){if(i){var e=o.slice(arguments);return t&&e.unshift(t),i.exec.apply(this,e)}},this.getRuid=function(){return i&&i.uid},this.destroy=(e=this.destroy,function(){e&&e.apply(this,arguments),this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()})}return i={},s={add:function(e){i[e.uid]=e},get:function(e,t){if(e)return i[e];for(var n in i)if(!t||!i[n].__standalone)return i[n];return null},remove:function(e){delete i[e.uid]}},e.installTo(t.prototype),t}),e("lib/dnd",["base","mediator","runtime/client"],function(e,t,n){var i=e.$;function r(e){(e=this.options=i.extend({},r.options,e)).container=i(e.container),e.container.length&&n.call(this,"DragAndDrop")}return r.options={accept:null,disableGlobalDnd:!1},e.inherits(n,{constructor:r,init:function(){var e=this;e.connectRuntime(e.options,function(){e.exec("init"),e.trigger("ready")})}}),t.installTo(r.prototype),r}),e("widgets/widget",["base","uploader"],function(d,e){var o=d.$,t=e.prototype._init,n=e.prototype.destroy,h={},a=[];function f(e){if(!e)return!1;var t=e.length,n=o.type(e);return!(1!==e.nodeType||!t)||("array"===n||"function"!==n&&"string"!==n&&(0===t||"number"==typeof t&&0<t&&t-1 in e))}function r(e){this.owner=e,this.options=e.options}return o.extend(r.prototype,{init:d.noop,invoke:function(e,t){var n=this.responseMap;return n&&e in n&&n[e]in this&&o.isFunction(this[n[e]])?this[n[e]].apply(this,t):h},request:function(){return this.owner.request.apply(this.owner,arguments)}}),o.extend(e.prototype,{_init:function(){var n=this,i=n._widgets=[],r=n.options.disableWidgets||"";return o.each(a,function(e,t){r&&~r.indexOf(t._name)||i.push(new t(n))}),t.apply(n,arguments)},request:function(e,t,n){var i,r,o,a=0,s=this._widgets,c=s&&s.length,l=[],u=[];for(t=f(t)?t:[t];a<c;a++)(i=s[a].invoke(e,t))!==h&&(d.isPromise(i)?u:l).push(i);return n||u.length?(r=d.when.apply(d,u))[o=r.pipe?"pipe":"then"](function(){var e=d.Deferred(),t=arguments;return 1===t.length&&(t=t[0]),setTimeout(function(){e.resolve(t)},1),e.promise()})[n?o:"done"](n||d.noop):l[0]},destroy:function(){n.apply(this,arguments),this._widgets=null}}),e.register=r.register=function(e,t){var n,i={init:"init",destroy:"destroy",name:"anonymous"};return 1===arguments.length?(t=e,o.each(t,function(e){"_"!==e[0]&&"name"!==e?i[e.replace(/[A-Z]/g,"-$&").toLowerCase()]=e:"name"===e&&(i.name=t.name)})):i=o.extend(i,e),t.responseMap=i,(n=d.inherits(r,t))._name=i.name,a.push(n),n},e.unRegister=r.unRegister=function(e){if(e&&"anonymous"!==e)for(var t=a.length;t--;)a[t]._name===e&&a.splice(t,1)},r}),e("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(o,e,a){var s=o.$;return e.options.dnd="",e.register({name:"dnd",init:function(e){if(e.dnd&&"html5"===this.request("predict-runtime-type")){var t,n=this,i=o.Deferred(),r=s.extend({},{disableGlobalDnd:e.disableGlobalDnd,container:e.dnd,accept:e.accept,ignoreDragElement:e.ignoreDragElement});return this.dnd=t=new a(r),t.once("ready",i.resolve),t.on("drop",function(e){n.request("add-file",[e])}),t.on("accept",function(e){return n.owner.trigger("dndAccept",e)}),t.init(),i.promise()}},destroy:function(){this.dnd&&(this.dnd.destroy(),this.dnd.disconnectRuntime(!0))}})}),e("lib/filepaste",["base","mediator","runtime/client"],function(e,t,n){var i=e.$;function r(e){(e=this.options=i.extend({},e)).container=i(e.container||document.body),n.call(this,"FilePaste",!0)}return e.inherits(n,{constructor:r,init:function(){var e=this;e.connectRuntime(e.options,function(){e.exec("init"),e.trigger("ready")})}}),t.installTo(r.prototype),r}),e("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(o,e,a){var s=o.$;return e.register({name:"paste",init:function(e){if(e.paste&&"html5"===this.request("predict-runtime-type")){var t,n=this,i=o.Deferred(),r=s.extend({},{container:e.paste,accept:e.accept,ignorePasteElement:e.ignorePasteElement});return this.paste=t=new a(r),t.once("ready",i.resolve),t.on("paste",function(e){e.forEach(function(e){e.logSource="paste"}),n.owner.request("add-file",[e])}),t.init(),i.promise()}},destroy:function(){this.paste&&this.paste.destroy()}})}),e("lib/blob",["base","runtime/client"],function(e,i){function t(e,t){var n=this;n.source=t,n.ruid=e,this.size=t.size||0,!t.type&&this.ext&&~"jpg,jpeg,png,gif,bmp".indexOf(this.ext)?this.type="image/"+("jpg"===this.ext?"jpeg":this.ext):this.type=t.type||"application/octet-stream",i.call(n,"Blob"),this.uid=t.uid||this.uid,e&&n.connectRuntime(e)}return e.inherits(i,{constructor:t,slice:function(e,t){return this.exec("slice",e,t)},getSource:function(){return this.source}}),t}),e("lib/file",["base","lib/blob"],function(e,i){var r=1,o=/\.([^.]+)$/;function t(e,t){var n;this.name=t.name||"untitled"+r++,!(n=o.exec(t.name)?RegExp.$1.toLowerCase():"")&&t.type&&(n=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(t.type)?RegExp.$1.toLowerCase():"",this.name+="."+n),/\.xmind\.zip$/.test(this.name)&&"zip"===n&&(this.name=this.name.slice(0,this.name.length-4),n="xmind"),this.ext=n,this.lastModifiedDate=t.lastModifiedDate||(new Date).toLocaleString(),this.logSource=t.logSource,this.atUuid=t.atUuid,i.apply(this,arguments)}return e.inherits(i,t)}),e("lib/filepicker",["base","runtime/client","lib/file"],function(e,t,o){var a=e.$;function n(e){if((e=this.options=a.extend({},n.options,e)).container=a(e.id),!e.container.length)throw new Error(i("etherpad.button.assignment_error"));e.innerHTML=e.innerHTML||e.label||e.container.html()||"",e.button=a(e.button||document.createElement("div")),e.button.html(e.innerHTML),e.container.html(e.button),t.call(this,"FilePicker",!0)}return n.options={button:null,container:null,label:null,innerHTML:null,multiple:!0,accept:null,name:"file"},e.inherits(t,{constructor:n,init:function(){var n=this,i=n.options,r=i.button;r.addClass("webuploader-pick"),n.on("all",function(e){var t;switch(e){case"mouseenter":r.addClass("webuploader-pick-hover");break;case"mouseleave":r.removeClass("webuploader-pick-hover");break;case"change":t=n.exec("getFiles"),n.trigger("select",a.map(t,function(e){return(e=new o(n.getRuid(),e))._refer=i.container,e}),i.container)}}),n.connectRuntime(i,function(){n.refresh(),n.exec("init",i),n.trigger("ready")}),this._resizeHandler=e.bindFn(this.refresh,this),a(C).on("resize",this._resizeHandler)},refresh:function(){var e=this.getRuntime().getContainer(),t=this.options.button,n=t.outerWidth?t.outerWidth():t.width(),i=t.outerHeight?t.outerHeight():t.height(),r=t.offset();n&&i&&e.css({bottom:"auto",right:"auto",width:n+"px",height:i+"px"}).offset(r)},enable:function(){this.options.button.removeClass("webuploader-pick-disable"),this.refresh()},disable:function(){var e=this.options.button;this.getRuntime().getContainer().css({top:"-99999px"}),e.addClass("webuploader-pick-disable")},destroy:function(){var e=this.options.button;a(C).off("resize",this._resizeHandler),e.removeClass("webuploader-pick-disable webuploader-pick-hover webuploader-pick")}}),n}),e("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(c,e,l){var u=c.$;return u.extend(e.options,{pick:null,accept:null}),e.register({name:"picker",init:function(e){return this.pickers=[],e.pick&&this.addBtn(e.pick)},refresh:function(){u.each(this.pickers,function(){this.refresh()})},addBtn:function(i){var r=this,o=r.options,a=o.accept,s=[];if(i)return u.isPlainObject(i)||(i={id:i}),u(i.id).each(function(){var e=c.Deferred(),t=u.extend({},i,{accept:u.isPlainObject(a)?[a]:a,swf:o.swf,runtimeOrder:o.runtimeOrder,id:this}),n=new l(t);n.once("ready",e.resolve),n.on("select",function(e){r.owner.request("add-file",[e])}),n.init(),r.pickers.push(n),s.push(e.promise())}),c.when.apply(c,s)},disable:function(){u.each(this.pickers,function(){this.disable()})},enable:function(){u.each(this.pickers,function(){this.enable()})},destroy:function(){u.each(this.pickers,function(){this.destroy()}),this.pickers=null}})}),e("lib/image",["base","runtime/client","lib/blob"],function(t,n,i){var r=t.$;function Image(e){this.options=r.extend({},Image.options,e),n.call(this,"Image"),this.on("load",function(){this._info=this.exec("info"),this._meta=this.exec("meta")})}return Image.options={quality:90,crop:!1,preserveHeaders:!1,allowMagnify:!1},t.inherits(n,{constructor:Image,info:function(e){return e?(this._info=e,this):this._info},meta:function(e){return e?(this._meta=e,this):this._meta},loadFromBlob:function(e){var t=this,n=e.getRuid();this.connectRuntime(n,function(){t.exec("init",t.options),t.exec("loadFromBlob",e)})},resize:function(){var e=t.slice(arguments);return this.exec.apply(this,["resize"].concat(e))},crop:function(){var e=t.slice(arguments);return this.exec.apply(this,["crop"].concat(e))},getAsDataUrl:function(e){return this.exec("getAsDataUrl",e)},getAsBlob:function(e){var t=this.exec("getAsBlob",e);return new i(this.getRuid(),t)}}),Image}),e("widgets/image",["base","uploader","lib/image","widgets/widget"],function(t,e,Image){var a,n,i,r,o,c=t.$;return n=5242880,i=0,r=[],o=function(){for(var e;r.length&&i<n;)e=r.shift(),i+=e[0],e[1]()},a=function(e,t,n){r.push([t,n]),e.once("destroy",function(){i-=t,setTimeout(o,1)}),setTimeout(o,1)},c.extend(e.options,{thumb:{width:110,height:110,quality:70,allowMagnify:!0,crop:!0,preserveHeaders:!1,type:"image/jpeg"},compress:{width:1600,height:1600,quality:90,allowMagnify:!1,crop:!1,preserveHeaders:!0}}),e.register({name:"image",makeThumb:function(e,t,n,i){var r,o;(e=this.request("get-file",e)).type.match(/^image/)?(r=c.extend({},this.options.thumb),c.isPlainObject(n)&&(r=c.extend(r,n),n=null),n=n||r.width,i=i||r.height,(o=new Image(r)).once("load",function(){e._info=e._info||o.info(),e._meta=e._meta||o.meta(),n<=1&&0<n&&(n=e._info.width*n),i<=1&&0<i&&(i=e._info.height*i),o.resize(n,i)}),o.once("complete",function(){t(!1,o.getAsDataUrl(r.type)),o.destroy()}),o.once("error",function(e){t(e||!0),o.destroy()}),a(o,e.source.size,function(){e._info&&o.info(e._info),e._meta&&o.meta(e._meta),o.loadFromBlob(e.source)})):t(!0)},beforeSendFile:function(i){var r,o,a=this.options.compress||this.options.resize,e=a&&a.compressSize||0,s=a&&a.noCompressIfLarger||!1;if(i=this.request("get-file",i),a&&~"image/jpeg,image/jpg".indexOf(i.type)&&!(i.size<e)&&!i._compressed)return a=c.extend({},a),o=t.Deferred(),r=new Image(a),o.always(function(){r.destroy(),r=null}),r.once("error",o.reject),r.once("load",function(){var e=a.width,t=a.height;i._info=i._info||r.info(),i._meta=i._meta||r.meta(),e<=1&&0<e&&(e=i._info.width*e),t<=1&&0<t&&(t=i._info.height*t),r.resize(e,t)}),r.once("complete",function(){var e,t;try{e=r.getAsBlob(a.type),t=i.size;var n=arguments[1];(e.size<t&&!s||n)&&(i.source=e,i.size=e.size,i.trigger("resize",e.size,t)),i._compressed=!0,o.resolve()}catch(e){o.resolve()}}),i._info&&r.info(i._info),i._meta&&r.meta(i._meta),r.loadFromBlob(i.source),o.promise()}})}),e("file",["base","mediator"],function(e,t){var n=e.$,i="WU_FILE_",r=0,o=/\.([^.]+)$/,a={};function s(){return i+r++}function c(e){this.name=e.name||"Untitled",this.size=e.size||0,this.type=e.type||"application/octet-stream",this.lastModifiedDate=e.lastModifiedDate||+new Date,this.id=s(),this.ext=o.exec(this.name)?RegExp.$1:"",this.statusText="",a[this.id]=c.Status.INITED,this.source=e,this.loaded=0,this.on("error",function(e){this.setStatus(c.Status.ERROR,e)})}return n.extend(c.prototype,{setStatus:function(e,t){var n=a[this.id];void 0!==t&&(this.statusText=t),e!==n&&(a[this.id]=e,this.trigger("statuschange",e,n))},getStatus:function(){return a[this.id]},getSource:function(){return this.source},destroy:function(){this.off(),delete a[this.id]}}),t.installTo(c.prototype),c.Status={INITED:"inited",QUEUED:"queued",PROGRESS:"progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled",INTERRUPT:"interrupt",INVALID:"invalid"},c}),e("queue",["base","mediator","file"],function(e,t,n){var o=e.$,r=n.Status;function i(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0,numofDeleted:0,numofInterrupt:0},this._queue=[],this._map={}}return o.extend(i.prototype,{append:function(e){return this._queue.push(e),this._fileAdded(e),this},prepend:function(e){return this._queue.unshift(e),this._fileAdded(e),this},getFile:function(e){return"string"!=typeof e?e:this._map[e]},fetch:function(e){var t,n,i=this._queue.length;for(e=e||r.QUEUED,t=0;t<i;t++)if(e===(n=this._queue[t]).getStatus())return n;return null},sort:function(e){"function"==typeof e&&this._queue.sort(e)},getFiles:function(){for(var e,t=[].slice.call(arguments,0),n=[],i=0,r=this._queue.length;i<r;i++)e=this._queue[i],t.length&&!~o.inArray(e.getStatus(),t)||n.push(e);return n},removeFile:function(e){this._map[e.id]&&(delete this._map[e.id],e.destroy(),this.stats.numofDeleted++)},_fileAdded:function(e){var n=this;this._map[e.id]||(this._map[e.id]=e).on("statuschange",function(e,t){n._onFileStatusChange(e,t)})},_onFileStatusChange:function(e,t){var n=this.stats;switch(t){case r.PROGRESS:n.numOfProgress--;break;case r.QUEUED:n.numOfQueue--;break;case r.ERROR:n.numOfUploadFailed--;break;case r.INVALID:n.numOfInvalid--;break;case r.INTERRUPT:n.numofInterrupt--}switch(e){case r.QUEUED:n.numOfQueue++;break;case r.PROGRESS:n.numOfProgress++;break;case r.ERROR:n.numOfUploadFailed++;break;case r.COMPLETE:n.numOfSuccess++;break;case r.CANCELLED:n.numOfCancel++;break;case r.INVALID:n.numOfInvalid++;break;case r.INTERRUPT:n.numofInterrupt++}}}),t.installTo(i.prototype),i}),e("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(l,e,u,t,n,d){var h=l.$,i=/\.\w+$/,a=t.Status;return e.register({name:"queue",init:function(e){var t,n,i,r,o,a,s,c=this;if(h.isPlainObject(e.accept)&&(e.accept=[e.accept]),e.accept){for(o=[],i=0,n=e.accept.length;i<n;i++)(r=e.accept[i].extensions)&&o.push(r);o.length&&(a="\\."+o.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"),c.accept=new RegExp(a,"i")}if(c.queue=new u,c.stats=c.queue.stats,"html5"===this.request("predict-runtime-type"))return t=l.Deferred(),this.placeholder=s=new d("Placeholder"),s.connectRuntime({runtimeOrder:"html5"},function(){c._ruid=s.getRuid(),t.resolve()}),t.promise()},_wrapFile:function(e){if(!(e instanceof t)){if(!(e instanceof n)){if(!this._ruid)throw new Error("Can't add external files.");e=new n(this._ruid,e)}e=new t(e)}return e},acceptFile:function(e){return!(!e||!e.size||this.accept&&i.exec(e.name)&&!this.accept.test(e.name))},_addFile:function(e){var t=this;if(e=t._wrapFile(e),t.owner.trigger("beforeFileQueued",e)){if(t.acceptFile(e))return t.queue.append(e),t.owner.trigger("fileQueued",e),e;t.owner.trigger("error","Q_TYPE_DENIED",e)}},getFile:function(e){return this.queue.getFile(e)},addFile:function(e){var t=this;e.length||(e=[e]),e=h.map(e,function(e){return t._addFile(e)}),t.owner.trigger("filesQueued",e),t.options.auto&&setTimeout(function(){t.request("start-upload")},20)},getStats:function(){return this.stats},removeFile:function(e,t){var n=this;e=e.id?e:n.queue.getFile(e),this.request("cancel-file",e),t&&this.queue.removeFile(e)},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(e,t){var n,i,r,o=this;if(e)return(e=e.id?e:o.queue.getFile(e)).setStatus(a.QUEUED),void(t||o.request("start-upload"));for(i=0,r=(n=o.queue.getFiles(a.ERROR)).length;i<r;i++)(e=n[i]).setStatus(a.QUEUED);o.request("start-upload")},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.owner.trigger("reset"),this.queue=new u,this.stats=this.queue.stats},destroy:function(){this.reset(),this.placeholder&&this.placeholder.destroy()}})}),e("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(e,r){return e.support=function(){return r.hasRuntime.apply(r,arguments)},e.register({name:"runtime",init:function(){if(!this.predictRuntimeType())throw Error("Runtime Error")},predictRuntimeType:function(){var e,t,n=this.options.runtimeOrder||r.orders,i=this.type;if(!i)for(e=0,t=(n=n.split(/\s*,\s*/g)).length;e<t;e++)if(r.hasRuntime(n[e])){this.type=i=n[e];break}return i}})}),e("lib/transport",["base","runtime/client","mediator"],function(e,n,t){var i=e.$;function r(e){var t=this;e=t.options=i.extend(!0,{},r.options,e||{}),n.call(this,"Transport"),this._blob=null,this._formData=e.formData||{},this._headers=e.headers||{},this.on("progress",this._timeout),this.on("load error",function(){t.trigger("progress",1),clearTimeout(t._timer)})}return r.options={server:"",method:"POST",withCredentials:!1,fileVal:"file",timeout:12e4,formData:{},headers:{},sendAsBinary:!1,formDataAsQuery:!1},i.extend(r.prototype,{appendBlob:function(e,t,n){var i=this,r=i.options;i.getRuid()&&i.disconnectRuntime(),i.connectRuntime(t.ruid,function(){i.exec("init")}),i._blob=t,r.fileVal=e||r.fileVal,r.filename=n||r.filename},append:function(e,t){"object"===g()(e)?i.extend(this._formData,e):this._formData[e]=t},setRequestHeader:function(e,t){"object"===g()(e)?i.extend(this._headers,e):this._headers[e]=t},send:function(e){this.exec("send",e),this._timeout()},abort:function(){return clearTimeout(this._timer),this.exec("abort")},destroy:function(){this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()},getResponse:function(){return this.exec("getResponse")},getResponseAsJson:function(){return this.exec("getResponseAsJson")},getStatus:function(){return this.exec("getStatus")},_timeout:function(){var e=this,t=e.options.timeout;t&&(clearTimeout(e._timer),e._timer=setTimeout(function(){e.abort(),e.trigger("error","timeout")},t))}}),t.installTo(r.prototype),r}),e("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(u,e,t,d){var h=u.$,a=u.isPromise,f=t.Status;function s(e,t){for(var n,i=[],r=e.source.size,o=t?Math.ceil(r/t):1,a=0,s=0,c={file:e,has:function(){return!!i.length},shift:function(){return i.shift()},unshift:function(e){i.unshift(e)}};s<o;)n=Math.min(t,r-a),i.push({file:e,start:a,end:t?a+n:r,total:r,chunks:o,chunk:s++,cuted:c}),a+=n;return e.blocks=i.concat(),e.remaning=i.length,c}h.extend(e.options,{prepareNextFile:!1,chunked:!1,chunkSize:5242880,chunkRetry:2,threads:10,formData:{}}),e.register({name:"upload",init:function(){var e=this.owner,t=this;this.runing=!1,this.progress=!1,e.on("startUpload",function(){t.progress=!0}).on("uploadFinished",function(){t.progress=!1}),this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this.__tick=u.bindFn(this._tick,this),e.on("uploadComplete",function(e){e.blocks&&h.each(e.blocks,function(e,t){t.transport&&(t.transport.abort(),t.transport.destroy()),delete t.transport}),delete e.blocks,delete e.remaning})},reset:function(){this.request("stop-upload",!0),this.runing=!1,this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this._trigged=!1,this._promise=null},startUpload:function(n){var i=this;if(h.each(i.request("get-files",f.INVALID),function(){i.request("remove-file",this)}),n)if((n=n.id?n:i.request("get-file",n)).getStatus()===f.INTERRUPT)h.each(i.pool,function(e,t){t.file===n&&t.transport&&t.transport.send()}),n.setStatus(f.QUEUED);else{if(n.getStatus()===f.PROGRESS)return;n.setStatus(f.QUEUED)}else h.each(i.request("get-files",[f.INITED]),function(){this.setStatus(f.QUEUED)});if(!i.runing){i.runing=!0;var r=[];for(h.each(i.pool,function(e,t){var n=t.file;n.getStatus()===f.INTERRUPT&&(r.push(n),i._trigged=!1,t.transport&&t.transport.send())});n=r.shift();)n.setStatus(f.PROGRESS);n||h.each(i.request("get-files",f.INTERRUPT),function(){this.setStatus(f.PROGRESS)}),i._trigged=!1,u.nextTick(i.__tick),i.owner.trigger("startUpload")}},stopUpload:function(n,e){var i=this;if(!0===n&&(e=n,n=null),!1!==i.runing){if(n)return(n=n.id?n:i.request("get-file",n)).getStatus()!==f.PROGRESS&&n.getStatus()!==f.QUEUED?void 0:(n.setStatus(f.INTERRUPT),h.each(i.pool,function(e,t){t.file===n&&(t.transport&&t.transport.abort(),i._putback(t),i._popBlock(t))}),u.nextTick(i.__tick));i.runing=!1,this._promise&&this._promise.file&&this._promise.file.setStatus(f.INTERRUPT),e&&h.each(i.pool,function(e,t){t.transport&&t.transport.abort(),t.file.setStatus(f.INTERRUPT)}),i.owner.trigger("stopUpload")}},cancelFile:function(e){(e=e.id?e:this.request("get-file",e)).blocks&&h.each(e.blocks,function(e,t){var n=t.transport;n&&(n.abort(),n.destroy(),delete t.transport)}),e.setStatus(f.CANCELLED),this.owner.trigger("fileDequeued",e)},isInProgress:function(){return!!this.progress},_getStats:function(){return this.request("get-stats")},skipFile:function(e,t){(e=e.id?e:this.request("get-file",e)).setStatus(t||f.COMPLETE),e.skipped=!0,e.blocks&&h.each(e.blocks,function(e,t){var n=t.transport;n&&(n.abort(),n.destroy(),delete t.transport)}),this.owner.trigger("uploadSkip",e)},_tick:function(){var e,t,n=this,i=n.options;if(n._promise)return n._promise.always(n.__tick);n.pool.length<i.threads&&(t=n._nextBlock())?(n._trigged=!1,e=function(e){n._promise=null,e&&e.file&&n._startSend(e),u.nextTick(n.__tick)},n._promise=a(t)?t.always(e):e(t)):n.remaning||n._getStats().numOfQueue||n._getStats().numofInterrupt||(n.runing=!1,n._trigged||u.nextTick(function(){n.owner.trigger("uploadFinished")}),n._trigged=!0)},_putback:function(e){e.cuted.unshift(e),~this.stack.indexOf(e.cuted)||this.stack.unshift(e.cuted)},_getStack:function(){for(var e,t=0;e=this.stack[t++];){if(e.has()&&e.file.getStatus()===f.PROGRESS)return e;e.has()&&(e.file.getStatus()===f.PROGRESS||e.file.getStatus()===f.INTERRUPT)||this.stack.splice(--t,1)}return null},_nextBlock:function(){var t,e,n,i,r=this,o=r.options;return(t=this._getStack())?(o.prepareNextFile&&!r.pending.length&&r._prepareNextFile(),t.shift()):r.runing?(!r.pending.length&&r._getStats().numOfQueue&&r._prepareNextFile(),e=r.pending.shift(),n=function(e){return e?(t=s(e,o.chunked?o.chunkSize:0),r.stack.push(t),t.shift()):null},a(e)?(i=e.file,(e=e[e.pipe?"pipe":"then"](n)).file=i,e):n(e)):void 0},_prepareNextFile:function(){var t,n=this,i=n.request("fetch-file"),r=n.pending;i&&(t=n.request("before-send-file",i,function(){return i.getStatus()===f.PROGRESS||i.getStatus()===f.INTERRUPT?i:n._finishFile(i)}),n.owner.trigger("uploadStart",i),i.setStatus(f.PROGRESS),t.file=i,t.done(function(){var e=h.inArray(t,r);~e&&r.splice(e,1,i)}),t.fail(function(e){i.setStatus(f.ERROR,e),n.owner.trigger("uploadError",i,e),n.owner.trigger("uploadComplete",i)}),r.push(t))},_popBlock:function(e){var t=h.inArray(e,this.pool);this.pool.splice(t,1),e.file.remaning--,this.remaning--},_startSend:function(e){var t=this,n=e.file;n.getStatus()===f.PROGRESS?(t.pool.push(e),t.remaning++,e.blob=1===e.chunks?n.source:n.source.slice(e.start,e.end),t.request("before-send",e,function(){n.getStatus()===f.PROGRESS?t._doSend(e):(t._popBlock(e),u.nextTick(t.__tick))}).fail(function(){1===n.remaning?t._finishFile(n).always(function(){e.percentage=1,t._popBlock(e),t.owner.trigger("uploadComplete",n),u.nextTick(t.__tick)}):(e.percentage=1,t.updateFileProgress(n),t._popBlock(e),u.nextTick(t.__tick))})):n.getStatus()===f.INTERRUPT&&t._putback(e)},_doSend:function(n){var i,r,t=this,o=t.owner,a=t.options,s=n.file,c=new d(a),e=h.extend({},a.formData),l=h.extend({},a.headers);(n.transport=c).on("destroy",function(){delete n.transport,t._popBlock(n),u.nextTick(t.__tick)}),c.on("progress",function(e){n.percentage=e,t.updateFileProgress(s)}),i=function(t){var e;return(r=c.getResponseAsJson()||{})._raw=c.getResponse(),e=function(e){t=e},o.trigger("uploadAccept",n,r,e)||(t=t||"server"),t},c.on("error",function(e,t){n.retried=n.retried||0,1<n.chunks&&~"http,abort".indexOf(e)&&n.retried<a.chunkRetry?(n.retried++,c.send()):(t||"server"!==e||(e=i(e)),s.setStatus(f.ERROR,e),o.trigger("uploadError",s,e),o.trigger("uploadComplete",s))}),c.on("load",function(){var e;(e=i())?c.trigger("error",e,!0):1===s.remaning?t._finishFile(s,r):c.destroy()}),e=h.extend(e,{id:s.id,name:s.name,type:s.type,lastModifiedDate:s.lastModifiedDate,size:s.size}),1<n.chunks&&h.extend(e,{chunks:n.chunks,chunk:n.chunk}),o.trigger("uploadBeforeSend",n,e,l),c.appendBlob(a.fileVal,n.blob,s.name),c.append(e),c.setRequestHeader(l),c.send()},_finishFile:function(t,e,n){var i=this.owner;return i.request("after-send-file",arguments,function(){t.setStatus(f.COMPLETE),i.trigger("uploadSuccess",t,e,n)}).fail(function(e){t.getStatus()===f.PROGRESS&&t.setStatus(f.ERROR,e),i.trigger("uploadError",t,e)}).always(function(){i.trigger("uploadComplete",t)})},updateFileProgress:function(e){var t=0,n=0;e.blocks&&(h.each(e.blocks,function(e,t){n+=(t.percentage||0)*(t.end-t.start)}),t=n/e.size,this.owner.trigger("uploadProgress",e,t||0))}})}),e("widgets/validator",["base","uploader","file","widgets/widget"],function(t,e,n){var i=t.$,r={},o={addValidator:function(e,t){r[e]=t},removeValidator:function(e){delete r[e]}};return e.register({name:"validator",init:function(){var e=this;t.nextTick(function(){i.each(r,function(){this.call(e.owner)})})}}),o.addValidator("fileNumLimit",function(){var e=this,t=e.options,n=0,i=parseInt(t.fileNumLimit,10),r=!0;i&&(e.on("beforeFileQueued",function(e){return i<=n&&r&&(r=!1,this.trigger("error","Q_EXCEED_NUM_LIMIT",i,e),setTimeout(function(){r=!0},1)),!(i<=n)}),e.on("fileQueued",function(){n++}),e.on("fileDequeued",function(){n--}),e.on("reset",function(){n=0}))}),o.addValidator("fileSizeLimit",function(){var e=this,t=e.options,n=0,i=parseInt(t.fileSizeLimit,10),r=!0;i&&(e.on("beforeFileQueued",function(e){var t=n+e.size>i;return t&&r&&(r=!1,this.trigger("error","Q_EXCEED_SIZE_LIMIT",i,e),setTimeout(function(){r=!0},1)),!t}),e.on("fileQueued",function(e){n+=e.size}),e.on("fileDequeued",function(e){n-=e.size}),e.on("reset",function(){n=0}))}),o.addValidator("fileSingleSizeLimit",function(){var e=this,t=e.options.fileSingleSizeLimit;t&&e.on("beforeFileQueued",function(e){if(e.size>t)return e.setStatus(n.Status.INVALID,"exceed_size"),this.trigger("error","F_EXCEED_SIZE",t,e),!1})}),o.addValidator("duplicate",function(){var e=this,t=e.options,n={};function i(e){for(var t=0,n=0,i=e.length;n<i;n++)t=e.charCodeAt(n)+(t<<6)+(t<<16)-t;return t}t.duplicate||(e.on("beforeFileQueued",function(e){var t=e.__hash||(e.__hash=i(e.name+e.size+e.lastModifiedDate));if(n[t])return this.trigger("error","F_DUPLICATE",e),!1}),e.on("fileQueued",function(e){var t=e.__hash;t&&(n[t]=!0)}),e.on("fileDequeued",function(e){var t=e.__hash;t&&delete n[t]}),e.on("reset",function(){n={}}))}),o}),e("runtime/compbase",[],function(){function e(e,t){this.owner=e,this.options=e.options,this.getRuntime=function(){return t},this.getRuid=function(){return t.uid},this.trigger=function(){return e.trigger.apply(e,arguments)}}return e}),e("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(c,t,n){var i="html5",l={};function e(){var a={},s=this,e=this.destroy;t.apply(s,arguments),s.type=i,s.exec=function(e,t){var n,i=this,r=i.uid,o=c.slice(arguments,2);if(l[e]&&(n=a[r]=a[r]||new l[e](i,s))[t])return n[t].apply(n,o)},s.destroy=function(){return e&&e.apply(this,arguments)}}return c.inherits(t,{constructor:e,init:function(){var e=this;setTimeout(function(){e.trigger("ready")},1)}}),e.register=function(e,t){return l[e]=c.inherits(n,t)},C.Blob&&C.FileReader&&C.DataView&&t.addRuntime(i,e),e}),e("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(e,r){return e.register("Blob",{slice:function(e,t){var n=(i=this.owner.source).slice||i.webkitSlice||i.mozSlice,i=n.call(i,e,t);return new r(this.getRuid(),i)}})}),e("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(p,e,s){var c=p.$,l="webuploader-dnd-";return e.register("DragAndDrop",{init:function(){var e=this.elem=this.options.container;this.dragEnterHandler=p.bindFn(this._dragEnterHandler,this),this.dragOverHandler=p.bindFn(this._dragOverHandler,this),this.dragLeaveHandler=p.bindFn(this._dragLeaveHandler,this),this.dropHandler=p.bindFn(this._dropHandler,this),this.dndOver=!1,e.on("dragenter",this.dragEnterHandler),e.on("dragover",this.dragOverHandler),e.on("dragleave",this.dragLeaveHandler),e.on("drop",this.dropHandler),this.options.disableGlobalDnd&&(c(document).on("dragover",this.dragOverHandler),c(document).on("drop",this.dropHandler))},_dragEnterHandler:function(e){var t,n=this,i=n._denied||!1;e=e.originalEvent||e;var r=this.options.ignoreDragElement;return!!p.isIgnoreEvent(e,r)||(n.dndOver||(n.dndOver=!0,(t=e.dataTransfer.items)&&t.length&&(n._denied=i=!n.trigger("accept",t)),n.elem.addClass(l+"over"),n.elem[i?"addClass":"removeClass"](l+"denied")),e.dataTransfer.dropEffect=i?"none":"copy",!1)},_dragOverHandler:function(e){var t=this.elem.parent().get(0),n=this.options.ignoreDragElement;return!!p.isIgnoreEvent(e,n)||(t&&!c.contains(t,e.currentTarget)||(clearTimeout(this._leaveTimer),this._dragEnterHandler.call(this,e)),!1)},_dragLeaveHandler:function(e){var t,n=this,i=this.options.ignoreDragElement;return!!p.isIgnoreEvent(e,i)||(t=function(){n.dndOver=!1,n.elem.removeClass(l+"over "+l+"denied")},clearTimeout(n._leaveTimer),n._leaveTimer=setTimeout(t,100),!1)},_dropHandler:function(e){var t,n,i=this,r=i.getRuid(),o=i.elem.parent().get(0),a=this.options.ignoreDragElement;if(p.isIgnoreEvent(e,a))return!0;if(o&&!c.contains(o,e.currentTarget))return!1;t=(e=e.originalEvent||e).dataTransfer;try{n=t.getData("text/html")}catch(e){}return n?void 0:(i._getTransferFiles(t,function(e){i.trigger("drop",c.map(e,function(e){var t=new s(r,e);return t.logSource="drag",t.fromDir=!!e.fromDir,t}))}),i.dndOver=!1,i.elem.removeClass(l+"over"),!1)},_getTransferFiles:function(e,t){var n,i,r,o,a=[],s=[],c=e.items,l=e.files,u=null;for(c&&(u=Array.prototype.slice.call(c).slice(0)),o=!(!c||!c[0].webkitGetAsEntry),i=0,r=l.length;i<r;i++){var d,h,f=(n=l[i]).type;(h=u&&u[i])&&(d=h.type,f.toUpperCase()!==d.toUpperCase()&&(u.splice(i,1),h=u[i])),o&&h.webkitGetAsEntry().isDirectory?s.push(this._traverseDirectoryTree(h.webkitGetAsEntry(),a)):a.push(n)}p.when.apply(p,s).then(function(){a.length&&t(a)})},_traverseDirectoryTree:function(e,o){var a=p.Deferred(),s=this;return e.isFile?e.file(function(e){e.fromDir=!0,o.push(e),a.resolve()}):e.isDirectory&&e.createReader().readEntries(function(e){for(var t=e.length,n=[],i=[],r=0;r<t;r++)n.push(s._traverseDirectoryTree(e[r],i));p.when.apply(p,n).then(function(){o.push.apply(o,i),a.resolve()},a.reject)}),a.promise()},destroy:function(){var e=this.elem;e&&(e.off("dragenter",this.dragEnterHandler),e.off("dragover",this.dragOverHandler),e.off("dragleave",this.dragLeaveHandler),e.off("drop",this.dropHandler),this.options.disableGlobalDnd&&(c(document).off("dragover",this.dragOverHandler),c(document).off("drop",this.dropHandler)))}})}),e("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(E,e,O){return e.register("FilePaste",{init:function(){var e,t,n,i,r=this.options,o=this.elem=r.container,a=".*";if(r.accept){for(e=[],t=0,n=r.accept.length;t<n;t++)(i=r.accept[t].mimeTypes)&&e.push(i);e.length&&(a=(a=e.join(",")).replace(/,/g,"|").replace(/\*/g,".*"))}this.accept=a=new RegExp(a,"i"),this.hander=E.bindFn(this._pasteHander,this),this.compatibleSafariPasteHandler=E.bindFn(this._compatibleSafariPasteHandler,this),o.on("paste",this.hander),o.on("custom-compatible-safari-paste",this.compatibleSafariPasteHandler)},_checkFromWord:function(e){var t=e.clipboardData||C.clipboardData,n=t.types,i=t.items||t.files,r=t.getData("text/html"),o=n&&n.length&&Array.prototype.some.call(n,function(e){return"text/rtf"===e}),a=!1,s=i&&i.length||0;if(s)for(var c=0;c<s;++c)/image/.exec(i[c].type)&&(a=!0);var l=r&&-1<r.indexOf("schemas-microsoft-com");return o&&a&&l},_base64toBlob:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:512,i=atob(e),r=[],o=0;o<i.length;o+=n){for(var a=i.slice(o,o+n),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a.charCodeAt(c);r.push(new Uint8Array(s))}return new Blob(r,{type:t})},_fetchFromBlobUrl:function(i){return new Promise(function(t,n){var e=new XMLHttpRequest;e.open("GET",i,!0),e.responseType="blob",e.onload=function(e){if(200==this.status)return t(this.response);n(this.response)},e.send()})},_compatibleSafariPasteHandler:function(e){var t=this.options.ignorePasteElement;if(E.isIgnoreEvent(e,t))return!0;var o,n=(e=e.originalEvent||e).detail;n&&(o=this)._fetchFromBlobUrl(n).then(function(e){var t=new FileReader;t.onload=function(e){var n=new Image,i=document.createElement("canvas"),r=i.getContext("2d");n.onload=function(){i.width=n.width,i.height=n.height,r.drawImage(n,0,0);var e=i.toDataURL("image/png"),t=o._base64toBlob(e.replace(/data:image\/png;base64,/,""),"image/png");o.trigger("paste",[new O(o.getRuid(),t)])},n.src=e.target.result},t.readAsDataURL(e)})},maybeImagePaste:function(e){var t=e.clipboardData;if(!t)return!1;var n=t.types,i=t.items,r=void 0===i?[]:i,o=JSON.stringify(n),a=1===n.length&&"Files"===n[0],s=2===n.length&&/("text\/plain","Files"|"Files","text\/plain")/.test(o),c=2===n.length&&/"text\/html","Files"|"Files","text\/html"/.test(o),l=E.browser.safari&&/"Files","text\/uri-list"/.test(o);if(a||s||c||l){var u=Array.prototype.slice.call(r).filter(function(e){return"file"===e.kind}),d=u.filter(function(e){return 0===e.type.indexOf("image/")});return d.length===u.length&&0<d.map(function(e){return e.getAsFile()}).filter(function(e){return!!e}).length}return!1},_pasteHander:function(e){var t=this.options.ignorePasteElement;if(E.isIgnoreEvent(e,t))return!0;var n,i,r,o,a=[],s=this.getRuid();e=e.originalEvent||e;var c,l,u=this.maybeImagePaste(e);if((l=(c=e.clipboardData||C.clipboardData).items||null)&&!this._checkFromWord(e)){for(r=0,o=l.length;r<o;r++)"file"===(n=l[r]).kind&&(y=n.getAsFile())&&u&&a.push(new O(s,y));var d=e.clipboardData.getData("text/html");if(/docs-internal-guid/.test(d))for(var h=/src=\"data:image\/([a-zA-Z]*);base64,([^\"]*)\"/g,f=h.exec(d);f;){var p=f,g=k()(p,3),m=(g[0],g[1]),v=g[2],b="image/"+m,y=this._base64toBlob(v,b);a.push(new O(this.getRuid(),y)),f=h.exec(d)}}if(!l)for(r=0,o=(i=c.files||[]).length;r<o;r++)y=i[r],a.push(new O(s,y));a.length&&(e.preventDefault(),e.stopPropagation(),this.trigger("paste",a))},destroy:function(){this.elem&&(this.elem.off("paste",this.hander),this.elem.off("custom-compatible-safari-paste",this.compatibleSafariPasteHandler))}})}),e("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(e,t){var u=e.$;return t.register("FilePicker",{init:function(){var e,t,n,r,i=this.getRuntime().getContainer(),o=this,a=o.owner,s=o.options,c=this.label=u(document.createElement("label")),l=this.input=u(document.createElement("input"));if(l.attr("type","file"),l.attr("name",s.name),l.addClass("webuploader-element-invisible"),c.on("click",function(){l.trigger("click")}),c.css({opacity:0,width:"100%",height:"100%",display:"block",cursor:"pointer",background:"#ffffff"}),s.multiple&&l.attr("multiple","multiple"),s.accept&&0<s.accept.length){for(e=[],t=0,n=s.accept.length;t<n;t++)e.push(s.accept[t].mimeTypes);l.attr("accept",e.join(","))}i.append(l),i.append(c),r=function(e){a.trigger(e.type)},l.on("change",function e(t){var n,i=e;o.files=t.target.files,(n=this.cloneNode(!0)).value=null,this.parentNode.replaceChild(n,this),l.off(),o.input=l=u(n).on("change",i).on("mouseenter mouseleave",r),a.trigger("change")}),c.on("mouseenter mouseleave",r)},getFiles:function(){return this.files},destroy:function(){this.input&&this.input.off(),this.label&&this.label.off()}})}),e("runtime/html5/util",["base"],function(e){var t=C.createObjectURL&&C||C.URL&&URL.revokeObjectURL&&URL||C.webkitURL,n=e.noop,i=n;return t&&(n=function(){return t.createObjectURL.apply(t,arguments)},i=function(){return t.revokeObjectURL.apply(t,arguments)}),{createObjectURL:n,revokeObjectURL:i,dataURL2Blob:function(e){for(var t,n=e.split(","),i=(~n[0].indexOf("base64")?atob:decodeURIComponent)(n[1]),r=new ArrayBuffer(i.length),o=new Uint8Array(r),a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return t=n[0].split(":")[1].split(";")[0],this.arrayBufferToBlob(r,t)},dataURL2ArrayBuffer:function(e){for(var t=e.split(","),n=(~t[0].indexOf("base64")?atob:decodeURIComponent)(t[1]),i=new Uint8Array(n.length),r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i.buffer},arrayBufferToBlob:function(e,t){var n,i=C.BlobBuilder||C.WebKitBlobBuilder;return i?((n=new i).append(e),n.getBlob(t)):new Blob([e],t?{type:t}:{})},canvasToDataUrl:function(e,t,n){return e.toDataURL(t,n/100)},parseMeta:function(e,t){t(!1,{})},updateImageHead:function(e){return e}}}),e("runtime/html5/imagemeta",["runtime/html5/util"],function(e){var d={parsers:{65505:[]},maxMetaDataSize:262144,parse:function(e,t){var n=this,i=new FileReader;i.onload=function(){t(!1,n._parse(this.result)),i=i.onload=i.onerror=null},i.onerror=function(e){t(e.message),i=i.onload=i.onerror=null},e=e.slice(0,n.maxMetaDataSize),i.readAsArrayBuffer(e.getSource())},_parse:function(e,t){if(!(e.byteLength<6)){var n,i,r,o,a=new DataView(e),s=2,c=a.byteLength-4,l=s,u={};if(65496===a.getUint16(0)){for(;s<c&&(65504<=(n=a.getUint16(s))&&n<=65519||65534===n)&&!(s+(i=a.getUint16(s+2)+2)>a.byteLength);){if(r=d.parsers[n],!t&&r)for(o=0;o<r.length;o+=1)r[o].call(d,a,s,i,u);l=s+=i}6<l&&(e.slice?u.imageHead=e.slice(2,l):u.imageHead=new Uint8Array(e).subarray(2,l))}return u}},updateImageHead:function(e,t){var n,i,r=this._parse(e,!0),o=2;return r.imageHead&&(o=2+r.imageHead.byteLength),i=e.slice?e.slice(o):new Uint8Array(e).subarray(o),(n=new Uint8Array(t.byteLength+2+i.byteLength))[0]=255,n[1]=216,n.set(new Uint8Array(t),2),n.set(new Uint8Array(i),t.byteLength+2),n.buffer}};return e.parseMeta=function(){return d.parse.apply(d,arguments)},e.updateImageHead=function(){return d.updateImageHead.apply(d,arguments)},d}),e("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(f,e){var p={ExifMap:function(){return this}};return p.ExifMap.prototype.map={Orientation:274},p.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},p.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,n){return e.getUint16(t,n)},size:2},4:{getValue:function(e,t,n){return e.getUint32(t,n)},size:4},5:{getValue:function(e,t,n){return e.getUint32(t,n)/e.getUint32(t+4,n)},size:8},9:{getValue:function(e,t,n){return e.getInt32(t,n)},size:4},10:{getValue:function(e,t,n){return e.getInt32(t,n)/e.getInt32(t+4,n)},size:8}},p.exifTagTypes[7]=p.exifTagTypes[1],p.getExifValue=function(e,t,n,i,r,o){var a,s,c,l,u,d,h=p.exifTagTypes[i];if(h){if(!((s=4<(a=h.size*r)?t+e.getUint32(n+8,o):n+8)+a>e.byteLength)){if(1===r)return h.getValue(e,s,o);for(c=[],l=0;l<r;l+=1)c[l]=h.getValue(e,s+l*h.size,o);if(h.ascii){for(u="",l=0;l<c.length&&"\0"!==(d=c[l]);l+=1)u+=d;return u}return c}f.log("Invalid Exif data: Invalid data offset.")}else f.log("Invalid Exif data: Invalid tag type.")},p.parseExifTag=function(e,t,n,i,r){var o=e.getUint16(n,i);r.exif[o]=p.getExifValue(e,t,n,e.getUint16(n+2,i),e.getUint32(n+4,i),i)},p.parseExifTags=function(e,t,n,i,r){var o,a,s;if(n+6>e.byteLength)f.log("Invalid Exif data: Invalid directory offset.");else{if(!((a=n+2+12*(o=e.getUint16(n,i)))+4>e.byteLength)){for(s=0;s<o;s+=1)this.parseExifTag(e,t,n+2+12*s,i,r);return e.getUint32(a,i)}f.log("Invalid Exif data: Invalid directory size.")}},p.parseExifData=function(e,t,n,i){var r,o,a=t+10;if(1165519206===e.getUint32(t+4))if(a+8>e.byteLength)f.log("Invalid Exif data: Invalid segment size.");else if(0===e.getUint16(t+8)){switch(e.getUint16(a)){case 18761:r=!0;break;case 19789:r=!1;break;default:return void f.log("Invalid Exif data: Invalid byte alignment marker.")}42===e.getUint16(a+2,r)?(o=e.getUint32(a+4,r),i.exif=new p.ExifMap,o=p.parseExifTags(e,a,a+o,r,i)):f.log("Invalid Exif data: Missing TIFF marker.")}else f.log("Invalid Exif data: Missing byte alignment offset.")},e.parsers[65505].push(p.parseExifData),p}),e("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(i,e,r){var t="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D";return e.register("Image",{modified:!1,init:function(){var n=this,e=new Image;e.onload=function(){n._info={type:n.type,width:this.width,height:this.height},n._metas||"image/jpeg"!==n.type?n.owner.trigger("load"):r.parseMeta(n._blob,function(e,t){n._metas=t,n.owner.trigger("load")})},e.onerror=function(){n.owner.trigger("error")},n._img=e},loadFromBlob:function(e){var t=this,n=t._img;t._blob=e,t.type=e.type,n.src=r.createObjectURL(e.getSource()),t.owner.once("load",function(){r.revokeObjectURL(n.src)})},resize:function(e,t){var n=this._canvas||(this._canvas=document.createElement("canvas")),i=this._resize(this._img,n,e,t);this._blob=null,this.modified=!0,this.owner.trigger("complete","resize",i)},crop:function(e,t,n,i,r){var o=this._canvas||(this._canvas=document.createElement("canvas")),a=this.options,s=this._img,c=s.naturalWidth,l=s.naturalHeight,u=this.getOrientation();r=r||1,o.width=n,o.height=i,a.preserveHeaders||this._rotate2Orientaion(o,u),this._renderImageToCanvas(o,s,-e,-t,c*r,l*r),this._blob=null,this.modified=!0,this.owner.trigger("complete","crop")},getAsBlob:function(e){var t,n=this._blob,i=this.options;if(e=e||this.type,this.modified||this.type!==e){if(t=this._canvas,"image/jpeg"===e){if(n=r.canvasToDataUrl(t,e,i.quality),i.preserveHeaders&&this._metas&&this._metas.imageHead)return n=r.dataURL2ArrayBuffer(n),n=r.updateImageHead(n,this._metas.imageHead),n=r.arrayBufferToBlob(n,e)}else n=r.canvasToDataUrl(t,e);n=r.dataURL2Blob(n)}return n},getAsDataUrl:function(e){var t=this.options;return"image/jpeg"===(e=e||this.type)?r.canvasToDataUrl(this._canvas,e,t.quality):this._canvas.toDataURL(e)},getOrientation:function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},info:function(e){return e?(this._info=e,this):this._info},meta:function(e){return e?(this._meta=e,this):this._meta},destroy:function(){var e=this._canvas;this._img.onload=null,e&&(e.getContext("2d").clearRect(0,0,e.width,e.height),e.width=e.height=0,this._canvas=null),this._img.src=t,this._img=this._blob=null},_resize:function(e,t,n,i){var r,o,a,s,c,l=this.options,u=e.width,d=e.height,h=this.getOrientation();return~[5,6,7,8].indexOf(h)&&(n^=i,n^=i^=n),r=l.scale||Math[l.crop?"max":"min"](n/u,i/d),l.allowMagnify||(r=Math.min(1,r)),o=u*r,a=d*r,l.crop?(t.width=n,t.height=i):(t.width=o,t.height=a),s=(t.width-o)/2,c=(t.height-a)/2,l.preserveHeaders||this._rotate2Orientaion(t,h),this._renderImageToCanvas(t,e,s,c,o,a),!l.preserveHeaders&&-1<[5,6,7,8].indexOf(h)},_rotate2Orientaion:function(e,t){var n=e.width,i=e.height,r=e.getContext("2d");switch(t){case 5:case 6:case 7:case 8:e.width=i,e.height=n}switch(t){case 2:r.translate(n,0),r.scale(-1,1);break;case 3:r.translate(n,i),r.rotate(Math.PI);break;case 4:r.translate(0,i),r.scale(1,-1);break;case 5:r.rotate(.5*Math.PI),r.scale(1,-1);break;case 6:r.rotate(.5*Math.PI),r.translate(0,-i);break;case 7:r.rotate(.5*Math.PI),r.translate(n,-i),r.scale(-1,1);break;case 8:r.rotate(-.5*Math.PI),r.translate(-n,0)}},_renderImageToCanvas:i.os.ios?7<=i.os.ios?function(e,t,n,i,r,o){var a=t.naturalWidth,s=t.naturalHeight,c=O(t,a,s);return e.getContext("2d").drawImage(t,0,0,a*c,s*c,n,i,r,o)}:function(e,t,n,i,r,o){var a,s,c,l,u,d,h,f=t.naturalWidth,p=t.naturalHeight,g=e.getContext("2d"),m=C(t),v="image/jpeg"===this.type,b=1024,y=0,E=0;for(m&&(f/=2,p/=2),g.save(),(a=document.createElement("canvas")).width=a.height=b,s=a.getContext("2d"),c=v?O(t,f,p):1,l=Math.ceil(b*r/f),u=Math.ceil(b*o/p/c);y<p;){for(h=d=0;d<f;)s.clearRect(0,0,b,b),s.drawImage(t,-d,-y),g.drawImage(a,0,0,b,b,n+h,i+E,l,u),d+=b,h+=l;y+=b,E+=u}g.restore(),a=s=null}:function(e){var t=i.slice(arguments,1),n=e.getContext("2d");n.drawImage.apply(n,t)}});function O(e,t,n){var i,r,o=document.createElement("canvas"),a=o.getContext("2d"),s=0,c=n,l=n;for(o.width=1,o.height=n,a.drawImage(e,0,0),i=a.getImageData(0,0,1,n).data;s<l;)0===i[4*(l-1)+3]?c=l:s=l,l=c+s>>1;return 0===(r=l/n)?1:r}function C(e){var t,n,i=e.naturalWidth;return 1048576<i*e.naturalHeight&&((t=document.createElement("canvas")).width=t.height=1,(n=t.getContext("2d")).drawImage(e,1-i,0),0===n.getImageData(0,0,1,1).data[3])}}),e("runtime/html5/transport",["base","runtime/html5/runtime"],function(c,e){var t=c.noop,l=c.$;return e.register("Transport",{init:function(){this._status=0,this._response=null},send:function(){var n,e,t,i=this.owner,r=this.options,o=this._initAjax(),a=i._blob,s=r.server;r.sendAsBinary?(s+=(/\?/.test(s)?"&":"?")+l.param(i._formData),e=a.getSource()):(n=new FormData,r.formDataAsQuery?s+=(/\?/.test(s)?"&":"?")+l.param(i._formData):l.each(i._formData,function(e,t){n.append(e,t)}),n.append(r.fileVal,a.getSource(),r.filename||i._formData.name||"")),r.withCredentials&&"withCredentials"in o?(o.open(r.method,s,!0),o.withCredentials=!0):o.open(r.method,s),this._setRequestHeader(o,r.headers),e?(o.overrideMimeType&&o.overrideMimeType("application/octet-stream"),c.os.android?((t=new FileReader).onload=function(){o.send(this.result),t=t.onload=null},t.readAsArrayBuffer(e)):o.send(e)):o.send(n)},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getStatus:function(){return this._status},abort:function(){var e=this._xhr;e&&(e.upload.onprogress=t,e.onreadystatechange=t,e.abort(),this._xhr=e=null)},destroy:function(){this.abort()},_initAjax:function(){var n=this,e=new XMLHttpRequest;return!this.options.withCredentials||"withCredentials"in e||"undefined"==typeof XDomainRequest||(e=new XDomainRequest),e.upload.onprogress=function(e){var t=0;return e.lengthComputable&&(t=e.loaded/e.total),n.trigger("progress",t)},e.onreadystatechange=function(){if(4===e.readyState)return e.upload.onprogress=t,e.onreadystatechange=t,n._xhr=null,n._status=e.status,200<=e.status&&e.status<300?(n._response=e.responseText,n.trigger("load")):500<=e.status&&e.status<600?(n._response=e.responseText,n.trigger("error","server")):n.trigger("error",n._status?"http":"abort")},n._xhr=e},_setRequestHeader:function(n,e){l.each(e,function(e,t){n.setRequestHeader(e,t)})},_parseJson:function(e){var t;try{t=JSON.parse(e)}catch(e){t={}}return t}})}),e("preset/html5only",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/image","runtime/html5/transport"],function(e){return e}),e("webuploader",["preset/html5only"],function(e){return e}),t("webuploader")},s={},a=function(e,t){var n,i,r;if("string"==typeof e)return u(e);for(n=[],i=e.length,r=0;r<i;r++)n.push(u(e[r]));return t.apply(null,n)},c=function(e,t,n){2===arguments.length&&(n=t,t=null),a(t||[],function(){l(e,n,arguments)})},l=function(e,t,n){var i,r={exports:t};"function"==typeof t&&(n.length||(n=[a,r.exports,r]),void 0!==(i=t.apply(null,n))&&(r.exports=i)),s[e]=r.exports},u=function(e){var t=s[e]||n[e];if(!t)throw new Error("`"+e+"` is undefined");return t},d=function(e){var t,n,i,r,o,a=function(e){return e&&e.charAt(0).toUpperCase()+e.substr(1)};for(t in s)if(n=e,s.hasOwnProperty(t)){for(o=a((i=t.split("/")).pop());r=a(i.shift());)n[r]=n[r]||{},n=n[r];n[o]=s[t]}return e},h=function(e){return n.__dollar=e,d(r(n,c,a))},"object"===g()(e)&&"object"===g()(e.exports)?e.exports=h():"function"==typeof define&&v("PDX0")||(o=n.WebUploader,n.WebUploader=h(),t=n.WebUploader,n.WebUploader.noConflict=function(){n.WebUploader=o}),m.default=t}.call(this,v("2vAP"),v("3UD+")(e))},Jo7J:function(e,t,n){},JyuV:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"34",height:"44",xmlnsXlink:"http://www.w3.org/1999/xlink"},t),c.a.createElement("defs",null,c.a.createElement("path",{d:"M2.32 0h21.74c.4 0 .8.16 1.09.45l8.36 8.36c.29.29.45.68.45 1.1v31a2.32 2.32 0 01-2.32 2.31H2.32A2.32 2.32 0 010 40.9V2.32A2.32 2.32 0 012.32 0z",id:"22472075bc7cd30e21af05b843e9b64f-a"})),c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("mask",{id:"22472075bc7cd30e21af05b843e9b64f-b",fill:"#fff"},c.a.createElement("use",{xlinkHref:"#22472075bc7cd30e21af05b843e9b64f-a"})),c.a.createElement("use",{fill:"#DEE0E3",xlinkHref:"#22472075bc7cd30e21af05b843e9b64f-a"}),c.a.createElement("path",{d:"M24.7-1.54l10.8 10.8h-8.49a2.32 2.32 0 01-2.31-2.31v-8.5z",fill:"#BBBFC4",mask:"url(#22472075bc7cd30e21af05b843e9b64f-b)"}),c.a.createElement("path",{d:"M4.63 13.9h24.7v24.69H4.63z"}),c.a.createElement("path",{d:"M18.21 32.42c.17 0 .31.13.31.3v1.7a.3.3 0 01-.3.31H8.01a.3.3 0 01-.3-.3v-1.7c0-.18.14-.31.3-.31h10.2zm7.72-6.95c.17 0 .31.14.31.3v1.7a.3.3 0 01-.3.31H8.02a.3.3 0 01-.31-.3v-1.7c0-.17.14-.31.3-.31h17.91zm0-6.95c.17 0 .31.14.31.31v1.7a.3.3 0 01-.3.3H8.02a.3.3 0 01-.31-.3v-1.7c0-.17.14-.3.3-.3h17.91z",fill:"#FFF"})))}},JznU:function(e,t,n){"use strict";function i(e,t){return{top:(e.top||0)*t,bottom:(e.bottom||0)*t,left:(e.left||0)*t,right:(e.right||0)*t,height:(e.height||0)*t,width:(e.width||0)*t,x:(e.x||0)*t,y:(e.y||0)*t}}n.d(t,"a",function(){return i})},K6ZQ:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABbQAAADcCAMAAACf49d1AAAApVBMVEXv8PFkanOPlZ7p6uyKj5bU1tjt7u+WmqHMztHc3d/j5OZpb3eboKWkqK20t7uGi5Khpap4fobn6Ol1e4OUmJ7e3+GeoaiDiI+8wMR8gYm4u8COk5nJy87Ex8trcXp/hYymqa+qrrO/wsa7vcLr7O7P0tWusbZ0eYFudHzg4uRxdn/Gyc2YnaPCxcixtLnY2tzl5ujIys2zt7uoq7K1ub3///9+hIsnEMmWAAAVJUlEQVR42uzBgQAAAACAoP2pF6kCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGD24EAAAAAAAMj/tRFUVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVYU9OCQAAAAAEPT/tTcMAAAAAAAAAAAAAAAAAAAA8BM79t+UKBDHcfz7Efkh4hGgIhi/FM0sxbTr+T+0AwQWBEOnmxtvhtcfYbVNsWtv1xV4+zQVxenJ5gXqdDqdziPTbbFXEG2dOp1Op/OohIXYqxAX//9um6MOkfD/L+Tf1s1I5/+n+70aX/9m/Pl7g9En3S6UdTp7NVS618HQqGZ9YmF2vDVVCJr7fP1/9smTqGTlPVGrRUhM33ilCn6XfmGsrajOy0Zz5jyif8Ee+pQycKDZgO4Rel5IF5zxggoTo0/fkCXbD+mvcAyRmoz2HCVCTW1NsOOdqGTSMw5Ud9KWlIsMlTqdRzZReg2UCV0h44USH1CJeRYbFeGcoZdHGwYxy1+Nlpe/E1SzhcwqBYUqZnCbyxG4n0R9OFTygTm1OcGUk07oKQuRnqLMHCOKmZCoboMJJRS8hFQS9BvJ388nb18RUe4TT5TSIDvQskwtTo0+qIIDOLqwhk+FCSyq4+QBvwtE00VsTW3200bri0XsU4NXgKfECiYxE7FsXzwzKuEPLYypTkE6/iAk8wuNksuBOp2HpCu9Rop+V7R/odGvtmhv0Wj7w2gLBlzvwoESKt7K0X6Wbox2pOElIpqiSmcdaY32B7Dxzt4pMUajyffzucYVR4r5SsyElVyWZEEmBdl+tIdGT7dHWxDq0f7sm5axQcHoT48raqOikXlLtH2o+Z/1RAyPsv55bVm02aiPa9E+ugsWbc/lqdN5QILfu8IX7ou2Mkg5q0FBaY/26YmxoOUPTxTjC88Az1SjbRqxDVwj4eQlAYaX0tE6YO92HvxdLCLC8MZok97HhqeFktpAVFJcng+LmqItH8Mi2oMXFNQs2iMpM8NWyoXfz+ezUtiirzASxQww7/SFVxJUBJRw9qkToOxLpJujzcOsR1tBzDW+1Ln4tN5FHN1EcnI7YOfkpBuiHW7g6G8JFaO3Mz5ZICmmIZBSfLK2LNqMD+9atGewimhL0LrT785DWvSuWtwX7REl+PJzfdQS7Sp5c7EHwhXVaFtubIihm9hRKtrgkxrNUDK6J9okjLGR6ewLEyozYE0TW8ynmTeKidjn0f4cQpW5hO7hM4v2slgH1pbW+WRUPNMFXoqNME4uAzIxIHrdGBwx4zyFITE/ifZepx8QAIGY9mjb0AQeFcW453S6oohi5WiHg0L0Apt9FpajLWjY5dGeY0GdzgPSxV7J4fehx4g6XVjNJvVoh04pMqGF/jo1uzvaClSqUAsmoDJJlYMgcDEKgsbjkWgL8/UCpfQtxvFG3sD8KeZUo91e7YBI8hNbTNNrSKkl6oL0Zt2NnkZb7gN9nctu1BNYtA+TxDuCyZlAV+azPdr1M20VfLJuOjHH/KVnpQVU6DMAezy/Hu3DR75sS/qn0bbwiybjmIrtOJPfiZdWd2iFF9HmcQVPFNm2rWJs2w4tYGXRXsHqNtqdh2T3yn7//t0rsenCO5a1aEcWJBYZHznz3mjzgESFljPtBTIs2pVmfw1RtS29MLAz7fuiTULtRFnP3yOIi5SG0yITZfkcpdH2MQxk1ZoQCT7AE4u2j6oD0bX5bI+2zqdOEPmUiRmfKrK9Qn7vvAu2wmjmXon2YK9C+1m0HS8DeBnnlmgvsOEotYdPVTbM8/KOLqNtxIAXo7DFMLnwyRJlzHSrfY622W20O49JEL+Ltii0R3vpwuLzyITvwJpL9FDbaVvHswCbY+pAZdwXwN0c7UH88y7Wx2NDtAdbmLqLU8D4ebT9YdQS7TacnLDAp9c8vi8cNZ5pk6ANB0m0hdGAhBE20sCLP1Al2lqfGSbRbplPRoVDFTtc8UZnkz/sneeWgkgQRuuTIEFXCYoYMIEKxlHPvP+jrcQGwTCz4bhnuT9ER0GnmLm01dXda2a6L7DdhQRJHQENVcr1H4zP5xH481nIpO3YuGH/NWkvUWL5hrR7TnayeHhUwN9ASLZSQdrszzdjlnVieu1220Cn3b4Fd4FLJG05qBvaNZ+J0KiQNkN4JW3JAtpuKhn5G+sp+m5oF7OU0y5xpDwN/ETaLKc9skIMBFbEnojTeI6cwsF0BBTj04+lzfrNXKKqnPYXsKAH0qYhzKzkjwYqVGgyFaV9IIaBE72OJ5O2WqyoF5pFNFjxHSH5qBtcKEW8QBWoyBweIGBODBMx51Da7ri/BhDshkzaqlNm9oa0W1yIDujRnVaFtC0vIw6+aAGj+MrZUx0l4xQ+x0efWxf2PAy3LG0BWr43U6b8o0N8eDl5GXekmppPZPhc2sNqaUO7cfyCNgJsiXWctcCfXBNTgceIK0lbm9+hFPv0I2nrpvxDaa9R4EpEYVrYwXzFmKfSvtoRDtbRdvuutG2E+DSoqlGbBB16KG3RmOqJtLlFQ4XDLPtY2q/jyQrnNgeXiois8mdW2EOcA3NyZWmw6jamAW6sT5RH33Q4gGs4uR8vZrMOrNnMIwGOE+3kEfn4TqVdRfsNafeLOe1+hbRz+MlFJZT2GfcYRLIJZ2ZaG0TMmbRLX0xKjfg9wItE+jFkDyPa+lRT83lcnkv7Ui3tCOELgL3PVztwf6T6bYpV1SNPGAJDgKMdNhIxbDUBSO7M76Xt9wpwFONU57TnKDB4V9qX3W63gU9SqTAyUp3/WNp0iqtH5HlHBZy2QqeeXpS2PWKoOL0RT2ahoQmsB1Rggg7rdbwQybyUnj+o04CJrrOzwN81tLehtD10y9UjEq8CKv+HBDtKklhZekQsQ3+PtDd8xinJyPMY0UC7ocLQMjqp4p1v8zIQJKhyWdp75K6uk7uved0wWnl2VFPzefSfS7tfLe3AvyF+IdiXS9SknQMH6s7LJMOyBI85AINQFsSNoOYUZAUqnIAB3ElbZnYQDwdiODhxDCWVtshF8NhHW/EnOW0bPlXhDxgGZuzBMT+4xlfhmAM9ktOZXnREvo4n64j0poAlZMKOciJ2M2JOe7SIzqmC23FJ9ZRvXoZSFDolwIoYgmrFJX8mxiVpt+HA5tLqETkVoIn9L3Pa3+0IIN5+v5HT1tDeJyeLcwKR8ijtPyZCdj3klbK0RQNemikxcjvrqgoDQ1pMGUYt7ZqPpPlc2s1XOe2CtEXhD3MNdCbitgNoXcnNSWb15H9A7APLWBYktpiYS4PeBDi9vLS9HVxKcQFiPMpp0+9y2kzavW6OyDJbPOCclzbtpUQTTNpR9+IMK52xxulFPMvVI8sN0NXTeOXokBBqj0+b/750VEQK6fUoTXIvCmO8j/F5OG0CpdTS9vIlf0fwaSylf68jkh+JqbSX1SkYcb2OzjhVDa45wHKTD70ixlltYHX3JWlYS7vmI/lbpe2rwPdMOtINrx8AEyYZ1llfhuOBIRvUMS8kRBXV0bMXargWOo+AwN+mTIDbbS+T9joPk7YYwmMSbX8hbQk5TLpxzAZ0WuFmhKAbI+WkrW8zRmhtt1J67SjntF/EsyxtUkwgiOWryzKPuRzjEweDOHUjPh5AoxOjj1n63AC8+HRwjQcz7ZM9Ep2KuG9JeyRFAPF29Ia0JY5SaVuQH5R9U0JZ2q6FXRxdjcuP6mq2cJDVjV9Lu+bjYekRNrgmR/9H0qbBQCEagf+iEG9JOcm04Bg55pQhaVCHeZFcC23tLnYVo2+UZcMBjCu3f9C6HXU6BjadDJOVKTM6v5I2ryTsYRab74s4LlY5+dPzUMTOMuAz9CVGgNPreJbrtL+MWP3p+OtzKzGaBpfppyjtEmdobvaciYb4TNqTtMhyDZ84FNnT35TT5qlEIm0ZToshvCdt8gOciY5qoWpmB6+FA600rpZ2zcdzaTzl8jNpR/Rma2hX7r7jjH8wSZHeB2yhKJIVcGB+MdL/5QXUXqHYBAqR0M8AbjcSpXgOJCrhQY36sAJNW/9O2uy1UlHaAY5V0hZbAHpyvgxv2mzO4iMKL3La5XhWS5u4Q6JYV8NXLmdhwvvG9i1pD+Ec2XPcFE3xobSlhY1VcihVDPfRGM6/Ie1i2CZpPr9pAs0QsVLaJAGSa+NQ+NGUQmmLxzo9UvP5DBtPGf5M2gniwMDoXjIbeErGPJO2tAa67r1I2sCAUoQNlkkDnLlg3PnDT2f5E6ty2jR2YA0Yi0zafJqXOP5S2o6dYBSkrQBuhbSVDtZqXPKn3+e0N+ERt92IDuz4Dvc6nmVpMw5YX69XDd3brRB1ALPZS/brFCC7K2QSVaX8eVAMNN1H0jYBTaf4Z9PI3MQYvZa2LwhzmEIEEG9NzAXBf1fa3jjjD2z8Uj6fq5Y2nbExi4e1IaVTs3atjLojsuYzERpPEd6RtmcvM8noSznSzFW+k8wRRl4smbQFBF8Vrb+mplDe2nOiGdSvyqlZD0avLG3xqqKA+rdJm5WhfRekvYBNZWlvA9h+1BEpjgylKG0ODrvqnNFncziV4/m2tJdgXIhkAAMmwQo8ChHTCyU7D8cNLIVJW1/kpD2eLRTWIv25tFt4QOtdaTN8AxKFyJMbC2ASctfSZjSBQKEcfINSafN1yV/NpyM2n+W0m+I70t6imUlmDgSNg1CelW6IbqW0aaJQhbTFE1HB2jsTjkSV0u7C5u6lvdcAjCbbhEGA7t8jbelxesTGvCBtb3ki6gIdPRkReYHlFqR9xHfcv9rUE2mPjSWFlOP5trT1bcg3VrfbUPVGrrhN5BJOYBWRYvJ9AFcaGSGAEeEKAdZCIm2z79jFCaNEP9Hv+RfSPvO8DYMvYMDm+fPb0hYp5mRj9bIjkqE3AbXwLhM5k7bSy1jV0q75TH47YZS+l1NpD9HOJKPsu98AjK7HJMPsUpb2686xtM0HR6BqaYsdNIvSPk6BzsLORmsKBrr0lrQVSXwq7SF0CR0v4ZyX9gTqqSDtM2ahtC8iJdIWR2gWpL1IB6dblEo7GVdejufb0r6rw9ONUGmnqfQ81h04X0RT5HFJ1qLAud4IwHpVlLYSfXoxgFAlbRbPZzltxo9z2jSzl258ctv0vrSlNdZNgPer5tOuzGkru/V6p1BNzYfwg6lZmbQ3hw7wlUp7hmshB6t/tTbA+pqXjADH/b20PR43+ActbVI22BekrQfaPh6zPZKJ9JmKGT2StuvmpC0BjWfSnkE93pf8sW8DLSpI+xK6uSflVq7R1xjkpd2PTCEAxyw9MsdaIaqM5/vSFpWjhX7XtNok8sCISEDreazHRtQHqd9QACVdSU1puUQNFXB2khjntDMEdKJ4alQlbRbPf0jargVsZv5ATWNSlrau30ub6wKmTl8BnMGb0uY0jEbQ6nWiaz6GHy2CsMMf0mqEGyovf2GaiENikokRx63NIi8ZEyb9VtrjDmDvFxpgbcvSZgsIMGnT0c1a3N25g2+BytIW6ZComkn7AkCnR2jAxiMJ00XCDGa+2zPZM41LE5P7NSIlzFJpswpnDTOW0yY+8VQ5nu9JW5oaDlK61MfmGwItMXwRa+7xczxG8aLGRWlPoqh3MauUNovnPyHtCC/+S5xQSdqc98fOrFgjUtLgRO9xagAj4S1pn7EgWuBMNTUfwvvLjYmLi4YIuz12iXxgoSjCDiqXLY/FOOaXG9ti4/9O2sfVN6ANxLiGAlrbE4mpUEmlmywkRkVcz8YNTeIqpN0CMkksEg/IxpM5vQVA61WX/PldwNJZUaEbO16+lzbJaRY4REZAxFmw3Jy0TxsM6WE8X0tbADZapxFgJskut4PjebDEHY5EyjhjAkzYI+X5eWAr3MoIxJznVkSKCiHeZ8WwsScWz7el3UzOR2+cMsN0nEO+74iU+yrUuUsMXVgA+Ylj6ZBKuzc3AKuXvrsD8OM7aU8WjFYi7b4qEolqn2pqPoW3F/YVccPpdAepfy3EtF4t7Cs72NPPpS1KbQ2ANhTTihALQLCbcET6YjwHG+gn7L+kLjRK0GVvf+1b0fxGvArguzUfTjw9L+2JYR04InkxGU8sXLLJSmV6gITOiZi0Tz2/G//qSlcF+CxcCqLiPRtrKkn7JMi+t06icUE/tIWhEHnCcYR2cgFx/IfxfC1tURGznPZRgzoO3+db/X421/b+3b4F0mDvWjFThLruRuGsHlzD4vla2oogbAMISdv2AfNy9UhvBKQLg27N6QYRG749kImOy8F+oEXdlO6CBzAdipRyumwAeyDmpe1UTBi1woRoggPV1HwMvVals3t0T3O2kAs7zqeapvEHMRkYbJbQYsn00aJfSHsPwGgLhbdcTQFcE0u0cgcMmVFMFzHf0TcCbtvXEBIJTtS5wtwjXnFub+vJaq5zl3LSHqRHJA+wv4gxS8yxLEtbQkiS34+bv+Yxuf5lw2HOz+P5fkdkPxm21Iwt6jUe4L0t7WUARisKtZDsM2do2BOL5ytps8CsE/k+ydeVS/4mWWt+D2DdaR22PjtoiByX4TgtgQpwfxhANy/t/o5hJdI+Bepup651qqn5HPRZRW5Ep5+xmJ6pxHm6iKdxvrPAUFtRCVfTXCqw63pUQl7tws2qPZOYD46tVqs7Th/LlskmfEtauJNz22Sfom9L6bu2b1yV5GUNbOkFwrRLIUqzmU4uMrwWzXQcLJfLiUsZI8tPPBEuuzg/pt8c2NAknm/u344nw9QkqmTGC0R6mjkQxvQ+7nTq0iNEb5sw7sXqTfaxiNGejt+I52S6yh13xPMrn95hrPWL7r2YFKHfLwXPsXPLja46lRAX/IkirqMJFdlP5xQhjxxnJFNNzSchLpqNAs3F/3OtJdOpFwas41ni//nPUPPh6MNmTtnD/+t3Qen/+ovH1PGsqfkPIQrDS7/Z7F+GQt2w+JM9OBAAAAAAAPJ/bQRVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVWEPDgQAAAAAgPxfG0FVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVdqDAxIAAAAAQf9ftyNQAQAAAAAAAAAAAAAAAAAA2Ah4kBuxS9hLOQAAAABJRU5ErkJggg=="},K9kX:function(e,C,k){"use strict";(function(t){k.d(C,"a",function(){return O});var e=k("lwsE"),i=k.n(e),n=k("W8MJ"),r=k.n(n),o=k("a1gu"),a=k.n(o),s=k("Nsbk"),c=k.n(s),l=k("7W2i"),u=k.n(l),d=k("cDf5"),h=k.n(d),f=k("q1tI"),p=k.n(f),g=k("tAHg"),m=k("OX8E"),v=k("4PSP"),b=k("D28M"),y=k("rLED"),E=(k("Jo7J"),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a}),O=function(e){function n(e){var t;return i()(this,n),(t=a()(this,c()(n).call(this,e))).controller=new g.a(m.a),t.state={status:!1},t}return u()(n,e),r()(n,[{key:"componentDidMount",value:function(){this.setLineDomId(),this.controller&&(this.controller.onTogglePlaceholder(this.handleTogglePalceholder),this.controller.onUpdateDomLine(this.handleUpdateDomLine))}},{key:"componentWillUnmount",value:function(){this.controller&&(this.controller.offTogglePlaceholder(this.handleTogglePalceholder),this.controller.offUpdateDomLine(this.handleUpdateDomLine))}},{key:"handleTogglePalceholder",value:function(e,t){this.placeholderDom&&e===this.domId&&this.state.status!==t&&this.setState({status:t})}},{key:"setLineDomId",value:function(){var e;!this.placeholderDom||(e=Object(b.o)(this.placeholderDom,"ace-line"))&&(this.domId=e.id)}},{key:"handleUpdateDomLine",value:function(e,t){this.domId===e.id&&(this.domId=t.id)}},{key:"setRef",value:function(e){this.placeholderDom=e}},{key:"render",value:function(){var e="";return this.state.status&&(e=Object(y.mb)()?t("CreationDoc_Docs_TaskCenter_Placeholder"):t("reminder.line.placeholder")),p.a.createElement("span",{ref:this.setRef,className:"reminder-placeholder"},e)}}]),n}(f.PureComponent);E([Object(v.Bind)()],O.prototype,"handleTogglePalceholder",null),E([Object(v.Bind)()],O.prototype,"setLineDomId",null),E([Object(v.Bind)()],O.prototype,"handleUpdateDomLine",null),E([Object(v.Bind)()],O.prototype,"setRef",null)}).call(this,k("2vAP"))},KCMi:function(e,t,n){"use strict";n.d(t,"c",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return d});var i=n("RIqP"),r=n.n(i),o=n("BmhO"),a=n("3doy"),s=n("VI6H"),c=10485760;function l(e,t){return{controls:!0,autoplay:!0,sources:[{src:e,type:/^mp3/i.test(t)?"audio/".concat(t):/^mov/i.test(t)?"video/mp4":"video/".concat(t)}]}}function u(e,t){return p(e)||t&&f(e)}function d(e,t){return Object(s.f)()&&h(e)&&t<=c}function h(e){return/(^| )docx|doc|xlsx|xls|pptx|ppt|pdf/i.test(e)}function f(e){return[].concat(r()(a.PDFPreviewTypes),r()(o.L)).includes(e.toLowerCase())}function p(e){return o.d.includes(e.toLowerCase())}},KJZc:function(e,t,n){"use strict";var i=n("H6oK");function r(){return{gallery:function(e){var t;try{t=JSON.parse(e)}catch(e){return{pluginCounts:[]}}return{pluginCounts:[["imageCount",t.items.length],["gallery",1]]}}}}function o(){return{"image-uploaded":function(){return{pluginCounts:[["imageCount",1]]}}}}var a=n("SQ87");n.d(t,"a",function(){return c});var s={};function c(e,t){var n,i=e.getPluginStats(s);for(n in i.totalBlockCount=0,i)n.includes("BLOCK")&&(i.totalBlockCount+=i[n]);return i}Object.assign(s,i.getBlockStatsHandler&&Object(i.getBlockStatsHandler)(),r&&r(),o&&o(),a.h&&Object(a.h)())},KQ26:function(e,t,n){},KVeW:function(e,t,n){},Kboj:function(e,K,Z){"use strict";(function(T){Z.d(K,"a",function(){return W});var e=Z("J4zp"),a=Z.n(e),t=Z("lwsE"),n=Z.n(t),i=Z("W8MJ"),r=Z.n(i),o=Z("Z0Cl"),s=Z("lE2N"),k=Z("CpTu"),c=Z("7EGn"),l=Z("hMnB"),_=Z.n(l),R=Z("HmyT"),w=Z("AiBH"),N=Z("mRaX"),u=Z("9g7G"),D=Z("eySY"),I=Z("M8cP"),j=Z("PX10"),d=Z("zhgJ"),M=Z("2ACu"),x=Z("1dfU"),h=Z("n/R6"),f=Z("Wc+A"),p=Z("QM+C"),P=Z("y2sV"),B=Z("rLED"),S=Z("EVj1"),U=Z("Yspk"),g=w.t.UP,m=w.t.DOWN,v=w.t.RIGHT,b=w.t.LEFT,y=w.t.BACKSPACE,E=w.t.RETURN,O=w.t.ESC,C=w.t.TAB,L=w.t.SPACE,z=1e3,H="A",F=Object(d.b)(),V="0",W=function(){function L(e){var C=this;n()(this,L),this.editor=e,this.ignore=!1,this.space=!0,this.UNSAFE_editorNormalizePasteNode=function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b=e.types,y=e.data,E=y.node,O=y.text;F||(n=(t=getSelection())&&(t.extentNode||t.focusNode),i=Object(R.$)(n).closest(".comment-textarea").length,r=C.editor.getRep(),!Object(k.a)(b,function(e){return"text/plain"===e})||0===i&&"0"===r.zoneId&&0===r.selStart[0]||(o=O,(a=Object(D.b)(o,!1))&&(s=a.preText,c=a.restText,l=Object(S.f)(o),(u=o.substring(s.length,l.length-c.length)).startsWith("http")&&(d=C.editor.getAuthor(),h=Object(N.h)(),f=L.HOLDER_PREFIX+h,v=!1,v=0<i?(p=Object(D.a)(u,f,d,C.space,[s,c]),E.innerHTML=p,!0):Object(D.c)({wrapper:E,pureUrl:u,holderCls:f,author:d,useSpace:C.space,filteredTextGroup:[s,c]}),C.space=!0,v&&(C.doReplace(C.editor,u,a,h,"acePaste"),Object(M.default)("client_paste_url",{url_host:Object(I.b)(u),url_parse_type:"first_party"}),g=a.token,m=a.type,Object(M.default)("client_insert_url",{create_source:"link_to_mention",has_text:!!o,insert_token:Object(x.a)(g),insert_type:m}))))))},this.mentionShare=new f.a}return r()(L,[{key:"clearReplaceTimer",value:function(){this.replaceTimer&&clearTimeout(this.replaceTimer)}},{key:"aceKeyEvent",value:function(e,t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k=this,I=t.evt,S=t.editor,T=I.type,_=I.keyCode,w=I.altKey,j=I.ctrlKey,M=I.metaKey;"keydown"===T&&(this.ignore=w||j||M),"keyup"!==T||-1<L.BLACK_LIST.indexOf(_)||S.getInInternationalComposition()||(null===(n=getSelection())||(i=n.extentNode||n.focusNode)&&(r=i.nodeValue,o=i.parentNode,a=i.previousSibling,this.ignore||Object(R.$)(i).closest('[class*="comment-id-"]').length?this.ignore=!1:(this.clearReplaceTimer(),(o.tagName.toUpperCase()===H&&Object(D.b)(r)||-1<o.className.toLowerCase().indexOf("url")&&a&&Object(D.b)(a.textContent+r))&&(s=S.getAuthor(),c=r,l=!1,o.tagName.toUpperCase()!==H&&(c=a.textContent+r,l=!0),u=Array.from(o.classList).find(function(e){return-1<e.indexOf(L.HOLDER_PREFIX)})||"",(d=this.getMentionSelectionRange(S,u))&&(h=d.selStart,f=d.selEnd,g=void 0===(p=d.selZone)?V:p,m=this.getExtendedAttribs(S),v=Object(N.h)(),b=L.HOLDER_PREFIX+v,(y=Object(D.b)(c))&&(this.space=!1,E=y.protocol,O=y.type,C=y.token,l&&(f[1]+=r.length),this.performMentionHolder(S,h,f,g,c,[["author",s],[L.HOLDER_CLASS,!0],[b,!0]].concat(m)),this.replaceTimer=setTimeout(function(){k.doReplace(S,c,{type:O,token:C,protocol:E},v,"aceKeyEvent")},z)))))))}},{key:"acePaste",value:function(e,t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C;F||(n=t.e,i=t.pasteDataWrapper,r=t.editorInfo,o=t.text,a=n.originalEvent.clipboardData||window.clipboardData,c=(s=getSelection())&&(s.extentNode||s.focusNode),l=Object(R.$)(c).closest(".comment-textarea").length,u=r.getRep(),a&&Object(k.a)(a.types,function(e){return"text/plain"===e})&&(0!==l||"0"!==u.zoneId||0!==u.selStart[0])&&(d=o||a.getData("text/plain"),(h=Object(D.b)(d,!1))&&(f=h.preText,p=h.restText,(m=(g=Object(S.f)(d)).substring(f.length,g.length-p.length)).startsWith("http")&&(v=r.getAuthor(),b=Object(N.h)(),y=L.HOLDER_PREFIX+b,0<l?(E=Object(D.a)(m,y,v,this.space,[f,p]),t.pasteDataWrapper.innerHTML=E):Object(D.c)({wrapper:i,pureUrl:m,holderCls:y,author:v,useSpace:this.space,filteredTextGroup:[f,p]}),this.space=!0,this.doReplace(r,m,h,b,"acePaste"),Object(M.default)("client_paste_url",{url_host:Object(I.b)(m),url_parse_type:"first_party"}),O=h.token,C=h.type,Object(M.default)("client_insert_url",{create_source:"link_to_mention",has_text:!!d,insert_token:Object(x.a)(O),insert_type:C})))))}},{key:"linkToMention",value:function(e,t){var n=t.editor,i=t.url,r=t.node,o=Object(N.h)();Object(R.$)(r).addClass("".concat(L.HOLDER_PREFIX+o));var a=Object(D.b)(i);a&&this.doReplace(n,i,a,o,"linkToMention")}},{key:"actionLink2Mention",value:function(e,t){var n=e.getRep(),i=e.getAuthor(),r=n.selStart,o=n.selEnd,a=n.zoneId,s=Object(N.h)(),c=L.HOLDER_PREFIX+s,l=this.getExtendedAttribs(e),u=Object(D.b)(t);u&&(this.space=!1,this.performMentionHolder(e,r,o,a,t,[["author",i],[L.HOLDER_CLASS,!0],[c,!0],["url",!0]].concat(l)),this.doReplace(e,t,u,s,"actionLink2Mention"))}},{key:"performMentionHolder",value:function(e,t,n,i,r,o){var a=this;e.inCallStackIfNecessary("performMentionHolder",function(){e.fastIncorp(),e.performDocumentReplaceRangeWithAttributes(i,t,n,r,a._uniqAttrs(o))})}},{key:"_uniqAttrs",value:function(e){return Object(s.a)(e,function(e){return e[0]})}},{key:"getExtendedAttribs",value:function(e){var t=Object(c.default)(e.getAttributesOnSelection(),"attribs")||[];return t=Object(o.a)(t,function(e){var t=e[0];return-1<["backcolor","bold","italic","underline","strikethrough"].indexOf(t)})}},{key:"doReplace",value:function(b,y,e,E,t){var O=this,C=e.type,k=e.token,I=e.protocol,S=p.NUM_SUITE_TYPE[C.toUpperCase()];p.suiteType.includes(S)&&(Object(M.default)("doc_replace_suite_url",{create_source:"link_to_mention",insert_token:Object(x.a)(k),insert_type:C,replace_source:t}),Object(u.d)({type:C,token:k}).then(function(e){var t=e.data;if(!b.getInInternationalComposition()){b.inCallStackIfNecessary("performMentionHolder",function(){b.fastIncorp()});var n="".concat(L.HOLDER_PREFIX).concat(E),i=O.getMentionSelectionRange(b,n);if(i){var r=i.selStart,o=i.selEnd,a=i.selZone,s=void 0===a?V:a,c=b.getAuthor(),l=t.title,u=w.E.BOX;switch(C){case"doc":u=w.E.FILE,l=l||T("common.unnamed_document");break;case"sheet":u=w.E.SHEET,l=l||T("common.unnamed_sheet");break;case"bitable":u=w.E.BITABLE,l=l||T("common.unnamed_bitable");break;case"mindnote":u=w.E.MINDNOTE,l=l||T("common.unnamed_mindnote");break;case"slide":u=w.E.SLIDE,l=l||T("common.unnamed_slide");break;case"wiki":u=w.E.WIKI,l=l||T("common.unnamed_document")}I||(I=window?_.a.protocol:"https",y="".concat(I,"//").concat(y));var d,h=t.icon_type,f=t.icon_key,p=t.icon_fsunit,g=[["author",c],["at-holder",0],["at-uuid_"+E,0],["mention-type_".concat(u),!0],["mention-link_".concat(encodeURIComponent(y)),!0],["mention-token_".concat(k),!0],["mention-uuid_".concat(E),!0]];h&&f&&g.push(["mention-icon",JSON.stringify({type:h,key:f,fs_unit:p||""})]),g.some(function(e){return"lineguid"===e[0]})||(d=b.getRep(s).attributeManager.findAttributeOnLine(r[0],"lineguid"),g.push(["lineguid",d||Object(U.b)()]));var m=O.getExtendedAttribs(b);r[1]=O.space&&0<r[1]?r[1]-1:r[1],Object(j.d)(b,r,o,l,g.concat(m),!1,s);var v=function(){var e={container:".doc-position",uuid:E,editor:b,token:k,suiteType:S,title:l};Object(B.s)()&&O.mentionShare&&O.mentionShare.showPopover(e),Object(N.L)(w.u.SHOW_EMBED_QUICK_SHARE_TIP,{token:Object(x.a)(k),suiteType:S,title:l});var t=[r[0],r[1]+l.length],n=[["author",c]].concat(m);Object(j.f)(b,t,t,n,s)};b.version.includes(P.y)?b.once("paint",v):v()}}}).catch(function(e){Object(M.default)("dev_parse_link_failed",{code:e.code||-99,msg:e.message}),h.a.error({content:T("mention.parse_link_failed")})}))}},{key:"getMentionSelectionRange",value:function(e,t){if(t){var n=null,i=function(e){return-1<e.indexOf(t)},r=e.getMatchedAttributePositionOnSelection(n,i),o=a()(r,1)[0];if(o)return o.docPosition}return null}},{key:"reset",value:function(){this.ignore=!1,this.mentionShare&&this.mentionShare.destroy(),this.mentionShare=null,this.clearReplaceTimer()}}]),L}();W.BLACK_LIST=[g,m,v,b,y,E,O,C,L],W.HOLDER_PREFIX="link-mention-uuid_",W.HOLDER_CLASS="link-mention-holder",K.b=new W}).call(this,Z("2vAP"))},KfM7:function(e,t,n){"use strict";var i=n("Lqjy");t.a=i.a},KgLa:function(e,t,n){"use strict";var i=n("lwsE"),o=n.n(i),r=n("W8MJ"),a=n.n(r),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n.n(f),g=n("iP/4"),m=n("eOIy"),v=function(e){function t(){var r;return o()(this,t),(r=c()(this,u()(t).apply(this,arguments))).handleScroll=function(e){var t=r.props,n=t.onScrollX,i=t.onScrollY;n&&n(e),i&&i(e)},r}return h()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.style,i=e.onWheel,r=e.children,o=e.className,a=e.containerRef,s=e.onContextMenu,c=e.onDoubleClick;return g.a.isMac||g.a.isIOS||g.a.isIE?p.a.createElement("div",{id:t,className:o,style:n,ref:a,onScroll:this.handleScroll,onContextMenu:s,onDoubleClick:c,onWheel:i},r):p.a.createElement(m.b,Object.assign({},this.props),r)}}]),t}(f.Component);t.a=v},KhPb:function(e,t,n){"use strict";n.d(t,"a",function(){return Rect});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),c=n("UXvI"),Rect=function(){function Rect(e){var s=this;r()(this,Rect),this.className="Rect",this.aceInitialized=function(e,t){s.editorInfo=t.editorInfo,s.onWindowResize=Object(c.default)(function(){s.clearRects()},60),window.addEventListener("resize",s.onWindowResize)},this.clearRects=function(){var e=s.editorInfo&&s.editorInfo.getReps();if(e)for(var t in e){var n=e[t].lines;if(n.length())for(var i=n.atIndex(0);i;)i.deleteRect(),i=n.next(i)}},this.editorSizeChange=function(){s.clearRects()},this.changesetApply=function(e,t){var n,i=t.changeset,r=!1,o=s.editorInfo.changesetHelper,a=o.unpack(i);for(n in a)if(o.opIterator(a[n].ops).hasNext()){r=!0;break}r&&s.clearRects()},this.reset=function(){window.removeEventListener("resize",s.onWindowResize),s.editorInfo=null,s.onWindowResize.cancel(),s.onWindowResize=null},e&&(this.editorInfo=e,this.aceInitialized("",{editorInfo:e}))}return a()(Rect,[{key:"handleImageResize",value:function(e,t){t.lineKey;this.clearRects()}},{key:"handleSheet",value:function(e){this.clearRects()}}]),Rect}();t.b=Rect},KhU0:function(e,t,n){"use strict";n.d(t,"a",function(){return k}),n.d(t,"b",function(){return I});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("iWIM"),h=n.n(d),f=n("7W2i"),p=n.n(f),g=n("cDf5"),m=n.n(g),v=n("Hj9z"),b=n("Y++A"),y=n("/spq"),E=n("KvM/"),O=n("H6oK"),C=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},k=function(e){function t(e){var a;return r()(this,t),(a=c()(this,u()(t).call(this,e))).className="MindnoteBridge",a.blockType="MINDNOTE_BLOCK",a.block=v.DocMindnoteBlock,a.getOrders=function(){return a.editor.getMatchedAttributePositionOnSelection(null,function(e,t){return e===O.BLOCK_DATA_META_BLOCK_PROPS&&JSON.parse(t).blockType===a.blockType}).reduce(function(e,t){var n,i,r=t.attrKey,o=t.attrValue;return r===O.BLOCK_DATA_META_BLOCK_PROPS&&(!(n=JSON.parse(o)).token||(i=a.processToken(n.token)).id&&e.push(i.id)),e},[])},a}return p()(t,e),a()(t,[{key:"processToken",value:function(e){var t=this.block.processToken(e);return{id:t.mindnoteId,token:t.token}}},{key:"loadBridgeManager",value:function(){var e=new b.a;return e.loadMindnoteManager(),e}},{key:"getInitMindnoteData",value:function(){return{title:"",content:{nodes:[{id:"1",text:""},{id:"2",text:""},{id:"3",text:""}],theme:"classic",structure:"right",globalLineStyle:"polyline"}}}},{key:"destroy",value:function(){h()(u()(t.prototype),"destroy",this).call(this)}}]),t}(E.a);function I(e){return{getMindnoteBridge:function(){return e.getBridge()},getInitMindnoteData:function(){return e.getInitMindnoteData()}}}k=C([Object(y.a)(["destroy"])],k)},KhV1:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">\n    <path  stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.998 12.006l4.99-5.015 5.05 5.015"/>\n</svg>\n'},KiC9:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a});var o=n("xYHj"),s=n("D28M"),c=n("RooE");function i(e){if(1<arguments.length&&void 0!==arguments[1]&&arguments[1]){var t=Object(s.o)(e,c.a);if(t)return{start:t,end:t,list:[t]}}if(!e.classList.contains("list-code"))return null;for(var n=[e],i=e;;){var r=i.previousSibling;if(!(r instanceof HTMLElement&&r.className.includes("list-code")))break;n.unshift(r),i=r}for(var o=e;;){var a=o.nextElementSibling;if(!(a instanceof HTMLElement&&a.className.includes("list-code")))break;n.push(a),o=a}return{start:i,end:o,list:n}}function r(e,t,n){if("code1"!==e.getAttributeOnLine(t,n,"list"))return null;for(var i=n,r=n;"code1"===e.getAttributeOnLine(t,i-1,"list");)--i;for(;"code1"===e.getAttributeOnLine(t,r+1,"list");)r+=1;return{start:i,end:r}}function a(e,t){for(var n=[],i=t;0<=i&&Object(o.g)(e,i);i--)n.unshift(i);for(var r=t+1;r<e.lines.length()&&Object(o.g)(e,r);r++)n.push(r);return n}},KiYW:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"f",function(){return d}),n.d(t,"a",function(){return h}),n.d(t,"g",function(){return f});var i=n("QM+C"),r=n("VIFs"),o=n("sLU5"),a=n("OX8E"),s=function(e,t){return a.a.emit(o.a.PC.SUITE.TRIGGER_UPDATE_CUSTOM_ICON_META,e,t)},c=function(e,t,n){return a.a.emit(o.a.PC.SUITE.UPDATE_CUSTOM_ICON_START,e,t,n)},l=function(e,t){return a.a.emit(o.a.PC.SUITE.UPDATE_CUSTOM_ICON_SUCCESS,e,t)};function u(e){var t=e.key,n=e.direct_link;if(n)return n;if(!t)return"";var i=Object(r.getDomainConfig)("domain").lark_file;return"https://".concat(i,"/api/avatar/v1/").concat(t,"/noop.image")}var d=function(e){if(!e)return"";var t=e.get("icon_key"),n=e.get("icon");return t||n?u({key:t,direct_link:n}):""},h=[i.NUM_SUITE_TYPE.FILE,i.NUM_SUITE_TYPE.BITABLE];function f(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}},"Kn+I":function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var i=n("peh1"),r=n("A2D6"),o=function(e){return e.appState.userSettings},a=Object(i.createSelector)(o,function(e){return{src_lang:Object(r.b)("lang")||"zh",permission_type:e.get("permission_type"),allow_share_outside:e.get("allow_share_outside"),lang_correction_perm:e.get("lang_correction_perm"),enable_auto_capitalize:e.get("enable_auto_capitalize"),smart_compose_setting:e.get("smart_compose_setting"),smart_compose_personalization_setting:e.get("smart_compose_personalization_setting")}}),s=Object(i.createSelector)(o,function(e){return{target_lang:e.get("target_lang"),enable_auto_translate:e.get("enable_auto_translate"),shield_auto_translate_langs:e.get("shield_auto_translate_langs").toJS(),global_display_type:e.get("global_display_type"),languages_display_type:e.get("languages_display_type").toJS(),enable_auto_translate_doc_body:e.get("enable_auto_translate_doc_body"),enable_auto_translate_doc_comment:e.get("enable_auto_translate_doc_comment"),is_user_translate_vip:e.get("is_user_translate_vip")}})},"KvM/":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("lwsE"),a=n.n(i),r=n("W8MJ"),s=n.n(r),c=n("H6oK"),o=function(){function o(e){var r=this;a()(this,o),this.hasSetup=!1,this.enterTranslate=!1,this.widthSettings=new Map,this.maxWidth=null,this.docWidth=null,this.bridge=null,this.handleBeforeInitBlocksOnly=function(e){if(e.blockType===r.blockType)return r.hasSetup?void 0:r.setupBlockBridgeOnInit(e.blockInfos)},this.handleBeforeUpdateBlock=function(e){var t,n,i;e.blockType===r.blockType&&e.blockToken&&(n=(t=r.processToken(e.blockToken)).token,i=t.id,r.hasSetup||r.setupBridge(n,[i]))};var t=e.editor,n=e.isTemplate,i=e.isInHistory;this.editor=t,this.isTemplate=!!n,this.isInHistory=!!i}return s()(o,[{key:"processToken",value:function(e){var t=this.block.processToken(e);return{id:t.bitableId,token:t.token}}},{key:"setupBridge",value:function(e,t){var r=this;this.bridge||(this.bridge=this.loadBridgeManager(e)),null!==this.maxWidth&&this.bridge.setMaxWidth(this.maxWidth),null!==this.docWidth&&this.bridge.setDocWidth(this.docWidth),this.enterTranslate&&this.bridge.enterTranslateMode(),this.widthSettings.forEach(function(e,t){var n=e.fullWidth,i=e.leftMargin;r.bridge.setWidth(n,i,t)}),this.widthSettings.clear(),this.hasSetup=!0}},{key:"handleBinding",value:function(e){var t=this.blockEventEmitter;t[e](c.PluginEventType.BEFORE_INIT_BLOCKS_ONLY,this.handleBeforeInitBlocksOnly),this.editor.pure||(t[e](c.PluginEventType.BEFORE_CREATE_BLOCK,this.handleBeforeUpdateBlock),t[e](c.PluginEventType.BEFORE_UPDATE_BLOCK_DATA,this.handleBeforeUpdateBlock))}},{key:"setupBlockBridgeOnInit",value:function(){var o,a=this,s=[];(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){var t,n,i,r=e.blockToken;r&&(n=(t=a.processToken(r)).id,i=t.token,n&&(s.push(n),o=i))}),o&&0<s.length&&this.setupBridge(o,s)}},{key:"setWidth",value:function(e,t,n){this.bridge?this.bridge.setWidth(e,t,n):this.widthSettings.set(n,{fullWidth:e,leftMargin:t})}},{key:"setDocWidth",value:function(e){if(this.bridge)return this.bridge.setDocWidth(e);this.docWidth=e}},{key:"setMaxWidth",value:function(e){this.bridge?this.bridge.setMaxWidth(e):this.maxWidth=e}},{key:"setBlockEventEmitter",value:function(e){this.blockEventEmitter&&this.handleBinding("off"),this.blockEventEmitter=e,this.handleBinding("on")}},{key:"getUpdateTime",value:function(){return this.bridge?this.bridge.updateTime:0}},{key:"enterTranslateMode",value:function(){this.bridge?this.bridge.enterTranslateMode():this.enterTranslate=!0}},{key:"exitTranslateMode",value:function(){this.enterTranslate=!1,this.bridge&&this.bridge.exitTranslateMode()}},{key:"getBridge",value:function(){return this.bridge}},{key:"destroy",value:function(){this.handleBinding("off"),this.bridge&&this.bridge.destroy()}}]),o}()},Kwn6:function(e,t,n){"use strict";var i=n("m/+l"),r=n("ANjH"),o=n("NltJ"),a=n("k5zB"),s={setMessagePositionData:n("1tpT").b},c=function(e){return{commentNumbers:Object(o.e)(e),commentPosition:Object(o.f)(e)}},l=Object(r.compose)(Object(i.connect)(c,s))(a.a);t.a=l},L1JX:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return l});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("4D8z"),c=function(){function t(){r()(this,t)}return a()(t,[{key:"IS_FS_MODE",get:function(){return t.isFSMode}},{key:"TABLE_FULL_WIDTH_RIGHT",get:function(){return t.isFSMode?0:s.y}},{key:"TABLE_RIGHT_SHADOW_OFFSET",get:function(){return t.isFSMode?0:s.C}},{key:"TABLE_FULL_WIDTH_WITH_COMMENT_RIGHT",get:function(){return t.isFSMode?20:s.z}}],[{key:"setIsFSMode",value:function(e){t.isFSMode=e}}]),t}();c.isFSMode=!1;var l=new c},L9nM:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MiIgaGVpZ2h0PSI3MiIgdmlld0JveD0iMCAwIDcyIDcyIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZmlsbD0iI0RFRTBFMyIgZD0iTTU3LjQwNyA4LjExNEw2LjUzOSAxNy4wODNsOC4yNjMgNDYuODYgNTAuODY3LTguOTd6Ii8+CiAgICAgICAgPHBhdGggZmlsbD0iI0Y1RjZGNyIgZD0iTTIxLjkxMyAxOS43MjJINjEuNjd2MzguMTkxSDIxLjkxM3oiLz4KICAgICAgICA8cGF0aCBmaWxsPSIjQzNDNkNCIiBmaWxsLXJ1bGU9Im5vbnplcm8iIGQ9Ik0yOC4xNzQgMjguMDMzaDI3LjIzNXYtMS4xMjVIMjguMTc0ek0yOC4xNzQgMzMuMDQyaDI3LjIzNXYtMS4xMjVIMjguMTc0ek0yOC4xNzQgMzguMTQyaDI3LjIzNXYtMS4xMjVIMjguMTc0ek0yOC4xNzQgNDMuMTUxaDE3LjM3NHYtMS4xMjVIMjguMTc0eiIvPgogICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ2IDQ2KSI+CiAgICAgICAgICAgIDxwYXRoIGZpbGw9IiNGRkM2MEEiIGQ9Ik0wIDlhOSA5IDAgMCAwIDkgOSA5IDkgMCAwIDAgOS05IDkgOSAwIDAgMC05LTkgOSA5IDAgMCAwLTkgOXoiLz4KICAgICAgICAgICAgPHJlY3Qgd2lkdGg9IjEuNjg4IiBoZWlnaHQ9IjEuNjg4IiB4PSI4LjE1NiIgeT0iMTEuODEzIiBmaWxsPSIjRkZGIiByeD0iLjUiLz4KICAgICAgICAgICAgPHJlY3Qgd2lkdGg9IjEuNjg4IiBoZWlnaHQ9IjUuNjI1IiB4PSI4LjE1NiIgeT0iNC41IiBmaWxsPSIjRkZGIiByeD0iLjUiLz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPgo="},LEGm:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE4IDVDMTguNTUyMyA1IDE5IDUuNDQ3NzIgMTkgNlYxOEMxOSAxOC41NTIzIDE4LjU1MjMgMTkgMTggMTlINkM1LjQ0NzcyIDE5IDUgMTguNTUyMyA1IDE4VjZDNSA1LjQ0NzcyIDUuNDQ3NzIgNSA2IDVIMThaTTguNSA2LjVINi41VjlIOC41VjYuNVpNMTAgNi41VjlIMTcuNVY2LjVIMTBaTTguNSAxMC41SDYuNVYxMy41SDguNVYxMC41Wk0xMCAxMy41SDE3LjVWMTAuNUgxMFYxMy41Wk04LjUgMTVINi41VjE3LjVIOC41VjE1Wk0xMCAxNy41SDE3LjVWMTVIMTBWMTcuNVoiIGZpbGw9IiMyQjJGMzYiLz4KPC9zdmc+Cg=="},LFUy:function(e,t,n){"use strict";var i=n("7Kxq"),r=function(e){var t=$(e);return t.hasClass(i.d)||t.children().hasClass(i.d)};t.a=r},LMGK:function(e,t,n){},LR58:function(e,t,n){},"LT0/":function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=(n("Lk3x"),n("q1tI")),c=n.n(s),l=n("y2sV"),u="translate-line-container",d=function(){function t(e){r()(this,t),this.className="translate",this.editor=e}return a()(t,[{key:"match",value:function(e){return"translate"===e}},{key:"aceAttribsToClasses",value:function(e,t){return"translate"===t.key&&"true"===t.value?["translate_paragraph"]:"translate-guid"===t.key?["".concat(t.key,":").concat(t.value)]:void 0}},{key:"aceDomLineProcessLineAttributes",value:function(e,t){var n=t.spanClass,i=/translate_paragraph/.exec(n),r=/(?:^| )translate-guid:([^ ]*)/.exec(n);(i||r)&&(i&&(t.lineClass+=" translate_paragraph"),r&&(t.lineClass+=" translate-".concat(r[1])),t.processedMarker=!0)}},{key:"renderLine",value:function(e){var t=e.children,n=e.lineState,i=e.index,r=n.getLineAttributes().toMap(),o=new RegExp("single-line|aceTable|list-code"),a=n.getOps().find(function(e){var t=e.attributes;return o.test(Object.keys(t||{}).join(" "))});return r["translate-guid"]&&!a&&(e.lineClass+=" translate-".concat(r["translate-guid"])),"true"===r.translate?(e.lineClass+=" translate_paragraph",1===i&&this.editor&&this.editor.getRep().lines.atIndex(i).registerInstance({displayType:"Inline",instanceName:"translate",shouldRetain:!0}),c.a.createElement(l.z,{className:u},t,c.a.createElement(l.w,{className:"translate-paragraph-close-tag"}))):null}},{key:"editorWillCopy",value:function(e){var t=e.deltaSet;t.forEach(function(e){e instanceof l.E&&e.forEach(function(e){e.attributes&&e.attributes.lmkr&&(e.attributes.translate&&delete e.attributes.translate,e.attributes["translate-guid"]&&delete e.attributes["translate-guid"])})}),e.deltaSet=t}},{key:"blockBridgeEnterTranslate",value:function(){this.editor&&(this.editor.plugins.sheetBridge.enterTranslateMode(),this.editor.plugins.bitableBridge.enterTranslateMode())}},{key:"onMount",value:function(){this.blockBridgeEnterTranslate()}},{key:"destroy",value:function(){this.editor=null}}]),t}()},LaDK:function(e,t,n){"use strict";var i,r,o,a;n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o}),(r=i=i||{})[r.COMMON=1]="COMMON",r[r.SYNCING=2]="SYNCING",r[r.SERVER_SYNCING=3]="SERVER_SYNCING",r[r.FAIL_RETRY=5]="FAIL_RETRY",r[r.FAIL_AUTH=6]="FAIL_AUTH",r[r.FAIL_PERMISSION=7]="FAIL_PERMISSION",r[r.FAIL_NO_JIRA=8]="FAIL_NO_JIRA",r[r.FAIL_CAN_NOT_USE=9]="FAIL_CAN_NOT_USE",r[r.FAIL_NO_BASE_URL=10]="FAIL_NO_BASE_URL",r[r.SOME_ISSUES_SYNC_FAIL=11]="SOME_ISSUES_SYNC_FAIL",(a=o=o||{})[a.HAS_NOT_FETCH=-2]="HAS_NOT_FETCH",a[a.FETCH_FAIL=-1]="FETCH_FAIL",a[a.NO_JIRA=0]="NO_JIRA",a[a.OPEN_JIRA=1]="OPEN_JIRA",a[a.WITHIN_JIRA=2]="WITHIN_JIRA",a[a.HAS_CONNECTED=3]="HAS_CONNECTED"},Lk3x:function(e,t,n){},Lqjy:function(e,v,b){"use strict";(function(a){var e=b("lwsE"),n=b.n(e),t=b("W8MJ"),i=b.n(t),r=b("a1gu"),s=b.n(r),o=b("Nsbk"),c=b.n(o),l=b("7W2i"),u=b.n(l),d=b("MXQz"),h=b("q1tI"),f=b.n(h),p=(b("17x9"),b("n/R6")),g=(b("S/VI"),Object(d.a)(function(){return!!document.queryCommandSupported&&["copy","cut"].every(function(e){return document.queryCommandSupported(e)})})),m=function(e){function t(e){var o;return n()(this,t),(o=s()(this,c()(t).call(this,e))).handleClickCopy=function(){var t,e=o.props.editor,n=e.getRep("0"),i=n.lines.length(),r=n.lines.atIndex(i-1).text.length;if(e.selection.setWithSelection("0",[0,0],[i-1,r],!1),e.updateBrowserSelectionFromRep(!0),e.copyable)try{t=document.execCommand("copy")}catch(e){t=!1,console.log(e)}else t=!1,e.call("COPY_WITHOUT_PERMISSION");e.selection.setWithSelection("0",[0,0],[0,0],!1),e.updateBrowserSelectionFromRep(!0),t&&p.a.show({type:"success",content:a("feadback.copied_to_clipborad")})},o}return u()(t,e),i()(t,[{key:"render",value:function(){return g()?f.a.createElement("div",{className:"copy-tips"},f.a.createElement("span",{onClick:this.handleClickCopy,className:"copy-tips__common"},a("feadback.one_click_clipborad"))):null}}]),t}(h.Component);v.a=m}).call(this,b("2vAP"))},LrxS:function(e,t,n){},"M/LR":function(e,t,n){"use strict";var i=n("lSNA"),p=n.n(i),r=n("o0o1"),l=n.n(r),o=n("yXPU"),a=n.n(o),s=n("J4zp"),m=n.n(s),c=n("lwsE"),u=n.n(c),d=n("W8MJ"),h=n.n(d),f=n("a1gu"),v=n.n(f),g=n("PJYZ"),b=n.n(g),y=n("Nsbk"),E=n.n(y),O=n("iWIM"),C=n.n(O),k=n("7W2i"),I=n.n(k),S=n("cDf5"),T=n.n(S),_=n("YsUP"),w=n("3Hq1"),j=n("q1tI"),M=n.n(j),L=n("HmyT"),R=n("y2sV"),N=n("FJEn"),D=n("aBgF"),x=n("kESg"),P=n("+4eN"),B=n("7Kxq"),U=n("PmjA"),z=n("zTCG"),H=n("nuq8"),F=n("Poi8"),V=n("YNKm"),W=n("RIqP"),K=n.n(W),Z=n("n+Ky"),q=n("4PSP"),Y=n("Z5sO"),J=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":T()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Q=function(){function t(e){u()(this,t),this.editor=e,this.stateCache={},this.rerenderQueue=new Map,this.idleCallbackId=null,this.loadLanguagesPromise=null,this.editor&&this.editor.on("viewportChange",this.viewportChange)}function e(){return n.apply(this,arguments)}var n,i;function r(e,t){return i.apply(this,arguments)}return h()(t,[{key:"destroy",value:function(){this.idleCallbackId&&Object(Y.a)(this.idleCallbackId),this.stateCache={},this.editor=null}},{key:"loadLanguages",value:function(){return this.loadLanguagesPromise||(this.loadLanguagesPromise=Object(Z.b)()),this.loadLanguagesPromise}},{key:"isSupportLanguage",value:function(e){return!!Z.a.getLanguage(e)}},{key:"initStateCache",value:(i=a()(l.a.mark(function e(t,n){var i,r,o,a,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadLanguages();case 2:if(this.editor){e.next=4;break}return e.abrupt("return");case 4:for(i=this.editor.getContentState().getZoneState(t),r=0,o=i.length();r<o;r++)a=i.getLine(r),s=a?a.getText():"",this.processHighlight(t,r,n,s);case 6:case"end":return e.stop()}},e,this)})),r)},{key:"highlight",value:function(e,t,n,i){var r=this.stateCache[e]&&this.stateCache[e][t];return r&&r.language===n&&r.code===i||(this.processHighlight(e,t,n,i),this.updateStateCacheThrottle(e,t,n,!1)),this.stateCache[e][t].value}},{key:"forceRerenderAll",value:function(e,t){this.rerenderQueue.has(e)&&(this.rerenderQueue.delete(e),this.addRerenderScope(e,[0])),this.updateStateCache(e,0,t)}},{key:"clearStateCache",value:function(e){var t=this;e.forEach(function(e){delete t.stateCache[e]})}},{key:"updateStateCacheThrottle",value:function(e,t,n){var i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];this.updateStateCache(e,t,n,i)}},{key:"viewportChange",value:function(){var n=this;this.rerenderQueue.forEach(function(e,t){n.rerenderViewportLine(t)})}},{key:"processHighlight",value:function(t,n,i,r){try{this.stateCache[t]||(this.stateCache[t]=[]);var e=this.stateCache[t][n-1],o=e&&i===e.language?e.top:void 0,a=this.isSupportLanguage(i)?Z.a.highlight(i,r,!0,o):{language:i,top:void 0,value:r},s=a.language,c=a.top,l=a.value;return this.stateCache[t][n]={language:s,top:c,value:l,code:r},l}catch(e){return this.stateCache[t][n]={language:i,top:void 0,value:r,code:r},r}}},{key:"updateStateCache",value:function(e,t,n){var i=this,r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];if(this.editor){var o=this.editor.getContentState().getZoneState(e);if(o){for(var a=o.length(),s=r?t:t+1,c=a-1,l=s;l<a;l++){var u=o.getLine(l),d=this.stateCache[e]&&this.stateCache[e][l];if(!u){c=l-1;break}var h=this.processHighlight(e,l,n,u.getText());if(d&&n===d.language&&h===d.value){c=l-1;break}}s<=c&&(this.idleCallbackId&&Object(Y.a)(this.idleCallbackId),this.addRerenderScope(e,[s,c]),window.requestAnimationFrame(function(){i.rerenderViewportLine(e),i.startRerenderLoop()}))}}}},{key:"addRerenderScope",value:function(e,t){if(this.editor){var n=K()(this.rerenderQueue.get(e)||[]),i=this.editor.getRep(e).lines.length()-1,r=m()(t,2),o=r[0],a=r[1],s=void 0===a?i:a;if(!(s<o)){for(var c=0;c<n.length;c++){var l=n[c];(l[0]<=o&&o<=l[1]||o<=l[0]&&l[0]<=s)&&(o=Math.min(o,l[0]),s=Math.min(Math.max(s,l[1]),i),n.splice(c,1),c--)}n.push([o,s]),this.rerenderQueue.set(e,n)}}}},{key:"intersectRerenderScope",value:function(e,t){var n=[],i=this.rerenderQueue.get(e);if(!(i&&0<i.length))return n;for(var r=[],o=m()(t,2),a=o[0],s=o[1],c=0;c<i.length;c++){var l,u,d,h=i[c];h[0]<=a&&a<=h[1]||a<=h[0]&&h[0]<=s?(u=(l=[Math.max(a,h[0]),Math.min(s,h[1])])[0],d=l[1],h[0]<=u-1&&r.push([h[0],u-1]),d+1<=h[1]&&r.push([d+1,h[1]]),n.push([u,d])):r.push(h)}return 0<r.length?this.rerenderQueue.set(e,r):this.rerenderQueue.delete(e),n}},{key:"rerenderViewportLine",value:function(t){var e,n,i,r,o,a,s,c,l,u,d,h=this,f=this.editor&&this.editor.plugins.viewportObserver;this.editor&&f&&((e=Object(F.e)(this.editor,t))&&(n=e.selStart[0],i=f.getVisibleLineZone(),o=(r=m()(i,2))[0],a=r[1],o&&a&&(s=o.lineNumInMainZone,c=a.lineNumInMainZone,s<=n&&n<=c&&(l=this.editor.getRep(t),u=o.selZone===t?o.lineNum:0,d=a.selZone===t?a.lineNum:l.lines.length()-1,this.intersectRerenderScope(t,[u,d]).forEach(function(e){return h.rerenderScope(t,e)})))))}},{key:"rerenderScope",value:function(e,t){var n,i,r,o,a,s,c,l;this.editor&&(n=this.editor,i=n.getRep(e),o=(r=m()(t,2))[0],a=r[1],s=i.lines.atIndex(a),c=[o,0],l=[a,s?s.text.length:0],n.inCallStackIfNecessary("rerender-codeblock",function(){n.getCurrentCallStack().preventScrolling=!0,n.makeNewEvent("nonundoable",function(){i.attributeManager.setAttributesOnRange(c,l,[["rerender","".concat(Date.now())]],N.config.LOCAL)})}))}},{key:"startRerenderLoop",value:(n=a()(l.a.mark(function e(){var s,t,c=this,n=arguments;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=0<n.length&&void 0!==n[0]?n[0]:window.sliceNum||10,t=function e(){var t,n,i,r,o,a;0<c.rerenderQueue.size&&(n=(t=m()(c.rerenderQueue.entries().next().value,2))[0],0!==(i=t[1]).length?(o=(r=i[0])[0],a=Math.min(o+s,r[1]),c.rerenderScope(n,[o,a]),a+1<r[1]?i[0]=[a+1,r[1]]:i.shift(),c.idleCallbackId=Object(Y.b)(e)):c.rerenderQueue.delete(n))},this.idleCallbackId=Object(Y.b)(t);case 3:case"end":return e.stop()}},e,this)})),e)}]),t}();J([Object(q.Throttle)(500,{leading:!0,trailing:!0})],Q.prototype,"updateStateCacheThrottle",null),J([Object(q.Bind)()],Q.prototype,"viewportChange",null);var X=n("TOQq"),$=n("hbEN"),ee=n("Zda9"),te=function(){function i(e,t){var n=this;u()(this,i),this.data={},this.updateState=function(e,t){return n.data[e]=t},this.triggerState=Object($.default)(function(e,t){n.updateState(e,t),ee.c.emit(ee.b,n.moduleName)},300),this.moduleName=e,this.replayFollow=t,this.init()}return h()(i,[{key:"init",value:function(){var e=this;Object(ee.h)({moduleName:this.moduleName,getCurrentModuleState:function(){return{data:e.data}}}),ee.c.on("".concat(ee.a,":").concat(this.moduleName),this.replayFollow)}},{key:"destroy",value:function(){Object(ee.l)(this.moduleName),ee.c.off("".concat(ee.a,":").concat(this.moduleName),this.replayFollow)}}]),i}(),ne=n("l9PA"),ie=n("EEMT"),re=n("F9bh"),oe=n("CnBM"),ae=n.n(oe),se=n("Ss5W"),ce=n("Uy54"),le=n("uirG"),ue=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":T()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},de=["editorWillCopy","editorWillSetClipboard","serialize","UNSAFE_editorNormalizePasteNode","UNSAFE_editorBeforePaste_priority","deserialize","editorWillPaste"],he=function(e){function n(e){var t;return u()(this,n),(t=v()(this,E()(n).call(this,e))).editor=e,t}return I()(n,e),h()(n,[{key:"matchOp",value:function(e){return Object(ce.c)(e)}},{key:"matchZoneDeltaOp",value:function(e){return this.matchOp(e)}},{key:"isBlockOp",value:function(e){var t=this.editor.getContentState().schema;return Object(R.K)(e.attributes,t)||Object(P.e)(x.l.CodeBlock,e)}},{key:"editorWillCopy",value:function(e){var t,n,i,r;this.collectZoneDelta(e)||(e.deltaSet=this.transformOldCodeBlockToNew(e.deltaSet),n=(t=e.range).start,i=t.end,n.line===i.line&&n.zoneId===i.zoneId||(r=this.maybeCopyPartOfCodeBlock(n.zoneId,e.deltaSet))&&(e.deltaSet=r))}},{key:"editorWillSetClipboard",value:function(e){e.deltaSet=this.replaceZoneInDeltaSet(e.deltaSet)}},{key:"serialize",value:function(e){var t=e.type,n=e.op,i=n&&n.attributes||{},r=this.getIsCodeBlockOp(n);if(t===R.u.LEAF&&r){var o=i[x.k.ZoneId],a=document.createElement("pre"),s=document.createElement("code"),c=e.zoneId;e.zoneId=o;var l=this.editor.clipboard.serialize(e).node;return s.appendChild(l),a.appendChild(s),Object.assign(e,{node:a,zoneId:c})}return e}},{key:"UNSAFE_editorNormalizePasteNode",value:function(e){var t,n=e.data;Object(F.i)(this.editor,this.editor.getRep().zoneId)&&(n.text=Object(F.c)(n.text),t=n.node.querySelectorAll("table"),K()(t).forEach(function(e){var t=e.querySelectorAll("tr");K()(t).forEach(function(e){var t=document.createElement("div");t.innerHTML=e.innerHTML,e.parentElement.replaceChild(t,e)});var n=document.createElement("pre");n.innerHTML=e.innerHTML,e.parentElement.innerHTML=n.outerHTML}));var i=n.node.querySelectorAll("pre > code");Array.from(i).forEach(function(e){e.textContent=e.textContent||""})}},{key:"deserialize",value:function(e){var t=e.node,n=e.zoneId,i=e.deltaSet;if(!(t instanceof HTMLElement))return i;var r=t.tagName,o=t.style;if("code"!==r.toLowerCase())return i;var a,s,c,l,u,d,h,f="block"===o.display;return(t.parentElement&&"pre"===t.parentElement.tagName.toLowerCase()||f)&&(s=i.get(n),c=Object(P.b)(),i.replace(n,s.create(Object.assign({},s,{zoneId:c}))),l=t.parentElement||t,d=(u=Object(F.d)(l)).lang,h=u.specified,i=i.concat(new R.E({zoneId:N.DEFAULT_REP_ZONE}).insert("*",(a={},p()(a,x.k.ZoneType,x.l.CodeBlock),p()(a,x.k.ZoneId,c),p()(a,U.f,d),p()(a,U.g,String(h)),a)))),i}},{key:"editorWillPaste",value:function(e){var t=this.replaceZoneInDeltaSet(e.deltaSet,!0),n=this.editor.selection.getSelection().start.zoneId;Object(ce.b)(n,this.editor)&&(t=this.flattenZoneDelta(t),t=this.filterUnexpectedOp(t,!0));var i=e.lineState.getAttributes().toMap();return i.list&&"code1"===i.list&&(t=this.transformNewCodeBlockToOld(e.deltaSet)),t}},{key:"transformOldCodeBlockToNew",value:function(e){return e.reduce(function(a,e){if(!(e instanceof R.E))return a.concat(e);var s=new R.E({zoneId:e.zoneId}),c=!1,l="";return e.eachLine(function(e,t){var n,i,r,o;t.list&&t.list.includes("code")?(n=e.ops.slice(1),c?(i=a.get(l),r=new R.E({zoneId:i.zoneId,ops:i.ops.concat(n)}),a.replace(i.zoneId,r)):(l=Object(P.b)(),s.insert("*",(o={},p()(o,x.k.ZoneType,x.l.CodeBlock),p()(o,x.k.ZoneId,l),p()(o,U.f,Object(F.k)(t.lang||"")),o)),a=a.concat(new R.E({zoneId:l,ops:n}))),c=!0):(c=!1,e.ops.forEach(function(e){return s.push(e)}))}),a.concat(s)},new R.e)}},{key:"transformNewCodeBlockToOld",value:function(s){return s.reduce(function(e,t){if(!(t instanceof R.E))return e.concat(t);var a=new R.E({zoneId:t.zoneId});return t.ops.forEach(function(e){var t,n,i,r,o=e.attributes&&e.attributes[x.k.ZoneType];o&&o===x.l.CodeBlock?(t=e.attributes[x.k.ZoneId],n=s.get(t),i=(i=new R.e).concat(n),"\n"===(r=Object(R.I)(i,t,{list:"code1"}).get(t)).ops[r.ops.length-1].insert&&r.insertLineMarker({list:"code1"}),r.ops.splice(0,1),a=a.concat(r)):a.push(e)}),e.concat(a)},new R.e)}},{key:"getIsCodeBlockOp",value:function(e){return(e&&e.attributes||{})[x.k.ZoneType]===x.l.CodeBlock}},{key:"maybeCopyPartOfCodeBlock",value:function(e,t){if(!Object(ce.b)(e,this.editor))return null;var n=this.editor.managers.zoneToLineEntry[e];if(!n)return null;var i=this.editor.getRep(n.zone).lines.indexOfEntry(n),r=this.editor.getContentState().getZoneState(n.zone).getLine(i).getOps().find(function(e){return!(!e.attributes||e.attributes.zoneType!==x.l.CodeBlock)});return t.concat((new R.e).concat(new R.E({zoneId:n.zone}).insert("*",Object.assign({},r.attributes))))}}]),n}(le.a);ue([Object(R.J)(500)],he.prototype,"UNSAFE_editorNormalizePasteNode",null);var fe=he,pe=n("YWBl"),ge=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":T()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},me="codeBlockV2",ve=ae()({loader:function(){return Promise.all([n.e("doc_index_css"),n.e("chunk_adit"),n.e("commons--doc_index_delay--voteEmoji--votePicker"),n.e(16),n.e("commons--doc_index_delay--jira"),n.e("doc_index_delay")]).then(n.bind(null,"oicp"))},loading:function(){return M.a.createElement("div",{dangerouslySetInnerHTML:{__html:x.m}})},render:function(e,t){var n=e.default;return M.a.createElement(n,Object.assign({},t,{ref:t.containerRef}))}}),be=function(e){function r(e){var g,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(u()(this,r),(g=v()(this,E()(r).call(this,e))).editor=e,g.className=me,g.highlightManager=new Q(g.editor),g.cachedZoneLang=new Map,g.clipboard=new fe(g.editor),g.codeBlockController=new X.a,g.zoneAceClassName="".concat(U.e," ").concat(z.a.ACE_LINE),g.spanClassName=z.a.SPAN,g.zoneParentClassName=z.a.CODE_BLOCK,g.zoneType=x.l.CodeBlock,g.instanceName=B.e.CODE_BLOCK,g.isReady=!1,g._editorLineStateWillRender=function(e,t){var n,r,o,i,a,s=/mention-/,c=t.lineState,l=t.index,u=[],d=c.getZoneId(),h=d&&Object(F.m)(g.editor,d)||"",f=c.getLineMarker(),p=c.getModelText().slice(f);h&&Object(F.i)(g.editor,d)&&(n=g.highlightManager.highlight(d,l,h,p),u=Object(F.h)(n),r=new R.E({zoneId:c.getZoneId()}),o=0,r.retain(c.getLineMarker()),u.forEach(function(e){var t=e.startIndex,n=e.endIndex,i=e.classes;r.retain(t-o).retain(n-t,{codeClasses:i.join(" ")}),o=n}),i=new R.E({zoneId:c.getZoneId()}),a=!1,c.getOps().forEach(function(e){"string"==typeof e.insert&&(e.attributes&&Object.keys(e.attributes).some(function(e){return s.test(e)})?(i.retain(e.insert.length,{codeClasses:""}),a=!0):i.retain(e.insert.length))}),t.lineState=c.compose(a?r.compose(i):r))},g.handleDidPaste=function(e){var t,n=e.isInternalPaste,i=e.deltaSet;n||(t=Object.keys(i.deltas),g.editor.once("paint",function(){t.forEach(function(e){Object(ce.b)(e,g.editor)&&g.parseLanguage(g.editor.getRep(e))})}))},g.collectText=function(e,t){var n=t.attributes||[];if(n.some(function(e){var t=m()(e,2),n=t[0],i=t[1];return n===x.k.ZoneType&&i===g.zoneType})){var i=n.find(function(e){return m()(e,1)[0]===x.k.ZoneId}),r=i&&i[1];if(r){var o="",a=g.editor.getContentState().getZoneState(r),s=!0,c=!1,l=void 0;try{for(var u,d=a[Symbol.iterator]();!(s=(u=d.next()).done);s=!0)o+=u.value.getText()}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}return o}}},g.handleWorkerMessage=function(e){var t=e.data,n=t.version,i=t.language,r=t.zoneId;n===U.o&&(Object(F.j)(g.editor,r)||g.setLanguage(r,i||Object(ee.d)(),!1))},g.replayFollow=function(e){var r=e.data;Object.keys(r).forEach(function(e){var t,n,i=r[e];Object(w.default)(i)||Object(_.a)(i)||(t=Object(L.$)(".".concat(g.zoneType,"-").concat(x.k.ZoneId,"-").concat(e,".").concat(z.a.SPAN," .").concat(x.e.SCROLL_CONTAINER)),n=Math.floor(t.prop("scrollWidth")*i),t.animate({scrollLeft:n}))})},g.onContainerScroll=function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];g.followController&&(n?g.followController.triggerState(e,t):g.followController.updateState(e,t))},g.registerCommand(),g.isReady=t,g.loading(),g.editor.on(R.k.DID_PASTE,g.handleDidPaste),Object(ee.g)()&&(g.followController=new te(me,g.replayFollow)),"function"!=typeof window.Proxy)return de.forEach(function(e){var t=g.clipboard[e];g[e]="function"==typeof t?t.bind(g.clipboard):t}),g;var n=new Proxy(b()(g),{get:function(e,t){return(t in e?e:e.clipboard)[t]}});return v()(g,n)}function t(){return n.apply(this,arguments)}var n;return I()(r,e),h()(r,[{key:"getZoneId",value:function(e,t,n){return Object(F.f)(e,t,n)}},{key:"loading",value:(n=a()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isReady||Object(ee.f)())return e.abrupt("return");e.next=2;break;case 2:return e.next=4,this.highlightManager.loadLanguages();case 4:this.isReady=!0;case 5:case"end":return e.stop()}},e,this)})),t)},{key:"onZoneRepInit",value:function(e){var t=Object(F.m)(this.editor,e);this.cachedZoneLang.set(e,t),this.highlightManager.initStateCache(e,t)}},{key:"insertTabImpl",value:function(e,t,n,i){var r,o,a,s=e.lines.atIndex(n),c=s.text,l=s.lineMarker;t?(r=/^(\s*)/.exec(c.slice(l))[1].length)&&(o=Math.min(r,N.config.THE_TAB.length),this.editor.performDocumentReplaceRange(e.zoneId,[n,l],[n,o+l],"")):(a=[n,Object(w.default)(i)?l:i],this.editor.performDocumentReplaceRange(e.zoneId,a,a,N.config.THE_TAB))}},{key:"registerCommand",value:function(){var o=this,e=z.a.SPAN;this.editor.commands.registerAceCommand(V.F,function(e,t,n,i){var r=i.source;o.doInsertCode({source:r})},{statusKey:e})}},{key:"doInsertCode",value:function(e){var t=e.dRep,n=e.range,i=e.correctRange,r=e.source,o=t||i||n;o&&o.selStart&&o.selEnd&&ie.a.convertToCodeBlock(this.editor,r,o)}},{key:"renderLine",value:function(e){var t,n=e.lineState.getZoneId();return Object(F.i)(this.editor,n)&&(t=encodeURI(this.cachedZoneLang.get(n)||""),e.lineClass+=" ".concat(z.a.LINE," ").concat(U.f,"-").concat(t)),e.children}},{key:"renderCustomZoneView",value:function(e){var n=this,t=e.attributes,i=e.lineEntry,r=t.zoneId,o=t.lang,a=this.cachedZoneLang.get(r);a&&a!==o&&!t[se.q]&&this.highlightManager.forceRerenderAll(r,o),this.cachedZoneLang.set(r,o);var s=Object(ee.g)()?function(e,t){return n.onContainerScroll(r,e,t)}:void 0;return M.a.createElement(ve,{editor:this.editor,zoneId:r,lineEntry:i,highlightManager:this.highlightManager,controllerId:this.codeBlockController.id,onScroll:s,onLanguageSelect:function(e){return n.setLanguage(r,e)},onMount:this.handleZoneMount,containerRef:function(e){n.handleRef(i,r,e)},onUnmount:this.handleZoneUnmount,onWordWrapChange:function(e){return n.setWordWrap(r,e)}})}},{key:"aceCreateDomLine",value:function(e,t){var n,i,r,o,a=t.spanClass,s=t.zoneId,c=t.attrObj,l=t.index,u=t.nextAttrObj;s&&Object(P.a)(this.spanClassName,a)&&(n=this.editor.getRep(s).lines.keyAtIndex(l),i=u.lang||c.lang,(r=this.cachedZoneLang.get(c.zoneId))&&r!==i&&!c[se.q]&&this.highlightManager.forceRerenderAll(c.zoneId,i),this.cachedZoneLang.set(c.zoneId,i),ne.a.zonePropsMap[n]=Object.assign({},c,{outZone:s}),t.lineClass+=" ".concat(U.e," ").concat(z.a.ACE_LINE," "),t.editable=!1,t.rawHtml=x.m),s&&!t.lineClass.includes(z.a.LINE)&&Object(F.i)(this.editor,s)&&(o=encodeURI(this.cachedZoneLang.get(s)||""),t.lineClass+=" ".concat(z.a.LINE," ").concat(U.f,"-").concat(o))}},{key:"aceKeyEvent",value:function(e,t){var n=t.rep,i=t.evt;return!!C()(E()(r.prototype),"aceKeyEvent",this).call(this,e,t)||!(i.which!==D.c.Enter||"keydown"!==i.type||!this.handleEnterKeyDown(n))&&(i.preventDefault(),!0)}},{key:"afterPasteInsert",value:function(e,t){this.parseLanguage(t.rep)}},{key:"linesWillReplace",value:function(e,t){var n=t.oldLineEntries,i=t.newLineEntries,r=new Set;n.forEach(function(e){var t=Object(F.g)(e);t&&r.add(t)}),i.forEach(function(e){var t=Object(F.g)(e);t&&r.delete(t)}),this.highlightManager.clearStateCache(r)}},{key:"pluginReadOnly",value:function(){this.codeBlockController.editStatusChange(!1)}},{key:"pluginReadWrite",value:function(){this.codeBlockController.editStatusChange(!0)}},{key:"markdownMatched",value:function(e,t){var n,i,r,o,a,s,c=this,l=t.key,u=t.value,d=t.lang,h=t.replaceLen;l===x.k.ZoneType&&u===this.zoneType&&(n=this.editor.getRep(),i=n.lines,r=n.selStart,o=n.zoneId,a=r[0],s=function(e){var t=i.atIndex(a).lineMarker;e.delete(t+h)},ie.a.insertZone({attributes:{lang:d},zoneId:o,lineNum:a,editor:this.editor,beforeInsert:s,afterInsert:function(e){return c.handleAfterInsertByMarkdown(e,d)}}))}},{key:"reset",value:function(){C()(E()(r.prototype),"reset",this).call(this),this.codeBlockController.destroy(),Object(H.a)(),this.highlightManager.destroy(),this.editor.off(R.k.DID_PASTE,this.handleDidPaste),this.followController&&this.followController.destroy()}},{key:"parseLanguage",value:function(e){var t=this,n=e.zoneId,i=e.alltext,r=e.lines;"\n"!==i&&Object(F.i)(this.editor,n)&&(this.editor.getInInternationalComposition()||Object(F.j)(this.editor,n)||this.editor.inCallStackIfNecessary("parse-lang-v2",function(){Object(H.b)(t.handleWorkerMessage).then(function(e){var t={zoneId:n,content:i,lineNumber:r.length(),version:U.o};e.postMessage(t)})}))}},{key:"handleEnterKeyDown",value:function(e){var t=this,n=e.selStart,i=e.selEnd,r=e.zoneId;if(!n||!i)return!1;var o=m()(n,2),a=o[0],s=o[1],c=e.lines.atIndex(a),l=c.text,u=c.lineMarker,d=l.slice(u);if(Object(F.i)(this.editor,r)){var h=/^\s+/.exec(d),f=h?h[0]:"";return f.length?(this.editor.inCallStackIfNecessary("autoSpace",function(){t.editor.performDocumentReplaceRange(r,n,i,"\n".concat(f))}),!0):!1}var p=/^```([a-zA-Z0-9]*)$/.exec(d);if(s!==l.length||!p||0===a&&r===N.DEFAULT_REP_ZONE||Object(P.g)(r))return!1;var g=p[1];return ie.a.insertZone({editor:this.editor,zoneId:r,sel:[[a,0],[a,l.length]],attributes:{lang:g},afterInsert:function(e){return t.handleAfterInsertByMarkdown(e,g)}}),Object(pe.a)({action:U.a,op:B.f,source:"markdown"}),!0}},{key:"handleAfterInsertByMarkdown",value:function(e,t){var n;t&&(n=Object(F.k)(t),Object(ee.i)(n),Object(F.a)({lang:n,source:"markdown",rows:1}))}},{key:"setLanguage",value:function(e,r){var t,o,n,a,s=this,c=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];this.editor.getInInternationalComposition()||(t=Object(F.j)(this.editor,e),this.cachedZoneLang.get(e)===r&&t===c||(o=Object(F.e)(this.editor,e))&&(n=o.selStart[2],a=this.editor.getRep(n),this.editor.inCallStackIfNecessary("add-lang",function(){var e=s.editor.getRep(),t=e.zoneId,n=e.selStart,i=function(){s.editor.getCurrentCallStack().preventScrolling=!0,a.attributeManager.setAttributesOnRange(o.selStart,o.selEnd,[[U.f,r],[U.g,String(c)]])};c?i():(s.editor.makeNewEvent("nonundoable",function(){i()}),ie.a.updateSelectionAfterPaint(s.editor,t,n))}),c&&Object(ee.i)(r),Object(F.a)({lang:r,source:c?"specified":"auto",rows:this.editor.getRep(e).lines.length()})))}},{key:"setWordWrap",value:function(e,t){var n,i,r=this,o=Object(F.e)(this.editor,e);o&&(n=o.selStart[2],i=this.editor.getRep(n),this.editor.inCallStackIfNecessary("updateWordWrap",function(){r.editor.makeNewEvent("nonundoable",function(){r.editor.getCurrentCallStack().preventScrolling=!0;var e=String(t);i.attributeManager.setAttributesOnRange(o.selStart,o.selEnd,[[U.h,e]]),Object(pe.a)({action:U.l,extraParams:p()({},U.l,e)})}),Object(ee.j)(t)}))}}]),r}(ne.a);ge([Object(re.a)()],be.prototype,"doInsertCode",null);t.a=be},M6dX:function(e,t,n){},M8cP:function(e,t,n){"use strict";function o(e){var t=document.createElement("a");t.href=e;try{return{protocol:t.protocol,hostname:t.hostname}}catch(e){return null}}function i(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=o(e);if(!n)return"";var i=n.protocol,r=n.hostname;return t?[i,r].join("//"):r}function r(e){return i(e,!1)}function a(e){var t=o(e);return t?t.hostname:""}n.d(t,"d",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a})},MCJU:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return l});var i=n("15MJ"),r=n("laI6"),o=n("Z/PY");function a(e){var t=i.d.exec(e);return t&&t[2]}function s(e){var t=i.c.exec(e);return t&&t[1]}function c(e){switch(l(e)){case r.a.Doc:return s(e);case r.a.Drive:return a(e);case r.a.External:default:return null}}function l(e){return Object(o.r)(e)?r.a.Doc:Object(o.s)(e)?r.a.Drive:r.a.External}},"MEJ+":function(e,t,n){"use strict";var i,r=n("J4zp"),h=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("bNQv"),u=n.n(l),d=n("mwIZ"),E=n.n(d),y=n("nVH4"),O=n("HmyT"),f=n("puQj"),C=n.n(f),p=n("H6oK"),g=n("/spq"),m=function(e){if(!e)return!1;for(var t=0,n=[".sheet:not(.sheet-pasting)",".block-type-".concat(p.BlockType.BITABLE_BLOCK),".".concat(p.BLOCK_CONTAINER,":not(.sheet-pasting)")];t<n.length;t++){var i=n[t];if(0<Object(O.$)(e).parents(i).length)return!0}return!1},v=n("XB4d");n.d(t,"a",function(){return S});var b="single-line",k="single-clicked",I="ignore-collect",S=Object(g.a)(["aceKeyEvent","onMount","reset"])(i=function(){function t(e){var d=this;a()(this,t),this.className="SingleLineManage",this.UNSAFE_editorNormalizePasteNode=function(){var e,t=d.editor.getRep(),n=t.zoneId,i=h()(t.selStart,2),r=i[0],o=i[1],a=h()(t.selEnd,2),s=a[0],c=a[1],l=t.alinesWidth,u=t.lines.atIndex(s);_(r,{rep:t})&&o>=l[r]-1&&r+1<=s&&d.editor.selection.setWithSelection(n,[r+1,0],[s,c]),_(s,{rep:t})&&c<=u.lineMarker&&r<=s-1&&(e=s-1,d.editor.selection.setWithSelection(n,[r,o],[e,l[e]-1]))},this._handleDocClick=function(e){var t=Object(O.$)(".".concat(k));!Object(O.$)(e.target).parents(".toolbar").length&&t.length&&d._removeClickClass(d.editor)},this._handleLineClick=function(e){if(!e.shiftKey&&!m(e.target)){var t=d.editor,n=Object(O.$)(e.target).closest("[id^=magicdomid]");if(n.length){var i=t.domToRep(n.get(0)),r=i.selStart,o=i.selEnd,a=r[2];return t.selection.setWithSelection(a,r,o,!1),d._removeClickClass(t),t.updateBrowserSelectionFromRep(!0),n.hasClass("drive-uploader-file")}}},this.aceSelectionChanged=function(e,n){var i=n.editorInfo,r=i.getDocBody(),o=i.getRep();d._getMutiLineNodes(o.selStart[0],o.selEnd[0],n).forEach(function(e){var t=Object(O.$)(e);O.$.contains(r,e)&&(!t.is("[id^=magicdomid]")&&t.parents("[id^=magicdomid]").length&&(t=t.parents("[id^=magicdomid]")),t.hasClass(b)?d._addClickClass(t,n):t.hasClass(k)&&i.markNodeClean(e,o.lines.atKey(e.id)))})},this._doMoveCursor=function(e,i){if(!i.preventOtherHooksHandle){var t=i.editorInfo;return Object(v.a)({editor:t,evt:e,isSpecialContent:function(e,t,n){return _(n,i)}})}},this._getLineNode=function(e,t){var n=t.rep;return E()(n.lines.atIndex(e),"domInfo.node")},this.editor=e}return c()(t,[{key:"reset",value:function(){var e;this.editor&&((e=this.$docBody).off("click",".single-line",this._handleLineClick),e.off("mousedown",this._handleDocClick))}},{key:"onMount",value:function(){this.editor&&(this.$docBody=Object(O.$)(this.editor.getDocBody()),this.$docBody.on("click",".single-line",this._handleLineClick),this.$docBody.on("mousedown",this._handleDocClick))}},{key:"aceKeyEvent",value:function(e,t){var n=t.evt,i=t.editorInfo,r=n.type,o=n.keyCode,a=n.shiftKey;if("keydown"===r){var s=y.c.LEFT,c=y.c.UP,l=y.c.RIGHT,u=y.c.DOWN,d=y.c.RETURN,h=y.c.BACKSPACE,f=y.c.DELETE,p=y.c.H,g=n.ctrlKey&&o===p;if(-1<[s,c,l,u].indexOf(o)&&!a)return this._removeClickClass(i),this._doMoveCursor(n,t);if(o===d)return this._doReturn(n,t);if(o===f)return this._handleDeleteKey(t);if(g||o===h){var m=i.selection.getSelection(),v=m.start,b=m.end;return v.line!==b.line?this._doRangeDelete(n,t):this._doDelete(n,t)}}}},{key:"_addClickClass",value:function(n,e){var i=e.editorInfo;i.getObserver().withoutRecordingMutations(function(){n.find(".".concat(I,", .").concat(p.BLOCK_V_TEXT)).addClass(k);var e=n.get(0),t=i.dom.getEntryForNode(e);i.markNodeClean(e,t)})}},{key:"_markLineClean",value:function(e,r){u()(e,function(e){var t,n=Object(O.$)(e).parents("[id^=magicdomid]"),i=r.dom.zoneOfdom(n.get(0));i&&(t=r.getReps()[i].lines.atKey(n.get(0).id),r.markNodeClean(n.get(0),t))})}},{key:"_removeClickClass",value:function(t){var n=this,i=Object(O.$)(".".concat(k));t.getObserver().withoutRecordingMutations(function(){var e=i.parents("[id^=magicdomid]");i.length&&e.length&&(i.removeClass(k),n._markLineClean(i,t))})}},{key:"_getMutiLineNodes",value:function(e,t,n){var i=n.rep,r=e,o=t;t<e&&(r=t,o=e);for(var a=[];r<=o;){var s=E()(i.lines.atIndex(r),"domInfo.node");a.push(s),r+=1}return a}},{key:"_doReturn",value:function(e,t){var n=t.editorInfo,i=n.getRep();if(_(i.selStart[0],t)){var r=i.selStart[0],o=i.lines.atIndex(r),a=[r,o.text.length],s=[r,o.text.length];return n.selection.setWithSelection(i.zoneId,a,s,!1),setTimeout(function(){n.getInInternationalComposition()||n.inCallStackIfNecessary("singleLineDoReturn",function(){n.performDocumentReplaceRange(i.zoneId,a,s,"\n"),n.once("paint",function(){n.selection.setWithSelection(i.zoneId,[r+1,0],[r+1,0],!1),n.updateBrowserSelectionFromRep()})},{shouldIncorp:!0})}),!0}}},{key:"_isClicked",value:function(e,t){var n=w(e,t);return 0<Object(O.$)(n).find(".".concat(k)).length}},{key:"_handleDeleteKey",value:function(e){var t=e.preventOtherHooksHandle,n=e.editorInfo,i=e.evt;if(t)return!1;var r=n.getLine(),o=n.getRep(),a=r+1,s=E()(o.lines.atIndex(r),"text.length",0),c=n.isCaret(),l=o.selStart[0]===o.selEnd[0],u=c&&s===o.selStart[1],d=Math.random().toString();return _(r,e)&&l?this._performDeleteInSingleLine(n,r,e,d):_(a,e)&&u?(i.preventDefault(),n.setWithSelection(o.zoneId,[a,0],[a,0]),n.updateBrowserSelectionFromRep(),!0):void 0}},{key:"_performDeleteInSingleLine",value:function(e,t,n,i){var r=n.evt;return e.observer.withoutRecordingMutations(function(){Object(O.$)(".comment-line-popup").removeClass("comment-line-popup_active")}),T(t,n,i),r.preventDefault(),!0}},{key:"_doDelete",value:function(e,t){var n=t.preventOtherHooksHandle,i=t.editorInfo;if(!n){var r=i.getRep(),o=r.selStart,a=r.selEnd,s=r.zoneId,c=r.selStart[0],l=r.lines.atIndex(c),u=l.lineMarker,d=l.text,h=c-1,f=Math.random().toString();if(_(c,t))return this._performDeleteInSingleLine(i,c,t,f);var p=i.getLineListType(s,c),g=r.attributeManager.findAttributeOnLine(c,"text-indent");if(o[1]===u&&a[1]===u&&!p&&!g&&_(h,t)){var m=r.lines.atIndex(h),v=E()(m,"lineNode");C.a.mobile||i.hooks.callAll("shouldDeletePrevSingleLine",{prevLineEntry:m}).find(function(e){return e})?T(h,t,f):setTimeout(function(){Object(O.$)(v).children().first().click()});var b=0<d.length-u,y=o[0]===a[0]&&o[0]===r.lines.length()-1;return b||i.inCallStackIfNecessary("delete-single-line",function(){i.fastIncorp(),y?i.performDelete(c):i.performDocumentReplaceRange(s,[c,0],[c+1,0],""),i.updateBrowserSelectionFromRep(!0)},{mergeEvent:f}),e.preventDefault(),!0}}}},{key:"_doRangeDelete",value:function(e,t){var n=t.preventOtherHooksHandle,i=t.editor;if(!n){var r=i.getRep().zoneId,o=j(t);if(o){var a=o.correctSelStart,s=o.correctSelEnd;return i.inCallStackIfNecessary("delete-range-single-line",function(){i.performDocumentReplaceRange(r,a,s,"")},{shouldIncorp:!0}),e.preventDefault(),!0}}}},{key:"aceCutRangeReplaceSeletion",value:function(e,t){var n,i,r=t.rep.zoneId,o=j(t);o&&(n=o.correctSelStart,i=o.correctSelEnd,this.editor.selection.setWithSelection(r,n,i,!1))}}]),t}())||i;function T(e,t,n){var i,r,o=t.editorInfo,a=o.getRep(),s=a.lines.atIndex(e);s&&(i=s.lineMarker,r=s.text,o.inCallStackIfNecessary("delete-single-line",function(){o.fastIncorp(),o.performDocumentReplaceRange(a.zoneId,[e,i],[e,r.length],"")},{mergeEvent:n}))}function _(e,t){if(e<0)return!1;var n=w(e,t);return n&&Object(O.$)(n).hasClass(b)}function w(e,t){var n=t.rep;return E()(n.lines.atIndex(e),"domInfo.node")}function j(e){var t=e.rep,n=t.selStart,i=t.selEnd,r=t.alinesWidth,o=t.lines;if(!n||!i)return null;var a=n[0],s=a+1,c=i[0],l=c-1,u=o.atIndex(a),d=o.atIndex(c);if(!d||!u)return null;var h=i[1]<=d.lineMarker,f=n[1]>u.lineMarker,p=n,g=i;return _(c,e)&&h&&a<=l&&(g=[l,r[l]-1]),_(a,e)&&f&&s<=c&&(p=[s,0]),p!==n||g!==i?{correctSelStart:p,correctSelEnd:g}:null}new S},MFtX:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i={id:"",en_name:"",cn_name:""},r={authStatus:{authUrl:"",authState:n("LaDK").a.HAS_NOT_FETCH,baseUrl:"",jiraType:"",canApply:!1,adminInfo:i},syncStatus:{},initDataMap:{}}},"MNj/":function(e,t,n){},MO5G:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lQZd"),r=n("QM+C"),o=n("rLED"),a=n("skFV"),s=function(){return!![r.NUM_SUITE_TYPE.DOC,r.NUM_SUITE_TYPE.SHEET,r.NUM_SUITE_TYPE.MINDNOTE,r.NUM_SUITE_TYPE.WIKI].includes(Object(i.l)())&&Object(o.I)("comment_image_enabled",Object(a.v)())}},MZhh:function(e,s,c){"use strict";(function(e){c.d(s,"a",function(){return o}),c.d(s,"b",function(){return a});var t=c("lSNA"),n=c.n(t),i=c("jU1f"),r=c("fMYX"),o=90,a=n()({reminder_id:{deletedMsg:e("reminder.toast.deleted"),getSelection:i.a}},r.a,{deletedMsg:e("CreationDoc_Docs_TaskCenter_Deleted_Tooltip"),getSelection:i.e})}).call(this,c("2vAP"))},MkHE:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s="MENTION_FILE_LIST_CHANGE",c="REFERENCE_LIST_MOUNT",l=function(){function t(e){r()(this,t),this.emitter=e}return a()(t,[{key:"destroy",value:function(){this.emitter=null}},{key:"onMentonFileListChange",value:function(e){this.emitter&&this.emitter.on(s,e)}},{key:"offMentonFileListChange",value:function(e){this.emitter&&this.emitter.off(s,e)}},{key:"mentionFileListChange",value:function(e){this.emitter&&this.emitter.emit(s,e)}},{key:"onReferenceListMount",value:function(e){this.emitter&&this.emitter.on(c,e)}},{key:"offReferenceListMount",value:function(e){this.emitter&&this.emitter.off(c,e)}},{key:"referenceListMount",value:function(){this.emitter&&this.emitter.emit(c)}}]),t}();t.a=l},Ms4L:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n("lwsE"),r=n.n(i),o=n("FJEn"),a=function e(t){r()(this,e),this.instanceName="gallery",this.id=t.uuid,this.displayType=o.DisplayType.Inline,this.isAsyncNode=!0}},MvBO:function(e,t,n){"use strict";var d=n("D1oa"),h=n("2IHA"),f=n("NtTV"),u=n("ahx2"),p=n("toa8"),g=n("rLED"),m={"use-new-default-thumbnail":"true"};function i(r){var o=r.url,a=r.key,s=r.iv,c=r.cancelToken,l=r.logger,u=!1;return new Promise(function(n,i){l&&(l.logValue("request_cdn_necessary",!0),l.logStartTime("request_cdn_time_cost"));var t=Object(p.d)({url:o,responseType:"arraybuffer",withCredentials:!1,ignoreInterceptors:!0,timeout:r.timeout});function e(t){return function(e){if(u)throw new Error;return t(e)}}c&&c.promise.then(function(e){i(e),t.abort(),u=!0}),t.then(function(e){var t=e.data;return l&&(l.logEndTime("request_cdn_time_cost"),l.logValue("size",t.byteLength),l.logValue("decrypt_necessary",!0),l.logStartTime("decrypt_time_cost")),Object(h.c)(t,window.atob(a),window.atob(s),h.a["AES-GCM"])}).then(e(function(e){l&&l.logEndTime("decrypt_time_cost");var t=Object(d.a)(e);n(t)})).catch(function(e){var t,n;u||(t=Object(f.e)(e),l&&(n=Object(f.f)(t),l.getLogValue("decrypt_necessary")?(l.logValue("decrypt_fail",!0),l.logValue("decrypt_fail_reason",n)):(l.logValue("request_cdn_fail",!0),l.logValue("request_cdn_fail_reason",n))),i(t))})})}function r(e){var i=e.url,r=e.cancelToken,a=e.logger,s=!1;return new Promise(function(o,t){a&&(a.logValue("request_origin_necessary",!0),a.logStartTime("request_origin_time_cost"));var n=Object(p.d)({url:i,responseType:"arraybuffer",ignoreInterceptors:!0});r&&r.promise.then(function(e){t(e),n.abort(),s=!0}),n.then(function(e){var t=e.headers,n=e.data;if(a&&a.logEndTime("request_origin_time_cost"),t["content-type"].includes("json")){var i=JSON.parse(Object(d.b)(n));throw{info:"[".concat(i.code,"]").concat(i.message)}}a&&a.logValue("size",n.byteLength);var r=Object(d.a)(n);o(r)}).catch(function(e){s||(a&&a.logValue("request_origin_failed",!0),t(Object(f.e)(e)))})})}function o(e){var o=e.url,a=e.key,s=e.cancelToken,c=e.logger,l=!1;return new Promise(function(n,i){c&&(c.logValue("request_suite_necessary",!0),c.logStartTime("request_suite_time_cost"));var t=Object(p.d)({url:o,params:{adapter:"front"},headers:Object.assign({},Object(g.P)()&&m),responseType:"arraybuffer",withCredentials:!0,ignoreInterceptors:!0});function e(t){return function(e){if(l)throw new Error;return t(e)}}s&&s.promise.then(function(e){i(e),t.abort(),l=!0});var r=!1;t.then(function(e){var t=e.headers,n=e.data;if(c&&c.logEndTime("request_suite_time_cost"),r=!!t["access-new-default-thumbnail"],t["content-type"].includes("json")){var i=JSON.parse(Object(d.b)(n));if(u.SpecitalSuiteCodeList.includes(i.code))throw{specialSuite:!0,info:i};if(i.code===u.STATUS_CODE.FORBIDDEN)throw{noPermitted:!0,info:"no permission"};throw{info:"[".concat(i.code,"]").concat(i.msg)}}return c&&(c.logValue("size",n.byteLength),c.logValue("decrypt_necessary",!0),c.logStartTime("decrypt_time_cost")),Object(h.d)(a,h.b["SHA-256"]).then(function(e){return Object(h.c)(n.slice(16),e.slice(0,32),n.slice(0,16),h.a["AES-CBC"])})}).then(e(function(e){c&&c.logEndTime("decrypt_time_cost");var t=Object(d.a)(e);n(Object.assign({},t,{isIcon:r}))})).catch(function(e){var t,n;l||(t=Object(f.e)(e),c&&(n=Object(f.f)(t),c.getLogValue("decrypt_necessary")?(c.logValue("decrypt_fail",!0),c.logValue("decrypt_fail_reason",n)):(c.logValue("request_suite_failed",!0),c.logValue("request_suite_fail_reason",n))),i(t))})})}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o})},NHsQ:function(e,t,n){},NRFK:function(e,d,h){"use strict";(function(n){var e,i=h("HmyT"),r=h("rT/R"),o=h("cGQV"),t=h("xZLd"),a=h.n(t),s=(h("LR58"),"");function c(){return e=e||r.c.toRegExp()}function l(){return s=s||r.a.toString()}window.requestIdleCallback&&window.requestIdleCallback(function(){e||s||(e=r.c.toRegExp(),s=r.a.toString())});var u={clazz:"rangecode-bomb",$el:null,$container:null,$counts:0,hasShow:!1,init:function(e){var t=Object(i.$)(".etherpad-container-wrapper").parent();u.$container=Object(i.$)(Object(o.b)(a.a)({clazz:u.clazz,data:0,wordInfo:n("etherpad.word")})).appendTo(t),u.$el=u.$container.find(".rangecode-bomb"),u.editor=e},showEntry:function(e,t){var n=u.$el;u.getSelectionCounts(e,t),0!==u.$counts&&(n.text(u.$counts),u.hasShow||u.$container.addClass("show"),u.hasShow=!0,document.addEventListener("selectionchange",u.handleSelectionChange))},hideEntry:function(){u.hasShow&&u.$container.removeClass("show"),u.hasShow=!1,document.removeEventListener("selectionchange",u.handleSelectionChange)},destory:function(){u.hasShow&&(u.$container.removeClass("show"),u.hasShow=!1),u.$el=null,u.$container.detach(),u.$container=null,s=e=null},getSelectionCounts:function(t,e){u.$counts=0;var n=t.getRep(),i=n.lines.offsetOfIndex(n.selStart[0])+n.selStart[1],r=t.selection.currentSelection,o=r.start,a=r.end;t.managers.getChildZonesInRangeRecursive(o,a).text.forEach(function(e){u.getCharNumber(t.getReps()[e].alltext)});var s=n.lines.offsetOfIndex(n.selEnd[0])+n.selEnd[1],c=n.alltext.substring(i,s);u.getCharNumber(c),e&&0<e.length&&e.forEach(function(e){e.zoneId===n.zoneId&&c||u.getCharNumber(e.alltext)})},getCharNumber:function(e){var t=e.replace("\n"," ");[].concat(t.split(c())).forEach(function(e){if(""!==e){for(var t=Object(r.b)(e,l());t.hasNext();)t.next();u.$counts+=t.counts()}})},handleSelectionChange:function(){0===window.getSelection().toString().length&&u.hideEntry()}};d.a=u}).call(this,h("2vAP"))},NSt8:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABbQAAADcCAMAAACf49d1AAAAllBMVEXv8PFkanOPlZ5tc3udoaeIjZTr7O7T1dfExsrm6Om/wsXa3N+VmqCBho7o6evk5eeZnaPHys1yd3+ytbqMkZhqcHnW2NqprbJ5foWgpKnQ0tWGipFmbHXf4OLc3uDFyMuip6x+hIumqa/h4+VnbXZ3fYW4u7/LzdB0eoKvsre7vsKPk5nNz9KSlp21ub2ssLR8gYn///+8+fyiAAAR60lEQVR42uzBgQAAAACAoP2pF6kCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGD24EAAAAAAAMj/tRFUVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVYUdO2xtGwbCOH6naW7taQ3ZTLJ1C/E8MMnGGvL9v9zWGULcs5piEJHD//fKryTuTnoQBgAAAAAAAAAAAAAAAAAAAAAAAAAAAG5dserWPgS/7laFAAByVnbBnYSuFABArooquIFQ8doGgEyVrTNaHtsAkKWNdyP8RgAA2Sm9G+VLuWjhX2T707dKojYuzPT93teZgOmYtfVreZNf/kkSMPunbZz3dxNWMg29BltCisHZkSTYzNSDnBSti2gLGWrfD1QiH1QH81x813eFxHxV3css9XUmYDpmrfWLjKn7KfxuqlL+C1pLAmb/tI1TrSasZBp6PbaEODO4BCOxm02pBzmpXFQlQ7UO7Edu0k4/SlSnupQ5WDVNkTC0Tccm3VA92S1vN7T7UZiVpjY0bs6h3Tfp0omeT2h/braCuDK4M4vjwp2YnxnV4dkf1ebw7HHkJpX3DxL3uJJZ2Ko+JAxt07GJoV3v/2lqVb2/2dDuR2FWmtjQuFmHdt+kSyd6PqH9QxtBXOfOHY9Hd6aTEZXqz7M7eYu/u05HPIc646F96D/udvqpJLTzQWgT2ikV4bXQDgWhffU6L4a2LFU7Qjsff9m7tu3EjSA4tUICgbBAIHERYO5XY5P//7kA3RLWVsYCn5PEyaEedndA0z1dXVOMZa39NO2naf+dSH5ZTFuQ3GPa62AbudrWqbuTf9S6q7j/662YzHXDy8nQ7ZrJvOkElzntSt9pdoxic+zHW7fj5bmCVXR898zR3eipstKMT0GNPns6x1U8ayUcR/MtPlxn9avK49t8J63IuOeegNR1337znnprFR06n3L+2jruPCRKB6kjufPxOdVOx5UzU41e6qTTcYExjhfOXac5rd5h2sbBQLcjR2JWF9Om4zQ/fB0yp5yfK6m7RzUBtyMUue5YyqudW5r2CneiiQZudU1bnTtEsRUsNV75jVAluh5Es97kXMqu66yOEyPwP5rReVpicj7Sa6Ftt2XrbLmquIQcB7dmMooWJAFpHMmQMlJLmCTima7QZMk8jU+V0E4j10OxadtxndwBzshMTlw3xtY9N+OJv8b6a9Ne32HaLVwhHLvyt+dCUCnc0gYuMm0j9lf6rcw9rjhk6hWsQtGEhnZfIpVNZ6nJigeLSROCOcXRfCdcsaaxlKHzRx9X8UFQL5p2TxcTFnNGN28vLHHVkPFOxzORdhO7xMkn5oxxvOoWFyw3d5h2E65sR47ErL7GMnQSY+GU83Ml2kszBk7ypB0iKU9bevJz02YauNUDGXa9nPdCK0hqlpULoUp0BxdsQ38mpQxFhQ4E+mH5Fsm7r2v0bZ0tVxWXkMNBJ9f/hCQgjSMZUkZqCZNEPNMVkkyzO1UrjVwPxeZtx3VyBygjM5lAcDJP/DV6X5t2r9y0u3Fvk9T7wOunHVPBsjf024G0gUx7mfbryWsKVHBoJ7WZTp4DQb1R7cVq4hUg3SftAVJHZNMBuu3JpvXbh8FLBEzPcVKgw3Eu+dzovVrtOIgXNJb5o3k72adA71LUcAdshkN156xOHOpJ/QCkWU6nkzT2EZbjgmcDs30yPOde+VehA819sukt4fjiJUdn9V69vDCa5IxxvDA+r2mTrPtxWm7aW7RkO1IkZmMSn0ldNNYRtsbGKefnSrQla6gcjmjJx8coaDfaXWCamTZP5lZPgdm11d2C4+WtIKnRytm03eV0WP2I0Ww678lwPsLMnOE7iHbDyWsTo+vKxkssz2HXp1EXfVtny1RFJVhNmyQgjSMZUkZuCZPEPPMVAU7btJ68XZZrpZHrodi07bhO7gBnZCZfhsM+guF/5aGFfwGVr027Um7ay0Qb6H7aMY4eY7px969MG/3LR6zXh1wdOtK9kxPooQ3+xV5GCDwjE1CX/TZQ/xg1Crf4RhtzCTiD43GcNhCFmn9H4zPmegTwAsQL2z1t9DQX2vK3M7muPUJgBFpK9zq1BnzI+HitoRrL2ptA09cXgpwxjjfQmvwUpabdADqy9ykSs9ERjswmjt9snHJ+ruQoPTtghb05I0JdyvtQ64wz06bJvKhFjIOntIHvabPUaOVs2npg2APLhnYuvIydqHoNs5XpLcQydoG+tbMlqqISrKZNEpDGkQwpI7WESCKeLfe0EShtsAqA6uHYvO24TnAHOGORyec97XIEX5t2UG7aSu8c0W3HhMUTNpt2XeZcxrLzXfMJC5HTALEedlsyo4dIlOetxDEEL3H2BXOSNoccpw28GxVDy/DYX2bRwhgDm2mvjKTewpWcqtA9EBY+Pybqes2KbMTs3jVGoSh5mL2AsTLG8fxlXlOpaftNLCe69zkSs7r1jMLGKefnSvbXlz3HqeEoDEl5Gv0VGKtp02Re1DSn7WgxbZIarZxMuy/qgFaSSKocLbgiVQ3bGKFv5a9EVVSC1bRJAtI4kiFlpJYQScSzxbSXodA2wtpGI9VDsWnbUZ2WDlDGIpNP0/4nTLuWK9y77ZgI2/ZXpi1y6MBRg0PTfIInUV0cs4kimy5ahQ2nqIoxKDhOG0gy+bmGx1UZi6JTm2nvcpdzZI4qeFzwgi66RqHjQxZCrmtiZgQToK2McbzhrSb77ZHK8IxaLwJ2emCjSMzGOzDI+mfjlPNzJYurDN5wfFleCFlLC5s43C5S0+bJ3Or8/TeLaZPUaOVk2kHRM0PhO8cUJ8mX5BP7xN+dqqISrKZNEpDGkQwpI7WESCKeLaZ9MoIt5jYaqR6KTduO6rR0gDIWmXya9sO3R8I/wkdvj1QLqtAdswewGtR8m2n7atrRb6YdtjvTytGVbRFhbgShyGaFZkXQxLawoJvFUhzJp9UipXFhfg+RzbRfb9n8658VReGripXKjccesFYlK0boKGMcbw/4WYtspp1jNDdq2hSJ2fBOwOjQkbbZOOX8XMnp0pM59sbF8JK8J1Y5yFu2UYHQZF7U7f2FxbRJarRyMm1diaPnOD8zbS/Z9watwxYnuSfvmUyFfeLvTlVRCVYzIwlI40iGlJFaQiQxz/ZH/tQabTRSPRSbth3VaekAZSwy+TTtB78Ryeh907RNe3Z1k27yiGkvWshQU0Xn4q5f//wEk+MDzm1AcUpNO5+vW9hi2lqJHs0+8Ak3lnTNPM4/g5qYG8UWU2WM4n1e04fVtEfxGU5aSfLtSJGYDeNXYpyx/fCMlVPOz5VMUblsr4XpXNJEGNpMmyaXtrrctGnl95t2fQXFiQol/u5UFZVgNTOSgDSOZUgZaaVEEvFcato2Gqkejq3redy0ixmfpv3NR/7sWH/HtPWtzi8HGNXuN21vBhx6+9pb1XL8ihDUchROhV4+oDilpq1bJPcqi2lvjKB2LX+NZS1Hw+TYZluFt87yqulmTpCJsVPGKB4fABnAB/0fDYpEbFzgvU5nAJqelVPOz5VscDIhZhdymmYCx9hMmybzom7v+3eftHnl5aYt8t0OOvV2tYWTiOfldn4l/u5UFZVgNTOSgDSOZEgZqSVEEvFcbto2Gqkejq3b7nHTLmZ8mvbjSL427eR7pq3w1g6i+017nzmjrzc6c3ltRDbpOThDz74KilNu2m+iMXmhaTPttRF0EMucsSHIffjiOLh98LT1kWpBmFXZ4niXijPDODxg2hSJ2VAkR+CdOLXn50q8GGH9upFX8Pc4Wk2bJvOi0vz95D7TppXfbdpbuJ6K7kQ374m/+1VlL8HBLl/4hCQgjSMZUkZqCZFEPJebto1Gqodi07ajOm0dKGZ8mvbj8IKv7mkH3ndNW7EDxnebdn6n7k20PM9Vqk+KVrDyDCNEdgbwO50GxSk17QUytXkRAi0m/N203VzMM5mzN4YxQKyx2539NYOjm+U9U/JynL+QKGMcb5xbchg/YNoUidjI4TloEaf2/FyJOaAWYHgtut7C3mraNJkX1crfn7Nph4alpit/3LTDPH56NW0/RpCrs2/tbLmq7CWcMMh3A0tAGkcypIzUEiKJeKYryLRtNFI9FJu2HdVp6YBkLDPtgXnib/2BUWzar2na0OPJ0rvbtOdwsm2HmmgzDeU6kU0C/QLs5TCbF/QVj/UfWFCcUtM2R0Sh0URDPWe+0nPa7azOtczZvggds9n404Uj1VsjRkWW/CGC3aIrXoIgeyHNPYbjdeGEyg36EnFTbtoUidk4pErdFj0bp5SfKhG2Ko4ju661xcJq2jSZFzXMbh+P44LjaStYarTye037BehkgU+fLXZ8AvrWzparyl7CQU3qJQImJAFpHMmQMlJLiCTima4g07bRSPVQbNp2VKelA5SRmNSDUSb6Jx780azfNO0x0E/OTXmNVCHlpi0hWsk5ZjfWM+EHsJ3Wdy6mQF3V0fONV3U1rWIRI3r1THUOHDlOuWlPlthuPLOYZ7tpDLjD35/TXr77xn9fqjInI5yq59TrEQ7FozZaExPWT1gmkgLTsfHeVhg1xEscHBvXF/CWewzHq+K6pkkLK/R12w1KTZsiMRsVYOefxxVgaOWU83MlZgLh23ixGKDFtHkyt/oADMYXwURxwfGkFSw1Wvndt0dmcGovxnt3YlmzHwGHzn7gbI/oWztbrip7CWsgWBhvONsCE5KANI5kSBmpJUQS8UxXkGnbaKR6KDZtO6rT0gHOyKbdAta+iP555n74lyB8x7S1f3CaI2AV3m/a5gggcuAMHf1C/n2p38NX0w5dANslfn8W69UBRg6A2QvHKTdtU8/mu7rcS55RvWDajRSILoGrSkMMONElp8xR+JfkDs6oy7h7GY+AOL9/0AOcJdRzlTGO14Gsab7O/qMeTqWmTZGYDf90eScC0DEWTik/VSJYAftsf0/tps2TudXjmdC2nURFx9NWkNRo5feadnUJLFdA0FE+x01csB330Ld1tkxVX5cwk9pXCTAhCUjjSIaUkVrCJBHPdAWZtoVGrodi07ajOi0doIy8H98AUXvv+SNIvv3rxh6/p71xcYbT880Dpu31YiB2E5OZtkk6wWFX/fTDIXd9nHEYmiIWvxwA0c4zFOce0zbjw2V+f5fHa8VA0bQXL5Ut4BxutXcl54spYn0qPuz43gfgdBs3V+ucgNGsXfAYjreZjYBZx+gOnaycfalpcyRm1e85OMPdGAFxyvm5EqUPobwBbL4wbZ7MrfYqEeD8mpii42kryLRp5XebtqmmAFZzk5m28erT7qDum8y0ubOlqvq6BL+1vChnsgAmJAFpHMmQMlJLmCTima4g07bQyPVQbNp2VKelA5SRmTT1PnDKRP/Eg7/Y9/t4aQxD8zAmVcu3Gtt53GrjfAljXA0pzlfg+S9FWnzD1zR+X+1flujpEm/jsVGokv1iMo6n8/zC8BEev2RjMdQFMqecnyr5Dngyt2icGIKlFbTyh+BXF4agRwfmr1xV5SV4jcSwBOwy5IzcEiaJef4+jVwPx9Ztx3UyHm9cmIn+ib/CuPKXnj02/zLG+712rgaE5v+B5vMm3c/C676dnzwrlmueEnjip8Gfs2fPffNvIxwhlW/6RZiZ/wmeO/aHYZA9VzEHapZrnhJ44sfBqwdFyw7qP+HLkimwPe4+jiPEDfM/wXPH/jBMIizTaWfaB1qWS54SeOInwl8Hnyx7/e8fs6/oObgi/a/8dsByuM7cPPGTkP2+GKdnO6g8JfDEz4SXrHuVIKj01slPOGULXva91uB9aJ544k/27NgEABgEANhY6CQ4iP8/6hUukryRPS876l9ZEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABg2IMDAQAAAAAg/9dGUFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVWV9uCABAAAAEDQ/9ftCFQAAAAAAAAAAAAAAAAAAAAWAvbZ4Qpul7/HAAAAAElFTkSuQmCC"},NVF8:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n("o0o1"),l=n.n(i),r=n("yXPU"),o=n.n(r),u=n("WtXJ"),d=n("JHqw"),h=n("Nmqt");function f(){return(new Date).getTime()}function a(e){return s.apply(this,arguments)}function s(){return(s=o()(l.a.mark(function e(t){var n,i,r,o,a,s,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(h.b)(t)){e.next=25;break}if((i=window["scm".concat(t)]=window["scm".concat(t)]||{}).tracker=i.tracker||{},r=f(),Object(u.a)().length){e.next=12;break}return o=f(),e.next=9,Object(u.b)({loadModule:!0});case 9:a=e.sent,i.tracker.fetchList_cost_time=f()-o,Object(u.d)(a.navs);case 12:return s=f(),e.next=15,Object(u.c)(t);case 15:return i.tracker.intExternalJS_cost_time=f()-s,c=f(),e.next=19,d.a.manager.loadModule(t,{disableSandbox:!0});case 19:e.sent.precompile(),i.tracker.intModuleJS_cost_time=f()-c,(n=Object(h.b)(t))||console.error("get garr ".concat(t," module error")),i.tracker.loadModule_cost_time=(new Date).getTime()-r;case 25:return e.abrupt("return",Promise.resolve(n||{}));case 26:case"end":return e.stop()}},e)}))).apply(this,arguments)}window.garrRequire=a},NWgW:function(e,t,n){},Najy:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return m});var i,r,o,a,s=n("lwsE"),c=n.n(s),l=n("W8MJ"),u=n.n(l),d=n("cDf5"),h=n.n(d),f=n("xKvl"),p=n("NzDz"),g=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};(r=i=i||{}).INIT="init_comment",r.SUCCESS="init_comment_success",r.FAILURE="init_comment_fail",(a=o=o||{}).INIT="init_comment_retry",a.SUCCESS="init_comment_retry_success",a.FAILURE="init_comment_retry_fail";var m=function(){function e(){c()(this,e),this.commentLogger=new p.a("part_comment")}return u()(e,[{key:"logResetComments",value:function(){}},{key:"logClickCommentPop",value:function(){}},{key:"logDevCreateCommentCost",value:function(){}},{key:"logClickShowCommentPanel",value:function(){}},{key:"logClientCommentPanel",value:function(){}},{key:"logShowReactionPanel",value:function(){this.commentLogger.logShowReactionPanel()}},{key:"logVcFollowCommentData",value:function(){}},{key:"logVcFollowNoCommentData",value:function(){}},{key:"logVcFollowNoCommentPanel",value:function(){}},{key:"logSelectReaction",value:function(e){this.commentLogger.logSelectReaction(e)}},{key:"logCancelReaction",value:function(e){this.commentLogger.logSelectReaction(e)}},{key:"logShowReactionPage",value:function(e){this.commentLogger.logSelectReaction(e)}},{key:"logShowReactionPageFull",value:function(e){this.commentLogger.logShowReactionPageFull(e)}},{key:"logDevCommentEvent",value:function(e){this.commentLogger.logDevCommentEvent(e)}},{key:"logCommentSubmitSuccess",value:function(e){this.commentLogger.logCommentSubmitSuccess(e)}},{key:"logSubmitEventError",value:function(e){this.commentLogger.logSubmitEventError(e)}},{key:"logClickCommentFinish",value:function(e){this.commentLogger.logClickCommentFinish(e)}},{key:"logCommentEdit",value:function(e){this.commentLogger.logCommentEdit(e)}},{key:"logCommentEditConfirm",value:function(e){this.commentLogger.logCommentEditConfirm(e)}},{key:"logClientCommentEditComment",value:function(e){this.commentLogger.logClientCommentEditComment(e)}},{key:"logCommentDelete",value:function(e){this.commentLogger.logCommentDelete(e)}},{key:"logClickCommentInput",value:function(e){this.commentLogger.logClickCommentInput(e)}},{key:"logClientCommentSumbitBox",value:function(e){this.commentLogger.logClientCommentSumbitBox(e)}},{key:"logClientCommentReplyComment",value:function(e){this.commentLogger.logClientCommentReplyComment(e)}},{key:"logClientCommentInputBox",value:function(e){this.commentLogger.logClientCommentInputBox(e)}}]),e}();g([Object(f.a)("pc_doc_comment_reset_comments",function(e){return{fromEditor:e.args[0].fromEditor}})],m.prototype,"logResetComments",null),g([Object(f.a)("click_comment_pop",function(){return{comment_action:"click_txt"}})],m.prototype,"logClickCommentPop",null),g([Object(f.a)("dev_create_comment_cost",function(e){var t=e.args;return{time_cost:Date.now()-t[0].localStartTime}})],m.prototype,"logDevCreateCommentCost",null),g([Object(f.a)("click_show_comment_panel",function(e){return{source:e.args[0].source}})],m.prototype,"logClickShowCommentPanel",null),g([Object(f.a)("client_comment_panel",function(e){var t=e.args;return Object.assign({},t[0])})],m.prototype,"logClientCommentPanel",null),g([Object(f.a)("dev_vc_comment_data",function(e){return{commentId:e.args[0].commentId}})],m.prototype,"logVcFollowCommentData",null),g([Object(f.a)("dev_vc_no_comment_error",function(){return{comment_type:"no_comment_data"}})],m.prototype,"logVcFollowNoCommentData",null),g([Object(f.a)("dev_vc_no_comment_error",function(){return{comment_type:"no_comment_panel"}})],m.prototype,"logVcFollowNoCommentPanel",null)},NbI8:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"a",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"b",function(){return i});var i,r,o="new_image_upload_event",a="new_image_upload_start",s="new_image_upload_end",c="play_big_gif",l="display_new_gallery",u="external_save_status";(r=i=i||{}).EXEC_URL_TO_FILE_FAIL="EXEC_URL_TO_FILE_FAIL",r.OVER_FILE_SIZE_LIMIMT="OVER_FILE_SIZE_LIMIMT"},NdYY:function(e,t,n){},Ngj4:function(e,w,j){"use strict";(function(o){var e=j("lwsE"),n=j.n(e),t=j("W8MJ"),i=j.n(t),r=j("a1gu"),a=j.n(r),s=j("Nsbk"),c=j.n(s),l=j("7W2i"),u=j.n(l),d=j("cDf5"),h=j.n(d),f=j("q1tI"),p=j.n(f),g=j("4PSP"),m=j("svPQ"),v=j("UlbS"),b=j("r06y"),y=j("HmyT"),E=j("MjSh"),O=j("Sd1l"),C=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},k=v.Select.Option,I=34,S=E.N900,T=E.N400,_=function(e){function t(){var e;return n()(this,t),(e=a()(this,c()(t).apply(this,arguments))).insertTimer=null,e}return u()(t,e),i()(t,[{key:"componentWillUnmount",value:function(){this.handleSetTimeBlur(),this.insertTimer&&clearTimeout(this.insertTimer),this.insertTimer=null}},{key:"getCurrentItemIndex",value:function(e,t){return e.findIndex(function(e){return e.value===t})}},{key:"scrollDropdown",value:function(e,t){e&&(e.scrollTop=I*t)}},{key:"insertSetTime",value:function(e){var t,n,i,r;e&&(t=-1<e.toLowerCase().indexOf("pm"),e=e.replace(//g,":").replace(/[^\d:]/g,""),/^([0-9]|[0-1]\d|2[0-3]):([0-9]|[0-5]\d)$/.test(e)&&(n=e.split(":"),i=Number(n[0]),t&&i<12&&(i+=12),r=60*(60*i+Number(n[1]))*1e3,this.props.onChange(Object.assign({},this.props,{setTime:r}))))}},{key:"handleSetTimeCheckboxClick",value:function(e){this.props.onChange(Object.assign({},this.props,{isWholeDay:!e.target.checked}))}},{key:"handleNotifyCheckboxClick",value:function(e){this.props.onChange(Object.assign({},this.props,{shouldNotify:e.target.checked}))}},{key:"insertSetTimeInput",value:function(e){var t=Object(y.$)(".set-time .reminder-popover-select input");t.length&&t.val(e)}},{key:"setSetTimeSelectColor",value:function(e){var t=Object(y.$)('.set-time .reminder-popover-select [data-sel="spark-select-value"]');t.length&&t.css({color:e})}},{key:"handleSetTimeOptionClick",value:function(e){var t=this,n=e.value,i=this.props.onChange;this.setSetTimeSelectColor(S),this.insertTimer=setTimeout(function(){t.insertSetTimeInput(Object(b.k)(Number(n)))},250),i(Object.assign({},this.props,{setTime:Number(n)}))}},{key:"handleSetTimeOpen",value:function(e){var t,n,i=this.props,r=i.setTimeList,o=i.setTime,a=Object(b.k)(o);e?(this.insertSetTimeInput(a),this.clearSetTimeTitle(),t=this.getCurrentItemIndex(r,o),n=document.querySelector(".set-time .reminder-popover-select-list"),this.scrollDropdown(n,t)):this.resetSetTimeTitle(a)}},{key:"clearSetTimeTitle",value:function(){Object(y.$)(".set-time .reminder-popover-select div[data-sel=spark-select-title]").html("")}},{key:"resetSetTimeTitle",value:function(e){var t=Object(y.$)(".set-time .reminder-popover-select div[data-sel=spark-select-title]");t.html()||t.html(e)}},{key:"handleSetTimeSearch",value:function(e){var t=e.target.value;e.target.value=Object(O.a)(t),e.target.focus(),e.target.value||this.setSetTimeSelectColor(T)}},{key:"handleSetTimeKeyDown",value:function(e){var t;"Enter"===e.key&&(t=e.target.value,this.insertSetTime(t),this.setSetTimeSelectColor(S))}},{key:"handleSetTimeBlur",value:function(){var e,t=document.querySelector(".reminder-popover-select input");t&&(e=t.getAttribute("value"),this.insertSetTime(e),this.setSetTimeSelectColor(S))}},{key:"handleNotifyTimeChange",value:function(e){var t=e.value;this.props.onChange(Object.assign({},this.props,{jetLag:Number(t)}))}},{key:"handleNotifyTimeOpen",value:function(e){var t,n,i,r,o;e&&(n=(t=this.props).jetLagList,i=t.jetLag,r=this.getCurrentItemIndex(n,i),o=document.querySelector(".jet-lag .reminder-popover-select-list"),this.scrollDropdown(o,r))}},{key:"renderSetTime",value:function(){var e=this.props,t=e.isWholeDay,n=e.setTime,i=e.setTimeList,r=!0;return p.a.createElement("div",{className:"option-row set-time"},p.a.createElement(m.a,{className:"reminder-popover-checkbox-label",checked:!t,onChange:this.handleSetTimeCheckboxClick},o("reminder.popover.setTime")),!t&&p.a.createElement(v.Select,{key:"setTime",searchable:r,className:"reminder-popover-select",listClassName:"reminder-popover-select-list",value:n.toString(),zIndex:2061,getContainer:function(){return Object(y.$)(".set-time .reminder-popover-select")[0]},onOptionClick:this.handleSetTimeOptionClick,onOpenChange:this.handleSetTimeOpen,onSearch:this.handleSetTimeSearch,onKeyDown:this.handleSetTimeKeyDown,onBlur:this.handleSetTimeBlur},i.map(function(e){return p.a.createElement(k,{value:e.value.toString(),key:e.text},e.text)})))}},{key:"renderNotifyTime",value:function(){var e=this.props,t=e.isShowNotify,n=e.shouldNotify,i=e.jetLag,r=e.jetLagList;return t?p.a.createElement("div",{className:"option-row jet-lag"},p.a.createElement(m.a,{className:"reminder-popover-checkbox-label",checked:n,onChange:this.handleNotifyCheckboxClick},o("reminder.popover.notifyTime")),n&&p.a.createElement(v.Select,{key:"jetLag",className:"reminder-popover-select",listClassName:"reminder-popover-select-list",value:i.toString(),zIndex:2061,getContainer:function(){return Object(y.$)(".jet-lag .reminder-popover-select")[0]},onChange:this.handleNotifyTimeChange,onOpenChange:this.handleNotifyTimeOpen},r.map(function(e){return p.a.createElement(k,{value:e.value.toString(),key:e.text},e.text)}))):null}},{key:"render",value:function(){return p.a.createElement("div",{className:"reminder-popover-option-wrapper"},this.renderSetTime(),this.renderNotifyTime())}}]),t}(p.a.Component);C([Object(g.Bind)()],_.prototype,"handleSetTimeCheckboxClick",null),C([Object(g.Bind)()],_.prototype,"handleNotifyCheckboxClick",null),C([Object(g.Bind)()],_.prototype,"handleSetTimeOptionClick",null),C([Object(g.Bind)()],_.prototype,"handleSetTimeOpen",null),C([Object(g.Bind)()],_.prototype,"handleSetTimeSearch",null),C([Object(g.Bind)()],_.prototype,"handleSetTimeKeyDown",null),C([Object(g.Bind)()],_.prototype,"handleSetTimeBlur",null),C([Object(g.Bind)()],_.prototype,"handleNotifyTimeChange",null),C([Object(g.Bind)()],_.prototype,"handleNotifyTimeOpen",null),w.a=_}).call(this,j("2vAP"))},Nl7c:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var i=n("FJEn");function c(e,t){return e===i.DEFAULT_REP_ZONE&&0===t}function r(){var s=this;return function(e,t,n){var a=n.value;return a instanceof Function&&(n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0],r=i.zoneId,o=i.children;return c(r,i.index)?o:a.apply(s,t)}),n}}function o(){var o=this;return function(e,t,n){var r=n.value;return r instanceof Function&&(n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0].lineState;return c(i.getZoneId(),i.index)?null:r.apply(o,t)}),n}}},NltJ:function(e,t,n){"use strict";n.d(t,"g",function(){return f}),n.d(t,"q",function(){return I}),n.d(t,"l",function(){return S}),n.d(t,"k",function(){return T}),n.d(t,"d",function(){return _}),n.d(t,"f",function(){return M}),n.d(t,"j",function(){return P}),n.d(t,"h",function(){return B}),n.d(t,"m",function(){return U}),n.d(t,"o",function(){return z}),n.d(t,"e",function(){return H}),n.d(t,"i",function(){return F}),n.d(t,"a",function(){return V}),n.d(t,"p",function(){return W}),n.d(t,"n",function(){return K}),n.d(t,"b",function(){return q}),n.d(t,"c",function(){return Y});var i=n("RIqP"),L=n.n(i),r=n("J4zp"),p=n.n(r),o=n("Muja"),O=n("lCmp"),R=n("owWc"),N=n("uQON"),D=n("VI6H"),a=n("peh1"),s=n("94ch"),c=n("ZGZ5"),l=n("vc5i"),x=n("Ux/T"),C=n("QM+C"),u=n("hVE6"),d=n("m1/u"),h=function(e){var t=Object(l.o)(e),n=C.NUM_SUITE_TYPE_TO_SUITE_ENGINE_TYPE[t];if(n===C.SUITE_ENGINE_TYPE.FILE&&Object(u.j)(e))return"history"},f=function(e){return e.appState.commentReaction},g=function(e){return e.appState.commentReactionLoadStatus},m=Object(a.createSelector)(function(e){return g(e)},function(e){return Object(l.n)(e)},function(e){return Object(l.o)(e)},function(e,t,n){return!0===e.get("".concat(n,":").concat(t))});function b(e,t,n){if(0<e.size){var i=!0,r=!1,o=void 0;try{for(var a,s=e.values()[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,l=c.commentId,u=c.replyId;if(l&&u&&l===t&&u===n)return{message_id:c.messageId,related:c.related,status:c.status}}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}return null}function v(n,e,i){return null!==e&&null!==i&&e.length===i.length&&e.every(function(e,t){return n(e,i[t])})}function y(r,o,a){var s=null,c=null;return function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return v(o,s,n)||(e=r.apply(void 0,n),c=a(c,e)),s=n,c}}function E(t,n){return Object.keys(t).length===Object.keys(n).length&&Object.keys(t).every(function(e){return"selfAsList"===e||("error"===e||"extra"===e?Object(o.default)(t[e],n[e]):"entities"===e?t.entities.users===n.entities.users:t[e]===n[e])})}var k=Object(a.createSelectorCreator)(y,function(e,t){return e===t},function(e,t){if(null===e||null===t)return t;var n=new Map(e.map(function(e){return[e.reply_id,e]})),i=!1,r=t.map(function(e){if(n.has(e.reply_id)){var t=n.get(e.reply_id);if(E(t,e))return t}return i=!0,e});return e.length===t.length&&!i?e:r}),I=function(e){return e.appState.messageData},S=k(function(e){return e.appState.commentData},function(e){return e.appState.messageData},function(e){return f(e)},function(e){return m(e)},function(e){return Object(s.a)(e)},function(e){return Object(l.n)(e)},function(e){return Object(l.o)(e)},function(e,d,h,t,f,n,i){if(!t)return[];var r=e[Object(x.b)(i,n)];return r?Object.entries(r).filter(function(e){var t=p()(e,2)[1],n=t.finish;return t.isWhole&&!n}).map(function(e){var t=p()(e,2),n=t[0],i=t[1],r=p()(i.commentList,1)[0],o=i.isWhole,a=r.replyId,s=r.deleted,c=r.userId;if(s||!f.get(c))return null;var l=Object(N.m)(r,f),u=Object.assign({isWhole:o},l,{},b(d,n,a),{reactions:h.get(a),commentId:n});return u.selfAsList=[u],u}).filter(function(e){return null!==e}).sort(function(e,t){return e.time-t.time}):[]}),T=function(e){return!0},_=Object(a.createSelector)(c.a,function(e){return{name:e.get("name"),avatar_url:e.get("avatar_url"),user_id:e.get("id")}}),w=function(e){return e.appState.commentPosition},j=Object(a.createSelector)(w,l.n,l.o,h,function(e,t,n,i){return e[Object(x.b)(n,t,i)]}),M=Object(a.createSelector)(function(e){return j(e)},function(e){return e&&e.positions?e.positions:[]}),P=Object(a.createSelector)(function(e){return j(e)},function(e){return e&&e.positions?e.positions.map(function(e){var t=e.commentId,n=e.context,i=e.visible,r=n.isSubmitted,o=n.quote,a=n.line;return{commentId:t,isSubmitted:r,quote:o,serviceToken:n.serviceToken,serviceType:n.serviceType,line:a,top:n.top,visible:i}}).filter(function(e){return void 0!==e.commentId}):[]}),B=Object(a.createSelector)(function(e){return j(e)},function(e){return!!e&&!0===e.shown}),U=Object(a.createSelector)(function(e){return j(e)},function(e){return!!e&&!0===e.isLoaded}),z=Object(a.createSelector)(function(e){return Object(d.a)("messages")(e)===C.StatusMap.loaded},function(e){return Object(d.a)("comments")(e)===C.StatusMap.loaded},function(e){return m(e)},function(e){return U(e)},function(e,t,n,i){return(C.isAnonymousAccess||e)&&t&&n&&i}),H=Object(a.createSelector)(function(e){return F(e)},function(e){var d={};return e.forEach(function(e){var t,n,i,r,o,a=e.comment_list,s=e.comment_id,c=e.context,l=c.top,u=c.line;l&&(i=void 0===(n=(t=d[l]||{}).commentIds)?[]:n,0<(o=(void 0===(r=t.listCount)?0:r)+a.length)&&(99<o&&(o="99+"),d[l]={commentIds:i.concat(s),listCount:o,line:u}))}),d}),F=(Object(a.createSelector)(function(e){return Object(d.a)("messages")(e)===C.StatusMap.loaded},function(e){return Object(d.a)("comments")(e)===C.StatusMap.loaded},function(e){return m(e)},function(e,t,n){return e&&t&&n}),Object(a.createSelector)(function(e){return e.appState.commentData},function(e){return e.appState.messageData},function(e){return M(e)},function(e){return f(e)},function(e){return m(e)},function(e){return Object(s.a)(e)},function(e){return Object(l.n)(e)},function(e){return Object(l.o)(e)},function(e,s,t,c,n,l,i,r,o){if(!n||0===t.length)return[];var u=e[Object(x.b)(r,i,o)];return Object(R.a)(t,function(e,t){var a=t.commentId,n=t.context,i=t.visible;if(!u||!u[a])return e;var r=u[a];if(r.finish)return e;var o=Object(R.a)([].concat(r.commentList),function(e,t){var n=t.replyId,i=t.deleted,r=t.userId;if(i||!l.get(r))return e;var o=Object(N.m)(t,l);return e.push(Object.assign({},o,{},b(s,a,n),{reactions:c.get(n)})),e},[]);return 0!==o.length||r.unSubmitComment?e.push(Object.assign({},Object(N.a)(r),{comment_list:o,comment_id:a,context:n,visible:i})):console.error("no commentList data found",t),e},[])})),V=Object(a.createSelector)(function(e){return e.appState.commentData},function(e){return Object(l.n)(e)},function(e){return Object(l.o)(e)},function(e,t,n){return e[Object(x.b)(n,t)]}),W=Object(a.createSelector)(function(e){return e.appState.commentData},function(e){return e.appState.messageData},function(e){return M(e)},function(e){return f(e)},function(e){return m(e)},function(e){return Object(s.a)(e)},function(e){return Object(l.n)(e)},function(e){return Object(l.o)(e)},function(e,p,t,g,n,m,i,r,o){if(!n||0===t.length)return[];var v=e[Object(x.b)(r,i,o)];return Object(R.a)(t,function(e,t){var a=t.commentId,n=t.visible,i=t.context,r=i.serviceType,o=i.serviceToken,s=i.top,c=i.isSubmitted,l=i.quote,u=i.line;if(!v||!v[a])return e;var d=v[a];if(d.finish)return e;var h=d.isWhole,f=Object(R.a)([].concat(d.commentList),function(e,t){var n=t.replyId,i=t.deleted,r=t.userId;if(i||!m.get(r))return e;var o=Object(N.m)(t,m);return e.push(Object.assign({isWhole:h},o,{},b(p,a,n),{reactions:g.get(n)})),e},[]);return 0===f.length&&c?console.error("no commentList data found",t):(l&&(d.quote=l),e.push(Object.assign({},Object(N.a)(d,c),{comment_list:f,serviceType:r,serviceToken:o,commentId:"".concat(r,":").concat(o,":").concat(a),top:s,visible:n,line:u}))),e},[])}),K=(Object(a.createSelector)(function(e){return e.appState.notification.messages},function(e){return _(e)},function(e,t){var n=[],i=t.user_id||"",r=0;if(0<e.size){var o=!0,a=!1,s=void 0;try{for(var c,l=e.values()[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=c.value;"MESSAGE_CARD"!==u.type&&u.userId===i||(n.push(u),1===u.status&&r++)}}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}}return{notifications:[].concat(n).sort(function(e,t){return t.createTime-e.createTime}),thisDocUnReadBadge:r}}),Object(a.createSelector)(function(e){return Z(e)},function(e){return Object(d.a)("comments")(e)===C.StatusMap.loaded},function(e){return Object(d.a)("messages")(e)===C.StatusMap.loaded},function(e){return m(e)},function(e){return U(e)},function(e,t,n,i,r){return t&&n&&i&&(0===e.length||r)})),Z=Object(a.createSelector)(function(e){return e.appState.commentData},function(e){return Object(l.n)(e)},function(e){return Object(l.o)(e)},function(e){return h(e)},function(e,t,n,i){var r=e[Object(x.b)(n,t,i)];return r?Object.entries(r).filter(function(e){var t=p()(e,2),n=(t[0],t[1]);return!n.isWhole&&!n.finish}):[]}),q=(Object(a.createSelector)(function(e){return e.appState.commentData},function(e){return e.appState.messageData},function(e){return e.appState.messagePosition},function(e){return f(e)},function(e){return Object(s.a)(e)},function(e){return e.appState.newOldMessage},function(e){return Object(l.n)(e)},function(e){return Object(l.o)(e)},function(e){return _(e)},function(e,O,t,C,k,n,i,r,o){var a=e["".concat(r,"-").concat(i)];if(0===O.size)return[];var s,c,I=o.user_id||"",p=t.position,g=t.isInit,l=[],u=n.mention,d=n.comment,h=function(e){var t=e.comment,b=e.commentId,n=e.serviceType,i=e.serviceToken,r=e.isSubmitted,o=t.commentList,y=!1,E=!1,a=Object(R.a)([].concat(o),function(e,t){var n=t.replyId,i=t.deleted,r=t.userId;if(i||!k.get(r))return e;var o=Object(N.m)(t,k);if(0<O.size){var a,s=!0,c=!1,l=void 0;try{for(var u,d=O.values()[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var h=u.value,f=h.commentId,p=h.replyId;if(f&&p&&f===b&&p===n){a=h;break}}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}if(a){var g=a.messageId,m=a.related,v=a.status;return 1===a.initStatus&&m&&(y=!0),m&&r!==I&&(E=!0),e.push(Object.assign({},o,{message_id:g,related:m,status:v,reactions:C.get(n)})),e}}return e.push(Object.assign({},o,{reactions:C.get(n)})),e},[]);if(0===a.length&&r)return console.error("no commentList data found",t),null;var s,c,l=!0;if((c=t.isWhole?o.every(function(e){return e.deleted}):(l=(s=p.find(function(e){return e.commentId===b}))?!1!==s.visible:!g,!!g&&!s),E)&&(!c&&!t.finish||y))return Object.assign({},Object(N.a)(t),{updateTime:d[b]||t.updateTimestamp,comment_list:a,serviceType:n,isNew:y,isRelated:E,serviceToken:i,isSubmitted:r,isDeleted:c,comment_id:b,type:t.isWhole?"MESSAGE_WHOLE_COMMENT":"MESSAGE_DOC_COMMENT",visible:l});return null},f=function(h){var f=[];if(0<O.size){var e=[],t=!0,n=!1,i=void 0;try{for(var r,o=O.values()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=a.mentionId,c=a.type;if(s&&s===h){e.push(a);break}h||"MESSAGE_DOC_SHARE"!==c||e.push(a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}0<e.length&&e.forEach(function(e){var t,n,i,r,o,a=e.status,s=e.initStatus,c=e.userId,l=e.type,u=1===s,d=k.get(c);if(!d)return null;"MESSAGE_DOC_SHARE"!==l?(n=!0,n=(t=p.find(function(e){return e.mentionId===h}))?!1!==t.visible:!g,(i=!!g&&!t)&&!u||(r={type:e.type,mention_id:e.mentionId,message_id:e.messageId,isNew:u,status:a,isDeleted:i,name:Object(D.o)(c),user_id:e.userId,create_time:e.createTime,create_timestamp:e.createTime,updateTime:e.createTime,avatar_url:d.avatar_url,visible:n,extra:e.extra,isHaveBeenSetPosition:!!t},f.push(r))):(o={type:e.type,message_id:e.messageId,isNew:u,status:a,name:Object(D.o)(c),user_id:e.userId,create_time:e.createTime,create_timestamp:e.createTime,updateTime:e.createTime,avatar_url:d.avatar_url},f.push(o))})}return f},m=f();for(s in 0<m.length&&l.push.apply(l,L()(m)),u){var v=f(s);0<v.length&&l.push.apply(l,L()(v))}for(c in d){if(!a)break;var b,y,E=a[c];E&&((y=h({comment:E,commentId:c,serviceType:(b=Object(x.a)(E,r,i)).serviceType,serviceToken:b.serviceToken,isSubmitted:!0}))&&l.push(y))}if(0<O.size){var S=!0,T=!1,_=void 0;try{for(var w,j=O.values()[Symbol.iterator]();!(S=(w=j.next()).done);S=!0){var M=w.value;"MESSAGE_CARD"===M.type&&l.push(M)}}catch(e){T=!0,_=e}finally{try{S||null==j.return||j.return()}finally{if(T)throw _}}}return[].concat(l).sort(function(e,t){return t.updateTime-e.updateTime})}),Object(a.createSelector)(function(e){return e.appState.commentData},function(e){return e.appState.messageData},function(e){return Object(l.n)(e)},function(e){return Object(l.o)(e)},function(e,t,n,i){var o=new Map,r=e["".concat(i,"-").concat(n)];if(!r)return o;var a=new Map;return Object.entries(r).forEach(function(e){var t=p()(e,2),n=t[0],i=t[1],r=i.finish,o=i.isWhole;r||i.commentList.forEach(function(e){var t=e.replyId;a.set(t,{commentId:n,isWhole:Boolean(o),replyId:t})})}),t.forEach(function(e,t){var n,i=e.replyId,r=e.type;"MESSAGE_DOC_COMMENT"!==r&&"MESSAGE_WHOLE_COMMENT"!==r||(n=a.get(i))&&o.set(t,n)}),o})),Y=Object(a.createSelector)(function(e){return e.appState.commentData},function(e){return M(e)},function(e){return Object(s.a)(e)},function(e){return e.appState.commentLoadStatus},function(e){return Object(l.n)(e)},function(e){return Object(l.o)(e)},function(e){return h(e)},function(e,p,g,m,v,b,t){if(0===Object.keys(e).length)return[];var n,y=e[Object(x.b)(b,v,t)],E=[],i=function(t){var e,n,i,r,o,a,s,c,l,u=y[t],d=u.finish,h=u.isWhole,f=u.commentList;b===C.NUM_FILE_TYPE.DOC?p.find(function(e){return e.commentId===t})||(i=n=e=!1,o=(r=Object(x.a)(u,b,v)).serviceType,a=r.serviceToken,s="".concat(o,"-").concat(a),d?(e=!0,h||(i=m[s])):h||(n=Object(O.a)(f,function(e){return!e.deleted})),(e||n)&&f&&(c=f.map(function(e){var t=e.userId;return g.get(t)?Object(N.m)(e,g):e}),E.push(Object.assign({},Object(N.a)(u),{comment_list:c,comment_id:t,is_whole:h,isLoading:i})))):b!==C.NUM_FILE_TYPE.SHEET&&b!==C.NUM_FILE_TYPE.FILE||d&&f&&(l=f.map(function(e){var t=e.userId;return g.get(t)?Object(N.m)(e,g):e}),E.push(Object.assign({},Object(N.a)(u),{comment_list:l,comment_id:t,is_whole:h,isLoading:!1})))};for(n in y)i(n);return E.sort(function(e,t){return t.finish_timestamp-e.finish_timestamp})})},Np3H:function(e,t,n){"use strict";n.d(t,"e",function(){return g}),n.d(t,"b",function(){return m}),n.d(t,"a",function(){return v}),n.d(t,"d",function(){return b}),n.d(t,"c",function(){return y});var i=n("D7h9"),r=n("vc5i"),o=n("rLED"),a=n("5dbN"),s=n("skFV"),c=n("VI6H"),l=n("AH9Y"),u=n("SGN9"),d=n("n3ZB"),h=n("G8Hj");function f(){return Object(a.locateRoute)().isDoc}function p(){return Object(a.locateRoute)().isWikiIndex}function g(){return!0===l.a.getPreferenceStatus()}function m(){var e=Object(d.i)(i.default.getState());return Object(u.n)(e,h.STEP_TYPES.doc_view_editors_guide)}function v(){return!Object(c.e)()&&Object(o.o)()&&(f()||p()&&Object(s.v)())}function b(){return v()&&!!y()}function y(){var e=i.default.getState(),t=Object(r.f)(e);if(t){var n=t.get("create_time");return Object(o.M)("doc_view_editors_limit_time",0)<1e3*n}}},"Ns/6":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return a});var i=n("toa8");n("AiBH"),n("jp/M");function r(e){var t="/api/mention/notify/";return i.d.post(t,e,{headers:{"Content-Type":"application/json","Cache-Control":"no-cache,no-store"}})}function o(e){var t="/api/mention/notification/";return i.d.post(t,e,{headers:{"Content-Type":"application/json","Cache-Control":"no-cache,no-store"}})}function a(e){return i.d.post("/api/mention/unnotify/",e)}},NtTV:function(e,t,n){"use strict";var r,i;function l(e){return e?null!=e.info?e:null!=e.code?{info:"code: ".concat(e.code)}:e.toString?{info:e.toString()}:{}:{}}function u(e){if(!e)return"unknown";if(e.specialSuite){var t=e.info;return"SpecialSuite-".concat(t.code)}return e.info}(i=r=r||{}).init="init",i.opened="opened",i.loaded="loaded",i.cancelled="cancelled";var o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),d=n("sLU5"),h=n("OX8E"),f=n("093l"),p=n("Ibn6"),g=n("bdgK"),m=n("ifKl"),v=n("4TP3"),b=n("TGBA"),y=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5;a()(this,t),this.runningPool={},this.currentRunningSize=0,this.waitingQueue=[],this.maxRunningSize=e}return c()(t,[{key:"addTask",value:function(e){this.currentRunningSize<this.maxRunningSize?this.runTask(e):this.waitTask(e)}},{key:"runTask",value:function(e){var t=this,n=function(){t.onFinishRunningTask(e.id)};e.onLoad=n,e.onCancel=n,this.currentRunningSize++,(this.runningPool[e.id]=e).send()}},{key:"waitTask",value:function(e){var t=this;e.onCancel=function(){t.onFinishWaitingTask(e)},this.waitingQueue.push(e)}},{key:"onFinishRunningTask",value:function(e){delete this.runningPool[e],this.currentRunningSize--;var t=this.waitingQueue.shift();t&&this.runTask(t)}},{key:"onFinishWaitingTask",value:function(e){Object(v.a)(this.waitingQueue,e)}},{key:"removeAllTasks",value:function(){var t=this;0<this.waitingQueue.length&&(this.waitingQueue.forEach(function(e){e.onCancel=m.default,e.cancel()}),this.waitingQueue.length=0),0<this.currentRunningSize&&Object(b.a)(this.runningPool).forEach(function(e){e.onCancel=m.default,e.onLoad=m.default,e.cancel(),delete t.runningPool[e.id],t.currentRunningSize--})}}]),t}(),E=n("o0o1"),O=n.n(E),C=n("lSNA"),k=n.n(C),I=n("yXPU"),S=n.n(I),T=n("Olm7"),_=n("jp/M"),w=n("toa8"),j=n("3doy"),M=function(){function e(){var t=this;a()(this,e),this.sendDatas={},this.responses={},this.getResponsePromiseCallbacks={},this.fetchs=[],this.timer=null,this.sendRequests=function(){t.timer=null;var e=Object.values(t.sendDatas).map(function(e){return t.convertSendDataToRequestSendData(e)});t.sendDatas={},t.doSendRequests(e)}}function t(e){return n.apply(this,arguments)}var n;return c()(e,[{key:"addRequest",value:function(e){var t=e.token;this.responses[t]||this.isCurrentTokenInRequest(t)||(this.sendDatas[t]=e,this.timer&&window.clearTimeout(this.timer),this.timer=window.setTimeout(this.sendRequests,100))}},{key:"getResponse",value:function(i){var r=this,e=new Promise(function(e,t){var n=r.responses[i.token];n?n.isSuccess?e(n.data):t():r.isCurrentTokenInRequest(i.token)?r.getResponsePromiseCallbacks[i.token]={resolve:e,reject:t}:(r.getResponsePromiseCallbacks[i.token]={resolve:e,reject:t},r.doSendRequests([r.convertSendDataToRequestSendData(i)]))});return e.abort=function(){var e=r.getResponsePromiseCallbacks[i.token];e&&(e.reject(),delete r.getResponsePromiseCallbacks[i.token])},e}},{key:"doSendRequests",value:(n=S()(O.a.mark(function e(t){var n,i,r,o=this;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(w.d)({url:_.apiUrls.POST_FILE_CDN_URL,method:_.apiUrls.METHOD.POST,headers:{"Content-Type":"application/json"},data:t}),this.fetchs.push({fetch:n,tokens:t.reduce(function(e,t){return Object.assign({},e,k()({},t.file_token,!0))},{})}),e.prev=2,e.next=5,n;case 5:i=e.sent,r={},i&&i.data&&i.data.forEach(function(e){r[e.file_token]=e}),t.forEach(function(e){var t=e.file_token,n=r[t];o.responses[t]={data:n,isSuccess:Boolean(n)};var i=o.getResponsePromiseCallbacks[t];i&&(n?i.resolve(n):i.reject(),delete o.getResponsePromiseCallbacks[t])}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:return e.prev=13,Object(T.a)(this.fetchs,function(e){return e.fetch===n}),e.finish(13);case 16:case"end":return e.stop()}},e,this,[[2,11,13,16]])})),t)},{key:"convertSendDataToRequestSendData",value:function(e){return{file_token:e.token,width:e.width,height:e.height,policy:j.PostFileCdnUrlPolicy.allow_up}}},{key:"isCurrentTokenInRequest",value:function(t){return Boolean(this.sendDatas[t]||this.fetchs.find(function(e){return e.tokens[t]}))}},{key:"reset",value:function(){this.fetchs.forEach(function(e){e.fetch.abort()}),this.fetchs=[],this.sendDatas={},this.responses={},this.timer&&window.clearTimeout(this.timer)}}]),e}(),L=n("AYG9");function R(e,t){var n="function"==typeof e?e():e;return void 0!==n?n:t}var N="client_grid_view_scroll",D=function(){function r(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a()(this,r),this.isStoppedFetchImgSrc=!1,this.viewportParam={},this.scrollEvent=d.a.PC.DRIVE.GridView.gridScroll,this.resizeEvent=d.a.PC.DRIVE.GridView.gridResize,this.onResizeEnd=function(){n.isStoppedFetchImgSrc=!1,h.a.emit(n.resizeEvent)},this.onScrollEnd=function(){n.isStoppedFetchImgSrc=!1,h.a.emit(n.scrollEvent),Object(L.c)(N)},this.onScrollStart=function(){n.isStoppedFetchImgSrc=!0,n.fetchImgSrcTaskQueue.removeAllTasks(),Object(L.b)(N)},this.onResizeStart=function(){n.isStoppedFetchImgSrc=!0,n.fetchImgSrcTaskQueue.removeAllTasks(),n.parallelRequestKeyManager.reset()},this.toggleBindEvent=function(e,t){t?n.bindEvent(e):n.unbindEvent()};var t=e.scrollEvent,i=e.resizeEvent;this.fetchImgSrcTaskQueue=new y,this.parallelRequestKeyManager=new M,t&&(this.scrollEvent=t),i&&(this.resizeEvent=i)}return c()(r,[{key:"bindEvent",value:function(e){this.resizeEventRemover=this.detectResizeEvent(e,this.onResizeStart,this.onResizeEnd),this.scrollEventRemover=this.detectScrollEvent(e,this.onScrollStart,this.onScrollEnd)}},{key:"unbindEvent",value:function(){this.resizeEventRemover&&this.resizeEventRemover.removeEvent(),this.scrollEventRemover&&this.scrollEventRemover.removeEvent()}},{key:"isInViewport",value:function(e){var t={top:0,bottom:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},n=R(this.viewportParam.top,t.top),i=R(this.viewportParam.bottom,t.bottom),r=e.getBoundingClientRect(),o=r.top;return n<=r.bottom&&o<=i}},{key:"setViewportParam",value:function(e){this.viewportParam=e}},{key:"removeAllTasks",value:function(){this.fetchImgSrcTaskQueue.removeAllTasks(),this.parallelRequestKeyManager.reset()}},{key:"detectScrollEvent",value:function(e,t,n){var i=new x(t,n);return e.addEventListener("scroll",i.handleEvent,!!p.a&&{passive:!0}),{removeEvent:function(){i.destroyEvent(),e.removeEventListener("scroll",i.handleEvent)}}}},{key:"detectResizeEvent",value:function(e,t,n){var i=new x(t,n),r=new g.default(Object(f.a)(i.handleEvent));return r.observe(e),{removeEvent:function(){i.destroyEvent(),r.disconnect()}}}}]),r}(),x=function(){function i(e,t){var n=this;a()(this,i),this.handleEvent=function(){window.clearTimeout(n.isEventProcessing),n.isEventProcessing||n.onStart(),n.isEventProcessing=window.setTimeout(function(){n.isEventProcessing=void 0,n.onEnd()},200)},this.onStart=e,this.onEnd=t}return c()(i,[{key:"destroyEvent",value:function(){this.isEventProcessing&&window.clearTimeout(this.isEventProcessing)}}]),i}(),P=n("fp5s"),B=n("mbpr"),U=n("lAOT"),z=function(){function e(){var n=this;a()(this,e),this.state=r.init,this.onCancel=m.default,this.onLoad=m.default,this.cancelSource=U.b.source(),this.logger=new B.a,this.wrapWithCancel=function(t){return function(e){if(n.isCancelled())throw new Error;return t(e)}},this.id=Object(P.a)("_FetchImgSrcTask_")}return c()(e,[{key:"setState",value:function(e){this.state=e}},{key:"getLog",value:function(){return this.logger.getLog()}},{key:"isCancelled",value:function(){return this.state===r.cancelled}},{key:"open",value:function(e){var n=this,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return this.sendData=e,this.setState(r.opened),this.logger.logStartTime("display_time_cost"),this.logger.logStartTime("queue_time_cost"),new Promise(function(e,t){n.resolve=e,n.reject=t,i&&n.send()})}},{key:"send",value:function(){var t=this;if(this.state!==r.opened)throw new Error("cannot start fetch when state is not ".concat(r.opened));this.logger.logEndTime("queue_time_cost"),this.logger.logStartTime("request_time_cost"),this.doSend().then(function(e){t.load(e)}).catch(function(e){t.fail(e)})}},{key:"load",value:function(e){this.logger.logEndTime("request_time_cost"),this.logger.logEndTime("display_time_cost"),this.logger.sendLog("client_grid_cover_load"),this.resolve&&this.resolve(e),this.setState(r.loaded),this.onLoad()}},{key:"fail",value:function(e){this.reject&&this.reject(e),e&&Object(U.c)(e)||(this.setState(r.loaded),this.onLoad(),this.logger.logValue("request_img_fail",!0),this.logger.logValue("request_img_fail_reason",u(e)),this.logger.sendLog("client_grid_cover_load"))}},{key:"cancel",value:function(){this.fail(new U.a),this.setState(r.cancelled),this.onCancel(),this.cancelSource.cancel()}}]),e}(),H=n("a1gu"),F=n.n(H),V=n("Nsbk"),W=n.n(V),K=n("7W2i"),Z=n.n(K),q=n("MvBO"),Y=n("VIFs"),J=n("1dfU"),Q=function(e){function t(){var r;return a()(this,t),(r=F()(this,W()(t).apply(this,arguments))).requestCDN=function(e){var t=e.url,n=e.secret,i=e.nonce;return Object(q.a)({url:t.replace("http://","https://"),key:n,iv:i,timeout:3e3,cancelToken:r.cancelSource.token,logger:r.logger}).then(function(e){return{src:e.blobUrl,isIcon:!1}})},r.requestOrigin=function(){var e=Object(Y.prependAPI)("/api/box/stream/download/v2/cover/".concat(r.sendData.token,"?")+"width=".concat(r.sendData.width,"&height=").concat(r.sendData.height,"&policy=").concat(j.PostFileCdnUrlPolicy.allow_up));return Object(q.b)({url:e,cancelToken:r.cancelSource.token,logger:r.logger}).then(function(e){return{src:e.blobUrl,isIcon:!1}})},r}return Z()(t,e),c()(t,[{key:"setParallelRequestKeyManager",value:function(e){this.parallelRequestKeyManager=e}},{key:"doSend",value:function(){var t=this;return this.logger.logValue("source",this.sendData.sourceForLog),this.logger.logValue("file_id",Object(J.a)(this.sendData.token)),this.logger.logValue("file_type",this.sendData.type),this.requestKey().then(this.wrapWithCancel(this.requestCDN)).catch(function(e){if(e&&e.noPermitted)throw e;return t.wrapWithCancel(t.requestOrigin)(e)})}},{key:"requestKey",value:function(){var i=this;this.logger.logValue("request_key_necessary",!0),this.logger.logStartTime("request_key_time_cost");var e=(this.parallelRequestKeyManager||new M).getResponse(this.sendData);return this.cancelSource.token.promise.then(function(){e.abort()}),e.then(function(e){if(i.logger.logEndTime("request_key_time_cost"),e){if(!e.permitted)throw{noPermitted:!0,info:"no permission"};if("0"===e.cipher_type)throw{info:"resp cipher type is 0"};return e}throw{info:"no response"}}).catch(function(e){if(i.isCancelled())throw e;var t=l(e),n=u(t);throw i.logger.logValue("request_key_fail",!0),i.logger.logValue("request_key_fail_reason",n),t})}}]),t}(z),X=n("7EGn"),$=n("AESI"),ee=n("ahx2"),te=n("7/sA"),ne=n("skFV"),ie=function(e){function t(){return a()(this,t),F()(this,W()(t).apply(this,arguments))}function n(e,t,n){return i.apply(this,arguments)}var i,r;function o(){return r.apply(this,arguments)}return Z()(t,e),c()(t,[{key:"transformDevUrl",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return e&&te.a&&/^https?:\/\//.test(e)?e.replace(/^https?:\/\/[^/]+/,ne.a):e}},{key:"doSend",value:(r=S()(O.a.mark(function e(){var t,n,i,r,o,a,s,c;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.sendData,n=t.token,i=t.type,r=t.hash,this.logger.logValue("source",this.sendData.sourceForLog),this.logger.logValue("file_id",Object(J.a)(this.sendData.token)),this.logger.logValue("file_type",this.sendData.type),e.next=6,this.getThumbnail(n,i,r);case 6:return o=e.sent,e.next=9,Object(q.c)({url:o.url,key:o.secret,cancelToken:this.cancelSource.token,logger:this.logger});case 9:return a=e.sent,s=a.blobUrl,c=a.isIcon,e.abrupt("return",{src:s,isIcon:c});case 13:case"end":return e.stop()}},e,this)})),o)},{key:"getThumbnail",value:(i=S()(O.a.mark(function e(t,n,i){var r,o,a,s,c;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.sendData.thumbnail,this.isCorrectThumbnail(r))return e.abrupt("return",Object.assign({},r,{url:this.transformDevUrl(r.url)}));e.next=3;break;case 3:return this.logger.logValue("request_key_necessary",!0),this.logger.logStartTime("request_key_time_cost"),e.prev=5,e.next=8,Object(w.d)({url:$.GET_THUMBNAIL_URL,method:"GET",params:Object.assign({obj_type:n,obj_token:t},i?{hash:i}:null)});case 8:if(o=e.sent,this.logger.logEndTime("request_key_time_cost"),a={url:this.transformDevUrl(Object(X.default)(o,"data.url")),secret:Object(X.default)(o,"data.decrypt_key")},this.isCorrectThumbnail(a)){e.next=13;break}throw new Error("thumbnail info error");case 13:return e.abrupt("return",a);case 16:throw e.prev=16,e.t0=e.catch(5),e.t0&&e.t0.code===ee.STATUS_CODE.FORBIDDEN&&(e.t0={noPermitted:!0,info:"no permission"}),s=l(e.t0),c=u(s),this.logger.logValue("request_key_fail",!0),this.logger.logValue("request_key_fail_reason",c),s;case 24:case"end":return e.stop()}},e,this,[[5,16]])})),n)},{key:"isCorrectThumbnail",value:function(e){return Boolean(e&&e.url&&e.secret)}}]),t}(z),re=n("QM+C"),oe=function(e){var t,n,i,r=e.sourceForLog,o=e.fileToken,a=e.fileType,s=e.clientHeight,c=e.clientWidth,l=e.thumbnail,u=e.fetchImgSrcManager,d=e.hash,h=a===re.NUM_SUITE_TYPE.FILE?(t={sourceForLog:r,token:o,type:a,width:c,height:s},i=new Q,u&&((n=u.parallelRequestKeyManager).addRequest(t),i.setParallelRequestKeyManager(n)),i.open(t,!1)):(i=new ie).open(Object.assign({sourceForLog:r,token:o,type:a,thumbnail:l},d?{hash:d}:null),!1);u?u.fetchImgSrcTaskQueue.addTask(i):i.send();var f=h;return f.task=i,f};n.d(t,"e",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"b",function(){return D}),n.d(t,"c",function(){return y}),n.d(t,"a",function(){return z}),n.d(t,"d",function(){return oe})},Nv5K:function(e,t,n){"use strict";var i,r;(r=i=i||{}).TextInputTime="TextInputTime",r.ScrollFps="ScrollFps",r.Delete="Delete",r.Undo="Undo",r.Redo="Redo",r.Indent="Indent",r.ViewportObserver="ViewportObserver",r.DocPosition="DocPosition",r.Rect="Rect",r.Range="Range",r.CursorTrack="CursorTrack",r.AttributePositionManager="AttributePositionManager",r.WordCopySupport="WordCopySupport",r.TencentDocCopySupport="TencentDocCopySupport",r.GDCopySupport="GDCopySupport",r.OneNoteCopySupport="OneNoteCopySupport",r.OneDriveWordCopySupport="OneDriveWordCopySupport",r.EditorCopy="EditorCopy",r.Align="Align",r.Author="Author",r.Line="Line",r.PCHeadings="PCHeadings",r.Heading="Heading",r.Horizontal="Horizontal",r.ShortKeyTea="ShortKeyTea",r.HyperLinks="HyperLinks",r.HyperLinksRemoveLink="HyperLinksRemoveLink",r.HyperLinksBackground="HyperLinksBackground",r.Simpletags="Simpletags",r.Image="Image",r.Quote="Quote",r.TabKey="TabKey",r.PCList="PCList",r.Table="Table",r.CommentPlugin="CommentPlugin",r.Bold="Bold",r.Italic="Italic",r.Underline="Underline",r.Strikethrough="Strikethrough",r.Sheet="Sheet",r.Bitable="Bitable",r.ISVBlock="ISVBlock",r.Mindnote="Mindnote",r.Save="Save",r.DocHistory="DocHistory",r.Checkbox="Checkbox",r.CodeBlock="CodeBlock",r.Markdown="Markdown",r.MobileEditBarStatusManager="MobileEditBarStatusManager",r.EditBarManager="EditBarManager",r.SelectionPopup="SelectionPopup",r.NoteTitlePlugin="NoteTitlePlugin",r.InputCompatible="InputCompatible",r.HighlightColor="HighlightColor",r.InlineCode="InlineCode",r.DriveUpload="DriveUpload",r.ReminderLine="ReminderLine",r.BlockPlugin="BlockPlugin",r.SingleLineManage="SingleLineManage",r.SectionNavPlugin="SectionNavPlugin",r.Rangecode="Rangecode",r.TemplateInline="TemplateInline",r.TemplateBlock="TemplateBlock",r.PlaceHolder="PlaceHolder",r.TemplateWrap="TemplateWrap",r.TemplateAbstract="TemplateAbstract",r.OfflineEditor="OfflineEditor",r.CheckAll="CheckAll",r.EditorCopyStyle="EditorCopyStyle",r.Link2Mention="Link2Mention",r.LinkToBlock="LinkToBlock",r.TripleClick="TripleClick",r.FsController="FsController",r.DocsRenderTime="DocsRenderTime",r.UnsupportFeature="UnsupportedFeature",r.InserDomLineBetweenPicture="InserDomLineBetweenPicture",r.UserChangeTea="UserChangeTea",r.BackBtn="BackBtn",r.LimitEditModeQuantityPlugin="LimitEditModeQuantityPlugin",r.MemoryMonitor="MemoryMonitor",r.SuspensionComment="SuspensionComment",r.FindReplacePlugin="FindReplacePlugin",r.ReminderPlugin="ReminderPlugin",r.FileCardSwitchView="FileCardSwitchView",r.Translate="Translate",r.Placeholder="Placeholder",r.ImageRelayPlugin="ImageRelayPlugin",r.SheetBridgePlugin="SheetBridgePlugin",r.MindnoteBridgePlugin="MindnoteBridgePlugin",r.BitableBridgePlugin="BitableBridgePlugin",r.BlockRenderStatistics="BlockRenderStatistics",r.BlockRenderAutoRender="BlockRenderAutoRender",r.ScrollPosition="ScrollPosition",r.AutoCapitalization="AutoCapitalization",r.AutoSpace="AutoSpace",r.DocDraggable="DocDraggable",r.LoadableInlineDraggable="LoadableInlineDraggable",r.LineMenuOperate="LineMenuOperate",r.LineMenuPollInsert="LineMenuPollInsert",r.LineHover="LineHover",r.GrammarChecker="GrammarChecker",r.SmartCompose="SmartCompose",r.UserChangeDetector="UserChangeDetector",r.ModalSelectAll="ModalSelectAll",r.DocLockerPlugin="DocLockerPlugin",r.DocTimingHooksPlugin="DocTimingHooksPlugin",r.LineGuidMonitor="LineGuidMonitor",r.LastEmptyLinePlaceholder="LastEmptyLinePlaceholder",r.PCDiagram="PCDiagram",r.JumpContent="JumpContent",r.TextNodeDeserializer="TextNodeDeserializer",r.BlockElementDeserializer="BlockElementDeserializer",r.PasteStyleInherit="PasteStyleInherit",r.OpAuthor="OpAuthor",r.CodeBlockV2="CodeBlockV2",r.CodeBlockLineNum="CodeBlockLineNum",r.Callout="Callout",r.PlainTextHandler="PlainTextHandler",r.ContextPreprocess="ContextPreprocess",r.SmartLink="SmartLink",r.AsyncDomLoadingManager="AsyncDomLoadingManager",r.UploadImgOrVideo="UploadImgOrVideo",n.d(t,"a",function(){return i})},Nwwt:function(e,t,n){"use strict";function i(e){return"A"!==e.tagName?"":e.href}t.a=i},NxIb:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("o0o1"),E=n.n(s),c=n("RIqP"),l=n.n(c),u=n("yXPU"),d=n.n(u),h=n("BkRI"),f=n.n(h),p=n("kcif"),g=n.n(p),m=n("mwIZ"),v=n.n(m),b=n("RvHS"),y=n("puQj"),O=n.n(y),C=n("EAIz");function k(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n="";for(e in t)n+="".concat(e,"=").concat(t[e],"&");return n.slice(0,n.length-1)}function I(e){var t=e.cdn_url,n=e.thumbnail_cdn_url,i=e.webp_cdn_url,r=e.webp_thumbnail_cdn_url;return O.a.mobile?r||i:n||t}function S(e){for(var t=e.slice(0,4),t=new Uint8Array(t),n=[],i=0;i<t.byteLength;i++)n.push(t[i].toString(16));return T(n.join("").toUpperCase())}function T(e){switch(e){case"89504E47":return"image/png";case"47494638":return"image/gif";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":case"FFD8FFE2":case"FFD8FFE3":case"FFD8FFE8":return"image/jpeg";case"52494646":return"image/webp";default:return""}}function _(){return crypto&&crypto.subtle}var w=function(){function e(){r()(this,e),this.xhrList=[]}return a()(e,[{key:"fetch",value:function(v,b){var y=this;return new Promise(function(){var t=d()(E.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=b.responseType,i=void 0===n?"":n,r=b.params,o=b.timeout,a=void 0===o?6e4:o,s=b.method,c=void 0===s?"get":s,l=b.withCredentials,u=void 0===l||l,d=new XMLHttpRequest,h=null,"post"===c?(d.open(c,v),d.setRequestHeader("Content-Type","application/json"),h=JSON.stringify(r)):(f=v.split("?"),p=f[0],g=[f[1],k(r)].filter(function(e){return e}).join("&"),d.open(c,"".concat(p).concat(g?"?"+g:""))),m=v.includes("pstatp"),e.t0=!m&&C.e,e.t0)return e.t1=d,e.t2=C.a,e.next=12,Object(C.b)();e.next=14;break;case 12:e.t3=e.sent,e.t1.setRequestHeader.call(e.t1,e.t2,e.t3);case 14:d.responseType=i,d.timeout=a,d.withCredentials=u,d.onreadystatechange=function(){d.readyState===XMLHttpRequest.DONE&&(200===d.status?t({err:!1,data:d.response}):t({err:!0,errorCode:d.status,data:{}}))},d.onerror=function(){t({err:!0,errorCode:d.status,data:{}})},y.xhrList.push(d),d.send(h),e.next=26;break;case 23:e.prev=23,e.t4=e.catch(0),t({err:!0});case 26:case"end":return e.stop()}},e,null,[[0,23]])}));return function(e){return t.apply(this,arguments)}}())}},{key:"abortAll",value:function(){this.xhrList.forEach(function(e){e.readyState!==XMLHttpRequest.DONE&&e.abort()})}}]),e}(),j=n("w+Oj");function M(e){var o=e.data,a=e.key,s=e.algorithm,c=e.iv;return new Promise(function(e,t){var n,i,r;_()&&0<o.byteLength&&a&&0<c.byteLength?(n=L(a),i=new Uint8Array(c),r=new Uint8Array(o),crypto.subtle.importKey("raw",n,s,!1,["decrypt"]).then(function(e){return crypto.subtle.decrypt({name:s,iv:i},e,r)}).then(e).catch(t)):t()})}function L(e){for(var t=j.Base64.atob(e),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.charCodeAt(r);return i}var R=n("SfZW"),N=n("FEfn"),D=null,x={},P=[],B=[],U=5,z={isProcessing:!1,err:!1,displayStatus:{timeOrigin:performance.timeOrigin},priority:b.i.Low},H=new R.a,F=new w;function V(t,n){var i=null,o=new Set,a=new Set;function r(){i=null,o.clear(),a.clear()}function s(e){var t=e.inViewImages,n=void 0===t?[]:t,i=e.nearScreenImages,r=void 0===i?[]:i;n.forEach(function(e){o.add(e.originSrc)}),r.forEach(function(e){o.has(e.originSrc)||a.add(e.originSrc)})}return function(e){s(e),i=i||self.setTimeout(function(){n(Array.from(o),Array.from(a)),r()},t.duration)}}function W(e){return e.filter(function(e){var t=x[e],n=t.fileToken,i=t.driveCdnUrlResult,r=t.isBatchRequestingDriveImgCDNUrl,o=!!n,a=!(i&&i.success||r);return o&&a})}var K=V({duration:10},Z);function Z(e,t){return q.apply(this,arguments)}function q(){return(q=d()(E.a.mark(function e(t,n){var i;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=W([].concat(l()(t),l()(n))),e.next=3,Y(i);case 3:oe([].concat(l()(t),l()(n))),se();case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Y(e){return J.apply(this,arguments)}function J(){return(J=d()(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return ye(t,!0),e.next=3,ve(t);case 3:n=e.sent,ye(t,!1),Ie(n);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Q(e){var t=e.data;switch(e.type){case b.h.FETCH:ee(t),K(t);break;case b.h.Destroy:ne(t)}}function X(e){var t=e.originSrc;t&&!x[t]&&(D=e.pluginId,x[t]=Object.assign(e,f()(z)))}function $(e){var t,n=e.originSrc,i=x[n];i&&(t=v()(e,"coverOptions"),v()(i,"coverOptions.type")!==(t&&t.type)&&Object.assign(i,Object.assign({driveCdnUrlResult:null},e)))}function ee(e){var t=e.inViewImages,n=void 0===t?[]:t,i=e.nearScreenImages,r=void 0===i?[]:i;[].concat(l()(n),l()(r)).forEach(function(e){X(e),$(e)});var o=n.map(function(e){return e.originSrc}),a=r.map(function(e){return e.originSrc});ge(o,b.i.High),ge(a,b.i.Low),te(o)}function te(e){e.map(function(e){x[e]&&!x[e].displayStart&&(x[e].displayStart=Date.now(),H.start("".concat(e,"_queue")))})}function ne(e){e.pluginId===D&&(x={},P=[],B=[],ie(),re(),H.clear())}function ie(){F.abortAll()}function re(){for(var e in x){var t=x[e].blobUrl;t&&URL.revokeObjectURL(t)}}function oe(e){B=ae(B=Array.from(new Set([].concat(l()(B),l()(e)))))}function ae(e){return e.sort(function(e,t){var n=x[e],i=x[t];return n&&i?n.priority<i.priority?-1:1:n?-1:1})}function se(){for(;P.length<U&&0<B.length;){var e,t,n=B.shift(),i=n&&x[n];n&&i&&(e=i.isProcessing,t=ce(i),le(i)&&t?pe(Object.assign(i,{blobUrl:t})):e||(P.push(n),de(n)))}}function ce(e){if(!e)return null;var t=e.coverResultUrl,n=e.originResultUrl;return ue(e)?t:n}function le(e){if(!e)return!1;var t=e.coverResultUrl,n=e.originResultUrl;return ue(e)?!!t:!!n}function ue(e){if(!e)return!1;var t=e.coverOptions;return!!t&&"cover"===t.type}function de(e){var t=x[e];t&&(fe(e),t.isProcessing=!0,new me(t).start().then(he))}function he(e){var t=e.originSrc,n=e.blobUrl,i=P.indexOf(t);P.splice(i,1),se();var r=x[t];ue(r)?e.coverResultUrl=n:e.originResultUrl=n,Object.assign(r,f()(e),{isProcessing:!1}),pe(r)}function fe(e){var t=x[e];t.displayStatus&&t.displayStart&&(t.displayStatus.queue_time_cost=H.end("".concat(e,"_queue")))}function pe(e){_e.onMessage(e)}function ge(e,t){for(var n in e){var i=e[n];x[i]&&(x[i].priority=t)}}var me=function(){function t(e){r()(this,t),this.key=e.key,this.keyUrl=e.keyUrl,this.fileToken=e.fileToken,this.isDriveImg=!!e.fileToken,this.cdnUrl=e.cdnUrl,this.driveFetchCdnUrl=e.driveFetchCdnUrl,this.decryptKey=e.decryptKey,this.originSrc=e.originSrc,this.displayStatus=e.displayStatus,this.coverOptions=e.coverOptions,this.driveCdnUrlResult=e.driveCdnUrlResult}return a()(t,[{key:"start",value:function(){return H.start("".concat(this.originSrc,"_request_until_end")),this.isDriveImg?this.startRequestDriveImg():this.requestDocCDNUrl()}},{key:"startRequestDriveImg",value:function(){return this.driveCdnUrlResult&&this.driveCdnUrlResult.success?this.handleRequestDriveCDNUrlSuccessResult(this.driveCdnUrlResult):this.requestSrc()}},{key:"requestDocCDNUrl",value:function(){var r=this;this.displayStatus.request_key_necessary=!0;var e=this.key,t=this.keyUrl,n={key:e};return H.start("".concat(this.originSrc,"_request_key")),F.fetch(t,{params:n,timeout:b.g}).then(function(e){r.displayStatus.request_key_time_cost=H.end("".concat(r.originSrc,"_request_key"));var t=Object(N.a)(e.data)||{};if(0!==t.code||e.err)return r.displayStatus.request_key_fail=!0,r.requestSrc();var n=I(t.data),i=t.data.decrypt_key;return r.cdnUrl=n,r.decryptKey=i,r.displayStatus.request_key_fail=!1,r.requestCDN()})}},{key:"handleRequestDriveCDNUrlSuccessResult",value:function(e){if(!e.permitted)return this.requestSrc();var t=e.url,n=e.cipher_type,i=e.secret,r=e.nonce;this.cdnUrl=t.replace("http://","https://"),this.decryptKey=i,this.displayStatus.request_key_fail=!1;var o=L(r);this.driveImgDecryptIv=o,this.needDecryptDriveImg=n===b.e.AESGCM;var a=this.needDecryptDriveImg;return this.requestDriveData(a)}},{key:"requestCDN",value:function(){var o=this,e={responseType:"arraybuffer",withCredentials:!1};return this.displayStatus.request_cdn_necessary=!0,H.start("".concat(this.originSrc,"_request_cdn")),F.fetch(this.cdnUrl,e).then(function(e){o.displayStatus.request_cdn_time_cost=H.end("".concat(o.originSrc,"_request_cdn"));var t=e.data,n=e.err;if(!t||n)return o.displayStatus.request_cdn_fail=!0,o.requestSrc();o.displayStatus.request_cdn_fail=!1,o.size=t.byteLength,o.displayStatus.size=o.size;var i=t.slice(0,16),r={data:t.slice(16),key:o.decryptKey,iv:i,algorithm:b.b};return o.decrypt(r)})}},{key:"requestDriveData",value:function(e){var r=this,t={responseType:"arraybuffer",withCredentials:!e};return this.displayStatus.request_cdn_necessary=!0,H.start("".concat(this.originSrc,"_request_cdn")),F.fetch(this.cdnUrl,t).then(function(e){r.displayStatus.request_cdn_time_cost=H.end("".concat(r.originSrc,"_request_cdn"));var t=e.data,n=e.err;if(!t||n)return r.displayStatus.request_cdn_fail=!0,r.requestSrc();if(r.displayStatus.request_cdn_fail=!1,r.size=t.byteLength,r.displayStatus.size=r.size,r.needDecryptDriveImg){var i={data:t,key:r.decryptKey,iv:r.driveImgDecryptIv,algorithm:b.c};return r.decrypt(i)}return r.convertData(t),r.requestEnd()})}},{key:"requestSrc",value:function(){var i=this,e={responseType:"arraybuffer"};return this.displayStatus.request_origin_necessary=!0,H.start("".concat(this.originSrc,"_request_origin")),F.fetch(this.originSrc,e).then(function(e){var t=e.data,n=e.err;return i.displayStatus.request_origin_time_cost=H.end("".concat(i.originSrc,"_request_origin")),!n&&t?(i.size=t.byteLength,i.displayStatus.request_origin_fail=!1,i.convertData(t)):i.displayStatus.request_origin_fail=!0,i.requestEnd()})}},{key:"decrypt",value:function(e){var t=this;return this.displayStatus.decrypt_necessary=!0,H.start("".concat(this.originSrc,"_decrypt")),M(e).then(function(e){return t.displayStatus.decrypt_time_cost=H.end("".concat(t.originSrc,"_decrypt")),t.displayStatus.decrypt_fail=!1,t.convertData(e),t.requestEnd()},function(){return t.displayStatus.decrypt_fail=!0,t.requestSrc()})}},{key:"convertData",value:function(e){if(0<e.byteLength)try{var t=S(e),n=new DataView(e),i=new Blob([n],{type:t||b.d});this.blobUrl=URL.createObjectURL(i),this.mime=t,this.displayStatus.mime_type=t}catch(e){}}},{key:"requestEnd",value:function(){var e=this.originSrc,t=this.blobUrl,n=this.displayStatus,i=this.mime;return n.request_decrypt_time_cost=H.end("".concat(this.originSrc,"_request_until_end")),Promise.resolve({originSrc:e,blobUrl:t,displayStatus:n,mime:i})}}]),t}();function ve(e){return be.apply(this,arguments)}function be(){return(be=d()(E.a.mark(function e(t){var n,i,r,o,a;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.filter(function(e){return x[e]}).map(function(e){return x[e]}),i=g()(n,b.a),r=[],o=0;case 4:if(o<i.length)return e.next=7,Ce(i[o]);e.next=12;break;case 7:a=e.sent,r=r.concat(a);case 9:o++,e.next=4;break;case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ye(e,n){e.forEach(function(e){var t=x[e];t&&(t.isBatchRequestingDriveImgCDNUrl=n)})}function Ee(e){var i=[];return e.forEach(function(e){var t=e.fileToken,n=e.coverOptions;i.push(Object.assign({file_token:t},n))}),i}function Oe(e){return e.driveFetchCdnUrl}function Ce(e){return ke.apply(this,arguments)}function ke(){return(ke=d()(E.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],0<t.length)return i=Ee(t),r=Oe(t[0]),o="".concat(Date.now(),"_batch_request_cdn"),H.start(o),e.prev=6,e.next=9,F.fetch(r,{params:i,method:"post",timeout:b.g});e.next=24;break;case 9:if(a=e.sent,s=H.end(o),c=a.data,l=a.err)throw Error("ajax error");e.next=14;break;case 14:if(u=JSON.parse(c)||{},d=u.code,h=u.data,0!==d||l||t.length!==h.length)throw Error("error from server data");e.next=18;break;case 18:n=h.map(function(e){return Object.assign({success:!0,timeCost:s},e)}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(6),n=t.map(function(e){return{success:!1,file_token:e.fileToken}});case 24:return e.abrupt("return",n);case 25:case"end":return e.stop()}},e,null,[[6,21]])}))).apply(this,arguments)}function Ie(e){e.forEach(function(e){for(var t in x){var n=x[t];n.fileToken===e.file_token&&(n.driveCdnUrlResult=e,n.displayStatus.request_key_necessary=!0,n.displayStatus.request_key_fail=e.success,e.success&&(n.displayStatus.request_key_time_cost=e.timeCost))}})}var Se=[],Te=new(function(){function e(){r()(this,e)}return a()(e,[{key:"postMessage",value:function(e){Q(e)}},{key:"addMessageHandle",value:function(e){Se.push(e)}},{key:"onMessage",value:function(t){Se.forEach(function(e){return e(t)})}},{key:"removeMessageHandle",value:function(e){for(var t=0,n=Se.length;t<n;t++)if(Se[t]===e){Se.splice(t,1);break}}}]),e}()),_e=t.a=Te},NzDz:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i=n("J4zp"),h=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),c=n("cDf5"),l=n.n(c),u=n("xKvl"),d=n("1dfU"),f=n("m3gH"),p=n("lG83"),g=n("fJxK"),m=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};function v(){return f.a.isInFullscreen()?"play_mode_comment":""}var b=function(){function t(e){o()(this,t),this.commentType=e}return s()(t,[{key:"logShowReactionPanel",value:function(){}},{key:"logSelectReaction",value:function(e){}},{key:"logCancelReaction",value:function(e){}},{key:"logShowReactionPage",value:function(e){}},{key:"logShowReactionPageFull",value:function(e){}},{key:"logClientCommentSumbitBox",value:function(e){}},{key:"logClientCommentReplyComment",value:function(e){}},{key:"logClientCommentInputBox",value:function(e){}},{key:"logClientCommentEditComment",value:function(e){}},{key:"logDevCommentEvent",value:function(e){}},{key:"logCommentSubmitSuccess",value:function(e){}},{key:"logSubmitEventError",value:function(e){}},{key:"logClickCommentFinish",value:function(e){}},{key:"logCommentEdit",value:function(e){}},{key:"logCommentEditConfirm",value:function(e){}},{key:"logCommentDelete",value:function(e){}},{key:"logClickCommentInput",value:function(e){}},{key:"getCommentCommonTeaLogData",value:function(e){return Object.assign({comment_type:this.commentType,comment_id:Object(d.a)(e.commentId),reply_id:Object(d.a)(e.replyId)},e.pluginTeaParams)}}]),t}();m([Object(u.a)("client_comment",function(e){return{action:"show_reaction_panel",comment_type:e.context.commentType}})],b.prototype,"logShowReactionPanel",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.reactionKey,a=r.referKey,s=r.commentId;return{action:"select_reaction",comment_id:Object(d.a)(s),reply_id:Object(d.a)(a),comment_type:i.commentType,emoji_type:o}})],b.prototype,"logSelectReaction",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0].reactionKey;return{action:"cancel_reaction",comment_type:i.commentType,emoji_type:r}})],b.prototype,"logCancelReaction",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0].reactionKey;return{action:"show_reaction_page",comment_type:i.commentType,emoji_type:r}})],b.prototype,"logShowReactionPage",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0].reactionKey;return{action:"show_reaction_page_full",comment_type:i.commentType,emoji_type:r}})],b.prototype,"logShowReactionPageFull",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.commentContentType,a=r.source,s=void 0===a?"direct":a,c=r.pluginTeaParams;return Object.assign({},i.getCommentCommonTeaLogData(r),{source:s,action:g.a.SubmitBox,comment_type:i.commentType,comment_content_type:o},c)})],b.prototype,"logClientCommentSumbitBox",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.commentContentType,a=r.source,s=void 0===a?"direct":a,c=r.pluginTeaParams;return Object.assign({},i.getCommentCommonTeaLogData(r),{source:s,action:g.a.ReplyComment,comment_type:i.commentType,comment_content_type:o},c)})],b.prototype,"logClientCommentReplyComment",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.source,a=void 0===o?"direct":o,s=r.pluginTeaParams;return Object.assign({},i.getCommentCommonTeaLogData(r),{action:g.a.InputBox,source:a,comment_type:i.commentType},s)})],b.prototype,"logClientCommentInputBox",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.commentContentType;return Object.assign({},i.getCommentCommonTeaLogData(r),{action:g.a.SubmitEdit,comment_type:i.commentType,comment_content_type:o})})],b.prototype,"logClientCommentEditComment",null),m([Object(u.a)("dev_comment_event",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.commentId,a=void 0===o?"":o,s=r.replyId,c=void 0===s?"":s,l=r.stage,u=r.extra,d=void 0===u?"":u;return Object.assign({},i.getCommentCommonTeaLogData({commentId:a,replyId:c}),{comment_stage:l,comment_extra:d})})],b.prototype,"logDevCommentEvent",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.commentTargetType,a=r.source,s=void 0===a?"direct":a,c=r.pluginTeaParams,l=r.translate_source;return Object.assign({},i.getCommentCommonTeaLogData(r),{action:"submit_comment",status_code:0,status_name:"success",comment_action:"click_submit",is_first:"true",comment_target_type:o,click_comment_submit_source:v(),source:s,zone:Object(p.l)(),translate_source:l},c)})],b.prototype,"logCommentSubmitSuccess",null),m([Object(u.a)("client_comment",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.code,a=r.msg,s=r.pluginTeaParams,c=r.translate_source;return Object.assign({action:"submit_comment",comment_type:i.commentType,status_name:a,status_code:o,zone:Object(p.l)(),translate_source:c},s)})],b.prototype,"logSubmitEventError",null),m([Object(u.a)("click_comment_finish",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.commentId,a=r.pluginTeaParams;return Object.assign({comment_type:i.commentType,comment_id:Object(d.a)(o),click_comment_finish_source:v()},a)})],b.prototype,"logClickCommentFinish",null),m([Object(u.a)("click_comment_edit",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0];return Object.assign({},i.getCommentCommonTeaLogData(r),{translate_source:r.translate_source})})],b.prototype,"logCommentEdit",null),m([Object(u.a)("click_comment_edit_confirm",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0];return i.getCommentCommonTeaLogData(r)})],b.prototype,"logCommentEditConfirm",null),m([Object(u.a)("click_comment_delete",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0];return i.getCommentCommonTeaLogData(r)})],b.prototype,"logCommentDelete",null),m([Object(u.a)("click_comment_input",function(e){var t=e.context,n=e.args,i=t,r=h()(n,1)[0],o=r.isFirst,a=r.pluginTeaParams;return Object.assign({comment_type:i.commentType,comment_action:"click_input",is_first:o?"true":"false"},a)})],b.prototype,"logClickCommentInput",null)},O15b:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r});var i=9,r=30},O9F5:function(e,t,n){"use strict";var i=document.createElement("style");i.type="text/css";var s=document.body.appendChild(i).sheet,c={},r=function(i){var r=-1,o=i instanceof RegExp;return[].find.call(s.cssRules,function(e,t){var n=e.selectorText;return o?!!i.test(n)&&(r=t,!0):n===i&&(r=t,!0)}),r},o=function(e){return-1!==r(e)},a=function(e){return!!e&&!!c[e]},l=function(e,t){var n,i=s.cssRules,r=i.length||0,o=s.insertRule(e,r);!t||(n=i[o])instanceof CSSStyleRule&&(c[t]=n.selectorText)},u=function(){var e=r(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"");-1!==e&&s.deleteRule(e)},d=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=c[e];t&&(u(t),delete c[e])},h=function(e,t){if(e){for(var n=s.cssRules,i=[],r=n.length-1;0<=r;r--){var o,a=n[r];a instanceof CSSStyleRule&&((o=a.selectorText).match(e)&&(i.push(o),s.deleteRule(r)))}t&&i.find(function(e){for(var t in c)if(c[t]===e)return delete c[t],!0;return!1})}};t.a={hasRule:o,hasRuleById:a,insertRule:l,deleteRuleById:d,deleteRulesByRegExp:h,deleteRuleBySelectorText:u}},OCl7:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("2ACu"),s=n("lQZd"),c=n("1dfU"),l=n("NbI8");function i(e,t){var n=e.startTime,i=e.fileToken,r=Object(s.g)(),o=performance.now()-n;Object(a.default)(l.c,{file_token:Object(c.a)(i),page_token:Object(c.a)(r),time_cost:o,status:t?"success":"fail"})}},OIAp:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var i=n("lwsE"),r=n.n(i),o=n("YWBl"),a=n("YNKm"),s=function e(t){var i=this;r()(this,e),this.aceKeyEvent=function(e,t){var n=t.evt;return!(!t.isTypeForSpecialKey||n.shiftKey||!Object(a.hb)(n,a.eb))&&(i.editor.triggerCommand(a.eb),n.preventDefault(),!0)},this.editor=t.editor,this.editor.registerCommand(a.eb,function(e,t){t.doUndoRedo(e),Object(o.a)({action:e})})}},OMpt:function(e,t,n){"use strict";n.d(t,"c",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"a",function(){return g}),n.d(t,"d",function(){return m});var i=n("o0o1"),r=n.n(i),o=n("yXPU"),a=n.n(o),s=n("y2sV"),c=n("j1lG"),l=n("KrGf"),u=n("Z/PY"),d=n("Tqb2"),h=n("FVmk"),f=function(e,t){return[!e&&t===c.D.Drive,t===c.D.External]},p=function(){var n=a()(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.addReminder(),e.prev=1,e.next=4,t();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("[Image Plugin]:",e.t0);case 9:n.removeReminder();case 10:case"end":return e.stop()}},e,null,[[1,6]])}));return function(e,t){return n.apply(this,arguments)}}(),g=function(e){if(!Object(l.b)())return e;var i=!1,t=e.reduce(function(e,t){if(t instanceof s.E){var n=t.reduce(function(e,t){return t.insert&&t.attributes&&t.attributes[c.c]?(i=!0,e):e.push(t)},new s.E({zoneId:t.zoneId}));return e.concat(n)}return e.concat(t)},new s.e);return i&&Object(u.a)(),t},m=function(e,t,n){var i,r,o,a=t.selection.getSelection().start,s=a.line,c=a.zoneId,l=e.get(c);!l||(i=l.ops[l.ops.length-1])&&Object(d.M)(i)&&(r={line:s+1,offset:0,zoneId:c},o={start:Object.assign({},r),end:Object.assign({},r)},t.selection.setSelection(o),Object(h.f)(r,t,n))}},OWch:function(e,t,n){"use strict";function i(e,t,n){var o=n.value;n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0],r=i.children;return i.attributes.lmkr?r:o.apply(this,t)}}n.d(t,"a",function(){return i})},Obi4:function(e,C,k){"use strict";(function(u){k.d(C,"a",function(){return O});var e=k("o0o1"),d=k.n(e),t=k("yXPU"),n=k.n(t),i=k("lwsE"),r=k.n(i),o=k("W8MJ"),a=k.n(o),s=k("7EGn"),c=k("AiBH"),h=k("toa8"),f=k("lQZd"),p=k("HIeq"),l=k("gI2E"),g=k("6jTl"),m=k("n/R6"),v=k("2ACu"),b="/api/image_relay/",y="REQUEST_RELAY_TOAST_KEY",E="client_upload_image_from_mobile",O=function(){function t(e){var l=this;r()(this,t),this.hideTimeoutId=0,this.timeRecode={},this.onInserImageRelay=n()(d.a.mark(function e(){var t,n,i,r,o,a,s,c;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.getMemberId(),n=l.getEditorBaseRev(),i=l.editorContext.getRep(),r=i.zoneId||"0",o=i.selStart[0],a=i.selStart[1],0===o&&"0"===r&&(o=1,a=0),s="relay-".concat(Object(p.b)(),"-").concat(Date.now()),c=0,e.prev=9,e.next=12,h.d.post(b,{UUID:s,Line:o,Pos:a,ZoneToken:i.zoneId||"0",MemberID:t,Token:Object(f.g)(),BaseRev:n});case 12:l.showModal(s),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(9),console.log(e.t0),e.t0&&3===e.t0.code?l.showModal(s):m.a.show({key:y,type:"error",content:u("image.relay_request_failure")}),c=e.t0&&e.t0.code?e.t0.code:-1;case 20:l.log({code:c}),l.recordStart(s);case 22:case"end":return e.stop()}},e,null,[[9,15]])})),e&&(this.editorContext=e,this.bindEvents())}return a()(t,[{key:"getRelayModalInstance",value:function(){return this.relayModal||(this.relayModal=Object(l.a)()),this.relayModal}},{key:"handleClientMessage_IMAGE_RELAY",value:function(e,t){var n=t.msg,i=n.code,r=n.uuid;0!==i&&g.a.show({body:u("image.upload_from_mobile_failure"),hasCancel:!1}),this.hideModal(r),this.log({upload_status:"success",upload_time_cost:this.getCostTime(r)})}},{key:"bindEvents",value:function(){this.editorContext.registerCommand(c.b.INSERTIMAGE_RELAY,this.onInserImageRelay)}},{key:"recordStart",value:function(e){this.timeRecode[e]=Date.now()}},{key:"getCostTime",value:function(e){var t=this.timeRecode[e];return t?Date.now()-t:-1}},{key:"log",value:function(e){Object(v.default)(E,e)}},{key:"hideModal",value:function(e){this.getRelayModalInstance().hide(e),this.clearRelayTimeout(e)}},{key:"clearRelayTimeout",value:function(e){this.currentUuid===e&&(this.hideTimeoutId&&clearTimeout(this.hideTimeoutId),this.hideTimeoutId=0)}},{key:"showModal",value:function(e){var t=this;this.getRelayModalInstance().show(e),this.hideTimeoutId&&clearTimeout(this.hideTimeoutId),this.hideTimeoutId=window.setTimeout(function(){t.hideModal(e),t.log({upload_status:"fail"})},3e5),this.currentUuid=e}},{key:"getMemberId",value:function(){var e=Object(s.default)(this.editorContext,"plugins.sync");return e?e.getMemberId():-1}},{key:"getEditorBaseRev",value:function(){var e=Object(s.default)(this.editorContext,"plugins.client");return e?e.getRev():-1}},{key:"unbindEvents",value:function(){}},{key:"destroy",value:function(){this.clearRelayTimeout(this.currentUuid),this.unbindEvents(),delete this.relayModal,Object(l.b)()}}]),t}()}).call(this,k("2vAP"))},OsWd:function(e,t,n){"use strict";function i(e){var t,n,i,r;e.savedRep&&(e.setEditable(!0),n=(t=e.savedRep).zoneId,i=t.selStart,r=t.selEnd,e.setWithSelection(n,i,r),e.updateBrowserSelectionFromRep(!0),e.savedRep=null)}n.d(t,"a",function(){return i})},OuIN:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({xmlnsXlink:"http://www.w3.org/1999/xlink",width:"20",height:"20",viewBox:"0 0 20 20"},t),c.a.createElement("defs",null,c.a.createElement("path",{id:"4520d5e1040987f36b5bd943f70ea071-a",d:"M0 0h20v20H0z"})),c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("mask",{id:"4520d5e1040987f36b5bd943f70ea071-b",fill:"#fff"},c.a.createElement("use",{xlinkHref:"#4520d5e1040987f36b5bd943f70ea071-a"})),c.a.createElement("path",{fill:"#2B2F36",d:"M12.01 10v3.78H9.08V10h-2.4a.68.68 0 01-.53-1.12l3.83-4.63a.68.68 0 011.05 0l3.8 4.64a.68.68 0 01-.52 1.11h-2.3zm-3 4.98h3v1.48c0 .3-.23.53-.53.53H9.54a.54.54 0 01-.53-.53v-1.48z",mask:"url(#4520d5e1040987f36b5bd943f70ea071-b)",transform:"matrix(1 0 0 -1 0 21)"})))}},OvDQ:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=function(){function t(e){r()(this,t),this.props=e,this.isMounted=!1,this.onUnmount=void 0}return a()(t,[{key:"mountIfNeeded",value:function(){return this.props.shouldMount()?this.isMounted||(this.onUnmount=this.props.mountImpl(),this.isMounted=!0):this.unmountIfNeeded(),this.isMounted}},{key:"willMountStateChange",value:function(){return this.props.shouldMount()!==this.isMounted}},{key:"unmountIfNeeded",value:function(){this.isMounted&&(this.onUnmount&&(this.onUnmount(),this.onUnmount=void 0),this.isMounted=!1)}}]),t}()},Ovl5:function(e,t){function n(e){e.prototype.getClientRects&&(e.prototype.getBoundingClientRect=function(){var e=this.getClientRects()[0];return e||{top:0,left:0,right:0,bottom:0,height:0,width:0,x:0,y:0}})}n(Element),n(Range)},OyiX:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i,r=n("lSNA"),o=n.n(r),a=n("RIqP"),s=n.n(a),c=n("y2sV"),l=n("H6oK"),u=n("kESg"),d=n("ciJ8"),h=n("DNsP"),f=/comment-|author/,p=/insertorder/,g=new c.t((i={bold:{mark:!0},italic:{mark:!0},underline:{mark:!0},strikethrough:{mark:!0},"comment-.*":{mark:!0},backcolor:{mark:!0},textcolor:{mark:!0},"at-holder":{mark:!0},"at-uuid_.*":{mark:!0},"clientside-mention-placeholder":{mark:!0},"inline-code":{mark:!0,tailInherit:!1},"url-.*":{mark:!0,tailInherit:!1,refresh:!0},"horizontal-line":{display:"block",displayEnter:!1,attributes:f,lineAttributes:p},"image-uploaded":{display:"block",displayEnter:!1,attributes:f,lineAttributes:/align|blockquote|insertorder|comment-/},gallery:{display:"inline",displayEnter:!1,attributes:f,lineAttributes:/align|blockquote|insertorder|comment-/},"image-previewer":{display:"block",displayEnter:!1},aceTable:{display:"block",attributes:f,lineAttributes:/insertorder|blockquote/,displayEnter:!1},chatCardProps:{display:"block",displayEnter:!1,attributes:/comment-|align|author/,lineAttributes:/insertorder|blockquote/},"sheet-token":{display:"block",displayEnter:!1,attributes:f,lineAttributes:/comment-/}},o()(i,l.BLOCK_DATA_META_BLOCK_PROPS,{display:function(e){var t=Object(l.parseJsonSafely)(e)||{};return Object(l.isInlineBlock)(t)?"inline":"block"},displayEnter:function(e){var t=Object(l.parseJsonSafely)(e)||{};return Object(l.isInlineBlock)(t)},attributes:function(e,t,n){var i=Object(l.parseJsonSafely)(n)||{};return Object(l.isInlineBlock)(i)?i.blockType!==l.BlockType.EQUATION_BLOCK||![h.a.BACKGROUND,h.a.TEXT].includes(e):f.test(e)},lineAttributes:function(e,t,n){var i=Object(l.parseJsonSafely)(n)||{};return!!Object(l.isInlineBlock)(i)||/insertorder|blockquote/.test(e)}}),o()(i,"zoneType",{display:"block",displayEnter:!1,attributes:function(e,t,n){return"codeBlock"===n?/lang|zoneId|langSpecified|word_wrap|author/.test(e):n===u.l.CalloutBlock?f.test(e)||new RegExp([u.k.ZoneId].concat(s()(Object.values(d.i))).join("|")).test(e):f.test(e)},lineAttributes:p}),i))},P438:function(e,t,n){"use strict";var i,r,o;n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),(r=i=i||{})[r.CONNECT_FAIL=-1]="CONNECT_FAIL",r[r.CONNECTING=0]="CONNECTING",r[r.CONNECT_SUCCESS=1]="CONNECT_SUCCESS",(o=o||{}).Jira="jira"},P4CN:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=1},PCTH:function(e,w,j){"use strict";(function(e){j.d(w,"a",function(){return I}),j.d(w,"f",function(){return s}),j.d(w,"e",function(){return S}),j.d(w,"b",function(){return c}),j.d(w,"h",function(){return l}),j.d(w,"d",function(){return u}),j.d(w,"c",function(){return T}),j.d(w,"g",function(){return d});var t=j("o0o1"),b=j.n(t),n=j("RIqP"),y=j.n(n),i=j("yXPU"),r=j.n(i),o=j("q1tI"),h=j.n(o),a=j("TSYQ"),f=j.n(a),p=j("ZvLv"),g=j("elsr"),m=j("UeI0"),v=j("YWBl"),E="0",O="toggle_heading_collapse",C="toggle_heading_expand",k={expandSection:e("doc.toggle.expand"),collapseSection:e("doc.toggle.collapse")},I="set-collapse";function s(e,t){var n=e.selStart,i=e.selEnd,r=e.zoneId;return{selStart:[n[0],t],selEnd:i.slice(0,2),selZone:r||n[2]}}function S(e,t){var n=t.lines.atIndex(e),i=n.width;return{selStart:[e,n.lineMarker],selEnd:[e,i-1],selZone:t.zoneId}}var c=function(e){var t=e.line,n=e.container,i=e.onClick,r=e.editor,o=t.zone,a=r.getRep().lines.indexOfEntry(t),s=r.getContentState().getZoneState(o).getLine(a);if(s){var c=s.getAttributes(0,s.length()-1).toMap(),l=Object(m.b)(c),u=l?k.expandSection:k.collapseSection,d=f()("collapsable-section-handle",{"collapsable-section-handle-collapsed":l});return h.a.createElement(p.a,{className:d,tooltip:u,container:n,onClick:i,"track-title":"collapse-section"})}};function l(e,t,n,i){var r=i.currentTarget;i&&r&&r!==document.activeElement&&r.focus();var o="toggle_button";u(e,t,n,e.isEditable(),!1,o)}function u(n,e,i,r,o,t){var a=e.selStart,s=e.selEnd,c=e.selZone;a.toString()===s.toString()&&1===a[1]&&(a[1]=0);var l=n.getRep();l.zoneId!==c&&(n.setWithSelection(c,s,s),n.updateBrowserSelectionFromRep(!0));var u,d,h=[];n.inCallStackIfNecessary(I,function(){var e=o||!r?g.b.LOCAL:"",t=i?"":"true",t=(o||e)&&""===t?"false":t;h.push(["collapse",t]),n.fastIncorp(),n.performDocumentApplyAttributesToRange(a,s,h,e)}),t&&(u=i?C:O,d=l.attributeManager.getAllAttributesOnLine(a[0]).find(function(e){return"heading"===e[0]}),Object(v.a)({action:u,source:t,objectType:d[1].toUpperCase()}))}function T(e,t,n,i,r){u(e,t,n,i,!0,r)}function d(e,t){return _.apply(this,arguments)}function _(){return(_=r()(b.a.mark(function e(i,t){var n,r,o,a,s,c,l,u,d,h,f,p,g,m,v;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.selStart,r=t.selEnd,o=t.zoneId,a=[],s=[],c=n[0],l=r[0],i){e.next=7;break}return e.abrupt("return");case 7:for(o!==E&&(u=i.getLineNumInRootZone(o,n),c=l=u),s.push(c,l),s=y()(new Set(s)),d=i.getReps()[E],h=i.lineTracker.collapseLines,f=h.trackers[E],p=f.entries,g=[],s.forEach(function(e){g.push(p[e].output.renderCollapsed)});g.includes(!0);){for(m=c;m<=l;m++)if(p[m].output.renderCollapsed){for(v=m;!p[v].output.startOfCollapseSection;)v--;a.push(v)}a.forEach(function(e){var t=S(e,d),n="comment";T(i,t,!0,i.isEditable(),n)}),s.forEach(function(e,t){g.splice(t,1,p[e].output.renderCollapsed)})}return e.abrupt("return",Promise.resolve());case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}}).call(this,j("2vAP"))},PFEC:function(e,t,n){"use strict";n.d(t,"a",function(){return k});var i=n("RIqP"),p=n.n(i),r=n("J4zp"),y=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),u=n("3Hq1"),g=n("BeL+"),l=n("1myf"),d=n("owWc"),h=n("pHS2"),f=n("HmyT"),m=n("FJEn"),v=n("U5G9"),b=m.tableIds.getRowAndColIdFromCellId,E=Object(v.b)({module:v.a.HISTORY}),O="+",C=3,k=function(){function n(e,t){a()(this,n),0===Object.keys(e).length?(this.allApool=(new m.AttributePool).fromJsonable(t),this.attributedTexts={texts:{},attribs:{}},this.allTexts=this.attributedTexts.texts,this.allAttribs=this.attributedTexts.attribs,this.tableMeta={rows:{},cols:{},attribs:{}},this.allRows={},this.allCols={}):(this.allApool=(new m.AttributePool).fromJsonable(JSON.parse(e.pool)),this.attributedTexts=JSON.parse(e.attributed_texts),this.tableMeta=JSON.parse(e.table_meta),this.allTexts=this.attributedTexts.texts,this.allAttribs=this.attributedTexts.attribs,this.allRows=this.tableMeta.rows,this.allCols=this.tableMeta.cols),this.alinesApool=(new m.AttributePool).fromJsonable(t),this.addTableData={},this.texts={},this.attribs={},this.rows=this.allRows,this.cols=this.allCols,this.changePosition={},this.insertData={}}return c()(n,[{key:"getRowColZoneId",value:function(e){var t,n,i,r,o=b(e),a=o.rowId,s=o.colId;for(i in this.allRows)if(-1<this.allRows[i].indexOf(a)){t=i;break}for(r in this.allCols)if(-1<this.allCols[r].indexOf(s)){n=r;break}return{rowZoneId:t,colZoneId:n}}},{key:"getItemType",value:function(e){var t="Z";switch(e.charAt(0)){case"c":t="C";break;case"r":t="R"}return t}},{key:"findTableIndexAttrib",value:function(t){var n=this;if(!this.attribs[0])return{tableAttrib:""};for(var e=this.attribs[0].split("|1+1"),i=!1,r="",o=0,a=0;a<e.length;a++){for(var s=e[a],c=E.opIterator(s);c.hasNext();){var l=c.next();E.eachAttribNumber(l.attribs,function(e){"aceTable"===n.allApool.getAttribKey(e)&&-1<n.allApool.getAttribValue(e).indexOf(t)&&(i=!0,r=n.allApool.getAttribValue(e))})}if(i){o=a;break}}return{tableAttrib:r,tableIndex:o}}},{key:"addTextAttribs",value:function(e){var t=e.zone_id;this.texts[t]?(this.texts[t]+=e.text,this.attribs[t]+=e.attribs):(this.texts[t]=e.text,this.attribs[t]=e.attribs)}},{key:"fillTableOtherZoneTexts",value:function(){for(var e in this.allTexts)this.texts[e]||(this.texts[e]=this.allTexts[e],this.attribs[e]=this.allAttribs[e])}},{key:"addChangeZoneIdToAline",value:function(e){for(var n=this,t=E.opIterator(e.attribs),i=0,r=e.text.split("|"),o=[];t.hasNext();){var a=t.next(),s=!1;E.eachAttribNumber(a.attribs,function(e){var t=n.allApool.getAttribKey(e);(-1<t.indexOf("__edit_add")||-1<t.indexOf("__edit_del"))&&(s=!0)}),a.opcode===O&&(s&&(o=o.concat(r.slice(i,i+a.chars)),s=!1),i+=a.chars)}e.changeZoneId=o}},{key:"getColRowIdIndex",value:function(e,t,n){var i=b(e),r=i.rowId,o=i.colId,a=this.rows[t],s=this.cols[n];return{rowIdIndex:Math.max(a.indexOf(r),0),colIdIndex:Math.max(s.indexOf(o),0)}}},{key:"handleAddTableData",value:function(e,t){var n=t.zone_id;"Z"!==this.getItemType(n)&&this.addChangeZoneIdToAline(t),this.addTableData["aceTable-"+e]=!0}},{key:"getNewAlines",value:function(e){var b=this,t=Object(h.a)(e,function(e){return e.zone_id}),n=Object.keys(t).sort(function(e,t){return e.length>t.length});return Object(d.a)(n,function(v,e){return Object(l.a)(t[e],function(e){return e.index}).forEach(function(e){e.attribs=E._moveOpsToNewPool(e.attribs,b.alinesApool,b.allApool);var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g=e.zone_id,m=b.getItemType(g);"Z"===m&&"0"===g?(b.addTextAttribs(e),v.push(e)):"Z"===m&&"0"!==g?(n=(t=b.getRowColZoneId(g)).rowZoneId,i=t.colZoneId,e.rowZoneId=n,e.colZoneId=i,b.allTexts[g]&&n&&i&&(r="".concat(n," ").concat(i),b.addTableData["aceTable-"+r]||(b.rows[n]=b.allRows[n],b.cols[i]=b.allCols[i],b.attribs[n]=b.tableMeta.attribs[n],b.attribs[i]=b.tableMeta.attribs[i]),b.handleAddTableData(r,e)),b.addTextAttribs(e)):(o="C"===m?b.cols:b.rows,a="C"===m?b.tableMeta.cols:b.tableMeta.rows,s=e.text.split("|"),a[g]?(l=(c=b.findTableIndexAttrib(g).tableAttrib).split(" "),d=(u=y()(l,2))[0],h=u[1],e.rowZoneId=d,e.colZoneId=h,b.addTableData["aceTable-"+c]||(f="C"===m?d:h,p="C"===m?b.tableMeta.rows:b.tableMeta.cols,("C"===m?b.rows:b.cols)[f]=p[f],b.attribs[f]=b.tableMeta.attribs[f]),o[g]=s,b.handleAddTableData(c,e)):(a[g]=s,o[g]=s),b.attribs[g]=e.attribs),b.addAlineChangePosition(e)}),v},[])}},{key:"addAlineChangePosition",value:function(e){var t=e.zone_id,n=e.rowZoneId,i=e.colZoneId,r=e.changeZoneId,o=this.getItemType(t);if("0"!==t)if("Z"===o&&n&&i){var a=this.getColRowIdIndex(t,n,i),s=a.rowIdIndex,c=a.colIdIndex,l="".concat(n," ").concat(i);this.addChangePosition(l,s,c)}else if(r&&n&&i)for(var u=this.rows[n],d=this.cols[i],h="C"===o?d:u,f="C"===o?u:d,p="".concat(n," ").concat(i),g=0;g<r.length;g++)for(var m=Math.max(h.indexOf(r[g]),0),v=0;v<f.length;v++){var b=void 0,y=void 0;"C"===o?(b=v,y=m):"R"===o&&(b=m,y=v),this.addChangePosition(p,b,y)}}},{key:"handleChangePosition",value:function(){for(var e in this.changePosition){for(var t=e.split(" "),n=y()(t,2),i=n[0],r=n[1],o=new Array(this.rows[i].length),a=new Array(this.cols[r].length),s=this.changePosition[e],c=Object.keys(s).map(function(e){return parseInt(e,10)}).sort(function(e,t){return e-t}),l=[],u=0;u<c.length;u++)var d=c[u],l=[].concat(p()(l),p()(s[d]));l=Object(g.a)(l).sort(function(e,t){return e-t});var h=this.handleArr(l,a),f=this.handleArr(c,o);this.insertData[e]={colInsert:h,rowInsert:f,initColArr:a,initRowArr:o}}}},{key:"handleArr",value:function(e,t){for(var n,i={},r=0;r<=e.length-1;r++){var o=e[r];if(0===r){var a=o-2;if(0<=a)for(var s=r;s<=a;s++)t[s]=1}if(r===e.length-1)if(3<=t.length-o)for(var c=o+2;c<=t.length-1;c++)t[c]=1;if(!Object(u.default)(n)&&C+1<=o-n)for(var l=n+1;l<=o-1;l++)l===o-(t[l]=1)&&(i[l]=!0);n=o}return i}},{key:"addChangePosition",value:function(e,t,n){this.changePosition[e]||(this.changePosition[e]={}),this.changePosition[e][t]?this.changePosition[e][t]=[].concat(p()(this.changePosition[e][t]),[n]):this.changePosition[e][t]=[n]}},{key:"handleTableHtml",value:function(e){var d=this;return e.map(function(e){var t=Object(f.$)(e),n=t.find('span[class*="aceTable-"]');if(0===n.length)return e;var i=n[0],r=i.className;if(Object(f.$)(i).hasClass("__edit"))return e;var o=/(^|\s*)(aceTable-([a-zA-Z0-9]+\s[a-zA-Z0-9]+))(\s|$)/.exec(r);if(!o||d.insertData[o[3]]){var a=d.insertData[o[3]],s=a.initColArr,c=a.initRowArr,l=a.colInsert,u=a.rowInsert;return Object(f.$)(i).find(".ace-table tr").each(function(e){if(c[e]&&Object(f.$)(this).css("display","none"),u[e]){for(var t=Object(f.$)("<tr>"),n="",i=0;i<s.length;i++)s[i]?n+='<td class="ace-table-cell ace-table-cell-ellipsis tb-resizable" style="display: none">...</td>':n+='<td class="ace-table-cell ace-table-cell-ellipsis -tb-resizable">...</td>',l[i]&&(n+='<td class="ace-table-cell ace-table-cell-ellipsis -tb-resizable">...</td>');t.append(n),Object(f.$)(this).after(t)}Object(f.$)(this).find("td.ace-table-cell").each(function(e){s[e]&&Object(f.$)(this).css("display","none"),l[e]&&Object(f.$)(this).after('<td class="ace-table-cell ace-table-cell-ellipsis tb-resizable">...</td>')})}),t[0].outerHTML}})}},{key:"fixTableColsAndRowsAttribs",value:function(){var t=this;Object.keys(this.cols).forEach(function(e){return Object(u.default)(t.attribs[e])&&(t.attribs[e]="+".concat(t.cols[e].length))}),Object.keys(this.rows).forEach(function(e){return Object(u.default)(t.attribs[e])&&(t.attribs[e]="+".concat(t.rows[e].length))})}},{key:"getInitClientVars",value:function(){return this.handleChangePosition(),this.fillTableOtherZoneTexts(),this.fixTableColsAndRowsAttribs(),{initialAttributedTexts:{attribs:this.attribs,cols:this.cols,rows:this.rows,text:this.texts},apool:this.allApool}}}]),n}()},PGru:function(e,t,n){"use strict";var i=n("o0o1"),u=n.n(i),r=n("yXPU"),s=n.n(r),o=n("lwsE"),c=n.n(o),a=n("W8MJ"),l=n.n(a),d=n("cDf5"),h=n.n(d),f=n("AiBH"),p=n("Hj9z"),g=n("XRg5"),m=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=Object(g.createViewer)(t,Object.assign({fullscreen:!0,autohideControls:!1},e,{hidden:function(){n.destroy(),n=null;var e=t.src;window.URL.revokeObjectURL(e)}}),g.MODULE_TYPE.DOC_BODY,g.BLOCK_VIEW_TYPE.DIAGRAM);return n.show(),n},v=n("H6oK"),b=n("4PSP"),y=n("OX8E"),E=n("gfe6"),O=n("AsG6"),C=n("2spZ"),k=n("2ACu"),I=n("5e3X"),S=n("iP/4"),T=n("y2sV"),_=n("rLED");n.d(t,"a",function(){return j});var w=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},j=function(){function t(e){c()(this,t),this.editor=null,this.editor=e,this.bindEvent(),O.a.init(e)}function e(e){return n.apply(this,arguments)}var n,i,r;function o(e,t){return i.apply(this,arguments)}function a(e){return r.apply(this,arguments)}return l()(t,[{key:"bindEvent",value:function(){var e=this;this.editor&&this.editor.commands.registerCommand(f.b.DIAGRAM_FLOWCHART,function(){e.handleInsertDiagram(p.DiagramType.FLOWCHART)}),this.editor&&this.editor.commands.registerCommand(f.b.DIAGRAM_UML,function(){e.handleInsertDiagram(p.DiagramType.UML)}),y.a.on(p.DiagramEvents.OPEN_VIEWER,this.handleOpenViewer)}},{key:"unbindEvent",value:function(){y.a.off(p.DiagramEvents.OPEN_VIEWER,this.handleOpenViewer)}},{key:"handleInsertDiagram",value:(r=s()(u.a.mark(function e(t){var n,i,r,o,a=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.editor.plugins.blockPlugin,i=this.editor.getRep(),r=Object(v.generateBlockDataSet)({blockType:v.BlockType.DIAGRAM_BLOCK,creator:Object(v.getBlockCreator)(v.BlockType.DIAGRAM_BLOCK,this.editor),props:{viewType:v.ViewTypes.CARD,diagramType:t},initData:Object(p.generateDiagramInitData)()}),n.insertBlock(r,i),Object(k.default)("client_insert_diagram",{create_source:"toolbar",block_subtype:t}),o=r.blockId,this.editor&&this.editor.version&&this.editor.version.includes(T.y)?this.editor.once("paint",function(){a.handleOpenEditor(o,t)}):this.handleOpenEditor(o,t);case 7:case"end":return e.stop()}},e,this)})),a)},{key:"handleOpenEditor",value:(i=s()(u.a.mark(function e(t,n){var i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.editor.plugins.blockPlugin.getBlockById(t),Object(E.c)())return e.next=4,Object(C.c)(400);e.next=6;break;case 4:i.handleEditDiagramFromAuto&&i.handleEditDiagramFromAuto(),Object(k.default)("click_enter_full_screen",{source:"auto",block_type:"diagram",block_subtype:n});case 6:case"end":return e.stop()}},e,this)})),o)},{key:"handleOpenViewer",value:(n=s()(u.a.mark(function e(t){var n,i,r,o,a,s,c,l;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.editor.plugins.blockPlugin.getBlockById(t)){e.next=3;break}return e.abrupt("return");case 3:if(S.a.isOpendoc||S.a.isLark&&!S.a.isLKP&&!S.a.isInVC){i=n.getSvg();try{r=document.createElement("img"),o=(o=(new XMLSerializer).serializeToString(i)).replace(/\x08/g,""),a=new Blob([o],{type:"image/svg+xml"}),s=URL.createObjectURL(a),r.setAttribute("src",s),m(r)}catch(e){console.log("fail to open viewer for  diagram",e)}}else Object(_.Q)()?(c=this.editor&&this.editor.getPlugins&&this.editor&&this.editor.getPlugins()||[],(l=c.find(function(e){return"gallery"===e.name}))&&l.previewModule&&l.previewModule.open(n.blockId,g.BLOCK_VIEW_TYPE.DIAGRAM)):Object(I.d)(n.blockId,null,g.BLOCK_VIEW_TYPE.DIAGRAM),Object(I.c)(I.a.OPEN,n.blockId);case 4:case"end":return e.stop()}},e,this)})),e)},{key:"reset",value:function(){O.a.destroy(),this.editor=null,this.unbindEvent()}}]),t}();w([Object(b.Bind)()],j.prototype,"handleInsertDiagram",null),w([Object(b.Bind)()],j.prototype,"handleOpenEditor",null),w([Object(b.Bind)()],j.prototype,"handleOpenViewer",null)},PI5S:function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),o=n("o0o1"),a=n.n(o),s=n("yXPU"),c=n.n(s),l=n("lwsE"),u=n.n(l),d=n("W8MJ"),h=n.n(d),f=n("cDf5"),p=n.n(f),g=n("mRaX"),m=n("1xqC"),v=n("uEBw"),b=n("QM+C"),y=n("c/bE"),E=n("pylR"),O=n("v2N6"),C=n("Tqb2");function k(e){return Object(C.l)(e).filter(function(e){return!Object(C.K)(e)})}function I(e){if(e.dataTransfer){var t=e.dataTransfer,n=t.items,i=t.files;return n?0<n.length:!!i&&0<i.length}return!1}var S=n("Mvmg"),T=n("4PSP"),_=n("rLED"),w=n("oJoF"),j=n("QtEt");n.d(t,"b",function(){return D}),n.d(t,"a",function(){return x}),n.d(t,"c",function(){return P});var M,L=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},R=3,N=function(){function n(e){var t=this;u()(this,n),this.uploadingQueue=[],this.waitingQueue=[],this.uploaderMap={},this.aceInitialized=function(){t.editorInfo.on(w.b,c()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.a)();case 2:t.docUploaderCreator=e.sent;case 3:case"end":return e.stop()}},e)})))},this.editorInfo=e.editorInfo,this.aceInitialized(),this.maxUploaderLimit=e.maxUploaderLimit||R,this.addBeforeUnloadHandle(),this.bindEvents()}function e(e){return t.apply(this,arguments)}var t;return h()(n,[{key:"bindEvents",value:function(){Object(_.Q)()&&(this.editorInfo.on("drop",this.onEditorDrop),document.addEventListener("dragover",this.onDragOver))}},{key:"unBindEvents",value:function(){Object(_.Q)()&&(this.editorInfo.off("drop",this.onEditorDrop),document.removeEventListener("dragover",this.onDragOver))}},{key:"onDragOver",value:function(e){I(e)&&e.preventDefault()}},{key:"onEditorDrop",value:function(e){var t=this,n=e.evt,i=k(n);0<i.length&&(n.preventDefault(),i.forEach(function(e){t.calcChecksumForNonImageFiles(e),e.source=S.i.DRAG,P(e)}))}},{key:"upload",value:function(e){var t=Object(g.h)();(this.enableUpload?this.uploadingQueue:this.waitingQueue).push(t);var n=Object.assign(e,{uuid:t});this.uploaderMap[t]=this.createUploader(n,this.docUploaderCreator),this.startUpload()}},{key:"calcChecksumForNonImageFiles",value:(t=c()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.a)(t);case 2:n=e.sent,O.b(t,n);case 4:case"end":return e.stop()}},e)})),e)},{key:"createUploader",value:function(e,t){var n={docUploaderCreator:t,editorInfo:this.editorInfo,file:e,handleUploadEnd:this.handleUploadEnd.bind(this)};return new m.a(n)}},{key:"handleUploadEnd",value:function(e){this.deleteUploaded(e),this.uploadingEnQueue(),this.startUpload()}},{key:"uploadingEnQueue",value:function(){var e=this.waitingQueue.splice(0,1);this.uploadingQueue=[].concat(r()(this.uploadingQueue),r()(e))}},{key:"startUpload",value:function(){var n=this;this.uploadingQueue.forEach(function(e){var t=n.uploaderMap[e];t.started||(t.startUpload(),t.started=!0)})}},{key:"deleteUploaded",value:function(e){delete this.uploaderMap[e],this.uploadingQueue.includes(e)&&this.uploadingQueue.splice(this.uploadingQueue.indexOf(e),1),this.waitingQueue.includes(e)&&this.waitingQueue.splice(this.waitingQueue.indexOf(e),1)}},{key:"cancelUploading",value:function(e){var t=this.uploaderMap[e];t&&!t.isDone&&t.cancelUpload()}},{key:"canLeavePage",value:function(){return!(0<this.uploadingQueue.length)}},{key:"addBeforeUnloadHandle",value:function(){y.a.addCanLeavePageHandler(this.canLeavePage),window.addEventListener("beforeunload",this.handleBeforeUnload)}},{key:"handleBeforeUnload",value:function(e){0<this.uploadingQueue.length&&(e.preventDefault(),e.returnValue="")}},{key:"destory",value:function(){y.a.removeCanLeavePageHandler(this.canLeavePage),window.removeEventListener("beforeunload",this.handleBeforeUnload),this.unBindEvents(),this.clearChecksumStore()}},{key:"clearChecksumStore",value:function(){Object(_.Q)()&&O.a()}},{key:"enableUpload",get:function(){return this.uploadingQueue.length<this.maxUploaderLimit}}]),n}();function D(e){if(!e)throw new Error("editorInfo not provided for uploader creation");return M=new N({editorInfo:e})}function x(){M&&(M.destory(),M=null)}function P(e){var t;b.isAnonymousAccess||((t=Object(v.h)(e))?Object(v.g)(t):M&&M.upload(e))}L([T.Bind],N.prototype,"onEditorDrop",null),L([T.Bind],N.prototype,"canLeavePage",null),L([T.Bind],N.prototype,"handleBeforeUnload",null)},PIJw:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("4/Xm"),r=n("iaE7"),o=n("rLED"),a=n("/mER");function s(e){return Object(o.f)()||Object(a.a)()?[new r.a(e,new i.a(e))]:[]}},PKWG:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 16 16"},t),c.a.createElement("g",{transform:"translate(-26 -4)",fill:"none",fillRule:"evenodd"},c.a.createElement("rect",{stroke:"#F1F2F3",x:".5",y:".5",width:"74",height:"23",rx:"11.5"}),c.a.createElement("path",{d:"M26 4h16v16H26z"}),c.a.createElement("path",{d:"M34 13.93l4.07-4.06c.1-.1.25-.1.35 0l.35.35c.1.1.1.26 0 .35L34.35 15a.5.5 0 01-.7 0l-4.42-4.42a.25.25 0 010-.35l.35-.35c.1-.1.26-.1.35 0L34 13.93z",fill:"#646A73"})))}},PLJW:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24"},t),c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("path",{d:"M0 0h24v24H0z"}),c.a.createElement("path",{d:"M17.7 4c.17 0 .3.13.3.3v.9a.3.3 0 01-.3.3h-2.2v4.25l3.1 4.04c.37.5.02 1.2-.6 1.2h-5.25v5.71a.3.3 0 01-.3.3h-.9a.3.3 0 01-.3-.3V15H6a.75.75 0 01-.65-1.12l.05-.09 3.1-4.04V5.5H6.3a.3.3 0 01-.3-.3v-.9c0-.17.13-.3.3-.3h11.4zM14 5.5h-4V10c0 .13-.03.26-.1.37l-.05.09-2.33 3.04h8.96l-2.32-3.04A.75.75 0 0114 10V5.5z",fill:"#646A73"})))}},PQAI:function(e,m,v){"use strict";(function(i){var e=v("lwsE"),r=v.n(e),t=v("W8MJ"),o=v.n(t),a=(v("+ECM"),v("FJEn")),s=v("t+1L"),c=v("G2xZ"),l=v("qKwb"),u=v("OX8E"),d=v("D7h9"),h=v("qOLP"),f=v("sLU5"),p=v("QM+C"),g=["blank-title","blank-body"],n=function(){function n(e,t){r()(this,n),this.root=e,this.editorContext=t}return o()(n,[{key:"checkTextStatus",value:function(e){var t,n,i=this.editorContext.getRep();i.zoneId===a.DEFAULT_REP_ZONE&&(0!==e?1===e&&(t=this.getBodyHasText(i),this.setTextStatus(e,t)):(n=this.hasNewLine(e),this.checkTitleAndBodyStatusImpl(i,n)))}},{key:"checkTitleAndBodyStatusImpl",value:function(e,t){var n,i=0,r=1,o=this.hasText(e.zoneId,i);this.setTextStatusToDOM(i,o),t&&(n=this.getBodyHasText(e),this.setTextStatusToDOM(r,n)),this.setTitleAndBodyStatusToRedux(o,n),t&&this.triggerDocHasText(r,n)}},{key:"checkTitleAndBodyStatus",value:function(){var e=this.editorContext.getRep();e.zoneId===a.DEFAULT_REP_ZONE&&this.checkTitleAndBodyStatusImpl(e,!0)}},{key:"getBodyHasText",value:function(e){return this.hasText(e.zoneId,1)||this.hasText(e.zoneId,2)||2<e.lines.length()}},{key:"setTextStatus",value:function(e,t){this.setTextStatusToDOM(e,t),this.setTextStatusToRedux(e,t),this.triggerDocHasText(e,t)}},{key:"setTextStatusToDOM",value:function(e,t){var n,i=this.root;!i||(n=g[e])&&this.editorContext.getObserver().withoutRecordingMutations(function(){t?i.classList.remove(n):i.classList.add(n)})}},{key:"setTextStatusToRedux",value:function(e,t){var n;this.editorContext.pure||(n=!t,0!==e?1===e&&Object(l.d)(d.default.getState())!==n&&d.default.dispatch(Object(c.c)(n)):Object(l.h)(d.default.getState())!==n&&d.default.dispatch(Object(c.h)(n)))}},{key:"setTitleAndBodyStatusToRedux",value:function(e,t){var n,i,r,o,a,s;this.editorContext.pure||(i=(n=function(e){return void 0===e?void 0:!e})(e),r=n(t),a=(o=function(e,t){return void 0!==e&&t(d.default.getState())!==e})(i,l.h),s=o(r,l.d),(a||s)&&d.default.dispatch(Object(c.g)({title:i,body:r})))}},{key:"triggerDocHasText",value:function(e,t){var n,i;this.editorContext&&this.editorContext.pure||1===e&&(n=this.editorContext.getRep().selStart,i=t||0!==n[0],u.a.trigger(h.b,[i]),t||u.a.emit(f.a.PC.DOCS.PLACEHOLDER.DOC_EMPTY))}},{key:"hasText",value:function(e,t){return Object(s.a)(e,t,this.editorContext)}},{key:"hasNewLine",value:function(e){var t=this.editorContext.getRep();if(!(e>=t.lines.length())){var n=t.lines.atIndex(e),i=n&&n.domInfo&&n.domInfo.node.textContent;return!!i&&0<i.length}}},{key:"setTitlePlaceholder",value:function(e){var t,n="data-title-placeholder";e&&!e.hasAttribute(n)&&(t=this.editorContext.pure?p.SuiteTitle.unamedDoc:i("doc.title_placeholder_default"),this.editorContext.observer.withoutRecordingMutations(function(){e.setAttribute(n,t)}))}},{key:"destory",value:function(){this.root=null,this.editorContext=null,this.docHasTextTimer=null}}]),n}();m.a=n}).call(this,v("2vAP"))},PSAx:function(e,t,n){"use strict";var i=n("CnBM"),r=n.n(i)()({loader:function(){return n.e("embed_obj_sidebar").then(n.bind(null,"ZBai"))},loading:function(){return null}});t.a=r},PX10:function(e,t,n){"use strict";var u,i,O=n("Ns/6"),C=n("HmyT"),r=n("lE2N"),k=(n("Z0Cl"),n("7EGn"),n("AiBH")),I=n("mRaX"),l=n("ibWA");n("Jmo2"),n("YNKm"),k.t.LEFT,k.t.RIGHT;(i=u=u||{}).LEFT="LEFT",i.RIGHT="RIGHT",i.START="START",i.END="END";var S=n("H6oK"),o=n("y2sV");function a(e,t){var n=e.rep,i=e.editorInfo,r=e.evt,o=r.keyCode===k.t.BACKSPACE?Object(I.x)():Object(C.$)(Object(I.t)()),a=o&&o.attr("class");if(o&&o.length&&Object(I.K)(a,"mention-type")!==String(k.E.CHAT)){var s=i.domToRep(o.get(0));i.fastIncorp();var c,l=n.selStart,u=n.selEnd,d=l,h=u;if(s){o.get(1)&&(c=i.domToRep(o.get(1))),s.selStart[1]<l[1]&&(d=s.selStart),s.selEnd[1]>u[1]&&s.selEnd[0]>=u[0]&&(h=s.selEnd),c&&c.selEnd[1]>u[1]&&(h=c.selEnd),i.inCallStackIfNecessary("docDeleteMention",function(){i.dom?i.performDocumentReplaceRange(n.zoneId,d,h,""):i.performDocumentReplaceRange(d,h,"")});var f,p,g,m,v=Object(I.K)(a,"mention-id"),b=Object(I.K)(a,"mention-tempId"),y=Object(I.K)(a,"mention-token"),E=Object(I.K)(a,"mention-type");return r.preventDefault(),!Object(S.isBlockTypeNode)(S.BlockType.AT_USER_BLOCK,o)||(f=Object(S.getBlockDataSet)(o))&&f.props&&(g=(p=f.props.data).user,m=p.mentionId,g&&m&&(y=g.id,E=k.E.USER.toString(),v=m)),v&&"undefined"!==v&&E===k.E.USER.toString()&&Object(O.b)({mention_id:v,token:y,source:k.z.DOC,note_token:Object(I.u)()}),!b||"undefined"===b||E!==k.E.USER.toString()&&E!==k.E.GROUP.toString()||t&&t({type:E,mentionTempId:b,mentionToken:y,fileToken:Object(I.u)()}),!0}}}function s(e,t){var n=e.evt,i=e.editorInfo,r=Object(I.l)();i.fastIncorp();var o,a=i.getRep(),s=d(t);if(r&&s){if(n.preventDefault(),Object(I.Q)(s)){var c=i.domToRep(s);if(!c)return;var l=[c.selStart[0],c.selStart[1]];i.selection.setWithSelection(a.zoneId,l,l,!1)}return i.updateBrowserSelectionFromRep()}t!==u.START&&t!==u.END||(n.preventDefault(),o=h(a,t),i.selection.setWithSelection(a.zoneId,o,o,!1),i.updateBrowserSelectionFromRep())}function d(e){var t,n=u.LEFT,i=u.RIGHT;if(e===n){if((t=Object(I.x)()).length)return t.prev().get(0)}else if(e===i&&(t=Object(I.t)()).length)return t.next().get(0);return null}function h(e,t){var n=e.selStart[0],i=u.START,r=u.END;if(t===i)return[n,0];if(t===r){var o=e.lines.atIndex(n);if(o&&o.text)return[n,o.text.length]}return[0,0]}function f(e){return Object(r.a)(e,function(e){return e[0]})}function c(e,t,n,i,r,o){e.dom?e.performDocumentReplaceRangeWithAttributes(e.getRep().zoneId,t,n,i,f(r)):e.performDocumentReplaceRangeWithAttributes(t,n,i,f(r)),e.updateBrowserSelectionFromRep(o)}function p(e,t,n,i,r){e.inCallStackIfNecessary("performSpace",function(){e.makeNewEvent("nonundoable",function(){e.fastIncorp(),e.dom?e.performDocumentReplaceRangeWithAttributes(r||e.getRep().zoneId,t,n," ",f(i)):e.performDocumentReplaceRangeWithAttributes(t,n," ",f(i))})}),e.version.includes(o.y)&&e.once("paint",function(){e.focus(void 0,!0)})}function g(e,n,i,t,r,o,a){var s=Object(l.a)(t," ").map(function(e,t){return{start:0===t?n:i,end:i,newText:e,attributes:/^\n+$/.test(e)?[]:f(r)}}),c=function(){e.dom?e.performDocumentReplaceMultiRangeWithAttributes(a||e.getRep().zoneId,s):e.performDocumentReplaceMultiRangeWithAttributes(s)};o?e.inCallStackIfNecessary("performAt",function(){e.fastIncorp(9),c()}):e.callWithAce(c,"performAt",!0)}function m(e,t){for(var n=null,i=e;!n&&i;)i.classList&&i.classList.contains(t)&&(n=i),i=i.parentNode;return n}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return p}),n.d(t,"d",function(){return g}),n.d(t,"c",function(){return m})},Pagd:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r});var i="JIRA_FILTER_BITABLE_ENTER_FULLSCREEN_EVENT",r="JIRA_FILTER_BITABLE_EXIT_FULLSCREEN_EVENT"},PcuH:function(e,t,n){"use strict";var i=n("J4zp"),O=n.n(i),r=n("RIqP"),N=n.n(r),o=n("lSNA"),D=n.n(o),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),u=n.n(c),d=n("m8R6"),h=n("XIp8"),x=n("XhtD"),P=n("y2sV"),f=n("FJEn"),B=n("+4eN"),U=n("kESg"),p=n("V2TW"),l=function(){function l(){s()(this,l)}return u()(l,[{key:"checkIsAllowInsertZone",value:function(e,t){var n=Object(B.n)(e,t),i=U.d[n];return!i||!i.attribs.includes(U.k.ZoneType)}},{key:"insertZoneDelta",value:function(e,t){return e.insert("*",Object.assign(D()({lineguid:Object(f.genGuid)(),author:Object(p.b)()},U.k.ZoneType,this.zoneType),t))}},{key:"getZoneAllOps",value:function(e,t){var n=e.getContentState().getZoneState(t);return N()(n).map(function(e){return e.getOps()}).flat()}},{key:"updateSelection",value:function(e,t,n,i){e.selection.setWithSelection(t,n,i),e.selection.updateBrowserSelectionFromRep()}},{key:"performOpsWithAttributes",value:function(t,n,i,e){(e?e.map(function(e){return t.getLine(e)}):N()(t)).forEach(function(e){e.getOps().forEach(function(e,t){0===t?"*"===e.insert&&e.attributes&&e.attributes.lmkr?n.insert("*",Object.assign({},e.attributes,{},i)):n.insertLineMarker(i).push(e):n.push(e)})})}},{key:"convertFragment",value:function(e,t,n,i,r){if(!n.length||Object(B.n)(e,t)!==this.zoneType)return[];var o=e.managers.zoneToLineEntry[t];if(!o)return[];var a=o.zone,s=e.getContentState(),c=s.getZoneState(a),l=s.getZoneState(t),u=e.getRep(a),d=e.getRep(t),h=u.lines.indexOfEntry(o);if(n.length===l.length())return this.convertEntire(e,a,h,i);n.sort(function(e,t){return e-t});var f=n[0],p=l.length()-1,g=0===f,m=[g?0:f-1,g?0:l.getLine(f-1).getModelText().length-1],v=[g?n.length:p,g?0:l.getLine(p).getModelText().length-1],b=[h+(g?0:1),0],y=b[0]-1+n.length,E=b[0]+n.length,O=new P.e;e.performDocumentReplaceRange(t,m,v,"");var C,k,I,S,T,_=new P.E({zoneId:a});if(c.getLine(b[0])?_.retain(c.pointToOffset({line:b[0],offset:b[1]})):(C=c.getLine(h).length()-1,_.retain(c.pointToOffset({line:h,offset:C})),_.insertEnter()),this.performOpsWithAttributes(l,_,i,n),O=O.concat(_),n[n.length-1]<p&&!g){for(var w=Object(B.b)(),O=O.concat(this.insertZoneDelta(new P.E({zoneId:a}),Object.assign(D()({},U.k.ZoneId,w),this.getZoneAttrsByZoneId(e,t)))),j=new P.E({zoneId:w}),M=f+n.length;M<=p;M++){var L,R=l.getLine(M).getOps();(L=j.ops).push.apply(L,N()(R))}Object(B.o)(j),O=O.concat(j)}return s.apply(O),r&&(k=d.selStart,I=d.selEnd,S=[b[0],k[1]],T=[y,I[1]],this.updateSelection(e,a,S,T)),Object(x.a)(b[0],E)}},{key:"convertEntire",value:function(e,t,n,i,r){var o=this.getZoneId(e,t,n);if(!o)return[];var a=e.getContentState(),s=a.getZoneState(t),c=a.getZoneState(o),l=s.getLine(n),u=l?l.getLineMarker():0,d=[n,0],h=c.length(),f=new P.E({zoneId:t}).retain(s.pointToOffset({line:d[0],offset:d[1]})).delete(1+u);return this.performOpsWithAttributes(c,f,i),Object(B.o)(f),a.apply(f),r&&this.updateSelection(e,t,d,d),Object(x.a)(n,n+h)}},{key:"convertRangeToZone",value:function(o,e,t,n){var a,s,i,r,c,l=this;e&&t&&t.length&&(Object(B.n)(o,e.zoneId)!==this.zoneType?(a=o.getContentState().getZoneState(e.zoneId),s=[],t.forEach(function(e){var t,n,i=a.getLine(e),r=Object(B.k)(i);Object(B.g)(r)?(t=l.getZoneAllOps(o,r),s.push.apply(s,N()(t))):(n=i.getOps().filter(function(e){return!Object(B.e)(l.zoneType,e)}),s.push.apply(s,N()(n)))}),i=t[t.length-1],r=a.getLine(i),c=[[t[0],0],[i,r.length()-1]],this.insertZone({editor:o,zoneId:e.zoneId,sel:c,attributes:n,beforeApply:function(e,t){var n=new P.E({zoneId:t}),i=U.d[l.zoneType].attribs;return s.forEach(function(e){var t=Object(h.default)(e);t.attributes=Object(d.default)(t.attributes,i),n.push(t)}),Object(B.o)(n),e.concat(n)},afterInsert:this.afterInsertZone})):this.convertFragment(o,e.zoneId,t,void 0,!0))}},{key:"convertToZone",value:function(t,e,n){var i=this;if(n&&n.selStart&&n.selEnd){var r=n.selStart,o=n.selEnd,a=[],s=!0;if("block_menu"===e){var c=r[0],s=!!Object(B.l)(t,n.zoneId,c,this.zoneType);a.push([c])}else{for(var l=[],u=r[0];u<=o[0];u++)this.isUnsupportLine(n,u)?(l.length&&a.push(l),l=[]):l.push(u),s=s&&!!Object(B.l)(t,n.zoneId,u,this.zoneType);l.length&&a.push(l)}if(a.length)return t.inCallStackIfNecessary("insertZoneByCommand",function(){t.makeNewEvent("insertZoneByCommand",function(){a.reverse().forEach(function(e){s?e.reverse().forEach(function(e){i.convertEntire(t,n.zoneId,e,void 0,!0)}):i.convertRangeToZone(t,n,e)})})}),s}}},{key:"updateSelectionAfterPaint",value:function(e,t,n){return Object(B.p)(e,t,n)}},{key:"insertZone",value:function(e){var t=e.editor,n=e.zoneId,i=e.lineNum,r=e.sel,o=e.attributes,a=e.beforeInsert,s=e.afterInsert,c=e.beforeApply;if(!this.checkIsAllowInsertZone(t,n))return null;var l=Object(B.b)(),u=r||[[i,0],[i,0]],d=O()(u,2),h=d[0],f=d[1],p=t.getContentState(),g=p.getZoneState(n),m=g.pointToOffset({line:h[0],offset:h[1]}),v=g.pointToOffset({line:f[0],offset:f[1]}),b=new P.e,y=new P.E({zoneId:n}).retain(m).delete(v-m);a&&a(y);var E=Object.assign(D()({},U.k.ZoneId,l),this.getDefaultZoneAttrs(o));return this.insertZoneDelta(y,E),b=b.concat(y),c&&(b=c(b,l)),p.apply(b),s&&s(l,E),this.updateSelectionAfterPaint(t,l),l}},{key:"tryConvertZone",value:function(n,e){var i=this,t=e.range,r=e.zoneType,o=e.attribKey,a=e.attribMap,s=t.zoneId,c=t.selStart,l=t.selEnd,u={zoneId:s,selStart:c,selEnd:l},d=!1;if(!n||!c||!l)return{range:u,isConverted:d};u.selStart=N()(c),u.selEnd=N()(l);var h=Object(x.a)(c[0],l[0]+1);if(Object(B.n)(n,s)===this.zoneType){var f=U.d[r];if(!f||!f.attribs.includes(o))return{range:u,isConverted:d};var p=n.managers.zoneToLineEntry[s];if(!p)return{range:u,isConverted:d};var g,m=p&&p.zone,v=this.convertFragment(n,s,h,a);return v.length&&(g=v[v.length-1],u.selStart[0]=v[0],u.selStart[1]=c[1],u.selEnd[0]=g,u.selEnd[1]=l[1],d=!0,u.zoneId=m),d&&this.updateSelection(n,m,u.selStart,u.selEnd),{range:u,isConverted:d}}var b=h.filter(function(e){var t=Object(B.l)(n,s,e);return t&&t.zoneType===i.zoneType}),y=b.length===h.length&&1===h.length;return b.reverse().forEach(function(e){var t=i.convertEntire(n,s,e,a,y);t.length&&(u.selEnd[0]+=t.length-1,d=d||!!t.length)}),d&&!y&&this.updateSelection(n,s,u.selStart,u.selEnd),{range:u,isConverted:d}}},{key:"tryToggleAttributeInZone",value:function(d,e,h,f){var t,p,g=this,m=e.zoneId,n=e.selStart,i=e.selEnd;n&&i&&(t=Object(x.a)(n[0],i[0]+1),p=d.getContentState(),t.forEach(function(e){var t=Object(B.l)(d,m,e);if(t&&t.zoneType===g.zoneType){for(var n=t.zoneId,i=p.getZoneState(n),r=i.length(),o=!0,a=0;a<r;a++){var s=i.getLine(a),c=s&&s.getLineAttributes().toMap();if(!c||c[h]!==f){o=!1;break}}var l=Object(x.a)(0,r),u=d.getRep(n).attributeManager;o?u.removeAttributeOnMultiLines(l,h):u.setAttributeOnMultiLines(l,h,f)}}))}}],[{key:"registerTransformer",value:function(e,t){l.transformers[e]=t}},{key:"tryConvertZone",value:function(t,e,n,i){var r=e.zoneId,o=e.selStart,a=e.selEnd,s={range:{zoneId:r,selStart:o,selEnd:a},isConverted:!1},c={range:{zoneId:r,selStart:o,selEnd:a},zoneType:Object(B.n)(t,e.zoneId),attribKey:n};return i&&(c.attribMap=D()({},n,i)),Object.values(l.transformers).forEach(function(e){e&&(s=e.tryConvertZone(t,c),c.range=s.range)}),s}}]),l}();l.transformers={},t.a=l},PiJo:function(e,t,n){"use strict";n.r(t);var i=n("o0o1"),d=n.n(i),r=n("yXPU"),o=n.n(r),a=n("9+78"),c=n.n(a),l=n("nN3d"),s=n("VIFs"),u=n("toa8"),h=n("AESI"),f=n("wN88");function p(e,t){return g.apply(this,arguments)}function g(){return(g=o()(d.a.mark(function e(r,o){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(t){var e=o.maxConcurrentCount,n=0;function i(){var e=r.shift();if("function"==typeof e)return e().then(i);--n<=0&&t()}for(;n<e;)i(),++n}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var m=n("+00W"),v=n.n(m);n.d(t,"generatePublicUrl",function(){return _}),n.d(t,"makePulicUrlEffective",function(){return M}),n.d(t,"makePublicUrlEffective",function(){return R});var b={},y={},E=3600,O="V4";function C(e){return Object(s.prependAPI)("/api/file/out/".concat(e,"/"))}function k(e){return Object(s.prependAPI)("/api/box/stream/download/asynccode/?code=".concat(e))}function I(e){var t=Object(f.c)(e),n=b[t];return n?C(n):(n=Object(l.c)(50),C(b[t]=n))}function S(e){var t=Math.round((new Date).getTime()/1e3),n=t+E,i="".concat(t,":").concat(n),r="Token:".concat(e),o=Object(l.c)(32),a=c()("".concat(o,"_").concat(r,"_").concat(i,"_").concat(O)),s="".concat(a,"_").concat(o,"_").concat(r,"_").concat(i,"_").concat(O);return v()(s)}function T(e){var t=y[e];return t?k(t):(t=S(e),k(y[e]=t))}function _(e){var t=e.originSrc,n=e.fileToken;return n?T(n):t?I(t):""}function w(e){return u.b.post("/api/file/copy_out/",{key_dict:JSON.stringify(e)}).catch(function(){console.error("doc  publicUrl ")})}function j(e){return u.b.post(h.MAKE_PUBLIC_URL_EFFECTIVE,{tokens:e}).catch(function(){console.error("drive  publicUrl ")})}function M(){return L.apply(this,arguments)}function L(){return(L=o()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([P(),U()]));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function R(){return N.apply(this,arguments)}function N(){return(N=o()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([P(),U()]));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(e,t){return x.apply(this,arguments)}function x(){return(x=o()(d.a.mark(function e(t,n){var i,r,o,a,s,c,l,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===(i=Object.keys(n)).length)return e.abrupt("return");e.next=3;break;case 3:if(r=50,i.length<=r)return e.next=7,t(n);e.next=9;break;case 7:e.next=15;break;case 9:for(o=2,a=[],s=0;s<i.length;){for(c={},l=Math.min(s+r,i.length);s<l;)u=i[s],c[u]=n[u],++s;a.push(t.bind(null,c))}return e.next=15,p(a,{maxConcurrentCount:o});case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function P(){return B.apply(this,arguments)}function B(){return(B=o()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(w,b);case 2:b={};case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U(){return z.apply(this,arguments)}function z(){return(z=o()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(j,y);case 2:y={};case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}},PlSv:function(e,t,n){},Pozx:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s});var i=n("j1lG"),r=n("mWyS");function o(e){return e===i.D.Doc}function a(e){return e===i.D.Drive}function s(e){return Object(r.a)(e)?i.D.Doc:Object(r.b)(e)?i.D.Drive:i.D.External}},PznQ:function(e,t,n){},Q2zD:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("Muja"),u=n("hbEN"),d=n("lE2N"),h=n("7EGn"),f=n("EOrr"),p=n("H6oK"),g=n("ALb8"),m=n("4PSP");function v(e){var t=Object.assign({},e);return["reminderBlockId","userProps","notCheckboxEntry","isFinish"].forEach(function(e){e in t&&delete t[e]}),t}n.d(t,"a",function(){return y});var b=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},y=function(){function t(e){r()(this,t),this.editor=e.editor,this.controller=new f.a(e.eventEmitter),this.bindEvents(),this.debounceMountedBlockCallback=Object(u.default)(this.mountedBlockCallback,300)}return a()(t,[{key:"linesWillReplace",value:function(e,t){var s,c,n,l=this,i=t.newLineEntries;i[0]&&i[0].zone&&(s=this.editor.getRep(i[0].zone),c=s.lines.indexOfKey(i[0].lineNode.id),(n=this.getLineReminders(s.zoneId,c))&&n.forEach(function(e){var t=e.blockId,n=e.props,i=[c,0],r=l.addContentProps({selStart:i,selEnd:i,zoneId:s.zoneId}),o=r.userProps,a=r.notCheckboxEntry;l.onContentChange(t,Object.assign({},n.data,{userProps:o,notCheckboxEntry:a}))}))}},{key:"reset",value:function(){this.debounceMountedBlockCallback.cancel(),this.unbindEvents()}},{key:"bindEvents",value:function(){this.controller&&(this.controller.onSetReminderProps(this.setReminderProps),this.controller.onGenerateBlock(this.generateBlock),this.controller.on(g.a,this.onClick),this.controller.on(g.c,this.onMouseEnter),this.controller.on(g.d,this.onMouseLeave),this.controller.on(g.b,this.onDelete))}},{key:"unbindEvents",value:function(){this.controller&&(this.controller.offSetReminderProps(this.setReminderProps),this.controller.offGenerateBlock(this.generateBlock),this.controller.off(g.a,this.onClick),this.controller.off(g.c,this.onMouseEnter),this.controller.off(g.d,this.onMouseLeave),this.controller.off(g.b,this.onDelete))}},{key:"addContentProps",value:function(e){var t=this.getLineIsFinishStatus(e);return{userProps:this.getRepUsers(e)||{},notCheckboxEntry:null===t?!0:!1}}},{key:"getCurrentLineSelection",value:function(e,t){var n=t.selStart[0],i=e.lines.atIndex(n);return{selStart:[n,0],selEnd:[n,i.width-i.lineMarker],selZone:t.selZone}}},{key:"getRepAttribs",value:function(e){var t=this.getCurrentLineSelection(e,e);return this.editor.getAttributesOnSelection(e.zoneId,t,!1)}},{key:"getLineReminders",value:function(e,t){var n=Object(h.default)(this.editor,"plugins.blockPlugin");return n?n.getBlocksDataForLine(p.BlockType.REMINDER_BLOCK,t,e):{}}},{key:"getRepUsers",value:function(e){var t=e.selStart[0],n=Object(h.default)(this.editor,"plugins.blockPlugin"),i={};return n&&n.getAllMentionsForLine(t,e.zoneId).forEach(function(e){i[e.id]=e}),i}},{key:"isCheckboxEnterInterface",value:function(e){var t=this.getRepAttribs(e).attribsKey;return!!t&&Object.keys(t).find(function(e){return Boolean(t[e]&&(-1<e.indexOf("list-done")||-1<e.indexOf("list-check")))})}},{key:"getLineIsFinishStatus",value:function(e){var t=e.selStart[0],n=Object(h.default)(this.editor,"plugins.blockPlugin");return!!n&&n.getLineCheckedState(t,e.zoneId)}},{key:"generateBlock",value:function(e,t){var n,i,r,o,a=p.BlockType.REMINDER_BLOCK,s=this.editor.getRep();this.isCheckboxEnterInterface(s)&&(n=Object(p.generateBlockDataSet)({blockType:a,creator:Object(p.getBlockCreator)(a,this.editor),props:{data:e.data}}),this.performBlockWithDataSet(n,t),t&&t.callback&&"function"==typeof t.callback&&(i=n.blockId,r=n.props,o=this.getRepUsers(s),this.debounceMountedBlockCallback(Object.assign({reminderBlockId:i},r.data,{userProps:o}),t.callback)))}},{key:"mountedBlockCallback",value:function(e,t){t(e)}},{key:"performBlockWithDataSet",value:function(e,t){var n=this.editor,i=n.plugins.blockPlugin,r=n.getAuthor(),o=n.getRep(),a=o.zoneId,s=o.selStart,c=o.selEnd,l=" ",u=[["author",r]].concat(i.getAttrsFromBlockDataSet(e));n.inCallStackIfNecessary("performReminderBlock",function(){n.fastIncorp(),n.performDocumentReplaceRangeWithAttributes(a,s,c,l,Object(d.a)(u,function(e){return e[0]}))})}},{key:"setReminderProps",value:function(e,t){var n=this.editor.plugins.blockPlugin.blockInfos.get(e).instance,i=v(Object.assign({},n.props.data,{},t.data));Object(l.default)(i,n.props.data)||(n.resetProps({data:i}),this.onContentChange(n.blockId,i))}},{key:"onContentChange",value:function(e,t){this.controller&&this.controller.propsChange(e,{data:t})}},{key:"onClick",value:function(e,t,n){var i,r,o,a=this.editor.domToRep(e);a&&a.selStart&&(r=(i=this.addContentProps(a)).userProps,o=i.notCheckboxEntry,this.controller&&(this.controller.click(t,{data:Object.assign({},n,{userProps:r,notCheckboxEntry:o})},{dom:e}),this.editor.selection.setWithSelection(a.selEnd[2],a.selEnd,a.selEnd),this.editor.selection.updateBrowserSelectionFromRep(!0)))}},{key:"onMouseEnter",value:function(e,t,n){var i,r,o,a=this.editor.domToRep(e);a&&a.selStart&&(r=(i=this.addContentProps(a)).userProps,o=i.notCheckboxEntry,this.controller&&this.controller.mouseEnter(t,{data:Object.assign({},n,{userProps:r,notCheckboxEntry:o})},{dom:e}))}},{key:"onMouseLeave",value:function(e,t){this.controller&&this.controller.mouseLeave(t,{dom:e})}},{key:"onDelete",value:function(e){this.controller&&(this.debounceMountedBlockCallback.cancel(),this.controller.reminderDelete(e))}}]),t}();b([Object(m.Bind)()],y.prototype,"addContentProps",null),b([Object(m.Bind)()],y.prototype,"generateBlock",null),b([Object(m.Bind)()],y.prototype,"setReminderProps",null),b([Object(m.Bind)()],y.prototype,"onContentChange",null),b([Object(m.Bind)()],y.prototype,"onClick",null),b([Object(m.Bind)()],y.prototype,"onMouseEnter",null),b([Object(m.Bind)()],y.prototype,"onMouseLeave",null),b([Object(m.Bind)()],y.prototype,"onDelete",null)},Q3NX:function(e,t,n){"use strict";function i(e){var t=document.createRange();t.selectNode(e);var n=window.getSelection();n&&(n.removeAllRanges(),n.addRange(t))}n.d(t,"a",function(){return i})},QQnO:function(e,t,n){},QYVc:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("lQZd");function r(){return"fake_"===Object(i.g)().slice(0,5)}},QbKL:function(e,p,g){"use strict";(function(I){g.d(p,"b",function(){return l}),g.d(p,"a",function(){return h});var e=g("o0o1"),S=g.n(e),t=g("lSNA"),n=g.n(t),i=g("yXPU"),r=g.n(i),o=g("xk4V"),T=g.n(o),a=g("toa8"),s=g("bsrO"),c=g("AESI"),_=g("Hj9z");function l(e){return u.apply(this,arguments)}function u(){return(u=r()(S.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return i=n.isDelete,r=void 0!==i&&i,o=n.linkUrl,a=void 0===o?"":o,s=n.lastSyncTime,c=void 0===s?0:s,l=n.filterId,u=void 0===l?"":l,d=n.filterName,h=void 0===d?"":d,f=n.jql,p=void 0===f?"":f,g=n.issueCount,m=void 0===g?0:g,v=n.issueMap,b=void 0===v?{}:v,y=n.fieldMap,E=void 0===y?{}:y,O=n.issues,C=void 0===O?[]:O,k={id:T()(),name:_.JiraFilterCreator.getFilterName(Number(u),I)||h||I("doc.jira.jira_filter"),fields:_.JiraFilterCreator.getDefaultFields(E),records:C.length?C:Object.keys(b),fieldVisibleMap:_.JiraFilterCreator.getDefaultFieldVisibleMap(E),exInfo:{type:1,rowHeight:1,isPrivate:!1,owner:"",filterInfo:null,sortInfo:[],groupInfo:[],fieldWidthMap:{},fieldStatTypeMap:{}}},e.abrupt("return",{isDelete:r,linkUrl:a,lastSyncTime:c,filterId:u,filterName:h,jql:p,issueCount:m,fieldMap:E,issueMap:b,issues:C,viewInfo:j(k)});case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w(e){return d.apply(this,arguments)}function d(){return(d=r()(S.a.mark(function e(t){var n,i;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(a.d)({url:c.JIRA_FILTER_GET_BY_URL,method:c.METHOD.GET,params:{url:t}});case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e.catch(0),i=e.t0.code,Object(s.l)(i,"filter");case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function h(e){return f.apply(this,arguments)}function f(){return(f=r()(S.a.mark(function e(t){var n,i;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(a.d)({url:c.JIRA_ISSUE_GET_BY_URL,method:c.METHOD.GET,params:{url:t}});case 3:return n=e.sent,e.abrupt("return",n.data.issue);case 7:e.prev=7,e.t0=e.catch(0),i=e.t0.code,Object(s.l)(i,"issue");case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function j(e){return{type:"",viewMap:n()({},e.id,e),views:[e.id]}}}).call(this,g("2vAP"))},QdK8:function(e,t,n){"use strict";n.d(t,"a",function(){return C});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("iP/4"),c=n("jp/M"),l=n("GVmr"),u=n("2ACu"),d=n("elsr"),h=n("cGQV"),f=c.platform.IOS,p=c.platform.ANDROID,g=c.platform.PC,m=s.a.isIOS,v=s.a.isAndroid,b=s.a.isMobile,y=m?f:v?p:g,E="client_performance_doc_scroll_quickjssdk",O=1e3/60,C=function(){function t(e){var s=this;r()(this,t),this.scrollEvent=null,this.maxMissFrameDuration=0,this.reset=function(){s.removeEvents()},this.bindEvents=function(){s.scrollEvent=s.detectScrollEvent(s.handleScrollStart,s.handleScrollEnd)},this.removeEvents=function(){s.scrollEvent.removeEvent(),s.scrollEvent=null},this.setupRAFMonitorLoop=function(){var t=performance.now();s.rAFId=requestAnimationFrame(function(){var e=performance.now();s.maxMissFrameDuration=Math.max(s.maxMissFrameDuration,e-t-O),s.setupRAFMonitorLoop()})},this.handleScrollStart=function(){var e=s.editor.blockRender.renderStartTime,t=e?performance.now()-e:-1,n=s.editor.docbody.offsetHeight,i=window.innerHeight,r=s.editor.getScrollTop()||0,o=r+i,a=s.getRenderedHeight();s.scrollStartLogParams={scroll_top:Object(h.a)(r)?r:-1,scroll_bottom:Object(h.a)(o)?o:-1,document_height:Object(h.a)(n)?n:-1,rendered_height:Object(h.a)(a)?a:-1,rendered_duration_time:Object(h.a)(t)?t:-1},s.setupRAFMonitorLoop()},this.handleScrollEnd=function(){var e;window.cancelAnimationFrame(s.rAFId),s.maxMissFrameDuration&&(e=s.maxMissFrameDuration,s.maxMissFrameDuration=0);var t=Object.assign({},s.scrollStartLogParams,{total_text:Object(l.d)(s.editor)},Object(l.a)(s.editor),{platform:y,if_render_in_scrolling:s.editor.blockRender.getIfRenderInScrolling(),scroll_miss_frame_duration:e});Object(u.collectSuiteEvent)(E,t),s.scrollStartLogParams=null},this.detectScrollEvent=function(t,n){var i,e=function(e){e.target===s.scroller&&(window.clearTimeout(i),i||t(),i=window.setTimeout(function(){i=void 0,n()},300))};return window.addEventListener("scroll",e,{passive:!0,capture:!0}),{removeEvent:function(){i&&(window.clearTimeout(i),i=void 0,n()),window.removeEventListener("scroll",e,{capture:!0})}}},this.editor=e,this.scroller=b?window:document.getElementsByClassName("etherpad-container-wrapper")[0],this.bindEvents()}return a()(t,[{key:"getRenderedHeight",value:function(){var e=this.editor.getRep(d.a),t=this.editor.blockRender.getLinesStatus()[d.a].findIndex(function(e){return!e.isRendered}),n=-1===t?e.lines.length()-1:Math.max(0,t-1),i=e.lines.atIndex(n);if(!i||!i.lineNode)return-1;var r=i.getLineRect();return r.top+r.height}}]),t}()},QgWq:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("lwsE"),r=n.n(i),c=n("y2sV"),o=function e(){var s=this;r()(this,e),this.collectContentLineText=function(e,t){var n=t.node,i=t.state.inOneNoteSchemas,r=n.parentNode&&n.parentNode.tagName||"",o=!n.textContent.trim();if(i&&(o&&("UL"===r||"OL"===r)))return[""]},this.checkOneNoteType=function(e,t){return"div"===e&&-1<t.innerHTML.indexOf("OneNote")},this.deserialize=function(e){var t=e.node,n=e.deltaSet;if(!t||t&&t.nodeType!==Node.TEXT_NODE)return n;var i=t.parentNode&&t.parentNode.tagName||"";if(!t.textContent.trim()&&("UL"===i||"OL"===i)){for(var r=t.parentNode,o=!1;r;){var a=(r.tagName||"").toLowerCase();if(s.checkOneNoteType(a,r)){o=!0;break}r=r.parentNode}if(o)return new c.e}return n}};new o},Qqsi:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d}),n.d(t,"a",function(){return h});var i=n("peh1"),r=n("5cZX"),o=n("fRsX"),a=n("iP/4"),s=n("D+Jz"),c=function(e){return e.appState.template},l=function(e){return c(e).isTemplateMode},u=function(e){return c(e).isTemplateVisible},d=function(e){return c(e).recommendTemplates},h=Object(i.createSelector)(u,r.e,function(e,t){return o.c&&!e&&!a.a.isLark&&t&&!Object(s.b)()})},QtEt:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("o0o1"),r=i.n(n),o=i("yXPU"),a=i.n(o);function s(){return c.apply(this,arguments)}function c(){return(c=a()(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([i.e("commons--FilePicker--attachment_preview_modal--box-utils-upload-v2--box_index--doc_uploader_delay----afa6617f"),i.e("commons--box-utils-upload-v2--box_right_bar--doc_uploader_delay--lark-upload-progress-viewer--nativ--93a0e733"),i.e("doc_uploader_delay")]).then(i.bind(null,"DugT"));case 2:return t=e.sent,n=t.createDocUploader,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}},QuVm:function(e,t,n){},Qvr1:function(e,t){e.exports='<div class=\'link-popup layout-row link-popup_hidden\'>\n    <svg\n        class=\'link-popup__triangle\'\n        width=\'20px\'\n        height=\'20px\'\n        viewBox=\'271 193 224 132\'\n        version=\'1.1\'\n        xmlns=\'http://www.w3.org/2000/svg\'>\n    \x3c!-- <polygon\n        id=\'Triangle\'\n        stroke=\'none\'\n        fill=\'#fff\'\n        fill-rule=\'evenodd\'\n        points=\'383 193 495 325 271 325\' /> --\x3e\n    </svg>\n    <div class=\'link-popup__input-group\'>\n        <div class=\'link-row\'>\n            <span class="link-row-text">{{{text}}}</span>\n            <input\n                type=\'text\'\n                spellcheck=\'false\'\n                placeholder="{{{addTextInfo}}}"\n                class=\'link-row-input text-input\' />\n        </div>\n        <div class=\'link-row\'>\n            <span class="link-row-text">{{{link}}}</span>\n            <input\n                type=\'text\'\n                spellcheck=\'false\'\n                class=\'link-row-input link-input\'\n                placeholder="{{{addLinkInfo}}}" />\n            <button class="link-submit">{{{sure}}}</button>\n        </div>\n    </div>\n    <div class=\'link-iframe hidden\'>\n      <div class="link-iframe__header">\n        <h4 class="link-iframe__title"></h4>\n        <i class="link-iframe__close">\n          <svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n              <g id="icon_global_close_nor">\n                <g id="Combined-Shape">\n                  <path d="M18.0129203,5.74210499 L18.507895,6.23707973 C18.6641047,6.39328945 18.6641047,6.64655544 18.507895,6.80276516 L13.0599477,12.2499477 L18.257895,17.4472348 C18.4141047,17.6034446 18.4141047,17.8567105 18.257895,18.0129203 L17.7629203,18.507895 C17.6067105,18.6641047 17.3534446,18.6641047 17.1972348,18.507895 L11.9999477,13.3099477 L7.05276516,18.257895 C6.89655544,18.4141047 6.64328945,18.4141047 6.48707973,18.257895 L5.99210499,17.7629203 C5.83589527,17.6067105 5.83589527,17.3534446 5.99210499,17.1972348 L10.9399477,12.2499477 L5.74210499,7.05276516 C5.58589527,6.89655544 5.58589527,6.64328945 5.74210499,6.48707973 L6.23707973,5.99210499 C6.39328945,5.83589527 6.64655544,5.83589527 6.80276516,5.99210499 L11.9999477,11.1899477 L17.4472348,5.74210499 C17.6034446,5.58589527 17.8567105,5.58589527 18.0129203,5.74210499 Z" id="Combined-Shape" fill="#646A73" fill-rule="nonzero"></path>\n                </g>\n              </g>\n            </g>\n          </svg>\n        </i>\n      </div>\n      <div class="link-iframe__main">\n        <input\n          type=\'text\'\n          placeholder="{{{iframeInputPlaceholder}}}"\n          spellcheck=\'false\'\n          class=\'link-iframe__input\' />\n        <a class="link-iframe__help hidden" target="_target">{{{help}}}</a>\n      </div>\n      <div class="link-iframe__footer">\n        <button class="link-iframe__example">{{{showExample}}}</button>\n        <button class="link-iframe__submit">{{{insert}}}</button>\n      </div>\n    </div>\n</div>\n'},R9xI:function(e,t,n){},RBWZ:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"i",function(){return a}),n.d(t,"m",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"f",function(){return h}),n.d(t,"j",function(){return f}),n.d(t,"c",function(){return p}),n.d(t,"o",function(){return g}),n.d(t,"k",function(){return m}),n.d(t,"e",function(){return v}),n.d(t,"h",function(){return b}),n.d(t,"p",function(){return y}),n.d(t,"q",function(){return E}),n.d(t,"d",function(){return O}),n.d(t,"n",function(){return C}),n.d(t,"l",function(){return k});var i=n("lSNA"),s=n.n(i),c=n("jp/M"),l=n("QM+C"),r=(n("D+Jz"),function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return{type:c.actionTypes.ui.CALL_TEMPLATE_CENTER,payload:e}}),o=function(e){return s()({type:c.actionTypes.template.CREATE_BLANK_FILE,payload:e},l.DEFERRED,!0)},a=function(){return s()({type:c.actionTypes.template.FETCH_TEMPLATE_LIST},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_LIST,method:c.apiUrls.METHOD.GET})},u=function(e){return s()({type:c.actionTypes.template.FETCH_TEMPLATE_SYS_LIST},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_SYS_LIST,method:c.apiUrls.METHOD.GET,params:e,options:{takeLatest:e&&e.takeLatest}})},d=function(e){return s()({type:c.actionTypes.template.FETCH_TEMPLATE_CUSTOM_LIST},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_CUSTOM_LIST,method:c.apiUrls.METHOD.GET,params:e,options:{takeLatest:e&&e.takeLatest}})},h=function(e){return s()({type:c.actionTypes.template.FETCH_TEMPLATE_CO_LIST},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_CO_LIST,method:c.apiUrls.METHOD.GET,params:e,options:{takeLatest:e&&e.takeLatest}})},f=function(){return s()({type:c.actionTypes.template.FETCH_TEMPLATE_LIST_V2},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_LIST_V2,method:c.apiUrls.METHOD.GET,params:{platform:"pc_st"}})},p=function(e,t,n,i){return s()({type:c.actionTypes.template.CREATE_BY_TEMPLATE},l.REQUEST,{url:c.apiUrls.POST_CREATE_BY_TEMPLATE,method:c.apiUrls.METHOD.POST,params:{type:e,token:t,parent_token:n,template_id:i}})},g=function(e){return s()({type:c.actionTypes.template.INSERT_TEMPLATE},l.REQUEST,{url:c.apiUrls.INSERT_TEMPLATE,method:c.apiUrls.METHOD.POST,data:{obj_type:e.objType,obj_token:e.objToken,template_obj_token:e.templateObjToken,base_rev:e.baseRev,member_id:e.memberId,extra:JSON.stringify(e.extra)}})},m=function(e){var t=e.platform,n=e.obj_type,i=e.obj_token,r=e.scene,o=e.num,a=e.version;return s()({type:c.actionTypes.template.FETCH_TEMPLATE_RECOMMENDATIONS},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_RECOMMENDATIONS,method:c.apiUrls.METHOD.GET,params:{platform:t,obj_type:n,obj_token:i,scene:r,num:o,version:a}})},v=function(e){var t=e.platform;return s()({type:c.actionTypes.template.FETCH_TEMPLATE_BANNER_RECOMMENDATIONS},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_BANNER_RECOMMENDATIONS,method:c.apiUrls.METHOD.GET,params:{platform:t}})},b=function(e){var t=e.platform,n=e.obj_type,i=e.scene,r=e.version;return s()({type:c.actionTypes.template.FETCH_TEMPLATE_GROUP},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_GROUP,method:c.apiUrls.METHOD.GET,params:{platform:t,obj_type:n,scene:i,version:r}})},y=function(e){return{type:c.actionTypes.template.SET_TEMPLATE_MODE,payload:e}},E=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return{type:c.actionTypes.template.TOGGLE_TEMPLATE_VISIBLE,payload:e}},O=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"tc",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"pc";return s()({type:c.actionTypes.template.FETCH_TEMPLATE_BANNER_LIST},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_BANNER_LIST,method:c.apiUrls.METHOD.GET,params:{scene:e,platform:t}})},C=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"pc";return s()({type:c.actionTypes.template.FETCH_TEMPLATE_TOPIC_LIST},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_TOPIC_LIST,method:c.apiUrls.METHOD.GET,params:{topic_id:e,obj_type:t,platform:n}})},k=function(e){return s()({type:c.actionTypes.template.FETCH_TEMPLATE_SEARCH_RECOMMEND},l.REQUEST,{url:c.apiUrls.GET_TEMPLATE_SEARCH_RECOMMEND,method:c.apiUrls.METHOD.GET,params:{search_scene_id:e},options:{takeLatest:!0}})}},RPIr:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("y2sV"),u=n("DNsP"),d=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},h=function(){function t(e){r()(this,t),this.editor=e}return a()(t,[{key:"editorWillPaste",value:function(e){var t=this.editor._inputModel.getInheritAttributes();delete t[u.a.TEXT],delete t[u.a.BACKGROUND],Object.keys(t).length&&(e.deltaSet=Object(l.H)(e.deltaSet,e.zoneId,t))}}]),t}();d([Object(l.J)(1001)],h.prototype,"editorWillPaste",null)},RTZD:function(e,t,n){},RooE:function(e,t,n){"use strict";n.d(t,"a",function(){return P}),n.d(t,"b",function(){return W});var i=n("RIqP"),s=n.n(i),r=n("lSNA"),u=n.n(r),o=n("J4zp"),f=n.n(o),a=n("lwsE"),c=n.n(a),l=n("W8MJ"),d=n.n(l),p=n("YNKm"),g=n("YWBl"),m=n("7Kxq"),h=(n("7+C2"),n("PznQ"),n("UXvI")),b=n("n+Ky"),y=n("HmyT"),v=n("dKDz"),E=n.n(v),O=n("FJEn"),C=n("KiC9"),k=n("oJoF"),I=n("q1tI"),S=n.n(I),T=n("y2sV"),_=n("MjSh"),w=n("SLR9"),j=n("Poi8"),M=n("nuq8"),L=n("PmjA"),R=n("zTCG"),N=n("TWwi"),D="list-code",x="list-code-span",P="codeblock-wrapper",B=/(?:^| )list-code(\d|\s|$)/,U={LIST:"list",LANG:"lang",START:"start"};function z(e){for(var t=null,n=e;n&&!(t=parseInt(e.start||e.getAttribute("start")));)n=n.parentElement;return t}var H=O.Changeset.numToString,F={wrapper:{backgroundColor:_.N100,lineHeight:1.5,borderWidth:1,borderColor:_.N300,borderStyle:"solid",fontSize:14,fontFamily:"SourceCodePro",marginTop:8,marginBottom:8}},V=S.a.createElement(T.z,{style:F.wrapper,className:P}),W=function(){function t(e){var v=this;c()(this,t),this.className="CodeBlock",this.highlightCache=new Map,this.maxCacheSize=200,this.aceInitialized=function(e,t){v._editorInfo=t.editorInfo,v.register(t.editorInfo),v._editorInfo.on(k.b,function(){return Object(M.b)(v.handleOnMessage)}),v._editorInfo.on(T.k.DID_PASTE,v.handleDidPaste)},this.register=function(e){var d="list",h="code",t="".concat(d,"-").concat(h);e.registerAceCommand(p.G,function(e,t,n,i){var r,o,a,s,c,l=i.source;i.extendCodeBlock&&(o=(r=t.getRep()).zoneId,a=f()(r.selStart,1)[0],(s=Object(C.c)(t,o,a))&&(c={zoneId:o,selStart:[s.start,0],selEnd:[s.end,0]}));var u=t.doInsertList({attribKey:d,attribValue:h,correctRange:c});Object(g.a)({action:L.a,op:u?m.g:m.f,source:l})},{statusKey:t})},this.aceAttribsToClasses=function(e,t){if("lang"===t.key)return["lang:".concat(encodeURI(t.value))]},this.renderWrapper=function(){return V},this._editorLineStateWillRender=function(e,t){var n,i,r,o,a,s,c,l,u,d,h,f,p=/mention-/,g=t.lineState,m=g.getLineAttributes().toMap();m&&m.list&&m.list.includes("code")&&m.lang&&b.a.getLanguage(m.lang)&&(n=m.lang,i=g.getZoneId(),r=g.getLineMarker(),a=n+"\n"+(o=g.getModelText()),(s=v.getCache(a))?t.lineState=g.compose(s):(c=b.a.highlight(m.lang,o.slice(1,o.length),!0),l=Object(j.h)(c.value),u=new T.E({zoneId:i}),d=0,u.retain(r),l.forEach(function(e){var t=e.startIndex,n=e.endIndex,i=e.classes;u.retain(t-d).retain(n-t,{codeClasses:i.join(" ")}),d=n}),h=new T.E({zoneId:g.getZoneId()}),f=!1,g.getOps().forEach(function(e){"string"==typeof e.insert&&(e.attributes&&Object.keys(e.attributes).some(function(e){return p.test(e)})?(h.retain(e.insert.length,{codeClasses:""}),f=!0):h.retain(e.insert.length))}),t.lineState=g.compose(f?u.compose(h):u),v.setCache(a,u)))},this.aceDomLineProcessLineAttributes=function(e,t){var n=t.spanClass,i=/(?:^| )lang:(\S+)/.exec(n);i&&(t.lineClass+=" lang-".concat(i[1]),t.processedMarker=!0)},this.aceCreateDomLine=function(e,t){t.lineClass.split(" ").includes(D)&&(t.spanClass+=" "+x)},this.deserialize=function(e){var n=e.node,t=e.deltaSet,i=e.zoneId;if(!Object(N.a)()){var r=t;if(n instanceof HTMLElement){var o=n.className,a=n.tagName,s=/lang-(\S+)/.exec(o),c=B.test(o),l=function(){var e,t=z(n);return Object(T.I)(r,i,(e={},u()(e,U.LIST,"code1"),u()(e,U.START,t||""),e))};return s&&(r=Object(T.I)(r,i,u()({},U.LANG,s[1]))),c||"CODE"===a&&Object(w.d)(n)?l():t}}},this.collectContentPre=function(e,t){var n=t.state,i=t.cls,r=void 0===i?"":i,o=/lang-(\S+)/.exec(r||"");o&&!r.includes(R.a.LINE)&&(n.lineAttributes[U.LANG]=o[1]),r&&B.test(r)&&(n.lineAttributes[U.LIST]="code1")},this.handleDidPaste=function(){var t=v._editorInfo.getRep(),e=v.pasteStartLine,n=t.selStart[0],i=t.apool.getAttribNum("list,code1");if(i)for(var r=new RegExp("\\*".concat(H(i),"[+\\*|]")),o=[],a=e;a<n;a++)r.test(t.alines[a])&&o.push(a),o.forEach(function(e){v.collectCodeContent(t.zoneId,e)})},this.collectContentPost=function(e,t){var n=t.cls,i=void 0===n?"":n,r=t.state;/lang-(\S+)/.exec(i||"")&&!i.includes(R.a.LINE)&&delete r.lineAttributes[U.LANG],i&&B.test(i)&&(delete r.lineAttributes[U.LIST],delete r.lineAttributes[U.START],r.listNesting&&(r.listNesting=0))},this.handleOnMessage=function(e){var i,t=e.data,r=t.area,o=t.language,a=t.zoneId;t.version===L.n&&(i=v._editorInfo,v.deleteFromAarray(r.firstLine,r.endLine),i.inCallStack("add-lang",function(){i.getInInternationalComposition()||(i.fastIncorp(),i.makeNewEvent("nonundoable",function(){var n="lang",e=r.endLine-r.firstLine+1,t=s()(new Array(e)).map(function(e,t){return r.firstLine+t}).filter(function(e){var t=i.getContentState().getZoneState(a).getLine(e).getLineAttributes().toMap();return t[n]!==o&&t.list&&-1<t.list.indexOf("code")});i.getRep(a).attributeManager.setAttributeOnMultiLines(t,n,o)}))}))},this.deleteFromAarray=function(e,t){for(var n=0;n<v.codeArray.length;++n)if(v.codeArray[n].firstLine===e&&v.codeArray[n].endLine===t)return v.codeArray.splice(n,1),!0;return!1},this.aceKeyEvent=function(e,t){var n=t.evt,i=t.editor,r=n.type;if(37===n.which||38===n.which||39===n.which||40===n.which)return!1;if("keyup"!==r)return!1;var o=i.getRep();(i.getAttributeOnLine(o.zoneId,o.selStart[0],"list")||"").includes("code")&&v.keyEventHandler(t)},this.keyEventHandler=Object(h.default)(function(e){var n=e.editorInfo;if(n.getInInternationalComposition())return!1;n.inCallStackIfNecessary("parse-lang",function(){var e=n.getRep(),t=e.selStart[0];if(n.getLineListType(e.zoneId,t).indexOf("code")<0)return!1;v.collectCodeContent(e.zoneId,t)},{shouldIncorp:!0})},500),this.collectCodeContent=function(t,e){var n=v._editorInfo,i=n.getReps()[t];if(!v.lineInArrayAlready(v.codeArray,e)){n.fastIncorp(),v.codeArray.push(v.findCodeArea(t,e));var r="",o=v.codeArray[v.codeArray.length-1],a=0,s=o.firstLine;do{var c=i.lines.atIndex(s),l=c.lineMarker?c.text.substr(c.lineMarker,c.text.length):c.text}while(r+=l+"\n",++s,l.trim()&&a++,s<=o.endLine);Object(M.b)(v.handleOnMessage).then(function(e){e.postMessage({zoneId:t,content:r,lineNumber:a,area:o,version:L.n})})}},this.aceCopy=function(e,t){var n,i=t.html,r=v._editorInfo.getRep(),o=r.selStart,a=r.selEnd;o&&a&&o[0]===a[0]&&((n=Object(y.$)("<div>")).html(i),n.find("code[class^=list-code]").length&&1===n.children().length&&n.children().hasClass(D)&&(t.html="<span>".concat(E()(n.text()),"</span>")))},this.serialize=function(e){if(!Object(N.a)()){var t,n,i=e.type,r=e.node,o=e.lineAttributes,a=o&&o.lang,s=o&&o.start;return i===T.u.LINE&&a&&s&&(t="code",(n=document.createElement(t)).classList.add("list-code"),n.classList.add("lang"+a),n.setAttribute("start",s),n.appendChild(r),e.node=n),e}},this.UNSAFE_editorNormalizePasteNode=function(e){var t,n,i;Object(N.a)()||(t=v._editorInfo.getRep(),v.pasteStartLine=t.selStart[0],!(n=e.pasteDataWrapper)||(i=Array.from(n.querySelectorAll("pre")).filter(function(e){return e.querySelector("code")})).length&&i.forEach(function(e){e.classList.add("list-code")}))},this.findCodeArea=function(e,t){for(var n=v._editorInfo,i=t,r=t;-1<n.getAttributeOnLine(e,i-1,"list").indexOf("code");)--i;for(;-1<n.getAttributeOnLine(e,r+1,"list").indexOf("code");)++r;return{firstLine:i,endLine:r}},this.lineInArrayAlready=function(e,t){return!(!e||e&&!e.length)&&-1<e.map(function(e){if(t>=e.firstLine&&t<=e.endLine)return!0}).indexOf(!0)},this.reset=function(){Object(M.a)(),v._editorInfo.off(T.k.DID_PASTE,v.handleDidPaste),v._editorInfo=null},this.codeArray=[],this.pasteStartLine=1,e&&this.aceInitialized("",Object.assign({editorInfo:e},e))}return d()(t,[{key:"isCodeBlockLine",value:function(e){return e.hasLineMarker()&&this.match("list",e.getLineAttributes().toMap().list||"")}},{key:"match",value:function(e,t){return"list"===e&&-1<t.indexOf("code")||"codeClasses"===e}},{key:"renderLine",value:function(e){return"code1"===e.lineState.getLineAttributes().toMap().list&&(e.lineClass+=" "+D),e.children}},{key:"render",value:function(e){return e.attributes.codeClasses&&(e.class+=" "+e.attributes.codeClasses),e.children}},{key:"editorWillPaste",value:function(e){var t=e.deltaSet,n=e.zoneId;if("code1"!==e.lineState.getLineAttributes().toMap().list)return t;var i=t.get(n),r=i.ops[0];return r&&r.attributes&&r.attributes.lmkr&&"code1"===r.attributes.list&&i.ops.shift(),t}},{key:"getCache",value:function(e){return this.highlightCache.has(e)?this.highlightCache.get(e):null}},{key:"setCache",value:function(e,t){var n=this.highlightCache;if(n.size>this.maxCacheSize){var i=0,r=!0,o=!1,a=void 0;try{for(var s,c=n[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;if(n.delete(l),++i>this.maxCacheSize/2)break}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}}n.set(e,t)}}]),t}();new W},RvHS:function(e,t,n){"use strict";var i,r,o,a,s,c;n.d(t,"i",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"h",function(){return s}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d}),n.d(t,"a",function(){return h}),n.d(t,"g",function(){return f}),(r=i=i||{})[r.High=0]="High",r[r.Low=1]="Low",(a=o=o||{}).PlainText="0",a.AESGCM="1",(c=s=s||{}).Destroy="DESTROY",c.FETCH="FETCH";var l="AES-CBC",u="AES-GCM",d="image/jpeg",h=200,f=2e3},Rvcf:function(e,t,n){"use strict";var i=n("2sVE"),r=n("VI6H"),o=[];t.a=function(){return 0<o.length?o:(o=i.b.embedIframeList.slice(),o=r.s?o.filter(function(e){return e.dataKey}):o.filter(function(e){return e.dataKey&&!e.isBytedanceUser}))}},"S/VI":function(e,t,n){},SCx9:function(e,t,n){"use strict";var i,r,o,a,s,c;n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return s}),(r=i=i||{}).Bubble="bubble",r.EDITOR_BAR="editorbar",r.SHORT_KEY="shortkey",(a=o=o||{}).COMMENT_FIRST_START_LOADING="commentFirstStartLoading",a.CLEAR_ACTIVE_COMMENT="clearActiveComment",a.CLICK_COMMENT_ON_DOC="clickCommentOnDoc",a.UPDATE_COMMENTABLE="updateCommentable",a.RENDER_COMMENTS="renderComments",a.START_NEW_COMMENT="startNewComment",a.CLICK_SAME_COMMENT_ON_POPUP="clickSameCommentOnPopup",a.HIDE_COMMENT_POPUP="hideCommentPopup",a.THIRD_PARTY_LOADED="thirdPartyLoaded",a.THIRD_PARTY_LOADIND="thirdPartyLoading",a.START_NEW_BEFORE="startNewBefore",a.OPEN_PANEL="openPanel",(c=s=s||{}).Doc="doc",c.Sheet="sheet",c.Bitable="bitable",c.Mindnote="mindnote"},"SD+I":function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=100,c=function(){function i(e){var t=this,n=e.imageStateInstance;r()(this,i),this.timerStartTime=null,this.rafId=null,this.batchOpList=[],this.hasDeselect=!1,this.rafLoop=function(e){e-t.timerStartTime>=s?t.doApply():t.rafId=window.requestAnimationFrame(t.rafLoop)},this.imageStateInstance=n}return a()(i,[{key:"doApply",value:function(){var i=this,e=this.imageStateInstance.getImageState(),t=e.onSelectionImageSet,n=e.selectedImageSet,r=new Set(n),o=new Set(t);this.batchOpList.forEach(function(e){var t=e.type,n=e.uuid;"deselect"===t?(i.hasDeselect=!0,r.delete(n),o.delete(n)):o.add(n)});var a={onSelectionImageSet:o};this.hasDeselect&&(a.selectedImageSet=r),this.imageStateInstance.setImageState(a),this.hasDeselect=!1,this.timerStartTime=null,this.rafId=null,this.batchOpList=[]}},{key:"initTimer",value:function(){this.timerStartTime=performance.now(),this.rafId=window.requestAnimationFrame(this.rafLoop)}},{key:"restartTimer",value:function(){this.timerStartTime=performance.now()}},{key:"handleThrottle",value:function(){this.rafId?this.restartTimer():this.initTimer()}},{key:"selectOnSelection",value:function(e){this.handleThrottle(),this.batchOpList.push({type:"select",uuid:e})}},{key:"deselectOnSelection",value:function(e){this.handleThrottle(),this.batchOpList.push({type:"deselect",uuid:e})}}]),i}();t.a=c},SFb0:function(e,t,n){},SLR9:function(e,t,n){"use strict";n.d(t,"a",function(){return S}),n.d(t,"d",function(){return T}),n.d(t,"b",function(){return w});var i,r,o,a,s,c=n("lwsE"),l=n.n(c),u=n("W8MJ"),d=n.n(u),h=n("U+yc"),f=n.n(h),p=(n("faYQ"),n("nVH4")),g=n("YWBl"),m=n("7Kxq"),v=n("YNKm"),b=n("/spq"),y=n("F9bh"),E=n("aBgF"),O=n("y2sV"),C=n("q1tI"),k=n.n(C),I=n("Nl7c"),S="IGNORE_INLINE_CODE";function T(e){if(e instanceof HTMLElement){var t=e.className,n=e.getAttribute("style");if(-1<t.indexOf("list-code"))return!0;if(/\bdisplay:\s*block\b/i.test(n))return!0}return!1}var _=k.a.createElement(O.w,{spellCheck:!1,className:"inline-code "}),w=(i=Object(b.a)(["aceKeyEvent"]),r=Object(I.a)(),o=Object(y.a)(),i((s=function(){function t(e){var o=this;l()(this,t),this.attributeKey="inline-code",this.aceInitialized=function(e,t){o.editorInfo=t.editorInfo,o.editorInfo.doInsertInlineCode=o.doInsertInlineCode,o.regist(o.editorInfo)},this.regist=function(e){var a="inline-code";e.registerAceCommand(v.D,function(e,t,n,i){var r=i.source,o=t.doInsertInlineCode({attribKey:"inline-code",attribValue:!0});Object(g.a)({action:a,op:o?m.g:m.f,source:r})},{statusKey:a})},this.getStyleType=function(e){var t=[];e&&(t=e.split(";"));for(var n=0;n<t.length;++n)if(-1<t[n].indexOf("background-color")){var i=/(^| )background-color:\s*(.*)/.exec(t[n]);if(i)return i[2]}},this.getNextPositionPoint=function(e,t,n){var i=[t[0],t[1]-1],r=[t[0],t[1]+1];return n!==p.c.LEFT||o.isInlineCodeAtPosition(e,r)?n!==p.c.RIGHT||0!==t[1]&&o.isInlineCodeAtPosition(e,i)?[]:r:i},this.isInlineCodeAtPosition=function(e,t,n){var i,r,o=e.selection.getZone();return!(!(r=n?(i=e.getReps()[o]).attributeManager.getAttributesOnSelection(t,[t[0],t[1]+1],i).attribs:e.getAttributesOnPosition(o,t[0],t[1]))||!r.some(function(e){return"inline-code"===e[0]}))},this.aceAttribsToClasses=function(e,t){if("inline-code"===t.key)return"inline-code"},e&&this.aceInitialized("",Object.assign({editorInfo:e},e))}return d()(t,[{key:"match",value:function(e){return e===this.attributeKey}},{key:"renderInlineWrapper",value:function(){return _}},{key:"reset",value:function(){this.editorInfo=null}},{key:"doInsertInlineCode",value:function(e){var t=e.attribKey,n=e.attribValue,i=e.isAllHasAttrib,r=e.isSpecialSelection,o=e.range,a=o.selStart,s=o.selEnd,c=o.attributeManager;return r?(c.setAttributesOnRange(a,s,[[t,i?"":n]]),i):this.editor.toggleAttributeOnSelection(t,o,n)}},{key:"aceKeyEvent",value:function(e,t){var n=t.evt,i=t.editorInfo,r=n.type,o=n.keyCode,a=n.shiftKey;if("keydown"!==r||Object(E.d)(n))return!1;if(o!==p.c.LEFT&&o!==p.c.RIGHT)return!1;if(!i.selection.isCaret())return!1;var s=i.getRep(),c=s.selStart,l=[c[0],c[1]+1],u=[c[0],c[1]-1],d=o===p.c.LEFT||o===p.c.BACKSPACE?this.isInlineCodeAtPosition(i,u,!0):this.isInlineCodeAtPosition(i,l);if(!d||o!==p.c.LEFT&&o!==p.c.RIGHT)return!1;var h=this.getNextPositionPoint(i,c,o);return!!h.length&&(n.preventDefault(),t.preventOtherHooksHandle=!0,i.setWithSelection(s.zoneId,a?c:h,h),i.updateBrowserSelectionFromRep(),!0)}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement){var r=t.tagName,o=t.className;if("CODE"===r&&!T(t)||"SPAN"===r&&-1<o.indexOf("inline-code"))return Object(O.H)(n,i,{"inline-code":"true"})}return n}}]),t}(),f()(s.prototype,"renderInlineWrapper",[r],Object.getOwnPropertyDescriptor(s.prototype,"renderInlineWrapper"),s.prototype),f()(s.prototype,"doInsertInlineCode",[o],Object.getOwnPropertyDescriptor(s.prototype,"doInsertInlineCode"),s.prototype),a=s))||a);t.c=new w},SNYb:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lwsE"),r=n.n(i),o=n("HmyT"),a=3,s=function e(){r()(this,e),this.className="TencentDocCopySupport",this.UNSAFE_editorNormalizePasteNode=function(e){var t,n=e.data.node,i=Object(o.$)(n).find(".document");n.innerHTML.includes("<melo-data")&&0<i.length&&(i.find("td").each(function(e,t){return Object(o.$)(t).html(t.innerHTML.trim())}),t=Array.from(i[0].childNodes).filter(function(e){return e.nodeType!==a}),i.html(t.map(function(e){return e.outerHTML}).join("")))}};new s},SQ87:function(e,t,n){"use strict";n.d(t,"g",function(){return g}),n.d(t,"f",function(){return b}),n.d(t,"b",function(){return y}),n.d(t,"a",function(){return E}),n.d(t,"h",function(){return O}),n.d(t,"j",function(){return C}),n.d(t,"c",function(){return k}),n.d(t,"i",function(){return I}),n.d(t,"d",function(){return S}),n.d(t,"e",function(){return T});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("J4zp"),_=n.n(s),c=(n("lSNA"),n("Muja")),l=n("U5G9"),v=n("4D8z"),u=n("Wwog"),d=n("FJEn"),h=(n("H6oK"),n("iP/4")),f=n("L1JX"),p=n("GixS"),g=(Object(l.b)({module:l.a.TABLE}),function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:v.l;return e-v.w+t}),b=function(e,t,n,i){var r,o=f.a.IS_FS_MODE?0:t.paddingRight,a=f.a.IS_FS_MODE?0:t.paddingLeft,s=f.a.TABLE_FULL_WIDTH_RIGHT,c=f.a.TABLE_FULL_WIDTH_WITH_COMMENT_RIGHT,l=0,u=0,d=i.width,l=e?1600<=d?c+v.h+v.g:900<=d?c+v.i+v.g:0:s,u=v.w,h=g(t.left-i.left,a);return n===v.q&&(r=i.right-t.right-l+o+2*p.b),{tableFullLeftMargin:h,tableFullRightMargin:r,tableVisibleWidth:d-u-l}},m=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!Object(c.default)(e[n],t[n]))return!1;return!0},y=Object(u.a)(function(e,t,n,i,r,o,a,s){return E({platform:o,fullWidth:n,scrollLeft:i,docbodyRect:e,tableTotalWidth:r,isCommentCross:a,showRightScrollShadow:s,containerRect:t})},m),E=function(e){var t=e.platform,n=e.fullWidth,i=e.docbodyRect,r=e.tableTotalWidth,o=e.isCommentCross,a=e.scrollLeft,s=e.containerRect,c=i.innerWidth,l={marginLeft:0,marginRight:0,paddingRight:0,docScrollWidth:null,tableScrollWidth:null,leftShadowOffset:0};if(!t)return l.docScrollWidth=c,l.tableScrollWidth=i.width,l;if(!n||r<=c||s.width<=900)return l;var u=b(o,i,t,s),d=u.tableFullLeftMargin,h=u.tableFullRightMargin,f=u.tableVisibleWidth,p=Math.min(a,d);if(c+h<r&&900<s.width){var g=f<=r?f:r+v.x,m=f<=r?d:g-c-h;return o||(l.paddingRight=v.x),l.marginLeft=-m,l.marginRight=-h,l.docScrollWidth=g,l.leftShadowOffset=-p,l.tableScrollWidth=c+h,l}return l.marginRight=-(r-c),l.docScrollWidth=r,l.tableScrollWidth=r,l};function O(){return{aceTable:function(e,t){var n=d.tableIds.getRowAndColIdFromTableValue(e),i=t.getVectorReps();return{pluginCounts:[["aceTable",1]],childReps:d.tableIds.getSortedTableCellIdsByTableIdFromVectorReps(i,n).map(function(e){return t.getRep(e)})}}}}function C(e){return 0<$(e).parents(".inner-zone-ace-editor-wrapper").length}function k(e,t,n){for(var i=-1,r=-1,o=e;0<=o&&-1===i;o--){for(var a=t;0<=a&&-1===r;a--){var s=n[o][a];(void 0===s.colspan||s.colspan&&0<s.colspan)&&(r=a)}var c=n[o][r];(void 0===c.rowspan||c.rowspan&&0<c.rowspan)&&(i=o)}return{rowIndex:-1===i?e:i,colIndex:-1===r?t:r}}function I(e,t){var n=t.getVectorReps(),i=e.split("x"),r=_()(i,3),o=r[1],a=r[2];if(!o||!a)return 0;var s=Object.keys(n).find(function(e){return n[e].vectorIds.includes(o)}),c=Object.keys(n).find(function(e){return n[e].vectorIds.includes(a)});if(!s||!c)return 0;var l=t.getVectorsRep(s,!0),u=t.getVectorsRep(c,!1),d=l.vectorIds.indexOf(o),h=u.vectorIds.indexOf(a);if(-1===d||-1===h)return 0;var f=t.changesetHelper.getAttributesPerCharacter(u.alines[0],t.getApool()),p=t.changesetHelper.getAttributesPerCharacter(l.alines[0],t.getApool())[d]||{},g=f[h]||{};if(p.mergeCellID&&g.mergeCellID){var m=p.mergeCellID.split(","),v="",b=!0,y=!1,E=void 0;try{for(var O,C=m[Symbol.iterator]();!(b=(O=C.next()).done);b=!0){var k=O.value;if(g.mergeCellID&&g.mergeCellID.includes(k)){v=k;break}}}catch(e){y=!0,E=e}finally{try{b||null==C.return||C.return()}finally{if(y)throw E}}if(0<v.length){for(var I=0,S=h-1;0<=S&&(f[S].mergeCellID&&f[S].mergeCellID.includes(v));S--)I+=w(f[S]);for(var T=h;T<f.length&&(f[T].mergeCellID&&f[T].mergeCellID.includes(v));T++)I+=w(f[T]);return I}}return w(g)}function w(e){return Number(e.colWidth)||v.r}var S=new(function(){function e(){r()(this,e),this.isRealMousedown=!1,this.invalidMousedown=!1,this.bindEvent()}return a()(e,[{key:"bindEvent",value:function(){var e=this;h.a.isSafari&&(document.addEventListener("mousedown",function(){e.isRealMousedown=!0}),document.addEventListener("mouseup",function(){e.isRealMousedown||(e.invalidMousedown=!0),e.isRealMousedown=!1}))}}]),e}());function T(e,t){for(var n=0,i=0;i<t;i++)n+=e[i];return n}},"SRA/":function(e,t,n){},SYRc:function(e,t,n){"use strict";var i,r,o,a;n.d(t,"a",function(){return i}),(r=i=i||{}).Default="Default",r.EmbeddedInSheet="EmbeddedInSheet",r.EmbeddedInDoc="EmbeddedInDoc",(a=o=o||{}).Default="Default",a.Table="Table"},SZqx:function(e,t,n){"use strict";var i=n("RIqP"),s=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),c=n.n(a),l=function(){function t(e){var d=this;o()(this,t),this.images=new Map,this.height=null,this.galleryToImages=function(e){var t=JSON.parse(e),n=new Map;return t.items.forEach(function(e){var t=e.uuid;n.set(t,e)}),n},this.getGalleryStringWithNewCommentAttribute=function(r,o){var a=[];return d.images.forEach(function(e,t){var n,i;t!==r?a.push(e):(n=[].concat(s()(e.comments||[]),[o]),i=Object.assign({},e,{comments:n}),a.push(i))}),JSON.stringify({items:a})},this.getGalleryStringWithChangeCommentAttribute=function(n,i){var r=[];return d.images.forEach(function(e){var t=[];e.comments.forEach(function(e){e!==n?t.push(e):i&&t.push(i)}),r.push(Object.assign({},e,{comments:t}))}),JSON.stringify({items:r})},this.isImageExists=function(e){return Boolean(d.images.get(e))},this.isCommentAttributeExists=function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=d.images.values()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)if(-1<r.value.comments.indexOf(e))return!0}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return!1},this.getComments=function(e,a){var s=new Map,c=new Map,t=d.groupByCommentStatus(e),l=t.resolvedCommentIds,u=t.operableCommentIds;return d.images.forEach(function(e,t){var n=e.comments,i=[],r=[];n&&n.forEach(function(e){var t,n=e.match(/comment-(id|resolved)-([0-9]+)/);n&&(t=n[2],-1<u.indexOf(t)?r.push(t):-1<l.indexOf(t)&&i.push(t))});var o=a.get(t)||[];s.set(t,r.concat(o)),c.set(t,i)}),{unResolvedComments:s,resolvedComments:c}},this.getImages=function(){return d.images},this.resolveComment=function(i){var r=[],o=new RegExp("comment-id-".concat(i));return d.images.forEach(function(e){var t=[];e.comments.forEach(function(e){o.test(e)?t.push("comment-resolved-".concat(i)):t.push(e)});var n=Object.assign({},e,{comments:t});r.push(n)}),JSON.stringify({items:r})},this.reopenComment=function(i){var r=[],o=new RegExp("comment-resolved-".concat(i)),a=!1;if(d.images.forEach(function(e){var t=[];e.comments.forEach(function(e){return o.test(e)?(a=!0,void t.push("comment-resolved-".concat(i))):void t.push(e)});var n=Object.assign({},e,{comments:t});r.push(n)}),a)return JSON.stringify({items:r})},this.images=this.galleryToImages(e)}return c()(t,[{key:"groupByCommentStatus",value:function(e){var t=[],n=[];return e.forEach(function(e){1!==e.finish?e.commentList.every(function(e){return 1===e.deleted})||n.push(e.commentId):t.push(e.commentId)}),{resolvedCommentIds:t,operableCommentIds:n}}},{key:"getCommentHeight",value:function(){return this.height}},{key:"setCommentHeight",value:function(e){this.height=e}},{key:"getResolvedCommentAttributes",value:function(){var r=new Map;return this.images.forEach(function(e,i){e.comments.forEach(function(e){var t=r.get(i);t||(t=[],r.set(i,t));var n=e.match(/comment-resolved-(\d+)/);n&&t.push(n[1])})}),r}}]),t}();t.a=l},ScS1:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29uX3Rvb2xfcHJldmlld3ZpZXdfbm9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IldlYi0xNioxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IkFydGJvYXJkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtODU0LjAwMDAwMCwgLTYwMC4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9Imljb25fdG9vbF9wcmV2aWV3dmlld19ub3IiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg1NC4wMDAwMDAsIDYwMC4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik01LjM1LDE3LjQ4ODkyOTkgTDE4LjY1LDE3LjQ4ODkyOTkgQzE4Ljg0MzI5OTcsMTcuNDg4OTI5OSAxOSwxNy42NTY4MjMxIDE5LDE3Ljg2MzkyOTkgTDE5LDE4LjYxMzkyOTkgQzE5LDE4LjgyMTAzNjcgMTguODQzMjk5NywxOC45ODg5Mjk5IDE4LjY1LDE4Ljk4ODkyOTkgTDUuMzUsMTguOTg4OTI5OSBDNS4xNTY3MDAzNCwxOC45ODg5Mjk5IDUsMTguODIxMDM2NyA1LDE4LjYxMzkyOTkgTDUsMTcuODYzOTI5OSBDNSwxNy42NTY4MjMxIDUuMTU2NzAwMzQsMTcuNDg4OTI5OSA1LjM1LDE3LjQ4ODkyOTkgWiBNNS41LDUgTDE4LjUsNSBDMTguNzc2MTQyNCw1IDE5LDUuMjIzODU3NjMgMTksNS41IEwxOSwxNC41IEMxOSwxNC43NzYxNDI0IDE4Ljc3NjE0MjQsMTUgMTguNSwxNSBMNS41LDE1IEM1LjIyMzg1NzYzLDE1IDUsMTQuNzc2MTQyNCA1LDE0LjUgTDUsNS41IEM1LDUuMjIzODU3NjMgNS4yMjM4NTc2Myw1IDUuNSw1IFogTTYuNSw2LjUgTDYuNSwxMy41IEwxNy41LDEzLjUgTDE3LjUsNi41IEw2LjUsNi41IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzJCMkYzNiI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4K"},Sd1l:function(e,t,n){"use strict";function i(e){var t,n,i=(i=e.match(/\s{1}?[PA]?M?/i))||e.match(/\s?[PA]?M+?/i),r=e.match(/(\d+)?(|:)?(\d+)?/),o="";return r&&0<r[0].length?o+=(t=r[0].split(/:|/))[0]+(1<t.length?":":"")+(t[1]||""):o+=(n=e.match(/\d+/))?n[0]:"",o+=(i?i[0]:"").toUpperCase()}n.d(t,"a",function(){return i})},SfZW:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=function(){function e(){r()(this,e),this.startTimestamp=new Map}return a()(e,[{key:"start",value:function(e){this.startTimestamp.set(e,performance.now())}},{key:"end",value:function(e){var t=this.startTimestamp.get(e);return(performance.now()-t).toFixed(4)}},{key:"clear",value:function(){this.startTimestamp.clear()}}]),e}();t.a=s},Sjdk:function(e,t,n){"use strict";var i=n("CnBM"),r=n.n(i),o=n("q1tI"),a=n.n(o);t.a=r()({loader:function(){return Promise.all([n.e("doc_index_css"),n.e("chunk_adit"),n.e(0),n.e(5),n.e(7),n.e("comment_textarea")]).then(n.bind(null,"MHQM"))},loading:function(){return null},render:function(e,t){var n=e.default;return a.a.createElement(n,Object.assign({},t,{ref:t.getRef}))}})},SnPR:function(e,r,o){"use strict";(function(e){o.d(r,"a",function(){return i});var t=o("J4zp"),u=o.n(t),d=o("gpFw"),n=o("q1tI"),h=o.n(n),f=e("anonymous.login");function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=new RegExp(t+f,"ig"),i=e.match(n);if(!i||1<i.length)throw new TypeError("No matched ".concat(f,'" or matched multiple result,\n    Indentifier such as "@" should be included before hypertext "').concat(f,'"\n    when content has mutiple "').concat(f,'".'));var r=i[0],o=e.split(r),a=u()(o,2),s=a[0],c=a[1],l=0<t.length?r.slice(t.length):r;return h.a.createElement("span",null,s,h.a.createElement(d.a,{loginText:l}),c)}}).call(this,o("2vAP"))},Ss5W:function(e,t,n){"use strict";n.d(t,"k",function(){return c}),n.d(t,"m",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"l",function(){return d}),n.d(t,"j",function(){return h}),n.d(t,"f",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"p",function(){return g}),n.d(t,"b",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"r",function(){return m}),n.d(t,"q",function(){return v}),n.d(t,"i",function(){return b}),n.d(t,"o",function(){return y}),n.d(t,"g",function(){return E}),n.d(t,"h",function(){return O}),n.d(t,"d",function(){return C});var i,r,o,a,s,c=864e5,l=10,u=20,d="origin",h="now",f="#",p={DOC_CREAT:1,DOC_EDIT:2,DOC_REVERT:3},g=60*(new Date).getTimezoneOffset()*1e3;(i=i||{}).DOC_BLOCK="DOC_BLOCK",(o=r=r||{}).add="__edit_add",o.del="__edit_del",o.change="__edit_change",(s=a=a||{}).EDIT="_edit",s.ADD="_edit_add",s.DEL="_edit_del",s.CHANGE="_edit_change";var m="highlight-",v="history-highlight",b=199,y="aceTable",E="gallery",O="image_uploaded",C="_edit_style_added"},SskX:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,(e.exports=n).id="SskX"},Svru:function(e,t,n){},T7Wt:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n.n(f),g=(n("17x9"),n("nHtH")),m=function(e){function n(e){var t;return r()(this,n),(t=c()(this,u()(n).call(this,e))).updateVisibilityChange=function(){var e;"hidden"===document.visibilityState?t.timer&&(clearInterval(t.timer),t.timer=null):(e=t.props.intervalTime,t.updateDate(),t.timer||(t.timer=setInterval(t.updateDate,e)))},t.updateDate=function(){var e=Object(g.c)(t.props.time);t.state.time!==e&&t.setState({time:e})},t.state={time:Object(g.c)(t.props.time)},t}return h()(n,e),a()(n,[{key:"componentDidMount",value:function(){var e=this.props.intervalTime;this.timer=setInterval(this.updateDate,e),document.addEventListener("visibilitychange",this.updateVisibilityChange),this.updateVisibilityChange()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.time!==e.time&&this.setState({time:Object(g.c)(e.time)})}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.time!==t.time}},{key:"componentWillUnmount",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null),document.removeEventListener("visibilitychange",this.updateVisibilityChange)}},{key:"render",value:function(){var e=this.props,t=e.className,n=void 0===t?"":t,i=e.prefix,r=void 0===i?"":i;return p.a.createElement("span",{className:n},r||"",this.state.time)}}]),n}(f.Component);m.defaultProps={intervalTime:2e4},t.a=m},TBry:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return E});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("q1tI"),u=n.n(l),d=n("YNKm"),h=n("YWBl"),f=n("7Kxq"),p=n("F9bh"),g=n("y2sV"),m=n("OWch"),v=n("Nl7c"),b=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},y="IGNORE_STRIKE_THROUGH",E=function(){function t(e){var a=this;r()(this,t),this.editor=e,this.className="Strikethrough",this.aceInitialized=function(e,t){a.register(t.editorInfo)},this.register=function(e){e.commands.registerAceCommand(d.X.toLowerCase(),function(e,t,n,i){var r=i.source,o=a.toggleAttribute({attribKey:"strikethrough",attribValue:!0});Object(h.a)({action:"strikethrough",op:o?f.g:f.f,source:r})},{statusKey:"strikethrough-true"})},this.aceAttribsToClasses=function(e,t){return"strikethrough"===t.key?["tag:s"]:null},this.editor=e,this.register(e)}return a()(t,[{key:"toggleAttribute",value:function(e){var t=e.attribKey,n=e.attribValue,i=e.range,r=e.isSpecialSelection,o=e.isAllHasAttrib,a=i.selStart,s=i.selEnd,c=i.attributeManager;return r?(c.setAttributesOnRange(a,s,[[t,o?"":n]]),o):this.editor.toggleAttributeOnSelection(t,i,n)}},{key:"serialize",value:function(e){return Object(g.P)(e,{tagAttribute:d.X,wrapTag:g.a[d.X]})}},{key:"match",value:function(e){return"strikethrough"===e}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement){var r=t.tagName,o=t.getAttribute("style")||"";if("S"===r||"DEL"===r||"STRIKE"===r||/\btext-decoration(-line)?:[^;]*line-through\b/i.test(o))return Object(g.H)(n,i,{strikethrough:"true"})}return n}},{key:"render",value:function(e){var t=e.children;return u.a.createElement(g.w,{style:{textDecoration:"line-through"}},t)}}]),t}();b([Object(p.a)()],E.prototype,"toggleAttribute",null),b([m.a,Object(v.b)()],E.prototype,"render",null)},TJjI:function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{}).EQUAL="equal",r.ALLOW_DOWN="allow_down",r.NEAR="near",r.ALLOW_UP="allow_up",r.ALLOW_UP_DEFAULT="allow_up_default"},TOQq:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("OX8E"),c=n("PmjA"),l=n("F7ws"),u=function(){function e(){r()(this,e),this.id=Object(l.a)(),e.controllerMap[this.id]=this}return a()(e,[{key:"editStatusChange",value:function(e){s.a.trigger(c.d.EDIT_STATUS_CHANGE+this.id,[e,this.id])}},{key:"onEditStatusChange",value:function(e){s.a.on(c.d.EDIT_STATUS_CHANGE+this.id,e)}},{key:"offEditStatusChange",value:function(e){s.a.off(c.d.EDIT_STATUS_CHANGE+this.id,e)}},{key:"destroy",value:function(){delete e.controllerMap[this.id],s.a.removeAllListeners(c.d.EDIT_STATUS_CHANGE+this.id)}}]),e}();u.controllerMap={},t.a=u},TRZa:function(e,t,n){"use strict";function i(e,t){return null==e?null==t:null!=t&&(e.selFocusAtStart===t.selFocusAtStart&&r(e.selStart,t.selStart)&&r(e.selEnd,t.selEnd)&&e.zoneId===t.zoneId)}function r(e,t){return null==e?null==t:null!=t&&(e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2])}function o(e){var t=e.selStart,n=e.selEnd;return t[0]===n[0]&&t[1]===n[1]}function a(e){var t=e.selStart,n=e.selEnd;return e.selFocusAtStart?t:n}function s(e){var t=e.selStart,n=e.selEnd;return null!=t&&null!=n&&2===t.length&&2===n.length}function c(e){var t=e.selStart,n=e.selEnd;return null!=t&&null!=n&&2===t.length&&2===n.length&&(t[0]<n[0]||t[0]===n[0]&&t[1]<n[1])}n.d(t,"d",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"e",function(){return c})},TRtO:function(e,t,n){"use strict";var a=n("kcBB"),s=n("lQZd"),c="error",i="info",r="warm",l="fatal",u="debug";function o(e,t,n){var i="";e!==c&&e!==l&&e!==u||(console.trace(),i=(new Error).stack||"");var r,o=window;o.lark&&o.lark.biz&&o.lark.biz.util.logger&&(r="".concat(d()," [").concat(e,"] FE token:").concat(Object(s.g)()," ").concat(t," ").concat(i),Object(a.a)()&&console.log(r,n||""),o.lark.biz.util.logger({logMessage:r}))}function d(){var e=new Date;return"".concat(h(e.getMonth()+1),"-").concat(h(e.getDate())," ").concat(h(e.getHours()),":").concat(h(e.getMinutes()),":").concat(h(e.getSeconds()),".").concat(h(e.getMilliseconds(),3))}function h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2,n=""+e;return e<Math.pow(10,t-1)&&(n="00000".slice(0,t-n.length)+e),n}t.a={info:function(e,t){o(i,e,t)},error:function(e,t){o(c,e,t)},warning:function(e,t){o(r,e,t)}}},TS0X:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29uX3Rvb2xfY2FyZHZpZXdfbm9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IldlYi0xNioxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IkFydGJvYXJkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtODU0LjAwMDAwMCwgLTU2Ni4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9Imljb25fdG9vbF9jYXJkdmlld19ub3IiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg1NC4wMDAwMDAsIDU2Ni4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJiZyIgZmlsbC1ydWxlPSJub256ZXJvIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiPjwvcmVjdD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik01LjgsOS44IEw1LjgsMTQuMiBMMTguMiwxNC4yIEwxOC4yLDkuOCBMNS44LDkuOCBaIE01LjgxMjUwMDU1LDE4LjMgTDE4LjE4OTE3MTUsMTguMyBMMTguMTg5MTcxNSwxOC42MjUgQzE4LjE4OTE3MTUsMTguNDk4ODQyNSAxOC4yNDg5MTQ0LDE4LjM3OTgxNzcgMTguMzQ4MDI4NCwxOC4zIEwxOC42MzkxNzE1LDE4LjMgQzE4LjU2MDEyOTksMTguMyAxOC40ODc4NDA3LDE4LjI4MTY5ODggMTguNDI1NDE4NSwxOC4yNSBDMTguNDg3ODQwNywxOC4yMTgzMDEyIDE4LjU2MDEyOTksMTguMiAxOC42MzkxNzE1LDE4LjIgTDE4LjM0ODAyODQsMTguMiBDMTguMjQ4OTE0NCwxOC4xMjAxODIzIDE4LjE4OTE3MTUsMTguMDAxMTU3NSAxOC4xODkxNzE1LDE3Ljg3NSBMMTguMTg5MTcxNSwxOC4yIEw1LjgxMjUwMDU1LDE4LjIgTDUuODEyNTAwNTUsMTcuODc1IEM1LjgxMjUwMDU1LDE4LjAwMTE1NzUgNS43NTI3NTc1OSwxOC4xMjAxODIzIDUuNjUzNjQzNTksMTguMiBMNS4zNjI1MDA1NSwxOC4yIEM1LjQ0MTU0MjE1LDE4LjIgNS41MTM4MzEyNywxOC4yMTgzMDEyIDUuNTc2MjUzNTIsMTguMjUgQzUuNTEzODMxMjcsMTguMjgxNjk4OCA1LjQ0MTU0MjE1LDE4LjMgNS4zNjI1MDA1NSwxOC4zIEw1LjY1MzY0MzU5LDE4LjMgQzUuNzUyNzU3NTksMTguMzc5ODE3NyA1LjgxMjUwMDU1LDE4LjQ5ODg0MjUgNS44MTI1MDA1NSwxOC42MjUgTDUuODEyNTAwNTUsMTguMyBaIE01LjY0MTE0MzA0LDUuOCBMNS44LDUuOCBMNS44LDUuNyBMNS42NDExNDMwNCw1LjcgQzUuNTY0NDk4NTgsNS43NjE3MjI2OSA1LjQ2NDMxMDc3LDUuOCA1LjM1LDUuOCBMNS42NDExNDMwNCw1LjggQzUuNzQwMjU3MDQsNS44Nzk4MTc2NyA1LjgsNS45OTg4NDI1MyA1LjgsNi4xMjUgTDUuOCw1LjggTDE4LjIsNS44IEwxOC4yLDYuMTI1IEMxOC4yLDUuOTk4ODQyNTMgMTguMjU5NzQzLDUuODc5ODE3NjcgMTguMzU4ODU3LDUuOCBMMTguNjUsNS44IEMxOC41NzA5NTg0LDUuOCAxOC40OTg2NjkzLDUuNzgxNjk4ODQgMTguNDM2MjQ3LDUuNzUgQzE4LjQ5ODY2OTMsNS43MTgzMDExNiAxOC41NzA5NTg0LDUuNyAxOC42NSw1LjcgTDE4LjM1ODg1Nyw1LjcgQzE4LjI1OTc0Myw1LjYyMDE4MjMzIDE4LjIsNS41MDExNTc0NyAxOC4yLDUuMzc1IEwxOC4yLDUuNyBMNS44LDUuNyBMNS44LDUuMzc1IEM1LjgsNS41MDExNTc0NyA1Ljc0MDI1NzA0LDUuNjIwMTgyMzMgNS42NDExNDMwNCw1LjcgTDUuMzUsNS43IEM1LjQ2NDMxMDc3LDUuNyA1LjU2NDQ5ODU4LDUuNzM4Mjc3MzEgNS42NDExNDMwNCw1LjggWiIgaWQ9Imljb25fdG9vbF9jYXJkLXZpZXdfbm9yIiBzdHJva2U9IiMyQjJGMzYiIHN0cm9rZS13aWR0aD0iMS42Ij48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="},TXAG:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 16 16"},t),c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("path",{d:"M0 0h16v16H0z"}),c.a.createElement("path",{d:"M10.8 3.39H5.2v.58c0 .15-.02.2-.05.27a.32.32 0 01-.13.13c-.06.03-.11.04-.27.04h-.5c-.16 0-.21-.01-.27-.04a.32.32 0 01-.13-.13c-.03-.06-.05-.12-.05-.27v-.58H2.4v10.24h11.2V3.4h-1.4v.58c0 .15-.02.2-.05.27a.32.32 0 01-.13.13c-.06.03-.11.04-.27.04h-.5c-.16 0-.21-.01-.27-.04a.32.32 0 01-.13-.13c-.03-.06-.05-.12-.05-.27v-.58zm1.4-1.37h2.1c.39 0 .7.31.7.69v11.6a.7.7 0 01-.7.69H1.7a.7.7 0 01-.7-.68V2.7a.7.7 0 01.7-.69h2.1v-.57c0-.16.02-.21.05-.27.03-.06.07-.1.13-.13S4.09 1 4.25 1h.5c.16 0 .21.02.27.05.06.03.1.07.13.13s.05.11.05.27v.57h5.6v-.57c0-.16.02-.21.05-.27.03-.06.07-.1.13-.13s.11-.05.27-.05h.5c.16 0 .21.02.27.05.06.03.1.07.13.13s.05.11.05.27v.57zM2.4 6.46h11.2v1.37H2.4V6.46z",fill:"#646a73"})))}},TaAU:function(e,t,n){},TfC2:function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"f",function(){return c});var i=64,r=2,o=i+2*r,a=34,s=20-2*r,c=9},TgJx:function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{})[r.NONE=0]="NONE",r[r.PAGED=1]="PAGED",r[r.NON_PAGED=2]="NON_PAGED"},"Tgf/":function(e,t,n){"use strict";var i=n("GGin"),r={container:{display:"inline-flex",boxSizing:"border-box",maxWidth:"100%",padding:n("j1lG").A,transition:"transform 0.1s ease"},image:{width:"100%",verticalAlign:"middle",maxHeight:"100%"},base:{display:"inline-block"},highlighted:{backgroundColor:i.f,outline:"4px solid ".concat(i.f)},position:{position:"absolute",left:0,top:0},innerContainerStyle:{display:"flex",alignItems:"flex-start",justifyContent:"inherit",whiteSpace:"nowrap",maxWidth:"100%",minWidth:0}};t.a=r},Tqb2:function(e,t,n){"use strict";n.d(t,"d",function(){return j}),n.d(t,"b",function(){return M}),n.d(t,"e",function(){return N}),n.d(t,"U",function(){return D}),n.d(t,"v",function(){return P}),n.d(t,"u",function(){return U}),n.d(t,"q",function(){return z}),n.d(t,"r",function(){return H}),n.d(t,"s",function(){return F}),n.d(t,"M",function(){return V}),n.d(t,"G",function(){return W}),n.d(t,"L",function(){return K}),n.d(t,"F",function(){return q}),n.d(t,"n",function(){return Y}),n.d(t,"o",function(){return J}),n.d(t,"f",function(){return Q}),n.d(t,"l",function(){return ee}),n.d(t,"m",function(){return te}),n.d(t,"c",function(){return ne}),n.d(t,"D",function(){return ie}),n.d(t,"K",function(){return ae}),n.d(t,"w",function(){return se}),n.d(t,"t",function(){return le}),n.d(t,"W",function(){return ue}),n.d(t,"V",function(){return de}),n.d(t,"R",function(){return he}),n.d(t,"p",function(){return fe}),n.d(t,"E",function(){return pe}),n.d(t,"H",function(){return ge}),n.d(t,"k",function(){return me}),n.d(t,"h",function(){return ve}),n.d(t,"B",function(){return be}),n.d(t,"T",function(){return ye}),n.d(t,"y",function(){return Ee}),n.d(t,"J",function(){return Oe}),n.d(t,"g",function(){return Ce}),n.d(t,"a",function(){return Ie}),n.d(t,"I",function(){return Se}),n.d(t,"j",function(){return Te}),n.d(t,"P",function(){return _e}),n.d(t,"Q",function(){return we}),n.d(t,"z",function(){return Me}),n.d(t,"x",function(){return Ae}),n.d(t,"i",function(){return Le}),n.d(t,"C",function(){return Re}),n.d(t,"S",function(){return Ne}),n.d(t,"O",function(){return xe}),n.d(t,"N",function(){return Pe}),n.d(t,"A",function(){return Be});var i=n("o0o1"),r=n.n(i),o=n("yXPU"),a=n.n(o),s=n("J4zp"),c=n.n(s),l=n("RIqP"),u=n.n(l),d=n("/xWd"),h=n("BpSZ"),O=n("j1lG"),C=n("Z/PY"),f=n("y2sV"),p=n("oTSI"),g=n("m8R6"),m=n("cGQV"),v=n("wN88"),b=n("3doy"),y=n("lQZd"),E=n("rLED"),k=n("elsr"),I=n("15MJ"),S=n("mWyS"),T=n("Pozx"),_=n("SQ87"),w=n("XB4d"),j=Array.prototype.flat?function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return e.flat(t)}:d.a;function M(e){if(!Object(h.b)(e))return null;var t=h.a.exec(e);if(!t||!t[1])return null;var n=t[1],i=t[2];return fetch(e).then(function(e){return e.blob()}).then(function(e){var t="data-url-convert-to-file-".concat(Date.now(),".").concat(i);return new File([e],t,{type:n})}).catch(function(e){return console.error("data url convert to file fail.",e),null})}function L(e){var t=e.naturalWidth,n=e.naturalHeight,i=e.displayHeight,r=e.displayWidth,o=1,a=1,s=0,c=0;return t&&n&&(s=Object(C.m)(t,n)),i&&r&&(c=Object(C.m)(r,i)),0<s&&s!==o?a=s:0<c&&c!==o&&(a=c),a}var R=function(e){var t=e.natrualHeight,n=e.natrualWidth,i=e.width,r=e.height;("100%"===i||"auto"===r)&&n&&t&&(i=n,r=t);var o=parseInt(t,10),a=parseInt(n,10),s=parseInt(r,10),c=parseInt(i,10);return{naturalHeight:o,naturalWidth:a,displayHeight:s,displayWidth:c,aspectRatio:L({naturalWidth:a,naturalHeight:o,displayWidth:c,displayHeight:s})}};function N(e){var t,n,i,r,o,a,s,c,l=e.uuid,u=e.image_type,d=e.src,h=void 0===d?"":d,f=e.size,p=e.comments,g=decodeURIComponent(h),m=Object(C.w)(e)||g,v=Object(T.a)(m),b=Object(S.c)(m),y=R(e),E={};return"isLocalAttribs"in e&&(t=e.uploading,n=e.uploadProgress,i=e.intermediateSrc,r=e.loadingShowPreview,o=e.sourceFileToken,a=e.needTransformToGallery,s=e.needSaveDriveImage,c=e.needSaveExternal,Object.assign(E,{uploading:t,uploadProgress:n,intermediateSrc:i,imageCategory:O.D.Drive,loadingShowPreview:r,sourceFileToken:o,needTransformToGallery:a,needSaveDriveImage:s,needSaveExternal:c})),Object.assign({uuid:l,token:b,serverSrc:g,originSrc:m,imageCategory:v,mimeType:u||"",fileSize:f,comments:p,size:y},E)}function D(e){var t=null;try{t=JSON.parse(e)}catch(e){console.error("[image plugin] gallery attribsString is not json string:",e)}return t}function x(e){return!!e&&"IMG"===e.tagName}function P(e){if(x(e))return e.dataset.uuid;var t=$(e).find("img")[0];return t&&t.dataset&&t.dataset.uuid||null}function B(e){var t=[[O.M],[O.K]];return e.getEntities(t)}function U(e){return H(B(e))}function z(e){var t={},n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.attributes,l=void 0===c?{}:c;if(l.author){var u=F(s),d=!0,h=!1,f=void 0;try{for(var p,g=u[Symbol.iterator]();!(d=(p=g.next()).done);d=!0)t[p.value.uuid]=l.author}catch(e){h=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(h)throw f}}}}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}function H(e){var n=[];return e.forEach(function(e){var t=F(e);if(t)return n.push.apply(n,u()(t))}),n}function F(e){var t,n,i=e.attributes;return i[O.K]?t=fe(O.K,i[O.K]):i[O.M]&&(n=t=fe(O.M,i[O.M]),c()(n,1)[0].comments=Te(i)),t||[]}function V(t){return t.attributes&&O.p.some(function(e){return!!t.attributes[e]})}function W(e){return e.attributes&&e.attributes.align&&"full"===e.attributes.align}function K(e){return e._getOps().some(function(e){return V(e)})}function Z(e,t){var n,i,r;Object(E.Q)()||t&&K(t)&&(i=(n=t._entry.getAllInstancesByName("gallery"))[n.length-1].id,r="image-upload-image-".concat(i),e.call("galleryImageChoosed",r))}function q(e,t){return Object(w.a)({editor:e,evt:t,isSpecialContent:function(e,t){return K(t)},selectContentCallback:function(e,t){return Z(e,t)}})}function Y(e,t){return e?t.selection._toModelRange({startContainer:e,startOffset:0,endContainer:e,endOffset:e.childNodes.length}):null}function J(n,e){return e.getEntities(function(e,t){return!!O.p.includes(e)&&t.includes(n.uuid)})}function Q(e){var t={items:[X(e)]};return JSON.stringify(t)}function X(e){var t=e.uuid,n=e.token,i=e.size,r=e.mimeType,o=e.fileSize,a=e.comments,s=void 0===a?[]:a,c=e.serverSrc,l=e.imageCategory,u=i.naturalHeight,d=i.naturalWidth,h=i.displayHeight,f=i.displayWidth,p=i.aspectRatio,g={uuid:t,src:encodeURIComponent(c),height:h.toString(),width:f.toString(),currHeight:h.toString(),currWidth:f.toString(),natrualHeight:u.toString(),natrualWidth:d.toString(),image_type:r,size:o,comments:s,pluginName:I.s,scale:p};return Object(T.b)(l)?g:Object.assign({},g,{file_token:n})}function ee(e){if(e.dataTransfer){var t=e.dataTransfer,n=t.items,i=t.files;if(n)return re(n);if(i)return oe(i)}return[]}function te(e){return ee(e).filter(function(e){return ae(e)})}function ne(e){if(e.dataTransfer){var t=e.dataTransfer,n=t.items,i=t.files;return n?Array.from(n).some(function(e){return e.type.startsWith("image")}):!!i&&!!Array.from(i).some(function(e){return e.type.startsWith("image")})}return!1}function ie(e){var t=(e.clipboardData||{}).files;return t?Array.from(t).filter(function(e){return ae(e)}):[]}function re(e){if(!e.length)return[];for(var t=[],n=0,i=Array.from(e);n<i.length;n++){var r=i[n].getAsFile();r&&t.push(r)}return t}function oe(e){return Array.from(e)}function ae(e){return!!e.type&&!!e.type.match(/image\/(gif|jpg|jpeg|bmp|png)$/)}function se(e){var t=null;return e.getEntities([]).forEach(function(e){V(e)&&(t=e)}),t}function ce(t){return new Promise(function(n,e){t||e(new Error("get image rect failed for without src."));var i=new Image;i.onload=function(){var e=i.width,t=i.height;n({naturalHeight:t,naturalWidth:e})},i.onerror=function(){e(new Error("get image rect failed for load image error."))},i.src=t})}function le(e){return{galleryAttribsString:e[O.K]||e[O.c],oldImageAttribsString:e[O.M]||e[O.d]}}function ue(e){var t=le(e),n=t.galleryAttribsString,i=t.oldImageAttribsString;if(n){var r=D(n);return r?r.items:[]}return i?[Object(m.c)(i)]:[]}function de(e){return ue(e).map(function(e){return N(e)})}var he=Object(p.a)(ce);function fe(e,t){return O.p.includes(e)&&t?(O.K.includes(e)?(n=D(t))&&(i=n.items.map(function(e){return N(e)})):i=[N(Object(m.c)(t))],i||null):null;var n,i}var pe=function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=3<arguments.length?arguments[3]:void 0,r=e.start,o=e.end,a=t.getContentState(),s=i?a.getZoneState(i):a.getActiveZone();if(n){var c=s.getLine(r.line),l=c.getOps(),u=l.length;if(l[0]&&l[0].insert===f.o&&u--,l[l.length-1]&&"\n"===l[l.length-1].insert&&u--,1===u)return{retainLen:s.pointToOffset({line:r.line,offset:0}),deleteLen:c.length(),isExclusive:!0}}var d=s.pointToOffset({line:r.line,offset:r.offset});return{retainLen:d,deleteLen:s.pointToOffset({line:o.line,offset:o.offset})-d,isExclusive:!1}};function ge(e,t,n){var i=e.line,r=e.zoneId,o=t.getContentState().getZoneState(r);if(!(i+1===o.length()))return!1;var a=o.getLine(i);return!!a&&n>=a.length()}function me(e,t){var n=Object(y.g)(),i={mountPoint:{type:b.MountPointType.DOC_IMAGE,token:n},coverOptions:t};return Object(v.e)(e,i)}function ve(e){return e.getEntities(Oe)}function be(e,t,n){return e.getEntities({start:t,end:n},Oe)}function ye(e){var t=e.map(function(e){return de(e.attributes)});return j(t)}function Ee(e,t){var n=t.line,i=t.zoneId;return i!==k.a?e.getLineNumInRootZone(i,n):n}function Oe(e){return-1<O.p.indexOf(e)}function Ce(e){return ke.apply(this,arguments)}function ke(){return(ke=a()(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,e){t||e("[image plugin] generateGifCover failed, no image src");var o=new Image;o.onload=function(){var e=document.createElement("canvas"),t=o.width,n=o.height;e.width=t,e.height=n;var i=e.getContext("2d");i&&(i.drawImage(o,0,0,t,n),r(e.toDataURL()))},o.onerror=e,o.src=t}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ie(e){var t=e.imageCategory,n=e.uploading,i=e.needTransformToGallery,r=e.needSaveExternal,o=e.needSaveDriveImage,a=!n||!(o||r||i);return[O.D.Drive,O.D.Doc].includes(t)&&a}function Se(e){return"image/gif"===e}var Te=function(e){return Array.from(Object.keys(e)).filter(function(e){return e.includes("comment-")})};function _e(e,t){return t.getEntities(e).find(function(e){return 0<e.text.length&&!e.attributes.lmkr})}function we(e){var t=e.start,n=t.zoneId,i=t.line;return n===k.a&&0===i}function je(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=n.getContentState().getZoneState(t).getLine(e);return r&&(i?r.getModelText():r.getText())}function Me(e,t){var n=e.start,i=n.line,r=n.zoneId,o=n.offset;return(je(i,r,t,!0)||"").slice(o)}function Ae(e,t,n){var i=n.getContentState().getZoneState(e).getLine(t);return i?H(i.getEntities([])):null}function Le(e,t,n){var i=n!==k.a,r=2*O.A*e;return t-(i?2*O.b:O.h+O.i)-r}function Re(e,t){return e===k.a?null:Object(_.i)(e,t)}function Ne(e){return Object(T.a)(decodeURIComponent(e.src))===O.D.Doc?Object(g.default)(e,["file_token"]):e}var De=function(e,t,n){if(!e.isCollapsed())return!1;var i=e.start,r=i.line,o=i.zoneId,a=t.getContentState().getZoneState(o).getLine(r);return!!a&&n(a)},xe=function(t,e){return De(t,e,function(e){return 0===t.start.offset})},Pe=function(t,e){return De(t,e,function(e){return t.start.offset===e.length()-1})};function Be(n,e){var t=e.getEntities(function(e,t){return e===O.c&&-1<t.indexOf(n)});return c()(t,1)[0]}},TqgO:function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"a",function(){return l});var i="op-author-line",r="HALF_FULL_SCREEN_UPDATE",o=52,a="op-symbol",s="op-author",c=48,l=26},"U/9v":function(e,t,n){},U5G9:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return c});var i=n("FJEn"),o=n("OX8E"),r=i.ChangesetHelper.ChangesetHelper,a={COMMENT:"comment",MENTION:"mention",HISTORY:"history",MINDMAP:"mindmap",SHEET:"sheet",BACK:"back",ATTRIBUTE_POSITION:"attribute_position",SELECTION_POPUP:"selection_popup",NOTE_TITLE:"note_title",INSERT_DIR:"insert_dir",CODEBLOCK:"codeblock",HYPERLINK:"hyperlink",TABLE:"table",HISTORY_NEW:"history_new",SUBSCRIPTION:"subscription"};function s(t){var e=new r;return e.setErrorHandler(function(e){throw e.silence||o.a.trigger("EtherpadPlugin:Error",[Object.assign({},t,{from:"etherpad",message:e.message,type:"changeset",editor:null})]),e}),e}function c(i,r){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.apply(null,t)}catch(e){o.a.trigger("EtherpadPlugin:Error",[Object.assign({},r,{from:"etherpad",message:e.message,type:"changeset",editor:null})])}}}},"U6+H":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDBweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgNDAgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8ZGVmcz4KICAgICAgICA8cmVjdCBpZD0icGF0aC0xIiB4PSIwIiB5PSIwIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiPjwvcmVjdD4KICAgICAgICA8bGluZWFyR3JhZGllbnQgeDE9Ijk4LjAzMSUiIHkxPSIwLjE2MSUiIHgyPSI1OC44ODglIiB5Mj0iNDAuNzY2JSIgaWQ9ImxpbmVhckdyYWRpZW50LTMiPgogICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMDA1MkNDIiBvZmZzZXQ9IjE4JSI+PC9zdG9wPgogICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMjY4NEZGIiBvZmZzZXQ9IjEwMCUiPjwvc3RvcD4KICAgICAgICA8L2xpbmVhckdyYWRpZW50PgogICAgICAgIDxsaW5lYXJHcmFkaWVudCB4MT0iMTAwLjY2NSUiIHkxPSIwLjQ1NSUiIHgyPSI1NS40MDIlIiB5Mj0iNDQuNzI3JSIgaWQ9ImxpbmVhckdyYWRpZW50LTQiPgogICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMDA1MkNDIiBvZmZzZXQ9IjE4JSI+PC9zdG9wPgogICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMjY4NEZGIiBvZmZzZXQ9IjEwMCUiPjwvc3RvcD4KICAgICAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPC9kZWZzPgogICAgPGcgaWQ9IkRvYy3ov57mjqUtSmlyYSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9ImppcmEtMSI+CiAgICAgICAgICAgIDxtYXNrIGlkPSJtYXNrLTIiIGZpbGw9IndoaXRlIj4KICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICAgICAgICAgIDwvbWFzaz4KICAgICAgICAgICAgPGcgaWQ9Ik1hc2siPjwvZz4KICAgICAgICAgICAgPGcgbWFzaz0idXJsKCNtYXNrLTIpIiBmaWxsLXJ1bGU9Im5vbnplcm8iIGlkPSJQYXRoIj4KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQuMDAwMDAwLCA0LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zMC4wNjE5ODA1LDAgTDE0Ljk1NDU2MjksMCBDMTQuOTU0NTYyOSwzLjc2NjQyOTU3IDE4LjAwNzg1NzQsNi44MTk3MjQwMiAyMS43NzQyODY5LDYuODE5NzI0MDIgTDI0LjU1NzI0ODQsNi44MTk3MjQwMiBMMjQuNTU3MjQ4NCw5LjUwNjcyMTMzIEMyNC41NTk3MDU5LDEzLjI2OTcyMTcgMjcuNjA5NTQ4NiwxNi4zMTk2ODczIDMxLjM3MjU0OSwxNi4zMjIxNDQ4IEwzMS4zNzI1NDksMS4zMTA1Njg1NiBDMzEuMzcyNTQ5LDAuNTg2OTY2NjI1IDMwLjc4NTk1MSwwIDMwLjA2MTk4MDUsMCBaIiBmaWxsPSIjMjY4NEZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTIyLjU4Njg0OTMsNy41Mjc0NzUyOCBMNy40Nzk1NTQ2Miw3LjUyNzQ3NTI4IEM3LjQ4MTg4OTIyLDExLjI5MDQ3NTcgMTAuNTMxNzMxOSwxNC4zNDA0NDEzIDE0LjI5NDg1NTIsMTQuMzQyODk4NyBMMTcuMDc3ODE2NywxNC4zNDI4OTg3IEwxNy4wNzc4MTY3LDE3LjAzODQ5NzIgQzE3LjA4MjYwODgsMjAuODAxNDk3NiAyMC4xMzQ1NDAzLDIzLjg0OTM3NDMgMjMuODk3NTQwNywyMy44NDkzNzQzIEwyMy44OTc1NDA3LDguODM4Mjg5NTkgQzIzLjg5NzU0MDcsOC4xMTQ0NDE5IDIzLjMxMDY5Nyw3LjUyNzQ3NTI4IDIyLjU4Njg0OTMsNy41Mjc0NzUyOCBMMjIuNTg2ODQ5Myw3LjUyNzQ3NTI4IFoiIGZpbGw9InVybCgjbGluZWFyR3JhZGllbnQtMykiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUuMTA3NDE3NSwxNS4wNTA2NSBMMCwxNS4wNTA2NSBDMCwxOC44MTcwOTA4IDMuMDUzNDA2MDQsMjEuODcwMzc0IDYuODE5NzI0MDIsMjEuODcwMzc0IEw5LjYxMTQwOTU0LDIxLjg3MDM3NCBMOS42MTE0MDk1NCwyNC41NTcyNDg0IEM5LjYxMzg2NzAxLDI4LjMxNjgwODQgMTIuNjU4NDI2MiwzMS4zNjU0MjI0IDE2LjQxODEwOSwzMS4zNzI1NDkgTDE2LjQxODEwOSwxNi4zNjEzNDE0IEMxNi40MTgxMDksMTUuNjM3NDkzNyAxNS44MzEyNjUyLDE1LjA1MDY1IDE1LjEwNzQxNzUsMTUuMDUwNjUgWiIgZmlsbD0idXJsKCNsaW5lYXJHcmFkaWVudC00KSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4K"},UAY2:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n.n(f),g=n("TSYQ"),m=n.n(g),v=(n("17x9"),n("2M8O"),function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return h()(t,e),a()(t,[{key:"render",value:function(){var e=m()("spiner",this.props.className),t={transform:"scale(".concat(this.props.scale,")")};return p.a.createElement("span",{className:e,style:t},p.a.createElement("span",{"aria-hidden":"true"}),p.a.createElement("span",{"aria-hidden":"true"}),p.a.createElement("span",{"aria-hidden":"true"}))}}]),t}(f.PureComponent));t.a=v},UH97:function(e,t,n){},UY5Z:function(e,t,n){"use strict";n.d(t,"b",function(){return h}),n.d(t,"a",function(){return r});var i=n("J4zp"),l=n.n(i),u=n("q1tI"),d=n("FJEn"),h=function(e,t){var n=t.key,i=t.zone;n&&i&&e.call(d.ASYNC_NODE_DID_UPDATE_EVENT,{key:n,zoneId:i})};function r(e,t,n){var i=t._entry,r=Object(u.useState)(!1),o=l()(r,2),a=o[0],s=o[1],c=Object(u.useCallback)(function(){a&&h(e,i)},[a]);return i&&!a&&(s(!0),i.registerInstance({instanceName:"gallery",displayType:d.DisplayType.Inline,isAsyncNode:!0,id:n})),[c]}},UeI0:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o});var f=n("PCTH"),i=function(n,e,t,i){var r=t[0],o=t[t.length-1],a=[],s=n.getReps()[e],c=n.lineTracker.collapseLines;if(c){var l=c.trackers[e].entries,u=[];for(t.forEach(function(e){u.push(l[e].output.renderCollapsed)});u.includes(!0);){for(var d=r;d<=o;d++)if(l[d].output.renderCollapsed){for(var h=d;!l[h].output.startOfCollapseSection;)h--;a.push(h)}a.forEach(function(e){var t=Object(f.e)(e,s);Object(f.c)(n,t,!0,n.isEditable(),i)}),t.forEach(function(e,t){u.splice(t,1,l[e].output.renderCollapsed)})}}};function r(e){var t=new RegExp("([a-z]+)([123456789])").exec(e);return t?{type:t[1],indent:Number(t[2])}:null}function o(e){return e["clientside-collapse"]?"true"===e["clientside-collapse"]:"true"===e.collapse}},Uizi:function(e,t,n){},Uy54:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o});var a=n("FJEn"),s=n("kESg"),i=function(e,t,n){return e.getAttributeOnLine(t,n,s.k.ZoneType)===s.l.CodeBlock?e.getAttributeOnLine(t,n,s.k.ZoneId):""};function r(e){return!(!e.insert||!e.attributes||e.attributes[s.k.ZoneType]!==s.l.CodeBlock)}function o(e,t){if(e===a.DEFAULT_REP_ZONE)return!1;var n=t.managers.zoneToLineEntry[e];if(!n)return!1;var i=t.getRep(n.zone).lines.indexOfEntry(n);if(i<0)return console.warn("can not find codeblock entry in container zone"),!1;var r=t.getContentState().getZoneState(n.zone).getLine(i);if(!r)return!1;var o=r.getAttributes().toMap();return o[s.k.ZoneType]&&o[s.k.ZoneType]===s.l.CodeBlock}},V2TW:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var i=n("VI6H"),r=function(){return Object(i.c)().get("id")||window.User.id},o=function(e){var t=/author-([0-9]+|-|z.+?z)/.exec(e);return t&&t[1]?t[1].replace(/[0-9]+|-|z.+?z/g,function(e){return"-"===e?".":"z"===e.charAt(0)?String.fromCharCode(Number(e.slice(1,-1))):e}):null}},VI8A:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=function(){function e(){r()(this,e),this.frame=void 0}return a()(e,[{key:"hasRequested",value:function(){return void 0!==this.frame}},{key:"request",value:function(){var t=this;return this.cancel(),new Promise(function(e){t.frame=window.requestAnimationFrame(function(){t.frame=void 0,e()})})}},{key:"cancel",value:function(){void 0!==this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=void 0)}}]),e}(),c=function(){function e(){r()(this,e),this.frame=void 0,this.timer=void 0}return a()(e,[{key:"hasRequested",value:function(){return void 0!==this.frame||void 0!==this.timer}},{key:"request",value:function(){var t=this;return 0<arguments.length&&void 0!==arguments[0]&&arguments[0]||this.cancel(),new Promise(function(e){t.frame=window.requestAnimationFrame(function(){t.frame=void 0,t.timer=window.setTimeout(function(){t.timer=void 0,e()})})})}},{key:"cancel",value:function(){void 0!==this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=void 0),void 0!==this.timer&&(window.clearTimeout(this.timer),this.timer=void 0)}}]),e}()},VN5G:function(e,t,n){"use strict";var i=n("f+gR"),r=n("x/Yo"),o=n("toa8"),a=n("Q9MD"),s=n("D7h9"),c=n("ZGZ5"),l=n("5cZX"),u=n("lwsE"),d=n.n(u),h=n("W8MJ"),f=n.n(h),p=n("cDf5"),g=n.n(p),b=n("7EGn"),m=n("xKvl"),y=n("1dfU"),v=n("fQzm"),E=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":g()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},O=parseInt(Object(b.default)(window,"DATA.clientVars.data.user_info.member_id"),10),C=function(){function e(){d()(this,e)}return f()(e,[{key:"logInitVersion",value:function(e){}},{key:"logVersionBreak",value:function(e){var t=e.localVersion;e.remoteVersion<t&&this.logLocateRemoteDiffVersion(e)}},{key:"logBroadcastVersion",value:function(e){var t=e.localVersion,n=e.remoteVersion,i=e.module,r=e.token,o=e.message;console.log("received! BROADCAST_".concat(i,"\n      localVersion: ").concat(t,"\n      remoteVersion: ").concat(n),o),v.b.info("IO: memberId(".concat(O,"):\n      BROADCAST_").concat(i,"\n      token: ").concat(Object(y.a)(r),"\n      localVersion: ").concat(t,"\n      remoteVersion: ").concat(n)),n<t&&this.logLocateRemoteDiffVersion(e)}},{key:"logLocateRemoteDiffVersion",value:function(e){}}]),e}();E([Object(m.a)("doc_comment_log_init_data_version",function(e){var t=e.args[0],n=t.aheadVersion,i=t.behindVersion,r=t.token,o=t.source,a=t.module;return{aheadVersion:n,behindVersion:i,source:o,token:Object(y.a)(r),module:a}})],C.prototype,"logInitVersion",null),E([Object(m.a)("doc_comment_log_broadcast_locate_remote_version",function(e){var t,n,i,r,o,a,s,c,l=e.args[0],u=l.localVersion,d=l.remoteVersion,h=l.source,f=l.token,p=l.module,g=l.message,m={},v=Object(b.default)(g,"data.message.context",null);return"COMMENT"===p&&v?(t=v.ACTION,n=v.REQUEST_ID,i=v.USER_ID,r=v.comment_id,o=v.reply_id,m={actionType:t,requestId:n,commentId:Object(y.a)(r),replyId:Object(y.a)(o),sendUserId:Object(y.a)(i)}):"COMMENT_REACTION"===p&&v&&(a=v.ACTION,s=v.REQUEST_ID,c=v.USER_ID,m={actionType:a,requestId:s,reactionKey:v.reaction_key,sendUserId:Object(y.a)(c)}),Object.assign({localVersion:u,remoteVersion:d,source:h,module:p,token:Object(y.a)(f),memberId:O},m)})],C.prototype,"logBroadcastVersion",null),E([Object(m.a)("doc_comment_log_locate_remote_diff_version",function(e){var t=e.args[0],n=t.localVersion,i=t.remoteVersion,r=t.source,o=t.token;return{localVersion:n,remoteVersion:i,source:r,module:t.module,token:Object(y.a)(o)}})],C.prototype,"logLocateRemoteDiffVersion",null);var k=new C,I=n("paQS"),S=n("kUgE"),T=n("WzBf"),_=n("rLED"),w=n("SebV");n.d(t,"a",function(){return L}),n.d(t,"b",function(){return R});var j=new i.a,M=new r.CommentRecordManager;function L(e,t){e&&"default"!==t||Object(w.a)("createCommentService token objType no collect");var n=j.getOrCreateCommentService({rootType:e,rootToken:t,commentRecordManager:M,getUserId:function(){return Object(c.a)(s.default.getState()).get("id")||window.User.id},getMemberId:function(){return Object(a.b)(s.default.getState())},getIsOwner:function(){return Object(l.F)(s.default.getState())},getLanguage:S.getLanguage,msgBox:Object(_.d)("message_msgBox_enable")?T.a:null,messageVersion:3,isNewMentionUi:Object(_.G)(),isCommentMergeMessage:!1});return n.setupRequest(o.d),n.setupLogger(k),n}function R(e,t,n){n||(j.destroyCommentService(t),M.destroyCommentRecord(e,t),I.a.destroy({suiteType:e,suiteToken:t}))}},VXMt:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("GVmr"),u=n("2ACu"),d=n("4PSP"),h=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},f=function(){function t(e){var o=this;r()(this,t),this.lastMounted=0,this.lastFocused=0,this.lastEdited=0,this.initialTotalText=0,this.initialTotalTextLines=0,this.editable=!1,this.sendStatics=function(){var e=o.lastMounted,t=o.lastEdited,n=o.lastFocused,i=o.initialTotalText,r=o.initialTotalTextLines;Object(u.collectSuiteEvent)("client_performance_doc_block_render_statistics",{initial_total_text:i,initial_total_text_lines:r,mount_percentage:e,focus_percentage:n,edit_percentage:t,editable:o.editable})},this.editor=e,this.handleEventBinding("on")}return a()(t,[{key:"handleEventBinding",value:function(e){"on"===e&&window.addEventListener("beforeunload",this.sendStatics),"off"===e&&window.removeEventListener("beforeunload",this.sendStatics)}},{key:"getTotalLines",value:function(){return this.editor.getRep("0").alines.length}},{key:"toPercentage",value:function(e,t){return e/t*100}},{key:"getSelectionEndLine",value:function(){var e=this.editor.getRep(),t=e.selEnd[0],n=e.zoneId;return"0"===n?t:this.editor.getLineNumInRootZone(n,t)}},{key:"pluginReadWrite",value:function(){this.editable=!0}},{key:"clientVars",value:function(){this.initialTotalText=Object(l.d)(this.editor),this.initialTotalTextLines=this.getTotalLines()}},{key:"lineNodesMounted",value:function(e,t){var n=t.mountedLines,i=this.toPercentage(n[n.length-1],this.getTotalLines());this.lastMounted<i&&(this.lastMounted=i)}},{key:"aceSelectionChanged",value:function(){var e=this.getSelectionEndLine(),t=this.toPercentage(e,this.getTotalLines());this.lastFocused<t&&(this.lastFocused=t)}},{key:"aceKeyEvent",value:function(){var e,t,n;this.editable&&(e=this.getSelectionEndLine(),t=this.toPercentage(e,this.getTotalLines()),(null===(n=this.lastEdited)||n<t)&&(this.lastEdited=t))}},{key:"reset",value:function(){this.sendStatics(),this.handleEventBinding("off")}}]),t}();h([Object(d.Debounce)(200)],f.prototype,"aceKeyEvent",null)},Va3G:function(e,t,n){},VeEP:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("OX8E"),c=n("kESg"),l=new(function(){function e(){r()(this,e)}return a()(e,[{key:"allZoneDidRender",value:function(){s.a.trigger(c.f.ALL_ZONE_DID_RENDER)}},{key:"onAllZoneDidRender",value:function(e){s.a.on(c.f.ALL_ZONE_DID_RENDER,e)}},{key:"offAllZoneDidRender",value:function(e){s.a.off(c.f.ALL_ZONE_DID_RENDER,e)}}]),e}());t.a=l},Vor4:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("2ACu"),c=n("7Kxq"),l=n("fQzm"),u=n("YWBl"),d=n("sFgt"),h=n("Z5sO"),f=function(){function e(){r()(this,e)}return a()(e,[{key:"logClickPopup",value:function(e){var t="",n="";e instanceof HTMLElement&&(t=e.id,n=e.className),Object(s.collectSuiteEvent)("comment",{action:"click_comment_popup",source:"popup",eventType:"click",targetId:t,targetClass:n})}},{key:"logTriggerStartNewCommentByEditorbar",value:function(e){Object(u.a)({action:"comment",op:c.f,source:"editorbar",eventType:"click",target:e})}},{key:"logTriggerStartNewCommentByShortcut",value:function(){Object(u.a)({action:"comment",op:c.f,source:"shortKey",eventType:"keydown"})}},{key:"logPcUpdateComments",value:function(e){Object(s.default)("pc_editor_update_comments",{fromType:e})}},{key:"logResolveCommentError",value:function(e,t){Object(s.collectSuiteEvent)("resolve_comment_error",{commentId:e,docPositions:t})}},{key:"logChangesetApply",value:function(e){l.b.info("comment_changeset",Object(d.l)(e))}},{key:"logPositionUpdate",value:function(i,r){Object(h.b)(function(){var e=i.positions.map(function(e){return e.docPositions}),n=[],t=r.map(function(e){var t={commentId:e.commentId,docPositions:e.docPositions};return e.visible||n.push(t),t});n.length&&Object(s.collectSuiteEvent)("position_update_unmounted_comments",n),l.b.info("comment_position_update",e,t)})}}]),e}()},Vr4U:function(e,q,Y){"use strict";Y.r(q),function(i){Y.d(q,"default",function(){return B}),Y.d(q,"docMention",function(){return Z});var e=Y("J4zp"),a=Y.n(e),t=Y("o0o1"),r=Y.n(t),n=Y("yXPU"),o=Y.n(n),s=Y("lwsE"),c=Y.n(s),l=Y("W8MJ"),u=Y.n(l),U=(Y("kooH"),Y("HmyT")),z=Y("mRaX"),H=Y("AiBH"),F=Y("7Kxq"),d=Y("7EGn"),h=Y("OZf9"),f=Y("UXvI"),p=Y("Bq+3"),g=Y("9h4r"),m=Y("pIdd"),v=Y("FGOA"),V=Y("iP/4"),b=Y("aXiW"),y=Y("H6oK"),E=Y("2ACu"),O=Y("lG83"),C=Y("dDhe"),k=Y("Hydg"),I=Y("OX8E"),S=Y("nQY9"),T=Y("lQZd"),_=Y("VI6H"),w=Y("/fVd"),W=Y("QM+C"),j=Y("rLED"),K=Y("D28M"),M=Y("y2sV"),L=Y("whZn"),R=Y("oJoF"),N=Y("Mvmg"),D=Y("PI5S"),x=Y("Guq5"),P=32,B=function(){function n(e){var s=this;c()(this,n),this.className="Mention",this.customIconEnable=Object(j.n)(),this.callbackQueueInNextTick=[],this.hasPressedAt=!1,this.init=function(){Object(C.c)()||s.initContainer(),s.cache={},s.handleResize=Object(f.default)(s.onResize,500),s.hover=new g.a(s.props),v.a.init();var e=s.props,t=e.showChatCards,n=e.source,i=e.type;t&&m.a.init({editor:s.editor,source:n}),s.mentionNotification=new S.a({editor:s.props.editor,boxType:i,fileType:Object(T.l)(),fileToken:Object(T.g)()}),s.editor.on(H.l,s.hidePopover),s.editor.on(k.a.ADD_MENTION_NOTIFY,s.onAddUserMentionNotify),s.editor.on(H.B,s.handleAfterTableRegister),s.props.controller&&s.props.controller.onReferenceListMount(s.pullAllMentionObjects)},this.hidePopover=function(e){var t=e.isDragging;s.hover&&s.hover.setCanShowPopover(!t)},this.handleAfterTableRegister=function(){s.initEmbedObjMap()},this.hasTriedPullingMention=!1,this.onMount=function(){s.updateMentionInfo({0:s.editor.getClientVars().apool.numToAttrib}),window.addEventListener("click",s.onWindowClick),I.a.on(H.D,s.toggleEmbedObjClassName),s.props.controller&&s.editor.on(R.b,o()(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Y.e("doc_index_css"),Y.e("chunk_adit"),Y.e("commons--doc_index_delay--voteEmoji--votePicker"),Y.e(16),Y.e("commons--doc_index_delay--jira"),Y.e("doc_index_delay")]).then(Y.bind(null,"GYvY"));case 2:if(t=e.sent,n=t.default,s.editor){e.next=6;break}return e.abrupt("return");case 6:s.mentionFileManager=new n,s.docMention.setMentionFileManager(s.mentionFileManager),s.hasTriedPullingMention&&s.pullAllMentionObjects();case 9:case"end":return e.stop()}},e)})))},this.pullAllMentionObjects=function(){var e,t=s.mentionFileManager,n=s.props.controller;t&&n?(e=t.pullAllMentionObjects(s.editor),n.mentionFileListChange(e)):s.hasTriedPullingMention=!0},this.toggleEmbedObjClassName=function(e,i){var t,r;s.editor&&(t=Object(L.b)(s.editor,e),r="content-with-lock",s.editor.getObserver().withoutRecordingMutations(function(){t.forEach(function(e){var t,n=e.querySelector("a");n&&(t=n.classList.contains(r),i?t||n.classList.add(r):t&&n.classList.remove(r))})}))},this.initEmbedObjMap=function(){var e;s.embedObjShareEnable&&(e=function(e){return 0===Object.keys(e).length},w.a&&e(w.a.embedObjMap)&&w.a.initEmbedObjMap(s.editor))},this.lineNodesRendered=function(e,t){var n=t.data,i=n.lineEntries,r=void 0===i?[]:i,o=n.isFirstBlock,a=r.map(function(e){return e&&e.lineNode});setTimeout(function(){o||m.a.updateWithNodes(s.editor,a)})},this.lineNodesMounted=function(e,t){var n;s.embedObjShareEnable&&(n=w.a&&w.a.cantReadFiles||{},Object.keys(n).forEach(function(e){var t=n[e];s.toggleEmbedObjClassName(e,t)}))},this.searchStringRange=function(e,t){t.attributeList.find(function(e){return-1<e.indexOf("mention-chatId_")||-1<e.indexOf("drive-fileId")})&&(t.isSearchable=!1)},this.aceInitialized=function(e,t){s.editor=t.editorInfo,s.docMention.editor=s.editor,s.init()},this.initContainer=function(){var e=s.editor.getDocBody(),t=Object(U.$)(e).parents(".etherpad-container");t.length||(t=Object(U.$)(e).parent()),s.$positionHolder=Object(U.$)(".doc-position"),s.$positionHolder.length||(s.$positionHolder=Object(U.$)('<div class="doc-position"></div>'),t.prepend(s.$positionHolder))},this.updateMentionInfo=function(e){m.a.update(s.editor,e)},this.collectText=function(e,t){var n=t.attributes;if(-1<(n?n.map(function(e){return e[0]||""}).join(" "):"").indexOf("mention-chatId"))return"[".concat(i("etherpad.lark.group.card"),"]")},this.collectCommentTargetType=function(e,t){var n=t.node;if(-1<Object(d.default)(n,"children[0].className","").indexOf("mention-chatId"))return"groupCard"},this.onWindowClick=function(){I.a.trigger(k.a.HIDE_SHARE_POPUP)},this.onAddUserMentionNotify=function(e){var t=e.user,n=e.blockId;s.mentionNotification.addMentionNotify({userId:t.id,userName:Object(_.q)(t),isExternal:t.is_external,blockId:n,notNotify:t.not_notify,blockNotify:t.block_notify})},this.nextTick=function(e){s.callbackQueueInNextTick.push(e)},this.changesetApply=function(e,t){var n,i=t.changeset,r=t.editor;i&&(n=r.getAttributesFromChangeset(t.changeset),Object.keys(n).length&&(m.a.update(r,n),s.callbackQueueInNextTick.forEach(function(e){return e()}),s.callbackQueueInNextTick=[],s.docMention.changesetApply(e,t)))},this.reset=function(){window.removeEventListener("click",s.onWindowClick),I.a.off(H.D,s.toggleEmbedObjClassName),s.editor.off(k.a.ADD_MENTION_NOTIFY,s.onAddUserMentionNotify),s.editor.off(H.l,s.hidePopover),s.editor.off(H.B,s.handleAfterTableRegister),s.cache={};var e=s.mentionFileManager;s.props.showChatCards&&m.a.reset(),s.docMention.destory(),s.hover.destory(),v.a.destory(),s.editor=null,s.docMention.editor=null,s.closeMention(),s.docMention=null,s.handleResize.cancel(),s.handleResize=null,s.$positionHolder=null,s.component=null,e&&e.reset();var t=s.props.controller;t&&t.offReferenceListMount(s.pullAllMentionObjects)},this.bufferChanged=function(e,t){return s.docMention.bufferChanged(e,t)},this.editorAlinesDidSplice=function(e,t){return s.docMention.editorAlinesDidSplice(e,t)},this.processBeforeInsertNode=function(e,t){return s.docMention.processBeforeInsertNode(e,t)},this.aceAttribsToClasses=function(e,t){return s.docMention.aceAttribsToClasses(e,t)},this.aceCreateDomLine=function(e,t){return s.docMention.aceCreateDomLine(e,t)},this.match=function(e,t){return s.docMention.match(e,t)},this.render=function(e){return s.docMention.render(e)},this.deserialize=function(e){return s.docMention.deserialize(e)},this.serialize=function(e){return s.docMention.serialize(e)},this.aceBeforeCopy=function(e){return s.docMention.aceBeforeCopy(e)},this.aceAfterCompositionEnd=function(e){return s.docMention.aceAfterCompositionEnd(e)},this.UNSAFE_editorNormalizePasteNode=function(e){return s.docMention.UNSAFE_editorNormalizePasteNode(e)},this.editorWillPaste=function(e){return s.docMention.editorWillPaste(e)},this.collectContentPre=function(e,t){return s.docMention.collectContentPre(e,t)},this.afterPasteInsert=function(e,t){return s.docMention.afterPasteInsert(e,t)},this.acePaste=function(e,t){return s.docMention.acePaste(e,t)},this.beforeAceSelectionChange=function(e,t){Object(z.b)(s.editor,t)},this.commentListUpdate=function(){s.handleResize()},this.onResize=function(){var e,t,n,i,r,o;s.component&&s.component.isMentionBoxVisible()&&(e=s.uuid,(t=Object(U.$)(".".concat(F.a).concat(e)).get(0))&&(i=(n=s.props).boxWidth,o=(r=n.container)?Object(U.$)(r):Object(U.$)(".doc-position"),s.component.mentionBox.setState({style:Object(z.F)(Object(z.v)(t,{boxWidth:i,$boxContainer:o,bottomGap:16}))})))},this.editorSizeChange=function(){s.handleResize()},this.aceCompositionEvent=function(e,t){return s.handleKeyEvent(t,p.a,"doc")},this.isStandardAt=function(e){var t=e.key,n=e.shiftKey,i=e.type,r=e.originalEvent||e;return"keydown"===i&&(("@"===t||"Digit2"===Object(d.default)(r,"code"))&&n)},this.upload=function(e){var t=e.event,n=e.source;[x.a.A_PANEL,x.a.BLOCK_MENU].includes(n)&&s.uploadVideoFile(t)},this.linesWillReplace=function(e,t){s.docMention.linesWillReplace(e,t);var o,n=t.oldLineEntries,a=t.newLineEntries;n[0]&&a[0]&&(o=".".concat(H.o),Object(h.a)(n,function(e,t){var n,i,r=e.lineNode;a[t]&&(n=a[t].lineNode,Object(U.$)(n).find(".drive").length||Object(U.$)(r).find(".drive").length||(i=Object(U.$)(r).find(o)).length&&(Object(U.$)(n).find(o).replaceWith(i),s.editor.markNodeClean(n,a[t])))}))},this.prevTextIsWordsOrNumber=function(){if(s.editor.inCallStackIfNecessary("openMention",function(){s.editor.fastIncorp()}),V.a.isIE)return Object(z.T)();var e=s.editor.getRep(),t=a()(e.selStart,2),n=t[0],i=t[1],r=e.lines.atIndex(n),o=i?r.text.slice(i-2,i-1):"";return/^[a-zA-Z0-9]$/.test(o)},this.openMention=function(e,t,n){var i=s.uuid=Object(z.h)();s.component=s.docMention,s.closeMention();var r={uuid:i,list:[],message:s.cache.message};return t.preventDefault(),s.component.showMentionBox(e,r,t,n),Object(b.a)("confirm_mention").push({recommend_group:"default_recomment"}),!0},this.closeMention=function(e){s.component&&s.component.isMentionBoxVisible()&&(s.hasPressedAt=!1,s.component.mentionBox&&s.component.mentionBox.close(e))},this.handleChange=function(e,t){var n=s.getKeyWords(e);void 0!==n&&(Object(b.a)("confirm_mention").push({recommend_group:n?"search_recommend":"default_recomment"}),s.docMention&&s.docMention.updateKeywords(n,t))},this.handleIframeBtnClick=function(e,t,n){s.editor.call("insertIframeLink",{e:e,iframeKey:t,createSource:n})};var t=e.editor;this.props=e,t&&(this.editor=t,this.addMentionCls(),this.embedObjShareEnable=Object(j.s)(),this.init()),this.docMention=new p.a(Object.assign({},e,{embedObjShareEnable:this.embedObjShareEnable})),this.docMention.setCustomIconEnableFG(this.customIconEnable)}return u()(n,[{key:"addMentionCls",value:function(){var e;Object(j.G)()&&(e=this.editor.getDocBody(),Object(z.a)(e))}},{key:"aceKeyEvent",value:function(e,t){var n=this.props.type,i=this.editor.getRep();if(!i||0!==i.selStart[0]||"0"!==i.zoneId||"doc"!==n)return this.handleKeyEvent(t)}},{key:"insertReturn",value:function(){var e=this,t=this.editor.getRep(),n=this.editor.getLine(),i=t.lines.atIndex(n);if(this.editor.version.includes(M.y)){var r=this.editor.getContentState().getZoneState(t.zoneId).getLine(n);if(!r)return;if(r.getLineAttributes().every(function(e){return F.c.includes(e[0])})&&r.isEmpty())return}else if(i&&"string"==typeof i.text&&Object(z.N)(i.text))return;var o=t.selStart[0],a=t.lines.atIndex(o),s=[o,a.text.length],c=[o,a.text.length],l=t.selStart[0]+1;this.editor.callWithAce(function(){e.editor.performDocumentReplaceRange(e.editor.getRep().zoneId,s,c,"\n"),e.editor.dom?e.editor.performSelectionChange(t.zoneId,[l,0],[l,0]):e.editor.performSelectionChange([l,0],[l,0]),e.editor.version.includes(M.y)||e.editor.updateBrowserSelectionFromRep(!0)},"doReturn",!0)}},{key:"handleBarBtnClick",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};i.command=t;var r={editor:this.editor,rep:this.editor.getRep()};return Object.values(H.p).includes(i.command)?(Object(E.default)("confirm_mention",{mention_type:"iframe",mention_sub_type:e,panel_source:"a_panel",zone:Object(O.l)(),line_is_empty:Object(z.P)(this.editor)}),this.handleIframeBtnClick(i,e,"toolbar")):i.command===y.BlockType.POLL_BLOCK?this.handlePollConfirm(r,n):i.command===H.q.DRIVE?this.handleFileUpload(r):(i.command===H.q.CHAT&&this.insertReturn(),this.handleOpenMention(r,i)),!0}},{key:"handleOpenMention",value:function(e,t){var n=this.uuid=Object(z.h)();this.component=this.docMention,this.closeMention();var i={uuid:n,list:[],message:this.cache.message};this.component.showMentionBox(e,i,t)}},{key:"handleFileUpload",value:function(e){this.insertReturn(),document.getElementById("uploader-file-btn").click()}},{key:"isVideoFile",value:function(e){return!!e.type&&/video\/(.*)$/.test(e.type)}},{key:"uploadVideoFile",value:function(n){var i=this;this.insertReturn(),Array.from(Object(d.default)(n,"target.files")||[]).forEach(function(e){var t;i.isVideoFile(e)&&(t=Object.assign(e,{source:N.i.TOOL_BAR,event:n}),Object(D.c)(t))})}},{key:"handlePollConfirm",value:function(e,t){var n=this.docMention,i=y.BlockType.POLL_BLOCK,r=this.uuid=Object(z.h)(),o={uuid:r,list:[],message:this.cache.message,isAPanelPoll:!0},a=Object(y.generateBlockDataSet)(Object.assign({blockType:i,creator:Object(y.getBlockCreator)(i,this.editor)},t));Object(E.default)("click_create_poll",{block_id:a.blockId,create_source:"toolbar",poll_type:t.initData.type}),n.createBlankDom(e,r,z.c,e.rep.selStart,!0);var s=function(){n.handleConfirm({data:{dataSet:a,type:H.E.BLOCK,pollType:t.initData.type}},e,o)};e.editor.version.includes(M.y)?e.editor.once("paint",s):s()}},{key:"editorKeyDown",value:function(e,t){I.a.trigger(k.a.HIDE_SHARE_POPUP),this.hover&&this.hover.hidePopover()}},{key:"handleKeyEvent",value:function(t,e){var n=this,i=t.evt,r=t.isTypeForCmdKey,o=t.padShortcutEnabled,a=i.keyCode,s=i.type,c=i.which,l=i.altKey,u=i.ctrlKey,d=i.metaKey,h=H.t.LEFT,f=H.t.RIGHT,p=H.t.UP,g=H.t.DOWN,m=H.t.RETURN,v=H.t.BACKSPACE,b=H.t.ESC,y=H.t.TAB,E=H.t.DELETE,O=this.docMention,C=O.deleteMentionIfNecessary,k=O.isMentionBoxVisible,I=O.mentionBox,S=k(),T=String.fromCharCode(c).toLowerCase();if(r&&"z"===T&&(d||u)&&!l&&o.cmdZ)S&&this.nextTick(function(){return n.handleChange(t,i)});else if(!(r&&"y"===T&&(d||u)&&o.cmdY||"c"===T&&(d||u))){var _,w=Object(z.A)(),j=Object(U.$)(w.focusNode).parent(),M=-1<[h,p,f,g,v].indexOf(a),L=!1,R=!1;if(Object(z.O)(w)&&(_=w.focusOffset,L=!this.editor.dom.isRootOfZone(j[0])&&_===j.text().length,R=0===_),"compositionstart"===s?this.composition=!0:"compositionend"===s&&(this.composition=!1),Object(z.R)(j.get(0))&&!M&&!L&&!R)if("compositionstart"===s)this.startText=j.text();else if("compositionend"===s)j.text(this.startText);else if("keydown"===s)return i.preventDefault(),!0;var N=this.props.showable,D=!S&&!W.isAnonymousAccess&&N;if("keypress"===s&&"@"===T&&D&&(this.hasPressedAt=!0),"keyup"===s&&-1===[p,g,f,h,v,m,b,y].indexOf(a)&&D){var x=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"@";if(n.hasPressedAt=!1,!n.prevTextIsWordsOrNumber())return V.a.isEdge?(n.composition=!1,n.editor.fastIncorp(!0),n.openMention(t,i,e)):n.composition?void 0:n.openMention(t,i,e)};if(Object(z.U)(this.editor))x();else if(this.hasPressedAt){var P=Object(z.E)();if(null===P)return;x(P)}}if((a===v||a===E)&&"keydown"===s&&!S)return this.needOpenMentionBox=!1,C(t);if("keydown"===s&&S&&-1<[h,f].indexOf(a)&&(t.preventOtherHooksHandle=!0,i.preventDefault()),a===v&&"keyup"===s&&S){var B=Object(z.A)().focusNode;if(Object(U.$)(B.parentNode).prev().hasClass("".concat(F.a).concat(this.uuid)))return!0;Object(K.l)(B,"".concat(F.a).concat(this.uuid))||(this.needOpenMentionBox=!1,I&&I.close())}if(S&&("keydown"===s||"compositionend"===s)){if(-1<[m,p,g,f,h].indexOf(a))return t.preventOtherHooksHandle=!0,i.preventDefault(),!0;this.nextTick(function(){return n.handleChange(t,i)})}}}},{key:"getKeyWords",value:function(e){var t=e.editor,n=t.getRep(),i=n.alinesWidth,r=n.selStart,o=n.zoneId,a=r[0],s=F.a+this.uuid,c=t.getTextAndAttrsOnSelection({selStart:[a,0],selEnd:[a,i[a]],selZone:o}).filter(function(e){return e.attributes[s]});if(c.length){var l=c[0].text,u="";if(0!==l.length){if(l[0]===z.c)u=Object(z.f)(l);else{if("@"!==l.slice(0,1))return void this.closeMention();u=l.slice(1)}return(u=(u||"").split(String.fromCharCode(160)).join(" ")).slice(0,P)}this.closeMention(!0)}}}]),n}(),Z=new B({type:"doc",postAddMentionId:!0,hoverArea:"#innerdocbody",showable:!0,showChatCards:!0,boxWidth:540,source:H.z.DOC,container:".doc-position",notify:!0})}.call(this,Y("2vAP"))},Vtm6:function(e,t,n){},Vw45:function(e,je,Me){"use strict";(function(E){Me.d(je,"a",function(){return we});var e=Me("o0o1"),O=Me.n(e),t=Me("J4zp"),g=Me.n(t),n=Me("yXPU"),i=Me.n(n),r=Me("lwsE"),o=Me.n(r),a=Me("W8MJ"),s=Me.n(a),m=Me("OZf9"),c=Me("owWc"),C=Me("7EGn"),l=Me("UXvI"),u=Me("3Hq1"),v=Me("HmyT"),b=Me("n/R6"),k=Me("2ACu"),I=Me("1PvN"),S=Me("nHtH"),d=Me("wd/R"),h=Me.n(d),T=Me("/OTu"),f=Me("dF9M"),p=Me("c7eX"),y=Me("hzE9"),_=Me.n(y),w=Me("IQRI"),j=Me.n(w),M=Me("KhV1"),L=Me.n(M),R=Me("ddk1"),N=Me("toa8"),D=Me("kVV+"),x=Me("uOZV"),P=Me("xGgM"),B=Me("ozNJ"),U=Me("gpLn"),z=Me.n(U),H=(Me("jDul"),Me("lQZd")),F=Me("OX8E"),V=Me("iP/4"),W=Me("t/UT"),K=Me("jU1f"),Z=Me("1qho"),q=Me("gNEk"),Y=Me("KiYW"),J=Me("H6oK"),Q=Me("F4ZU"),X=Me("6s36"),$=Me("zfY2"),ee=Me("C+Is"),te=Me("FJEn"),ne=Me("v5fw"),ie=Me("1lbP"),re=Me("rLED"),oe=Me("D7h9"),ae=Me("jzcD"),se=Me("Cf53"),ce=Me("XMIC"),le=Me("jryj"),ue=Me("Ngi8"),de=Me("D28M"),he=Me("n+Ky"),fe=Me("TWwi"),pe=Me("EMUX"),ge=Me("9+L6"),me={1:E("history.create"),2:E("history.write"),3:E("history.modify_title"),4:E("history.reduction")},ve="remote",be="local",ye={remote:".history-remote",local:".history-local"},Ee=1,Oe=2,Ce=5,ke={CREATE:1,EDIT:2,TITLE_CHANGE:3,REVERT:4,ICON:5},Ie=["sheet","bitable"],Se=!1,Te={SHEET:3,BITABLE:8},_e="history_block_del_style_id",we=function(){function n(e,t){var y=this;o()(this,n),this.className="DocHistory",this.bling=new Z.a({duration:1e3}),this.customIconEnable=Object(re.n)(),this.retryCount=0,this.rxOp=new ie.a,this.aceInitialized=function(e,t){y.editorInfo=t.editorInfo,y.showRevokedBtn=!!Object(u.default)(t.showRevokedBtn)||t.showRevokedBtn},this.postAceInit=function(e,t){y.resetInitData(),y.$wrap=Object(v.$)(".etherpad-container"),y.initDom(),y.$body=Object(v.$)("#history-content"),y.$history=Object(v.$)("#history-sidebar"),y.$navigationBar=Object(v.$)(".navigation-bar"),y.bindEvent(),y.throttleQuery=Object(l.default)(y.fetchData,3e3),y.hideHistory(),y.activeTab=ve},this.performUndoRedo=function(e,t){y.handleEntryToastWhenUndo(e,t)},this.undoCount=0,this.resetUndoCountTimeId=null,this.handleEntryToastWhenUndo=function(e,t){var n,i,r,o,a;"undo"===t.which&&(n="is-show-undo-history-entry-tip",(i=window.sessionStorage.getItem(n))||"false"===i||(r=function(){return y.undoCount=0},o=1e4,a=10,y.undoCount++,y.undoCount>=a&&(window.sessionStorage.setItem(n,"true"),r(),clearTimeout(y.resetUndoCountTimeId),b.a.info({closable:!0,content:pe.a,key:"history",duration:5e3})),0===y.undoCount&&(y.resetUndoCountTimeId=setTimeout(r,o))))},this.reset=function(){y.hideHistory(),y.unBindEvent(),y.rxOp.destroy(),y.editorInfo=null,y.throttleQuery=null,y.$body=null,y.$wrap=null,y.$history=null,y.$wrap=null,y.$navigationBar=null,y.bling.destroy(),y.bling=null,b.a.remove("history")},this.triggerResized=function(){y.editorInfo.hooks.callAll("editorResized")},this.setShowRevokedBtn=function(e){y.showRevokedBtn=e},this.resetInitData=function(){y.query={timestamp:(new Date).getTime(),order:"after",page_size:10,lastest_timestamp:0,oldest_timestamp:0,before_last_page:!1,after_last_page:!1,cacheData:{}},y.$history&&y.$history.find(".history-list.history-remote").html(""),y.$history&&y.$history.find(".history-list.history-local").html("")},this.fetchLastestData=function(){y.throttleQuery(y.query.lastest_timestamp,Oe,y.query.page_size)},this.bindEvent=function(){y.handleEventBinding("on")},this.unBindEvent=function(){y.handleEventBinding("off")},this.handleEventBinding=function(e){y.$history[e]("click",".history-help",y.handleClickHelp),y.$history[e]("click",".history-close",y.hideHistory),y.$history[e]("click",".more",y.toggleExpand),y.$history[e]("click",".Revoked",y.revoked),y.$history[e]("click",".locate",y.locate),y.$history[e]("click",".sheet,.block-type-BITABLE_BLOCK",y.locateSheet),y.$history[e]("transitionend",y.triggerResized),y.$history[e]("click",".history-item-b",y.sessionClick),y.$history[e]("click",".history-tab",y.clickTab),y.$history[e]("click","td.ace-table-cell",y.locateTable),y.$history.find(".history-list.history-remote")[e]("scroll",y.onScroll),y.$history[e]("click",'[class*="url"] > a, [class*="mention"] > a',q.d),F.a[e]("showOldHistory",y.showHistoryByEmitter),F.a[e]("hideOldHistory",y.hideHostoryByEmitter),"off"===e&&document.removeEventListener("keydown",y.escEvent)},this.escEvent=function(e){27===e.keyCode&&(y.revertModal?y.revertModal.destory():1===Object(v.$)(".bitable-in-doc-history-mode").length?y.editorInfo.plugins.bitableBridge.exitHistoryMode():1===Object(v.$)(".embed-sheet-history").length||y.isVisible()&&y.hideHistory())},this.clickTab=function(e){var t=Object(v.$)(e.target),n=be,i=ve;t.hasClass("history-remote-tab")&&(n=ve,i=be),n!==y.activeTab&&(Object(v.$)(".history-tab").removeClass("history-tab-active"),t.addClass("history-tab-active"),Object(v.$)(ye[i]).addClass("history-list-hide"),Object(v.$)(ye[n]).removeClass("history-list-hide"),y.activeTab=n,Object(k.collectSuiteEvent)("history",{action:y.activeTab===ve?"historyrecord":"localrecord",source:"btn",eventType:event.type,targetId:event.target&&event.target.id||"",targetClass:event.target&&event.target.className||""}))},this.handleClickHelp=function(){Object(k.collectSuiteEvent)("history",{action:"click_help_history",source:"btn"}),window.open(ge.i)},this.sessionClick=function(e){Object(v.$)(y).parents(".history-item").hasClass("short")&&Object(v.$)(y).parents(".history-item").addClass("expand")},this.onScroll=function(e){var t,n=e.target,i=n.scrollHeight-n.offsetHeight-n.scrollTop;-1<=i&&i<=10&&!y.isLoading&&((t=y.query).before_last_page||y.fetchData(t.oldest_timestamp,Ee,t.page_size))},this.invokeCollapse=function(e){F.a.emit("invokeCollapse",{dom:e,source:"history"})},this.invokeCollapseBySelection=function(e){var t=e.selStart,n=e.selEnd,i=e.selZone;F.a.emit("invokeCollapse",{zoneId:i,range:{selStart:t,selEnd:n},source:"history"})},this.locateSheet=function(){var t=i()(O.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.currentTarget.className,!(i=n.match(/sheet-id-([^\s]*)|block-id-([^\s]*)/))){e.next=17;break}if(r=i[0],o=i[1]||i[2],a=Object(K.a)(y.editorInfo,o))return s=a.selStart,c=a.selZone,l=g()(s,1),u=l[0],d=y.editorInfo.getLineNumInRootZone(c,u),y.editorInfo.blockRender.isLineCollapsed(d)&&y.invokeCollapseBySelection(a),e.next=13,Object(K.h)({editor:y.editorInfo,targetSelection:a,placement:"top",source:"old-history-locate"});e.next=16;break;case 13:return h=y.editorInfo.plugins.blockPlugin.getBlockById(o),y.blingWithDom(Object(v.$)(h.mountPoint).parents(".".concat(r))),e.abrupt("return");case 16:b.a.show({closable:!0,content:E("history.no_doc"),key:"history"});case 17:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.locateTable=function(){var t=i()(O.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.currentTarget.innerText.trim().length)return e.abrupt("return");e.next=3;break;case 3:if(n=Object(v.$)(t.currentTarget),i=n.parents('span[class*="aceTable-"]'),r=i.attr("class"),(o=/(?:^|\s*)(aceTable-([a-zA-Z0-9]+\s[a-zA-Z0-9]+))(?:\s|$)/.exec(r))&&o[1]){e.next=9;break}return e.abrupt("return");case 9:if(a=o[2],s=Object(K.d)(y.editorInfo,a))return c=s.selStart,l=s.selZone,u=g()(c,1),d=u[0],h=y.editorInfo.getLineNumInRootZone(l,d),y.editorInfo.blockRender.isLineCollapsed(h)&&y.invokeCollapseBySelection(s),e.next=18,Object(K.h)({editor:y.editorInfo,targetSelection:s,placement:"top",source:"old-history-locate"});e.next=23;break;case 18:if(f=y.editorInfo.getRep(te.DEFAULT_REP_ZONE).lines.atIndex(d),0<(p=Object(v.$)(f.lineNode).find("table.ace-table")).length)return y.blingWithDom(p),e.abrupt("return");e.next=23;break;case 23:b.a.show({closable:!0,content:E("history.no_doc"),key:"history"});case 24:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.locate=function(){var t=i()(O.a.mark(function e(t){var n,a,i,r,o,s,c,l,u,d,h,f,p;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(k.collectSuiteEvent)("history",{action:"historyClick",source:"btn",eventType:t.type,targetId:t.target&&t.target.id||"",targetClass:t.target&&t.target.className||""}),n=t.currentTarget,!Object(v.$)(n).children().hasClass("deletion upload-image")){e.next=6;break}b.a.show({closable:!0,content:E("history.no_doc"),key:"history"}),e.next=32;break;case 6:if(a=/lineguid-(\S+)/g,i=/aceTable-(\S+)/g,r=/block-type-BITABLE_BLOCK/g,o=/block-type-SHEET_BLOCK/g,s=Object(v.$)(n).attr("class"),c=Object(v.$)(n).children().attr("class"),i.test(c))return e.abrupt("return");e.next=14;break;case 14:if(r.test(c))return e.abrupt("return");e.next=16;break;case 16:if(o.test(c))return e.abrupt("return");e.next=18;break;case 18:if(!a.test(s)){e.next=32;break}if(l=function(){a.lastIndex=0;for(var e=a.exec(s);null!==e;e=a.exec(s)){var t=e,n=g()(t,1)[0],i=/lineguid-(\S+)/g.exec(n),r=g()(i,2)[1],o=Object(K.b)(y.editorInfo,r);if(o)return o}return null}())return u=l.selStart,d=l.selZone,h=u[0],f=y.editorInfo.getLineNumInRootZone(d,h),y.editorInfo.blockRender.isLineCollapsed(f)&&y.invokeCollapseBySelection(l),e.next=28,Object(K.h)({editor:y.editorInfo,targetSelection:l,placement:"top",source:"old-history-locate"});e.next=31;break;case 28:return p=y.editorInfo.getRep(d).lines.atIndex(h),y.bling.blingblingWithId(p.key),e.abrupt("return");case 31:b.a.show({closable:!0,content:E("history.no_doc"),key:"history"});case 32:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.blingWithDom=function(){var t=i()(O.a.mark(function e(t){var n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ne.a,y._blingWithDomImpl(t,""),e.next=4,y.rxOp.toPromise(n.sleep(0));case 4:return y._blingWithDomImpl(t,"locate-highlight 2s"),e.next=7,y.rxOp.toPromise(n.sleep(2e3));case 7:y._blingWithDomImpl(t,"");case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this._blingWithDomImpl=function(){var n=i()(O.a.mark(function e(t,n){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(y.editorInfo){e.next=2;break}return e.abrupt("return");case 2:y.editorInfo.getObserver().withoutRecordingMutations(function(){t.css({animation:n})});case 3:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),this.changesetApply=function(e,t){y.isVisible()&&setTimeout(function(){y.fetchLastestData()},1e3)},this.getDataFromLocalHistory=function(t){var e=y.localData.filter(function(e){return e.key===t});return e&&e[0]},this.revoked=function(e){var t=y.activeTab===ve,n=Object(v.$)(e.target).parents(".history-item");if(n.attr("data-block")){var i=JSON.parse(n.attr("data-block")),r=i.name.substr(i.name.indexOf("#")+1),o=i.obj_token,a=1e3*i.create_time,s=1e3*i.update_time,c=i.revision_range;if(i.obj_type===Te.SHEET)return y.editorInfo.plugins.sheetBridge.enterHistoryMode(o,r,a,s);if(i.obj_type===Te.BITABLE)return y.editorInfo.plugins.bitableBridge.enterHistoryMode(o,r,c[0],c[1])}y.revertModal=P.a.create({token:y.editorInfo.getDocId(),userId:y.editorInfo.getAuthor(),memberId:y.editorInfo.plugins.sync.getMemberId(),type:t?B.b:B.a,historyId:n.attr("data-id"),historyTime:n.attr("data-time"),metaId:n.attr("data-meta_id"),editor:y.editorInfo,onClose:function(e,t){y.revertModal=null,t&&window.setTimeout(function(){y.fetchLastestData()},1e3)}}),Object(k.collectSuiteEvent)("history",{action:"restore",source:t?"remote":"local",eventType:e.type,targetId:e.target&&e.target.id||"",targetClass:e.target&&e.target.className||""})},this.toggleExpand=function(e){return Object(v.$)(e.currentTarget).parents(".history-item").hasClass("expand")||Object(k.collectSuiteEvent)("history",{action:"more_open",source:"btn",eventType:e.type,targetId:e.target&&e.target.id||"",targetClass:e.target&&e.target.className||""}),Object(v.$)(e.currentTarget).parents(".history-item").toggleClass("expand"),!1},this._toggleHistory=function(e){y.applyOpendocSidebarOptions(),Object(ae.d)(oe.default.getState()).translated?oe.default.dispatch(Object(ce.c)(le.MODAL_TYPES.HISTORY_CONFIRM)):y.toggleHistory(void 0,e)},this.toggleHistory=function(e,t){var n,i;!Object(v.$)(".note-title__history").hasClass("g-cp")||(n=y.isVisible())!==t&&(t||void 0===t&&!n?(y.token!==Object(H.g)()&&(y.resetInitData(),I.a.showLoading("#history-content",{class:"spiner-top"})),y.showHistory(),y.getLocalHistory(),y.$history.find(".history-item").length?y.fetchLastestData():y.fetchData(0,Oe,10),e&&(i=Object(C.default)(e,"originalEvent.isTrusted"),Object(k.collectSuiteEvent)("history",{action:"open",source:i?"title":"more_func",eventType:e.type,targetId:e.target&&e.target.id||"",targetClass:e.target&&e.target.className||""}))):(y.hideHistory(),e&&Object(k.collectSuiteEvent)("history",{action:"close",source:"",eventType:e.type,targetId:e.target&&e.target.id||"",targetClass:e.target&&e.target.className||""})))},this.showHistoryByEmitter=function(e){var t,n=e.timestamp,i=void 0===n?0:n,r=e.event,o=e.source;Object(v.$)(".note-title__history").hasClass("g-cp")&&(y.isVisible()||(y.token!==Object(H.g)()&&(y.resetInitData(),I.a.showLoading("#history-content",{class:"spiner-top"})),y.showHistory(),y.getLocalHistory(),t=0<i?Ee:Oe,y.fetchData(i,t,10),r&&Object(k.collectSuiteEvent)("history",{action:"open",source:o||"",eventType:r.type,targetId:r.target&&r.target.id||"",targetClass:r.target&&r.target.className||""})))},this.hideHostoryByEmitter=function(e){var t=e.event;Object(v.$)(".note-title__history").hasClass("g-cp")&&y.isVisible()&&(y.hideHistory(),t&&Object(k.collectSuiteEvent)("history",{action:"close",source:"",eventType:t.type,targetId:t.target&&t.target.id||"",targetClass:t.target&&t.target.className||""}))},this.hideHistory=function(){y.$wrap.removeClass("history-show"),y.$wrap.find(".hasComment").removeClass("hasComment"),y.$body.addClass("g-dpn"),document.removeEventListener("keydown",y.escEvent),F.a.emit("oldHistoryIsHidden")},this._showHistory=function(){y.$wrap.addClass("history-show"),y.$body.removeClass("g-dpn"),y.$wrap.find(".doc-comment__panel-item").length&&y.$wrap.find(".etherpad-client-container").addClass("hasComment")},this.isVisible=function(){return!y.$body.hasClass("g-dpn")},this.initDom=function(){var e;!Object(v.$)("#history-sidebar").length&&y.$wrap&&(e='<div id="history-sidebar" class="history-sidebar'.concat(Object(re.G)()?" new-mention-ui":"",'"\n        ').concat(Object(v.$)(".app.has-hide-header").length?'style="top: 0"':"",'>\n              <div class="history-wrap">\n                <div class="history-body doc-history-common layout-column g-dpn" id="history-content">\n                    <div class="history-title layout-row layout-cross-center">\n                      <div class="history-tab-wrap">\n                        <span class="history-tab history-remote-tab history-tab-active">').concat(E("nav.tips.history_record"),'\n                        </span>\n                        <span class="history-tab history-local-tab">').concat(E("nav.tips.local_record"),'</span>\n                      </div>\n                      <div class="history-btn-wrap">\n                        <span class="history-help">').concat(j.a,'</span>\n                        <span class="history-close">').concat(_.a,'</span>\n                      </div>\n                    </div>\n                    <div\n                      id="history-list"\n                      class="history-list history-remote  flex"\n                      ').concat(V.a.isMac?"":'style="overflow: hidden; position: relative;','"\n                    ></div>\n                    <div\n                      id="history-list-local"\n                      class="history-list history-local history-list-hide flex"\n                      ').concat(V.a.isMac?"":'style="overflow: hidden; position: relative;','"\n                    ></div>\n                </div>\n              </div>\n            </div>\n            '),y.$wrap.append(e),V.a.isMac||(new W.a("#history-list",{suppressScrollX:!0,wheelPropagation:!1}).update(),new W.a("#history-list-local",{suppressScrollX:!0,wheelPropagation:!1}).update()))},this.fetchData=function(t,b,n){return y.isLoading=!0,y.token=Object(H.g)(),N.d.get("/api/xhistory/",{params:{timestamp:t,order:b,page_size:n,token:Object(H.g)()}}).then(function(){var t=i()(O.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=t.data,i=y.handleHistoryData(Object(C.default)(t,"data.histories",[])),r=Object(C.default)(t,"data.snapshots",{}),o=[],a=[],s=y.$history.find(".history-list.history-remote"),c=s[0].scrollTop,Object(fe.a)())return e.next=11,Object(he.b)();e.next=11;break;case 11:l=0;case 12:if(!(l<i.length)){e.next=38;break}if(u=i[l],d=u.history_id,!(u.type===ke.CREATE||u.type===ke.TITLE_CHANGE||u.type===ke.REVERT||y.customIconEnable&&u.type===ke.ICON)){e.next=20;break}u.change=y.renderTitle(u,n),u.html=u.change,e.next=33;break;case 20:if(u.type===ke.EDIT)return h=JSON.parse(r[d]||"{}"),f=u.content.content,e.prev=23,e.next=26,I.a.renderAlines(f.alines,JSON.parse(f.apool),h,y.$history[0]);e.next=33;break;case 26:u.change=e.sent,e.next=32;break;case 29:e.prev=29,e.t0=e.catch(23),console.error(e.t0);case 32:u.html=y.createDom(u,n,b);case 33:(y.query.cacheData[u.history_id]=u).change&&u.change.length&&((p=y.$history.find('[data-id="'+u.history_id+'"]')).length?(g=p.attr("class"),m=y.$history.find('[data-id="'+u.history_id+'"]'),x.a.reset(m[0]),m[0].outerHTML=u.html,y.$history.find('[data-id="'+u.history_id+'"]').attr("class",g)):o.push(u.html),a.push(u.history_id));case 35:l++,e.next=12;break;case 38:b===Oe?(i.length&&(y.query.lastest_timestamp=i[0].update_time,y.query.oldest_timestamp||(y.query.oldest_timestamp=i[i.length-1].update_time)),y.query.after_last_page=n.last_page,s.prepend(o)):(i.length&&(y.query.oldest_timestamp=i[i.length-1].update_time),y.query.before_last_page=n.last_page,s.append(o)),y.updateHeight(a),y.updateShowTime(),s[0].scrollTop=c,s.find(".history-item").length?s.find(".empty_li").remove():s.find(".empty_li").length||s.append('<div class="empty_li">'.concat(E("nav.tips.no_history_record"),"</div>")),D.a.update(i),v=document.querySelector(".history-list"),x.a.update(v,{editorInfo:y.editorInfo}),e.next=51;break;case 48:e.prev=48,e.t1=e.catch(0),console.error("parse history error",e.t1);case 51:y.retryCount=0;case 52:case"end":return e.stop()}},e,null,[[0,48],[23,29]])}));return function(e){return t.apply(this,arguments)}}()).finally(function(){y.isLoading=!1,I.a.hideLoading("#history-content")}).catch(function(e){console.error("fetch history error",e),y.retryCount++<Ce?y.fetchData(t,b,n):(y.retryCount=0,y.$history.find(".history-list.history-remote").html('<div class="empty_li">'.concat(E("history.server_error"),"</div>")))})},this.handleHistoryData=function(e){return Object(c.a)(e,function(s,c,e){return c.content=JSON.parse(c.content||"{}"),c.type!==ke.EDIT?s.push(c):(Object(C.default)(c,"content.content.alines",!1)&&s.push(c),c.content.blocks&&c.content.blocks.forEach(function(e){var t=e.name.substr(0,e.name.indexOf("/"));if(-1!==Ie.indexOf(t)){var n,i=Object.assign({},e,{create_time:c.create_time,update_time:c.update_time});if(e.obj_type===Te.BITABLE)n=J.BlockType.BITABLE_BLOCK;else{if(e.obj_type!==Te.SHEET)return;n=J.BlockType.SHEET_BLOCK}var r=I.a.handleBlockContent(c.content,i,n),o=c.history_id+"_"+e.name,a=Object.assign({},c,{history_id:o,content:r});s.push(a)}})),s},[])},this.updateShowTime=function(){for(var e in y.query.cacheData){var t,n,i,r=y.$history.find('div[data-id="'+e+'"]');r.length&&(n="update_time",1===(t=y.query.cacheData[e]).history_type&&(n="create_time"),i=Object(S.a)(parseInt(t[n])),r.find(".updateTime").html(i),r.attr("data-time",t[n]))}},this.updateHeight=function(e){e.forEach(function(e){var t,n=y.$history.find('div[data-id="'+e+'"]'),i=y;n.find(".history-item-b img").off("load").on("load",function(){var e=Object(v.$)(y).parents("[data-id]").attr("data-id");i.updateHeight([e])}),n.find(".history-item-b").length&&(t=n.find(".history-item-b")&&12<n.find(".history-item-b")[0].scrollHeight-165,165<n.find(".history-item-b")[0].scrollHeight&&t?n.addClass("short"):n.removeClass("short"))})},this.renderLocalList=function(e){return e?e.map(function(e){var t=e.time,n=e.key,i='<p class="Revoked g-cp layout-row layout-cross-center" data-key="'.concat(n,'">\n          ').concat(E("history.detail"),"\n        </p>");return'<div class="history-item" data-id="'.concat(n,'" data-time="').concat(t,'">\n        <div class="history-item-t layout-row layout-cross-center">\n          <div class="flex">\n            <div class="layout-row layout-cross-center">\n              <div class="flex">').concat(h()(t).format(f.a.SAME_YEAR),"</div>\n                ").concat(i,'\n              </div>\n            <div class="layout-row layout-cross-center p1">\n              <div class="flex">').concat(E("history.edit_content"),"</div>\n            </div>\n          </div>\n        </div>\n      </div>")}).join(""):""},this.renderTitle=function(e,t){var n="",i=Object(S.a)(parseInt(e.update_time)),r=Object(C.default)(t,"entities.users",{}),o=e.content.user_ids[0];switch(e.type){case ke.CREATE:i=Object(S.a)(parseInt(e.create_time)),n='<div class="flex">'.concat(E("history.creted_document"),'&nbsp;&nbsp;\n        <span class="updateTime">').concat(i,"</span></div>");break;case ke.TITLE_CHANGE:e.content.origin=Object(R.a)(e.content.origin),e.content.now=Object(R.a)(e.content.now||""),n='<div class="flex">'.concat(E("history.the_document"),"").concat(e.content.origin," ").concat(E("history.rename"),"\n        ").concat(e.content.now,'\n        &nbsp;&nbsp;<span class="updateTime">').concat(i,"</span></div>");break;case ke.REVERT:i=Object(S.a)(parseInt(e.create_time)),n='<div class="flex">'.concat(me[e.type]||""," ").concat(E("history.content"),'&nbsp;&nbsp;\n        <span class="updateTime">').concat(i,"</span></div>");break;case ke.ICON:var a=e.content,s=a.origin,c=a.now,l=s&&s.key?'<img src="'.concat(Object(Y.e)(s),'" class="history-diy-icon"/>'):E("common.default"),u=c&&c.key?'<img src="'.concat(Object(Y.e)(c),'" class="history-diy-icon"/>'):E("common.default"),n='<div class="flex">'.concat(E("doc.diy_icon.history_icon_change",l,u),'&nbsp;&nbsp;\n        <span class="updateTime">').concat(i,"</span></div>")}return'<div class="history-item" data-id="'.concat(e.history_id,'" data-type="').concat(e.type,'" data-time="').concat(e.update_time,'">\n                <div class="history-item-t layout-row history-item-session1" >\n                    <img class="ava" src="').concat(r[o].avatar_url,'"/>\n                    <div class="flex">\n                        <div  class="layout-row history-item__author-info">\n                            <div class="flex name">').concat(Object(R.a)(Object(T.a)(r,o)),'</div>\n                        </div>\n                        <div  class="layout-row p1">\n                            ').concat(n,"\n                    </div>\n                    </div>\n                </div>\n            </div>")},this.createDom=function(e,t,n){var i="";Object(m.a)(e.change,function(e,t){i+='<div class="history-change change '.concat(0!==t?"state2":"state1",' innerdocbody">\n            ').concat(e,"\n          </div>")});var r,o,a=Object(C.default)(t,"entities.users",{}),s=Object(S.a)(parseInt(e.update_time)),c=e.content.user_ids,l=1===c.length,u=a[c[0]]||{},d=l?u.avatar_url:z.a;l?o=Object(T.a)(a,c[0]):(r=3,o=c.slice(0,r).map(function(e){return Object(T.a)(a,e)}).join(E("common.comma_seperator")),c.length>r&&(o+=" ".concat(E("history.list_many_users",c.length,c.length-r))));var h,f='<p class="Revoked g-cp layout-row layout-cross-center">\n         '.concat(E("history.detail"),"\n        </p>"),p="";return e.content.blockInfo&&(h=JSON.stringify(e.content.blockInfo),p="data-block=".concat(h)),'<div class="history-item" data-id="'.concat(e.history_id,'" data-type="').concat(e.type,'" data-time="').concat(s,'"\n      data-meta_id="').concat(e.content.first_meta_id,'" ').concat(p,'>\n                <div class="history-item-t layout-row">\n                    <img class="ava" src="').concat(d,'"/>\n                    <div class="flex">\n                        <div  class="layout-row history-item__author-info">\n                            <div class="flex name">').concat(Object(R.a)(o),"</div>\n                              ").concat(f,'\n                            </div>\n                        <div  class="layout-row layout-cross-center  p1">\n                            <div class="flex">').concat(me[e.type]||""," ").concat(E("history.content"),'&nbsp;&nbsp;\n<span class="updateTime">').concat(s,'</span></div>\n                    </div>\n                    </div>\n                </div>\n                <div class="history-item-b">\n                    ').concat(i,'\n                </div>\n                <div class="history-item-f layout-row layout-main-center more g-cp">\n                    <span class=" layout-row layout-main-center  ">').concat(L.a,"</span>\n                </div>\n            </div>")},this.showHistory=function(){var e=Object(p.b)();e.panelDisplayControlHub&&(Se||(e.panelDisplayControlHub.emitEvent("registerCloseFunc",[y.hideHistory]),Se=!0),e.panelDisplayControlHub.emitEvent("closeExcepetMe",[y.hideHistory])),document.addEventListener("keydown",y.escEvent),y._showHistory(),y._addDelAfterContentStyle()},e&&(this.aceInitialized("",Object.assign({editorInfo:e},t,{},e)),this.postAceInit("",Object.assign({editorInfo:e},t,{},e))),V.a.isOpendoc&&Object($.registerOpendocApi)(ee.b.toggleHistory,this._toggleHistory)}function e(){return t.apply(this,arguments)}var t;return s()(n,[{key:"applyOpendocSidebarOptions",value:function(){var e,t,n,i,r,o,a,s,c;V.a.isOpendoc&&((e=Object(se.d)())&&e.borderSide?(n=(t=g()(e.borderSide,4))[0],i=t[1],r=t[2],o=t[3]):e&&e.border&&(n=e.border.top,o=e.border.left||!0,i=e.border.right,r=e.border.bottom),a=Object(v.$)(".history-title"),s=Object(v.$)(".history-list"),c="1px solid ".concat(ue.N300),a.css("border-top",n?c:"none"),a.css("border-left",o?c:"none"),a.css("border-right",i?c:"none"),s.css("border-left",o?c:"none"),s.css("border-bottom",r?c:"none"),s.css("border-right",i?c:"none"))}},{key:"_addDelAfterContentStyle",value:function(){var e;document.querySelector("".concat(_e))||((e=Object(de.c)("\n      .__edit_del .block-placeholder:not(.inline-block-placeholder) .block-v-text::after {\n        content: '".concat(E("history.deleted"),"' !important;\n      }\n    "))).id=_e,document.body.appendChild(e))}},{key:"getLocalHistory",value:(t=i()(O.a.mark(function e(){var t,n,i;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(H.g)(),e.next=3,Object(X.a)(Q.a,t);case 3:n=e.sent,i=I.a.formatHistoryRecordsFromLocal(n),(this.localData=i).length?Object(v.$)(".history-local").html(this.renderLocalList(i)):Object(v.$)(".history-local").html('<div class="empty_li">'.concat(E("nav.tips.no_local_record"),"</div>"));case 7:case"end":return e.stop()}},e,this)})),e)}]),n}()}).call(this,Me("2vAP"))},WLPM:function(e,t,n){"use strict";var h=n("xWuZ");function i(e,t){var n=e.getRep(),i="whitelist",r="blacklist";if(n){var o=n.zoneId,a=n.selStart[0],s=n.lines.atIndex(n.selStart[0]);if(!s)return null;var c=s.text,l=s.lineMarker;if(!(t=t||(e.isCaret()?e.getAttributesOnSelection(n.zoneId,{selStart:[a,0,o],selEnd:[a,c.length,o]},!!l):e.getAttributesOnSelection(n.zoneId,n,!!l))))return null;if("0"===n.zoneId&&0===a&&0===n.selEnd[0])return{enable:"titleEnable",mode:i};if(t.attribsKey["mention-type_5-true"])return{enable:"mentionEnable",mode:i};if(t.attribs.some(function(e){return/^drive-/.test(e[0])}))return{enable:"driveEnable",mode:i};var u=Object(h.a)(t.attribs)||[],d=-1<u.indexOf("list");if(-1<u.indexOf("image-uploaded")||-1<u.indexOf("gallery"))return{enable:"imageEnable",mode:i};if(d)return{enable:"listEnable",mode:r}}return null}t.a=i},"WP/d":function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),l=n("HmyT"),s=n("YNKm"),u=n("nVH4"),c=(n("Svru"),n("y2sV")),h=["author","insertorder","lmkr","template-placeholder"],f=[37,38,39,40],d=function(){function t(e){var d=this;r()(this,t),this.attributeKey="template-placeholder",this.regist=function(e){e.registerAceCommand(s.TEMPLATEPLACEHOLDER,function(e,t){t.doInsertPlaceHolder()},{statusKey:null})},this.onMount=function(){for(var e=d.editor.docbody,t=Object(l.$)(e).find(".template-placeholder-sp"),n=0;n<t.length;++n){var i=d.editor.dom.getEntryForNode(t[n]);d.processBeforeInsertNode("before",{entry:i})}},this.aceKeyEvent=function(e,t){var n=t.evt,i=t.editorInfo,r=t.isTypeForSpecialKey,o=i.getRep(),a=n.keyCode,s=n.type;if(!i.selection.isCaret())return!1;if(!i.getAttributeOnLine(o.zoneId,o.selStart[0],"template-placeholder"))return!1;if(i.getInInternationalComposition())return!1;if(a===u.c.BACKSPACE&&"keydown"===s&&r&&o.lines.isStartOfLine(o.selStart[0],o.selStart[1])){var c=i.getAttributesOnLine(o.zoneId,o.selStart[0]),l=!1;return c&&c.forEach(function(e){-1<h.indexOf(e[0])||(l=!0,i.removeAttributeOnLine(o.zoneId,o.selStart[0],e[0]))}),l&&i.updateBrowserSelectionFromRep(),n.preventDefault(),!0}return!1},this.aceInitialized=function(e,t){var n=t.editorInfo.getClientVars();d.isTemplate=n&&n.is_template,d._editorInfo=t.editorInfo,d.editorInfo=t.editorInfo,d._editorInfo.doInsertPlaceHolder=d.doInsertPlaceHolder,d.regist(d._editorInfo)},this.isPlaceHolder=function(e){return Object(l.$)(e).hasClass("template-placeholder-sp")},this.isEmptyDiv=function(e){if(!!!e.childNodes)return!0;if(!(1===e.childNodes.length))return!1;var t=e.childNodes[0];return!(!t||"BR"!==t.tagName)},this.isPlaceholderByAttributes=function(e){return!!d._editorInfo.getAttributeOnLine(d._editorInfo.getRep().zoneId,e,"template-placeholder")},this.inPlaceholder=function(e){if(0===e)return!1;for(var t=d._editorInfo.getRep().attributeManager.getAllAttributesOnLine(e)||[],n=!0,i=0;i<t.length;++i){var r=t[i][0];if("template-placeholder"===r){n=!0;break}if(-1<r.indexOf("template")){n=!1;break}}return n},this.deletePreLastCls=function(e){for(var t=d.editorInfo.getRep();d.inPlaceholder(--e)&&0<e;){var n=t.lines.atIndex(e).domInfo.node;Object(l.$)(n).removeClass("last-tp-sub")}},this.addCls=function(e){var t,n,i,r,o,a,s,c;d.editorInfo&&(t=d.editorInfo,n="",i=e.id,!t.getRep||(o=(r=t.getRep()).lines.atKey(i))&&(a=r.lines.indexOfEntry(o),s=d.inPlaceholder(a+1),d.inPlaceholder(a)&&(n+=" tp-sub",s||(n+=" last-tp-sub",d.deletePreLastCls(a))),!d.isPlaceholderByAttributes(a)||((c=o.text).substr(1,c.length)||s)&&(n+=" none-empty"),Object(l.$)(e).addClass(n)))},this.editorKeyDown=function(e,t){var n,i,r,o,a,s,c,l,u;d.isTemplate&&(n=t.evt,i=t.isTypeForCmdKey,r=t.specialHandled,o=t.inInternationalComposition,i&&n.metaKey&&86===!n.keyCode||r||(a=d.editor.getRep()).selStart&&"0"===a.zoneId&&(s=a.selStart[0],c=find(f,function(e){return e===t.evt.keyCode}),u=(l=a.lines.atIndex(s)).text.length-l.lineMarker==0,!o&&u&&c||d.editor.getObserver().withoutRecordingMutations(function(){l.lineNode.classList.add("none-empty")})))},this.editorKeyUp=function(e,t){var n,i,r,o,a,s;d.isTemplate&&(n=t.evt,i=t.isTypeForCmdKey,r=t.specialHandled,i&&n.metaKey&&86===!n.keyCode||r||d.editor.getInInternationalComposition()||(o=d.editor.getRep()).selStart&&"0"===o.zoneId&&(a=o.selStart[0],(s=o.lines.atIndex(a)).text.length!==s.lineMarker||s.lineNode.classList.remove("none-empty")))},this.processBeforeInsertNode=function(e,t){var n;d.isTemplate&&(n=t.entry.domInfo.node,d.addCls(n))},this.acePostWriteDomLineHTML=function(e,t){var n;d.isTemplate&&(n=t.node,d.addCls(n))},this.doInsertPlaceHolder=function(){var e=d.editorInfo,t=e.getRep().selStart[0];e.setAttributeOnLine(t,"template-placeholder","sp")},this.aceAttribsToClasses=function(e,t){var n=t.key,i=t.value;if("template-placeholder"===n)return d.isTemplate=!0,"template-placeholder-".concat(i)},this.aceDomLineProcessLineAttributes=function(e,t){var n=t.spanClass;/(?:^| )template-placeholder/.exec(n)&&(d.placeHolderCls.push(n),t.lineClass+=" template-placeholder-sp",t.processedMarker=!0)},e&&(this.editor=e,this.placeHolderCls=[],this.aceInitialized("",Object.assign({editorInfo:e},e)))}return a()(t,[{key:"match",value:function(e){return e===this.attributeKey}},{key:"reset",value:function(){this.editor&&(this.editor=null),this._editorInfo=null,this.editorInfo=null}},{key:"renderLine",value:function(e){var t=e.lineState,n=e.children,i=t.getLineAttributes().toMap()[this.attributeKey];return i&&(this.isTemplate=!0,e.lineClass+=" ".concat(this.attributeKey,"-").concat(i)),n}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;return t instanceof HTMLElement&&-1<t.className.indexOf("template-placeholder")?Object(c.I)(n,i,{"template-placeholder":"sp"}):n}}]),t}();new d},WUVX:function(e,t,n){"use strict";var i=n("RIqP"),$=n.n(i),r=n("J4zp"),ee=n.n(r),o=n("o0o1"),te=n.n(o),a=n("yXPU"),ne=n.n(a),ie=n("hbEN"),re=n("Bw5p"),oe=n("q1tI"),ae=n.n(oe),s=n("XRg5"),c=n("VkAN"),l=n.n(c),u=n("vOnD"),d=n("/GXw"),h=n("qxQb"),f=n.n(h),se=n("TfC2");function p(){var e=l()(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 4px;\n  background-color: ",";\n}"]);return p=function(){return e},e}function g(){var e=l()(["\n  position: relative;\n  min-width: 1px;\n  width: ","%;\n  background-color: ",";\n  &::before,\n  &::after {\n    content: '';\n    top: 0;\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background-color: ",";\n  }\n  &::before {\n    left: -4px;\n  }\n  &::after {\n    right: -4px;\n  }\n"]);return g=function(){return e},e}function m(){var e=l()(["\n  display: flex;\n  width: 40px;\n  height: 8px;\n  padding: 0 4px;\n  border-radius: 4px;\n  background-color: ",";\n  z-index: 1;\n"]);return m=function(){return e},e}function v(){var e=l()(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 4px;\n  background-color: ",";\n  pointer-events: none;\n"]);return v=function(){return e},e}function b(){var e=l()(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  border-radius: 4px;\n  background-color: ",";\n"]);return b=function(){return e},e}function y(){var e=l()(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 24px;\n  height: 24px;\n  border-radius: 4px;\n  cursor: pointer;\n  z-index: 2;\n  svg {\n    pointer-events: none;\n  }\n  &:hover {\n    opacity: 0.9;\n  }\n"]);return y=function(){return e},e}function E(){var e=l()(["\n  position: relative;\n  width: ","px;\n  height: ","px;\n  margin: ","px;\n  transition: transform .1s linear;\n  border: 1px solid ",";\n  border-radius: 4px;\n  ","\n  "," {\n    display: ",";\n  }\n  ","\n  ","\n  ","\n  img {\n    width: 100%;\n    height: 100%;\n    display: block;\n    object-fit: cover;\n    border-radius: 4px;\n    cursor: zoom-in;\n    user-select: none;\n  }\n"]);return E=function(){return e},e}function O(){var e=l()(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n  margin: -2px;\n  cursor: ",";\n  "," {\n    cursor: ",";\n  }\n  "," {\n    img {\n      cursor: ",";\n    }\n    ","\n  }\n"]);return O=function(){return e},e}var ce=u.default.div(O(),function(e){return e.isDragImage?"grabbing":"auto"},function(){return k},function(e){return e.isDragImage?"grabbing":"pointer"},function(){return C},function(e){return e.isDragImage?"grabbing":"zoom-in"},function(e){return e.isDragImage?"":"\n      &:hover {\n        &::before {\n          content: '';\n          position: absolute;\n          left: -1px;\n          top: -1px;\n          right: -1px;\n          bottom: -1px;\n          border-radius: 4px;\n          border: 2px solid ".concat(d.c,";\n          pointer-events: none;\n        }\n      }\n    ")}),C=u.default.div(E(),se.d,se.d,se.c,d.s,function(e){return e.isDragImage?"\n    opacity: .6;\n    &::before {\n      content: '';\n      position: absolute;\n      left: -1px;\n      top: -1px;\n      right: -1px;\n      bottom: -1px;\n      border-radius: 4px;\n      border: 2px solid ".concat(d.c,";\n      pointer-events: none;\n    }\n  "):""},function(){return k},function(e){return e.isDragImage?"none":"flex"},function(e){return e.isDrag?"\n    &::after {\n      content: '';\n      position: absolute;\n      right: -6px;\n      top: 0;\n      width: 2px;\n      height: ".concat(se.d,"px;\n      background-color: ").concat(d.f,";\n    }\n  "):""},function(e){return e.isDragFirst?"\n    &::after {\n      content: '';\n      position: absolute;\n      left: -".concat(se.a,"px;\n      top: 0;\n      width: 2px;\n      height: ").concat(se.d,"px;\n      background-color: ").concat(d.f,";\n    }\n  "):""},function(e){return e.needTransformRight?"\n    transform: translateX(".concat(se.a,"px);\n  "):""}),k=u.default.div(y()),I=u.default.div(b(),d.r),S=u.default.div(v(),f()(d.q,.4)),T=u.default.div(m(),f()(d.t,.6)),_=u.default.div(g(),function(e){return e.percentage},d.f,d.f),w=u.default.div(p(),d.r),j=n("lwsE"),M=n.n(j),L=n("W8MJ"),R=n.n(L),N=n("UXvI"),le=function(){function t(e){var E=this;M()(this,t),this.mouseDownContext=null,this.handleMouseDown=function(e){var t,n=e.target;e instanceof MouseEvent&&2===e.button||n instanceof HTMLImageElement&&n.classList.contains("comment-image-cover")&&E.options.container.contains(n)&&(e.preventDefault(),t=Array.from(E.options.container.querySelectorAll(".comment-image-cover")).findIndex(function(e){return e===n}),E.mouseDownContext={currentImage:t,hasTriggerDrag:!1,isMoving:!1,dragPosition:-1})},this.handleMouseMove=Object(N.default)(function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y;E.mouseDownContext&&(n=e instanceof MouseEvent?(t=e.pageX,e.pageY):(t=e.touches[0].pageX,e.touches[0].pageY),r=(i=E.mouseDownContext).hasTriggerDrag,o=i.currentImage,s=(a=E.options).imageList,c=a.container,l=a.onDragPositionChange,u=a.onDrag,d=a.lineImageCount,u&&!r&&(u(o),E.mouseDownContext.hasTriggerDrag=!0),E.mouseDownContext.isMoving=!0,h=s[o],E.insertImageDrag(n-se.b/2,t-se.b/2,h.coverSrc||h.src),g=n-(f=c.getBoundingClientRect()).top,(p=t-(f.left-se.e/2))>se.e*(d+1)||g>se.e*Math.ceil(se.f/d)||p<0||g<0?l&&l(-1):(m=Math.floor(p/se.e)+Math.floor(g/se.e)*(d+1),v=s.length,b=Math.floor(v/d)*(d+1)+v%d,y=Math.min(m,b),E.mouseDownContext.dragPosition=y,l&&l(y)))},16),this.handleMouseUp=function(){var e,t,n,i,r,o,a,s,c,l,u;E.mouseDownContext&&(t=(e=E.mouseDownContext).isMoving,n=e.dragPosition,i=e.currentImage,E.mouseDownContext=null,t&&(o=(r=E.options).onDragPositionChange,a=r.onDrag,s=r.onDragEnd,c=r.lineImageCount,E.removeImageDrag(),o&&o(-1),a&&a(-1),l=i+Math.ceil((i+1)/c)<=n,u=n-Math.floor(n/(c+1))-(l?1:0),s&&s(i,u)))},document.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchstart",this.handleMouseDown),document.addEventListener("touchmove",this.handleMouseMove),document.addEventListener("touchend",this.handleMouseUp),this.options=e}return R()(t,[{key:"insertImageDrag",value:function(e,t,n){var i,r=document.getElementById("comment-image-drag");r?(r.style.top=e+"px",r.style.left=t+"px"):((r=document.createElement("div")).id="comment-image-drag",r.style.position="absolute",r.style.top=e+"px",r.style.left=t+"px",r.style.width="".concat(se.b,"px"),r.style.height="".concat(se.b,"px"),r.style.padding="2px",r.style.borderRadius="4px",r.style.backgroundColor=d.o,r.style.border="1px solid ".concat(d.s),r.style.zIndex="9999",r.style.cursor="grabbing",r.style.pointerEvents="none",(i=document.createElement("img")).src=n,i.style.display="block",i.style.width="100%",i.style.height="100%",i.style.objectFit="cover",i.style.borderRadius="4px",r.appendChild(i),document.body.appendChild(r))}},{key:"removeImageDrag",value:function(){var e=document.getElementById("comment-image-drag");e&&e.remove()}},{key:"updateImageList",value:function(e){this.options.imageList=e}},{key:"destroy",value:function(){this.removeImageDrag(),document.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchstart",this.handleMouseDown),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("touchend",this.handleMouseUp)}}]),t}(),D=n("96li"),x=n("pVnL"),P=n.n(x),B=n("QILm"),U=n.n(B),z=function(e){e.styles;var t=U()(e,["styles"]);return ae.a.createElement("svg",P()({width:"18",height:"18",viewBox:"0 0 18 18",fill:"none"},t),ae.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 18A9 9 0 109 0a9 9 0 000 18z",fill:"#1F2329",fillOpacity:".6"}),ae.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.48 12.4a.4.4 0 000 .57l.29.28c.15.16.4.16.56 0l3.54-3.53 3.53 3.53a.4.4 0 00.57 0l.28-.28a.4.4 0 000-.57L9.72 8.87l3.53-3.54a.4.4 0 000-.56l-.28-.29a.4.4 0 00-.57 0L8.87 8.02 5.33 4.48a.4.4 0 00-.56 0l-.29.29a.4.4 0 000 .56l3.54 3.54-3.54 3.53z",fill:"#fff"}))},H=function(e){e.styles;var t=U()(e,["styles"]);return ae.a.createElement("svg",P()({width:"20",height:"18",viewBox:"0 0 20 18",fill:"none"},t),ae.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.05 8.4L5.66 6a.69.69 0 00-.98 0l-3.3 3.31V1.38h10.78l.8-1.38H.7C.31 0 0 .3 0 .69v15.86c0 .38.3.7.69.7h2.17l5.19-8.86zm9.19-3.92a1.72 1.72 0 11-3.45 0 1.72 1.72 0 013.45 0zM15.76 0h3.55c.38 0 .69.3.69.69v15.86c0 .38-.3.7-.69.7H5.66l4.15-7.1 2.6 2.6 2.96-2.95c.27-.27.71-.27.98 0l2.27 2.27V1.37h-3.67L15.76 0z",fill:"#9CA2A9"}))},F=n("HiAM"),V=function(){var e=Object(oe.useState)(!1),t=ee()(e,2),n=t[0],i=t[1];return Object(oe.useEffect)(function(){var e=setTimeout(function(){i(!0)},100);return function(){clearTimeout(e)}},[]),n?ae.a.createElement(I,null):null},ue=function(e){var t=e.isDragImage,n=e.isDrag,i=e.isDragFirst,r=e.needTransformRight,o=e.canEdit,a=e.canDelete,s=e.onDelete,c=e.imageItem,l=e.onImageMouseDown,u=e.onImagePreview,d=e.inViewport,h=Object(oe.useState)(c.status),f=ee()(h,2),p=f[0],g=f[1];Object(oe.useEffect)(function(){c.status===D.a.LOADING&&-1<[D.a.READY,D.a.FAILED,D.a.LOADING].indexOf(p)||g(c.status)},[c.status]);var m=function(e){e.preventDefault()},v=function(){g(D.a.FAILED)},b=function(){o||g(D.a.READY)},y=function(){var e=null;switch(p){case D.a.UPLOADING:if(!o)break;e=ae.a.createElement(S,null,ae.a.createElement(T,null,ae.a.createElement(_,{percentage:c.percentage||1})));break;case D.a.FAILED:e=ae.a.createElement(w,null,ae.a.createElement(H,null));break;case D.a.LOADING:e=ae.a.createElement(V,null)}return e};return ae.a.createElement(C,{className:"comment-image-item",isDragImage:t,isDrag:n,isDragFirst:i,needTransformRight:r},(o||a)&&ae.a.createElement(k,{onMouseDown:m,onClick:function(){return s()},"data-keep":!0},ae.a.createElement(z,null)),y(),p!==D.a.FAILED&&ae.a.createElement(F.c,{canEdit:o,imageStatus:p,imageItem:c,onMouseDown:l,onClick:u,onLoad:b,onError:v,canLoadCover:d}))},W=n("m3ds"),K=n("LghI"),de=n("OX8E"),he=n("SyrE"),fe=n("Trbk"),Z=n("Xngx"),q=n("hNo0"),pe=function(e,t){return!(t.left-e.left+t.width<0||t.left-e.left>e.width||t.top-e.top+t.height<0||t.top-e.top>e.height)},ge="DocComment",Y=function(e){var n=document.createElement("div");return e.forEach(function(e){var t;e.status!==D.a.FAILED&&((t=document.createElement("img")).dataset.src=e.src,n.appendChild(t))}),n},me=function(){var r=ne()(te.a.mark(function e(t,n,i,r){var o,a;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!W.a.isLark||W.a.isLKP||W.a.isInVC){e.next=7;break}return o=t.map(function(e,t){return e.token?{key:"commentImage"+t,url:Object(Z.c)({fileToken:e.token,mountPoint:{token:i,type:q.a.COMMENT_IMAGE}})}:void console.warn("[comment image] Can not find token when preview.")}).filter(function(e){return!!e}),e.next=4,K.e.openLarkImageViewer({images:o,index:n});case 4:if(e.sent)return e.abrupt("return",null);e.next=7;break;case 7:return(a=Object(s.createViewer)(Y(t),{initialViewIndex:n,hidden:function(){r&&r(-1),a.destroy()},loading:!0,report:function(e){"PREV"!==e.actionType&&"NEXT"!==e.actionType||r&&r(a.index)}},s.MODULE_TYPE.COMMENT)).show(),e.abrupt("return",a);case 10:case"end":return e.stop()}},e)}));return function(e,t,n,i){return r.apply(this,arguments)}}(),J=function(u){var e=u.style,t=u.imageList,o=u.onImageListChange,n=u.onDeleteImage,d=u.canEdit,h=u.canDelete,i=u.lineImageCount,r=void 0===i?1/0:i,a=u.scrollContainer,s=u.isCalcCommentPosition,c=void 0===s||s,l=Object(oe.useState)(-1),f=ee()(l,2),p=f[0],g=f[1],m=Object(oe.useState)(-1),v=ee()(m,2),b=v[0],y=v[1],E=Object(oe.useState)(t),O=ee()(E,2),C=O[0],k=O[1],I=Object(oe.useState)(!1),S=ee()(I,2),T=S[0],_=S[1],w=Object(oe.useRef)(null),j=Object(oe.useRef)(C),M=Object(oe.useState)(r),L=ee()(M,2),R=L[0],N=L[1],D=Object(oe.useRef)(null),x=Object(oe.useRef)(null),P=Object(oe.useRef)(null),B=Object(oe.useRef)(a),U=function(e){g(e)},z=function(e){D.current=null,y(e)},H=Object(oe.useCallback)(function(e,t){var n,i,r;e!==t&&(i=(n=$()(j.current)).splice(e,1),r=ee()(i,1)[0],n.splice(t,0,r),o&&o(n))},[j]),F=Object(oe.useCallback)(function(){if(R!==1/0)return R;var e=w.current.getBoundingClientRect().width;return Math.floor((e+2*se.c)/se.e)||1},[R]),V=function(e){w.current&&!x.current&&(x.current=new le({container:w.current,imageList:C,lineImageCount:e,onDragPositionChange:U,onDrag:z,onDragEnd:H}))},W=Object(oe.useCallback)(function(){var t=ne()(te.a.mark(function e(t){var n,i,r,o,a,s,c,l;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.actionType,i=t.data,r=i.commentId,o=i.replyId,a=i.imageIndex,s=u.commentId,c=u.replyId,"CommentImagePreview"!==n||r!==s||o!==c)return P.current&&(P.current.destroy(),P.current=null),e.abrupt("return");e.next=6;break;case 6:if(!(-1<a)){e.next=17;break}if(!P.current){e.next=11;break}P.current.view(a),e.next=15;break;case 11:return e.next=13,me(C,a,o);case 13:(l=e.sent)&&(P.current=l);case 15:e.next=18;break;case 17:P.current&&(P.current.destroy(),P.current=null);case 18:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),[C]),K=Object(oe.useCallback)(function(e){var t,n,i;T||c&&w.current&&e.target&&((t=e.target).contains(w.current)&&(n=t.getBoundingClientRect(),i=w.current.getBoundingClientRect(),pe(Object(re.a)(n,["top","left","width","height"]),Object(re.a)(i,["top","left","width","height"]))&&_(!0)))},[w,T,c]),Z=Object(oe.useCallback)(Object(ie.default)(K,150),[K]);Object(oe.useEffect)(function(){var e=F();return N(e),d&&V(e),a.forEach(function(e){K({target:e}),e.addEventListener("scroll",Z)}),he.g.on("".concat(fe.g,":").concat(ge),W),function(){x.current&&x.current.destroy(),Z.cancel(),B.current.forEach(function(e){e.removeEventListener("scroll",Z)}),he.g.off("".concat(fe.g,":").concat(ge),W)}},[]),Object(oe.useEffect)(function(){B.current.forEach(function(e){e.removeEventListener("scroll",Z)}),a.forEach(function(e){K({target:e}),e.addEventListener("scroll",Z)}),B.current=a},[a]),Object(oe.useEffect)(function(){return de.a.on("CommentImageScroll",Z),function(){de.a.off("CommentImageScroll",Z)}},[Z]),Object(oe.useEffect)(function(){k(t),j.current=t},[t]),Object(oe.useEffect)(function(){var e;0<C.length?(e=F(),N(e),x.current?x.current.updateImageList(C):d&&V(e)):x.current&&(x.current.destroy(),x.current=null)},[C]);var q,Y=function(e){if(n&&!n(e))return;var t=$()(C);t.splice(e,1),o&&o(t)},J=function(e){var t;2!==e.button&&(e.preventDefault(),t=F(),N(t),D.current={pageX:e.pageX,pageY:e.pageY})},Q=function(){var n=ne()(te.a.mark(function e(t,n){var i,r,o,a,s,c,l;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(D.current){e.next=2;break}return e.abrupt("return");case 2:if(i=t.pageX,r=t.pageY,o=D.current,a=o.pageX,s=o.pageY,5<Math.abs(a-i)||5<Math.abs(s-r))return e.abrupt("return");e.next=6;break;case 6:t.stopPropagation(),c=u.commentId,l=u.replyId,me(C,n,l,function(e){de.a.emit(fe.a,{module:ge,actionType:"CommentImagePreview",data:{commentId:c,replyId:l,imageIndex:e}})}),c&&l&&de.a.emit(fe.a,{module:ge,actionType:"CommentImagePreview",data:{commentId:c,replyId:l,imageIndex:n}});case 10:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}();r&&r!==1/0&&(q=se.e*r+se.a);var X=Math.ceil(C.length/R);return ae.a.createElement("div",{style:e,ref:w},C.length&&ae.a.createElement(ce,{style:{maxWidth:q},isDragImage:-1<b},Array(X).fill(0).map(function(e,s){var c=Math.floor(p/(R+1))===s,l=p%(R+1);return Array(R).fill(0).map(function(e,t){var n=s*R+t;if(n+1>C.length)return null;var i=C[n],r=c&&0!==l&&l-1===t,o=c&&0===l&&0===t,a=l<=t&&c;return ae.a.createElement(ue,{key:n+(i.uid||""),isDragImage:b===n,isDrag:r,isDragFirst:o,needTransformRight:a,onDelete:function(){return Y(n)},imageItem:C[n],onImageMouseDown:J,onImagePreview:function(e){return Q(e,n)},canDelete:h,canEdit:d,inViewport:T})})})))};t.a=J},"Wc+A":function(e,s,f){"use strict";(function(m){var e=f("pVnL"),c=f.n(e),t=f("lwsE"),n=f.n(t),v=f("wq9/"),b=f("HmyT"),y=f("mRaX"),l=f("bCSi"),i=f("q1tI"),u=f.n(i),r=f("i8i4"),d=f.n(r),o=f("Si88"),h=f.n(o),a=function e(){var g=this;n()(this,e),this.showPopover=function(e){var t=e.uuid,n=e.editor,i=e.container,r=e.token,o=e.suiteType,a=e.title;g.visible&&(g.clearPopupHideTimeout(),g.closePopOver());var s,c,l,u,d,h,f,p=Object(b.$)(".mention-uuid_".concat(t));p&&(s=Object(v.a)(p.get(0),n),c=Object(b.$)(i),l=84,u=48,d=Object(y.k)([m("permission.embed.share_tips_2")+m("permission.embed.share_btn")],57),h=Object(y.v)(p,{horizontalAlign:"center",boxWidth:d,boxMaxHeight:l,boxMinHeight:u,upFirst:!0,gap:10,zoom:s,$container:c,coverNavBar:!0}),f={style:Object(y.F)(h),container:c.get(0),handlePopOverEnter:g.onMouseEnter,handlePopOverLeave:g.onMouseLeave},g.renderPopOver(f,r,o,a),g.hidePopupTimeoutId=setTimeout(function(){g.onHideSharePopup()},4e3))},this.renderPopOver=function(e,t,n,i){var r=e.container,o=e.style,a=document.createElement("div");r.appendChild(a),g.container=r,g.wrapper=a;var s=!0;d.a.render(u.a.createElement(h.a,{in:s,timeout:250,classNames:"popover-fade",onExited:g.remove},u.a.createElement("section",{onMouseEnter:g.onMouseEnter,onMouseLeave:g.onMouseLeave},u.a.createElement(l.a,c()({token:t,type:n,title:i,style:o},{closePopover:g.closePopOver,onHideSharePopup:g.onHideSharePopup})))),a,function(){g.visible=!0})},this.close=function(){d.a.unmountComponentAtNode(g.wrapper),g.container.removeChild(g.wrapper),g.wrapper=null,g.container=null},this.closePopOver=function(){g.visible&&(g.close(),g.visible=!1)},this.onMouseEnter=function(){g.isHoverPopup=!0,g.clearPopupHideTimeout()},this.onMouseLeave=function(){g.isHoverPopup=!1,g.clearPopupHideTimeout(),g.hidePopupTimeoutId=setTimeout(function(){g.onHideSharePopup()},2e3)},this.onHideSharePopup=function(){g.isHoverPopup||g.closePopOver()},this.clearPopupHideTimeout=function(){clearTimeout(g.hidePopupTimeoutId),g.hidePopupTimeoutId=0},this.destroy=function(){g.clearPopupHideTimeout(),g.closePopOver()},this.isHoverPopup=!1,this.hidePopupTimeoutId=0,this.visible=!1,this.wrapper=null,this.container=null};s.a=a}).call(this,f("2vAP"))},Wd2d:function(e,Me,Ae){"use strict";(function(c){Ae.d(Me,"a",function(){return je});var e=Ae("RIqP"),l=Ae.n(e),t=Ae("o0o1"),u=Ae.n(t),n=Ae("yXPU"),d=Ae.n(n),i=Ae("lwsE"),f=Ae.n(i),r=Ae("W8MJ"),h=Ae.n(r),o=Ae("a1gu"),p=Ae.n(o),a=Ae("Nsbk"),g=Ae.n(a),s=Ae("PJYZ"),m=Ae.n(s),v=Ae("7W2i"),b=Ae.n(v),y=Ae("cDf5"),E=Ae.n(y),O=Ae("UXvI"),C=Ae("3Hq1"),k=Ae("hbEN"),I=Ae("TSYQ"),S=Ae.n(I),T=Ae("elsr"),_=Ae("zfY2"),w=Ae("q1tI"),j=Ae.n(w),M=Ae("PLJW"),L=Ae("x1ZR"),R=Ae("sLU5"),N=Ae("UlbS"),D=Ae("G8Hj"),x=Ae("iP/4"),P=Ae("2ACu"),B=Ae("HmyT"),U=Ae("SGN9"),z=Ae("vYX0"),H=Ae("OX8E"),F=Ae("v5fw"),V=(Ae("PlSv"),Ae("hjac")),W=Ae("4PSP"),K=Ae("zhgJ"),Z=Ae("eOIy"),q=Ae("+0ye"),Y=Ae("dDhe"),J=Ae("l2V6"),Q=Ae("QM+C"),X=Ae("521f"),$=Ae("s1mk"),ee=Ae("5bIa"),te=Ae("7Kxq"),ne=Ae("R/2b"),ie=Ae("O15b"),re=Ae("GixS"),oe=Ae("NnqK"),ae=Ae("C+Is"),se=Ae("2XSo"),ce=Ae("TqgO"),le=Ae("D0c4"),ue=Ae("3EEQ"),de=Ae("V2TW"),he=Ae("mRaX"),fe=Ae("AiBH"),pe=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":E()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},ge="block-resizable-region",me=R.a.PC.DOCS.SECTION_NAV,ve=x.a.msie,be=x.a.msedge,ye=x.a.isMac,Ee=x.a.isIPad,Oe=x.a.firefox,Ce=24,ke=24,Ie=20,Se=6,Te="doc-editors-popover";function _e(e){var t,n=e.metaKey,i=e.ctrlKey,r=e.shiftKey;return(ye||Ee)&&(i=(t=[n,i])[0],n=t[1]),{ctrlKey:i,metaKey:n,shiftKey:r}}function we(e,t){return e.guid===t.guid&&e.cls===t.cls&&e.text===t.text&&e.type===t.type&&e.olCls===t.olCls&&e.olStart===t.olStart}var je=function(e){function r(e){var h;f()(this,r),(h=p()(this,g()(r).call(this,e))).entriesContainerRef=null,h.sectionNavRef=null,h.navContainerRef=null,h.setEntriesContainerRef=function(e){h.entriesContainerRef=e},h.setSectionNavRef=function(e){h.sectionNavRef=e;var t=h.props.getSectionNavRef;t&&t(e)},h.setNavContainerRef=function(e){h.navContainerRef=e},h.activeGuid=null,h.isContextMenuJustClicked=!1,h.showFullTimer=new F.a,h.showAccordingToPinStateTimer=new F.a,h.resetWidthTimer=new F.a,h.showAbstractTimer=new F.a,h.isOverlaySectionNavStatus=!1,h.scroller=null,h.currentViewLineNumberValues=null,h.currentSectionNavRect=null,h.navRectDirty=!1,h.useTempPin=x.a.isOpendoc,h.tempPin=!0,h.inited=!1,h.dataReadyToRenderStageCollector=new $.a(m()(h)),h.ignoreActiveGuidChange=!1,h.popOver=null,h.setWidth=function(){h.setState({maxWidth:h.etherpadLeftSpaceWidth})},h.setHoverWidth=function(){h.setState({maxWidth:h.etherpadLeftSpaceWidth/2})},h.showPopOverIfNecessary=Object(O.default)(function(e){var t=e.clientX;if(h.etherpadLeftSpaceWidth-ce.e-t>ce.g)return h.closePopOver(),void h.toggleNavContainerZindex("up");h.showPopOver(e)},300,{leading:!1}),h.showPopOver=Object(k.default)(function(e){var t,n,i,r,o,a,s,c,l=e.clientY,u=e.target,d=u.closest(".ace-line-pocket");u&&d?(n=(t=u.getBoundingClientRect()).top,i=t.right,l-n>ce.a?h.closePopOver():(Object(P.default)("doc_main_body_author",{action_source:"user",action:"hover_main_author"}),x.a.isOpendoc||h.popOver||(r=u.className,o=h.props.editor,!(a=Object(de.a)(r))||(s=se.a.getUserNameById(a))&&(c={className:Te,style:Object(he.F)(Object.assign({},Object(he.v)(d,{boxWidth:0,zoom:1,mouseY:l,horizontalAlign:"left",flatDom:!0,gap:10,coverNavBar:!0,closeContainerBottom:!0,$boxContainer:Object(B.$)("body")}),{left:i+12})),container:document.body,component:j.a.createElement(le.default,Object.assign({closePopover:h.closePopOver},{name:s,token:a,sourceString:"doc",source:fe.z.DOC},{editor:o,triangle:"bottom"}))},h.popOver=new ue.default(c))))):h.closePopOver()},400),h.clearHideTimeout=function(){h.closePopOver.cancel()},h.closePopOver=Object(k.default)(function(){h.showPopOverIfNecessary.cancel(),h.showPopOver.cancel(),h.popOver&&(h.popOver.close(),h.popOver=null)},100),h.fetchSectionList=function(){h.inited||H.a.trigger(me.ON_SECTION_NAV_READY)},h.opendocGetDirectoryData=function(){return h.state.entries.reduce(function(e,t){var n=t.title,i=t.text,r=t.indentationLevel,o=t.guid;return n||e.push({text:i,indentLevel:r,anchor:o}),e},[])},h.checkIsOverlay=function(e){if(!h.currentSectionNavRect)return!1;var t=h.currentSectionNavRect,n=t.top,i=t.bottom,r=t.right,o=se.a.getViewEditorsMenuStatus()?ce.e-6:0;return n<e.bottom&&i>e.top&&r+o>e.left},h.isResizableBlockOverlay=function(e){var t=h.props.editor.getRep(T.a).lines.atIndex(e).lineNode,n=Object(B.$)(".ace-table-wrapper",t)[0],i=Object(B.$)(".".concat(ge),t)[0];if(n||!i)return!1;var r=i.getBoundingClientRect(),o={top:r.top-Se,left:r.left-Se,bottom:r.bottom+Se,right:r.right+Se};return h.checkIsOverlay(o)},h.isFullWidthPicOverlay=function(e){var t=h.props.editor.getRep(T.a).lines.atIndex(e).lineNode;if(!t)return!1;if(!t.className.includes("align-full"))return!1;var n=t.querySelector("img");if(!n)return!1;var i=n.getBoundingClientRect();return h.checkIsOverlay(i)},h.isHalfFullWidthSectionOverlay=function(e){var t,n=h.props.editor,i=n.getRep(T.a).lines.atIndex(e);return!!(i&&i.lineNode&&i.isFullWidth&&i.fullWidthNode)&&(!!(t=!!i.getInstanceByName(te.e.ACE_TABLE)?h.getTableRect(i,e):n.plugins.blockPlugin.getRectCoordsForFullWidthElement(i))&&h.checkIsOverlay(t))},h.isCurrentLineCollapsed=function(e){var t=h.props.editor;return!!(t.lineTracker&&t.lineTracker.collapseLines&&t.lineTracker.collapseLines.getCollapsedStatusOfLine&&t.lineTracker.collapseLines.getCollapsedStatusOfLine(T.a,e).renderCollapsed)},h.isCurrentLineOverlaySectionNav=function(e,t){return!h.isCurrentLineCollapsed(t)&&e.some(function(e){return e(t)})},h.isOverlaySectionNav=function(e,t){if(!h.props.editor||!h.currentSectionNavRect||!h.sectionNavRef)return!1;var n=Object(K.k)(),i=!n||"true"===n.open,r=[h.isFullWidthPicOverlay,h.isResizableBlockOverlay];i&&r.push(h.isHalfFullWidthSectionOverlay);for(var o=e;o<=t;o++)if(h.isCurrentLineOverlaySectionNav(r,o))return!0;return!1},h.onNewEntries=function(){var t=d()(u.a.mark(function e(n){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.state.entries,h.inited=!0,t.length!==n.length){e.next=8;break}if(t.every(function(e,t){return we(e,n[t])}))return h.dataReadyToRenderStageCollector.dataReady(X.a.FETCH_DOC_SECTION_NAV_SUCCESS,Q.FILE_TYPE.DOC),h.dataReadyToRenderStageCollector.didUpdate(X.a.RENDER_DOC_SECTION_NAV_SUCCESS,Q.FILE_TYPE.DOC),e.abrupt("return");e.next=8;break;case 8:if(h.setIndentationLevel(n),h.dataReadyToRenderStageCollector.dataReady(X.a.FETCH_DOC_SECTION_NAV_SUCCESS,Q.FILE_TYPE.DOC),h.setState({entries:n},function(){h.navRectDirty=!0,h.sendDirectoryDataToOpendoc()}),0===t.length&&0<n.length)return e.next=14,h.resetWidthTimer.sleep(0);e.next=15;break;case 14:h.resetWidthAndHeight();case 15:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),h.setIndentationLevel=function(e){var t=[];e.forEach(function(e){e.title||t.push(Object(q.c)(e.type))});var n=l()(new Set(t)).sort();e.forEach(function(e){e.indentationLevel=n.indexOf(Object(q.c)(e.type))+1})},h.onNewActiveGuid=function(e,t){var n;e&&!h.isValidGuid(e)||(n=h.activeGuid,h.ignoreActiveGuidChange&&!t||n!==e&&(t&&(h.ignoreActiveGuidChange=!0,setTimeout(function(){h.ignoreActiveGuidChange=!1},500)),h.activeGuid=e,x.a.isOpendoc&&Object(_.sendOpendocEvent)(ae.d.CURR_ANCHOR,h.activeGuid),h.state.isShowing&&(h.switchActiveNavItem(),h.scrollEntriesContainer())))},h.scrollEntriesContainer=function(){var e,t,n,i,r,o;h.entriesContainerRef&&h.activeGuid&&(e="",e=(h.state.isShowingFull?".full-entry[data-guid=":".abstract-entry[data-guid=").concat(h.activeGuid,"]"),0!==(t=Object(B.$)(e,h.entriesContainerRef)).length&&(i=(n=Object(B.$)(h.entriesContainerRef)).scrollTop(),r=n.innerHeight(),((o=t.position().top)-i<0||r<o-i)&&n.scrollTop(o-20)))},h.resetWidthAndHeight=function(){h.isPinned?(h.setWidth(),h.navRectDirty=!0):h.setHoverWidth(),h.scrollEntriesContainer();var e=window.innerHeight-94,t="".concat(e%2?e-1:e,"px");h.state.maxHeight!==t&&h.setState({maxHeight:t})},h.onShowingStateChange=function(e){h.state.isShowing!==e&&(h.setState({isShowing:e}),e&&!h.props.keepShowFull&&h.showAccordingToPinState())},h.handleShowingFullChange=function(e){},h.onMouseEnter=function(e){var t,n,i;h.toggleNavContainerZindex("up"),h.closePopOver(),!h.props.keepShowFull&&h.currentViewLineNumberValues&&(n=(t=h.currentViewLineNumberValues).inViewTopLineNu,i=t.inViewBottomLineNu,h.isOverlaySectionNavStatus=h.isOverlaySectionNav(n,i),h.showFullWithDelay(),h.setIsShowingPin(!0))},h.onMouseLeave=function(e){h.toggleNavContainerZindex("down"),h.props.keepShowFull||(h.mouseLeaveWithDelay(),h.setIsShowingPin(!1))},h.showFull=function(){h.setWidth(),h.setState({isShowingFull:!0,isTableOver:h.isOverlaySectionNavStatus}),h.props.sharedDocGuideOn&&Object(U.r)(),Object(P.collectSuiteEvent)("show_nav_catalog",{is_ding:+h.isPinned})},h.showAbstract=function(){h.setState({isShowingFull:!1,isTableOver:h.isOverlaySectionNavStatus}),h.isOverlaySectionNavStatus||h.setHoverWidth(),h.props.sharedDocGuideOn&&Object(U.r)()},h.showAccordingToPinState=function(){h.showFullTimer.cancel(),h.isContextMenuJustClicked||(h.isPinned&&!h.isOverlaySectionNavStatus?h.showFull():h.showAbstract())},h.onPinClicked=function(e){h.isPinned=!h.isPinned,h.setState({isPinned:h.isPinned}),h.showAccordingToPinState(),h.props.sharedDocGuideOn&&Object(U.f)(D.STEP_TYPES.shared_doc_group_toc),h.isPinned?Object(P.collectSuiteEvent)("click_ding_catalog"):(Object(P.collectSuiteEvent)("click_ding_catalog_cancel"),h.setIsShowingPin(!1),h.setIsHoverPin(!1))},h.handlePinMouseEnter=function(){h.setIsHoverPin(!0)},h.handlePinMouseLeave=function(){h.setIsHoverPin(!1)},h.onContextMenu=function(){h.isContextMenuJustClicked=!0,h.clearContextMenuJustClicked()},h.clearContextMenuJustClicked=Object(k.default)(function(){h.isContextMenuJustClicked=!1},100),h.onFullEntryClicked=function(e){e.preventDefault();var t,n=_e(e),i=n.ctrlKey,r=n.shiftKey;i||r||(t=Object(B.$)(e.currentTarget).attr("data-guid"),h.onNewActiveGuid(t,!0),Object(V.a)(t),H.a.emit(me.ON_SCROLL_TO_ACTIVE_LINE,t),Object(P.collectSuiteEvent)("click_nav_catalog_item",{is_ding:+h.isPinned}))},h.onScrollPreventParentFromScrolling=ve||be||Oe?function(e){e.stopPropagation(),e.preventDefault()}:void 0,h.onMouseWheelPreventParentFromScrolling=ve||be||Oe?function(e){if(null!==h.entriesContainerRef){var t=Object(B.$)(h.entriesContainerRef),n=h.entriesContainerRef.scrollHeight,i=t.scrollTop(),r=t.innerHeight(),o=e.deltaY;return 0<o&&n-i-r<o?(t.scrollTop(n),a()):o<0&&i<-o?(t.scrollTop(0),a()):void 0}function a(){return e.stopPropagation(),e.preventDefault(),!1}}:void 0,h.handleCopy=function(e){var t=h.props.otherPermissions;t&&!t.copyable&&(e.preventDefault(),h.props.copyTextWithoutPermission())};var t=e.keepShowFull,n=e.opendocDirectoryConfig,i=e.opendocDirectory;return x.a.isOpendoc&&!!(n&&!n.pin||i&&i.noPin)&&(h.isPinned=!1),h.state={isShowing:!0,entries:[],isShowingFull:t||h.isPinned,isPinned:t||h.isPinned,maxWidth:h.etherpadLeftSpaceWidth,isShowingPin:!1,isHoverPin:!1,isTableOver:!1,maxHeight:"unset"},h.isOverlaySectionNavStatus=!1,Object(ee.a)(),h}function t(){return n.apply(this,arguments)}var n,i,o;function a(){return i.apply(this,arguments)}function s(){return o.apply(this,arguments)}return b()(r,e),h()(r,[{key:"getNavMaxWidth",value:function(){var e=this.props.haveEditPermission,t=this.state.maxWidth,n=this.state.isShowingFull;return!Object(C.default)(t)&&n&&(se.a.getViewEditorsMenuStatus()?t=t-ce.e+Ie-ce.g:(t=t-ke+Ie,e&&(t-=Ce))),t}},{key:"render",value:function(){var e=this.props,t=e.keepShowFull,n=e.className,i=void 0===n?"":n,r=e.opendocDirectoryConfig,o=e.opendocDirectory,a=this.state,s=a.isShowing,c=a.isShowingFull,l=a.isTableOver,u=a.maxHeight,d=this.getNavMaxWidth();if(!!(x.a.isOpendoc&&!(r&&r.enable||o&&o.hide)))return null;if(!s||void 0===d)return j.a.createElement("div",{className:"section-nav-container ".concat(i)});var h=this.isOverlaySectionNavStatus&&c;return j.a.createElement("div",{className:"section-nav-container".concat(i?" ".concat(i):""),onCopy:this.handleCopy,onCut:this.handleCopy,ref:this.setNavContainerRef},j.a.createElement("div",{className:S()("section-nav",{"showing-full":c,"section-nav-table":l,"showing-animation":h,"section-nav-in-edge":x.a.isEdge}),style:{maxWidth:Object(Y.c)()?0:d,minWidth:Object(Y.c)()?"unset":void 0},ref:this.setSectionNavRef,"data-selector":"section-nav",onContextMenu:this.onContextMenu,onMouseLeave:this.onMouseLeave,onMouseEnter:this.onMouseEnter,onScroll:this.onScrollPreventParentFromScrolling,onWheel:this.onMouseWheelPreventParentFromScrolling},t?null:this.renderPin(),j.a.createElement(Z.b,{className:"entries-container",containerRef:this.setEntriesContainerRef,options:{suppressScrollX:!0},style:{outline:"transparent",maxHeight:u},size:Z.a.Small},c?this.renderFullEntryList():this.renderAbstractEntryList())),j.a.createElement("span",{ref:this.spanScript}))}},{key:"renderPin",value:function(){var e=this.state,t=e.isShowingFull,n=e.isPinned,i=e.isShowingPin,r=e.isHoverPin;return i&&t?j.a.createElement("div",{className:"pin"},j.a.createElement(N.Tooltip,{visible:r,showDelay:200,title:c(n?"etherpad.hide_dir":"etherpad.peg_dir"),placement:"bottom"},j.a.createElement("span",{onClick:this.onPinClicked,onMouseEnter:this.handlePinMouseEnter,onMouseLeave:this.handlePinMouseLeave},n?j.a.createElement(M.a,null):j.a.createElement(L.a,null)))):null}},{key:"renderFullEntryList",value:function(){var e=this.onFullEntryClicked,t=this.activeGuid,n=this.state.entries,i=this.props,r={token:i.token,activeGuid:t,entries:n,onFullEntryClicked:e,translated:i.translated};return j.a.createElement(z.b,Object.assign({},r))}},{key:"renderAbstractEntryList",value:function(){var e=this.activeGuid,t=this.state.entries;return j.a.createElement(z.a,{entries:t,activeGuid:e})}},{key:"componentDidUpdate",value:function(e,t){var n=this,i=this.state.maxWidth,r=this.props,o=r.keepShowFull,a=r.editor;e.token!==this.props.token&&(this.setState({entries:[],isShowingFull:o||this.isPinned,isPinned:o||this.isPinned,maxWidth:void 0},function(){n.sendDirectoryDataToOpendoc()}),this.dataReadyToRenderStageCollector.switchDocToken()),this.props.sharedDocGuideOn&&"number"==typeof i&&i<=0&&Object(U.r)(),a!==e.editor&&this.bindScrollerEvent(),this.dataReadyToRenderStageCollector.didUpdate(X.a.RENDER_DOC_SECTION_NAV_SUCCESS,Q.FILE_TYPE.DOC)}},{key:"onFirstRenderAfterDataReady",value:function(){this.props.updateBusinessStage(ne.b.Doc,ne.c.SectionNavRendered),Object(oe.c)()}},{key:"componentDidMount",value:function(){H.a.on(me.ON_NEW_ENTRIES,this.onNewEntries),H.a.on(me.ON_NEW_ACTIVE_GUID,this.onNewActiveGuid),H.a.on(me.ON_RESIZE,this.resetWidthAndHeight),H.a.on(me.ON_SHOWING_STATE_CHANGE,this.onShowingStateChange),H.a.on(me.ON_SHOWING_FULL_CHANGE,this.handleShowingFullChange),H.a.on(me.ON_LINE_ENTRY_CHANGE,this.showAbstractIfNecessary),H.a.on("blockPositionUpdate",this.showAbstractIfNecessary),H.a.on("showAbstractIfNecessary",this.showAbstractIfNecessary),H.a.on("viewEditorsStatusUpdate",this.handleViewEditorsMenuUpdate),window.addEventListener("resize",this.onResize),this.resetWidthAndHeight(),this.fetchSectionList(),Object(Y.c)()&&this.insertSSRScript(),this.bindScrollerEvent(),x.a.isOpendoc&&Object(_.registerOpendocApi)(ae.b.getDirectoryData,this.opendocGetDirectoryData),Object(B.$)(document.body).on("mousemove",".partially-full-screen",this.handleMouseMove),Object(B.$)(document.body).on("mousemove",".tb-scrollable-content",this.handleMouseMove),se.a.getViewEditorsMenuStatus()&&this.toggleEditosEvents(!0)}},{key:"handleMouseMove",value:function(e){var t,n,i,r,o=e.clientY,a=e.clientX,s=this.getNavMaxWidth();!this.state.isShowingFull||void 0===s||s<a||this.navContainerRef&&this.currentSectionNavRect&&(n=(t=this.currentSectionNavRect).top,i=t.bottom,r=t.right,t.left<a&&a<r&&n<o&&o<i?this.toggleNavContainerZindex("up"):this.toggleNavContainerZindex("down"))}},{key:"componentWillUnmount",value:function(){H.a.off(me.ON_NEW_ENTRIES,this.onNewEntries),H.a.off(me.ON_NEW_ACTIVE_GUID,this.onNewActiveGuid),H.a.off(me.ON_RESIZE,this.resetWidthAndHeight),H.a.off(me.ON_SHOWING_STATE_CHANGE,this.onShowingStateChange),H.a.off(me.ON_SHOWING_FULL_CHANGE,this.handleShowingFullChange),H.a.off(me.ON_LINE_ENTRY_CHANGE,this.showAbstractIfNecessary),H.a.off("blockPositionUpdate",this.showAbstractIfNecessary),H.a.off("showAbstractIfNecessary",this.showAbstractIfNecessary),H.a.off("viewEditorsStatusUpdate",this.handleViewEditorsMenuUpdate),window.removeEventListener("resize",this.onResize),this.cancelThrottleFn(this.onResize),this.cancelThrottleFn(this.showAbstractIfNecessary),this.cancelThrottleFn(this.handleMouseMove),this.showFullTimer.cancel(),this.showAccordingToPinStateTimer.cancel(),this.resetWidthTimer.cancel(),this.showAbstractTimer.cancel(),this.clearContextMenuJustClicked.cancel(),this.entriesContainerRef=null,this.sectionNavRef=null,this.destroyScroller(),this.closePopOver.cancel(),this.showPopOverIfNecessary.cancel(),this.showPopOver.cancel(),Object(B.$)(document.body).off("mousemove",".partially-full-screen",this.handleMouseMove),Object(B.$)(document.body).off("mousemove",".tb-scrollable-content",this.handleMouseMove),this.toggleEditosEvents(!1)}},{key:"cancelThrottleFn",value:function(e){e.cancel()}},{key:"bindScrollerEvent",value:function(){this.destroyScroller();var e=this.props.editor;e&&e.once("paint",this.scrollerEvent)}},{key:"destroyScroller",value:function(){this.scroller&&this.scroller.destroy()}},{key:"scrollerEvent",value:function(){var e=this.props.editor;this.etherpadContainerWrapper=e.getScrollContainer(),this.etherpadContainerWrapper&&(this.scroller=new J.a({editor:e,limit:1,duration:50,scroller:this.etherpadContainerWrapper,listener:this.handleScroll}),this.scroller.collectViewData())}},{key:"updateCurrentNavRect",value:function(){this.state.isShowingFull&&this.navRectDirty&&this.sectionNavRef&&(this.currentSectionNavRect=this.sectionNavRef.getBoundingClientRect(),this.navRectDirty=!1)}},{key:"handleViewEditorsMenuUpdate",value:function(e){this.forceUpdate(),this.navRectDirty=!0,this.updateCurrentNavRect(),this.toggleEditosEvents(e)}},{key:"toggleEditosEvents",value:function(e){Object(B.$)(document.body)[e?"on":"off"]("mousemove",".".concat(ce.d),this.showPopOverIfNecessary),Object(B.$)(document.body)[e?"on":"off"]("mouseleave",".".concat(ce.d),this.closePopOver),Object(B.$)(document.body)[e?"on":"off"]("mouseenter",".".concat(Te),this.clearHideTimeout),Object(B.$)(document.body)[e?"on":"off"]("mouseleave",".".concat(Te),this.closePopOver)}},{key:"handleScroll",value:function(e){this.currentViewLineNumberValues=e,this.showAbstractIfNecessary()}},{key:"sendDirectoryDataToOpendoc",value:function(){var e;x.a.isOpendoc&&(e=this.opendocGetDirectoryData(),Object(_.sendOpendocEvent)(ae.d.DIRECTORY_CHANGE,e))}},{key:"showAbstractIfNecessary",value:(o=d()(u.a.mark(function e(){var t,n,i,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.keepShowFull)return e.abrupt("return");e.next=2;break;case 2:if(this.currentViewLineNumberValues){e.next=5;break}return this.scroller&&this.scroller.collectViewData(),e.abrupt("return");case 5:if(this.isPinned){e.next=7;break}return e.abrupt("return");case 7:if(this.updateCurrentNavRect(),this.showAbstractTimer.cancel(),t=this.currentViewLineNumberValues,n=t.inViewTopLineNu,i=t.inViewBottomLineNu,r=this.props.editor.getReps()[T.a],i>=r.lines.length())return e.abrupt("return");e.next=13;break;case 13:o=this.isOverlaySectionNav(n,i),this.isOverlaySectionNavStatus!==o&&(Object(P.collectSuiteEvent)("toggle_attribute",{table_slide_hide_catalog:this.isOverlaySectionNavStatus}),(this.isOverlaySectionNavStatus=o)?this.showAbstract():this.showAccordingToPinState(),this.scrollEntriesContainer());case 15:case"end":return e.stop()}},e,this)})),s)},{key:"getTableRect",value:function(e,t){var n,i,r=this.props,o=r.editor,a=r.haveEditPermission,s=e.fullWidthNode.getBoundingClientRect(),c={top:s.top,bottom:s.bottom,left:s.left,right:s.right};return se.a.getViewEditorsMenuStatus()||a&&(n=o.getLineNumInRootZone(o.getRep().zoneId,-1)===t,i=ie.a,n&&(i+=re.c+re.e),c.left-=i),c}},{key:"isValidGuid",value:function(e){return/^[a-z\d\-]+$/i.test(e)}},{key:"switchActiveNavItem",value:function(){Object(B.$)(".active",this.entriesContainerRef).removeClass("active"),this.activeGuid&&Object(B.$)('[data-guid="'.concat(this.activeGuid,'"]')).addClass("active")}},{key:"onResize",value:function(){this.resetWidthAndHeight()}},{key:"toggleNavContainerZindex",value:function(e){this.navContainerRef&&(this.navContainerRef.style.zIndex="up"===e?"40":"1")}},{key:"toggleEntriesContainerBackground",value:function(e){this.entriesContainerRef&&("enter"===e?this.state.isShowingFull||(this.entriesContainerRef.style.background="rgba(255, 255, 255, 0.99)"):this.entriesContainerRef.style.background="transparent")}},{key:"mouseLeaveWithDelay",value:(i=d()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showFullTimer.cancel(),this.showAccordingToPinStateTimer.cancel(),e.next=4,this.showAccordingToPinStateTimer.sleep(400);case 4:this.toggleEntriesContainerBackground("leave"),this.showAccordingToPinState();case 6:case"end":return e.stop()}},e,this)})),a)},{key:"showFullWithDelay",value:(n=d()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showAccordingToPinStateTimer.cancel(),this.showFullTimer.cancel(),t=this.state.isShowingFull?0:300,e.next=5,this.showFullTimer.sleep(t);case 5:this.toggleEntriesContainerBackground("enter"),this.showFull();case 7:case"end":return e.stop()}},e,this)})),t)},{key:"setIsShowingPin",value:function(e){this.setState({isShowingPin:e})}},{key:"spanScript",value:function(e){this.spanScriptEl=e}},{key:"insertSSRScript",value:function(){var e="\n      try {\n        window.ssr_wikiEnable = ".concat(Object(Y.d)(),";\n\n        var hideDirectory = /hideDirectory=[^=]+/.test(location.search);\n        if (hideDirectory) {\n          var directoryEl = document.querySelector('.section-nav-container');\n          if (directoryEl) {\n            directoryEl.style.display = 'none';\n          }\n        } else {\n          // \n          var pinStateKey = '").concat(this.pinStateKey,"';\n          var pinFlag = window.localStorage.getItem(pinStateKey);\n          var noPin = /noPinDirectory=true/.test(location.search);\n          var isPinned = (pinFlag === '1' || pinFlag === null) && !noPin;\n\n          var windowInnerWidth = window.innerWidth;\n\n          //  etherpad \n          function getEtherpadLeftSpaceWidth() {\n            var leftSpaceWidth;\n            if (windowInnerWidth > 1400) {\n              var etherpadWidth = 790;\n              leftSpaceWidth = (windowInnerWidth - etherpadWidth) / 2;\n            } else if (windowInnerWidth <= 900) {\n              leftSpaceWidth = 32;\n            } else if (windowInnerWidth <= 1279) {\n              leftSpaceWidth = windowInnerWidth * 0.15;\n            } else if (windowInnerWidth <= 1400) {\n              leftSpaceWidth = windowInnerWidth * 0.2;\n            }\n            return leftSpaceWidth;\n          }\n\n          var etherpadLeftSpaceWidth = getEtherpadLeftSpaceWidth();\n\n          var visibleElClass = 'showing-full';\n\n          //  SSR \n          Array.from(document.querySelectorAll('#ssrBox .section-nav')).forEach(function(item) {\n            if (isPinned) {\n              item.classList.add(visibleElClass);\n              var maxWidth = etherpadLeftSpaceWidth - 24 + 20;\n              var data = ((window.DATA || {}).clientVars || {}).data;\n              if (data && data.readonly) {\n                maxWidth -= 24;\n              }\n              item.style.maxWidth = maxWidth + 'px';\n            } else {\n              item.classList.remove(visibleElClass);\n              item.style.maxWidth = etherpadLeftSpaceWidth / 2 + 'px';\n            }\n          });\n\n          //  SSR \n          var windowInnerHeight = window.innerHeight - 94;\n          var maxHeight = windowInnerHeight % 2 ? windowInnerHeight - 1 : windowInnerHeight;\n          Array.from(document.querySelectorAll('#ssrBox .entries-container')).forEach(function(item) {\n            item.style.maxHeight = maxHeight + 'px';\n          });\n        }\n      } catch(err) {\n        console.warn(err);\n      }\n    "),t=document.createElement("script");t.text=e,this.spanScriptEl&&this.spanScriptEl.appendChild(t)}},{key:"setIsHoverPin",value:function(e){this.setState({isHoverPin:e})}},{key:"pinStateKey",get:function(){return"section-nav:pin"}},{key:"isPinned",get:function(){if(this.useTempPin)return this.tempPin;var e=window.localStorage.getItem(this.pinStateKey);return"1"===e||null===e},set:function(e){this.useTempPin?this.tempPin=e:window.localStorage.setItem(this.pinStateKey,e?"1":"")}},{key:"etherpadLeftSpaceWidth",get:function(){var e=this.props.isDocInContainer,t=Object(B.$)(".etherpad-container"),n=t.offset();return 0!==t.length&&n?e?t[0].offsetLeft:n.left:0}}]),r}(w.PureComponent);je.defaultProps={},pe([Object(W.Bind)(),Object(W.Throttle)(500)],je.prototype,"handleMouseMove",null),pe([Object(W.Bind)()],je.prototype,"scrollerEvent",null),pe([Object(W.Bind)()],je.prototype,"handleViewEditorsMenuUpdate",null),pe([Object(W.Bind)()],je.prototype,"handleScroll",null),pe([Object(W.Bind)(),Object(W.Throttle)(100)],je.prototype,"showAbstractIfNecessary",null),pe([Object(W.Bind)(),Object(W.Throttle)(100)],je.prototype,"onResize",null),pe([Object(W.Bind)()],je.prototype,"spanScript",null)}).call(this,Ae("2vAP"))},WsN4:function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{}).Src="src",r.DataNoRequestSrc="data-no-request-src",r.DataSrc="data-src",r.DataSuite="data-suite",r.DataHeight="data-height",r.DataWidth="data-width"},WtIE:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return E});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("q1tI"),u=n.n(l),d=n("YNKm"),h=n("YWBl"),f=n("7Kxq"),p=n("F9bh"),g=n("y2sV"),m=n("OWch"),v=n("Nl7c"),b=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},y="IGNORE_UNDERLINE",E=function(){function t(e){var a=this;r()(this,t),this.editor=e,this.className="Underline",this.aceInitialized=function(e,t){a.register(t.editorInfo)},this.register=function(e){e.commands.registerAceCommand(d.db,function(e,t,n,i){var r=i.source,o=a.toggleAttribute({attribKey:"underline",attribValue:!0});Object(h.a)({action:"underline",op:o?f.g:f.f,source:r})},{statusKey:"underline-true"})},this.aceAttribsToClasses=function(e,t){return"underline"===t.key?["tag:u"]:null},this.editor=e,this.register(e)}return a()(t,[{key:"toggleAttribute",value:function(e){var t=e.attribKey,n=e.attribValue,i=e.range,r=e.isSpecialSelection,o=e.isAllHasAttrib,a=i.selStart,s=i.selEnd,c=i.attributeManager;return r?(c.setAttributesOnRange(a,s,[[t,o?"":n]]),o):this.editor.toggleAttributeOnSelection(t,i,n)}},{key:"serialize",value:function(e){return Object(g.P)(e,{tagAttribute:d.db,wrapTag:g.a[d.db]})}},{key:"match",value:function(e){return"underline"===e}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement){var r=t.tagName,o=t.getAttribute("style")||"";if("U"===r||"INS"===r||/\btext-decoration(-line)?:[^;]*underline\b/i.test(o))return Object(g.H)(n,i,{underline:"true"})}return n}},{key:"render",value:function(e){var t=e.children;return u.a.createElement(g.w,{style:{textDecoration:"underline"}},t)}}]),t}();b([Object(p.a)()],E.prototype,"toggleAttribute",null),b([m.a,Object(v.b)()],E.prototype,"render",null)},WzBf:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("mJXI"),c=n("5gS9"),l=n("toa8"),u=n("rLED"),d=function(){function o(){r()(this,o)}return a()(o,null,[{key:"register",value:function(e,t){var n=this.generateOptions(e),i=n.token,r=o.messageBoxMap.get(i);r||(r=new s.a(n,c.b.getInstance(),l.d,Object(u.H)()),o.messageBoxMap.set(i,r)),r.register(t,n.subtype)}},{key:"deregister",value:function(e,t){var n=this.generateOptions(e),i=o.messageBoxMap.get(n.token);i&&(i.deregister(t,n.subtype),i.isRegistered()||(i.destory(),o.messageBoxMap.delete(n.token)))}},{key:"onError",value:function(e,t){var n=this.generateOptions(e),i=o.messageBoxMap.get(n.token);i||(i=new s.a(n,c.b.getInstance(),l.d,Object(u.H)()),o.messageBoxMap.set(n.token,i)),i.onError(t)}},{key:"removeErrorListener",value:function(e,t){var n=this.generateOptions(e),i=o.messageBoxMap.get(n.token);i&&i.removeErrorListener(t)}},{key:"generateOptions",value:function(e){return"string"==typeof e?{token:e}:e}}]),o}();d.messageBoxMap=new Map},X4VC:function(e,t,n){"use strict";var i=n("FJEn"),r=n("+4eN"),o=i.tableIds.isRowsZoneId,a=i.tableIds.isColsZoneId,s=function(e,t){var n=t?[i.DEFAULT_REP_ZONE]:[];return Object.keys(e.managers.zoneToLineEntry).forEach(function(e){!Object(r.g)(e)&&(o(e)||a(e))||n.push(e)}),n};t.a=s},XB4d:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var w=n("nVH4"),j=n("iP/4");function i(e){var n=e.editor,i=e.evt,t=e.isSpecialContent,r=e.selectContentCallback,o=5,a=i.keyCode,s=i.ctrlKey,c=i.metaKey,l=i.shiftKey,u=n.selection.getSelection().start,d=u.line,h=u.offset,f=n.getContentState().getActiveZone(),p=f.getLine(d),g=Math.max(0,d-1),m=f.getLine(g),v=d+1,b=f.getLine(v),y=!!p&&t(n,p,d),E=!!m&&t(n,m,g),O=!!b&&t(n,b,v),C=n.getContentState().getActiveZone().getZoneId();if(!y&&!E&&!O||c||s||l)return!1;if((E||O)&&!y&&a===w.a.UP&&0<p._entry.getCharRect(h).top)return!1;var k=p.length()-p.getLineMarker();function I(){if(0===k)return!0;if(y)return!0;var e=p._entry.getCharRect(h),t=p._entry.getCharRect(0);return Math.abs(t.top-e.top)<=o}function S(){if(0===k)return!0;if(y)return!0;var e=p._entry.getCharRect(h),t=p._entry.getCharRect(p.length()-1);return Math.abs(t.top-e.top)<=o}function T(){var e=!E&&m?m.length():0;n.performSelectionChange(C,[g,e],[g,e]);var t=j.a.isEdge||j.a.isIE;n.updateBrowserSelectionFromRep(t),i.preventDefault(),m&&r&&r(n,m,g)}function _(){var e=0;n.performSelectionChange(C,[v,e],[v,e]);var t=j.a.isEdge||j.a.isIE;n.updateBrowserSelectionFromRep(t),i.preventDefault(),b&&r&&r(n,b,v)}switch(a){case w.a.UP:if(E&&I()||y)return T(),!0;break;case w.a.DOWN:if(O&&S()||y)return _(),!0;break;case w.a.LEFT:if(E&&h===p.getLineMarker()||y)return T(),!0;break;case w.a.RIGHT:if(O&&h+1>=p.length()||y)return _(),!0;break;default:return!1}return!1}},XC0b:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i=n("lwsE"),o=n.n(i),r=n("W8MJ"),a=n.n(r),g=n("xpYl"),s=n("UXvI"),c=n("hbEN"),m=n("sFgt"),v=n("WLPM"),b=n("4HEM"),l=n("ylw9"),d=n("OX8E"),u=n("nVH4"),h=n("IyQe"),f=n("U5G9"),y=n("7Kxq"),E=n("SCx9"),O=n("kESg"),C=n("+4eN"),k=Object(f.b)({module:f.a.SELECTION_POPUP}),p=function(){function r(e){var p=this,t=e.editor,n=e.commentable,i=void 0===n||n;o()(this,r),this.className="SelectionPopup",this.aceInitialized=function(e,t){p.editorInfo=t.editorInfo,p.showCommentTip=Object(c.default)(p._showCommentTip.bind(p),50),p.onScrollThrottle=Object(s.default)(p._onScroll.bind(p),50),p.etherpadContainer=$(".etherpad-container-wrapper"),p.editorInfo.on("showBlockEditbar",p.showBlockEditbar),p.editorInfo.on(E.c.UPDATE_COMMENTABLE,p.updateCommentable)},this.changesetApply=function(e,t){var n=t.changeset,i=t.editor;if(p._commentable){var r=p.editorInfo.getRep();if(r.selStart&&r.selEnd&&(!t||!t.callstack||"insertComment"!==t.callstack.type)){var o=r.selEnd[0],a=Object(m.f)(p.editorInfo,r,r.zoneId);if(a){var s,c=k.unpack(n);for(s in c){var l=c[s],u=k.opIterator(l.ops);if(!u.hasNext())return;var d,h,f=p._extractSelectionInfo(r).popupType;(u.next().lines<=o||"0"!==r.zoneId)&&(d=p.showCommentTip,h=Object(v.a)(i),p.editorInfo.call("verticalPositionUpdate"),d.call(p,{selection:a,getSelectionInfo:Object(g.a)(b.a,{editor:p.editorInfo}),popupType:f,selectionStatus:h}))}}}}},this.updateCommentable=function(e){p._commentable=e&&p.isCommentable()},this._extractSelectionInfo=function(e){return{popupType:Object(l.a)({rep:e}),isContainedTitleLine:0===e.selStart[0]||0===e.selEnd[0]}},this.checkTablesInSelection=function(e){for(var t=e.selStart[0],n=e.selEnd[0],i=t;i<=n;i++){var r=e.lines.atIndex(i);if(r&&r.getInstanceByName(y.e.ACE_TABLE))return!0}return!1},this.aceSelectionChanged=function(e,t){var n,i,r,o,a,s=t.callstack,c=t.rep,l=t.attribs;"setup"===s.type||"importText"===s.type||"setBaseText"===s.type||s.isCollabChangedSelection||(n=Object(m.f)(p.editorInfo,c,c.zoneId))&&(r=(i=p._extractSelectionInfo(c)).popupType,o=i.isContainedTitleLine,a=Object(v.a)(p.editorInfo,l),p._showCommentAtSelection(n,r,o,a))},this._showCommentAtSelection=function(e,t,n,i){var r=p._commentable,o=p.showCommentTip,a=p.editorInfo,s=!p.editorInfo.commentEnabled,c=!0;"0"!==e.selZone&&(c=!1),r&&o&&o.call(p,{selection:e,getSelectionInfo:Object(g.a)(b.a,{editor:a}),popupType:t,isContainedTitleLine:n,isAllowedComment:s,notAllowedFullScreen:!c,selectionStatus:i})},this.showCommentAtSelection=function(e,t){var n=t.selection,i=t.popupType,r=t.isContainedTitleLine,o=t.selectionStatus;p._showCommentAtSelection(n,i,r,o)},this._handlePopupClick=function(e){p.editorInfo.call("handlePopupCommentClick",e)},this._showCommentTip=function(e){var t=e.selection,n=e.getSelectionInfo,i=e.popupType,r=e.isContainedTitleLine,o=e.isAllowedComment,a=e.notAllowedFullScreen,s=e.selectionStatus;p.editorInfo.selection.isCaret(t)||i===u.d.BLOCK?p._hideCommentTip():(p.editorInfo.call("showCommentPopup",{getPosition:n,onClick:p._handlePopupClick,popupType:i,isContainedTitleLine:r,isAllowedComment:o,notAllowedFullScreen:a,selectionStatus:s}),p.etherpadContainer.off("scroll",p.onScrollThrottle),p.etherpadContainer.on("scroll",p.onScrollThrottle),p._onScroll())},this.showBlockEditbar=function(e){var t,n,i=e.positionInfo,r=e.commands,o=e.rep,a=e.context,s=o.zoneId,c=o.selStart,l=o.selEnd,u=Object(C.n)(p.editorInfo,s);[O.l.CodeBlock,O.l.CalloutBlock].includes(u)||(t=Object(m.f)(p.editorInfo,{selStart:c,selEnd:l},s),n=!p.editorInfo.commentEnabled&&p._commentable,d.a.trigger("showBlockEditbarWithComment",[{positionInfo:i,isAllowedComment:n,commands:r,selection:t,context:a}]))},this.reset=function(){p.editorInfo.off("showBlockEditbar",p.showBlockEditbar),p.editorInfo.off(E.c.UPDATE_COMMENTABLE,p.updateCommentable),p.etherpadContainer.off("scroll",p.onScrollThrottle),p.etherpadContainer=null,p.onScrollThrottle.cancel(),p.onScrollThrottle=null,p.showCommentTip.cancel(),p.showCommentTip=null},t&&this.aceInitialized("",Object.assign({editorInfo:t},t)),this._commentable=i}return a()(r,[{key:"onMount",value:function(){this.updateCommentable(this._commentable)}},{key:"_hideCommentTip",value:function(){this.editorInfo.call("hideCommentPopup")}},{key:"_onScroll",value:function(){var e,t,n,i,r,o,a,s,c,l,u;this.editorInfo&&(t=(e=this.editorInfo.getRep()).selStart[0],!(n=e.lines.atIndex(t))||(i=$(n.lineNode).children().first()[0])&&i.getBoundingClientRect&&(o=(r=i.getBoundingClientRect()).top,a=r.bottom,s=r.height,c=r.width,l=r.left,u=i.offsetTop,this.editorInfo.call("editorbar:updateTargetPosition",{top:o,bottom:a,height:s,left:l,width:c,offsetTop:u})))}},{key:"isCommentable",value:function(){return this.editorInfo.plugins.comment&&Object(h.getUserPermissionCommentable)()}},{key:"pluginReadOnly",value:function(e){this._commentable=this.isCommentable()}},{key:"pluginReadWrite",value:function(){this._commentable=this.isCommentable()}}]),r}()},XDjv:function(e,t,n){"use strict";var i=n("RIqP"),p=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),c=n("ibWA"),g=n("H6oK"),m=n("Xngx"),v=n("uEBw"),b=n("Mvmg"),l=n("jVwk"),u=n("2ACu");function d(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Object(u.default)("block_update_props",Object.assign({block_id:e.blockId,block_type:e.blockType},t))}var O=n("mRaX");n.d(t,"a",function(){return h});var h=function(){function n(e,t){var E=this;o()(this,n),this.insertInSingleLine=function(){var e=E.ace.editorInfo,t=e.getRep();e.inCallStackIfNecessary("insertDriveInSingleLine",function(){e.fastIncorp(),e.performDocumentReplaceRangeWithAttributes(t.zoneId,t.selStart,t.selEnd,"\n")})},this.insertPlaceholder=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.driveKey,i=void 0===n?"none":n,r=t.uploadOwner,o=void 0===r?"":r,a=t.atUuid,s=void 0===a?"":a,c=E.ace,l=E.uuid,u=c.editorInfo,d=u.getRep();if(u.updateBrowserSelectionFromRep(!0),e instanceof File){u.inCallStackIfNecessary("mentionFastIncrop",function(){u.fastIncorp()});var h=d.selStart||[1,0],f=d.selEnd||[1,0],p=d.zoneId||"0",g={};if(s){if(!(g=Object(O.z)(u,s)))return;h=g.selStart,f=g.selEnd,p=g.selZone}var m,v,b=" ",y=!0;h&&f&&(m=E.generateCardAttributes({file:e,uuid:l,driveKey:i,uploadOwner:o,useDriveStorage:y}),u.callWithAce(function(){u.fastIncorp();var e=E.adaptEnterText(m,h,f,p,g);b=e.text;var t=e.ops;u.performDocumentReplaceMultiRangeWithAttributes(p,t)},"insertDriveUploadPlaceholder",!0),v=d.selStart[0]+1,"\n"!==b.slice(-1)&&v<d.lines.length()&&u.inCallStackIfNecessary("insertDrivePerformRepChange",function(){u.performSelectionChange(p,[v,0],[v,0])}))}},this.adaptEnterText=function(n,i,r,e){var t=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},o=E.ace.editorInfo.getReps()[e],a=Object(l.a)(o,null,t);return{text:a,ops:Object(c.b)(a).map(function(e,t){return{start:0===t?i:r,end:r,newText:e,attributes:"\n"===e?[]:n}})}},this.updateFileCard=function(e){var t=e.driveKey,n=void 0===t?"":t,i=e.owner,r=void 0===i?"":i,o=E.ace.editorInfo;o.callWithAce(function(){o.fastIncorp(),E._replaceCard(o,{driveKey:n,owner:r})},"insertFileCardSuccess",!0)},this.updateDriveKey=function(e){E.updateFileCard({driveKey:e})},this.updateFileOwner=function(e){E.updateFileCard({owner:e})},this.generateCardAttributes=function(e){var t=e.file,n=e.uuid,i=e.driveKey,r=e.uploadOwner,o=e.useDriveStorage,a=t.name,s=t.size,c=t.type,l={name:a,type:a.split(".").pop(),actualType:c,size:s,driveKey:i,uploadOwner:r,useDriveStorage:o},u=["m4a"],d=g.ViewTypes.CARD;!Object(v.e)(l.type,s)||Object(m.m)(l.type)||Object(m.k)(l.type)||u.includes(l.type.toLowerCase())||(d=g.ViewTypes.PREVIEW);var h=Object(g.generateBlockDataSet)({blockType:g.BlockType.FILE_CARD_BLOCK,props:{data:{fileId:n,fileInfo:l},viewType:d,version:b.g}}),f=E.ace.editorInfo.plugins.blockPlugin.getAttrsFromBlockDataSet(h);return E.blockId=h.blockId,[["at-holder",0]].concat(p()(f))},this._replaceCard=function(e,t){var n,i,r=t.driveKey,o=void 0===r?"":r,a=t.owner,s=void 0===a?"":a,c=e.plugins.blockPlugin.blockInfos.get(E.blockId);c&&c.instance?(n=c.instance.props.data)&&n.fileInfo?(i=n.fileInfo,o&&(i.driveKey=o),s&&(i.owners||(i.owners={}),i.owners[s]=!0),n.fileInfo=i,c.instance.setProps({data:n}),d(c.instance,{status:"success"})):d(c.instance,{status:"error-fileInfo"}):d(c.instance,{status:"error-instance"})},this.ace=t,this.uuid=e}return s()(n,[{key:"destroy",value:function(){delete this.ace}},{key:"deleteFileCard",value:function(){var n=this,i=this.ace.editorInfo;i.callWithAce(function(){i.fastIncorp();var e=i.plugins.blockPlugin,t=e.getBlockById(n.blockId);t&&e.deleteBlock({block:t})},"deleteDriveFileCard",!0)}}]),n}()},XDkv:function(e,t,n){"use strict";n.d(t,"b",function(){return h}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return g});var i,r,o=n("RIqP"),a=n.n(o),s=n("oTSI"),c=n("Zss7"),l=n.n(c),u=n("Ngi8"),d=["#0077ff"].concat(a()(u.CURSOR_COLOR_PALETTE)),h=(i=new Map,r=0,function(e){var t=i.get(e);if(t)return t;for(var n=["#E94D3D","#E9455A","#E93324"];t=d[r],r=(r+1)%d.length,-1<n.indexOf(t););return i.set(e,t),t}),f=Object(s.a)(function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.3;return l()(e).setAlpha(t).toRgbString()});function p(e){return e.slice(5,-1).split(",").map(parseFloat)}var g=function(e,t,n){for(var i=p(e),r=p(t),o="number"==typeof n?Math.max(0,Math.min(100,n)):50,a=[],s=0;s<4;s++){var c=i[s]+(r[s]-i[s])*o/100;a[s]=3===s?c:Math.round(c)}return"rgba(".concat(a,")")}},XJJA:function(e,I,S){"use strict";(function(e){S.d(I,"e",function(){return c}),S.d(I,"d",function(){return l}),S.d(I,"c",function(){return u}),S.d(I,"g",function(){return h}),S.d(I,"f",function(){return f}),S.d(I,"b",function(){return E}),S.d(I,"a",function(){return C});var t=S("o0o1"),p=S.n(t),n=S("yXPU"),i=S.n(n),g=S("j1lG"),m=S("Tqb2"),r=S("BpSZ"),o=S("gSGL"),a=S("n/R6"),v=S("Z/PY"),b=S("15MJ"),y=S("lQZd"),s=S("kESg");function c(e){return e!==s.l.CodeBlock&&e!==s.l.CalloutBlock}function l(e){return e.size<=g.z}function u(e){return d.apply(this,arguments)}function d(){return(d=i()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof File)return e.abrupt("return",t);e.next=2;break;case 2:if(Object(o.a)(t)&&Object(r.b)(t))return e.next=5,Object(m.b)(t);e.next=6;break;case 5:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(){a.a.show({type:"error",closable:!0,content:e("etherpad.upload_failed_than_size")})}function f(){a.a.show({type:"error",closable:!0,content:e("etherpad.upload_failed")})}function E(e,t){return O.apply(this,arguments)}function O(){return(O=i()(p.a.mark(function e(t,n){var i,r,o,a,s,c,l;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=URL.createObjectURL(n),e.next=3,Object(m.R)(i);case 3:return r=e.sent,o=r.naturalWidth,a=r.naturalHeight,s={uploading:!0,uploadProgress:g.C,intermediateSrc:i},c=Object.assign({uuid:t,height:a.toString(),width:o.toString(),natrualHeight:a.toString(),natrualWidth:o.toString(),image_type:n.type,size:n.size,isLocalAttribs:!0},s),l={items:[c]},e.abrupt("return",JSON.stringify(l));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function C(e,t,n){return k.apply(this,arguments)}function k(){return(k=i()(p.a.mark(function e(t,n,i){var r,o,a,s,c,l,u,d,h,f;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.uuid&&t.fileToken){e.next=3;break}return console.error("[image plugin] generate uploaded attribs fail."),e.abrupt("return",null);case 3:return r=t.uuid,o=t.file,a=t.fileToken,s=URL.createObjectURL(o),e.next=7,Object(m.R)(s);case 7:return c=e.sent,l=c.naturalWidth,u=c.naturalHeight,d=Object(v.i)(a,Object(y.g)()),i&&n.height===g.e.toString()&&n.height===g.f.toString()&&(delete n.width,delete n.height,delete n.currHeight,delete n.currWidth),h=Object.assign({uuid:r,height:u.toString(),width:l.toString(),currHeight:u.toString(),currWidth:l.toString(),natrualHeight:u.toString(),natrualWidth:l.toString(),file_token:a,src:encodeURIComponent(d),image_type:o.type,size:o.size,comments:[],pluginName:b.s,scale:Object(v.m)(l,u)},n),f={items:[h]},e.abrupt("return",JSON.stringify(f));case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}}).call(this,S("2vAP"))},XNb2:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return s});var i=n("J4zp"),o=n.n(i),r=function(e,t){return t?a(e,function(e){return e===t}):null},a=function(e,t){if(t){var n=null,i=e.getMatchedAttributePositionOnSelection(n,t),r=o()(i,1)[0];if(r)return r.docPosition}return null},s=function(e,t){if(t){var n=null,i=function(e){return e===t};return 0<e.getMatchedAttributePositionOnSelection(n,i).length}return!1}},XRg5:function(e,r,o){"use strict";o.r(r),function(u){o.d(r,"DEFAULT_ZOOM_RATIO",function(){return v}),o.d(r,"ZOOM_TWICE_RATIO",function(){return b}),o.d(r,"MODULE_TYPE",function(){return t}),o.d(r,"BLOCK_VIEW_TYPE",function(){return d}),o.d(r,"imageViewerCreator",function(){return n}),o.d(r,"createViewer",function(){return i});o("fFdo");var d,e,h=o("dvZ7"),f=o("2ACu"),p=o("Z/PY"),g=o("Mp37"),m=o("rLED"),v=.15,b=Math.pow(1+v,2)-1,t={DOC_FULLSCREEN:"presentation",DOC_BODY:"mainbody",SHEET:"sheet",MINDNOTE:"mindnote",COMMENT:"comment"};(e=d=d||{}).PICTURE="picture",e.DIAGRAM="diagram";var y={DEFAULT:[[g.TOOLBAR_TYPE.ZOOM_OUT,!0],[g.TOOLBAR_TYPE.ZOOM_IN,!0],[g.TOOLBAR_TYPE.ROTATE_LEFT,!0],[g.TOOLBAR_TYPE.ONE_TO_ONE,!0],[g.TOOLBAR_TYPE.DOWNLOAD,!1]],BLACK:[[g.TOOLBAR_TYPE.PREV,!0],[g.TOOLBAR_TYPE.PAGE_NUM,!0],[g.TOOLBAR_TYPE.NEXT,!0],[g.TOOLBAR_TYPE.SEPARATOR_LINE,!0],[g.TOOLBAR_TYPE.ZOOM_OUT,!0],[g.TOOLBAR_TYPE.RATIO,!0],[g.TOOLBAR_TYPE.ZOOM_IN,!0],[g.TOOLBAR_TYPE.ONE_TO_ONE,!0],[g.TOOLBAR_TYPE.SEPARATOR_LINE,!0],[g.TOOLBAR_TYPE.ROTATE_LEFT,!0]]},n={create:function(e){return i(e.elementsWrapper,e.options,e.evtSource)}};function i(e,s,c){var l=3<arguments.length&&void 0!==arguments[3]?arguments[3]:d.PICTURE,t=Date.now(),n=function(e){var t,n,i=e.actionType,r=e.evtType,o="";s.report&&s.report({actionType:i,evtType:r});var a=r===g.UX_EVENT_TYPE.KEYBOARD?"keydown":r===g.UX_EVENT_TYPE.WHEEL||r===g.UX_EVENT_TYPE.PINCH?"touchpad":"mouseclick";switch(i){case g.UX_ACTION_TYPE.HIDE:t="close",n=r===g.UX_EVENT_TYPE.KEYBOARD?"esc":r===g.UX_EVENT_TYPE.BUTTON_CLICK?"click_icon":"click_bg";break;case g.UX_ACTION_TYPE.NEXT:case g.UX_ACTION_TYPE.PREV:t=i===g.UX_ACTION_TYPE.NEXT?"next_image":"previous_image",n=r===g.UX_EVENT_TYPE.KEYBOARD?"keyboard":"click_icon";break;case g.UX_ACTION_TYPE.ZOOM_IN:case g.UX_ACTION_TYPE.ZOOM_OUT:t=i===g.UX_ACTION_TYPE.ZOOM_IN?"zoom_in":"zoom_out",n=r===g.UX_EVENT_TYPE.KEYBOARD?"keyboard":r===g.UX_EVENT_TYPE.WHEEL?"wheel":r===g.UX_EVENT_TYPE.PINCH?"pinch":"click_icon",o=i===g.UX_ACTION_TYPE.ZOOM_IN?"zoom-in":"zoom-out";break;case g.UX_ACTION_TYPE.ORIGINAL_SIZE:case g.UX_ACTION_TYPE.INITIAL_SIZE:t=i===g.UX_ACTION_TYPE.ORIGINAL_SIZE?"original_size":"initial_size",n=r===g.UX_EVENT_TYPE.CANVAS_DBL_CLICK?"double_click":"click_icon",o=t;break;case g.UX_ACTION_TYPE.MOVE:t="move",n=r===g.UX_EVENT_TYPE.DRAG?"drag":"wheel";break;case g.UX_ACTION_TYPE.FULLSCREEN:case g.UX_ACTION_TYPE.NOT_FULLSCREEN:t=i===g.UX_ACTION_TYPE.FULLSCREEN?"fullscreen":"not_fullscreen",n=r===g.UX_EVENT_TYPE.CANVAS_DBL_CLICK?"double_click":"click_icon",o=t;break;default:return}Object(f.default)("client_block_view",{client_block_view_type:l,client_block_view_subtype:"picture_".concat(t,"_by_").concat(n),client_block_view_source:c}),s.isDrive&&o&&Object(h.f)({action:o,source:"toolbar",eventType:a,subFileType:s.fileType})},i=function(){var e=Date.now();Object(f.default)("client_block_view",{client_block_view_type:l,client_block_view_subtype:"picture_open",client_block_view_source:c,client_block_view_launch_duration:e-t})},r=Object(m.N)("image_viewer_theme","DEFAULT"),o=y[r],a=new g.default(e,Object.assign({minZoomRatio:.1,maxZoomRatio:5,zoomRatio:v,navbar:!1,clearSwitchTransition:!0,theme:r,toolbar:o,i18n:{toolbar_zoom_in:u("image.zoom-in"),toolbar_zoom_out:u("image.zoom-out"),toolbar_one_to_one:u("image.one-to-one"),toolbar_rotate_left:u("viewer.toolbar.rotate"),toolbar_fullscreen:u("viewer.toolbar.fullscreen"),toolbar_exit_fullscreen:u("viewer.toolbar.exitfullscreen"),toolbar_download:u("viewer.toolbar.download"),toolbar_reset:u("image.reset"),toolbar_prev:u("image.prev"),toolbar_next:u("image.next")},rotateRight:!1,keyboard:!0,loop:!1,url:function(e){var t=e.getAttribute("data-src"),n=Object(p.p)(t)&&/\/file\/f\//.test(t)?t.replace(/\/$/,"~noop"):t;return(n||e.src).replace(/"/g,"").replace(/'/g,"")},viewed:function(e){var t=e.detail.image.getBoundingClientRect().width;t&&1===a.imageData.ratio&&window.innerWidth/4>=t&&(a.zoom(b,{evtType:g.UX_EVENT_TYPE.INIT_ZOOM},!0),a.initialImageData.ratio=a.imageData.ratio)},report:n,shown:i},s));return a}}.call(this,o("2vAP"))},XUVG:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),u=n("NFsq"),d=n("HmyT"),h=n("iP/4"),f=n("H6oK"),p=n("2ACu"),s=n("y2sV"),c="client_performance_doc_paste_keydown_to_paint",l=function(){function t(e){var l=this;r()(this,t),this.aceInitialized=function(e,t){l.editorContext=t.editorInfo},this.handlePaste=function(){l.editorContext.profile.start(c)},this.handleDidPaste=function(){l.editorContext.profile.end(c)},this.UNSAFE_editorNormalizePasteNode=function(e){var t,n,i,r,o,a=l.editorContext.getRep(),s=e.data.node,c=e.types;""!==s.innerHTML&&(Object(u.a)(c,"text/html")||h.a.modernIE)&&(s.innerHTML.includes("mubu-node")&&Object(p.collectSuiteEvent)("toggle_attribute",{action:"paste",paste_source:"space_mindnote"}),t=function(e){var n=e;return["table","thead","tbody","tfoot","tr","th","td","caption"].forEach(function(e){var t=new RegExp("<".concat(e,"(\\s.*?)?>(.*?)</").concat(e,">"),"gi");n=n.replace(t,"$2")}),n=n.replace(/<colgroup(\s.*?)?>.*?<\/colgroup>/gi,"")},o=s,Object(d.$)(o).find("table table").filter(function(){return 1===Object(d.$)(this).parents("table").length}).each(function(){var e=Object(d.$)(this);e.replaceWith("<div>".concat(t(e.html()),"</div>"))}),n=function(e){var t=Object(d.$)(e).siblings();return 0===t.length||1===t.length&&t.is("meta")},a.zoneId&&"0"!==a.zoneId&&(n(r=(i=Object(d.$)(s)).find("table"))||r.remove(),i.find("span.block-type-".concat(f.BlockType.SHEET_BLOCK)).closest(".ace-line,blockquote").remove(),i.find("span.block-type-".concat(f.BlockType.BITABLE_BLOCK)).closest(".ace-line,blockquote").remove(),i.find("span.block-type-".concat(f.BlockType.JIRA_FILTER_BLOCK)).closest(".ace-line,blockquote").remove()))},this.editorWillPaste=function(e){var t=e.deltaSet,n=e.zoneId;l.collectPasteInfo(t,n)},this.collectPasteInfo=function(e,t){var r=0,o=0,n={},a=function(e){n[e]=(n[e]||0)+1},s=0;e.get(t).eachLine(function(e,t,n){var i;"heading"in t&&a("paste_heading"),"list"in t&&(i="paste_"+/([a-z]+)([0-9]+)/.exec(t.list)[1],a(i)),"blockquote"in t&&a("paste_blockquote"),"gallery"in t&&a("paste_gallery"),"dataMetaBlockProps"in t&&a("paste_block"),"aceTable"in t&&o++,s=n+1,r+=Object.keys(t).length}),l.editorContext.profile.pushData(c,Object.assign({paste_text_lines:s,paste_attribute_count:r,paste_table_count:o},n))},e&&(this.editorContext=e,this.editorContext.on(s.k.PASTE,this.handlePaste),this.editorContext.on(s.k.DID_PASTE,this.handleDidPaste))}return a()(t,[{key:"destroy",value:function(){this.editorContext.on(s.k.off,this.handlePaste),this.editorContext.off(s.k.DID_PASTE,this.handleDidPaste)}}]),t}();new l},XVMX:function(e,b,y){"use strict";(function(r){y.d(b,"b",function(){return o}),y.d(b,"a",function(){return h}),y.d(b,"d",function(){return p}),y.d(b,"c",function(){return m});var o,e,t=y("o0o1"),a=y.n(t),n=y("yXPU"),i=y.n(n),s=y("q1tI"),c=y.n(s),l=y("n/R6"),u=0;function d(){return u+=1,"toast_".concat(Date.now(),"_").concat(u)}(e=o=o||{})[e.CONFIRMED=0]="CONFIRMED",e[e.CANCELED=1]="CANCELED";var h=8e3,f="";function p(e){return g.apply(this,arguments)}function g(){return(g=i()(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(t){f&&l.a.remove(f),f=d();var e=r("CreationDoc_FeishuDocs_Mention_Notification_Toast",n.join("".concat(r("common.separator"))));l.a.show({key:f,content:c.a.createElement("div",{className:"toast-confirm"},c.a.createElement("p",{className:"toast-text"},e),c.a.createElement("button",{className:"toast-button",onClick:function(e){l.a.remove(f),f="",t(o.CANCELED)}},r("common.undo"))),duration:h,className:"permissionToast",cancelText:r("common.undo"),onClose:function(){return t(o.CONFIRMED)}})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=i()(a.a.mark(function e(i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(t){var n=d(),e=r("permission.invite_confirm",i.join("".concat(r("common.separator"))));l.a.show({key:n,content:c.a.createElement("div",{className:"toast-confirm"},c.a.createElement("p",{className:"toast-text"},e),c.a.createElement("button",{className:"toast-button",onClick:function(e){l.a.remove(n),t(o.CONFIRMED)}},r("common.confirm"))),duration:h,className:"permissionToast",onClose:function(){return t(o.CANCELED)}})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}}).call(this,y("2vAP"))},"Xd/R":function(e,E,O){"use strict";(function(s){O.d(E,"a",function(){return y});var e=O("lwsE"),n=O.n(e),t=O("W8MJ"),i=O.n(t),r=O("a1gu"),o=O.n(r),a=O("Nsbk"),c=O.n(a),l=O("7W2i"),u=O.n(l),d=O("q1tI"),h=O.n(d),f=O("ybRk"),p=O("UlbS"),g=O("P438"),m=O("zrMW"),v=O("yN2k"),b=(O("t73A"),"connect-dialog"),y=function(e){function t(){return n()(this,t),o()(this,c()(t).apply(this,arguments))}return u()(t,e),i()(t,[{key:"renderIcon",value:function(){var e=this.props,t=e.connectStatus,n=e.logoIcon,i=(t===g.a.CONNECT_FAIL?v:m).a;return h.a.createElement("div",{className:"".concat(b,"__body__icon")},n,h.a.createElement(i,{className:"connect_status_icon"}),h.a.createElement("span",{className:"logo_icon"}))}},{key:"renderContent",value:function(){var e=this.props,t=e.connectStatus,n=e.onReconnect,i=e.onCancelConnect,r=e.connectFailText,o=e.connectingText,a=h.a.createElement(p.Button,{className:"connect_btn",onClick:i},s("doc.common.cancel_connection"));return h.a.createElement(d.Fragment,null,this.renderIcon(),t===g.a.CONNECT_FAIL?h.a.createElement(d.Fragment,null,h.a.createElement("div",{className:"".concat(b,"__body__fail")},r),a,h.a.createElement(p.Button,{type:"primary",className:"connect_btn",onClick:n},s("doc.common.re_auth"))):h.a.createElement(d.Fragment,null,h.a.createElement("div",{className:"".concat(b,"__body__connecting")},o),a))}},{key:"render",value:function(){var e=t.DIALOG_WIDTH;return h.a.createElement("div",{className:"".concat(b,"__container")},h.a.createElement(f.a,{visible:!0,width:e,zIndex:2063,bodyClassName:"".concat(b,"__body"),closeClassName:"".concat(b,"__close-icon"),center:!0,title:null,footer:null,onClose:this.props.onCancelConnect},this.renderContent()))}}]),t}(h.a.Component);y.DIALOG_WIDTH=480}).call(this,O("2vAP"))},XjP5:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 16 16"},t),c.a.createElement("g",{transform:"translate(-29 -4)",fill:"none",fillRule:"evenodd"},c.a.createElement("rect",{stroke:"#E3E5EA",x:".5",y:".5",width:"73",height:"23",rx:"4"}),c.a.createElement("path",{d:"M0 0h16v16H0z"}),c.a.createElement("path",{d:"M37 6a6 6 0 110 12 6 6 0 010-12zm3.07 3.8a.35.35 0 00-.5 0l-3.3 3.3-1.71-1.73a.35.35 0 00-.5 0l-.33.33a.35.35 0 000 .5l1.92 1.94.03.04.34.34c.13.14.35.14.49 0l3.89-3.89a.35.35 0 000-.5z",fill:"#8F959E"})))}},XmSq:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n("VkAN"),g=n.n(p),m=n("vOnD"),v=n("MjSh");function b(){var e=g()(["\n  animation: "," 1.2s linear infinite;\n\n  & > circle {\n    stroke-dasharray: 1, 200;\n    stroke-dashoffset: 0;\n    animation: "," 1.5s ease-in-out infinite;\n    stroke: ",";\n    stroke-linecap: round;\n  }\n"]);return b=function(){return e},e}function y(){var e=g()(["\n  display: flex;\n  flex: 1;\n  align-items: center;\n  justify-content: center;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n"]);return y=function(){return e},e}function E(){var e=g()(["\n  0% {\n    stroke-dasharray: 1, 200;\n    stroke-dashoffset: 0;\n  }\n  50% {\n    stroke-dasharray: 89, 200;\n    stroke-dashoffset: -35px;\n  }\n  100% {\n    stroke-dasharray: 89, 200;\n    stroke-dashoffset: -124px;\n  }\n"]);return E=function(){return e},e}function O(){var e=g()(["\n  100% {\n    transform: rotate(360deg);\n  }\n"]);return O=function(){return e},e}var C=Object(m.keyframes)(O()),k=Object(m.keyframes)(E()),I=m.default.div(y()),S=m.default.svg.attrs({viewBox:"25 25 50 50",width:50,height:50})(b(),C,k,v.B500),T=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return h()(t,e),a()(t,[{key:"render",value:function(){return f.createElement(I,null,f.createElement(S,null,f.createElement("circle",{cx:"50",cy:"50",r:"20",fill:"none",strokeWidth:"4",strokeMiterlimit:"10"})))}}]),t}(f.PureComponent),_=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return h()(t,e),a()(t,[{key:"render",value:function(){return f.createElement(S,{className:this.props.className},f.createElement("circle",{cx:"50",cy:"50",r:"20",fill:"none",strokeWidth:"4",strokeMiterlimit:"10"}))}}]),t}(f.PureComponent);n.d(t,"a",function(){return _});t.b=T},Xngx:function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),o=n("yIs4"),a=n("F2y5"),s=n("BmhO"),c=n("VIFs"),l=n("kUgE"),u=n("EVj1"),d=n("5ydi"),h=n("y94N"),f=n("VQSS"),p=n("JC8k");function g(e){var t=e.fileToken,n=e.mountPoint,i=e.version,r=Object(c.prependDriveStreamAPI)("/api/box/stream/download/all/".concat(t,"/")),o=Object(f.a)({mount_node_token:n&&n.token,mount_point:n&&n.type,version:i});return r+Object(u.d)(o)}function m(e){var t=e.fileToken,n=e.mountPoint,i=e.coverOptions,r=Object(c.prependAPI)("/api/box/stream/download/v2/cover/".concat(t,"/")),o=Object(f.a)({mount_node_token:n&&n.token,mount_point:n&&n.type,width:i&&i.width,height:i&&i.height,policy:i&&i.policy,shape:i&&i.shape});return r+Object(u.d)(o)}function v(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;if(!Object(o.default)(e))return"";var n=e;return n<1024?"".concat(Math.round(n)," B"):(n/=1024)<1024?"".concat(n.toFixed(t)," KB"):(n/=1024)<1024?"".concat(n.toFixed(t)," MB"):(n/=1024)<1024?"".concat(n.toFixed(t)," GB"):"".concat((n/=1024).toFixed(t)," TB")}function b(e){var t=Object(p.a)(e),n={image:r()(s.C),video:r()(s.D),audio:r()(s.E),txt:r()(s.F),word:r()(s.G),excel:r()(s.B),ppt:r()(s.H),code:r()(s.A)};return Object.keys(n).find(function(e){return n[e].includes(t)})||t}function y(e){return s.w.includes(e.toLowerCase())}function E(e){return s.x.includes(e.toLowerCase())}function O(e){return s.u.includes(e.toLowerCase())}function C(e){return s.J.includes(e.toLowerCase())}var k=function(e){return Array.isArray(e)?e.map(function(e){switch(e&&e.type){case d.e.NewVersion:return new d.b(e);case d.e.RenameFile:return new d.c(e);case d.e.DeleteVersion:return new d.a(e);case d.e.RestoreVersion:return new d.d(e);default:return null}}).filter(function(e){return e}):[]},I=function(e,t){var n=e.map(function(e){return e.get("version")});return t.filter(function(e){return e&&!n.includes(e.get("version"))})};function S(e){return"number"!=typeof e||e<1e4?e:"zh"===Object(l.getLanguage)()?"".concat(Object(a.a)(e/1e4,1),""):"".concat(Object(a.a)(e/1e3,1),"K")}function T(e){if(!e.render_config)return{};try{var t=e.render_config;return"string"==typeof e.render_config&&(t=JSON.parse(e.render_config)),{"--top-border-bg-color":t&&t.show_top_border?t.top_border_color:"transparent"}}catch(e){return{}}}function _(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=Object(p.a)(e);return s.C.includes(t)?s.C:s.D.includes(t)?s.D:s.E.includes(t)?s.E:s.G.includes(t)?s.G:s.B.includes(t)?s.B:s.H.includes(t)?s.H:t===s.s.PDF?[s.s.PDF]:void 0}function w(e){return s.C.includes(e)?h.d.IMAGE:h.d.FILE}n.d(t,"d",function(){return p.a}),n.d(t,"f",function(){return p.b}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return m}),n.d(t,"g",function(){return v}),n.d(t,"e",function(){return b}),n.d(t,"n",function(){return y}),n.d(t,"l",function(){return E}),n.d(t,"m",function(){return O}),n.d(t,"k",function(){return C}),n.d(t,"o",function(){return k}),n.d(t,"p",function(){return I}),n.d(t,"a",function(){return S}),n.d(t,"i",function(){return T}),n.d(t,"j",function(){return _}),n.d(t,"h",function(){return w})},XsFf:function(e,t,n){"use strict";var i=n("o0o1"),o=n.n(i),r=n("J4zp"),a=n.n(r),s=n("lwsE"),c=n.n(s),l=n("W8MJ"),u=n.n(l),d=n("yXPU"),h=n.n(d),f=n("cDf5"),p=n.n(f),g=n("BeL+"),m=n("Z0Cl"),v=n("ZBlo"),b=n("toa8"),y=n("H6oK"),E=n("4PSP"),O=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},C=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];c()(this,t),this.array=[],this.maxSize=0,this.array=e}return u()(t,[{key:"setMaxSize",value:function(e){this.maxSize=e}},{key:"length",value:function(){return this.array.length}},{key:"add",value:function(e){var t=this.findIndex(e.id);-1<t?this.array.splice(t,1,e):(0<this.maxSize&&this.array.length===this.maxSize&&this.pop(),this.array.push(e))}},{key:"delete",value:function(e){var t=this.findIndex(e);-1!==t&&this.array.splice(t,1)}},{key:"pop",value:function(){return this.array.shift()}},{key:"findIndex",value:function(t){return this.array.findIndex(function(e){return e.id===t})}},{key:"latest",value:function(){return this.array[this.length()-1]}},{key:"toJSON",value:function(){return this.array}},{key:"clear",value:function(){this.array=[]}},{key:"isPendding",get:function(){return 0===this.maxSize||this.array.length<this.maxSize}}]),t}(),k=function(){function i(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;c()(this,i),this.workerFn=t,this.maxOccurs=n,this.waitQueue=e,this.workerQueue=new C,this.workerQueue.setMaxSize(n),this.pause=!1,this.workerResult=[],this.workerRqs=[]}return u()(i,[{key:"setCallback",value:function(e,t){this.onSuccess=e,this.onFail=t}},{key:"setWorker",value:function(e){this.workerFn=e}},{key:"appendWaitQueue",value:function(e){var t=this;e.forEach(function(e){t.waitQueue.add(e)})}},{key:"start",value:function(){var t=this;return this.workerResult=[],this.workerRqs=[],new Promise(function(e){t.resolveQueue=e,0===t.waitQueue.length()&&t.resolveQueue([]),t.work()})}},{key:"stop",value:function(){this.pause=!0}},{key:"clearWait",value:function(){this.waitQueue.clear()}},{key:"continue",value:function(){this.pause=!1,this.work()}},{key:"clear",value:function(){this.pause=!1,this.cancel(),this.waitQueue.clear(),this.workerQueue.clear(),this.workerRqs=[]}},{key:"cancel",value:function(){this.workerRqs.forEach(function(e){var t=e.abort||e.cancel;t&&"function"==typeof t&&t()}),this.workerRqs=[]}},{key:"work",value:function(){for(var e=Math.min(this.waitQueue.length(),this.maxOccurs-this.workerQueue.length()),t=0;t<e;t++)this.addQueue()}},{key:"checkQueuePending",value:function(){return this.workerQueue.isPendding}},{key:"checkWaitQueueEmpty",value:function(){return 0===this.waitQueue.length()}},{key:"addQueue",value:function(){var e;this.pause||!this.checkQueuePending()||(e=this.waitQueue.pop())&&(this.workerQueue.add(e),this.worker())}},{key:"worker",value:function(){var n,e,t,i,r=this;this.pause||(n=this.workerQueue.latest(),e=n.id,t=n.data,i=this.workerFn(t),this.workerRqs.push(i),i.then(function(e){var t={payload:n,response:e};r.workerResult.push(t),r.onSuccess&&r.onSuccess(t)}).catch(function(e){var t={payload:n,response:e};r.workerResult.push(t),r.onFail&&r.onFail(t)}).finally(function(){r.removeWorkerQueue(e),r.queueEmpty()&&r.resolveQueue?r.resolveQueue(r.workerResult):r.pause||r.addQueue()}))}},{key:"removeWorkerQueue",value:function(e){this.workerQueue.delete(e)}},{key:"checkWorkerQueueEmpty",value:function(){return 0===this.workerQueue.length()}},{key:"queueEmpty",value:function(){return this.checkWaitQueueEmpty()&&this.checkWorkerQueueEmpty()}}]),i}();O([Object(E.Bind)()],k.prototype,"clear",null);var I=n("HIeq"),S=n("jp/M"),T=n("AiBH");n.d(t,"a",function(){return L}),n.d(t,"b",function(){return R});var _,w=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},j=5,M=50;function L(){return _=_||new x}function R(n,i,r){var o=L();return new Promise(function(e,t){o.resCacheMap.has(n)?e(o.resCacheMap.get(n)):(o.fetchingSet.has(n)||o.appendWaitQueue([n],i,r),o.addDetachMap(n,{resolve:e,reject:t}))})}function N(e,t,n){return D.apply(this,arguments)}function D(){return(D=h()(o.a.mark(function e(t,n,i){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.d.post(S.apiUrls.POST_FETCH_USER_DETAIL,{mentioned_users:t,source:n,token:i},{headers:{"Content-Type":"application/json"}});case 3:return r=e.sent,e.abrupt("return",r.data.entities);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",Promise.reject(new Error("pull users Error ".concat(e.t0.code,": ").concat(e.t0.msg))));case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}var x=function(){function e(){c()(this,e),this.resCacheMap=new Map,this.detachMap=new Map,this.userQueue=null,this.fetchingSet=new Set,this.throttleWaitUserIds=[],this.userQueue=new k(new C,this.fetchUsers,j),this.userQueue.setCallback(this.fetchUsersSuccess,this.fetchUsersFail),this.userQueue.start()}return u()(e,[{key:"fetchUsersToQueue",value:function(e,t,n){var i=this,r=Object(m.a)(Object(g.a)(e),function(e){return!i.resCacheMap.has(e)&&!i.fetchingSet.has(e)});this.appendWaitQueue(r,t,n)}},{key:"fetchEditorUsers",value:function(e,t){var n=T.z.DOC,i=this.collectEditorUsers(e);this.fetchUsersToQueue(i,n,t)}},{key:"collectEditorUsers",value:function(e){var n="dataMetaBlockProps",t=function(e,t){return Boolean(e===n&&JSON.parse(t).blockType===y.BlockType.AT_USER_BLOCK)};return e.getMatchedAttributePositionOnSelection(null,t,{shouldMerge:!1}).map(function(e){try{return JSON.parse(e.attrValue).props.data.user.id}catch(e){return{}}})}},{key:"pause",value:function(){this.userQueue&&this.userQueue.clear(),this.fetchingSet.clear()}},{key:"fetchUsers",value:function(e){var t=this,n=a()(e,3),i=n[0],r=n[1],o=n[2];return i.forEach(function(e){return t.fetchingSet.add(e)}),N(i,r,o)}},{key:"fetchUsersFinally",value:function(t,n){var i=this;Object.keys(t).forEach(function(e){i.detachMap.has(e)&&n(e,t[e]),i.fetchingSet.delete(e),i.detachMap.delete(e)})}},{key:"resolve",value:function(e,t){this.detachMap.get(e).forEach(function(e){e.resolve(t)}),this.resCacheMap.set(e,t)}},{key:"reject",value:function(e,t){this.detachMap.get(e).forEach(function(e){e.reject(t)})}},{key:"fetchUsersSuccess",value:function(e){var t=e.response;this.fetchUsersFinally(t,this.resolve)}},{key:"fetchUsersFail",value:function(e){var t=e.response;this.fetchUsersFinally(t,this.reject)}},{key:"appendWaitQueue",value:function(e,t,n){this.userQueue&&(this.userQueue.appendWaitQueue(Object(v.a)(e,M).map(function(e){return{id:Object(I.b)(),data:[e,t,n]}})),this.userQueue.continue())}},{key:"addDetachMap",value:function(e,t){var n,i=t.resolve,r=t.reject;this.detachMap.has(e)?(n=this.detachMap.get(e),this.detachMap.set(e,n.concat([{resolve:i,reject:r}]))):this.detachMap.set(e,[{resolve:i,reject:r}])}}]),e}();w([Object(E.Bind)()],x.prototype,"pause",null),w([Object(E.Bind)()],x.prototype,"fetchUsers",null),w([Object(E.Bind)()],x.prototype,"resolve",null),w([Object(E.Bind)()],x.prototype,"reject",null),w([Object(E.Bind)()],x.prototype,"fetchUsersSuccess",null),w([Object(E.Bind)()],x.prototype,"fetchUsersFail",null)},"Y++A":function(e,t,O){"use strict";O.d(t,"b",function(){return T}),O.d(t,"a",function(){return s});var n=O("o0o1"),C=O.n(n),i=O("yXPU"),k=O.n(i),r=O("lwsE"),I=O.n(r),o=O("W8MJ"),S=O.n(o),a="source_file_type";function T(e){if(e)try{var t=e[a];return JSON.parse(t)}catch(e){return!1}return!1}var s=function(){function e(){I()(this,e),this.renderQueue=[],this.updateTime=Date.now()}function t(e,t,n){return i.apply(this,arguments)}var i,n,r,o,a,s,c,l,u,d;function h(){return n.apply(this,arguments)}function f(e,t,n){return r.apply(this,arguments)}function p(e){return o.apply(this,arguments)}function g(e,t){return a.apply(this,arguments)}function m(e){return s.apply(this,arguments)}function v(e){return c.apply(this,arguments)}function b(){return l.apply(this,arguments)}function y(){return u.apply(this,arguments)}function E(){return d.apply(this,arguments)}return S()(e,[{key:"loadMindnoteModule",value:(d=k()(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.mindnoteModule,e.t0){e.next=5;break}return e.next=4,Promise.all([O.e("doc_index_css"),O.e("commons--PCDocSheetBridge--bear-bitable-external--bear-external--bear-sheet-external--btn_groups--d--dba25785"),O.e("commons--PCDocSheetBridge--bear-bitable-external--bear-sheet-external--btn_groups--create-by-templa--5eb3c3ae"),O.e("commons--box_message--mindnote-block"),O.e("vendors--mindnote-block"),O.e("mindnote-block")]).then(O.bind(null,"HvRN"));case 4:e.t0=e.sent;case 5:return this.mindnoteModule=e.t0,e.abrupt("return",this.mindnoteModule.EmbeddedMindnoteManager);case 7:case"end":return e.stop()}},e,this)})),E)},{key:"loadMindnoteManager",value:(u=k()(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadMindnoteModule();case 2:return t=e.sent,this.mindnoteManager=this.mindnoteManager||new t,e.abrupt("return",this.mindnoteManager);case 5:case"end":return e.stop()}},e,this)})),y)},{key:"checkManagerReady",value:(l=k()(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadMindnoteManager();case 2:return e.abrupt("return",!!e.sent);case 3:case"end":return e.stop()}},e,this)})),b)},{key:"pushIntoQueue",value:(c=k()(C.a.mark(function e(n){var i=this;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){i.renderQueue.push({options:n,resolve:e,reject:t}),0<i.renderQueue.length&&setTimeout(function(){i.launchMindnote()},0)}));case 1:case"end":return e.stop()}},e)})),v)},{key:"launchMindnote",value:function(){var e=this,t=this.renderQueue.shift();t&&(this.checkManagerReady()?(this.mindnoteManager.mountMindnote(t),0<this.renderQueue.length&&this.launchMindnote()):setTimeout(function(){t&&e.renderQueue.unshift(t)},100))}},{key:"mountMindnote",value:(s=k()(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.sent)return e.next=5,this.pushIntoQueue(t);e.next=5;break;case 5:case"end":return e.stop()}},e,this)})),m)},{key:"unmount",value:function(e,t){this.mindnoteManager&&this.mindnoteManager.unmount(e,t)}},{key:"updateMindnoteSelectionState",value:(a=k()(C.a.mark(function e(t,n){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(!e.sent){e.next=4;break}this.mindnoteManager.updateMindnoteSelection(t,n);case 4:case"end":return e.stop()}},e,this)})),g)},{key:"handleCopy",value:function(e){if(this.mindnoteManager)return this.mindnoteManager.copyHandler(e)}},{key:"takeScreenShot",value:(o=k()(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(e.sent)return e.abrupt("return",this.mindnoteManager.takeScreenShot(t));e.next=4;break;case 4:case"end":return e.stop()}},e,this)})),p)},{key:"currentScreenShot",value:function(e){if(this.mindnoteManager)return this.mindnoteManager.currentScreenShot(e)}},{key:"setShowBlockEditbar",value:(r=k()(C.a.mark(function e(t,n,i){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(!e.sent){e.next=4;break}this.mindnoteManager.setShowBlockEditbar(t,n,i);case 4:case"end":return e.stop()}},e,this)})),f)},{key:"destroy",value:(n=k()(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(!e.sent){e.next=4;break}this.mindnoteManager.destroy();case 4:console.log("destroy");case 5:case"end":return e.stop()}},e,this)})),h)},{key:"getBlockIdFromExtra",value:function(e,t){var n=T(e);if(!n||!n.blockId)return null;var i=n.blockId;return t.plugins.blockPlugin.getBlockById(i)?i:null}},{key:"hightlightMention",value:(i=k()(C.a.mark(function e(t,n,i){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkManagerReady();case 2:if(!e.sent){e.next=9;break}if(r=this.getBlockIdFromExtra(n,i))return e.abrupt("return",this.mindnoteManager.hightlightMention(r,t));e.next=8;break;case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}},e,this)})),t)},{key:"getAllMentionList",value:function(){return this.mindnoteManager?this.mindnoteManager.getAllMentionList():[]}},{key:"setWidth",value:function(){console.log("setWidth")}},{key:"setDocWidth",value:function(){console.log("setDocWidth")}},{key:"setMaxWidth",value:function(){console.log("setMaxWidth")}},{key:"enterTranslateMode",value:function(){console.log("enterTranslateMode")}},{key:"exitTranslateMode",value:function(){console.log("exitTranslateMode")}}]),e}()},"YH+F":function(e,t,n){"use strict";function i(e,t){return!!e[t]||Object.keys(e).some(function(e){return-1<e.indexOf(t)})}t.a=i},YL5g:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("q1tI"),r=n("XmSq");function o(e){if(e.error)throw console.error("react loadable error",e.error),e.error;return i.createElement("div",{className:"layout-column layout-main-cross-center flex"},i.createElement(r.b,null))}},YO6O:function(e,t,n){"use strict";n.r(t);var i=n("QILm"),o=n.n(i),r=n("lwsE"),a=n.n(r),s=n("W8MJ"),c=n.n(s),l=n("a1gu"),u=n.n(l),d=n("Nsbk"),h=n.n(d),f=n("7W2i"),p=n.n(f),g=n("q1tI"),m=n.n(g),v=n("Si88"),b=n.n(v),y=n("VI6H"),E=n("D0c4"),O=n("pVnL"),C=n.n(O),k=n("PJYZ"),I=n.n(k),S=n("Bw5p"),T=n("i8i4"),_=n.n(T);n("17x9");function w(e,t,n,i){var r=_.a.unstable_batchedUpdates?function(e){_.a.unstable_batchedUpdates(n,e)}:n;return e.addEventListener(t,r,i),{cancel:function(){e.removeEventListener(t,r,i)}}}function j(e,t){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}var M=n("EB6M"),L=n("lSNA"),R=n.n(L),N=n("TSYQ"),D=n.n(N),x=n("UXvI"),P=n("Muja"),B=n("kaUV");function U(e){return null!=e&&e===e.window}var z=function(e){function r(){var e,s;a()(this,r);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(s=u()(this,(e=h()(r)).call.apply(e,[this].concat(n)))).observer=null,s.prevHeight=0,s.forceAlign=function(){var e=s.props,t=e.target,n=e.align,i=e.disabled,r=e.onAlign;if(!i){var o=Object(T.findDOMNode)(I()(s));if(!o)return console.error("Align Component findDOMNode return null");var a=Object(B.c)(o,t,n);r&&r(o,t,a)}},s}return p()(r,e),c()(r,[{key:"componentDidMount",value:function(){this.forceAlign(),!this.props.disabled&&this.props.observe&&this.startMutationObserver(),!this.props.disabled&&this.props.monitorWindowResize&&this.startMonitorWindowResize()}},{key:"componentDidUpdate",value:function(e){var t,n,i=!1,r=this.props;r.disabled||(e.disabled||!Object(P.default)(e.align,r.align)?i=!0:(t=e.target,n=r.target,U(t)&&U(n)?i=!1:t!==n&&(i=!0))),i&&this.forceAlign(),r.monitorWindowResize&&!r.disabled?this.startMonitorWindowResize():this.stopMonitorWindowResize(),r.observe&&!r.disabled?this.startMutationObserver():this.stopMutationObserve()}},{key:"componentWillUnmount",value:function(){this.stopMonitorWindowResize(),this.stopMutationObserve()}},{key:"startMonitorWindowResize",value:function(){this.resizeHandler||(this.bufferMonitor=Object(x.default)(this.forceAlign,this.props.monitorBufferTime),this.resizeHandler=w(window,"resize",this.bufferMonitor))}},{key:"stopMonitorWindowResize",value:function(){this.resizeHandler&&(this.bufferMonitor.cancel(),this.resizeHandler.cancel(),this.resizeHandler=null)}},{key:"startMutationObserver",value:function(){var t,e,n,i=this;this.observer||(t=Object(T.findDOMNode)(this),e={attribute:!0,childList:!0,subtree:!0},n=function(){var e;!t||(e=t.offsetHeight)!==i.prevHeight&&(i.prevHeight=e,i.forceAlign())},this.observer=new MutationObserver(n),this.observer.observe(t,e))}},{key:"stopMutationObserve",value:function(){this.observer&&this.observer.disconnect(),this.observer=null}},{key:"render",value:function(){return g.Children.only(this.props.children)}}]),r}(g.Component);z.defaultProps={target:window,monitorBufferTime:50,monitorWindowResize:!0,observe:!0};var H=z,F=function(e){function o(){var e,t;a()(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=u()(this,(e=h()(o)).call.apply(e,[this].concat(i)))).setAlign=function(e){t.align=e},t.setPopupInner=function(e){t.popupInner=e},t.forceAlign=function(){t.align&&t.align.forceAlign()},t}return p()(o,e),c()(o,[{key:"getPopupElement",value:function(){var e=this.props,t=e.prefixCls,n=e.className,i=e.style,r=e.children,o=e.visible,a=e.destroyOnHide,s=e.placement,c=e.zIndex,l=e.align,u=e.target,d=e.onMouseEnter,h=e.onMouseLeave,f=e.onAlign;if(a&&!o)return null;var p=D()(t,"".concat(t,"_").concat(s),n,R()({},"".concat(t,"_hidden"),!o));return m.a.createElement(H,{ref:this.setAlign,target:u,align:l,disabled:!o,onAlign:f},m.a.createElement("div",{ref:this.setPopupInner,className:p,onMouseEnter:d,onMouseLeave:h,style:Object.assign({},i,{zIndex:c})},m.a.createElement(M.b,{visible:o},r)))}},{key:"getMaskElement",value:function(){var e=this.props,t=e.prefixCls,n=e.mask,i=e.visible,r=e.zIndex,o=D()("".concat(t,"__mask"),R()({},"".concat(t,"__mask_hidden"),!i));return n&&m.a.createElement(M.b,{visible:i},m.a.createElement("div",{className:o,style:{zIndex:r}}))}},{key:"render",value:function(){return m.a.createElement("div",null,this.getMaskElement(),this.getPopupElement())}}]),o}(g.Component),V={adjustX:!0,adjustY:!0,alwaysByViewport:!0},W=[0,0],K={l:{points:["cr","cl"],overflow:V,offset:[0,0],targetOffset:[10,0],useCssRight:!0},r:{points:["cl","cr"],overflow:V,offset:[0,0],targetOffset:[10,0]},t:{points:["bc","tc"],overflow:V,offset:[0,0],targetOffset:[0,7],useCssBottom:!0},b:{points:["tc","bc"],overflow:V,offset:[0,0],targetOffset:[0,7]},tl:{points:["bl","tl"],overflow:V,offset:[0,0],targetOffset:W},lt:{points:["tr","tl"],overflow:V,offset:[0,0],targetOffset:W},tr:{points:["br","tr"],overflow:V,offset:[0,0],targetOffset:W},rt:{points:["tl","tr"],overflow:V,offset:[0,0],targetOffset:W},bt:{points:["tr","br"],overflow:V,offset:[0,0],targetOffset:W},rb:{points:["bl","br"],overflow:V,offset:[0,0],targetOffset:W},bl:{points:["tl","bl"],overflow:V,offset:[0,0],targetOffset:W},lb:{points:["br","bl"],overflow:V,offset:[0,0],targetOffset:W}},Z=["onClick","onMouseEnter","onMouseLeave","onFocus","onBlur"],q=function(e){function t(e){var r;return a()(this,t),(r=u()(this,h()(t).call(this,e))).setTrigger=function(e){r.trigger=e},r.setContainerRender=function(e){r.containerRender=e},r.handleDocumentClick=function(e){var t;r.props.mask&&!r.props.maskClosable||(j(_.a.findDOMNode(I()(r)),t=e.target)||j(r.containerRender.component.popupInner,t)||r.setPopupVisible(!1))},r.handlePopupMouseEnter=function(e){r.clearDelayTimer()},r.handlePopupMouseLeave=function(e){e.relatedTarget&&r.trigger&&j(r.trigger,e.relatedTarget)||r.delaySetPopupVisible(!1,r.mouseLeaveDelay)},r.getPopup=function(){var e=I()(r).props,t={};r.isMouseEnterToShow()&&(t.onMouseEnter=r.handlePopupMouseEnter),r.isMouseLeaveToHide()&&(t.onMouseEnter=r.handlePopupMouseEnter,t.onMouseLeave=r.handlePopupMouseLeave);var n=Object(S.a)(e,["prefixCls","className","style","visible","placement","destroyOnHide","mask","zIndex","onAlign"]),i=Object.assign({},K[e.placement],{},e.align);return m.a.createElement(F,C()({},t,n,{target:_.a.findDOMNode(I()(r)),align:i,visible:r.state.visible}),r.props.popup)},r.handleClick=function(e){if(r.onClick(e),r.focusTime){if(Math.abs(Date.now()-r.focusTime)<20)return;r.focusTime=0}var t=!r.state.visible;(r.isClickToHide()&&!t||r.isClickToShow()&&t)&&r.setPopupVisible(t)},r.handleMouseEnter=function(e){r.onMouseEnter(e),r.delaySetPopupVisible(!0,r.props.mouseEnterDelay)},r.handleMouseLeave=function(e){r.onMouseLeave(e),r.delaySetPopupVisible(!1,r.props.mouseLeaveDelay)},r.handleFocus=function(e){r.onFocus(e),r.clearDelayTimer(),r.isFocusToShow()&&(r.focusTime=Date.now(),r.delaySetPopupVisible(!0,r.props.focusDelay))},r.handleBlur=function(e){r.onBlur(e),r.clearDelayTimer(),r.isBlurToHide()&&r.delaySetPopupVisible(!1,r.props.blurDelay)},r.state={visible:!!e.visible},Z.forEach(function(t){r[t]=function(e){return r.fireEvents(t,e)}}),r}return p()(t,e),c()(t,[{key:"componentDidMount",value:function(){this.componentDidUpdate({},{visible:this.state.visible})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){"visible"in e&&this.setState({visible:e.visible})}},{key:"componentDidUpdate",value:function(e,n){var i=this;this.containerRender.renderComponent(null,function(){var e,t=i.state;n.visible===t.visible||(e=i.props.afterPopupVisibleChange)&&e(t.visible)}),this.state.visible?!this.clickOutsideHandler&&this.isClickToHide()&&(this.clickOutsideHandler=w(document,"click",this.handleDocumentClick)):this.clearOutsideHandler()}},{key:"componentWillUnmount",value:function(){this.clearDelayTimer(),this.clearOutsideHandler()}},{key:"isClickToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")}},{key:"isClickToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")}},{key:"isMouseEnterToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseEnter")}},{key:"isMouseLeaveToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseLeave")}},{key:"isFocusToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("focus")}},{key:"isBlurToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("blur")}},{key:"setPopupVisible",value:function(e){var t;this.clearDelayTimer(),this.state.visible!==e&&("visible"in this.props||this.setState({visible:e}),(t=this.props.onVisibleChange)&&t(e))}},{key:"delaySetPopupVisible",value:function(e,t){var n=this;this.clearDelayTimer(),t?this.delayTimer=setTimeout(function(){return n.setPopupVisible(e)},t):this.setPopupVisible(e)}},{key:"clearDelayTimer",value:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)}},{key:"fireEvents",value:function(e,t){var n=this.props.children.props[e];n&&n(t);var i=this.props[e];i&&i(t)}},{key:"clearOutsideHandler",value:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.cancel(),this.clickOutsideHandler=null)}},{key:"render",value:function(){var e={ref:this.setTrigger},t=g.Children.only(this.props.children);return e.onClick=this.isClickToShow()||this.isClickToHide()?this.handleClick:this.onClick,e.onMouseEnter=this.isMouseEnterToShow()?this.handleMouseEnter:this.onMouseEnter,e.onMouseLeave=this.isMouseLeaveToHide()?this.handleMouseLeave:this.onMouseLeave,this.isFocusToShow()||this.isBlurToHide()?(e.onFocus=this.handleFocus,e.onBlur=this.handleBlur):(e.onFocus=this.onFocus,e.onBlur=this.onBlur),m.a.createElement(M.a,{ref:this.setContainerRender,autoMount:!1,visible:this.state.visible,getComponent:this.getPopup,getContainer:this.props.getContainer},Object(g.cloneElement)(t,e))}}]),t}(g.Component);q.defaultProps={action:[],showAction:[],hideAction:[],mask:!1,maskClosable:!0,mouseEnterDelay:0,mouseLeaveDelay:100,focusDelay:0,blurDelay:150,getContainer:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.left=0,e.style.top=0,e.style.width=0,e.style.height=0,document.body.appendChild(e),e}};var Y=q,J=n("I4N/"),Q=n("2ACu"),X=n("iP/4");n("p/xT"),n("xD9Q"),n("BzeS");n.d(t,"default",function(){return $});var $=function(e){function t(e){var r;return a()(this,t),(r=u()(this,h()(t).call(this,e))).getPopup=function(){var e=r.props,t=e.token,n=e.source,i=e.grantViewAccessDisabled;return m.a.createElement(b.a,{in:r.state.isFadingInOrOut,timeout:250,className:"mention-popover comment-ignore-blur",classNames:"popover-fade",onExited:r.hidePopup},m.a.createElement("section",null,m.a.createElement(E.default,{closePopover:r.hidePopup,grantViewAccessDisabled:i,token:t,source:Object(J.a)(n)})))},r.onVisibleChange=function(e){if(!e)return r.startToFadeOut();r.props.onVisibleChange&&r.props.onVisibleChange(!0),r.props.usePopover&&(Object(Q.default)("click_user_photo",{source_user_photo:r.props.source}),r.setState({visible:!0,isFadingInOrOut:!0}))},r.hidePopup=function(){r.props.onVisibleChange&&r.props.onVisibleChange(!1),r.setState({visible:!1})},r.state={isFadingInOrOut:!1,visible:!1},r}return p()(t,e),c()(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){}},{key:"startToFadeOut",value:function(){this.setState({isFadingInOrOut:!1})}},{key:"componentWillUnmount",value:function(){this.props.onVisibleChange&&this.props.onVisibleChange(!1)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.trigger,i=(e.usePopover,e.onVisibleChange,e.className),r=o()(e,["children","trigger","usePopover","onVisibleChange","className"]);return Object(y.u)(this.props.token)||X.a.isOpendoc?t:m.a.createElement(Y,Object.assign({},r,{className:i,mask:!0,maskClosable:!1,action:[n],popup:this.getPopup(),destroyOnHide:!0,visible:this.state.visible,onVisibleChange:this.onVisibleChange}),t)}}]),t}(g.Component);$.defaultProps={usePopover:!0}},YWjA:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"b",function(){return l});var a=n("+Xq6"),s=n("lQZd"),c=n("HmyT"),o=n("WsN4");function i(e){e.each(function(e,t){var n,i,r=Object(c.$)(t),o=r.attr("data-src");o&&(n=Object(a.g)(o),(i=Object(a.f)({originSrc:o,fileToken:n}))&&(r.attr("src",i),r.attr("data-src",o),r.attr("data-suite",Object(a.e)({fileToken:n||"",objType:Object(s.k)(),objToken:Object(s.g)(),originSrc:o}))))})}function r(e){if(!e)return null;var t=e.src,n=Object(c.$)(document.createElement("img"));if(t){var i=Object(a.g)(t),r=Object(a.f)({originSrc:t,fileToken:i});if(r)return n.attr(o.a.DataNoRequestSrc,r),n.attr(o.a.DataSrc,t),n.attr(o.a.DataSuite,Object(a.e)({fileToken:i||"",objType:Object(s.k)(),objToken:Object(s.g)(),originSrc:t})),n[0]}}function l(){Object(a.i)()}},YYIF:function(e,t,n){},YdHx:function(e,t,n){"use strict";var i=n("lSNA"),me=n.n(i),r=n("J4zp"),ne=n.n(r),ie=n("q1tI"),ve=n.n(ie),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("a1gu"),u=n.n(l),d=n("Nsbk"),h=n.n(d),f=n("7W2i"),p=n.n(f),g=n("cDf5"),m=n.n(g),v=n("oTSI"),b=n("Muja"),y=n("m8R6"),E=n("i8i4"),O=n.n(E),C=n("HmyT"),k=n("TSYQ"),be=n.n(k),I=(n("IU78"),n("aBgF")),H=n("iP/4"),S=n("4PSP"),z=n("4D8z"),re=n("SQ87"),ye=n("4ngZ"),T=n("kESg"),_=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},F=function(e){function t(){var e;return a()(this,t),(e=u()(this,h()(t).apply(this,arguments))).state={initialWidth:0,initialHeight:0,diffX:0,diffY:0,editable:e.editor.isEditable()},e}return p()(t,e),c()(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,i=n.cellId,r=n.rowSpan,o=n.colSpan,a=n.mergedCellId;(e.colSpan!==o&&0===o||e.rowSpan!==r&&0===r)&&i===this.editor.getRep().zoneId&&setTimeout(function(){t.props.focusAndCollapseSelectionOntoCellByZoneId(a,[-1,-1])},0)}},{key:"onCellMouseUp",value:function(e){var t=this.props.cellId;!Object(C.$)(e.target).is(".ace-table-cell")||Object(I.d)(e)||e.shiftKey||"Range"===window.getSelection().type||!this.isEditable()||this.editor.managers.getLineManagerWithSpecialSelection(T.a)||this.props.focusAndCollapseSelectionOntoCellByZoneId(t)}},{key:"onCellKeyDown",value:function(e){var t=this.props.selectEntireCell;Object(I.e)(e)&&e.stopPropagation();var n=this.props.cellId===this.editor.selection.getZone();Object(I.d)(e)&&e.keyCode===I.c.A&&n&&(e.preventDefault(),e.stopPropagation(),t({cellId:this.props.cellId,withMergedCell:!0}))}},{key:"resetWidth",value:function(){this.setState({initialWidth:null})}},{key:"resetHeight",value:function(){this.setState({initialHeight:null})}},{key:"onResizeStart",value:function(){var e=this.props,t=e.width,n=e.height;this.setState({initialWidth:t||0,initialHeight:n||0})}},{key:"onResizeEnd",value:function(){this.setState({diffX:0,diffY:0,initialWidth:null,initialHeight:null})}},{key:"handleMouseEnter",value:function(){var e=this.props.setCurrentHoverOfZone,t=this.editor.isEditable();t!==this.state.editable&&this.setState({editable:t}),e(this.props.cellId)}},{key:"handleMouseDown",value:function(e){re.d.invalidMousedown||Object(C.$)(e.target).parents(".".concat(z.s)).length||(this.disposeMouseDown(),this.screenXWhenMouseDown=e.clientX,document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.disposeMouseDown))}},{key:"disposeMouseDown",value:function(){this.screenXWhenMouseDown=0,document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.disposeMouseDown)}},{key:"handleMouseMove",value:function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f=this.props,p=f.cellId,g=f.width,m=f.getRectOfZone,v=f.isAditDragging,b=f.getDocbodyRect,y=f.selectEntireCell;!v&&this.el.contains(e.target)&&(t=e.clientX-this.screenXWhenMouseDown,n=m([p]).left,i=b().left,r=this.isAllTextHaveSelected(p),a=(o=this.editor.getRep()).lines,s=o.zoneId,l=(c=a.atIndex(a.length()-1)).getLineRect(s).left,u=c.getCharRect(c.width-1,!1,s).left,d=this.el?this.el.clientWidth:g,h=this.el.clientHeight,(r&&24<t&&e.offsetX>l+u+24||d+n+i-6<e.clientX||h-6<e.offsetY)&&(this.disposeMouseDown(),y({cellId:p,withMergedCell:!0,clearSelection:!0})))}},{key:"isAllTextHaveSelected",value:function(e){var t=this.editor.getRep(e),n=t.lines,i=t.selEnd,r=t.selStart,o=n.atIndex(0),a=n.atIndex(n.length()-1),s=window.getSelection(),c=s.anchorNode,l=s.anchorOffset,u=s.focusNode,d=s.focusOffset;return!(!c||!u)&&(H.a.isEdge?0===r[0]&&r[1]===o.lineMarker&&i[0]===n.length()-1&&i[1]===a.width-1:o.lineNode.contains(c)&&0===l&&a.lineNode.contains(u)&&d===a.width-1-a.lineMarker)}},{key:"isEditable",value:function(){return this.state.editable}},{key:"setRef",value:function(e){var t=this.props,n=t.setCellRef,i=t.cellId;this.el=O.a.findDOMNode(e),n("cell-"+i,e)}},{key:"render",value:function(){var e,t=this.props,n=t.author,i=t.cellId,r=t.isEditAdd,o=t.isEditDel,a=t.isSelected,s=t.horizontalScrollToZone,c=t.diffType,l=t.colSpan,u=t.rowSpan,d=t.tableMounted,h=be()("ace-table-cell",(e={"ace-table-cell-selected":a,"ace-table-cell-diff-plus":" plus"===c,"ace-table-cell-diff-minus":" minus"===c,"ace-table-cell-diff-phantom":" phantom"===c,__edit_add:r,__edit_del:o,__edit:r||o},me()(e,"author-".concat(n),n),me()(e,"table-hide",0===l||0===u),e)),f=this.isEditable();return ve.a.createElement("td",{ref:this.setRef,onMouseUp:this.onCellMouseUp,onMouseDown:this.handleMouseDown,onKeyDown:this.onCellKeyDown,onMouseEnter:this.handleMouseEnter,className:h,colSpan:l,rowSpan:u,contentEditable:f,suppressContentEditableWarning:!0,"data-gramm":"false"},ve.a.createElement(ye.c,{zoneId:i,horizontalScrollToZone:s,createByEdit:d}))}},{key:"editor",get:function(){return this.context.innerZoneEditor}}]),t}(ve.a.PureComponent);F.contextTypes=ye.i,_([Object(S.Bind)()],F.prototype,"onCellMouseUp",null),_([Object(S.Bind)()],F.prototype,"onCellKeyDown",null),_([Object(S.Bind)()],F.prototype,"resetWidth",null),_([Object(S.Bind)()],F.prototype,"resetHeight",null),_([Object(S.Bind)()],F.prototype,"onResizeStart",null),_([Object(S.Bind)()],F.prototype,"onResizeEnd",null),_([Object(S.Bind)()],F.prototype,"handleMouseEnter",null),_([Object(S.Bind)()],F.prototype,"handleMouseDown",null),_([Object(S.Bind)()],F.prototype,"disposeMouseDown",null),_([Object(S.Bind)()],F.prototype,"handleMouseMove",null),_([Object(S.Bind)()],F.prototype,"isEditable",null),_([Object(S.Bind)()],F.prototype,"setRef",null);var V=n("FJEn"),w=n("Z5sO"),j=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Z=function(e){function t(e){var n;return a()(this,t),(n=u()(this,h()(t).call(this,e))).idleTimer=0,n.bindEventTimer=0,n.bindEvents=function(){n.stuntRef&&(n.stuntRef.contentWindow?n.bindEventTimer=window.setTimeout(function(){n.stuntRef.contentWindow&&n.stuntRef.contentWindow.addEventListener("resize",n.requestIdleHandleContentResize)},0):n.stuntRef.onload=n.bindContentResize)},n.bindContentResize=function(){n.stuntRef.contentWindow&&n.stuntRef.contentWindow.addEventListener("resize",n.requestIdleHandleContentResize)},n.requestIdleHandleContentResize=function(){n.idleTimer||(n.idleTimer=Object(w.b)(function(){n.props.handleContentResize(),n.idleTimer=0}))},n.cancelIdleHandleContentResize=function(){n.idleTimer&&(Object(w.a)(n.idleTimer),n.idleTimer=0)},n.findSelectedAllMergedCells=Object(v.a)(function(e,m,v,b){var y=new Map,t=new Set;e.forEach(function(e,t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g=V.tableIds.getRowAndColIdFromCellId(e);g&&(n=g.rowId,i=g.colId,r=v.indexOf(n),o=m.indexOf(i),0<=r&&0<=o&&((a=b[r][o])&&a.mergeCellID&&(s=a.mergeCellID,c=a.colspan||0,l=a.rowspan||0,p=y.has(s)?(d=(u=y.get(s)).counts,h=u.colSpans,f=u.rowSpans,{counts:d+1,colSpans:c||h,rowSpans:l||f}):{counts:1,colSpans:c,rowSpans:l},y.set(s,p))))});var n=!0,i=!1,r=void 0;try{for(var o,a=y.entries()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=ne()(o.value,2),c=s[0],l=s[1];l.counts===(l.colSpans||1)*(l.rowSpans||1)&&t.add(c)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return Array.from(t)}),n.renderColGroup=function(){var e=n.props,o=e.horzResizeDiff,a=e.columnBeingResized,t=e.colAttribs,s=e.getColMinWidth;return ve.a.createElement("colgroup",null,t.map(function(e,t){var n=e[z.a.COL_WIDTH]||z.r,i=t===a?Number(n)+Number(o):Number(n),r=s?s(t):0;return ve.a.createElement("col",{width:Math.max(i,z.t,r),key:t})}))},n}return p()(t,e),c()(t,[{key:"componentDidMount",value:function(){this.bindEvents()}},{key:"componentWillUnmount",value:function(){this.stuntRef.contentWindow&&this.stuntRef.contentWindow.removeEventListener("resize",this.requestIdleHandleContentResize),this.bindEventTimer&&window.clearTimeout(this.bindEventTimer)}},{key:"shouldComponentUpdate",value:function(e){var t=Object(y.default)(this.props,"table"),n=Object(y.default)(e,"table");return!Object(b.default)(n,t)}},{key:"renderRows",value:function(){var n=this,e=this.props,t=e.rowIds,i=e.rowAttribs;return t.map(function(e,t){return ve.a.createElement("tr",{key:e,className:"ace-table-row"},n.renderCells(e,i[t],t))})}},{key:"setCellRef",value:function(e,t){this.props.setCellRef("cell-"+e,t)}},{key:"renderCells",value:function(E){var O=this,C=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},k=2<arguments.length?arguments[2]:void 0,e=this.props,I=e.colIds,S=e.rowIds,T=e.colAttribs,_=e.cellAttribs,w=e.selectedCellIds,j=e.horizontalScrollToZone,M=e.setHighlightColumn,L=e.setCurrentHoverOfZone,R=e.getDocbodyRect,N=e.getRectOfZone,D=e.isAditDragging,x=e.selectEntireCell,P=e.focusAndCollapseSelectionOntoCellByZoneId,B=e.tableMounted,U=this.findSelectedAllMergedCells(w,I,S,_);return I.map(function(e,t){var n,i,r,o=_[k]?_[k][t]:{},a=T[t]||{},s=o.mergeCellID,c=o.rowspan,l=o.colspan,u=V.tableIds.getCellIdFromRowAndCol(E,e),d=U.includes(s),h=s&&(void 0!==c||void 0!==l)&&!d,f=-1!==w.indexOf(u),p=a.__edit_add||C.__edit_add,g=a.__edit_del||C.__edit_del,m=a.author||C.author,v=o[z.a.COL_SPAN],b=o[z.a.ROW_SPAN],y=u;return u===O.editor.getRep().zoneId&&(i=(n=Object(re.c)(k,t,_)).rowIndex,r=n.colIndex,y=V.tableIds.getCellIdFromRowAndCol(S[i],I[r])),ve.a.createElement(F,{disableHorzResize:!1,disableVertResize:!0,key:u,cellId:u,tableMounted:B,isAditDragging:D,mergedCellId:y,getRectOfZone:N,getDocbodyRect:R,setCellRef:O.props.setCellRef,setHighlightColumn:M,setCurrentHoverOfZone:L,selectEntireCell:x,isSelected:f&&(d||!h),focusAndCollapseSelectionOntoCellByZoneId:P,isEditAdd:p,isEditDel:g,author:m,colSpan:v,rowSpan:b,horizontalScrollToZone:j})})}},{key:"render",value:function(){var t=this;return ve.a.createElement("table",{className:"ace-table",ref:this.props.setTableRef,"data-zone-container":"*","data-ace-table-col-widths":this.props.tableColsWidth},this.renderColGroup(),ve.a.createElement("tbody",{ref:this.props.setTbodyRef},this.renderRows()),ve.a.createElement("iframe",{src:"//about:blank",frameBorder:"0",ref:function(e){return t.stuntRef=e},className:"tb-scrollable-stunt"}))}},{key:"editor",get:function(){return this.context.innerZoneEditor}}]),t}(ie.Component);Z.contextTypes=ye.i,j([Object(S.Bind)()],Z.prototype,"renderRows",null),j([Object(S.Bind)()],Z.prototype,"setCellRef",null),j([Object(S.Bind)()],Z.prototype,"renderCells",null);var M=n("PJYZ"),L=n.n(M),R=n("UXvI"),N=n("8QLk"),D=n("hbEN"),x=n("cvgA"),W=n.n(x),P=n("xEkU"),B=n.n(P);function U(i){var r=this,o=null;return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[0]&&t[0].persist&&t[0].persist(),null===o&&(o=B()(function(){i.apply(r,t),o=null})),o}}function K(){return function(t,n,e){var i=e.value,r=!1;return{configurable:!0,get:function(){if(r||this===t.prototype||this.hasOwnProperty(n))return i;var e=U(i.bind(this));return r=!0,Object.defineProperty(this,n,{value:e,configurable:!0,writable:!0}),r=!1,e}}}}n("YYIF");var q=n("OX8E"),Y=n("sLU5"),J=n("9BhA"),Q=function(){function e(){var t=this;a()(this,e),this.isRunning=!1,this.lastTime=0,this.duration=[],this.run=function(){var e;t.isRunning&&(e=performance.now(),0!==t.lastTime&&t.duration.push(e-t.lastTime),t.lastTime=e,requestAnimationFrame(t.run))}}return c()(e,[{key:"start",value:function(){this.isRunning||(this.isRunning=!0,requestAnimationFrame(this.run))}},{key:"end",value:function(){return this.isRunning=!1,this.log()}},{key:"clear",value:function(){this.lastTime=0,this.duration=[]}},{key:"average1",value:function(){return 1e3/(this.duration.reduce(function(e,t){return e+t},0)/this.duration.length)}},{key:"average2",value:function(){return this.duration.reduce(function(e,t){var n=1e3/t;return e+(n=60<=n?60:n)},0)/this.duration.length}},{key:"variance",value:function(){var i=this.average2();return this.duration.reduce(function(e,t){var n=60<=(n=1e3/t)?60:n;return e+Math.pow(n-i,2)},0)/this.duration.length}},{key:"standardDeviation",value:function(){return Math.sqrt(this.variance())}},{key:"greaterThan",value:function(t){return this.duration.filter(function(e){return t<e}).length/this.duration.length}},{key:"log",value:function(){var e=[];return e.push(this.average1().toFixed(2)),e}}]),e}(),X=n("rLED"),$=n("skFV");function ee(){return Object($.v)()||Object(X.I)("table_scrollbar_sticky_enable")}var te,oe,ae=n("L1JX"),se=n("GixS"),ce=n("dDhe"),le=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},ue=Y.a.PC.DOCS.SECTION_NAV,de=8,he=2e3,fe=4,pe=15;(oe=te=te||{}).absolute="absolute",oe.fixed="fixed";var ge=function(e){function s(e){var g;a()(this,s),(g=u()(this,h()(s).call(this,e))).randomKey=Math.random(),g.fps=new Q,g.idleTimer=0,g.inResponseZone=!1,g.stickyScrollbarEnable=ee(),g.docScrollWidth=0,g.cacheDocScrollWidth=0,g.leftShadowOffset=0,g.startMovePoint=null,g.bindBaseEvents=function(){g.stickyScrollbarEnable&&g.scrollContainer.addEventListener("scroll",g.handleDocScroll),Object(C.$)(window).on("resize.table-scrollable".concat(g.randomKey),g.requestIdleHandleContentResize)},g.removeBaseEvents=function(){Object(C.$)(document).off(".table-scrollable".concat(g.randomKey)),Object(C.$)(window).off(".table-scrollable".concat(g.randomKey))},g.requestIdleHandleContentResize=function(){g.idleTimer||(g.idleTimer=Object(w.b)(function(){g._handleContentResize(),g.idleTimer=0}))},g.cancelIdleHandleContentResize=function(){g.idleTimer&&(Object(w.a)(g.idleTimer),g.idleTimer=0)},g.bindMouseEvents=function(){Object(C.$)(document).on("mousemove.table-scrollable".concat(g.randomKey),g.handleThumbDrag),Object(C.$)(document).on("mouseup.table-scrollable".concat(g.randomKey),g.handleMouseUp)},g.removeMouseEvents=function(){Object(C.$)(document).off(".table-scrollable".concat(g.randomKey))},g.onResize=function(){var e=g.state,t=e.showLeftScrollShadow,n=e.showRightScrollShadow,i=e.leftShadowWidth,r=e.rightShadowWidth,o=e.scrollLeft;g.props.onResize&&g.props.onResize(t,n,i,r,o)},g.debounceCollectFpsEnd=Object(D.default)(function(){var e=g.fps.end();Object(J.e)({type:z.u.TABLE_SRCOLL,source:"table_horz_scroll",averageFps:e[0]}),g.fps.clear()},300),g.onScroll=function(){var e=g.state,t=e.showLeftScrollShadow,n=e.showRightScrollShadow,i=e.leftShadowWidth,r=e.rightShadowWidth,o=e.scrollLeft,a=L()(g),s=a.scrollDirection,c=a.leftShadowOffset,l=g.props.tableId;q.a.trigger("updateBlockEditbar",[{scrollLeft:o,leftOffset:c,callerTableId:l}]),g.props.onScroll&&g.props.onScroll(t,n,i,r,o,s)},g.maybeHideScrollShadows=function(){g.setState(g.calcScrollShadows())},g.handleThumbMouseDown=function(e){e.preventDefault(),g.setState({initialScroll:g.state.scrollLeft,initialPosition:e.pageX,scrolling:!0,scrollbarVisible:!0}),g.bindMouseEvents()},g.handleThumbDrag=function(e){var t=g.state,n=t.clientWidth,i=t.scrollWidth,r=t.initialScroll,o=t.initialPosition;g.scrollableRef.scrollLeft=r+-1*(o-e.pageX)*(i/n)},g.handleMouseUp=function(){g.setState({scrolling:!1}),g.stickyScrollbarEnable&&g.delayToHideScrollbar(),g.removeMouseEvents()},g.handleJumpLeft=function(e){var t,n,i;e.preventDefault(),e.stopPropagation(),g.scrollableRef&&(n=(t=g.state).scrollLeft,i=t.clientWidth,g.scrollableRef.scrollLeft=Math.max(n-i,0))},g.handleJumpRight=function(e){var t,n,i,r;e.preventDefault(),e.stopPropagation(),g.scrollableRef&&(n=(t=g.state).scrollLeft,i=t.clientWidth,r=t.scrollWidth,g.scrollableRef.scrollLeft=Object(N.a)(n+i,0,r-i))},g.handleWrapScroll=function(){var e,t;!H.a.ios||(e=window.getSelection())&&e.rangeCount&&(t=e.getRangeAt(0).cloneRange(),e.removeAllRanges(),e.addRange(t))},g.getShadowVisiable=function(e,t){var n=g.state,i=n.showLeftScrollShadow,r=n.showRightScrollShadow,o=n.scrollLeft;if(i||r)return!0;var a,s=g.props,c=s.customContext,l=s.tableTotalWidth,u=c.fullWidth,d=c.isCommentCross,h=c.docbodyRect,f=c.platform,p=c.containerRect;return e&&t||(e=(a=Object(re.b)(h,p,u,o,l,f,d,r)).docScrollWidth,t=a.tableScrollWidth),!!(e&&t&&t<e)},g.handleWrapMouseMove=function(e){var t,n;H.a.isIPad&&e.pageY&&e.pageX&&g.getShadowVisiable()&&(t={x:e.pageX,y:e.pageY},g.startMovePoint?(n=Math.abs(t.x-g.startMovePoint.x)<Math.abs(t.y-g.startMovePoint.y))!==g.state.isVerticalScroll&&g.setState({isVerticalScroll:n}):g.startMovePoint=t,g.clearMovePoint())},g.clearMovePoint=Object(D.default)(function(){g.setState({isVerticalScroll:!1}),g.startMovePoint=null},300),g.toggleScrollbarVisible=function(e){var t;g.stickyScrollbarEnable&&(t=e.type,g.debounceToggleScrollbarVisible(t))};var t=e.colAttribs,n=e.customContext.docbodyRect,i=t.reduce(function(e,t){return e+Number(t.colWidth||z.r)},0);return g.state={hideScrollBar:!0,clientWidth:n.innerWidth,scrollWidth:i,leftOffset:0,scrollLeft:0,firstRender:!0,showLeftScrollShadow:!1,showRightScrollShadow:!1,leftShadowWidth:0,rightShadowWidth:0,initialScroll:0,initialPosition:0,scrolling:!1,scrollbarVisible:!g.stickyScrollbarEnable||!1,scrollbarPositionInfo:{position:te.absolute,left:0,bottom:0},isVerticalScroll:!1},g.state=Object.assign(g.state,g.calcScrollShadows()),g.scrollContainer=g.props.editor.getScrollContainer(),g}return p()(s,e),c()(s,[{key:"componentDidMount",value:function(){this.scrollableRef&&(this.bindBaseEvents(),setTimeout(s.updateRectInfo,200))}},{key:"shouldComponentUpdate",value:function(e,t){var n=["editor"],i=Object(y.default)(this.props,n),r=Object(y.default)(e,n);return!Object(b.default)(i,r)||!Object(b.default)(t,this.state)}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.setTableScrollWidth,i=this.props.customContext,r=i.docbodyRect,o=i.isCommentCross,a=e.customContext,s=a.docbodyRect,c=a.isCommentCross;Object(b.default)(r,s)&&o===c&&Object(b.default)(e,this.props)&&Object(b.default)(t,this.state)||this.handleContentResize(),this.state.firstRender&&this.setState({firstRender:!1}),this.docScrollWidth&&this.cacheDocScrollWidth!==this.docScrollWidth&&(n(this.docScrollWidth),this.cacheDocScrollWidth=this.docScrollWidth)}},{key:"componentWillUnmount",value:function(){this.removeMouseEvents(),this.removeBaseEvents()}},{key:"handleContentResize",value:function(){this._handleContentResize()}},{key:"_handleContentResize",value:function(){var e=this.props,t=e.editor,n=e.colsZoneId,i=t.managers.zoneToLineEntry[n];i&&i.isActive&&this.scrollableRef&&(this.setState({hideScrollBar:!1,clientWidth:this.scrollableRef.clientWidth,scrollWidth:this.scrollableRef.scrollWidth,scrollLeft:this.scrollableRef.scrollLeft}),this.maybeHideScrollShadows(),this.updateScrollbarPosition(),s.updateRectInfo(),this.setState({},this.onResize))}},{key:"handleScroll",value:function(e){var t,n,i=this.state,r=i.scrollWidth,o=i.clientWidth,a=this.scrollableRef.scrollLeft;a<0||r-o<a||(e.preventDefault(),this.fps.start(),a!==this.state.scrollLeft&&(this.prevStateScrollLeft=this.state.scrollLeft,this.state.scrollLeft<a?(this.scrollDirection="slide_to_left",(t=Object(C.$)(e.target).parents(".ace-table-mount-point").eq(0)).hasClass("ace-table-scroll-out-left")||t.addClass("ace-table-scroll-out-left")):this.state.scrollLeft>a&&(this.scrollDirection="slide_to_right")),a<=0&&((n=Object(C.$)(e.target).parents(".ace-table-mount-point").eq(0)).hasClass("ace-table-scroll-out-left")&&n.removeClass("ace-table-scroll-out-left")),this.maybeHideScrollShadows(),s.updateRectInfo(),this.setState({scrollLeft:a},this.onScroll),this.debounceCollectFpsEnd())}},{key:"calcScrollShadows",value:function(){var e,t,n,i,r,o=this.state,a=o.scrollLeft,s=o.scrollWidth,c=o.clientWidth,l=this.props,u=l.customContext,d=l.tableTotalWidth,h=u.isCommentCross,f=u.fullWidth,p=u.docbodyRect,g=u.platform,m=u.containerRect,v=p.innerWidth;r=f&&900<m.width?(t=(e=Object(re.f)(h,p,g,m)).tableFullLeftMargin,i=v+(n=e.tableFullRightMargin)<c?a<t:0===a,Math.min(d,c)<=v+n):(i=0===a,s<=c||s<a+c);var b=a;return{showLeftScrollShadow:!i,showRightScrollShadow:!r,leftShadowWidth:Math.min(de,b/3),rightShadowWidth:Math.min(de,(s-(b+c))/3)}}},{key:"delayToHideScrollbar",value:function(){var e=this;setTimeout(function(){e.inResponseZone||e.setState({scrollbarVisible:!1})},he)}},{key:"handleDocScroll",value:function(){this.updateScrollbarPosition()}},{key:"updateScrollbarPosition",value:function(){var e,t,n,i,r,o;this.stickyScrollbarEnable&&this.scrollableRef&&((e=this.scrollableRef.offsetParent)&&(n=(t=e.getBoundingClientRect()).bottom,i=t.top,o=n-(r=window.innerHeight),0<i&&i-r<0&&0<o||i<0&&0<o?this.setScrollbarPosition(te.fixed):this.setScrollbarPosition(te.absolute)))}},{key:"debounceToggleScrollbarVisible",value:function(e){var t=this.state.scrolling,n="mouseenter"===e,i=!(!(this.inResponseZone=n)&&!t);this.state.scrollbarVisible!==i&&this.setState({scrollbarVisible:i})}},{key:"setScrollbarPosition",value:function(e){var t,n,i,r,o;this.state.scrollbarPositionInfo.position!==e&&(t=this.props.editor.getRect(),i=(n=e===te.fixed)&&t?t.left+z.l:0,r=n&&t?fe:0,o=n&&t?te.fixed:te.absolute,this.setState({scrollbarPositionInfo:{position:o,left:i,bottom:r}}))}},{key:"setTableOuterWrapperRef",value:function(e){var t,n;e&&(this.scrollableChildrenRef=e,(t=this.props.editor.dom.getEntryForNode(e))&&(t.fullWidthNode=e,n=this.props.customContext,t.isFullWidth=n.fullWidth))}},{key:"render",value:function(){var t=this,e=this.state,n=e.scrolling,i=e.showLeftScrollShadow,r=e.showRightScrollShadow,o=e.leftShadowWidth,a=e.rightShadowWidth,s=e.clientWidth,c=e.scrollWidth,l=e.scrollLeft,u=e.scrollbarVisible,d=e.scrollbarPositionInfo,h=e.isVerticalScroll,f=this.props,p=f.customContext,g=f.tableTotalWidth,m=p.fullWidth,v=p.isCommentCross,b=p.docbodyRect,y=p.platform,E=p.containerRect,O=Object(re.b)(b,E,m,l,g,y,v,r),C=O.docScrollWidth,k=O.leftShadowOffset,I=O.marginLeft,S=O.marginRight,T=O.tableScrollWidth,_=O.paddingRight;this.leftShadowOffset=k;var w=this.getShadowVisiable(C,T),j=W()(),M=ae.a.IS_FS_MODE?6:0,L=(j?-j:-pe)+M,R=0<Number(C)?Number(C)+2*se.b:0,N={paddingBottom:!Object(ce.c)()&&w?j||2*pe:pe,marginBottom:w?L:0,marginLeft:I,overflowX:w&&!h?"auto":"hidden"},D={transform:"translate(".concat(Math.round(-I),"px, 0px)"),width:"fit-content"},x=pe+"px",P=m&&T||s;this.docScrollWidth=Number(C);var B=be()(this.props.className,{"tb-scrollable":!0,"tb-scrollable-scrolling":n,"tb-scrollable-with-scrollbar":w,"tb-scrollable-with-shadow-left":i,"tb-scrollable-with-shadow-right":r,"tb-scrollable-width-over":g>=b.width}),U=Object(ce.c)()?-1e3:S,z=r&&s===c-l;return ve.a.createElement("div",{className:B,onScroll:this.handleWrapScroll,style:{marginLeft:I,marginRight:U,paddingLeft:-I,paddingRight:-"".concat(_||0)},onMouseMove:this.handleWrapMouseMove},H.a.isMobile?ve.a.createElement("div",{className:"tb-scrollable-content"},this.props.children):ve.a.createElement("div",{className:"tb-scrollable-content",ref:function(e){return t.scrollableRef=e},onScroll:this.handleScroll,style:N,"data-width":R},ve.a.createElement("div",{className:"tb-scrollable-children",style:D,ref:this.setTableOuterWrapperRef,onMouseEnter:this.toggleScrollbarVisible,onMouseLeave:this.toggleScrollbarVisible},this.props.children),ve.a.createElement("div",{className:be()("tb-scrollable-shadow","tb-scrollable-shadow-left",{"tb-scrollable-shadow-enabled":i}),style:{left:k,width:o,bottom:x}}),ve.a.createElement("div",{className:be()("tb-scrollable-shadow","tb-scrollable-shadow-right",{"tb-scrollable-shadow-enabled":r,"tb-scrollable-shadow-right-end":z}),style:{width:a,right:U,bottom:x}}),ve.a.createElement(Ee,{enabled:u&&!this.state.hideScrollBar&&!this.state.firstRender&&(i||r||w),onThumbMouseDown:this.handleThumbMouseDown,onJumpLeft:this.handleJumpLeft,onJumpRight:this.handleJumpRight,tableVisibleWidth:P,clientWidth:s,scrollWidth:c,scrollLeft:l,paddingRight:_,scrollbarPositionInfo:d,onMouseEnter:this.toggleScrollbarVisible,onMouseLeave:this.toggleScrollbarVisible,stickyScrollbarEnable:this.stickyScrollbarEnable})))}},{key:"editor",get:function(){return this.context.innerZoneEditor||null}}]),s}(ve.a.Component);ge.contextTypes=ye.i,ge.updateRectInfo=Object(R.default)(function(){q.a.trigger(ue.ON_LINE_ENTRY_CHANGE)},50),le([K()],ge.prototype,"handleContentResize",null),le([K()],ge.prototype,"handleScroll",null),le([K()],ge.prototype,"handleDocScroll",null),le([Object(S.Debounce)(500)],ge.prototype,"debounceToggleScrollbarVisible",null),le([Object(S.Bind)()],ge.prototype,"setTableOuterWrapperRef",null);var Ee=function(e){var t=e.enabled,n=e.clientWidth,i=e.scrollWidth,r=e.scrollLeft,o=e.onThumbMouseDown,a=e.onJumpLeft,s=e.onJumpRight,c=e.onMouseEnter,l=e.onMouseLeave,u=e.tableVisibleWidth,d=e.paddingRight,h=e.scrollbarPositionInfo,f=e.stickyScrollbarEnable;if(!t)return null;var p={width:u*(n/i)+2,left:u*(r/i)},g="tb-scrollable-scrollbar-thumb",m=f?g+"-sticky":g;return ve.a.createElement("div",{className:"tb-scrollable-scrollbar",style:Object.assign({},h,{width:u}),onMouseEnter:c,onMouseLeave:l},ve.a.createElement("div",{className:"tb-scrollable-page-left",style:{width:p.left-d},onMouseDown:a}),ve.a.createElement("div",{className:"tb-scrollable-page-right",style:{width:Math.max(0,n-p.width-p.left-8)},onMouseDown:s}),ve.a.createElement("div",{className:m,style:p,onMouseDown:o}))},Oe=n("CnBM"),Ce=n.n(Oe),ke=Ce()({loader:function(){return n.e("doc_ace_table").then(n.bind(null,"U1j5"))},loading:function(){return null}}),Ie=(n("Zz26"),function(e,t){var n=e.columnWidths,o=e.hintColsToDeleteCount,a=e.selectedColumns,s=e.onSelect,c=e.onMouseDown,l=e.onMouseEnter,u=e.partialCols,d=e.isDragging,h=e.isHovering,i=e.columnHeaderColLeft,r=e.marginRight,f=e.marginLeft,p=t.innerZoneEditor;function g(){var i=[],r=0;return n.forEach(function(e,t){var n=-1!==a.indexOf(t);i.push(ve.a.createElement("div",{key:t,className:be()("ace-table-col-header",{"ace-table-col-header-is-deletion-hint":0<o&&n,"ace-table-col-header-selected":n,"ace-table-col-header-hovered":h&&!n,"ace-table-col-header-partial-selected":-1!==u.indexOf(t),"ace-table-col-header-is-being-dragged":d&&n}),style:{width:e?e+r:ye.e},onMouseEnter:function(e){return l(t,!1)}},ve.a.createElement("button",{className:"dmc-button ace-table-col-select hpx-button",onClick:function(e){return s&&s(e,t)},onMouseDown:function(e){p.profile.start(z.u.CLICK_COL_HEADER),c(e,t,!1),p.profile.endByNextRender(z.u.CLICK_COL_HEADER)}},ve.a.createElement("span",{className:"drag-handler drag-handler-horizontal"}))))}),i}return ve.a.createElement("div",{className:"ace-table-col-headers",style:{marginLeft:f,marginRight:r}},ve.a.createElement("div",{className:"ace-table-col-headers-inner",style:{transform:"translateX(".concat(i-f,"px)")}},g()))});Ie.contextTypes=ye.i;var Se=Ie,Te=(n("R9xI"),n("O15b")),_e=function(e,t){var n=e.rowHeights,a=e.hintRowsToDeleteCount,s=e.selectedRows,c=e.onSelect,l=e.onMouseDown,u=e.onMouseEnter,d=e.partialRows,h=e.isHovering,i=e.columnHeaderColLeft,f=t.innerZoneEditor;function r(){var o=[];return n.forEach(function(e,t){var n=-1!==s.indexOf(t),i=be()("ace-table-row-header",{"ace-table-row-header-is-deletion-hint":0<a&&n,"ace-table-row-header-selected":n,"ace-table-row-header-hovered":h&&!n,"ace-table-row-header-partial-selected":-1!==d.indexOf(t)}),r={onMouseLeave:function(e){e.target.classList.remove(z.D)}};n||(r.onMouseEnter=function(e){e.target.classList.add(z.D)}),o.push(ve.a.createElement("div",{key:t,className:i,style:{height:e},onMouseEnter:function(e){return u(t,!0)}},ve.a.createElement("button",Object.assign({className:"dmc-button ace-table-row-select hpx-button",onClick:function(e){return c&&c(e,t)},onMouseDown:function(e){f.profile.start(z.u.CLICK_ROW_HEADER),l(e,t,!0),f.profile.endByNextRender(z.u.CLICK_ROW_HEADER)}},r))))}),o}return ve.a.createElement("div",{className:"ace-table-row-headers",style:{left:i-(Te.a+z.A)}},r())};_e.contextTypes=ye.i;var we=_e,je=(n("RTZD"),n("pVnL")),Me=n.n(je),Ae=n("QILm"),Le=n.n(Ae),Re=function(e){e.styles;var t=Le()(e,["styles"]);return ve.a.createElement("svg",Me()({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},t),ve.a.createElement("rect",{width:"16",height:"16",rx:"8",fill:"#DEE0E3"}),ve.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 5a1 1 0 000 2h6a1 1 0 100-2H5zm0 4a1 1 0 000 2h6a1 1 0 100-2H5z",fill:"#8F959E"}))},Ne=function(e){function i(){var t;return a()(this,i),(t=u()(this,h()(i).apply(this,arguments))).state={isSelected:!1},t.wrapperRef=null,t.onToggleSelect=function(e){t.state.isSelected&&t.props.entireTable||t.setState({isSelected:e})},t.enterTableIcon=function(e){t.props.editor&&t.props.editor.call("editorbar:enterTableIcon",{table:t.props.tableRef,event:e.nativeEvent})},t}return p()(i,e),c()(i,[{key:"componentDidMount",value:function(){this.props.editor&&this.props.editor.on("toggleSelect",this.onToggleSelect),this.wrapperRef&&(this.wrapperRef.tableRef=this.props.tableRef)}},{key:"componentWillUnmount",value:function(){this.props.editor&&this.props.editor.off("toggleSelect",this.onToggleSelect)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.entireTable!==e.entireTable&&this.setState({isSelected:e.entireTable})}},{key:"shouldComponentUpdate",value:function(e,t){return t.isSelected!==this.state.isSelected||e.columnHeaderColLeft!==this.props.columnHeaderColLeft}},{key:"render",value:function(){var t=this,e=this.state.isSelected,n=this.props.columnHeaderColLeft;return ve.a.createElement("div",{ref:function(e){return t.wrapperRef=e},className:be()("".concat(i.prefix," ace-table-table-header-wrapper"),{selected:e}),style:{left:n-12}},ve.a.createElement("button",{onClick:function(){return t.props.onToggleSelect(!0)},onMouseEnter:this.enterTableIcon,className:"ace-table-table-select hpx-button"},ve.a.createElement(Re,null)))}}]),i}(ve.a.Component);Ne.prefix="ace-table-header";var De=Ce()({loader:function(){return n.e("doc_ace_table").then(n.bind(null,"n1a1"))},loading:function(){return null}}),xe=function(e){var t=e.selectedColumns,n=e.selectedRows,i=e.scrollLeft,r=e.rowHeights,o=e.onToggleSelect,a=e.hintTableToDelete,s=e.onDeleteTable,c=e.onCopyTable,l=e.onCutTable,u=e.columnWidths,d=e.onSelectCol,h=e.onSelectRow,f=e.onMouseDown,p=e.onMouseEnter,g=e.hintColsToDeleteCount,m=e.partialCols,v=e.hintRowsToDeleteCount,b=e.partialRows,y=e.tableTotalWidth,E=e.tableRectInfo,O=e.hoveringColAdd,C=e.isSelectAll,k=e.selectType,I=e.rowsZoneId,S=e.colsZoneId,T=e.tableWrapper,_=e.addColAtIndex,w=e.deleteSelectedZones,j=e.addRowAtIndex,M=e.getScrollTop,L=e.tableRef,R=e.editor,N=e.customContext,D=e.setTableHeaderRef,x=e.entireTable,P=e.scrollerWidth,B=e.unselectAll,U=e.setDeleteFlag,z=e.select,H=e.selectedCellIds,F=e.tableScrollWidth,V=e.isFocused,W=N.isCommentCross,K=N.fullWidth,Z=N.docbodyRect,q=N.platform,Y=N.isHovering,J=N.containerRect,Q=Object(re.a)({fullWidth:K,docbodyRect:Z,tableTotalWidth:y,isCommentCross:W,scrollLeft:i,platform:q,containerRect:J}),X=Object(ie.useState)(!0),$=ne()(X,2),ee=$[0],te=$[1];return ve.a.createElement("div",null,ee?ve.a.createElement(ke,{tableRectInfo:E,deleteSelectedZones:w,tableWrapper:T,hoveringColAdd:O,selectedColumns:t,selectedRows:n,isSelectAll:C,selectType:k,scrollLeft:i,colWidths:u,rowHeights:r,maxRight:Q.marginRight,scrollerWidth:P,marginLeft:Q.marginLeft,columnHeaderColLeft:Q.leftShadowOffset,editor:R,setDeleteFlag:U,tableScrollWidth:F}):null,ve.a.createElement(Ne,{entireTable:x,onToggleSelect:o,hintTableToDelete:a,onDeleteTable:s,onCopyTable:c,onCutTable:l,getScrollTop:M,columnHeaderColLeft:Q.leftShadowOffset,editor:R,tableRef:L,ref:D}),ve.a.createElement(Se,{columnWidths:u,columnHeaderColLeft:-i,selectedColumns:t,onSelect:d,onMouseDown:f,onMouseEnter:p,hintColsToDeleteCount:g,partialCols:m,isHovering:Y,marginLeft:Q.marginLeft,marginRight:Q.marginRight}),ve.a.createElement(we,{rowHeights:r,selectedRows:n,onSelect:h,onMouseDown:f,onMouseEnter:p,columnHeaderColLeft:Q.leftShadowOffset,hintRowsToDeleteCount:v,partialRows:b,isHovering:Y}),ve.a.createElement(De,{rowsZoneId:I,colsZoneId:S,rowHeaderHeights:r,colHeaderWidths:u,columnHeaderColLeft:-i,rowHeaderColLeft:Q.leftShadowOffset,marginLeft:Q.marginLeft,marginRight:Q.marginRight,addColAtIndex:_,addRowAtIndex:j,unselectAll:B,select:z,tableIsFocused:V,selectedCellIds:H,tableScrollWidth:F,setShowPopover:te}))},Pe=(n("mDY+"),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a}),Be=function(e){function n(){var t;return a()(this,n),(t=u()(this,h()(n).apply(this,arguments))).fps=new Q,t.state={doingHorzResize:!1,doingVertResize:!1,initialX:-1,initialY:-1},t.debounceCollectFpsEnd=Object(D.default)(function(){var e=t.fps.end();Object(J.e)({type:z.u.HORZ_RESIZE,source:"table_col_resize",averageFps:e[0]}),t.fps.clear()},300),t}return p()(n,e),c()(n,[{key:"onHorzMouseDown",value:function(e){var t=this;e.preventDefault(),e.stopPropagation(),Object(C.$)(document).off(".resizable"),this.props.onHorzResizeStart(),this.setState({doingHorzResize:!0,initialX:e.screenX},function(){Object(C.$)(document).on("mousemove.resizable",t.onHorzMouseMove),Object(C.$)(document).on("mouseup.resizable",t.onHorzMouseUp)})}},{key:"componentWillMount",value:function(){Object(C.$)(document).off(".resizable")}},{key:"onHorzMouseUp",value:function(){Object(C.$)(document).off(".resizable"),this.editor.profile.start(z.u.HORZ_RESIZE_END),this.props.onHorzResizeEnd(),this.setState({doingHorzResize:!1,initialX:-1}),this.editor.profile.endByNextRender(z.u.HORZ_RESIZE_END)}},{key:"onHorzMouseMove",value:function(e){var t=this.state,n=t.doingHorzResize,i=t.initialX,r=this.props.onHorzResize;n&&r&&(e.preventDefault(),this.fps.start(),r(e.screenX-i)),this.debounceCollectFpsEnd()}},{key:"onHorzMouseEnter",value:function(e){var t=this;e.stopPropagation(),this.horzHoverTimer&&clearTimeout(this.horzHoverTimer),this.editor.profile.start(z.u.MOUSE_ENTER),this.horzHoverTimer=window.setTimeout(function(){t.horzHoverTimer=null,t.props.onHorzMouseEnter&&t.props.onHorzMouseEnter(),t.editor.profile.endByNextRender(z.u.MOUSE_ENTER)},10)}},{key:"onHorzMouseLeave",value:function(e){this.horzHoverTimer&&clearTimeout(this.horzHoverTimer),!this.props.onHorzMouseLeave||this.state.doingHorzResize||this.props.isHorzBeingResized||this.props.onHorzMouseLeave()}},{key:"onVertMouseDown",value:function(e){var t=this,n=this.props.onVertResizeStart;e.preventDefault(),Object(C.$)(document).off(".resizable"),n&&n(),this.setState({doingVertResize:!0,initialY:e.screenY},function(){Object(C.$)(document).on("mousemove.resizable",t.onVertMouseMove),Object(C.$)(document).on("mouseup.resizable",t.onVertMouseUp)})}},{key:"onVertMouseMove",value:function(e){var t=this.props,n=t.onVertResize,i=t.isVertBeingResized,r=this.state,o=r.doingVertResize,a=r.initialY;o&&n&&!i&&(e.preventDefault(),n(e.screenY-a))}},{key:"onVertMouseUp",value:function(){var e=this.props.onVertResizeEnd;Object(C.$)(document).off(".resizable"),e&&e(),this.setState({doingVertResize:!1,initialY:-1})}},{key:"onVertMouseEnter",value:function(e){var t=this;this.vertHoverTimer&&clearTimeout(this.vertHoverTimer),this.vertHoverTimer=window.setTimeout(function(){t.vertHoverTimer=null,t.props.onVertMouseEnter&&t.props.onVertMouseEnter(e)},10)}},{key:"onVertMouseLeave",value:function(e){this.vertHoverTimer&&clearTimeout(this.vertHoverTimer),!this.props.onVertMouseLeave||this.state.doingVertResize||this.vertHoverTimer||this.props.onVertMouseLeave(e)}},{key:"render",value:function(){var e=this.props,t=e.alignToLeft,n=e.isHorzHovered,i=e.disableVertResize,r=e.isVertHovered,o=e.alignToTop,a=e.height,s=e.leftOffset,c=e.isShowBorder,l=e.visible,u="".concat(this.props.className||""," tb-resizable"),d=[],h=this.props.htmlTag||"div",f=Object.assign({},this.props,{className:u}),p={height:a,left:s},f=Object(y.default)(f,["htmlTag","visible","onHorzResize","onHorzResizeStart","onHorzResizeEnd","onVertResize","onVertResizeStart","onVertResizeEnd","onHorzMouseEnter","onHorzMouseLeave","disableHorzResize","disableVertResize","alignToTop","alignToLeft","isHorzHovered","isVertHovered","isHorzBeingResized","isVertBeingResized","children","leftOffset","height",H.a.isEdge?"contentEditable":""]);return this.props.disableHorzResize&&!this.props.isHorzHovered||d.push(ve.a.createElement("div",{key:1,className:be()("tb-resizable-grippy","tb-resizable-horz",{"tb-resizable-left":t,"is-hovered":n,"tb-resizable-hidden":!c,"tb-resizable-nonvisible":!l}),style:p,onMouseEnter:this.onHorzMouseEnter,onMouseLeave:this.onHorzMouseLeave,onMouseDown:this.onHorzMouseDown},ve.a.createElement("div",{className:"tb-resizable-grippy-inner"}))),i&&!r||d.push(ve.a.createElement("div",{key:2,className:be()("tb-resizable-grippy","tb-resizable-vert",{"tb-resizable-top":o,"is-hovered":r}),onMouseEnter:this.onVertMouseEnter,onMouseLeave:this.onVertMouseLeave,onMouseDown:this.onVertMouseDown,onMouseMove:this.onVertMouseMove},ve.a.createElement("div",{className:"tb-resizable-grippy-inner"}))),ve.a.createElement(h,Object.assign({},f),ve.a.createElement("div",{className:"separate-td-content-editable",contentEditable:!1},this.props.children,d))}},{key:"editor",get:function(){return this.context.innerZoneEditor||null}}]),n}(ve.a.PureComponent);Be.contextTypes=ye.i,Pe([Object(S.Bind)()],Be.prototype,"onHorzMouseDown",null),Pe([Object(S.Bind)()],Be.prototype,"onHorzMouseUp",null),Pe([K()],Be.prototype,"onHorzMouseMove",null),Pe([Object(S.Bind)()],Be.prototype,"onHorzMouseEnter",null),Pe([Object(S.Bind)()],Be.prototype,"onHorzMouseLeave",null),Pe([Object(S.Bind)()],Be.prototype,"onVertMouseDown",null),Pe([Object(S.Bind)()],Be.prototype,"onVertMouseMove",null),Pe([Object(S.Bind)()],Be.prototype,"onVertMouseUp",null),Pe([Object(S.Bind)()],Be.prototype,"onVertMouseEnter",null),Pe([Object(S.Bind)()],Be.prototype,"onVertMouseLeave",null);var Ue=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},ze=function(e){function t(){return a()(this,t),u()(this,h()(t).apply(this,arguments))}return p()(t,e),c()(t,[{key:"renderColumns",value:function(){var e=this.props,l=e.columnWidths,u=e.hintColsToDeleteCount,d=e.onMouseDown,h=e.onMouseEnter,f=e.onHorzDiff,t=e.rowHeights,p=e.handleHorzResize,g=e.handleHorzResizeStart,m=e.handleHorzResizeEnd,v=e.handleResizeEnter,b=e.handleResizeLeave,y=e.columnWithRightBorderHighlighted,E=e.columnBeingResized,O=e.colAttribs,C=e.horzResizeDiff,n=e.columnHeaderColLeft,k=e.colHeaderTypes,i=e.marginLeft,r=e.marginRight,I=e.isCommentCross,S=e.getColMinWidth;if(t.length){var o,a,s,T=t.reduce(function(e,t){return e+t}),_=0,w=0;I&&(o=z.j+Math.abs(i)+Math.abs(r),a=Math.abs(n),s=Math.abs(i),0<a&&(_=Math.abs(i)>a?0:a-Math.abs(i),s=Math.abs(i)>a?Math.abs(i)-a:0),w=o-s);var j=l.length-1;return l.map(function(e,t){var n=y===t,i=l.slice(0,t+1).reduce(function(e,t){return e+t}),r=!0;t===j||!I||(r=i-_<w);var o="colMerged"!==k[t],a=O[t]&&O[t][z.a.COL_WIDTH]||z.r,s=t===E?Number(a)+Number(C):Number(a),c=Math.max(s,z.t,S?S(t):0);return ve.a.createElement(He,{key:t,colIndex:t,height:T,onMouseDown:d,visible:r,onMouseEnter:function(){return h(t,!1)},onResize:function(e){return p(t,0,e)},onResizeStart:function(){return g(t)},onResizeEnd:function(e){return m(t,e)},onResizeMouseEnter:function(){return v(t,!1)},onResizeMouseLeave:function(){return b(!1)},isColumnBeingResized:E===t,isLeftBorderHighlighted:0===t&&-1===y,isRightBorderHighlighted:n,isShowBorder:o,hintColsToDeleteCount:u,onHorzDiff:f,colNumber:l.length,width:c>z.t?c:z.t})})}}},{key:"render",value:function(){return ve.a.createElement("div",{className:"ace-table-col-headers-resize"},ve.a.createElement("div",{className:"ace-table-col-headers-resize-inner"},this.renderColumns()))}}]),t}(ve.a.PureComponent),He=function(e){function t(){var e;return a()(this,t),(e=u()(this,h()(t).apply(this,arguments))).state={diffX:0,initialWidth:null},e}return p()(t,e),c()(t,[{key:"componentWillMount",value:function(){this.removeBodyCursor()}},{key:"handleResize",value:function(e){var t=this.props,n=t.onResize,i=t.onHorzDiff,r=t.colIndex;i&&(e=i(r,e)),n(e),this.setState({diffX:e})}},{key:"handleResizeStart",value:function(){var e=this.props,t=e.width;(0,e.onResizeStart)(),this.addBodyCursor(),this.setState({initialWidth:t||0})}},{key:"handleResizeEnd",value:function(){(0,this.props.onResizeEnd)(this.state.diffX),this.removeBodyCursor(),this.setState({diffX:0,initialWidth:null})}},{key:"addBodyCursor",value:function(){document.documentElement.style.cursor="col-resize",document.body.style.pointerEvents="none"}},{key:"removeBodyCursor",value:function(){document.documentElement.style.cursor="",document.body.style.pointerEvents=""}},{key:"getStyle",value:function(e){var t=e.width,n={width:"".concat(t?t+1:1,"px")};return n.minWidth=n.width="".concat(t,"px"),n}},{key:"render",value:function(){var e=this.props,t=e.onResizeMouseEnter,n=e.onResizeMouseLeave,i=e.onMouseEnter,r=e.colIndex,o=e.height,a=e.width,s=e.isShowBorder,c=e.isLeftBorderHighlighted,l=e.isRightBorderHighlighted,u=e.isColumnBeingResized,d=e.visible,h=this.state,f=h.initialWidth,p=h.diffX,g=this.getStyle({initialWidth:f,width:a,diffX:p});return ve.a.createElement(Be,{htmlTag:"div",key:r,visible:d,isShowBorder:s,onHorzResize:this.handleResize,onHorzResizeStart:this.handleResizeStart,onHorzResizeEnd:this.handleResizeEnd,onHorzMouseEnter:t,onHorzMouseLeave:n,disableHorzResize:!1,disableVertResize:!0,alignToLeft:c,isHorzHovered:l||c,isHorzBeingResized:u,isVertBeingResized:!1,onMouseEnter:i,isVertHovered:!1,style:g,height:o})}}]),t}(ve.a.PureComponent);Ue([Object(S.Bind)()],He.prototype,"handleResize",null),Ue([Object(S.Bind)()],He.prototype,"handleResizeStart",null),Ue([Object(S.Bind)()],He.prototype,"handleResizeEnd",null),Ue([Object(S.Bind)()],He.prototype,"getStyle",null);var Fe=ze,Ve=n("D28M"),We=n("y2sV");function Ke(e){var t,n=e.instance,i=n.state,r=n.setTableOuterWrapperRef,o=n.handleTableMouseDown,a=n.setTableWrapperRef,s=i.addRemoveIsShown,c=i.isFocused,l=i.customContext,u=n.getWhollySelectedRegions().entireTable,d=Object(ie.useState)(!1),h=ne()(d,2),f=h[0],p=h[1],g=Object(ie.useState)(0),m=ne()(g,2),v=m[0],b=m[1],y=be()("ace-table-wrapper-outer",(t={"ace-table-add-remove-shown":s,"ace-table-is-focused":c,"ace-table-header-hovered":l.isHovering||u},me()(t,se.i,!0),me()(t,se.j,f),t)),E=function(e){var t=e.target,n=Object(Ve.f)(t,"tb-scrollable-content"),i=window.getSelection();n&&i&&i.removeAllRanges(),o(e)};return ve.a.createElement("div",{ref:r,className:y,onMouseDown:E},ve.a.createElement(We.D,{className:"not-display-enter"}),ve.a.createElement("div",{className:"ace-table-wrapper",ref:a},Ze(n,{setTableScrollWidth:b}),Ye(n,{setDeleteFlag:p,tableScrollWidth:v})))}function Ge(e){var t=e.state,n=e.zoneBlockMinWidthMap,i=t.hintColsToDeleteCount,r=t.columnWithRightBorderHighlighted,o=t.rowHeaderHeights,a=t.colHeaderWidths,s=t.columnBeingResized,c=t.colAttribs,l=t.horzResizeDiff,u=t.colHeaderTypes,d=t.customContext,h=t.scrollLeft,f=e.updateCurrentHoverHeader,p=e.handleHeaderMouseDown,g=e.handleHorzResize,m=e.handleHorzResizeStart,v=e.handleHorzResizeEnd,b=e.handleResizeEnter,y=e.handleResizeLeave,E=e.getColMinWidth,O=e.getTableScrollWidth(),C=d.isCommentCross,k=d.fullWidth,I=d.docbodyRect,S=d.platform,T=d.containerRect,_=Object(re.a)({fullWidth:k,docbodyRect:I,tableTotalWidth:O,isCommentCross:C,scrollLeft:h,platform:S,containerRect:T}),w={hintColsToDeleteCount:i,columnHeaderColLeft:-h,marginLeft:_.marginLeft,marginRight:_.marginRight,rowHeights:o,columnWidths:a,onMouseDown:p,onMouseEnter:f,columnWithRightBorderHighlighted:r,horzResizeDiff:l,handleHorzResize:g,handleHorzResizeStart:m,handleHorzResizeEnd:v,handleResizeEnter:b,handleResizeLeave:y,columnBeingResized:s,colAttribs:c,colHeaderTypes:u,isCommentCross:C,getColMinWidth:E,zoneBlockMinWidthMap:n};return ve.a.createElement(Fe,Object.assign({},w))}function Ze(e,t){var n=e.state,i=e.getTableScrollWidth,r=e.handleScrollableScroll,o=e.handleScrollableResize,a=e.setTableWrapperInnerRef,s=e.getColsZoneId,c=e.getEditor,l=e.getTableId,u=e.tableRectInfo,d=n.customContext,h=i(),f=Object.assign({onScroll:r,onResize:o,ref:a,editor:c(),className:"ace-table-wrapper-inner",colAttribs:n.colAttribs,tableTotalWidth:h,customContext:d,tableRectInfo:u,colsZoneId:s(),tableId:l()},t);return ve.a.createElement(ge,Object.assign({},f),qe(e))}function qe(e){var t=e.state,n=e.setTableRef,i=e.setTbodyRef,r=e.setCellRef,o=e.handleVertResizeEnd,a=e.horizontalScrollToZone,s=e.handleHorzResize,c=e.handleHorzResizeStart,l=e.handleHorzResizeEnd,u=e.handleVertResizeStart,d=e.handleVertResize,h=e.getTableColsWidth,f=e.handleContentResize,p=e.setCurrentHoverOfZone,g=e.setHighlightColumn,m=e.getRectOfZone,v=e.getDocbodyRect,b=e.selectEntireCell,y=e.focusAndCollapseSelectionOntoCellByZoneId,E=e.customStatus,O=e.getColMinWidth,C=e.zoneBlockMinWidthMap,k=e.getEditor,I=t.colIds,S=t.rowIds,T=t.rowAttribs,_=t.colAttribs,w=t.isDragging,j=t.selectedCellIds,M=t.rowHeaderHeights,L=t.selectedCellColor,R=t.columnBeingResized,N=t.rowBeingResized,D=t.rowWithBottomBorderHighlighted,x=t.hintRowsToDeleteCount,P=t.hintColsToDeleteCount,B=t.cellAttribs,U=t.horzResizeDiff,z=t.rowBeingResizedHeights,H=t.columnWithRightBorderHighlighted,F=t.isSelectAll,V=t.colHeaderWidths,W=k(),K={colIds:I,rowIds:S,rowAttribs:T,colAttribs:_,isDragging:w,isAditDragging:E.isAditDragging,setTableRef:n,setTbodyRef:i,setCellRef:r,cellAttribs:B,horzResizeDiff:U,selectedCellIds:j,rowHeaderHeights:M,setHighlightColumn:g,selectEntireCell:b,setCurrentHoverOfZone:p,getDocbodyRect:v,getRectOfZone:m,isSelectAll:F,columnBeingResized:R,rowBeingResized:N,selectedCellColor:L,hintRowsToDeleteCount:x,hintColsToDeleteCount:P,rowBeingResizedHeights:z,horizontalScrollToZone:a,handleContentResize:f,handleHorzResize:s,handleHorzResizeStart:c,handleHorzResizeEnd:l,handleVertResize:d,handleVertResizeStart:u,handleVertResizeEnd:o,rowWithBottomBorderHighlighted:D,columnWithRightBorderHighlighted:H,columnWidths:V,focusAndCollapseSelectionOntoCellByZoneId:y,tableColsWidth:h().join(";"),getColMinWidth:O,zoneBlockMinWidthMap:C,tableMounted:e.getComponentMounted()};return ve.a.createElement(ve.a.Fragment,null,ve.a.createElement(Z,Object.assign({},K)),W.isEditable()&&Ge(e))}function Ye(e,t){var n=e.state,i=e.getComponentMounted,r=n.isFocused,o=n.isHovered,a=n.columnBeingResized;if(!i()||e.isEditingDisabled()||!r&&!o&&-1===a)return null;var s=n.hintColsToDeleteStartIndex,c=n.isDragging,l=n.hintColsToDeleteCount,u=n.selectType,d=n.rowsZoneId,h=n.scrollLeft,f=n.colIds,p=n.colsZoneId,g=n.rowIds,m=n.rowWithBottomBorderHighlighted,v=n.columnWithRightBorderHighlighted,b=n.rowHeaderHeights,y=n.colHeaderWidths,E=n.customContext,O=n.isSelectAll,C=n.colAttribs,k=n.horzResizeDiff,I=n.colHeaderTypes,S=n.selectedCellIds,T=e.getRowCount,_=e.getColCount,w=e.getTableWrapper,j=e.updateCurrentHoverHeader,M=e.deleteSelectedZones,L=e.addRowAtIndex,R=e.setHighlightRow,N=e.addColAtIndex,D=e.deleteTable,x=e.copyTable,P=e.cutTable,B=e.handleSelectCol,U=e.handleSelectRow,z=e.handleHeaderMouseDown,H=e.handleToggleSelectTable,F=e.setHighlightColumn,V=e.getTableRectInfo,W=e.getEditor,K=e.setTableHeaderRef,Z=e.handleHorzResize,q=e.handleHorzResizeStart,Y=e.handleHorzResizeEnd,J=e.handleResizeEnter,Q=e.handleResizeLeave,X=e.getScrollable,$=e.unselectAll,ee=e.select,te=e.getTableInnerWrapper,ne=W(),ie=e.getWhollySelectedRegions(),re=ie.entireTable,oe=ie.cols,ae=ie.rows,se=e.getPartiallySelectedRegions(),ce=se.partialRows,le=se.partialCols,ue=0===s&&l===f.length,de=ue?g.length:n.hintRowsToDeleteCount,he=e.getTableScrollWidth();function fe(){var e=X(),t=parseInt(e.dataset.width,10);return t||e.getBoundingClientRect().width}var pe=Object.assign({editor:ne,selectType:u,rowsZoneId:d,colsZoneId:p,scrollLeft:h,customContext:E,isDragging:c,isFocused:r,partialRows:ce,partialCols:le,tableTotalWidth:he,addColAtIndex:N,setHighlightColumn:F,deleteSelectedZones:M,addRowAtIndex:L,setHighlightRow:R,hintColsToDeleteCount:l,hintRowsToDeleteCount:de,selectedColumns:oe,selectedRows:ae,onCopyTable:x,onCutTable:P,rowCount:T(),colCount:_(),isSelectAll:O&&re,tableWrapper:w,rowHeights:b,onToggleSelect:H,hintTableToDelete:ue,onDeleteTable:D,columnWidths:y,onSelectCol:B,onSelectRow:U,onMouseDown:z,onMouseEnter:j,hoveringRowAdd:null!==m,hoveringColAdd:null!==v,columnWithRightBorderHighlighted:v,tableRectInfo:V(),tableRef:e.getTable(),getScrollTop:ne.getScrollTop,setTableHeaderRef:K,horzResizeDiff:k,entireTable:re,handleHorzResize:Z,handleHorzResizeStart:q,handleHorzResizeEnd:Y,handleResizeEnter:J,handleResizeLeave:Q,colAttribs:C,colHeaderTypes:I,scrollerWidth:fe(),unselectAll:$,select:ee,selectedCellIds:S},t),ge=te();return ve.a.createElement("div",{contentEditable:!1,className:be()("ace-table-toolbars",me()({},ye.b,!0)),onMouseEnter:ge.toggleScrollbarVisible,onMouseLeave:ge.toggleScrollbarVisible},ve.a.createElement(xe,Object.assign({},pe)))}n.d(t,"a",function(){return Ke})},YeJo:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lwsE"),o=n.n(i),r=n("W8MJ"),a=n.n(r),s=function(){function t(e){var r=this;o()(this,t),this.className="EditBarManage",this.aceInitialized=function(e,t){r.editorInfo=t.editorInfo,r.readWrite=!1},this.reset=function(){},this.changesetApply=function(e,t){t.insertsAfterSelection||r.notifyUserChangeContent(),r.handleToolbarStatus(t.attribs.attribsKey)},this.aceSelectionChanged=function(e,t){var n=t.callstack,i=t.attribs;"setup"===n.type||"importText"===n.type||"setBaseText"===n.type||n.isCollabChangedSelection||r.handleToolbarStatus(i.attribsKey)},this.handleToolbarStatus=function(e){r.editorInfo.call("toolBarStatusChange",e)},this.pluginReadOnly=function(){r.readWrite=!1},this.pluginReadWrite=function(){r.readWrite=!0},e&&(this.editor=e,this.aceInitialized("",Object.assign({editorInfo:e},e)))}return a()(t,[{key:"notifyUserChangeContent",value:function(){this.editorInfo.call("userChangeContent")}}]),t}();new s},Yj5g:function(e,t,n){},YlgD:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var i=n("VI6H"),r=function(e){return{userId:e.id,userName:e.name,avatarUrl:e.avatarUrl||Object(i.k)(e.id),description:e.description?e.description.text:"",descType:e.description?e.description.type:0,anonymous:Object(i.n)(e.id)}},o=function(e){return{id:e.userId,name:e.userName,avatarUrl:e.avatarUrl,description:e.description?{text:e.description,type:e.descType||0}:void 0}}},Yspk:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var i=n("nN3d");function r(e,t){var n=e.getRep(t).lines.totalWidth();return e.changesetHelper.builder(n)}function o(e){return Object(i.c)(e||6)}},Ysvc:function(e,t,n){"use strict";var i=n("7EGn"),r=n("iP/4"),o=function(r){var o,a=this;return function(){if(o)return o;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=r.apply(a,t);return o=i}};function a(){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split("."),n=e.split("."),i=Math.max(t.length,n.length),r=0;r<i;r++){var o=t[r],a=n[r];if(!a)return!0;if(!o)return!1;var s=Number(o),c=Number(a);if(s<c)return!1;if(c<s)return!0}return!0}function s(e,t){var n;r.a.isDocsSDK?r.a.android?n=e[0]:r.a.ios&&(n=e[1]):r.a.android?n=t[0]:r.a.ios&&(n=t[1]);var i=u();return!!n&&a(i,n)}n.d(t,"a",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"f",function(){return h}),n.d(t,"d",function(){return f}),n.d(t,"c",function(){return p}),n.d(t,"b",function(){return m});var c=o(function(){var e=window.navigator.userAgent;return Object(i.default)(e.match(/DocsSDK\/([0-9.]+)/i),"[1]")}),l=(o(function(){var e=c();return!!(e&&r.a.isLark&&(r.a.ios&&a(e,"1.3")||!r.a.ios&&a(e,"1.1.0")))}),o(function(){var e=c();return!!(e&&r.a.ios&&a(e,"1.7.0"))}));function u(){if(r.a.isDocsSDK)return c();var e=navigator.userAgent||"";return Object(i.default)(e.match(/Docs[^SDK/]*\/([0-9.]+)/),"[1]")}function d(){var e=u(),t="",t=r.a.isDocsSDK?r.a.android?"1.2.3":"1.8.2":"0.2.5";return(!r.a.isIOS||g())&&a(e,t)}function h(){var e=u(),t="";return!r.a.isDocsSDK||r.a.android?t="0.2.4":r.a.ios&&(t="1.8.0"),a(e,t)}function f(){return s(["1.12.99","1.9.1"],["0.2.7","0.2.7"])}function p(){if(r.a.isDocs){if(r.a.ios)return!0;var e=r.a.isDocsSDK?"1.12.99":"0.2.7";return a(u(),e)}return!1}function g(){return-1<location.protocol.indexOf("docsource")}function m(){return s(["1.15.99","1.9.4"],["0.3.0","0.3.0"])}s(["1.15.99","1.9.4"],["0.3.0","0.3.0"])},YwVb:function(e,t){e.exports='<div id="tablepicker" class="tablepick hidden">\n    <div class="tips">{{{insertSheet}}}</div>\n    <div class="unhighlight"></div>\n    <div class="highlight"></div>\n</div>\n'},"Z+RQ":function(e,t,n){},"Z/PY":function(e,me,ve){"use strict";(function(e){ve.d(me,"a",function(){return T}),ve.d(me,"w",function(){return L}),ve.d(me,"x",function(){return R}),ve.d(me,"y",function(){return N}),ve.d(me,"u",function(){return B}),ve.d(me,"v",function(){return U}),ve.d(me,"e",function(){return z}),ve.d(me,"E",function(){return H}),ve.d(me,"d",function(){return W}),ve.d(me,"n",function(){return K}),ve.d(me,"D",function(){return Z}),ve.d(me,"g",function(){return q}),ve.d(me,"p",function(){return J}),ve.d(me,"C",function(){return Q}),ve.d(me,"b",function(){return X}),ve.d(me,"i",function(){return $}),ve.d(me,"l",function(){return ee}),ve.d(me,"t",function(){return te}),ve.d(me,"j",function(){return ne}),ve.d(me,"s",function(){return ie}),ve.d(me,"r",function(){return re}),ve.d(me,"q",function(){return oe}),ve.d(me,"f",function(){return ae}),ve.d(me,"m",function(){return se}),ve.d(me,"c",function(){return ce}),ve.d(me,"B",function(){return le}),ve.d(me,"h",function(){return ue}),ve.d(me,"k",function(){return he}),ve.d(me,"o",function(){return fe}),ve.d(me,"A",function(){return pe}),ve.d(me,"z",function(){return ge});var t=ve("o0o1"),r=ve.n(t),n=ve("yXPU"),i=ve.n(n),o=ve("J4zp"),w=ve.n(o),a=ve("dtwz"),s=ve("yIs4"),c=ve("F294"),l=ve("CpTu"),j=ve("15MJ"),u=ve("2ACu"),d=ve("+Xq6"),h=ve("3doy"),f=ve("skFV"),p=ve("VIFs"),g=ve("kUgE"),m=ve("BpSZ"),v=ve("lQZd"),b=ve("6O0K"),y=ve("jJw9"),E=ve("EVj1"),O=ve("dDhe"),C=ve("cGQV"),k=ve("rLED"),I=ve("wMS7"),S=ve.n(I);function T(){Object(b.a)(e("anonymous.paste_toast_with_login"))}var _=1280,M=730;function L(e){if(e){var t=e.src,n=e.file_token;if(!n)return Object(y.replaceImageDataSrc)(decodeURIComponent(t).replace(/\/\/file/,"/file"));var i=$(n);return Object(O.c)()?P(i):i}return null}function R(e){if(e){var t=e.src;return!!e.file_token?D(e):Object(y.replaceImageDataSrc)(decodeURIComponent(t).replace(/\/\/file/,"/file"))}return null}function N(e){if(!e)return!1;var t=e.size;if(!!!e.file_token)return!1;if(!t||!Object(s.default)(+t))return!1;var n=Object(k.M)("gif_load_icon_limit_value",Number.MAX_SAFE_INTEGER);return!!n&&n<+t}function D(e){if(!e)return null;var t=e.file_token;if(!!!t)return null;var n=Object(a.a)($,P)(t);return n?N(e)?x(n):n:null}function x(e){return e?e.replace("/all/","/v2/cover/"):null}function P(e){if(!e)return null;var t=Object(E.k)(e,!0),n=t.pathname,i=t.search,r=t.hash,o="".concat(n).concat(i).concat(r),a=Object(c.a)(Object(f.i)())||Object(c.a)(Object(f.r)());if(!a)return console.error("get api domain faild."),null;var s="https://".concat(a);return"".concat(s).concat(o)}function B(e){return e&&e.includes("pluginName="+j.s)}function U(e,t,n){var i=n.getAllAttributesOnLine(e,t);return!!Object(l.a)(i,function(e){return j.t.includes(e[0])})}function z(e){var t,n="";for(t in e)n+="".concat(t,"=").concat(e[t],"&");return n.slice(0,n.length-1)}function H(e){return void 0===e||"undefined"===e||"null"===e?void 0:e}function F(e,t){var n="t"===e[0]?-1:1,i="l"===e[1]?-1:1;return{width:t.width*i,height:t.height*n}}function V(e){return e/Math.abs(e)}function W(e){for(var t=e.direction,n=e.alignment,i=e.imageSize,r=e.moveVector,o=e.imageMaxWidth,a=F(t,i),s=[V(a.width),V(a.height)],c=r.x,l=r.y,u="center"===n?2:1,d=i.width/u,h=i.height,f=a.width/u,p=a.height,g=o/u,m=f*p<0?-1:1,v=l*f*m<p*c*m,b=0,y=[["left","tr","top"],["center","tl","top"],["center","tr","top"],["right","tl","top"],["left","bl","side"],["right","br","side"]];b<y.length;b++){var E=y[b];E[0]===n&&E[1]===t&&(v="top"===E[2])}var O=(v?[f+c,p*(f+c)/f]:[f*(p+l)/p,p+l]).map(function(e,t){return e*s[t]}),C=w()(O,2),k=C[0],I=C[1],S=[d*u<h?j.m/u:j.m*d/h,d*u<h?j.m/u*h/d:j.m],T=[g,g*h/d],_=[Math.round(Math.min(T[0],Math.max(S[0],k))),Math.round(Math.min(T[1],Math.max(S[1],I)))];return{width:_[0]*u,height:_[1]}}function K(e,t,n){var i=n.split(".").pop()||"unknown";Object(u.default)("mention_drag_upload",{upload_status:e||"fail",mention_file_length:t,mention_file_type:i})}function Z(e,t){return parseFloat(Number(e).toFixed(t))}function q(e){return Y.apply(this,arguments)}function Y(){return(Y=i()(r.a.mark(function e(t){var i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t)return i=new Image,e.abrupt("return",new Promise(function(n){i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;var t=e.getContext("2d");t&&(t.drawImage(i,0,0,e.width,e.height),n(e.toDataURL()))},i.src=t}));e.next=3;break;case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J(e){var t=Object(f.h)();return new RegExp("^https?:\\/\\/[\\w\\-._]+\\.(".concat(t.map(function(e){return e.replace(/\./g,"\\.")}).join("|"),")\\/space\\/api\\/")).test(e)}function Q(e){var t=null;if(e)try{t=JSON.parse(e)}catch(e){}return t}function X(e){try{e=decodeURIComponent(e)}catch(e){}return!!e&&/^(?:([A-Za-z]+):){1}(?:\/\/([.\-\w]+)){1}(?::(\d+))?(\/[^?#<>"']*)?(\?[^#<>"']*)?(#[^<>"']*)?$/.test(e)}function $(e,t){t=t||Object(v.g)();var n={mountPoint:{type:h.MountPointType.DOC_IMAGE,token:t}};return Object(d.h)(e,n)}function ee(){var e=Object(g.getLanguage)();return j.o[e]||j.n}function te(e){return!(!e||Object(m.b)(e))&&(!Object(p.isDocUrl)(e)||!ie(e)&&!re(e))}function ne(e){return e?"drive":"doc"}function ie(e){return j.d.test(e)}function re(e){return j.c.test(e)}function oe(e,t){return _<t&&e*_/t<M}function ae(e,n){var t=e.getMatchedAttributePositionOnSelection(null,function(e,t){return"image-previewer"===e&&n(Object(C.c)(t))});return 0<t.length?t[0].docPosition:null}function se(e,t){var n=Object(s.default)(e)?e:parseFloat(e),i=Object(s.default)(t)?t:parseFloat(t);return isNaN(n)||isNaN(i)||i<=0||n<=0?1:n/i}function ce(e){var t="#ssrBox #container-wrap-".concat(j.u,"-image-").concat(e," img");return!!document.querySelector(t)}function le(e){return S.a.sanitize(e,{SAFE_FOR_JQUERY:!0,ALLOW_DATA_ATTR:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ADD_ATTR:["contenteditable"]}).replace(/data-faketext=""/g,'data-faketext=" "')}function ue(e){return de.apply(this,arguments)}function de(){return(de=i()(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(decodeURIComponent(t),{credentials:"include"});case 3:return n=e.sent,e.next=6,n.blob();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:return e.abrupt("return");case 13:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}function he(e){return e&&Object.keys(e).find(function(e){return"gallery"===e||"image-uploaded"===e})}function fe(e){return/^comment-(id|resolved|deleted)-[0-9]+$/.test(e)}function pe(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{transformSrc:!0},i=[];return"gallery"===e?i=ge(t).items||[]:"image-uploaded"===e&&(i=[Object(C.c)(t)]),n.transformSrc&&i.forEach(function(e){e.src=L(e)}),i}function ge(e){var t={};try{t=JSON.parse(e)}catch(e){console.error("attrObj gallery is not json string:",e)}return t}}).call(this,ve("2vAP"))},Z2VF:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s});var i=n("toa8"),r=n("AESI"),o=n("lQZd"),a=function(e){return Object(i.d)({url:r.BOX_IMAGE_CREATE,method:"post",headers:{"Content-Type":"application/json"},data:{url:e,mount_node_token:Object(o.g)(),mount_point:"doc_image"}})},s=function(e){return Object(i.d)({url:r.BOX_IMAGE_CHECK,method:"post",headers:{"Content-Type":"application/json"},data:{code_list:e}})}},Z5sO:function(e,t,n){"use strict";function i(e){if(window.requestIdleCallback)return window.requestIdleCallback(e);var t=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})})}function r(e){return window.cancelIdleCallback?window.cancelIdleCallback(e):clearTimeout(e)}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r})},Z6pE:function(e,t,n){},ZKUE:function(e,t,n){"use strict";function i(e,t){var n=e.getImageState,i=e.setImageState,r=n().selectedImageSet,o=new Set(r);o.clear(),o.add(t),i({selectedImageSet:new Set(o)})}n.d(t,"a",function(){return i})},ZLFf:function(e,t,n){"use strict";var i=n("o0o1"),r=n.n(i),o=n("yXPU"),a=n.n(o),s=n("lwsE"),c=n.n(s),l=n("W8MJ"),u=n.n(l),d=n("Ngi8"),h=(n("Z+RQ"),new(function(){function e(){var t=this;c()(this,e),this.opened=!1,this.animation=!1,this.onAnimationEnd=function(e){e.target===t.overlay&&(t.opened?t.removeOverlay():t.handleOpened&&t.handleOpened(),t.opened=!t.opened)}}function t(){return n.apply(this,arguments)}var n;return u()(e,[{key:"createForFullScreen",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length?arguments[2]:void 0;this.overlay&&this.removeOverlay(),this.animation=t,this.handleOpened=n;var i=document.createElement("div"),r=document.getElementById("mainContainer")||document.body;return e&&(r=document.querySelector(".create-by-template__container")||r),Object.assign(i.style,{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"100",backgroundColor:d.N00}),i.className="layout-column flex",this.animation&&(t&&i.classList.add("fullscreen-open"),t&&i.addEventListener("animationend",this.onAnimationEnd)),r.appendChild(i),this.overlay=i}},{key:"createForHistory",value:function(){var e=document.createElement("div"),t=document.getElementById("mainContainer");return Object.assign(e.style,{position:"fixed",top:"0",left:"0",right:"0",bottom:"0",zIndex:"88",backgroundColor:"rgba(31, 35, 41, 0.6)"}),t.appendChild(e),e}},{key:"remove",value:(n=a()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.overlay,this.animation)return t&&t.classList.add("fullscreen-close"),e.abrupt("return");e.next=4;break;case 4:this.removeOverlay();case 5:case"end":return e.stop()}},e,this)})),t)},{key:"removeOverlay",value:function(){this.overlay&&this.overlay.parentElement&&this.overlay.parentElement.removeChild(this.overlay),this.overlay=null}}]),e}()));t.a=h},ZLpy:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return g});var a=n("AiBH"),i=n("hMnB"),r=n.n(i),o=n("rLED"),s=!function(){return["larksuite.com","larksuite-staging.com"].some(function(e){return-1<r.a.hostname.indexOf(e)})}(),c=["youtube","gmaps","tiktok","vimeo","instagram","facebook","googleDrive","datastudio","oneDrive","imgur","soundcloud","slideshare","speakerdeck","lark_survey"],l=["youku","bilibili","autonavi","baidumap","xigua","modao","canva","feishu_survey","jinshuju"],u=c.reduce(function(e,t){return e[t]=!0,e},{}),d=l.reduce(function(e,t){return e[t]=!0,e},{});function h(){return"1"===window.User.tenantId}var f=function(e){if(!e)return!1;if(h())return!0;if(e=e.replace(/Code$/,""),s){if(c.includes(e))return!1}else if(l.includes(e))return!1;return!0};function p(e,t){var n=Object(o.x)();return n&&n.length?e.filter(function(e){return!n.includes(t(e))}):e}function g(e){var n,t=e.inChina,i=e.isBytedance,r=e.list,o=e.getKey;return p(i?r.filter(function(e){return o(e)!==a.b.LARK_SURVEY}):(n=t?u:d,r.filter(function(e){var t=o(e);return!n[t]})),o)}},ZMP9:function(e,I,S){"use strict";S.r(I),function(n){S.d(I,"ContactUsButton",function(){return k});var e=S("o0o1"),t=S.n(e),i=S("yXPU"),r=S.n(i),o=S("lwsE"),a=S.n(o),s=S("W8MJ"),c=S.n(s),l=S("a1gu"),u=S.n(l),d=S("Nsbk"),h=S.n(d),f=S("7W2i"),p=S.n(f),g=S("cDf5"),m=S.n(g),v=S("q1tI"),b=S.n(v),y=S("jtRX"),E=S("4PSP"),O=S("xKvl"),C=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},k=function(e){function t(e){return a()(this,t),u()(this,h()(t).call(this,e))}return p()(t,e),c()(t,[{key:"onClick",value:function(){Object(y.b)()}},{key:"render",value:function(){return b.a.createElement("button",{key:"btn1",className:"modal__action modal__extra",onClick:this.onClick},n("common.contact"))}}]),t}(b.a.PureComponent);C([Object(E.Bind)(),Object(O.b)("click_contact_customer_service",r()(t.a.mark(function e(){return t.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{source:"file_open",withFileInfo:!0});case 1:case"end":return e.stop()}},e)})))],k.prototype,"onClick",null)}.call(this,S("2vAP"))},ZrCh:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"c",function(){return h}),n.d(t,"a",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"h",function(){return g}),n.d(t,"f",function(){return m});var i=n("RIqP"),r=n.n(i),o=n("4HEM"),a=n("/CvD"),s=n("4X5c"),c=420;function l(e){var t=Object(o.a)({editor:e});if(!t)return{};var n={},i=t.bottom,r=(t.left+t.right-c)/2;return n.left=0<=r?r:0,n.top=i+10,n}function u(e){switch(e.contentType.toLowerCase()){case"text":return a.a.Text;case"number":return a.a.Number;case"date":return a.a.DateTime;case"single_option":return a.a.SingleSelect;case"multiple_option":return a.a.MultiSelect;default:return a.a.NotSupport}}var d=function(e){return e.map(function(e,t){return Object.assign({},e,{color:t+1})})};function h(e,t){var n=function(e){return e.id===t};return e.find(n)}function f(e,t,n){var i,r,o=h(e,n),a=h(t,n);return o&&(i=o.value),a&&(r=a.value),i!==r}function p(e,t){return s.a[e]||t[0]}var g=function(e){return e.sort(function(e,t){return e.sort.toString().localeCompare(t.sort)})};function m(e,t){return e.property||(e.property={options:{}}),e.property.options.selectOptions||(e.property.options.selectOptions=[]),Object.assign({},e,{property:Object.assign({},e.property,{options:Object.assign({},e.property.options,{selectOptions:[].concat(r()(e.property.options.selectOptions),[{name:t,id:t,color:e.property.options.selectOptions.length+1}])})})})}},ZuTZ:function(e,t,n){"use strict";n.d(t,"b",function(){return S}),n.d(t,"a",function(){return T});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("cDf5"),p=n.n(f),g=n("q1tI"),m=n.n(g),v=n("y2sV"),b=n("V2TW"),y=n("FJEn"),E=n("4PSP"),O=n("56Fm"),C=n("TSYQ"),k=n.n(C),I=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},S="op-symbol",T=function(e){function n(e){var t;return r()(this,n),(t=c()(this,u()(n).call(this))).isFirstTimeToPaste=!1,t.editor=e,t}return h()(n,e),a()(n,[{key:"match",value:function(e){return"author"===e&&!Object(O.f)()}},{key:"editorWillPaste",value:function(){var e=this.editor.clipboard.getPasteInfo(),t=e.pasteFrom,n=e.pasteTimes;this.isFirstTimeToPaste=1===n&&"cut"===t}},{key:"aceEditEvent",value:function(){this.isFirstTimeToPaste=!1}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(!(t instanceof HTMLElement))return n;var r=t.className,o=n,a=Object(b.a)(r);return a&&(o=Object(v.H)(o,i,{author:a})),o}},{key:"acePreWriteDomLineHTML",value:function(e,t){t&&t.info&&t.info.zone===y.DEFAULT_REP_ZONE&&(t.isPocket=!0,t.isPocketWithoutFakeText=!0)}},{key:"editorWillApplyChange",value:function(e){var t=e.deltaSet,n=e.options;if(n&&n.isRemote)return t;var i=this.editor.callStack.getCurrentCallStack()||{},r=i.type,o=void 0===r?"":r,a=i.editEvent,s=void 0===a?{}:a;if("applyDrop"===o||"performImageStyle"===o||"dropImageEvent"===o||"updateBlockProps"===o||"comment"===o||"undo"===o||"handleKeyEvent"===o&&"undo"===s.eventType||o.startsWith("align")||"insertZoneByCommand"===s.eventType||this.isFirstTimeToPaste)return t;var c=Object(b.b)();return t.forEach(function(e){e instanceof v.E&&e.forEach(function(e){e.insert&&(e.attributes=e.attributes||{},e.attributes.lmkr?delete e.attributes.author:e.attributes.author=c)})}),t}},{key:"render",value:function(e){var t=e.attributes,n=e.children,i=k()("".concat(Object(O.a)(t.author)," ").concat(S));return m.a.createElement(v.w,{className:i},n)}}]),n}(v.p);I([Object(v.J)(1e4),Object(E.Bind)()],T.prototype,"deserialize",null)},ZvLv:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n.n(f),g=n("TSYQ"),m=n.n(g),v=n("UlbS"),b=n("FI0B"),y=n("HmyT"),E=function(e){function t(){var n;return r()(this,t),(n=c()(this,u()(t).apply(this,arguments))).handleToggleRef=function(e,t){n.hideTooltip=t},n}return h()(t,e),a()(t,[{key:"render",value:function(){var t=this,e=this.props,n=e.className,i=e.tooltip,r=e.container,o=e.etherpadContainer,a=m()(n,{"hpx-button":!0}),s=["bottom"],c=[!0,"check-viewport"],l={padding:"4px 6px",pointer_events:"none"};return p.a.createElement(v.Tooltip,{title:i,placement:"bottom",tooltipClassName:"ignore-dom editor_toggle_button",adjustPlacements:s,adjustOverflow:c,getContainer:function(){return Object(y.$)(document.body).hasClass("fs-mode-non-paged")?r:o||null},style:l,onTooltipMouseEnter:function(e){setTimeout(function(){t.hideTooltip()},0)},toggleRef:this.handleToggleRef,gap:3,showDelay:500},p.a.createElement("button",{className:a,disabled:e.disabled,onClick:e.onClick,dir:"auto","data-track-title":e["track-title"]},p.a.createElement("span",{className:"dmc-button-content"},p.a.createElement("span",{className:"icon-wraper"},p.a.createElement(b.a,null)))))}}]),t}(f.PureComponent);t.a=E},Zz26:function(e,t,n){},aPFL:function(e,d,h){"use strict";(function(l){var e=h("lwsE"),n=h.n(e),t=h("W8MJ"),i=h.n(t),o=h("HmyT"),r=h("cgIo"),a=h("YwVb"),s=h.n(a),c=15,u=function(){function t(e){var c=this;n()(this,t),this.handleCalcHighlightRect=function(e){var t=e.clientX-c.editorbarRectLeft+10,n=c.rectificationNumber(Math.floor(t/16)),i=e.clientY-c.editorbarRectTop,r=c.rectificationNumber(Math.floor(i/16)-1),o=16*n,a=16*r;c.highlight.css({width:"".concat(o,"px"),height:"".concat(a,"px")});var s=l("etherpad.insert_sheet");r&&n&&(s="".concat(l("etherpad.insert")).concat(n,"X").concat(r).concat(l("etherpad.sheet")),c.x=n,c.y=r),c.tips.text(s)},this.context=e,this.editorBar=Object(o.$)("[data-key=sheet]"),this.popupContainer=Object(o.$)(".doc-popup-container"),this.display=!1,this.x=0,this.y=0,Object(o.$)("#tablepicker").length||this.createTablePicker(),this.tablePicker=Object(o.$)("#tablepicker"),this.$window=Object(o.$)(window),this.highlight=this.tablePicker.find(".highlight"),this.tips=this.tablePicker.find(".tips"),this.tablePicker.off("mousemove",this.handleCalcHighlightRect),this.tablePicker.on("mousemove",this.handleCalcHighlightRect)}return i()(t,[{key:"destory",value:function(){this.tablePicker.off("mousemove",this.handleCalcHighlightRect),this.context=null,this.editorBar=null,this.popupContainer=null,this.tablePicker=null,this.$window=null,this.highlight=null,this.tips=null}},{key:"handleClickHighLight",value:function(){return this.hide(),{x:this.x,y:this.y}}},{key:"rectificationNumber",value:function(e){return e<0?0:9<e?9:e}},{key:"getTableHeight",value:function(){return this.tableHeight||(this.tableHeight=this.tablePicker.height()),this.tableHeight}},{key:"toggleDisplay",value:function(e){var t;e.handleShowPicker&&e.showPicker||!e.handleShowPicker&&this.tablePicker.hasClass("hidden")?(t=this.calcPosition(e),this.tablePicker.css({left:"".concat(t.left,"px"),top:"".concat(t.top,"px")}),this.show()):this.hide(),this.resetStatus()}},{key:"resetStatus",value:function(){this.x=0,this.y=0,this.tips.text(l("etherpad.insert_sheet")),this.highlight.css({width:0,height:0})}},{key:"calcPosition",value:function(e){var t,n,i,r;return e.pos?(this.editorbarRectLeft=e.pos.left,this.editorbarRectTop=e.pos.top):(t=Object(o.$)("[data-key=sheet]").get(0).getBoundingClientRect(),this.editorbarRectLeft=t.left-77+16,n=t.height+10,i=this.$window.height()-t.height-t.top,r=this.getTableHeight(),this.editorbarRectTop=r+c<i?t.top+n:t.top-r-c),{left:this.editorbarRectLeft,top:this.editorbarRectTop}}},{key:"show",value:function(){this.tablePicker.removeClass("hidden"),this.display=!0}},{key:"hide",value:function(){this.tablePicker.addClass("hidden"),this.display=!1}},{key:"createTablePicker",value:function(){Object(o.$)(Object(r.a)(s.a)({insertSheet:l("etherpad.insert_sheet")})).appendTo(this.popupContainer)}}]),t}();d.a=u}).call(this,h("2vAP"))},aWXl:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var f=n("aBgF"),p=n("Tqb2"),g=n("FVmk"),m=n("zy84"),i=function(e,t,n){var i=e.evt,r=i.keyCode,o=t.selection.getSelection(),a=o.start,s=a.line,c=a.zoneId,l=r===f.c.Delete,u=r===f.c.BackSpace;if(l||u){if(o.isCollapsed()){if(!(l?Object(p.N):Object(p.O))(o,t))return!1;var d=s+(l?1:-1),h=t.getContentState().getZoneState(c).getLine(d);return h&&Object(p.L)(h)?(i.preventDefault(),i.stopPropagation(),u&&Object(g.e)(o,t),Object(g.f)(h,t,n),!0):!1}if(Object(m.a)(n.getImageState(),t))return i.preventDefault(),i.stopPropagation(),!0}return!1}},ac4d:function(e,t,n){},afrW:function(e,He,Fe){"use strict";(function(Z){Fe.d(He,"a",function(){return ze});var e,t,n,i,r,o,a,s=Fe("RIqP"),d=Fe.n(s),c=Fe("J4zp"),h=Fe.n(c),l=Fe("o0o1"),f=Fe.n(l),u=Fe("yXPU"),p=Fe.n(u),g=Fe("lwsE"),m=Fe.n(g),v=Fe("W8MJ"),b=Fe.n(v),y=Fe("U+yc"),E=Fe.n(y),O=Fe("xWuZ"),C=Fe("NxIb"),k=(Fe("Geka"),Fe("YWBl")),I=Fe("7Kxq"),q=Fe("cGQV"),S=Fe("M8cP"),Y=Fe("15MJ"),T=Fe("RvHS"),_=Fe("nVH4"),w=Fe("7EGn"),j=Fe("hbEN"),M=Fe("Muja"),L=Fe("HIeq"),J=Fe("Z/PY"),R=Fe("xYHj"),N=Fe("YNKm"),D=Fe("/P/v"),x=Fe("0bqa"),P=Fe("5e3X"),B=Fe("HmyT"),U=Fe("2ACu"),z=Fe("GIL9"),Q=Fe("iP/4"),H=Fe("/spq"),F=Fe("Ysvc"),W=Fe("nN3d"),V=Fe("n/R6"),K=Fe("FJEn"),X=Fe("aBgF"),$=Fe("4PSP"),ee=Fe("VIFs"),te=Fe("Cy2Z"),ne=Fe("1dfU"),ie=Fe("dDhe"),re=Fe("TgJx"),oe=Fe("SQ87"),ae=Fe("Ms4L"),se=Fe("+Xq6"),ce=Fe("lQZd"),le=Fe("7P1s"),ue=Fe("dtwz"),de=Fe("QM+C"),he=Fe("Brof"),fe=Fe("AESI"),pe=Fe("2spZ"),ge=Fe("wMS7"),me=Fe.n(ge),ve=Fe("oJoF"),be=Fe("kESg"),ye=Fe("+4eN"),Ee=Fe("rLED"),Oe=Fe("YWjA"),Ce=Fe("y2sV"),ke=Fe("Di24"),Ie=Fe("D28M"),Se=Fe("+c5q"),Te=Fe("Tqb2"),_e=Fe("cVBB"),we=Fe("n2k8"),je=Fe("56Fm"),Me=Fe("TqgO"),Ae=Fe("j1lG"),Le=Fe("4+Yg"),Re=.625,Ne={},De='<svg class="circular" viewBox="25 25 50 50"><circle\n  class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4"\n  stroke-miterlimit="10"></circle></svg>|';function xe(e){e.preventDefault()}function Pe(r){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4;return new Promise(function(n,e){var t=setTimeout(function(){clearTimeout(t),t=null,e(new Error("timeout"))},o),i=new Image;i.onload=function(){var e=i.width,t=i.height;n({width:e,height:t})},i.onerror=e,i.src=r})}function Be(e){var t=e.uuid,n=e.width,i=e.height,r=e.taskId,o=e.externalLoading,a=e.externalImgId,s=e.imageSrc,c=e.pointsHTML,l=e.author,u=(u=i&&parseInt(i)/parseInt(n)*100)||66.6666667,d="position:relative;width:".concat(parseInt(n),"px;max-width:100%;"),h='<i class="image-loading layout-main-cross-center loading-play" data-selector="height-jack"'+'style="padding-top:'.concat(u,'%;width:100%;height:100%;background:transparent">')+De.slice(0,De.length-1)+"</i>",f='<div data-selector="height-jack" style="padding-top:'.concat(u,'%"></div>')+"<div id='".concat(Y.u,"-holder-").concat(t,"' class='upload-progress flex' contenteditable='false'>")+'<span class="upload-progress-bar" contenteditable="false"></span></div>',p='<div class="placeholder-wrap layout-main-cross-center" style="'.concat(d,'">')+(o?h:f)+"</div>",g=r?"data-task=".concat(r):"",m=a?'data-external-id="'.concat(a,'"'):"",v=!n||!i,b='<div draggable="false" id="container-wrap-'.concat(Y.u,"-image-").concat(t,'"\n    class="image-container-wrap with-loading">')+"<div id='".concat(Y.u,"-image-").concat(t,"'\n      class='image-container ").concat(m?"external-preview":"","\n      ").concat(l?Me.f+" "+Object(je.a)(l):"","'>")+"<img data-uuid=".concat(t,' src="').concat(s,'" ').concat(g," ").concat(m,' data-width="').concat(n,'"\n         data-height="').concat(i,'" style="position:absolute;left:0;top:0;').concat(v?"display:none":"",'" />')+"".concat(c).concat(p)+"</div></div>";return Object(J.B)(b)}function Ue(e,t,n){t=parseInt(t);var i=(parseInt(n)||t)/t*100,r=Object(B.$)("#".concat(Y.u,"-image-").concat(e));r.find(".placeholder-wrap").css({width:"".concat(t,"px")}),r.find("img").show(),r.find('[data-selector="height-jack"]').css({paddingTop:"".concat(i,"%")})}var ze=(e=Object(H.a)(["initEvent","markNodeClean","initImageView","initUploader","log","aceKeyEvent","aceAfterCompositionEnd","handleAfterImgLoaded","viewportChange","handleImageAlignFullChange","decryptImgDidUpdate","regist","reset"]),t=Object($.Bind)(),n=Object($.Throttle)(500),i=Object($.Bind)(),r=Object($.Debounce)(300),e((a=function(){function u(e){var V=this;m()(this,u),this.className="ImageUpload",this.pluginId=Object(L.b)(),this.isInPresentationMode=!1,this.gifImageSrcMap={},this.gifUuidList=[],this.activeGifList=[],this.lastContainerScrollTop=0,this.isInHistory=!1,this.toolbarVisible=!1,this._externalImageSaver=null,this._loadingBackground={},this.driveImageEnable=!0,this.externalImgHintEnable=Object(Ee.I)("enable_external_img_hint"),this.searchStringRange=function(e,t){var n=t.attributeMap;(n.gallery||n["image-placeholder"]||n["image-uploaded"]||n["image-previewer"])&&(t.isSearchable=!1)},this.debounceResize=Object(j.default)(this.onDocumentResizeWidthChange(this.handleImageAlignFullChange.bind(this)),500),this.getImgRequestConfig=function(e){var t=e.file_token,n=e.src,i=e.cdn_url,r=e.thumbnail_cdn_url,o=e.webp_thumbnail_cdn_url,a=e.decrypt_key,s=e.image_type,c=e.forceLoadGifOrigin,l=void 0!==c&&c,u=e.uuid,d=t||V.getImageKey(n),h=Object(J.w)(e),f=Q.a.mobile&&Object(J.E)(o)||Object(J.E)(r)||Object(J.E)(i),p=l||V.checkLoadOriginPicture(e);return{key:d,cdnUrl:f,decryptKey:a,pluginId:V.pluginId,originSrc:h,keyUrl:Object(ee.prependAPI)("/api/file/get"),fileToken:t,driveFetchCdnUrl:Object(ee.prependAPI)("/api/box/file/cdn_url/"),coverOptions:p?{platform:"pc"}:{platform:"pc",type:"cover"},originMimeType:s,forceLoadGifOrigin:l,uuid:u}},this.checkLoadOriginPicture=function(e){var t=e.natrualHeight,n=e.natrualWidth,i=e.file_token,r=parseInt(t),o=parseInt(n),a=!1;return i&&Object(J.q)(o,r)&&(a=!0),!Object(J.y)(e)||a},this.isImgNeedDecrypt=function(e){var t=e.src,n=e.file_token,i=e.uuid,r=Object(F.e)(),o=n||Object(J.p)(t),a=Object(ie.c)()||Object(J.c)(i),s=r||Object(z.a)()||V.isInHistory||a,c=V.getUploadSrc(e),l=V.getIsLoadBySsr(t,i);return!s&&o&&!c&&!l},this.isGifNeedFetching=function(e){var t=(e||{}).uuid;return!(V.gifStatusMap[t]||{}).isFetching},this.handleMsgFromWorker=function(t){V.editorInfo.getObserver().withoutRecordingMutations(function(){var e=Ne[t.pluginId];e&&e._handleMsgFromWorker.call(e,t)})},this.switchGifImageSrc=function(e,t){var n,i,r,o;V.isInHistory||e&&(n=e.attr("data-src"),i=V.getImgUrlPath(n),r=V.gifResourceMap[i],o=e.parent().find(".".concat(Y.g)).hasClass(Y.f),r&&r[t]&&!o&&V.setSrcWithoutRecord(e,r[t]))},this.handleImageMouseEnter=function(e){var t,n,i,r,o,a,s,c=e.target,l=c.querySelector("img");l&&!P.b.getDragingState()&&(t=l.dataset.uuid,0!==(n=Object(Te.o)({uuid:t},V.editorInfo)).length&&(r=(i=n[0]).start,o=i.end,a={selStart:[r.line,r.offset,r.zoneId],selEnd:[o.line,o.offset,o.zoneId]},s=c.id,V.cancelHideSelectionPopup(),V.addGalleryHoverStyle(s),V._handleImageMouseEnterDebounce(a,s)))},this._handleImageMouseEnterDebounce=Object(j.default)(function(e,t){V.hoveredGalleryItemId=t;var n,i=e.selStart,r=e.selEnd,o=i[2];V.galleryComment&&(n={selStart:i,selEnd:r,selZone:i[2]},V.galleryComment.setSelectedImageUUID(V.selectedGalleryItemIdToImageUUID(t),n)),V.editorInfo.call("customPopupControl",{zoneId:o,status:!0,selStart:i,selEnd:r})},200),this.handleImageMouseLeave=function(e){Object(B.$)(".selection-popup--visible").length?V.deferHideSelectionPopup():(V._handleImageMouseEnterDebounce.cancel(),V.hoverGalleryTimer=setTimeout(x.a.removeGalleryHoverStyle,500))},this.deferHideSelectionPopup=function(){V.leaveTimer=window.setTimeout(function(){V.toolbarVisible&&V.editorInfo.call("customPopupControl",{status:!1}),x.a.removeGalleryHoverStyle(),V.hoveredGalleryItemId=null},500)},this.cancelHideSelectionPopup=function(){V.leaveTimer&&(clearTimeout(V.leaveTimer),V.leaveTimer=null,V._handleImageMouseEnterDebounce.cancel())},this.addGalleryHoverStyle=function(e){e&&(V.hoverGalleryTimer&&clearTimeout(V.hoverGalleryTimer),x.a.addGalleryHoverStyle(e))},this.handlePopupMouseEnter=function(){V.addGalleryHoverStyle(V.hoveredGalleryItemId),V.cancelHideSelectionPopup()},this.handlePopupMouseLeave=function(){V.deferHideSelectionPopup()},this.isPlaceholderSrc=function(e){return e.attr("src")===Y.p},this.handleDocRenderred=function(){for(var e=V.decodedImageList.shift();e;)V._handleMsgFromWorker(e),e=V.decodedImageList.shift()},this.collectText=function(e,t){var n=t.attributes;if(n&&n.some(function(e){return"gallery"===e[0]||"image-uploaded"===e[0]}))return"[".concat(Z("editorbar.image"),"]")},this.collectCommentTargetType=function(e,t){var n=t.node;if(-1<Object(w.default)(n,"children[0].className","").indexOf("image-uploaded"))return"image"},this.aceInitialized=function(e,t){V.ace=t,V.editorInfo=t.editorInfo,V.initUploader(t),V.initImageView(t),V.initEvent(t),V.regist(V.editorInfo),Q.a.firefox&&document.execCommand("enableObjectResizing",!1,!1),V.editorInfo.on(Y.l,V.markDecodeImage),V.editorInfo.on(ve.a,function(){return V.loadImagesOnMount()}),V.editorInfo.on(Ce.k.WILL_DELETE_FROM_CUT,V.handleCut),V.editorInfo.on(Ce.k.CONTENT_CHANGE,V.onEditorContentChange),V.editorInfo.on("editorbar:changedSelection",V.handleToolbarChangedSelection)},this.handleToolbarChangedSelection=function(e){var t=e.popupType,n=e.customPopup;t===_.d.IMAGE?V.toolbarVisible=n.visible:V.toolbarVisible=!1},this.markDecodeImage=function(e){V.decryptImages&&(V.decryptImages[e]={finished:!0})},this.isDisabled=function(){V.decryptImages={}},this.getSuiteData=function(e){return Object(se.d)(e)},this.logExternalImg=function(e){var t=Object(S.a)(e);V.log("doc_collect_image_extenal",{image_hostname:t})},this._getImgSizWithRetry=function(){var i=p()(f.a.mark(function e(t,n,i){var r,o,a,s,c=arguments;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=3<c.length&&void 0!==c[3]?c[3]:3,o=0;case 2:if(i&&n||!(o<r)){e.next=22;break}return e.prev=3,e.next=6,Pe(t);case 6:a=e.sent,n=a.width,i=a.height,e.next=19;break;case 11:if(e.prev=11,e.t0=e.catch(3),s=e.t0.message,console.error("get drive image size faild",t,e.t0),V.log("doc_paste_external_img_load_size",{status:"failed",msg:s,url:t,image_category:"drive"}),o+1!==r)return e.next=19,Object(pe.c)(5e3*(o+1));e.next=19;break;case 19:o++,e.next=2;break;case 22:return e.abrupt("return",{width:n,height:i});case 23:case"end":return e.stop()}},e,null,[[3,11]])}));return function(e,t,n){return i.apply(this,arguments)}}(),this._saveExternalImage=function(){var n=p()(f.a.mark(function e(s,t){var c,l,u,n,d,i;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.externalId,c=t.uuid,l=t.width,u=t.height,n=t.noSiz,d=Object(ce.g)(),n)return e.next=5,V._getImgSizWithRetry(s,l,u,1);e.next=9;break;case 5:i=e.sent,l=i.width,u=i.height,Ue(c,l,u);case 9:V.log("doc_paste_external_img_start",{src:s,image_category:"drive",width:l,height:u}),V._externalImageSaver.newTask(d,s,function(){var n=p()(f.a.mark(function e(t,n){var i,r,o,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==he.a.DONE)return e.abrupt("return",V._saveFaild(c,s));e.next=2;break;case 2:if(i="".concat(fe.DRIVE_DIRECT_DOWNLOAD).concat(n,"?mount_node_token=").concat(d,"&mount_point=doc_image"),r=Object(ee.prependAPI)(i,ee.API_TYPE.DRIVE_API),u&&l){e.next=10;break}return e.next=7,V._getImgSizWithRetry(r,l,u);case 7:o=e.sent,l=o.width,u=o.height;case 10:if(u&&l){e.next=12;break}return e.abrupt("return",V._saveFaild(c,r,"load size"));case 12:V._loadingBackground[r]=s,a={file:{},fileToken:n},V._replaceExternalImg(r,c,l,u,"success",a);case 15:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}());case 11:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),this._uuidCertainly=function(e){var t=V.ace.editorInfo,n=e.dataset.uuid||Object(W.c)(10),i=function(e,t){return-1<t.indexOf("uuid=".concat(n))};return 0<t.getMatchedAttributePositionOnSelection(null,i).length&&(n+=(new Date).getTime()),n},this.deserialize=function(e){var t,n=e.node,i=e.deltaSet,r=e.zoneId,o=V.editorInfo.clipboard.getPasteInfo(),a=o.pasteFrom,s=o.pasteTimes,c="cut"===a&&1===s,l=i;return n instanceof HTMLElement&&(t=n.tagName,n.classList.contains("gallery")?l=Object(ke.a)(n,i,r,c,V.needReplaceTokenMap):"IMG"!==t||Object(Ie.o)(n,"gallery")||(l=Object(ke.b)(n,i,r,c,{log:V.log,needReplaceTokenMap:V.needReplaceTokenMap,editor:V.editorInfo,uuidCertainly:V._uuidCertainly,editable:V.editable,tasks:V.tasks,driveImageEnable:V.driveImageEnable,saveExternalImage:V._saveExternalImage,suffixPixel:V.suffixPixel}))),l},this.aceBlur=function(){x.a.removeImageChooseStyle(),x.a.removeGalleryChoosedStyle()},this.aceSelectionChanged=function(e,t){var n,i,r=t.rep,o=r.selStart[0],a=r.lines.atIndex(o),s=[o,a.lineMarker],c=[o,a.width-1],l=r.attributeManager.getAttributesOnSelection(s,c,r),u=0;l.attribs.forEach(function(e){var t,n=h()(e,2),i=n[0],r=n[1];"image-uploaded"!==i?"gallery"!==i||(t=V.galleryComment&&V.galleryComment.getGallery(r))&&(u+=t.getImages().size):u++}),l.attribs.some(function(e){var t=h()(e,1)[0];return"gallery"===t||"image-uploaded"===t})||(V.selectedGalleryItemId=null),x.a.removeImageChooseStyle(),x.a.removeGalleryChoosedStyle(),r.selStart[0]!==r.selEnd[0]||0===u&&V.galleryComment?V.galleryComment&&V.galleryComment.setSelectedImageUUID(null):(n=a.lineNode,1===u?(i=Object(B.$)(n).find(".image-container").attr("id"),V.editable&&x.a.addImageChooseStyle(i),V.galleryComment&&V.galleryComment.setSelectedImageUUID(V.selectedGalleryItemIdToImageUUID(i))):1<u&&V.editable&&x.a.addGalleryChoosedStyle(V.selectedGalleryItemId))},this.execInsertImage=function(e){V.trigger(),Object(k.a)({action:"insertimage",op:I.f,source:e,eventType:"mouseclick"})},this.aceCreateDomLine=function(e,t){var n=t.spanClass,i=t.attrObj,r=t.index,o=t.zoneId;if(/key=gallery/.test(n)){t.editable=!1;var a=i.gallery||null,s=Object(J.z)(a).items||[];t.spanClass+=" image-uploaded ".concat(te.a.join(" ")),t.lineClass+=" "+te.b.join(" "),t.attributes["data-ace-gallery-json"]=a,t.rawHtml=V.createGalleryHtml(s,o,r)}else if(Object(J.u)(n)){t.editable=!1,n=n.replace(/pluginName=imageUpload\s*/,"pluginName=imageUpload");var c,l,u,d,h,f,p,g,m=i["image-uploaded"]||i["image-previewer"],v={externalLoading:"true"===(v=Object(q.c)(m)).externalLoading,externalId:v.externalId,isUnsupported:v.isUnsupported,src:V.itemSchema(v.src,"image_url"),width:V.itemSchema(v.width,"string"),height:V.itemSchema(v.height,"string"),uuid:V.itemSchema(v.uuid,"string"),taskId:V.itemSchema(v.taskId,"string"),fileToken:v.fileToken?V.itemSchema(v.fileToken,"string"):""},b=Object(J.b)(v.src)?"":"image-illegal";if(i["image-uploaded"]){try{c=Object(J.w)(v)}catch(e){c=Y.p}V.initDecryptImage(c),v.src=c;var y,E,O=v.width,C=v.height,k=v.imageType,I=void 0===k?"":k,S=v.uuid,T="image/gif"===I;S||(y=/uuid=([\w\d-]*)/,(E=n.match(y))&&(v.uuid=S=E[1]));var _,w=Object(J.c)(S),j=Y.q.map(function(e){return e.includes("c")?'<span class="point '.concat(e,'"></span>'):'<span class="point '.concat(e,' n-icon-dragable"></span>')}).join(""),M=I?"".concat(I.split("/").join("-"),"-container"):"",L=V.editorInfo,R=(V.isInHistory?document.querySelector(".doc-history-revert__content.innerdocbody, .history-list"):L.getInnerContainer()).offsetWidth,R=V.getContextWidth(R,o,L),N='\n<div class="history-deleted-mask">\n  <div class="history-deleted-mask_text">'.concat(Z("history.deleted"),"</div>\n</div>").trim(),D=V.checkShouldShowLoading(v),x=V.getImgSrc(v);(Object(ie.c)()||w)&&(_=Object(J.x)(v),x=w?Y.p:_,V.markDecryptImgLoadBySSR(c,S),T&&V.setLoadedGifResource(_,_)),v.isUnsupported&&(x=Object(J.l)()),V.imgPrerenderRegist(x,S,o,r);var P=("100%"===O||parseInt(O)>=R)&&D?'style="width:'.concat(R,"px;height:").concat(R*Re,'px"'):"",B=Re;isNaN(parseInt(C))||isNaN(parseInt(O))||(B=Object(J.D)(parseInt(C)/parseInt(O),6));var U=D?'<i class="image-loading layout-main-cross-center"\n            style="padding-top: '.concat(100*B,'%">\n            ').concat(De,"\n          </i>"):"",z=Q.a.modernIE?'contenteditable="false"':"";t.spanClass+=" image-uploaded";var H=V.getLoadGifIconHtml(v),F='<div draggable="false" id="container-wrap-'.concat(Y.u,"-image-").concat(S,'"\n        class="image-container-wrap image-container-wrap-old" data-fake-text="*"\n        ').concat(z,"><div id='").concat(Y.u,"-image-").concat(S,"'\n        class='image-container ").concat(M).concat(b,"'\n        ").concat(P,">").concat(H).concat(V.isInHistory?N:"").concat(U,'<img\n        class="ssr-reuse" id="ssr-reuse-').concat(S,'" data-width="').concat(O||"",'" data-height="').concat(C||"",'"\n        data-uuid=').concat(S,' data-src="').concat(c,'" src="').concat(x,'"\n        data-file-token="').concat(v.fileToken||"","\" style='width:").concat(O,";'/>").concat(j)+'<span data-zero-space="true">&#8203;</span></div></div>';t.rawHtml=Object(J.B)(F)}i["image-previewer"]&&(l=v.uuid,u=v.width,h=void 0===(d=v.height)?0:d,f=v.taskId,p=Y.q.map(function(e){return'<span class="point '.concat(e,"br"===e?' n-icon-dragable"></span>':'"></span>')}).join(""),g=V.getUploadSrc(v)||Y.p,t.spanClass+=" image-previewer",t.rawHtml=Be({uuid:l,width:u,height:h,taskId:f,imageSrc:g,pointsHTML:p,externalLoading:v.externalLoading,externalImgId:v.externalId,author:v.author}))}},this.imgPrerenderRegist=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:K.DEFAULT_REP_ZONE,i=3<arguments.length?arguments[3]:void 0,r={uuid:t},o=new ae.a(r),a=V.editorInfo.getRep(n).lines.atIndex(i);a.registerInstance(o);var s=e!==Y.p,c=a.key,l=a.zone;s&&c&&l&&V.bindFinalImgLoad(e,{key:c,zone:l})},this.bindFinalImgLoad=function(e,t){var n=t.key,i=t.zone,r=new Image;r.src=e;var o=Object(B.$)(r),a=function e(){o.off("load",e),o.off("error",s),V.notifyImgDidUpdate({key:n,zone:i})},s=function e(){o.off("load",a),o.off("error",e),V.notifyImgDidUpdate({key:n,zone:i})};o.on("load",a),o.on("error",s)},this.notifyImgDidUpdate=function(e){var t=e.key,n=e.zone;t&&n&&V.editorInfo.call(K.ASYNC_NODE_DID_UPDATE_EVENT,{key:t,zoneId:n})},this.getLoadedSrc=function(e){if(!e)return null;var t=e.image_type,n=e.uuid,i=Object(J.w)(e),r=V.decryptImages[i]||{},o=r.uuids,a=void 0===o?[]:o,s=r.blobUrl,c=a.includes(n),l="image/gif"===t,u=V.getImgUrlPath(i);return l?V.gifResourceMap[u]&&V.gifResourceMap[u].origin:c?V.getSsrSrc(e):s||V.getUploadSrc(e)},this.itemSchema=function(e,t){if(!e)return e;var n=/^(\w)*(-\.)*/g,i=/^[0-9]*$/g,r=/^[0-9]+(\.\d+)?(\w+|%)?$/g,o=/^(?:([A-Za-z]+):){1}(?:\/\/([.\-\w]+)){1}(?::(\d+))?(\/[^?#<>"']*)?(\?[^#<>"']*)?(#[^<>"']*)?$/,a="";switch(t){case"size":a=r;break;case"string":e=me.a.sanitize(e),a=n;break;case"number":a=i;break;case"url":case"image_url":a=o;try{e=decodeURIComponent(e)}catch(e){}if(e=unescape(e),"image_url"!==t)break;var s=e.match(/^data:image\/(jpg|jpeg|png|gif|ico);base64,/);if(s){var c=e.substr(s[0].length),l=document.createElement("a");return l.href=c,-1===l.href.indexOf("%")?e:""}var u=Object(J.b)(e);return u||V.log("doc_illegal_image",{origin_src:e}),u?e:Y.p;case"string[]":var d=e.map(function(e){return me.a.sanitize(e)});return n.test(d.join(""))?d:[];default:return e}return a.test(e)?e:""},this.generateDropImageHint=function(e){return'<div class="gallery-drop-hint-container ignore-collect gallery-drop-hint-container-col"\n    ><div class="gallery-drop-hint gallery-drop-hint-'.concat(e,'"\n    aria-hidden="true" role="presentation"></div></div>')},this.setSrcWithoutRecord=function(t,n){if(!V.editorInfo)return t.attr("src",n);V.editorInfo.getObserver().withoutRecordingMutations(function(){t.attr("src",n);var e=t.parents("div[id^=magicdomid]");e[0]&&V.markNodeClean(e[0])})},this.onMount=function(e,t){V.galleryComment&&V.galleryComment.onMount(),window.addEventListener("resize",V.debounceResize)},this.loadImagesOnMount=function(){V.triggerInViewImages()},this.changesetApply=function(e,t){V.galleryComment&&V.galleryComment.changesetApply(e,t)},this.editorAlinesDidSplice=function(e,t){var n=t.currentState,i=void 0===n?{}:n,r=t.prevState,o=void 0===r?{}:r,a=i.alinesAttribs,s=void 0===a?[]:a,c=o.alinesAttribs,l=void 0===c?[]:c,u=V.filterImgFromAlinesAttribs(s);u.forEach(function(e){var t,n,i,r,o,a=e.uuid,s=Object(Te.o)({uuid:a},V.editorInfo);0!==s.length&&(n=(t=s[0].start).zoneId,i=t.line,(r=V.editorInfo.getRep(n).lines.atIndex(i).lineNode)&&r.classList.contains("align-full")&&((o=r.querySelector("span.image-uploaded"))&&o.removeAttribute("style")))});var d=V.filterImgFromAlinesAttribs(l);(u.length||d.length)&&(V.galleryComment&&V.galleryComment.onCsImageChanged(),V.triggerInViewImages())},this.processAfterInsertNode=function(e,t){var n=Object(B.$)(t.entry.lineNode),i=n.find(".image-container > img[src]");i.length&&V.bindInsertImageEvent(i),Q.a.isIE&&0<n.has(".image-container img").length&&(n.off("mscontrolselect",xe),n.on("mscontrolselect",xe)),V.reuseAlignFullStyle(n)},this.bindInsertImageEvent=function(e){e.each(function(e,t){var n=Object(B.$)(t),i=function(e){var t=!0;"error"===e.type&&n.attr("src")&&(t=!1),n.off(),V.logInsertImageEvent(n,t)};n.on("load",i),n.on("error",i)})},this.logInsertImageEvent=function(e,t){var n=e.attr("data-src");V.log(Y.k,{origin_src:Object(ne.a)(n),load_status:t?"success":"fail"})},this.selectedGalleryItemIdToImageUUID=function(e){return e&&e.replace("image-upload-image-","")},this.postMsgToWorker=function(e){C.a.postMessage(e)},this.lineNodesRendered=function(e,t){V.handleImageAlignFullChange()},this.filterSelectedImageAttribs=function(e){var t=V.selectedGalleryItemIdToImageUUID(V.selectedGalleryItemId),n=t?e.filter(function(e){return e.uuid===t}):e;return 0<n.length?n:e},this.checkIsImageLine=function(e){e.fastIncorp();var t=e.getRep(),n=t.selStart[0];return Object(R.l)(t,n)},this.handleDeleteKey=function(e,t){var n=e.getRep(),i=n.selStart[0]===n.selEnd[0],r=e.isCaret(),o=e.getLine(),a=o+1,s=Object(w.default)(n.lines.atIndex(o),"lineNode",void 0),c=Object(w.default)(n.lines.atIndex(o),"text.length",-1),l=Object(w.default)(n.lines.atIndex(a),"lineNode",void 0),u=s&&Object(B.$)(s).find("img").length,d=l&&Object(B.$)(l).find("img").length,h=s&&n.selStart[1]===c,f=s&&0===n.selStart[1],p=t.evt;if(i&&u){t.preventOtherHooksHandle=!0,p.preventDefault();var g="#"+Object(B.$)("#galleryTempStyle").attr("data-id"),m=Object(B.$)(g).closest(".image-container-wrap"),v=parseInt(m.attr("data-gallery-index"));return e.spliceGalleryItemsAtLine(n.zoneId,o,v,1,null,!0)||V.performDelete(o,t),!0}if(r&&h&&d){t.preventOtherHooksHandle=!0,p.preventDefault(),f&&(e.inCallStackIfNecessary("delete-single-line",function(){e.fastIncorp(),e.performDocumentReplaceRange(n.zoneId,[o,0],[o+1,0],"")}),a--);var b=Object(B.$)(l).find(".image-container")[0],y=Object(B.$)(b).attr("id");return V.handleGalleryItemsChoosed(y),e.setWithSelection(n.zoneId,[a,0],[a,0]),e.updateBrowserSelectionFromRep(),!0}return!1},this.setSelectionOnImage=function(n){var i=V.editorInfo,r=i.getRep();i.inCallStackIfNecessary("imageFocus",function(){var e=new K.Position(r.zoneId,n,0),t=new K.Position(r.zoneId,n,1);i.selection.set({start:e,end:t}),i.selection.internalUpdateSelectionFromRep(!0)})},this.doReturn=function(e,t){var n=e.selStart[0],i=e.lines.atIndex(n),r=[n,i.text.length],o=[n,i.text.length];t.performDocumentReplaceRange(e.zoneId,r,o,"\n"),t.selection.setWithSelection(e.zoneId,[n+1,0],[n+1,0],!1),t.updateBrowserSelectionFromRep()},this.handleCut=function(e){var t,n,i,r,o,a,s=e.preventEvent,c=e.stopEvent,l=V.editorInfo.getRep(),u=l.selStart,d=l.selEnd,h=l.zoneId,f=V.editorInfo.getContentState().getZoneState(h).getLine(u[0]);f&&(t=f.getAttributes(),n=l.selStart[0],d[0]>u[0]||t.some(function(e){return"gallery"===e[0]})&&(i=V.toImageArray(V.getSelectedImgOnLine()||V.getImageSel()),r=V.isNewGalleryStructure(f.content.ops),i.length&&!r&&(o=Object(B.$)(i[0]).closest(".image-container-wrap").attr("data-gallery-index")||0,a=i.length,V.editorInfo.spliceGalleryItemsAtLine(h,n,parseInt(o),a)||V.performDelete(n),s(),c())))},this.doDelete=function(e,t,n,i){var r,o=e.selStart,a=e.selEnd,s=o[0],c=a[0],l=e.lines.atIndex(s),u=s-1,d=Object(R.l)(e,s),h=Object(R.n)(e,s),f=Object(R.n)(e,s-1),p=l.lineMarker,g=e.attributeManager.findAttributeOnLine(s,"list"),m=e.attributeManager.findAttributeOnLine(s,"text-indent"),v=o[1]===a[1]&&o[0]===a[0],b=Object(R.d)(e,s);if(!t.getInInternationalComposition()){if(v&&o[1]===p&&!g&&!m&&!b&&!f&&Object(R.l)(e,u)){i.preventOtherHooksHandle=!0,V.selectPreLineImage(e,u);var y=Object(w.default)(l,"text.length");if(0<y&&l.lineMarker!==y)return n.preventDefault(),!0}if(0===o[1]&&0===a[1]&&f&&!d)return V.performDelete(s-1,i),n.preventDefault(),!0;if(c===s&&(d||h)){var E="#"+Object(B.$)("#galleryTempStyle").attr("data-id"),O=Object(B.$)(E).closest(".image-container-wrap").attr("data-gallery-index");return Object(R.l)(e,u)&&1===Object(B.$)(l.lineNode).find("img").length&&V.selectPreLineImage(e,u),t.spliceGalleryItemsAtLine(e.zoneId,s,parseInt(O),1,null,!0)||V.performDelete(s,i),n.preventDefault(),i.preventOtherHooksHandle=!0}h&&0===u&&(r=[u,e.lines.atIndex(u).text.length],e.selStart=e.selEnd=r,t.updateBrowserSelectionFromRep())}},this.UNSAFE_editorNormalizePasteNode=function(e){var t=e.data.node,n=V.getDriveImageData(t);V.pasteDriveImg(n),de.isAnonymousAccess&&V.stripImgFromHtml(t).hasExternalImg&&Object(J.a)()},this.replaceToken=function(){var n=p()(f.a.mark(function e(t,n){var i,r,c,l,u;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(se.c)(t),e.next=3,i.promise;case 3:if((r=e.sent).tokenMap){e.next=8;break}return V.clearPasteImage(n),V.log("doc_paste_image_failed",{count:t.length}),e.abrupt("return");case 8:c=r.tokenMap,l={},u={},Object.keys(c).forEach(function(e){var a=c[e];if(l[a])return!1;var s=n[e].fileToken;V.editorInfo.getMatchedAttributePositionOnSelection(null,function(e,t){var n=null;if("image-uploaded"===e||"clientside-image-uploaded"===e){if(n=Object(q.c)(t),Object(se.g)(decodeURIComponent(n.src))!==s)return!1;var i=Object(ce.g)();return n.src=Object(J.i)(a,i),n.file_token=a,n.from_copy=1,l[s]=1,u["".concat(e).concat(t)]=V.buildGalleryItem(n),!0}if("gallery"!==e&&"clientside-gallery"!==e)return!1;n=JSON.parse(t);var r=!1,o=Object(ce.g)();return n.items.forEach(function(e){c[e.file_token]&&(e.src=Object(J.i)(c[e.file_token],o),e.file_token=c[e.file_token],e.from_copy=1,l[e.file_token]=1,r=!0)}),!!r&&(u["".concat(e).concat(t)]=n,!0)}).forEach(function(e){var t,n,i,r,o=e.attrKey,a=e.attrValue,s=e.docPosition,c=u["".concat(o).concat(a)];c&&(t=s.selStart,n=s.selEnd,i=s.selZone,t[2]=i,n[2]=i,r={selStart:t,selEnd:n,zoneId:i},V.updateCopyImageRange(c,r))})});case 13:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),this.buildGalleryItem=function(e){var t=e.uuid,n=e.width,i=void 0===n?0:n,r=e.height,o=void 0===r?0:r,a=Object(J.m)(i,o),i=V.suffixPixel(i),o=V.suffixPixel(o);return{items:[Object.assign({attachmentId:"attachment-id-"+Object(L.b)(),type:"image",pluginName:Y.s,uuid:t,natrualWidth:i,natrualHeight:o,decrypt_key:"",cdn_url:"",thumbnail_cdn_url:"",webp_thumbnail_cdn_url:"",height:o,width:i,scale:a,comments:[],isDragging:!1,image_type:"",size:0,currHeight:o,currWidth:i,file_version:""},e)]}},this.updateCopyImageRange=function(e,t){var n=t.zoneId,i=t.selStart,r=t.selEnd,o=[["gallery",JSON.stringify(e)]];V.editorInfo.callWithAce(function(){r[1]=r[1]+1,V.editorInfo.performDocumentReplaceRangeWithAttributes(n,i,[i[0],i[1]+1,i[2]]," ",o)},"updateCopyImageCS",!0)},this.fullscreenPageChanged=function(e,t){var n,i=t.nextLineDoms,r=[];i.forEach(function(e){var t=Object(B.$)(e).find("img");Array.from(t).forEach(function(e){var t=Object(B.$)(e),n=t&&t.attr("data-uuid");n&&r.push(n)})}),0<r.length&&(n=r.filter(function(e){return V.gifUuidList.includes(e)}),V.playInViewGif(n))},this.fullscreenModeChanged=function(e,t){t.mode===re.a.PAGED&&V.loadAllImages()},this.loadAllImages=function(){var e=V.getImageFromAttr()||[],t=Object(O.a)(e.map(function(e){return Object(J.A)(e.attrKey,e.attrValue)}));V.postMsgToWorker({type:T.h.FETCH,data:{inViewImages:V.filterDecryptConfigImgs(t),nearScreenImages:[]}})},this.aceAfterPaste=function(e,t){var n,i,r;(t.e.originalEvent.clipboardData||window.clipboardData)&&(n=t.pasteDataWrapper,i=t.rep,r=V.getDriveImageData(n),V.pasteDriveImg(r),de.isAnonymousAccess&&V.stripImgFromHtml(n).hasExternalImg&&Object(J.a)(),i.selStart[0]===i.selEnd[0]&&Object(R.l)(i,i.selStart[0])&&(t.pasteDataWrapper.innerHTML=""))},this.performDelete=function(e,t){var n,i=V.editorInfo,r=i.getRep(),o=r.lines.atIndex(e),a=0<=e-1?e-1:0,s=r.lines.atIndex(a);o&&(n=o.text.length,t&&(t.preventOtherHooksHandle=!0),e?i.performDocumentReplaceRange(r.zoneId,[a,s.text.length],[e,n],""):i.performDocumentReplaceRange(r.zoneId,[e,0],[e,n],""))},this.getImageSel=function(){var e=x.a.getChosenGalleryContainer()||x.a.getChosenImgContainer();return Object(B.$)(e).find("img").get(0)},this.handleGalleryItemsChoosed=function(e){V.selectedGalleryItemId=e,V.galleryComment&&V.galleryComment.setSelectedImageUUID(V.selectedGalleryItemIdToImageUUID(e))},this.pluginReadOnly=function(e,t){var n,i=(V.ace||{}).editorInfo;i&&(V.editable=!1,n=i.getInnerContainer(),Object(B.$)(n).undelegate(".image-uploaded img","dragstart",V.handleDragStart),Object(B.$)(n).delegate(".image-uploaded img","dragstart",V.handleDragStart),i.off("galleryImageChoosed",V.handleGalleryItemsChoosed),i.on("galleryImageChoosed",V.handleGalleryItemsChoosed),!V.isInHistory&&V.uploader&&(V.uploader.uploader.enableDropImage=!1))},this.pluginReadWrite=function(e,t){var n,i=(V.ace||{}).editorInfo;i&&(V.editable=!0,n=i.getInnerContainer(),Object(B.$)(n).undelegate(".image-uploaded img","dragstart",V.handleDragStart),i.on("galleryImageChoosed",V.handleGalleryItemsChoosed),i.on("imageUploadSuccess",V.handleImageUploaded),!V.isInHistory&&V.uploader&&(V.uploader.uploader.enableDropImage=!0))},this.handleImageUploaded=function(){V.editorInfo.pure||void 0!==V.shouldShowGuide||Q.a.isMobile||(V.shouldShowGuide=!0,setTimeout(function(){V.editorInfo.call("imageFirstUpload")},100))},this.selectPreLineImage=function(e,t){var n=Object(w.default)(e.lines.atIndex(t),"lineNode"),i=Object(B.$)(n).find("img").length,r=Object(B.$)(Object(B.$)(n).find("img")[i-1]);V.selectedGalleryItemId=Object(B.$)(r).parents(".image-container").attr("id");var o=r.attr("data-uuid");o&&setTimeout(function(){var e,t,n,i=Object(Te.o)({uuid:o},V.editorInfo);0!==i.length&&(t=(e=i[0]).start,n=e.end,V.editorInfo.selection.setSelection({start:t,end:n},!0))})};var t=e.editor,n=void 0===t?void 0:t,i=e.galleryComment,r=void 0===i?void 0:i,o=e.needInit,a=void 0===o||o,s=e.containerCls,c=void 0===s?"":s,l=e.eventEmitter;n&&a?this.aceInitialized("",Object.assign({editorInfo:n},n)):n&&(this.ace=n,this.editorInfo=n),n&&(this.isInHistory=n.pure),this.eventEmitter=l,this.galleryComment=r,this.containerCls=""!==c?c+" ":c,this.decryptImages={},(Ne[this.pluginId]=this).editable=!1,this.tasks={},this.uploadDispayUrl={},this.decodedImageList=[],this.enterTimer=null,this.leaveTimer=null,this.undelegateImgMouseList=[],this._externalImageSaver=new he.b,this.gifResourceMap={},this.gifStatusMap={},this.docHeight=n.getInnerContainer().offsetHeight-52,c||this.bindImageMouseEvent(),this.externalImgHintEnable=Object(Ee.I)("enable_external_img_hint")}function e(e){return t.apply(this,arguments)}var t,n,i;function r(e,t){return n.apply(this,arguments)}function o(e){return i.apply(this,arguments)}return b()(u,[{key:"bindImageMouseEvent",value:function(){var e={passive:!0},t="#innerdocbody .image-container",n="#outerdocbody .selection-popup",i="#innerdocbody .image-gif-container .gif-load-icon-content",r=[{parent:"body",child:t,event:"mouseenter",handle:this.handleImageMouseEnter.bind(this),eventOptions:e},{parent:"body",child:t,event:"mouseleave",handle:this.handleImageMouseLeave.bind(this),eventOptions:e},{parent:"body",child:n,event:"mouseenter",handle:this.handlePopupMouseEnter.bind(this),eventOptions:e},{parent:"body",child:n,event:"mouseleave",handle:this.handlePopupMouseLeave.bind(this),eventOptions:e},{parent:"body",child:i,event:"click",handle:this.handleLoadOriginGif.bind(this),eventOptions:e}],s=[];r.map(function(e){var t=e.parent,n=e.child,i=e.event,r=e.handle,o=e.eventOptions,a=Object(le.a)(t,n,i,r,o);a&&s.push(a)}),this.undelegateImgMouseList=s}},{key:"unBindImageMouseEvent",value:function(){this.undelegateImgMouseList.forEach(function(e){return e&&e()}),this.undelegateImgMouseList=null}},{key:"editorSizeChange",value:function(e,t){var n=t.next;this.docHeight=n.height,this.galleryComment&&this.galleryComment.editorSizeChange()}},{key:"viewportChange",value:function(e,t){var n=t.visibleRangeInMainZone;this.loadImagesByLine(n)}},{key:"onDocumentResizeWidthChange",value:function(t){var n=null;return function(){var e=document.body.clientWidth;e!==n&&(n=e,t&&t.call(this))}}},{key:"getAlignFullImg",value:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s,c,l=o.value.docPosition,u=l.selStart,d=l.selZone,h=this.editorInfo.getRep(d).lines.atIndex(u[0]);h&&h.isRendered&&(s=h.lineNode,!Object(B.$)(s).is(".align-full")||(c=Object(B.$)(s).find(".image-uploaded")).length&&t.push(c[0]))}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}},{key:"handleImageAlignFullChange",value:function(){var e,t,n=this.getImageFromAttr(),i=this.getAlignFullImg(n);i.length<=0||(e=i[0],t=this.getAlignFullStyle(e),i.forEach(function(e){Object(B.$)(e).css(t),Object(B.$)(e).find(".image-loading").width(t.width)}),this.alignFullStyleCache=t)}},{key:"getAlignFullStyle",value:function(e){if(!e)return null;var t=this.editorInfo.getScrollContainer().getBoundingClientRect(),n=this.editorInfo.getInnerContainer().getBoundingClientRect(),i=parseInt(window.getComputedStyle(this.editorInfo.getInnerContainer()).paddingLeft)||0,r=t.width,o=t.left,a=n.left-o+i;return{width:this.isInPresentationMode?"".concat(r/1.8,"px"):"".concat(r,"px"),marginLeft:this.isInPresentationMode?"-".concat(a/1.8,"px"):"-".concat(a,"px")}}},{key:"playInViewGif",value:function(e){this.pauseGif(e),this.playGif(e),this.activeGifList=e}},{key:"playInViewGifByLine",value:function(e){var t=this,n=e.filter(function(e){return t.gifUuidList.includes(e.uuid)}).map(function(e){return e.uuid});this.playInViewGif(n)}},{key:"collectGifUuidList",value:function(e){var t=Object(O.a)(Object.values(e)),n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s,c=o.value;-1<(c.image_type||"").indexOf("gif")&&(s=c.uuid,this.gifUuidList.includes(s)||this.gifUuidList.push(s))}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}},{key:"triggerInViewImages",value:function(){this.isInHistory||this.loadImagesByLine(this.editorInfo.plugins.viewportObserver.getVisibleRange())}},{key:"checkShouldShowLoading",value:function(e){if(e){var t=e.src,n=this.decryptImages[t]&&this.decryptImages[t].finished;return this.isImgNeedDecrypt(e)&&!n}return!1}},{key:"getUploadSrcByBase64Upload",value:function(e){var t=e.taskId;return(t&&this.tasks[t]||{}).src||""}},{key:"loadImagesByLine",value:function(e){var t=this.getLineImagesMap();this.collectGifUuidList(t);var n=this.filterPriorityImages(e,t),i=n.inViewImages,r=n.nearScreenImages;this.playImagesLoading(i),this.loadImagesByPriority(i,r),this.playInViewGifByLine(i)}},{key:"playImagesLoading",value:function(e){var r="loading-play",o=e.map(function(e){return e.uuid});Object(B.$)("img[data-uuid]").each(function(e,t){var n=Object(B.$)(t),i=n.parent(".image-container");o.includes(n.data("uuid"))?i.addClass(r):i.removeClass(r)})}},{key:"loadImagesByPriority",value:function(e,t){this.postMsgToWorker({type:T.h.FETCH,data:{inViewImages:this.filterDecryptConfigImgs(e),nearScreenImages:this.filterDecryptConfigImgs(t)}})}},{key:"filterDecryptConfigImgs",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return Object(ue.a)([function(e){return e.filter(t.isGifNeedFetching)},function(e){return e.filter(t.isImgNeedDecrypt)},function(e){return e.map(t.getImgRequestConfig)}])(e)}},{key:"filterPriorityImages",value:function(e,r){var t=h()(e,2),o=t[0],a=t[1],s=5,c=[],l=[];return Object.keys(r).forEach(function(e){var t=r[e],n=e<o&&o-s<e,i=a<e&&e<a+s;o<=e&&e<=a?c=c.concat(t):(n||i)&&(l=l.concat(t))}),{inViewImages:c,nearScreenImages:l}}},{key:"getLineImagesMap",value:function(){var r=this,e=this.getImageFromAttr(),o={};return e.forEach(function(e){var t,n,i=r.getLineNoFromPosition(e.docPosition);i&&(t=Object(J.A)(e.attrKey,e.attrValue),n=(n=o[i]||[]).concat(t),o[i]=n)}),o}},{key:"getImageFromAttr",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=function(e){return/(gallery|image-uploaded)/.test(e)};return this.editorInfo.getMatchedAttributePositionOnSelection(e,t)}},{key:"getLineNoFromPosition",value:function(e){var t="0",n=e.selZone,i=void 0===n?t:n,r=e.selStart,o=void 0===r?[]:r;return i!==t?this.editorInfo.getLineNumInRootZone(i,o[0]):o[0]}},{key:"playGif",value:function(e){var n=this;e.some(function(e){return!n.activeGifList.includes(e)&&void(!e||(t=Object(B.$)('img[data-uuid="'.concat(e,'"]'))).length&&n.switchGifImageSrc(t,"origin"));var t})}},{key:"pauseGif",value:function(n){var i=this;this.activeGifList.some(function(e){return!n.includes(e)&&void(!e||(t=Object(B.$)('img[data-uuid="'.concat(e,'"]'))).length&&i.switchGifImageSrc(t,"cover"));var t})}},{key:"handleClientMessage_ACCEPT_COMMIT",value:function(e,t){this.galleryComment&&this.galleryComment.changeSetCommitWatcher.handleClientMessage_ACCEPT_COMMIT(e,t)}},{key:"handleClientMessage_ERROR",value:function(e,t){this.galleryComment&&this.galleryComment.changeSetCommitWatcher.handleClientMessage_ERROR(e,t)}},{key:"sendMessageError",value:function(e,t){this.galleryComment&&this.galleryComment.changeSetCommitWatcher.sendMessageError(e,t)}},{key:"_handleMsgFromWorker",value:function(e){var t;this.isInHistory||(t=e.originSrc,this.decryptImages[t]&&this.handleImageDisplay(e))}},{key:"getImgUrlPath",value:function(e){if(e){var t=Object(ee.getLocation)(e);return t&&t.pathname}return null}},{key:"handleImageDisplay",value:function(i){var r=this,e=i.blobUrl,t=i.originSrc,n=i.forceLoadGifOrigin;this.decryptImages[t].finished=!0,this.decryptImages[t].blobUrl=e;var o=this.getImgUrlPath(t);this.setGifResource(i),n?this.loadGifOrigin(i):Object(B.$)('img[data-src*="'.concat(o,'"]'),this.editorInfo.getInnerContainer()).each(function(e,t){var n=Object(B.$)(t);r.isImgWaitDisplay(n)&&r.loadImg(n,i)})}},{key:"loadGifOrigin",value:function(o){var a=this;o&&this.getSamePathGifAttrs(o).forEach(function(){var e,t,n,i,r=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).docPosition;r&&(e=r.selStart,t=r.selZone,e&&t&&(!(n=e[0])||(i=a.editorInfo.getRep(t).lines.atIndex(n).lineNode)&&Object(B.$)("img",i).each(function(e,t){var n=Object(B.$)(t),i=n.data("uuid");(a.gifStatusMap[i]||{}).isFetching&&(a.loadImg(n,o),a.updateGifLoadOriginStatus(i))})))})}},{key:"getSamePathGifAttrs",value:function(e){var n=this;if(!e)return[];var t=e.originSrc,i=this.getImgUrlPath(t),r=function(e,t){return!!/(gallery|image-uploaded)/.test(e)&&Object(J.A)(e,t).find(function(e){return n.getImgUrlPath(e.src)===i})},o=null;return this.editorInfo.getMatchedAttributePositionOnSelection(o,r)}},{key:"loadImg",value:function(e,t){var n,i,r;e&&t&&(n=t.blobUrl,i=t.originSrc,this.bindImageEvent(e,t),r=n||i,t.loadBlobStart=performance.now(),this.setSrcWithoutRecord(e,r))}},{key:"updateGifLoadOriginStatus",value:function(e){var t=this.gifStatusMap[e]||{};this.gifStatusMap[e]=Object.assign({},t,{isFetching:!1})}},{key:"setGifResource",value:(i=p()(f.a.mark(function e(t){var n,i,r,o,a,s,c,l,u;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(n=t.originMimeType,i=t.originSrc,r=t.coverResultUrl,o=t.originResultUrl,"image/gif"===n){e.next=6;break}return e.abrupt("return");case 6:if(a=this.getImgUrlPath(i),this.isNeedSetGifResource(a)){e.next=10;break}return e.abrupt("return");case 10:if(s=this.isRequestCover(t),c=this.isRequestCoverButReceiveOrigin(t),this.gifResourceMap[a]=this.gifResourceMap[a]||{},s?(this.gifResourceMap[a].cover=r,c&&(this.gifResourceMap[a].cover=null,this.gifResourceMap[a].origin=r)):this.gifResourceMap[a].origin=o,this.gifResourceMap[a].cover){e.next=20;break}return l=r||o,e.next=18,Object(J.g)(l);case 18:u=e.sent,this.gifResourceMap[a].cover=u;case 20:case"end":return e.stop()}},e,this)})),o)},{key:"setLoadedGifResource",value:(n=p()(f.a.mark(function e(t,n){var i,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return");case 2:return i=this.getImgUrlPath(t),this.gifResourceMap[i]=this.gifResourceMap[i]||{},this.gifResourceMap[i].origin=n,e.next=7,Object(J.g)(n);case 7:r=e.sent,this.gifResourceMap[i].cover=r;case 9:case"end":return e.stop()}},e,this)})),r)},{key:"isRequestCover",value:function(e){return!!e&&"cover"===e.coverOptions.type}},{key:"isNeedSetGifResource",value:function(e){var t=this.gifResourceMap[e];return!t||(!t.cover||!t.origin)}},{key:"isRequestCoverButReceiveOrigin",value:function(e){if(!e)return!1;var t="image/gif"===e.mime;return this.isRequestCover(e)&&t}},{key:"toggleGifLoadIconClass",value:function(n){var e,t,i,r,o;n&&Object(B.$)(n).parent(".image-container").hasClass("image-gif-container")&&(e=n.attr("data-src"),t=this.getImgUrlPath(e),i=this.gifResourceMap[t]||{},r=i.cover,o=i.origin,this.editorInfo&&this.editorInfo.getObserver().withoutRecordingMutations(function(){var e=n.parent().find(".".concat(Y.g)),t=e.hasClass(Y.f);o?t&&e.removeClass(Y.f):r&&(t||e.addClass(Y.f))}))}},{key:"isImgWaitDisplay",value:function(e){var t=e.attr("src");return t===Y.p||!t}},{key:"cancelImageLoading",value:function(e){var t=e.parents(".image-container-wrap");this.editorInfo&&this.editorInfo.getObserver().withoutRecordingMutations(function(){1===t.closest(".ace-line").find("img").length&&(t.attr("style",""),t.find(".image-container").attr("style","")),Object(B.$)("i.image-loading",t).addClass("image-loaded")})}},{key:"bindImageEvent",value:function(e,t){e.on("load",this.handleDecryptImgOnLoad(e,t)),e.on("error",this.handleDecryptImgOnError(e,t))}},{key:"handleDecryptImgOnError",value:function(i){var r=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=!1;return function(e){var t=o.originSrc,n=o.uuid;if(a)return r.unBindImageEvent(i),r.handleAfterImgLoaded({uuid:n}),r.logDecryptImageDisplay(o,!0),void r.decryptImgDidUpdate(i);r.setSrcWithoutRecord(i,t),a=!0,r.toggleGifLoadIconClass(i),r.isPlaceholderSrc(i)||r.cancelImageLoading(i),r.decryptImgDidUpdate(i)}}},{key:"mergeImgSizeToImageStatus",value:function(e,t){var n=e.target.dataset,i=n.width,r=n.height;t.displayStatus.image_width=parseInt(i,10),t.displayStatus.image_height=parseInt(r,10)}},{key:"handleDecryptImgOnLoad",value:function(t){var n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e){n.mergeImgSizeToImageStatus(e,i),n.unBindImageEvent(t),n.logDecryptImageDisplay(i,!1),n.toggleGifLoadIconClass(t),n.isPlaceholderSrc(t)||n.cancelImageLoading(t),n.decryptImgDidUpdate(t)}}},{key:"decryptImgDidUpdate",value:function(e){var t,n,i,r;e&&(t=e[0],i=(void 0===(n=this.editorInfo.domToRep(t).selStart)?[]:n)[2],(r=e.closest(".ace-line").attr("id"))&&i&&this.notifyImgDidUpdate({key:r,zone:i}))}},{key:"logDecryptImageDisplay",value:function(e,t){var n=e.displayStatus,i=e.displayStart,r=e.originSrc,o=e.fileToken,a=e.loadBlobStart;i&&(n.display_time_cost=(Date.now()-i).toFixed(4)),a&&(n.load_blob_cost=(performance.now()-a).toFixed(4)),a&&(n.load_blob_cost=(performance.now()-a).toFixed(4)),n.display_fail=!!t,this.log(Y.b,Object.assign({origin_src:Object(ne.a)(r),image_catagory:Object(J.j)(o)},n))}},{key:"unBindImageEvent",value:function(e){e.off("load"),e.off("error")}},{key:"checkIfImageLoadError",value:function(e){return[T.ErrorType.GetCdnKey,T.ErrorType.GetCdnUrl,T.ErrorType.GetImageUrl].includes(e)}},{key:"handleAfterImgLoaded",value:function(e){var t,n,i=e.uuid,r=Object(B.$)("".concat(this.containerCls,"#image-upload-image-").concat(i));r.length&&(t=r.offset().top,(n=this.editorInfo)&&n.call("afterImgLoaded",{top:t}),n.scrollVerticallyBySelectionPosition())}},{key:"regist",value:function(e){var o=this;e.registerAceCommand(N.K,function(e,t,n,i){var r=i.source;o.execInsertImage(r)}),C.a.addMessageHandle(this.handleMsgFromWorker)}},{key:"onEditorContentChange",value:function(e){var t=this,n=e.changes;Object(Le.b)(n)&&this.editorInfo.once("paint",function(){t.handleImageAlignFullChange()})}},{key:"initImageView",value:function(e){x.a.initAce(e)}},{key:"initUploader",value:function(e){Object(ie.c)()||(this.uploader=new D.a(e,this),this.trigger=this.uploader.uploader.open)}},{key:"initEvent",value:function(e){Object(ie.c)()||P.b.bind(e,this)}},{key:"_saveFaild",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"save faild";V.a.show({type:"error",closable:!0,content:Z("etherpad.image_save_failed")}),this.log("doc_paste_external_img_end",{status:"failed",src:t,image_category:"drive",msg:n});var i=Object(J.l)();this.logExternalImg(i),this._replaceExternalImg(i,e,"730px","110px","faild")}},{key:"_replaceExternalImg",value:function(o,a,s,c,l,e){var u=this,d=this.editorInfo,h=d.getRep(),t=e||{file:{}},f=t.decryptKey,p=t.cdnUrl,g=t.thumbCdnUrl,m=t.webpThumbCdnUrl,v=t.fileToken,b=t.version,y=t.file;d.callWithAce(function(){d.fastIncorp();var e=Object(J.m)(s,c);s=u.suffixPixel(s),c=u.suffixPixel(c);var t,n,i=[["gallery",JSON.stringify({items:[{attachmentId:"attachment-id-".concat(a),type:"image",src:encodeURIComponent(o),pluginName:Y.s,uuid:a,natrualWidth:s,natrualHeight:c,decrypt_key:f||"",cdn_url:p||"",thumbnail_cdn_url:g||"",webp_thumbnail_cdn_url:m||"",height:c,width:s,scale:e,comments:[],isDragging:!1,image_type:y.type,size:y.size,currHeight:c,currWidth:s,file_token:v||"",file_version:b||"",isUnsupported:"faild"===l}]})]],r=d.getMatchedAttributePositionOnSelection(null,function(e,t){return"image-previewer"===e&&-1<t.indexOf("uuid=".concat(a))});r.length&&(t=r[0].docPosition,(n=d.getCurrentCallStack())&&"externalImageSave"===n.type&&(n.preventScrolling=!0),d.performDocumentReplaceRangeWithAttributes(h.zoneId,t.selStart,t.selEnd," ",i))},"externalImageSave",!0),this.log("doc_paste_external_img_end",{status:l,url:o,image_category:"drive"})}},{key:"editorWillPaste",value:function(e){var o=this,t=e.deltaSet;if(!e.isInternalPaste){var n=t;return t.forEach(function(e){e.zoneType===Ce.F.Content&&n.replace(e.zoneId,Object(Se.a)(e,o.editorInfo))}),n}var i=this.editorInfo.clipboard.getPasteInfo(),r=i.pasteFrom,a=i.pasteTimes,s=t,c="cut"===r&&1===a,l=[],u=[];return s.forEach(function(e){var t,n,i,r;e.zoneType===Ce.F.Content&&(n=(t=Object(ke.c)(e,c,o._saveExternalImage)).zoneDelta,i=t.fileTokenList,r=t.fileTokenToSuiteMap,l=l.concat(i),u=Object.assign({},u,{},r),s=s.replace(e.id,Object(Se.a)(n,o.editorInfo)))}),this.pasteDriveImg({fileTokenList:l,fileTokenToSuiteMap:u}),s}},{key:"getContextWidth",value:function(e,t,n){var i;return t&&Object(ye.h)(t)&&(i=16,(e=Object(oe.i)(t,n)-i)<0&&console.error("illegal zoneId for getWidthOfMergedCells")),e}},{key:"parseImagesFromOp",value:function(e,r){return Object(Te.d)(e.map(function(e){var t=e.attributes,n=(void 0===t?{}:t)[r];if(n){var i={transformSrc:!1};return Object(J.A)(r,n,i)}}).filter(function(e){return e}))}},{key:"getAuthorInfoFromOp",value:function(e,t){var n={},i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value.attributes,l=void 0===c?{}:c;if(l.author){var u=l[t];if(u){var d={transformSrc:!1},h=Object(J.A)(t,u,d),f=!0,p=!1,g=void 0;try{for(var m,v=h[Symbol.iterator]();!(f=(m=v.next()).done);f=!0)n[m.value.uuid]=l.author}catch(e){p=!0,g=e}finally{try{f||null==v.return||v.return()}finally{if(p)throw g}}}}}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}},{key:"isNewGalleryStructure",value:function(e){var n=0;return e.forEach(function(e){var t=e.attributes;(void 0===t?{}:t).gallery&&(n+=1)}),1<n}},{key:"match",value:function(e,t){return!(!Object(J.u)(t)&&!new RegExp('"pluginName":"imageUpload"').test(t)&&"gallery"!==e)||"imaexecInsertImagegefulexecInsertImagelscreen"===e}},{key:"render",value:function(e){var t,n,i=e.index,r=e.zoneId;for(n in e.attributes){var o=e.attributes[n];"imaexecInsertImagegefulexecInsertImagelscreen"===n&&(e.class+="image-full-screen"),(Object(J.u)(o)||new RegExp('"pluginName":"imageUpload"').test(o)||"gallery"===n)&&(t=" key=".concat(n,"&").concat(o),e.class+=t,e.class+=" image-plugin-comment")}var a=e.attributes,s=i;if(/key=gallery/.test(e.class)){var c=a.gallery||null,l=Object(J.z)(c).items||[],u=a.author?l.reduce(function(e,t){return e[t.uuid]=a.author,e},{}):{};e.lineClass+=" "+te.b.join(" ");var d=this.createGalleryHtml(l,r,s,u);return Object(_e.a)(d,c,t)}if(Object(J.u)(e.class)){e.class=e.class.replace(/pluginName=imageUpload\s*/,"pluginName=imageUpload");var h,f=a["image-uploaded"]||a["image-previewer"],p={externalLoading:"true"===(p=Object(q.c)(f)).externalLoading,externalId:p.externalId,isUnsupported:p.isUnsupported,src:this.itemSchema(p.src,"image_url"),width:this.itemSchema(p.width,"string"),height:this.itemSchema(p.height,"string"),uuid:this.itemSchema(p.uuid,"string"),taskId:this.itemSchema(p.taskId,"string"),fileToken:p.fileToken?this.itemSchema(p.fileToken,"string"):""},g=Object(J.b)(p.src)?"":"image-illegal";if(a["image-uploaded"]){try{h=Object(J.w)(p)}catch(e){h=Y.p}this.initDecryptImage(h),p.src=h;var m,v,b=p.width,y=p.height,E=p.uuid;E||(m=/uuid=([\w\d-]*)/,(v=e.class.match(m))&&(p.uuid=E=v[1]));var O=Object(J.c)(E),C=Y.q.map(function(e){return e.includes("c")?'<span class="point '.concat(e,'"></span>'):'<span class="point '.concat(e,' n-icon-dragable"></span>')}).join(""),k=p.imageType||"",I=k?"".concat(k.split("/").join("-"),"-container"):"",S=this.editorInfo,T=(this.isInHistory?document.querySelector(".doc-history-revert__content.innerdocbody, .history-list"):S.getInnerContainer()).offsetWidth,T=this.getContextWidth(T,r,S),_='\n<div class="history-deleted-mask">\n  <div class="history-deleted-mask_text">'.concat(Z("history.deleted"),"</div>\n</div>").trim(),w=this.checkShouldShowLoading(p),j=this.getImgSrc(p);(Object(ie.c)()||O)&&(j=O?Y.p:Object(J.x)(p),this.markDecryptImgLoadBySSR(h)),p.isUnsupported&&(j=Object(J.l)()),this.imgPrerenderRegist(j,E,r,s);var M=("100%"===b||parseInt(b)>=T)&&w?'style="width:'.concat(T,"px;height:").concat(T*Re,'px"'):"",L=Re;isNaN(parseInt(y))||isNaN(parseInt(b))||(L=Object(J.D)(parseInt(y)/parseInt(b),6));var R=w?'<i class="image-loading layout-main-cross-center"\n            style="padding-top: '.concat(100*L,'%">\n            ').concat(De,"\n          </i>"):"",N=Q.a.modernIE?'contenteditable="false"':"",D=this.getLoadGifIconHtml(p),x='<div draggable="false" id="container-wrap-'.concat(Y.u,"-image-").concat(E,'"\n        class="image-container-wrap image-container-wrap-old\n        ').concat(p.author?Me.f+" "+Object(je.a)(p.author):"",'"\n        data-fake-text="*" ').concat(N,"><div id='").concat(Y.u,"-image-").concat(E,"'\n        class='image-container ").concat(I).concat(g,"'\n        ").concat(M,">").concat(D).concat(this.isInHistory?_:"").concat(R,'<img\n        class="ssr-reuse" id="ssr-reuse-').concat(E,'" data-width="').concat(b||"",'" data-height="').concat(y||"",'"\n        data-uuid=').concat(E,' data-src="').concat(h,'" src="').concat(j,'"\n        data-file-token="').concat(p.fileToken||"","\" style='width:").concat(b,";'/>").concat(C)+'<span data-zero-space="true">&#8203;</span></div></div>',P=Object(J.B)(x);return Object(_e.a)(P,null,t)}if(a["image-previewer"]){var B=p.uuid,U=p.width,z=p.height,H=void 0===z?0:z,F=p.taskId,V=Y.q.map(function(e){return'<span class="point '.concat(e,"br"===e?' n-icon-dragable"></span>':'"></span>')}).join(""),W=this.getUploadSrc(p)||Y.p;e.class+=" image-previewer";var K=Be({uuid:B,width:U,height:H,taskId:F,imageSrc:W,pointsHTML:V,externalLoading:p.externalLoading,externalImgId:p.externalId,author:a.author});return Object(_e.a)(K,null,t)}}return e.children}},{key:"hasImageAttribs",value:function(e){return e.find(function(e){var t=e.attributes,n=void 0===t?{}:t;return n.gallery||n["image-uploaded"]})}},{key:"renderLine",value:function(e){var t=e.lineState,n=e.children,i=e.index,r=t.content.ops,o=this.parseImagesFromOp(r,"gallery");if(this.hasImageAttribs(r)&&(e.lineClass+=" ".concat(Ae.l," "),e.editable=!1),!this.isNewGalleryStructure(r))return n;var a=this.getAuthorInfoFromOp(r,"gallery"),s=this.createGalleryHtml(o,t._zoneId,i,a),c={items:d()(o)};console.log("[image plugin] originImageAttribsItems",o);var l=JSON.stringify(c),u=" key=gallery&".concat(l);return Object(_e.a)(s,l,u)}},{key:"createGalleryHtml",value:function(N,D,x,P){var B=this,e=this.editorInfo,t=e.getInnerContainer(),n=e&&t["data-last-width"]||t.offsetWidth,n=this.getContextWidth(n,D,e);if((void 0!==N.find(function(e){var t=e.natrualWidth,n=e.natrualHeight,i=e.currWidth,r=e.currHeight,o=i===t&&r===n,a=isNaN(parseInt(i))||isNaN(parseInt(r));return o||a})||n<N.reduce(function(e,t){return parseFloat(t.currWidth)+e},0))&&2<=N.length){var i,r,o=N.reduce(function(e,t){return e+t.scale},0),a=n,s=4,c=N.length,l=Number.MAX_VALUE,u=null,d=Number.MAX_VALUE,h=!0,f=!1,p=void 0;try{for(var g,m=N[Symbol.iterator]();!(h=(g=m.next()).done);h=!0){var v=g.value,b=v.scale/o*(a-s*c),y=b/v.scale;v.currWidth=b+s+"px",v.currHeight=y+"px",v.width=v.currWidth,v.height=v.currHeight,b<l&&(l=b,u=v),y<d&&(d=y)}}catch(e){f=!0,p=e}finally{try{h||null==m.return||m.return()}finally{if(f)throw p}}if(l<Y.m?(i=parseFloat(u.natrualWidth)/parseFloat(u.natrualHeight),r=Y.m/i):d<Y.m&&(r=Y.m),l<Y.m||d<Y.m){var E=!0,O=!1,C=void 0;try{for(var k,I=N[Symbol.iterator]();!(E=(k=I.next()).done);E=!0){var S=k.value,T=parseFloat(S.natrualWidth)/parseFloat(S.natrualHeight);S.currHeight=S.height=r+"px",S.currWidth=S.width=T*r+s+"px"}}catch(e){O=!0,C=e}finally{try{E||null==I.return||I.return()}finally{if(O)throw C}}}}var _=N.map(function(e,t){e=Object.assign({},e,{width:B.suffixPixel(B.itemSchema(e.width,"string")),attachmentId:B.itemSchema(e.attachmentId,"string"),uuid:B.itemSchema(e.uuid,"string"),comments:B.itemSchema(e.comments,"string[]")||[],src:B.itemSchema(e.src,"image_url"),height:B.suffixPixel(B.itemSchema(e.height,"string")),currWidth:B.suffixPixel(B.itemSchema(e.currWidth,"string")),currHeight:B.suffixPixel(B.itemSchema(e.currHeight,"string")),natrualWidth:e.natrualWidth?parseInt(e.natrualWidth):0,natrualHeight:e.natrualHeight?parseInt(e.natrualHeight):0,imageType:e.image_type?B.itemSchema(e.image_type,"string"):"",fileToken:e.file_token?B.itemSchema(e.file_token,"string"):""});var n=Object(J.w)(e);B.initDecryptImage(n);var i=Object(J.b)(e.src)?"":"image-illegal",r="image/gif"===e.imageType,o=e.uuid,a=Object(J.c)(o),s=e.currWidth,c=e.currHeight,l=e.natrualWidth,u=e.natrualHeight;s&&e.width===e.currWidth||(s=e.width,c=e.height),e.src=n;var d=0<N.length?Y.q.map(function(e){return e.includes("c")?'<span class="point '.concat(e,'"></span>'):'<span class="point '.concat(e,' n-icon-dragable"></span>')}).join(""):"",h=N.length,f="";B.shouldShowGuide&&(f='data-selector="galleryUserGuide"',B.shouldShowGuide=!1);var p=e.imageType||"",g=p?"".concat(p.split("/").join("-"),"-container"):"",m='\n        <div class="history-deleted-mask" style="z-index: 1">\n          <div class="history-deleted-mask_text">'.concat(Z("history.deleted"),"</div>\n        </div>").trim(),v=1;l&&u?v=u/l:isNaN(parseInt(c))||isNaN(parseInt(s))||(v=Object(J.D)(parseInt(c)/parseInt(s),6));var b,y=B.checkShouldShowLoading(e),E=B.getImgSrc(e);(Object(ie.c)()||a)&&(b=Object(J.x)(e),E=a?Y.p:b,B.markDecryptImgLoadBySSR(n,o),r&&B.setLoadedGifResource(b,b)),e.isUnsupported&&(E=Object(J.l)()),B.imgPrerenderRegist(E,o,D,x);var O,C="",k="";y?(C=B._loadingBackground[n],O="padding-top:".concat(100*v,"%;width:").concat(s,";max-width:100%;"),C&&(O+="background-image:url('".concat(C,"')")),k='<i class="ignore-collect image-loading layout-main-cross-center '.concat(C?"loading-modal":"","\n            ").concat(1<h?"multi-images-loading":"",'" style="').concat(O,'">').concat(De,"</i>")):delete B._loadingBackground[n];var I=Q.a.modernIE?'contenteditable="false"':"",S=e.comments.join(" ")||"",T=1<h?"multi-images":"",_=Q.a.isMobile?"user-select:none;-webkit-user-select:none;":"",w=parseFloat(s),j=1<h?'style="max-width: 100%; width:'+w+"px;"+_+'"':"",M=j&&"height: 100% !important;position: absolute;left: 0;top: 0;",L='style="width:100%;padding-top:'.concat(100*v,'%;height:0;vertical-align:top;"'),R=B.getLoadGifIconHtml(e);return'<div draggable="false" id="container-wrap-'.concat(Y.u,"-image-").concat(o,'"\n          class="image-container-wrap\n          ').concat(P&&P[o]?Me.f+" "+Object(je.a)(P[o]):"",'"\n          ').concat(I," data-gallery-index=").concat(t,"\n          ").concat(j||(y?'style="width:100%;"':"")," >")+"<div id='".concat(Y.u,"-image-").concat(o,"'\n            class='image-container ").concat(S," ").concat(T," ").concat(g).concat(i,"'\n            ").concat(j?L:""," data-dynamicFlex=").concat(e.scale,">")+R+(B.isInHistory?m:"")+k+'<img data-uuid="'.concat(o,'" class="ssr-reuse" id="ssr-reuse-').concat(o,'" data-src="').concat(n,'"\n              data-file-token="').concat(e.fileToken||"",'" src="').concat(E,'" ').concat(f,'\n              data-width="').concat(s||"",'" data-height="').concat(c||"","\"\n              style='").concat(M||"width:"+s,"'/>")+d+'</div><span data-zero-space="true">&#8203;</span></div>'}),w=1<N.length?"multi-image":"",j='<div class="gallery '.concat(w,'" data-fake-text="*">')+this.generateDropImageHint("edge-left")+_.join(this.generateDropImageHint("middle"))+this.generateDropImageHint("edge-right")+"</div>";return Object(J.B)(j)}},{key:"getLoadGifIconHtml",value:function(e){if(e){var t=e.image_type,n=e.uuid;if(!("image/gif"===t)||this.isInHistory)return"";var i=this.gifStatusMap[n]||{},r=i.isFetching?De:"",o=i.isFetching?"":"gif-load-icon-content-active",a=this.shouldShowGifLoadIcon(e)?Y.f:"";return'<div class="ignore-collect layout-main-cross-center gif-load-icon '.concat(a,'"><i class="gif-load-icon-background"></i><i data-uuid=').concat(n,' class="gif-load-icon-content ').concat(o,'">').concat(r,"</i></div>")}return""}},{key:"shouldShowGifLoadIcon",value:function(e){if(!e)return!1;var t=e.src,n=this.checkShouldShowLoading(e),i=this.getImgUrlPath(t),r=this.gifResourceMap[i]&&this.gifResourceMap[i].origin;return!n&&!r&&Object(J.y)(e)}},{key:"suffixPixel",value:function(e){return-1<"".concat(e).indexOf("px")?e:"".concat(e||0,"px")}},{key:"initDecryptImage",value:function(e){e&&(this.decryptImages[e]=this.decryptImages[e]||{finished:!1,uuids:[]})}},{key:"markDecryptImgLoadBySSR",value:function(e,t){e&&(this.decryptImages[e]||this.initDecryptImage(e),this.decryptImages[e].uuids.push(t))}},{key:"reMarkImageLoadBySsr",value:function(e,t){var n,i;e&&(n=e.uuid,i=Object(J.w)(e),this.getIsLoadBySsr(i,n)&&this.markDecryptImgLoadBySSR(i,t))}},{key:"getIsLoadBySsr",value:function(e,t){if(!e||!t)return!1;var n=(this.decryptImages[e]||{}).uuids;return(void 0===n?[]:n).includes(t)}},{key:"getUploadSrcByWebUploader",value:function(e){if(e){var t=e.src,n=e.uuid;return this.uploadDispayUrl[t]||this.uploadDispayUrl[n]}return null}},{key:"getImgSrc",value:function(e){if(e){var t=e.src,n=this.isImgNeedDecrypt(e),i=this.getDecryptedImgSrc(e),r=this.decryptImages[t]&&this.decryptImages[t].finished?i:Y.p,o=this.getUploadSrc(e);return n?r:o||t}return null}},{key:"getDecryptedImgSrc",value:function(e){if(!e)return null;var t=e.src,n="image/gif"===e.image_type,i=this.getImgUrlPath(t);if(n&&this.gifResourceMap[i]){var r=this.gifResourceMap[i],o=r.cover;return r.origin||o}return this.decryptImages[t]&&this.decryptImages[t].blobUrl}},{key:"getSsrSrc",value:function(e){if(!e)return null;var t=e.uuid,n="#ssr-reuse-".concat(t),i=document.querySelector(n);return i&&i.src}},{key:"getUploadSrc",value:function(e){return e.externalLoading?e.src:this.getUploadSrcByBase64Upload(e)||this.getUploadSrcByWebUploader(e)}},{key:"markNodeClean",value:function(e){this.editorInfo&&this.editorInfo.markNodeClean(e)}},{key:"filterImgFromAlinesAttribs",value:function(e){var o=this,a=[];return e.forEach(function(e){e.forEach(function(e){var t,n=h()(e,2),i=n[0],r=n[1];i&&r&&o.checkIsImageAttr(i)&&(t=Object(J.A)(i,r),a=[].concat(d()(t),d()(a)))})}),a}},{key:"getImageKey",value:function(e){var t=null,n=/\/file\/f\/(\w*)\//,i=e.match(n);return i&&i[1]&&(t=i[1]),t}},{key:"checkIsImageAttr",value:function(e){return/gallery|image-uploaded/.test(e)}},{key:"reuseAlignFullStyle",value:function(e){e.hasClass("align-full")&&this.alignFullStyleCache&&e.find(".image-uploaded").css(this.alignFullStyleCache)}},{key:"addGifImageData",value:function(e,t,n){this.gifImageSrcMap[e]={origin:t,frame:n}}},{key:"log",value:function(e,t){Object(U.default)(e,t)}},{key:"isImagePreviewerLine",value:function(e){var t=this.editorInfo.getRep();if(e<0||e>t.lines.length()-1)return!1;var n=Object(w.default)(t.lines.atIndex(e),"lineNode");return!(!n||!n.querySelector(".image-previewer"))}},{key:"getSelectedImgOnLine",value:function(){var e=this.editorInfo.getRep(),t=e.selStart[0],n=function(e){return Array.from(e).map(function(e){return e.dataset.uuid})},i=document.getSelection();if(!i.rangeCount||"Caret"===i.type)return null;var r=e.lines.atIndex(t).lineNode,o=i.getRangeAt(0).cloneContents(),a=r.querySelectorAll("img"),s=o.querySelectorAll("img");return Object(M.default)(n(a),n(s))?a:null}},{key:"toImageArray",value:function(e){return e&&e.length?Array.from(e):e?[e]:[]}},{key:"aceBeforeCopy",value:function(e){var t=this.editorInfo.getRep(),n=t.selStart[0],i=t.selStart,r=t.selEnd,o=Object(R.l)(t,n),a=!!this.editorInfo.managers.getLineManagerWithSpecialSelection(be.a);if(o&&i[0]===r[0]&&!a){var s=this.toImageArray(this.getSelectedImgOnLine()||this.getImageSel());if(s.length)return x.a.setRangeOnCloneImages(s)}}},{key:"_formatGalleryItem",value:function(e){var t=e.height,n=e.width;return Object.assign({},e,{height:"".concat(parseFloat(t),"px"),width:"".concat(parseFloat(n),"px")})}},{key:"_formatGallery",value:function(e){var c=this,t=Object(B.$)("<div></div>").html(e),n=t.find(".gallery");return 0<n.length&&n.each(function(e,t){var n,i,r=Object(B.$)(t),o=r.attr(Y.a)?r:r.parent(),a=o.attr(Y.a),s=Object(J.C)(a);s&&(n=Array.from(o.find("img")).reduce(function(e,t){var n=t.dataset.uuid;return n&&e.push(n),e},[]),0===(i=s.items.reduce(function(e,t){return n.includes(t.uuid)&&e.push(c._formatGalleryItem(t)),e},[])).length?r.remove():o.attr(Y.a,JSON.stringify(Object.assign({},s,{items:i}))))}),t.html()}},{key:"editorWillCopy",value:function(e){Object(we.a)(e,this.filterSelectedImageAttribs)}},{key:"serialize",value:function(e){var t=e.op,n=e.type;if(!t||n!==Ce.u.LEAF)return e;var i=t.attributes;if(!(i&&(i.gallery||i["image-uploaded"])))return e;var r=this.generateImageCopyNode(i);return this.addDataGallery(i,r),Object(Oe.b)(),Object.assign(e,{node:r})}},{key:"addDataGallery",value:function(e,t){var n,i=e.gallery;i&&(n=Object(J.z)(i).items||[],t.setAttribute(Y.a,JSON.stringify({items:n})),t.classList.add("gallery"))}},{key:"generateImageCopyNode",value:function(e){var t=this.parseImagesFromAttribsMap(e);if(0<t.length){var n=document.createElement("div");return n.classList.add("image-uploaded"),t.forEach(function(e){var t=Object(Oe.a)(e);t&&n.appendChild(t)}),n}return null}},{key:"parseImagesFromAttribsMap",value:function(e){var t=Object.keys(e).find(function(e){return"gallery"===e||"image-uploaded"===e});return Object(J.A)(t,e[t])}},{key:"aceCopy",value:function(e,t){t.html=this._formatGallery(t.html)}},{key:"aceCut",value:function(e,t){t.html=this._formatGallery(t.html);var n=t.rep,i=n.selStart[0];this.doCut(n,i,this.editorInfo,t)}},{key:"aceAfterCompositionEnd",value:function(e,t){this.uploader.compositionEndSubject.next()}},{key:"aceKeyEvent",value:function(e,t){var n=t.evt,i=t.padShortcutEnabled,r=t.isTypeForSpecialKey,o=t.editorInfo,a=n.which,s=n.type,c=n.keyCode,l=n.ctrlKey;if("keydown"!==s)return!1;if(!P.b.pcImageViewerShown()){var u=String.fromCharCode(a).toLowerCase(),d=_.c.RETURN,h=_.c.BACKSPACE,f=_.c.DELETE;if(!("c"===u||"x"===u||c===d||c===h||c===f||c===X.c.D&&l||Object.values(_.a).includes(c)))return!1;if(Q.a.windows&&Object(X.d)(n)&&("c"===u||"x"===u)){if(!this.checkIsImageLine(o))return!1;var p=o.getRep().selStart[0];return!Q.a.modernIE&&"x"!==u||(this.setSelectionOnImage(p),n.preventDefault()),document.execCommand("c"===u?"copy":"cut"),!0}if(r&&c===d&&i.return){if(!this.checkIsImageLine(o))return!1;var g=o.getRep();return this.doReturn(g,o),n.preventDefault(),!0}if(r&&(c===h||c===X.c.D&&l)&&i.delete){o.fastIncorp();var m=o.getRep();return this.doDelete(m,o,n,t)}return r&&c===f&&i.delete?this.handleDeleteKey(o,t):!!Object.values(_.a).includes(c)&&Object(Te.F)(o,n)}n.preventDefault()}},{key:"stripImgFromHtml",value:function(e){var t=!1;return e.querySelectorAll("img").forEach(function(e){e.getAttribute("data-suite")||(t=!0,e.parentElement.remove(e))}),{hasExternalImg:t}}},{key:"pasteDriveImg",value:(t=p()(f.a.mark(function e(t){var n,i;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.fileTokenToSuiteMap,i=t.fileTokenList,this.needReplaceTokenMap=n,i.length)return this.log("doc_replace_drive_token_start",{count:i.length}),e.next=6,this.replaceToken(i,n);e.next=7;break;case 6:this.log("doc_replace_drive_token_end",{count:i.length});case 7:case"end":return e.stop()}},e,this)})),e)},{key:"getDriveImageData",value:function(e){var t=Array.from(e.querySelectorAll("img")),n=[],i={};return t.forEach(function(e){var t;!e.dataset.suite||(t=Object(se.d)(e.dataset.suite)).fileToken&&t.objToken!==Object(ce.g)()&&(n.push(t.fileToken),i[t.fileToken]=t)}),{fileTokenList:n,fileTokenToSuiteMap:i}}},{key:"getPasteImageSelection",value:function(a){var e=function(e){return/(gallery|image-uploaded|clientside-gallery|clientside-image-uploaded)/.test(e)};return this.editorInfo.getMatchedAttributePositionOnSelection(null,e).filter(function(e){var t,n=e.attrKey,i=e.attrValue,r=null,o=!1;return"gallery"===n||"clientside-gallery"===n?o=(r=JSON.parse(i)).items.some(function(e){return a[e.file_token]}):"image-uploaded"!==n&&"clientside-image-uploaded"!==n||(r=Object(q.c)(i),t=Object(se.g)(decodeURIComponent(r.src)),o=a[t]),o})}},{key:"clearPasteImage",value:function(e){var o=this,t=this.getPasteImageSelection(e);this.editorInfo.callWithAce(function(){t.forEach(function(e){var t=e.docPosition,n=t.selZone,i=t.selStart,r=t.selEnd;o.editorInfo.performDocumentReplaceRangeWithAttributes(n,i,r,"",[])})},"deletePasteImage",!0)}},{key:"handleDragStart",value:function(e){e.preventDefault()}},{key:"destory",value:function(){var e;this.uploader&&this.uploader.compositionEndSubject&&this.uploader.compositionEndSubject.complete(),this.galleryComment&&this.galleryComment.destroy(),this._externalImageSaver&&(this._externalImageSaver.destroy(),this._externalImageSaver=null),this.gifImageSrcMap={},this.editorInfo&&(e=this.editorInfo.getInnerContainer(),Object(B.$)(".image-uploaded img",e).off())}},{key:"destroyImageWorker",value:function(){this.postMsgToWorker({type:T.h.Destroy,data:{pluginId:this.pluginId}})}},{key:"reset",value:function(){var n=this;this.decryptImages={},delete Ne[this.pluginId],this.tasks={},this.uploadDispayUrl={},this.decodedImageList=[],this.gifResourceMap={},this.gifStatusMap={};var e=this.ace.editorInfo;if(C.a&&this.destroyImageWorker(),C.a.removeMessageHandle(this.handleMsgFromWorker),this.isInPresentationMode=!1,Object(ie.c)()||e.pure||P.b.unbind(),e.pure)delete Ne[this.pluginId];else{C.a&&this.destroyImageWorker(),C.a.removeMessageHandle(this.handleMsgFromWorker),x.a.destroy();for(var t=0,i=Object.keys(Ne);t<i.length;t++){var r=i[t];delete Ne[r]}}this.isInPresentationMode=!1;var o=e.getInnerContainer(),a=this.containerCls;Object(B.$)(o).undelegate(".image-uploaded img","dragstart",this.handleDragStart),a||this.unBindImageMouseEvent(),this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.hoverGalleryTimer&&(clearTimeout(this.hoverGalleryTimer),this.hoverGalleryTimer=null),this.hoveredGalleryItemId=null,Object.keys(this.tasks).forEach(function(e){var t=n.tasks[e];t.task&&t.task.abort()}),this.tasks={},e.off("galleryImageChoosed",this.handleGalleryItemsChoosed),e.off(Ce.k.WILL_DELETE_FROM_CUT,this.handleCut),e.off(Ce.k.CONTENT_CHANGE,this.onEditorContentChange),e.off("editorbar:changedSelection",this.handleToolbarChangedSelection),this.ace=null,this.uploader&&this.uploader.destroy(),window.removeEventListener("resize",this.debounceResize),P.b.hidePcImageViewer()}},{key:"fullscreenEntered",value:function(e,t){this.isInPresentationMode=!0,P.b.setIsInPresentation(!0),this.handleImageAlignFullChange()}},{key:"fullscreenExited",value:function(e,t){this.isInPresentationMode=!1,P.b.setIsInPresentation(!1),this.handleImageAlignFullChange(),P.b.hiddenPcFullScreenViewer()}},{key:"handleLoadOriginGif",value:function(e){var t,n,i,r,o,a;Object(ie.c)()||(t=e.target,n=Object(B.$)(t).attr("data-uuid"),(i=this.gifStatusMap[n]||{}).isFetching||(r=this.getImageFromAttr()||[],(o=Object(O.a)(r.map(function(e){return Object(J.A)(e.attrKey,e.attrValue)})).find(function(e){return e.uuid===n}))&&(a=Object.assign(o,{forceLoadGifOrigin:!0}),this.loadImagesByPriority([a]),this.gifStatusMap[n]=Object.assign({},i,{isFetching:!0}),this.updateGifLoadIconStyle(n))))}},{key:"updateGifLoadIconStyle",value:function(n){var i=this;n&&this.editorInfo&&this.editorInfo.getObserver().withoutRecordingMutations(function(){var e,t=Object(B.$)(".gif-load-icon-content[data-uuid=".concat(n,"]"));!t||(e=i.gifStatusMap[n])&&e.isFetching&&t.removeClass("gif-load-icon-content-active").append(De)})}}]),u}(),E()(a.prototype,"handleImageAlignFullChange",[t,n],Object.getOwnPropertyDescriptor(a.prototype,"handleImageAlignFullChange"),a.prototype),E()(a.prototype,"collectGifUuidList",[i,r],Object.getOwnPropertyDescriptor(a.prototype,"collectGifUuidList"),a.prototype),E()(a.prototype,"onEditorContentChange",[$.Bind],Object.getOwnPropertyDescriptor(a.prototype,"onEditorContentChange"),a.prototype),o=a))||o)}).call(this,Fe("2vAP"))},aim4:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r});var i=function(){var n=window.User.minaConfig||{},i=n.unsupportedAttrs||{};return Object.keys(i).filter(function(e){var t=i[e];return!n[t]})}(),r=function(e){return!i.includes(e)}},avPc:function(e,c,l){"use strict";(function(d){var e=l("J4zp"),h=l.n(e),t=l("lwsE"),n=l.n(t),i=l("W8MJ"),r=l.n(i),o=l("q1tI"),f=l.n(o),a=l("L9nM"),p=l.n(a),g=(l("3BrA"),l("aim4")),m=l("y2sV"),v="unsupported-feature",s=function(){function t(e){n()(this,t),this.editor=e}return r()(t,[{key:"aceAttribsToClasses",value:function(e,t){var n=t.key,i=t.value,r="".concat(n,"-").concat(i);return Object(g.b)(r)?null:[r,"single-line",v]}},{key:"aceCreateDomLine",value:function(e,t){var n=t.spanClass,i=t.attrObj;n&&n.includes(v)&&(Object.assign(t,{editable:!1,rawHtml:'<img class="warning-icon" src="'.concat(p.a,'" /><p>').concat(d("block.placeholder.new_app"),"</p>")}),this.fallbackUnsupportedFeature(i))}},{key:"match",value:function(e,t){var n="".concat(e,"-").concat(t);return!Object(g.b)(n)}},{key:"render",value:function(e){for(var t=e.attributes,n=e.children,i=!0,r=[],o=0,a=Object.entries(t);o<a.length;o++){var s=h()(a[o],2),c=s[0],l=s[1],u="".concat(c,"-").concat(l);Object(g.b)(u)||(i=!1,r.push(u))}return i?n:(e.lineClass="".concat(e.lineClass," single-line"),this.fallbackUnsupportedFeature(t),f.a.createElement(m.l,{className:"".concat(r.join(" ")," ").concat(v)},f.a.createElement("img",{className:"warning-icon",src:p.a}),f.a.createElement("p",null,d("block.placeholder.new_app"))))}},{key:"aceCopy",value:function(e,t){var n=t.html,i=document.createElement("div");i.innerHTML=n;var r=i.querySelectorAll(".".concat(v));r.length&&(r.forEach(function(e){return e.remove()}),t.html=i.innerHTML)}},{key:"fallbackUnsupportedFeature",value:function(e){e&&e.zoneId&&this.editor.initZone(e.zoneId,!0)}}]),t}();c.a=s}).call(this,l("2vAP"))},avrJ:function(e,t,n){},b5Yl:function(e,t,n){},b5gA:function(e,y,E){"use strict";(function(e){E.d(y,"a",function(){return b});var t=E("lwsE"),i=E.n(t),n=E("W8MJ"),r=E.n(n),o=E("cDf5"),c=E.n(o),l=E("HmyT"),a=E("xKvl"),s=E("4PSP"),u=(E("s4BX"),E("VIFs")),d=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},h=".link-noty-popup",f=".doc-popup-container",p=Object(u.getPublicDocs)("airtable-block"),g='<div class="link-noty-popup layout-row link-popup_hidden">\n    <div class="link-noty-content">\n      <span class="link-noty-text">'.concat(e("iframe.airtable-noty"),"</span>\n      <a href='").concat(p,'\' class="link-noty-btn" target="_blank" rel="noopener noreferrer">\n        ').concat(e("iframe.view-example"),"\n      </a>\n    </div>\n</div>\n"),m='<div class="link-noty-popup layout-row link-popup_hidden">\n    <div class="link-noty-content">\n      <span class="link-noty-text">'.concat(e("iframe.amap-noty"),"</span>\n    </div>\n</div>\n"),v=function(){function t(e){var n=this;i()(this,t),this.linkNotyClick=function(){n.clearTimer(),n.hide(),n.log()},this.onClickOutside=function(e){var t=e.target;0===Object(l.$)(t).parents(h).length&&(n.clearTimer(),n.hide())},this.onMouseEnter=function(e){n.clearTimer()},this.onMouseOut=function(e){n.hideAfterDuration(3e3)},this.template=e}return r()(t,[{key:"init",value:function(){this.container=Object(l.$)(f),this.popup=Object(l.$)(this.template),this.popup.appendTo(this.container),this.popup.delegate(".link-noty-btn","click",this.linkNotyClick)}},{key:"log",value:function(){}},{key:"destroy",value:function(){Object(l.$)(window).off("click",this.onClickOutside),this.popup.undelegate(".link-noty-btn","click",this.linkNotyClick),this.popup[0].removeEventListener("mouseenter",this.onMouseEnter),this.popup[0].removeEventListener("mouseleave",this.onMouseOut),this.clearTimer(),this.popup=null}},{key:"clearTimer",value:function(){this.timer&&(window.clearTimeout(this.timer),this.timer=void 0)}},{key:"hide",value:function(){this.popup.addClass("link-popup_hidden"),Object(l.$)(window).off("click",this.onClickOutside),this.popup[0].removeEventListener("mouseenter",this.onMouseEnter),this.popup[0].removeEventListener("mouseleave",this.onMouseOut)}},{key:"show",value:function(e){var t=this;this.popup.css({left:"-2000px"}),this.popup.removeClass("link-popup_hidden");var n=e.getBoundingClientRect(),i=this.popup[0].getBoundingClientRect(),r=this.container[0].getBoundingClientRect(),o=(n.width-i.width)/2,o=Math.max(0,o),a=n.left-r.left+o,s=n.top-r.top-i.height-10;this.popup.css({left:"".concat(a,"px"),top:"".concat(s,"px")}),window.setTimeout(function(){Object(l.$)(window).on("click",t.onClickOutside),t.popup[0].addEventListener("mouseenter",t.onMouseEnter),t.popup[0].addEventListener("mouseleave",t.onMouseOut)}),this.hideAfterDuration(5e3)}},{key:"hideAfterDuration",value:function(e){var t=this;this.timer=window.setTimeout(function(){t.timer=void 0,t.hide()},e)}}]),t}();d([Object(s.Bind)(),Object(a.b)("click_airtable_error_viewexample",function(e){e.context;return{withFileInfo:!0}})],v.prototype,"log",null);var b=function(){function e(){i()(this,e),this.badCases=[{regex:/^https:\/\/airtable.com\/[^\s]*$/,noty:new v(g)},{regex:/^http:\/\/f.amap.com\/[^\s]*$/,noty:new v(m)}],this.badCases.forEach(function(e){return e.noty.init()})}return r()(e,[{key:"destroy",value:function(){this.badCases.forEach(function(e){return e.noty.destroy()})}},{key:"testUrlAndShowNoty",value:function(t,n){this.badCases.some(function(e){return!!e.regex.test(t)&&(e.noty.show(n),!0)})}}]),e}()}).call(this,E("2vAP"))},b6qs:function(e,t,n){"use strict";var i=n("HA5h"),r={},o={init:function(e){},reset:function(){r={}},setCacheInfo:function(e){Object(i.a)(r,e)},getCacheInfo:function(e){return r[e]},getAllCacheInfo:function(){return r}};t.a=o},bCSi:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n.n(f),g=n("m/+l"),m=n("D7h9"),v=n("5cZX"),b=n("XMIC"),y=n("jBvr"),E=function(e){return{embedObjPermissions:Object(v.y)(e)}},O={openModal:b.c},C=Object(g.connect)(E,O)(y.a),k=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return h()(t,e),a()(t,[{key:"render",value:function(){return p.a.createElement(g.Provider,{store:m.default},p.a.createElement(C,this.props))}}]),t}(f.Component);t.a=k},bCqk:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABbQAAADcCAMAAACf49d1AAAAn1BMVEXv8PFkanOPlZ7n6OmHjJPt7u9uc3zEx8uVmaDc3uBnbXbQ0tV/hYzIy867vcJ9gonT1dfr7O7Aw8d6f4aYnKLN0NOLkJeSlp2tsbZqb3hyd3/f4OKztrvh4+WPk5nk5uegpKrp6uuan6S9wMTLzdB1eoKDiI+kqK2qrrO4u8Da3N6nq7G2ub2ws7h3fIXV19qdoahwdX5rcXrX2dv///8tA35dAAAYdklEQVR42uzBgQAAAACAoP2pF6kCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGD24EAAAAAAAMj/tRFUVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVYU9OKYBAAYBALaHBCuEA/yrmw2OtgAAAAAAAAAAAAAAAAAAcEdM9WZu18Tjs2en62kCYRSAz5EdFQUtLqDiwuKuae//2lqtcQAVq3RJW98/+RFDhu88cyCTl5eXl49MmuuVM30u4eXl5eXlo1IcvZKhOwpKUPDrjJNOMsb/5fWnz8tHYQdhbYq/m/8PvJRKceVCLOFx8cQDAK0XSbiu9NGLEu3b+0hBedsqCgwWH+DJ8LPmaUXRCn+I1ForKLDqx/jZFNxg4xfx/oEa+DHtcB2YDj62MXJGawdn3tsQec0R/irepHLFxEOeod1g4EjZcwag2WMsHSnIGZh9CY/xvMxVNHrwWEdpczZQIKKGQoNgiTxvhgJ/bJ7zXhD01vhltpZXUMpswZikIUPmHNd8Wlp41vRNx1XxW63tV+1nHj0tcY/VAXJkWiijOnp2LfkcfjX7UNj6EDnl51k+d8HbBAoy6uzjpGrAYYKsHZf4m0iTylUTCTk+b/DfCzVUAGPPd5+Rk/DhuHNXsfYKlL2F0kY9FlWszCkuTdwtThZUkRfQRYE/Nc9aACxbN941p8tPuK/wuCxhBze1uEKVaThSvhuQnpKGky5lPGtHHVcNeWBGy5mNh0ikgRMljPI/rTNBCeMetfysi9fyYA7K+IrnS7vt4kL5eYrcSzJCvuW2yvp8VTtsjBFQQ4bGvY2/hxJXbogVZNX1G+o46jABmhvKywOXGymf+P69KMeehx9DLjKBmMHnoOfhR0hGsz71k3iiu3JUa23sy4a1jdm0u0twweUcl1qi6D32kDNWOUeR3z9PqTsGWgmwDgFg5LaREzHBXRobBdU+ZBe3zKiOUWVLe0e+j/K6mdi8T2fb4ArXjbfWrmaS7FWc50rm8wyfzAmylmyjBIemlJ918VoezGHOK4Y27hlckPTQjwuOR0rMs1zuwrbP/hZZEwY4qZo6lOEMGcqGFrKkD9ziTuUm58EgTHpK12RbOTZSTxVtu5CPauRx0n2TdMU3qxcGYpq50oamcq+h2DZuu7W+yRwJR9p07neX8ZBsqDwKcWLHy6S7Xvu+3+Dw22eCiT50p+nSPu+nEYmcFdUyQZefpxCGs+P0WlwCieqfTo6npIWMEdm8n8OqR3YGuCFkHYAtDRbb6qzuHMZbxUmHAVBlhHckjmrqwRv5pmZ8Epv34WxFI2xx4uGSPVvKJtvPlYyrGvC5ypdihBI6Ij0x68K1PJiDxSvC8f27vmD6QdiwcGA0Lxgl5lkud0F7Y8tDTsS57VW1uQNgRR8X1qwhq80YGasOPghJr6SMvowqgi7hESvKXkTK9YOVyeTwVcJBM5f8vhWJibi84N8ubSiegjvqPDD7NbcddJM3DqfNhXd+cqoU1IY7Saw6Tmxe0cXZRpS2RObX0WCMEkrPUxi/V/GcpgEl3u9jGwc6e9lxWtz/SA7ekFQdXDUiR0CdaavzoTuNy9IWLDYU5IjN+2C24iOqcspT70sQms7iHJ+1eK60R/3GGPoSGTP2gfHn+irWo8EzpyMWBDHrgrU8lsOlRY8a7pHUPJNB0b51S8yzVO6CT0YjCLEry1HNpMmD1rGOl7gg9TgbVB0/1uVNcrq9BGlN0sLHMK+kffnypZIyxxVakuLgzN5wZag9ZjVxYC8+f95udcrbhTeQxsjYNXJ69MVVSQOCEfi4b9C16tuRgoOpmn8xj+NkvbIcTTP5CVnK1Fr5vr9eryO6c8vR6rNqc5Qu7WqqF+38zjUHKPZr5yl8Pr+CRNmNJG3YyCy7w/YP5YB6SLYlXDFjCMAz1bARuRVdb092QRPfTSijoLSlPWcoKO1HshVi1pqGcsxTZgfCjnH5M9iqqedW1HRisqbmznfuGeRPR/KzLlrLoznkKTUOnzt8r6ZKe9/K2NMtMc8SuQvKjnTHSJF5om6i4W6dvR3Z7eh65XDQ0jB5NsFBRB8ZE6oDfASKXlTauoJLEwrp5JekhW2dLeubgLXDlxabOFuYPQM/QqYv5kp6eNfUSdPAI5ZUtwCgLOvICygjr/jfySGrqafJGICS7j8d9/ymeWrci/cDDSlNkwEERaVTmIMgtclQ/Hpjk9g4Wt/e/xrZLirtgEPcKe372Qpjp7tzWz0e9KImgFHIaTohv3xpY9W236f3lb1z3VIVB6Iwu7nZiALiDfGCCqjYIuj7v9ucIBpMuLQ6y9NrpvePnl4jHJMq8qVSqdDblRRryKXFUn+/y9dCjepo3uJqZwq7als3Q5v3Ay8xunBnC8d9ooKli0lx22fMumz4pD1f8zuVGwKre2iZ/sA8HmCXoWyJO52MYTLu+p9WngpdM1cHSISfoOMHB+2iGNvM1gMCmWS9Xk9Of37syWPSOUQXhGTLh/bF5v3LwkwqQEYOcSCQewzaIoV2RwLQMh9MMTgXzMqSwj3pixNUQTyrX5sRh1uPDcpk0Y3MFOP112G7SfqjIWAHinai/5qG5ra9yZ4HSskVdOYjFLzqA2KDH6h6yoSGGnPoN1N5VRU66RXainRVEdpHMgWbrYK2/OBt9i2fgw0lsiAmJjOL4ZGE3ivQ5pUCgKLPPQXTB6OwFnDaLi9W4EpYeVvXtaXWDyxX5/nUfeAemf7Vrolf/UR4/yq0qV7wO5WfQivNDmzKdzBkv6OqZDV9jD5nHvS7waRwXlnD+RHl+Lt6aDMW6OCDUIDMQLZCaioxJzzpXfxZgIzoYMFCZoN5T0q1UL3Yy+w+BO3j3gYczxUekg8ts3y3JSwCY3n54kGn94e84723CnBSkEmzWDezI0BDqSi0xwiFRr3Jni2saLnNfagtG8V2jiA1Tp5UM4p7n+YB+thWlpVcoV1U8Qs2JDlQUMgM3ibfMkr2Xd/tIiYroeSSrepjyGS3/kVof311zmLWk/LscTKnWjHA6AZAOrWIswyBEW/rxrZQPzRD21QwLADKIqvQSLt+iVGZu/0EBn8d2tTvjOQ9XZ4wytzjjvdeQpIhuh3oJU2a3D/u4GIwa4KD8AO0r4f2/tuQ6WIiXSBzMgwjhpZnRU16r6ZjMrSBtSCuRwqw+Ca0Z0J7EwOYjB+d52QDu3xZdxBMbZRv19xJ0T+8qXqW80dmPspygZ4Ou98afcyHUr7mDCaxEWqQ+glJia97KnB0i8ddYvQWh83aEur0JnumWNOxzEwmA0At/N6phXaNZecUzRWXdaGtMmgvTaIhtiYRjRhAtgkX7av20Ngqgmbf8hrmi6QwW826Do50U3v2PLSD1br67lV5lBuDiiOzNVWAoOtqHCR5Wze2hfqhGdr+CUPrLsgmlXNb8pPMFtVW2mMi10P7aXu+7vdIB0Zi+T3ZMzAAVSzwWuPk1k4rxETCD1BSD+3k25CJMRiRh+94YYtm5DpfJ2kFkAbZE5IONQCG534T2q0JgHTly2zFZolEhhrXVFYCX1gPstvmrZWXb0X6O2htpviKUypQKRSaFiDf2ybwFQBSbSHVe+xpFgkesWCeI6TbUUPhKWh/QYuajgMuT1h/oU/Df+Y6VcO0eHmCdFA/eHnfUvFpqt6Fkx72V0vk6yLR7PTai0ehTWR7qlUNQ15t/6pNWXfE/Qk4URJW27quLfV+4E9jqdqV2XTLe5uVh47zgp6qbcgJ9kIztJvHJt+H1/3ec6Csq5LAcGRBcC+jvjM4RrNSuEtFJ7olUaULRMLfV6se2q1SyJDKWkD5IwqZ1lYgkMlHH9C7L5MV7Tzb5HrZyYb14puwWADAJPHl5gMDfIkTrZi3QqX0GxOQ1CHVZ3vgd0iiqw/J9wdt0zxG5dAWobG1tk6w8Zz6cOc99hxDF6pTIG3Ei1v57vkpaLsK6HxuVBWP2RuhBtq+BvQKrYoRzpoHL+9bnnFxPlQvjDZh36o0JAJKPQdGT34I2t19qAFQvHMZMq6kE4/q1BR4TctPK84SDZjzDeFt3dwW3g+8PKysgDKbrto+yU+HOGBUWWKzQSo2Q7t5bPJ9eN3vLmC7NcWztcG7O1DbriXMUkzZSJs/3vv39RS0bUmSHO3PD4NC5iznkFn2AgS7k2aS30f5gRBLQtomCF5pADwmGG2AdjIofajXkxJ1mcLV5c2pa2YUnn3VXAhLA5L8/a14pXBqAwoT32EuklBGug5TYyxweo89w7txZ7Jo7si3LN5KeAbaCxuFOTDAIPufXe4ErZxBuyddlMLOfyMdNE8oQtsHPLl28K7HM8a3Va3e3C4RLzA7XqGzscYKEEutZBgAkvxgTltUPRtA2OW+ug1nPU6GBulUKfT2SKqaC0jUmJW2bm4L7wdeI+yFqG/xmZU5obDSIbXZ8CviVQ07oQHatWOzpg8v+90F9Eorzuuy/e05LtK3Y2i07xraJVmwlvD3RdMj9HDNM+kRIgIZde4AK1HYk61Y30bq557IinR2CjSvj4PwELSfLo4cIKgYglMbmVJPDcqzkVMM66GtQmeKMkZyXixLzwJyeoc98/0iKr2iJRs4s2egLep3+/cx/AuW+HAmg/a07MxOpECfF6C9xrx+mSwH2HzHtzPgePtteWnY/tqfJIDx5eYbgQr6T2xEDloaaNPEo0oO1AS46mQPV72aElIe5ugDE+Kvels3t4X3A6+wPFR0s6M2LqGeV5V2kkMYchO0n7Xn636fAkq3IpI+oV1d8wycwtFqrqcgUm7h+gRqSdp7Ivx97T9qtX8UMgcEG1MQEwAbCZjnk99yZF4K3/uusMf4TdDeVdXpB4CebA+JpAAO2DqwxdElIWLZA3jCOVtOCYI1vI9Sbdh5/VZ6C3zWAqe32NOD/Z3j9VNgKzwBbUu6r/3WswaLCnbl0J61/2iQGkN42vB6On6EUOzfQbtVD+0utFmdb2mv4tvcpeXj3L6+FgBxTy7mZ6Jnqh0WBzvv/v4EKmkzVY9MrrSxRPyLxOUdBRqdeHlbN7al2Q8MiTiN526Obw29Sip2hCZoP2vP1/0uDGxAiko/yU/IloHEg3Otb7A6qxTOmZqTt2ME/ICiv109tHePQkYkIYMaYN4DwLDCw4lc+T5od5BW7D/bx9s5qxgI7/aGFABaHEOqhPYMTpzeb2G2Af8+ElgArsDpHfYUT/hij+iuyxJAkOQnoC2PmK2DIb4y6gZyObQzbTBoobu9jfvFSMx6OgajVsXgtdGv8S1VeAtpzTyBZTn24uIa9JfMzt1rJWrj7EDNlpzHMIjXHn5rZA9o5WdCPKHZ1nxbGvzA40tb1L+BvFVVuOo7dC30vpK/Zr9TWRvA2ZWuZj6yW7VN2dF/tWiGtk9zKvkXL4OP20Be/oidyGM9tI+lkGkdDofU+fMjYSFD3PGlE9PJKaZbFE1oEq49DO3ZC9AWy018vJu75U6rWOhjAJPRMAYAnU8OKhm0F8YJCLr3NbLS1UT2NX0SC7zeYc8DFMom2jqe2bEoPA7tKAQ2JfXBHvpCNbR99MlGpGWn1PRZTw/KRQ40JdOq/A0+X8C51rd09ozYzcGrf12VzVDuX4OMOGt4wx6Vjk4JCDVIVsabPtCSm2zNt6XJD/wl86YjjxUZbZU09Q3QfsLvVGacLUZ5239dYjXe3SrsSlPk8bkKh3acJPz/uuRWXU67JZdChoqDTLvvAB+fWezQWzg2cyrpcWgvidOeVYzku1kTen4wykbRFgDitcy6X81naJetbusxqe55aez0BntaATfQB3zUPwbSSHgY2vLU4TjiwWNS+By0xYmyyKpH/OK4rk2PqFCY0/e1vqXw/KDlbQ05awPq65ChZRlCnQKYfPRwgi7S3PZw2Wxrvi3NfqCaOQ09/gJWVcwOReEN0H7W7/T4f+rzuxyfl2Ii6xEWiPlOZFLslfEjXhrV9MIoHjKDXUE+l4NVNi750yGwsRVWUItZvcPFK0nnEVgEL5hpCuzLUBnUYN68HWPvhIDtM2ePx1WzspXDJ38KXHqgatEPgn4+/7/BnhtoLotahU2YeED8KTwM7U8JCHwuNhpmtg5mVdBeStjlJX99JPK3oB0Vj9svAtjWd3x7BoVj2PB28zNNUMre+kVoTxsq1TT+/p2CeFbkZa/R1nxbmv1AJRqsFfnV16q8UkuDIQpvgPaTfqdan4Ate4eRjdGy1p3hVFpkmLlUTIsAmnoDZky/Xc2vZuUhw4iBjExOBM5GUNQu+kKE1C3YLpRLg/0BK70IizmUtvCsPKDPRTiWg0P1Rk2Uh6uEj70Y8Kz7zMNnOd6Sm4mM/Jv1axQeYz5HnIVRb7DnUcO4YVlsHRQgXDzkB6LZ9lLKwsjMHvxPB8q4fTGWNYsWBWjPdAyvddoLGyPrO9CWJ7R/7Rja8Vu+bVF2Rg2cjdLCtQrGL0C7ORu25HawIomZN9Vps635tjT7gVpUwqlucTVboTyKXawAe1ECtWRwp+RZaL/ud6rIAIZ3dtMvvl0jKOFzig+50qXk+d8wewTMmH63mv8IwuOQIZZuaZBmwhRehi6r8BKM0F/mnXZN1aL+Y1WExfkEpKNkfzjsk9YwtCfKQ9kfAPrXwJWZyXq4pn4tfja6OFwcIZbJR1vAjgq4MxDvltf7FlH+qwu06VpMvd9qnxL79LIuvcGesg5D5p1cCCjk3QTQNswD3OiH5VoCMFFLjHxJ9B0nAOBM4lQD8EWhfSanOW6Ha9wA0rIW2nTMhAPyz589wOl8y7efIE3xTdKdkBi3UkdPKS74owAr+RVon6HJHH6oUoD8R759ttUAzge8rZvb0uyHXKYOqDU93Dvlu6HyVAHmfPT++vu0qZ73O69lC4ijomfg5icp4u5ndsVnW726fuBA34m3e0XmeLQ+B7PSZ8b0u9X858Z4yExGnIIiZJY7HUhJZ1ZkfrP0wlg0CSxiXQpjB6D7CUud11qg8nX2FU2PyGxpIAqi+yOv0Oxw3p+HtnIXdn9OAGM1VKD418k+WNyHZ4Bi2HEwUXAD8xZ2MRCwV3ZhtCTkCK3skBjmDfb8QllNqkjnkJkNQGfil0Y/uKsTAPvAh370DJ24bk2Qy6HQXiqQrMKJyM8UIx7aO7RKQio4hu4AsM3v+TaBntFECYdp6aJIGn70k2QeBgCkYmdcG8kr0F4CXFIKnOTrtxmAwfWp2da0LQ/6QbA8prSCkapkrOQ1MIC4NKHp6Zy8Z6D9ot95fWlQaIs3kPKeKACgBA6Awjt8UkALwvlcCg3m7Kk1B5hkDDum367mP+zLQ6ZMRciMAHtnCYJ4cDK7RKdNYf01HTrIlNrSRyR8V4tOd7zfkBeG7Hq++Sk8ptm2JQWaZt2/eHl0Qi7ncJdJ7GsANMmlrzi5H5xTI7/TSWMjfzRa2ph6OgEAhUY4BxLfqGRqeIc95XVp7fVmG9EAKezJDz8kCpSkijI7rOiF7vH8uZCLOW1Psu6OsR/T9j20o3NkhvD4wSkhkz6Vv+db+VKqvI+BcihauEpJjsxDFuDrBWgLKXzuJk40U6Ft5cdtTdvyqB8EeQiprgfuya6o4Ia2t4Tn1dyHV/3Oy1cKx8v6N7+K65F9AbcxpN9urUP6SvQV8w9tNsxExozpvyZ3VcpstwwyUpvTsAiZs6TmMMrDKfYIujU7R6LwdskLfgC7pu+3j9wHy2PnXA81MfpcLJnhWeR+b2rKBRpMnNXKCUThh9jTNYUntO5Z1fbgx18R2kuLefeIyCSCPkDUFnhZUac3mDX6ljuh7w7Uo1x2aYf8gdBpr+3yn55PWrVllpLU0Ixu75F9qcW50daPt0Wso7LYsJ8fVT3z40h4Rc19eNnvvCJ7RLvDjNWlVeKOY4e8VbvpG/kx/fckbkpyI2LpFLgtmXWkPMTYh+rV5nq46gm/uigaOs78U/hf2nMd05XBXmdiuX2+UlGHw+Hq79e/qp4s/Oq/IZEj8xvG9Hsl95gXR7V6v8/vv6hfY/7qV/8t/YAxLe5aBWTvfsAB+1/96le/+lWN5ONun7RayX53/AGTyK9+9Q97cCAAAAAAAOT/2giqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqsIeHAgAAAAAAPm/NoKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrQHhwQAAAAAgv6/doMdAAAAAAAAAAAAAAAAAAAA4AndP02O9CdYyAAAAABJRU5ErkJggg=="},bIgJ:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtwAAAGSCAMAAADnzebaAAAAP1BMVEXl5ujn5+r19vfk5eecoqmus7nj5efR1Njz9PXv8fKmq7Kgpq3f4uS3u8C0uL3p6+3N0dTHy8+/wsfY2t2wtLtBBvaRAAAAAnRSTlPsSYtYiOwAAAWUSURBVHja7NIxEcAwDAAxN57Cn3CD40/CoPlmIejVnnsg6M7sgaSVmyq5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZKbLLnJkpssucmSmyy5yZL7Z5cOZAAAAAAG+Vvf4yuG2JKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSm9i5m503YSCMwlI6BIe/QNL7v9Z6HKp8AUdedTFvz7MyXqIjBLaMLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOKGLOL+t9burM/zt6Vz6wU/EHcodjbe8vxmLxf8RNyRmG39weTzvduI+4C4IzG7Xr66EvcBcUfyJe7bcyLuCuKOpB73r8FsScR9RNyh1ONeLOuJ+4S4I6nHPVi2EfcJcUdSj/th2ZO4T4g7kj3ue58+vicXs40PyjPijuQV9zTanD7mb4nVkgrijsTj9rYt1806dxNxR+Jxe9ulbuJuIe5IctzedvEg7hbijsRsHW3XE3cLcUdib78/998TcZ8RdyT25jf6mi7FfWD7vYa4I7Hs/cadhjntbVuum7iPiDuS0xGFOZW23TIR9wFxR2J/rf7Afq13e9vFQNwHxB2J7bqUL2ZzS2mbY2Y1xB2J7aY8nmxH3N8QdyT2Mudh6oi7hbgjsWK85+FqxN1C3JFYsfm2zUjcTcQdibkhlQMKxN1E3JGYe/qNNuJuIu5Q/HdqDx88ugN+p1ZB3ABx4/9G3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JBF3JD1h106kAEAAAAY5G99j68YkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLbnZkpstudmSmy252ZKbLblrlw6KAAYBIIgd5YV/w/Wxk2gIWXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXKTJTdZcpMlN1lykyU3WXd7HwS97exC0M4PFp8M/ukGaV4AAAAASUVORK5CYII="},bNqd:function(e,t,n){"use strict";n.d(t,"a",function(){return E});var s,i,r=n("lwsE"),a=n.n(r),o=n("W8MJ"),c=n.n(o),l=n("cDf5"),u=n.n(l),d=n("hbEN"),h=n("2ACu"),f=n("Hj9z"),p=n("4PSP"),g=n("jp/M"),m=n("H6oK"),v=n("lG83"),b=n("mRaX"),y=(n("0nDA"),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":u()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a});(i=s=s||{}).GridView="GridView",i.Kanban="Kanban";var E=function(){function o(e){var n=this,t=e.editor,i=e.bitableBridgePlugin,r=e.eventEmitter;a()(this,o),this.className="Bitable",this.debounceRecalculatePosition=Object(d.default)(function(){n.updateVerticalPosition()},100),this.debounceSelectionChange=Object(d.default)(function(){n.iteratorBitableBlocks(function(e){e.selectionChange()})},500),this.fullscreenModeChanged=function(e,t){n.fullscreenOptions=t,n.updateSheetsByFullscreenOptions()},this.editor=t,this.eventEmitter=r,this.bitableBridgePlugin=i,this.fullscreenOptions=null,this.bindEvents()}return c()(o,[{key:"reset",value:function(){this.unbindEvents(),this.bitableBridgePlugin.destroy(),this.editor=null}},{key:"bindEvents",value:function(){window.addEventListener("keydown",this.preventKeyDown,!0);var e=this.editor;e&&(e.eventEmitter.on("aceSelectionChanged",this.debounceSelectionChange),e.eventEmitter.on("editorSizeChange",this.updateVerticalPosition),e.getScrollContainer().addEventListener("scroll",this.debounceRecalculatePosition),this.eventEmitter.on(g.events.PC.BITABLE.INSERT_GRIDVIEW,this.insertGridView),this.eventEmitter.on(g.events.PC.BITABLE.INSERT_KANBAN,this.insertKanban))}},{key:"unbindEvents",value:function(){this.debounceRecalculatePosition.cancel(),this.debounceSelectionChange.cancel(),window.removeEventListener("keydown",this.preventKeyDown,!0);var e=this.editor;e&&(e.eventEmitter.off("aceSelectionChanged",this.debounceSelectionChange),e.eventEmitter.off("editorSizeChange",this.updateVerticalPosition),e.getScrollContainer().removeEventListener("scroll",this.debounceRecalculatePosition),this.eventEmitter.off(g.events.PC.BITABLE.INSERT_GRIDVIEW,this.insertGridView),this.eventEmitter.off(g.events.PC.BITABLE.INSERT_KANBAN,this.insertKanban))}},{key:"preventKeyDown",value:function(t){this.iteratorBitableBlocks(function(e){e.preventKeyDown(t)})}},{key:"insertGridView",value:function(e){this.insertBitable(e,s.GridView)}},{key:"insertKanban",value:function(e){this.insertBitable(e,s.Kanban)}},{key:"updateVerticalPosition",value:function(){this.iteratorBitableBlocks(function(e){e.updateVerticalPosition()})}},{key:"iteratorBitableBlocks",value:function(i){var r=this;this.editor&&this.editor.plugins.blockPlugin.blockInfos.forEach(function(e,t){var n=e.instance;n.blockType===m.BlockType.BITABLE_BLOCK&&i.apply(r,[n,t])})}},{key:"insertBitable",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s.GridView,n=this.editor;if(e&&n){var i=Object(b.z)(n,e);if(!i)return;var r=i.selStart,o=i.selEnd,a=i.selZone;n.inCallStack("deleteBitbleAtHolder",function(){n.fastIncorp(),n.callStack.makeNewEvent("nonundoable",function(){n.performDocumentReplaceRange(a,r,o,"")})})}Object(h.collectSuiteEvent)("confirm_mention",{mention_type:"bitable",mention_sub_type:"grid",panel_source:e?"mention_panel":"a_panel",zone:Object(v.l)()}),Object(f.insertBitableBlock)(n,t)}},{key:"fullscreenEntered",value:function(e,t){this.fullscreenOptions=t,this.updateSheetsByFullscreenOptions()}},{key:"updateSheetsByFullscreenOptions",value:function(){var e,t;!this.fullscreenOptions||(e=this.bitableBridgePlugin.getBridge())&&(e.setZoom(this.fullscreenOptions.zoom),(t=this.fullscreenOptions.size())&&e.setSize(t.width,t.height+1))}}]),o}();y([Object(p.Bind)()],E.prototype,"preventKeyDown",null),y([Object(p.Bind)()],E.prototype,"insertGridView",null),y([Object(p.Bind)()],E.prototype,"insertKanban",null),y([Object(p.Bind)()],E.prototype,"updateVerticalPosition",null),y([Object(p.Bind)()],E.prototype,"iteratorBitableBlocks",null),y([Object(p.Bind)()],E.prototype,"insertBitable",null)},bPgG:function(e,t,n){"use strict";var i=n("lwsE"),o=n.n(i),r=n("W8MJ"),a=n.n(r),s=n("a1gu"),l=n.n(s),c=n("Nsbk"),u=n.n(c),d=n("iWIM"),h=n.n(d),f=n("7W2i"),p=n.n(f),S=n("FJEn"),g=n("o0o1"),b=n.n(g),m=n("yXPU"),v=n.n(m),y=n("RIqP"),E=n.n(y),O=n("lSNA"),C=n.n(O),k=n("J4zp"),R=n.n(k),I=n("cDf5"),T=n.n(I),_=n("YNKm"),w=n("7Kxq"),j=n("PyL4"),M=n.n(j),N=n("nN3d"),B=n("HIeq"),L=n("F9bh"),D=n("YWBl"),x=n("+KmE"),U=n("p3Wu"),P=n("aBgF"),z=n("HmyT"),H=n("y2sV"),F=n("PcuH"),V=n("q1tI"),W=n.n(V),K=n("fMYX"),Z=n("4PSP"),q=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":T()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Y=function(){function n(e){var L=this,t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];o()(this,n),this.editor=e,this.className="List",this.pasteLineNum=-1,this.willRenumberArr=[],this.handleWillDeleteFromCut=function(e){var t=L.editor,n=t.getRep(),i="",r="";t.managers.getLineManagerWithSpecialSelection()||(i=t.getLineListType(n.zoneId,n.selStart[0]),n.selEnd[0]!==n.lines.length()-1&&(r=t.getLineListType(n.zoneId,n.selEnd[0]+1))),(i||r)&&(L.cutList(n),e.preventEvent())},this.cutList=function(t){var e=L.editor,n=e.performDocumentReplaceRange,i=e.renumberList,r=e.deleteNumberList,o=t.selStart[0],a=t.selEnd[0],s=t.lines.atIndex(o),c=t.selStart,l=t.selEnd;t.lines.isEndOfLine(a,t.selEnd[1])&&t.lines.isStartOfLine(o,t.selStart[1])&&(c=[o,s.lineMarker]);var u=r(e,[c,l]);n(t.zoneId,c,l,"");var d=e.getRep().selStart[0];-1!==d&&u.forEach(function(e){"number"==typeof e&&null===i(t.zoneId,d+1)?i(t.zoneId,d):i(t.zoneId,d,e,!1)})},this.handleDidPaste=function(){var e=L.editor.getRep();L.doFixNewInsertNodeListError(L.pasteLineNum,Math.max(e.selStart[0]-L.pasteLineNum,1)),L.mergeListIfNecessary(e.zoneId,e.selStart[0],e.selEnd[0]),L.editor.renumberList(e.zoneId,L.pasteLineNum)},this.handleContentChange=function(e){var t=e.changes;e.options.isRemote||L.needRenumberList&&Object.values(t).forEach(function(r){var o=0;r.forEach(function(e){var t=e.start,n=e.inserts,i=e.deletes;(1<n.length||1<i.length||1<r.length)&&L.doFixNewInsertNodeListError(t+o,n.length),o+=n.length-i.length})})},this.doFixNewInsertNodeListError=function(e,t){if(L.needRenumberList)for(var n=L.editor,i=n.getLineListType,r=n.renumberList,o=(0,n.getRep)(),a="",s="",c=0;c<t;++c){var l,u,d=e+c,h=i(o.zoneId,d),f=i(o.zoneId,d+1),p=-1<h.indexOf("number"),g=-1<h.indexOf("code"),m=-1<f.indexOf("code"),v=p&&o.attributeManager.findAttributeOnLine(d,"ol-id");p&&v!==a&&(l=""===v?a:"",u=L.needRenumberList,L.needRenumberList=!1,l?r(o.zoneId,d,l,!0):r(o.zoneId,d),L.needRenumberList=u);var b=-1<s.indexOf("code");g&&!b&&r(o.zoneId,d),!g&&m&&r(o.zoneId,d+1),s=h,a=v}},this.doInsertOrderedList=function(){return L.doInsertList({attribKey:"list",attribValue:"number"})},this.doInsertUnorderedList=function(){return L.doInsertList({attribKey:"list",attribValue:"bullet"})},this.register=function(a){a.commands.registerAceCommand(_.H,function(e,t,n,i){var r=i.source,o=L.doInsertOrderedList();Object(D.a)({action:"list-number",op:o?w.g:w.f,source:r}),a.getCurrentCallStack().preventScrolling=!0},{statusKey:"list-number"}),a.commands.registerAceCommand(_.J,function(e,t,n,i){var r=i.source,o=L.doInsertUnorderedList();Object(D.a)({action:"list-bullet",op:o?w.g:w.f,source:r}),a.getCurrentCallStack().preventScrolling=!0},{statusKey:"list-bullet"})},this.beforePaste=function(e,t){var n=t.node.querySelectorAll("ul,ol");Array.from(n).forEach(function(e){Array.from(e.childNodes).forEach(function(e){e.nodeType===Node.TEXT_NODE&&e.parentNode.removeChild(e)})})},this.deserialize=function(e){var t,n,i,r,o,a,s,c=e.node,l=e.deltaSet,u=e.zoneId,d=l;return c instanceof HTMLElement&&(t=c.tagName,n=c.className,(i=U.e.exec(n))&&(d=Object(H.I)(d,u,{"ol-id":i[1]})),"LI"===t&&(r=Object(x.j)(c),o=Object(x.h)(c),a=Object(x.i)(c),s=Object(x.p)(c),(1<=o&&r||s)&&Object(x.a)(d,u,{list:s||"".concat(r).concat(o),start:String(a)}))),d},this.UNSAFE_editorNormalizePasteNode=function(e){var t=e.data.node,n=L.editor.getRep();if(n.selStart){var i=n.selStart[0],r=0<n.selStart[1],o=Object(z.$)(t).find(">:not(meta)"),a=1===o.length,s=Object(z.$)(t).find("ul, ol");if(r&&a&&s[0]&&o.hasClass("list-div")){var c=Object(z.$)("<div/>");c.html(s.html());for(var l=0;l<s[0].attributes.length;l++){var u=s[0].attributes[l];c.attr(u.name,u.value)}c.removeClass("bullet1 number1"),c.html(c.find("li")[0].innerHTML),s.replaceWith(c)}var d=t.querySelectorAll("ul,ol");Array.from(d).forEach(function(e){Array.from(e.childNodes).forEach(function(e){e.nodeType===Node.TEXT_NODE&&e.parentNode&&e.parentNode.removeChild(e)})});var h=Object(z.$)(t).find("ol");if(!(h.length<=0)){for(var f,p,g,m,v,b,y,E,O,C,k=h[0],I=h[0];k.previousSibling&&"meta"!==Object(B.f)(k.previousSibling);)k=k.previousSibling;for(;I.nextSibling;)I=I.nextSibling;k&&I&&(f=n.attributeManager.findAttributeOnLine(i-1,"ol-id"),p=n.attributeManager.findAttributeOnLine(i,"ol-id"),g=n.attributeManager.findAttributeOnLine(i+1,"ol-id"),m="ol"===Object(B.f)(k),v="ol"===Object(B.f)(I),m||v?m&&(f||p)?L.assignListId(h,f||p):v&&g?L.assignListId(h,g):(y=(b=L.getLevelAndOrderFromOl(k)).level,E=b.order,(O=Object(x.m)(n,i).upwardClosestOListInfo)?L.assignListId(h,O.listId):(C=Object(x.n)(n,U.b.UP,i,y,E))?L.assignListId(h,C.listId):L.assignListId(h,Object(B.c)())):L.assignListId(h,Object(B.c)()))}}},this.editorWillPaste=function(e){var i=e.deltaSet,u=e.zoneId,t=e.isInternalPaste,o=e.lineState;L.pasteLineNum=L.editor.selection.getSelection().start.line;var a,r,s,c,n,l,d,h,f,p,g,m,v,b,y,E=L.editor.getRep(),O=E.selStart[0],C=L.editor.getContentState().schema,k=i.get(u),I=k.ops[0]&&Object(H.K)(k.ops[0].attributes,C),S=k.ops[0]&&(k.ops[0].attributes||{}).lmkr&&(k.ops[0].attributes.list||k.ops[0].attributes.blockquote);o&&L.isListLine(o)&&!Object(H.L)(k,"\n")&&(I||S||(a=new H.E({zoneId:u}),k.eachLine(function(e,t,n){var i,r;a=0!==n?(i=t.lmkr?t:{},r=t.lmkr?e.ops.slice(1):e.ops,a.insertLineMarker(Object.assign({},i,{},o.getLineAttributes().toMap())).concat(new H.E({zoneId:u,ops:r}))):a.concat(e)}),i.replace(u,a))),t&&(s=null,c=r=!1,i.forEach(function(e){var i;e.zoneId===u&&e instanceof H.E&&(i=0,e.eachLine(function(e,t,n){i=n}),e.eachLine(function(e,t,n){t["ol-id"]&&(0===n&&(r=!0,s=t),n===i&&(c=!0))}))}),n=E.attributeManager.findAttributeOnLine(O-1,"ol-id"),l=E.attributeManager.findAttributeOnLine(O,"ol-id"),d=E.attributeManager.findAttributeOnLine(O+1,"ol-id"),h=function(n){i.forEach(function(e){var t;e.zoneId===u&&(t=Object(H.N)(e,function(e){return"ol-id"===e.key},function(e){return{key:e.key,value:n}}),i.replace(u,t))})},r||c?r&&(n||l)?h(n||l):r&&d?h(d):(p=(f=s||{list:"number1",start:"1"}).list,g=f.start,m=parseInt(U.g.exec(p)[2],10),v=parseInt(g,10)||1,h((b=Object(x.m)(E,O).upwardClosestOListInfo)?b.listId:(y=Object(x.n)(E,U.b.UP,O,m,v))?y.listId:Object(B.c)())):h(Object(B.c)()));var T,_,w=function(e,i){var r={};return e.eachLine(function(e,t,n){return i!==n||(r=t,!1)}),"list"in r}(i.get(u),0),j=i.get(u),M=function(){var e=E.attributeManager.getAttributeOnLine(E.selStart[0],"list");if(w){var i=[];if(j.eachLine(function(e,t){var n=t.list&&Number(t.list.slice(-1));n&&i.push(n)}),i.length){var t=Number(e.slice(-1))||Math.min.apply(Math,i),n=!e&&1===t,r=e&&t+Math.min.apply(Math,i)-i[0]<1;if(!n&&!r)return[t,!!e]}}}();return M&&(T=0,_=new H.E({zoneId:u}),j.eachLine(function(e,t,n){var i,r=/([a-z]+)([0-9]+)/.exec(t.list),o=r&&r[1],a=r&&Number(r[2]),s=R()(M,2),c=s[0],l=s[1];_=o&&a?(i="",i=l?(0===n&&(T=c-a),0===n?"".concat(o).concat(c):"".concat(o).concat(a+T)):(a!==c&&(T=a-c),a===c?"".concat(o,"1"):"".concat(o).concat(T+1)),_.insert("*",Object.assign({},e.ops[0].attributes,{list:i})).concat(new H.E({zoneId:u,ops:e.ops.slice(1)}))):_.concat(e)}),i.replace(u,_)),i},this.addListAttrToDeltaSet=function(n,e){if(n&&L.isListLine(n)){var i=new H.e,o=n.getLineAttributes().toMap();return e.forEach(function(e,t){var r;i=t===n.getZoneId()&&e instanceof H.E?(r=new H.E({zoneId:t}),e.eachLine(function(e){e.ops.forEach(function(e,t){var n,i;0===t?(n=e.attributes||{},"*"===e.insert&&e.attributes&&e.attributes.lmkr?(i=e.attributes.list,r.insert("*",i?n:Object.assign({},n,{},o))):r.insertLineMarker(o).push(e)):r.push(e)})}),i.concat(r)):i.concat(e)}),i}return e},this.isListLine=function(e){return e.hasLineMarker()&&e.getLineAttributes().toMap().list},this.addListId=function(e,t){t&&(Object(z.$)(e).removeClass(function(e,t){return(t.match(/ol-id([\w]{8})/g)||[]).join(" ")}),Object(z.$)(e).addClass("ol-id".concat(t)))},this.aceAttribsToClasses=function(e,t){var n=t.key,i=t.value;return"list"===n?["list:".concat(i)]:"start"===n?["start:".concat(i)]:"origin-start"===n?["origin-start:".concat(i)]:"ol-id"===n&&U.f.test(i)?["ol-id:".concat(i)]:null},this.renderLine=function(e){var t,n=e.children,i="",r=e.lineState.getLineAttributes().toMap();for(t in r){var o,a,s=r[t];(["list","start","origin-start"].includes(t)||"ol-id"===t&&U.f.test(s))&&(o=i?" ":"",a="".concat(t,":").concat(s),i+="".concat(o).concat(a))}var c,l=/(?:^| )list:(\S+)/.exec(i),u=/(?:^| )ol-id:(\S+)/.exec(i);if(u&&(c=e.lineClass?" ":"",e.lineClass+="".concat(c,"ol-id").concat(u[1])),l){var d=l[1];if(d){var h="list-div",f=M.a.escapeHTMLAttribute(d),p=/(?:^| )start:(\S+)/.exec(i),g=p||["start:1","1"],m=parseInt(g[1],10);if(-1<f.indexOf("code"))return h+=" list-code",1===m&&(h+=" list-code-start"),e.lineClass+=" ".concat(h),W.a.createElement("code",{start:"".concat(m),className:"list-".concat(f),spellcheck:"false"},e.children);if(f.indexOf("number")<0)return(-1<f.indexOf("check")||-1<f.indexOf("done"))&&(h+=" list-checkbox"),e.lineClass+=" ".concat(h),W.a.createElement("ul",{className:"list-".concat(f)},W.a.createElement("li",null,e.children));if(g){1===m&&(h+=" list-start-".concat(f));var v=/(?:^| )origin-start:(\S+)/.exec(i),b=Number(/([a-z]+)([0-9]+)/.exec(f)[2]),y="".concat(m);switch(b%3){case 0:y=Object(N.g)(m);break;case 2:y=Object(N.f)(m)}if(v){var E=M.a.escapeHTMLAttribute(v[1]);return e.lineClass+=" ".concat(h),W.a.createElement("ol",{"data-origin-start":"".concat(E),start:"".concat(m),"data-start":"".concat(m),className:"list-".concat(f)},W.a.createElement("li",{start:"".concat(y),"data-start":"".concat(y)},e.children))}return e.lineClass+=" ".concat(h),W.a.createElement("ol",{start:"".concat(m),"data-start":"".concat(m),className:"list-".concat(f)},W.a.createElement("li",{start:"".concat(y),"data-start":"".concat(y)},e.children))}return e.lineClass+=" ".concat(h),W.a.createElement("ol",{className:"list-".concat(f)},W.a.createElement("li",null,e.children))}}return n},this.editor=e,this.register(e),e.doInsertList=this.doInsertList,this.editor.on(H.k.DID_PASTE,this.handleDidPaste),this.editor.on(H.k.WILL_DELETE_FROM_CUT,this.handleWillDeleteFromCut),this.editor.on(H.k.CONTENT_CHANGE,this.handleContentChange),this.needRenumberList=t}function e(e,t,n){return i.apply(this,arguments)}var i;return a()(n,[{key:"reset",value:function(){this.editor.off(H.k.DID_PASTE,this.handleDidPaste),this.editor.off(H.k.WILL_DELETE_FROM_CUT,this.handleWillDeleteFromCut),this.editor=null}},{key:"doInsertList",value:function(e){var t=e.attribKey,n=e.attribValue,i=e.range,r=e.isAllHasAttrib,o=e.clickZone,a=e.dRep,s=e.correctRange,c=i,l=a||s||i,u=l.selStart,d=l.selEnd,h=l.zoneId;if(this.editor&&c&&u&&d){var f=F.a.tryConvertZone(this.editor,c,t).range,p=f.selStart,g=f.selEnd,m=f.zoneId;m&&(c=this.editor.getRep(m));for(var v,b,y,E,O,C,k=this.editor,I=k.getLineListType,S=k.selection,T=n.replace(/^([a-z]+)\d*$/g,"$1"),_=(p||u)[0],w=(g||d)[0],j=m||o||h||S.getZone(),M=[],L=this.editor.getClosetListNumberId(j,T,c)||Object(B.c)(),R=_;R<=w;R++)"code"!==T?(v=0,b="",y=c.attributeManager.findAttributeOnLine(R,"text-indent"),E=I(j,R),(O=/([a-z]+)([0-9]+)/.exec(E))&&(b=O[1],v=Number(O[2])),y&&(v+=2),b=E||y,r&&--v,O&&"indent"===O[1]&&!y&&(v+=1),C=r&&!o?0<v?"indent"+v:"":b?T+v:T+"1",M.push([R,C,y,L])):M.push([R,r?"":"code1",""]);var N=M.filter(function(e){var t=e[0];return!(-1<c.lines.atIndex(t).lineNode.className.indexOf(U.a))}).map(function(e){return e[0]}),D=M.reduce(function(e,t){return e[t[0]]=t[1],e},{}),x=M[0][1];U.g.exec(x)?this.bulkInsertOList(j,N,D):this.setMultiLinesListType(j,N,D,L);var P=M.filter(function(e){return e[2]}).map(function(e){return e[0]});return c.attributeManager.removeAttributeOnMultiLines(P,"text-indent"),this.editor.renumberList(h,w+1),r}}},{key:"serialize",value:function(e){var t=e.type,n=e.node,i=e.lineAttributes,r=i&&i.list;if(t===H.u.LINE&&r&&(Object(x.s)(r)||/check|done/.test(r))){var o=document.createElement("li");return o.classList.add(U.c),i&&(i.list&&(o.dataset.list=i.list),i["ol-id"]&&(o.dataset.olId=i["ol-id"]),i.start&&(o.dataset.start=i.start)),o.appendChild(n),Object.assign(e,{node:o})}if(t===H.u.ROOT){var a=e.node.querySelectorAll(".".concat(U.c)),s=Object(x.r)(a),c=!0,l=!1,u=void 0;try{for(var d,h=s[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){for(var f=d.value,p=f[0].parentNode,g=p.parentNode,m=void 0,v=[],b=0;b<f.length;b++){var y=f[b],E=y.parentElement,O=Object(x.g)(y),C=O.type,k=O.level,I=0===b?1:k-Object(x.g)(f[b-1]).level,S=Object(x.e)(C,I),T=S.child,_=S.root;if(y.dataset.start&&T.setAttribute("start",y.dataset.start),y.classList.remove(U.c),T.appendChild(y),m){var w=v[v.length-1],j=k-Object(x.g)(w).level;if(0<j)v.push(y),w.appendChild(_);else if(j<0){for(var M=j,L=w;M<=0&&L.parentElement;)L=L.parentElement,["ol","ul"].includes(L.tagName.toLowerCase())&&(M++,v.pop());L.appendChild(y),v.push(y)}else w.parentElement.appendChild(y),v.pop(),v.push(y)}else m=_,v.push(y);E!==p&&g.removeChild(E)}g.insertBefore(m,p),g.removeChild(p)}}catch(e){l=!0,u=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw u}}}return e}},{key:"assignListId",value:function(e,n){var i=this;e.each(function(e,t){return i.addListId(t,n)})}},{key:"getLevelAndOrderFromOl",value:function(e){var t=/list-number([0-9]+)/.exec(e.className),n=Object(z.$)(e).attr("start");return{level:t?parseInt(t[1],10):1,order:n?parseInt(n,10):1}}},{key:"aceDomLineProcessLineAttributes",value:function(e,t){var n=t.spanClass,i=/(?:^| )list:(\S+)/.exec(n),r=/(?:^| )ol-id:(\S+)/.exec(n);if(i){var o=i[1];if(o){var a="list-div",s="",c="",l=M.a.escapeHTMLAttribute(o),u=/(?:^| )start:(\S+)/.exec(n),d=parseInt(u?u[1]:"1",10);if(-1<l.indexOf("code"))a+=" list-code",1===d&&(a+=" list-code-start"),s='<code start="'.concat(d,'" class="list-').concat(l,'" spellcheck="false">'),c="</code>";else if(l.indexOf("number")<0)s+='<ul class="list-'.concat(l,'"><li>'),c="</li></ul>",(-1<l.indexOf("check")||-1<l.indexOf("done"))&&(t.lineClass+=" list-checkbox");else{if(u){1===d&&(a+=" list-start-".concat(l));var h,f=/(?:^| )origin-start:(\S+)/.exec(n),p=Number(/([a-z]+)([0-9]+)/.exec(l)[2]),g="".concat(d);switch(p%3){case 0:g=Object(N.g)(d);break;case 2:g=Object(N.f)(d)}s=f?(h=M.a.escapeHTMLAttribute(f[1]),'<ol\n                data-origin-start="'.concat(h,'"\n                start="').concat(g,'"\n                data-start="').concat(g,'"\n                class="list-').concat(l,'"\n                ><li\n                start="').concat(g,'" data-start="').concat(g,'">')):'<ol start="'.concat(g,'" data-start="').concat(g,'" class="list-').concat(l,'"><li\n                start="').concat(g,'" data-start="').concat(g,'">')}else s='<ol class="list-'.concat(l,'"><li>');c="</li></ol>"}t.lineClass+=" ".concat(a),t.preHtml=s,t.postHtml=c,t.processedMarker=!0}}r&&(t.lineClass+=" ol-id".concat(r[1]))}},{key:"editorAfterDoDeleteKey",value:function(e,t){var n=this.editor.getRep();this.mergeListIfNecessary(n.zoneId,t.theLine),this.handleDeleteListLine(t.theLine)}},{key:"editorAfterDoReturnKey",value:function(e,t){this.handleDeleteListLine(t.theLine)}},{key:"handleDeleteListLine",value:function(t){var n,i,e=this.editor;e&&(n=e.renumberList,i=this.editor.getRep(),this.willRenumberArr.forEach(function(e){"number"==typeof e&&null===n(i.zoneId,t+1)?n(i.zoneId,t):n(i.zoneId,t,e,!1)}),this.willRenumberArr=[])}},{key:"aceKeyEvent",value:function(e,t){if(this.editor){var n=t.rep,i=t.evt;if(n.selEnd){var r=R()(n.selEnd,2),o=r[0],a=r[1],s=n.lines.atIndex(o);i.keyCode===P.c.Delete&&"Delete"===i.key&&this.editor.isCaret()&&s&&a===s.text.length&&this.mergeList(n.zoneId,o+2,o);var c=i.type,l=i.keyCode,u=i.shiftKey,d=i.ctrlKey,h=i.metaKey;if(S.browser.isSafari&&"keydown"===c){var f,p,g=n.selStart,m=n.selEnd,v=n.attributeManager,b=n.zoneId;if(g&&m){if(!(l!==P.c.Up&&l!==P.c.Down||d||h)){var y=l===P.c.Up,E=this.editor.selection.getSelection().isReversed,O=y?Math.max((u&&!E?m:g)[0]-1,0):Math.min((u&&E?g:m)[0]+1,n.alines.length-1);if(!v.getAttributeOnLine(O,"list"))return;var C=n.lines.atIndex(O).lineMarker,k=u&&!E?g:[O,C],I=u&&E?m:[O,C];n.alinesWidth[O]-1===C&&(this.editor.selection.setWithSelection(b,k,I),this.editor.selection.updateBrowserSelectionFromRep(!0),i.preventDefault())}v.getAttributeOnLine(g[0],"list")&&this.editor.isCaret({selStart:g,selEnd:m,selZone:b})&&l===P.c.Left&&Object(P.d)(i)&&(f=n.lines.atIndex(g[0]).lineMarker,p=g[0],i.shiftKey?this.editor.selection.setWithSelection(b,m,[p,f]):this.editor.selection.setWithSelection(b,[p,f],[p,f]),this.editor.selection.updateBrowserSelectionFromRep(!0),i.preventDefault())}}}}}},{key:"editorKeyDown",value:function(e,t){var n=t.rep,i=t.evt,r=i.keyCode,o=n.selStart,a=n.zoneId;i.shiftKey||r!==P.c.Tab||a===S.DEFAULT_REP_ZONE&&0===o[0]||this.mergeToParentListIfNecessary(n)}},{key:"markdownMatched",value:function(e,t){var n=this;if(this.editor){var i=t.key,r=t.value,o=t.start,a=t.replaceLen;if(U.g.exec(r)){var s=this.editor.getRep(),c=s.selStart[0],l=s.attributeManager.getAttributeOnLine(c,i);if(!l||l!==r)return this.editor.makeNewEvent("insertNewList",function(){var e,t;n.editor&&(e=s.lines.atIndex(c),n.editor.performDocumentReplaceRange(s.zoneId,[c,e.lineMarker],[c,e.lineMarker+a],""),t=Object(x.v)(s,c),n.bulkInsertOList(s.zoneId,[c],C()({},c,t),o),Object(x.q)(s,c)&&s.attributeManager.removeAttributeOnLine(c,"text-indent"))}),Object(D.a)({action:"list-number",op:w.f,source:"markdown"}),!0}}}},{key:"bulkInsertOList",value:function(e,t,n,i){var r,o,a,s,c,l,u,d;this.editor&&0!==t.length&&(r=this.editor.getRep(e),t.sort(function(e,t){return e-t}),o=t[0],a=t[t.length-1],s=Object(B.c)(),r.attributeManager.setAttributeOnLine(o,"origin-start","".concat(i||1)),this.setMultiLinesListType(e,t,n,s),1===i?((c=Object(x.n)(r,U.b.UP,o))?this.mergeList(r.zoneId,c.lineNum,o):(u=(l=Object(x.m)(r,o,a)).upwardClosestOListInfo,d=l.downwardClosestOListInfo,u&&d&&this.mergeList(r.zoneId,o,d.lineNum)),r.attributeManager.findAttributeOnLine(a+1,"ol-id")&&this.mergeList(r.zoneId,a+1,a)):this.mergeListIfNecessary(r.zoneId,o,a))}},{key:"mergeList",value:function(n,i,r){var o=this;if(!this.editor)return Promise.resolve(null);var a=this.editor.getRep(n);if(!Object(x.t)(a,i)||!Object(x.t)(a,r))return Promise.resolve(null);var e=this.editor.getLineListInfo(n,i),t=this.editor.getLineListInfo(n,r);if(e&&t&&e.listId!==t.listId){var s=e.listId,c=[r].concat(E()(Object(x.d)(a,r,t.listId,U.b.UP)),E()(Object(x.d)(a,r,t.listId,U.b.DOWN))).sort(function(e,t){return e-t});return new Promise(function(e,t){if(!o.editor)return e(null);o.editor.inCallStackIfNecessary("mergeList",function(){o.editor&&(a.attributeManager.setAttributeOnMultiLines(c,"ol-id",s),c[0]>i?a.attributeManager.removeAttributeOnLine(c[0],"origin-start"):(a.attributeManager.removeAttributeOnLine(i,"origin-start"),Object(x.u)(a,c[0])||a.attributeManager.removeAttributeOnLine(c[0],"origin-start")),o.editor.renumberList(n,r),e(s))})})}return Promise.resolve(null)}},{key:"mergeListIfNecessary",value:(i=v()(b.a.mark(function e(t,n,i){var r,o,a,s,c,l,u,d,h,f,p,g,m,v;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.editor){e.next=2;break}return e.abrupt("return");case 2:if(r=this.editor.getRep(t),o=i||n,Object(x.t)(r,n)&&Object(x.t)(r,o)){e.next=6;break}return e.abrupt("return");case 6:if(a=Object(x.k)(r,n),s=a.listId,c=Object(x.k)(r,n-1),l=Object(x.k)(r,o+1),u=Object(x.n)(r,U.b.UP,n),d=Object(x.n)(r,U.b.DOWN,o),f=l||d,p=!1,(h=c||u)&&h.listId!==s)return e.next=17,this.mergeList(t,h.lineNum,n);e.next=22;break;case 17:if(e.t0=e.sent,e.t0){e.next=20;break}e.t0=s;case 20:s=e.t0,p=!0;case 22:if(f&&f.listId!==s)return e.next=25,this.mergeList(t,f.lineNum,o);e.next=30;break;case 25:if(e.t1=e.sent,e.t1){e.next=28;break}e.t1=s;case 28:s=e.t1,p=!0;case 30:if(p)return e.abrupt("return",Promise.resolve());e.next=32;break;case 32:if(g=Object(x.m)(r,n,o),m=g.upwardClosestOListInfo,v=g.downwardClosestOListInfo,m&&v)return e.next=36,this.mergeList(t,m.lineNum,n);e.next=38;break;case 36:return e.next=38,this.mergeList(t,v.lineNum,o);case 38:case"end":return e.stop()}},e,this)})),e)},{key:"splitList",value:function(n,i){var r=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(!this.editor)return Promise.resolve();var a=this.editor.getRep(n);if(!Object(x.t)(a,i))return Promise.resolve();var e=Object(x.k)(a,i).listId,s=Object(B.c)(),c=[i].concat(E()(Object(x.d)(a,i,e,U.b.DOWN)));return new Promise(function(e,t){if(!r.editor)return e();r.editor.inCallStackIfNecessary("splitList",function(){r.editor&&(a.attributeManager.setAttributeOnMultiLines(c,"ol-id",s),a.attributeManager.setAttributeOnLine(i,"origin-start","".concat(o)),r.editor.renumberList(n,i))})})}},{key:"mergeToParentListIfNecessary",value:function(o){for(var a=this,e=o.selStart,t=o.selEnd,n={},i=e[0];i<=t[0];i++){var r=o.repManager.editor.getLineListInfo(o.zoneId,i);!r||n[r.listId]||Object(x.o)(r.listType)<=1||(n[r.listId]=i)}Object.entries(n).forEach(function(e){var t=R()(e,2),n=(t[0],t[1]),i=o.repManager.editor.getLineListType(o.zoneId,n),r=Object(x.f)(o,n,U.b.UP,Object(x.o)(i),!0);r&&a.mergeList(o.zoneId,r.lineNum,n)})}},{key:"editorWillDoDeleteKey",value:function(e){var t,n,i,r,o,a,s,c,l=this,u=e.deltaSet,d=e.editor,h=d.getContentState().getActiveZone(),f=h.getZoneId(),p=d.selection.getSelection(),g=p.start,m=h.getLine(g.line),v=m.getLineAttributes().toMap(),b=v["ol-id"];v.list&&(n=(t=p.toPosition()).start,i=t.len,r=Number(m.hasLineMarker()),o=v.list.match(/([a-z]+)([0-9]+)/),!i&&g.offset-r==0&&o&&(a=new H.E({zoneId:f}),s=o[1],c=Number(o[2]),"number"===s?(v["origin-start"]="",v.start="",v["ol-id"]="",v.list="indent"+c,a.retain(n-1).retain(1,v)):"code"===s?a.retain(n-2).delete(2):(v.list="",v[U.d]="",a.retain(n-1).retain(1,v)),e.deltaSet=u.compose(a),this.willRenumberArr=[b],Promise.resolve().then(function(){l.handleDeleteListLine(g.line)})))}},{key:"editorWillDoReturnKey",value:function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y=e.evt,E=e.delta,O=e.editor,C=O.getContentState(),k=C.getActiveZone(),I=k.getZoneId(),S=O.selection.getSelection(),T=S.start.line,_=k.getLine(T),w=_.getLineAttributes().toMap(),j=S.toPosition(),M=j.start,L=j.len;w.list&&!L&&(n=(t=w.list.match(/([a-z]+)([0-9]+)/))[1],i=Number(t[2]),r=_.isEmpty(),o=1===S.start.offset,a=y.shiftKey,b=new H.E({zoneId:I}),["number","bullet","check","done","indent"].includes(n)&&(r?(1===i?["list","start","origin-start","ol-id",U.d].forEach(function(e){w[e]=""}):w.list=n+(i-1),b.retain(M-1).retain(1,w)):(a&&(w.list="indent"+i,["start","origin-start","ol-id",U.d].forEach(function(e){w[e]=""})),s=this.findLastListLine(k,T),"indent"===n&&!a&&s&&(c=s.type,l=s.start,u=s.olId,"number"===c[1]&&(w.list=c[0],w.start=String(l+1),w["ol-id"]=u),w.list=c[1]+c[2]),"check"!==n&&"done"!==n||(w[U.d]=Object(K.d)("inherit")),b.retain(M).insertEnter().insertLineMarker(w),"done"===n&&(b=o?b.compose(new H.E({zoneId:I}).retain(Math.max(M-1,0)).retain(1,Object.assign({},w,{list:"check"+i}))):b.compose(new H.E({zoneId:I}).retain(M+1).retain(1,Object.assign({},w,{list:"check"+i})))))),d=_.previousSibling(),"code"===n&&d&&(0===T?b.retain(M).insertEnter().insertLineMarker(w):(h=k.getLineIndexOfKey(d.getKey()),f=d.isEmpty(),p=C.rangeToPosition({start:{line:h,offset:0,zoneId:I},end:{line:h,offset:0,zoneId:I}}).start,m="code1"===(g=d.getLineAttributes().toMap()).list,r&&f&&m?(["list","start","insertorder","lang"].forEach(function(e){g[e]="",w[e]=""}),v=new H.E({zoneId:I}).retain(p).retain(1,g),b=b.retain(M-1).retain(1,w).compose(v)):b.retain(M).insertEnter().insertLineMarker(w))),e.delta=E.compose(b),this.willRenumberArr=O.deleteNumberList(O))}},{key:"findLastListLine",value:function(e,t){for(var n=t,i="";0<=n-1;){var r=e.getLine(n-1).getLineAttributes().toMap();if(!(i=r.list))return null;if("bullet"===(i=/([a-z]+)([0-9]+)/.exec(i))[1]||"number"===i[1]||"check"===i[1]||"done"===i[1])return{line:--n,type:"done"===i[1]?{0:"check"+i[2],1:"check",2:i[2]}:i,start:"number"===i[1]?parseInt(r.start,10)||1:null,olId:r["ol-id"]};n--}return null}},{key:"setListAttributeOnMultiLine",value:function(e){var r=e.editor,o=e.rep,t=e.lineNums,a=e.lineTypes,s=r.changesetHelper;if(!Array.isArray(t)||!t.length)return!1;var c=/check|done/.test(a[t[0]]);c&&Object(K.b)(r);var l=[0,0],u=s.builder(o.lines.totalWidth(),"Z",o.zoneId);return t.forEach(function(e){var t,n=[["list",a[e]]];c&&(t=r.getAttributeOnLine(o.zoneId,e,U.d),n.push([U.d,t||Object(K.d)("create")]));var i=o.attributeManager.lineHasMarker(e);s.buildKeepRange(o,u,l,l=[e,0]),i?s.buildKeepRange(o,u,l,l=[e,1],n,o.repManager.apool):o.attributeManager._insertLineAttribute(u,n)}),o.attributeManager.applyChangeset(u)}},{key:"setMultiLinesListType",value:function(n,i,e,t){var r,o,a,s=this,c=e[i[0]];i.length&&this.editor&&(r=this.editor.repManager.reps[n],a=new Map,i.forEach(function(e){var t=r.attributeManager.findAttributeOnLine(e,"ol-id");!a.has(t)&&t&&a.set(t,!0)}),/check|done/.test(c)||r.attributeManager.removeAttributeOnMultiLines(i,U.d),""===c||/indent/.test(c)?(this.setListAttributeOnMultiLine({editor:this.editor,rep:r,lineNums:i,lineTypes:e}),r.attributeManager.removeAttributeOnMultiLines(i,"start"),r.attributeManager.removeAttributeOnMultiLines(i,"origin-start"),r.attributeManager.removeAttributeOnMultiLines(i,"lang"),r.attributeManager.removeAttributeOnMultiLines(i,"ol-id")):(i=i.filter(function(e){return Object(x.b)(s.editor,n,e,[["horizontal-line","true"],["sheet-id",""],["aceTable",""]])}),-1<c.indexOf("number")?(o=t||this.editor.getClosetListNumberId(n,c,r)||Object(B.c)(),r.attributeManager.setAttributeOnMultiLines(i,"ol-id",o)):r.attributeManager.removeAttributeOnMultiLines(i,"ol-id"),this.setListAttributeOnMultiLine({editor:this.editor,rep:r,lineNums:i,lineTypes:e})),a.forEach(function(e,t){s.editor.renumberList(n,i[0],t)}),this.editor.renumberList(n,i[0],o))}}]),n}();q([Object(Z.Bind)(),Object(L.a)({checkAttributeApplied:x.c})],Y.prototype,"doInsertList",null),q([Object(H.J)(100)],Y.prototype,"editorWillDoDeleteKey",null);var J=n("iP/4"),Q=n("O9F5"),X=n("PJYZ"),$=n.n(X),ee=n("i8i4"),te=n.n(ee),ne=n("+BHD"),ie=n("gpe9"),re=function(e){function t(){var a;return o()(this,t),(a=l()(this,u()(t).apply(this,arguments))).upwardClosestOListInfo=null,a.continueVisible=!1,a.createVisible=!1,a.handleItemClick=function(e){var t=e.key,n=$()(a),i=n.liElement,r=n.oListInfo,o=n.upwardClosestOListInfo;a.hidePopup(),i&&t&&"function"==typeof a.handlers[t]&&a.handlers[t]({liElement:i,listInfo:r,upwardClosestOListInfo:o})},a}return p()(t,e),a()(t,[{key:"beforeRender",value:function(e,t){var n=t.lineNum,i=t.level;this.upwardClosestOListInfo=Object(x.f)(e,n,U.b.UP,i),this.continueVisible=Object(x.u)(e,n)&&!!this.upwardClosestOListInfo&&this.upwardClosestOListInfo.listId!==t.listId,this.createVisible=1<t.order}},{key:"render",value:function(e){this.oListInfo&&this.liElement&&this.rep&&(this.beforeRender(this.rep,this.oListInfo),te.a.render(W.a.createElement(ne.a,{continueVisible:this.continueVisible,createVisible:this.createVisible,calcRenderStyle:this.calcRenderStyle,handleItemClick:this.handleItemClick,popupContainerRef:this.popupContainerRef}),e))}}]),t}(ie.b),oe=n("1BX5"),ae=function(e){function t(){var r;return o()(this,t),(r=l()(this,u()(t).apply(this,arguments))).handleConfirm=function(e,t,n,i){"function"==typeof r.handlers.confirm&&r.handlers.confirm(e,t,n,i),r.hidePopup()},r}return p()(t,e),a()(t,[{key:"render",value:function(e){this.liElement&&this.oListInfo&&te.a.render(W.a.createElement(oe.a,{calcRenderStyle:this.calcRenderStyle,listInfo:this.oListInfo,onConfirm:this.handleConfirm,popupContainerRef:this.popupContainerRef}),e)}}]),t}(ie.b),se=n("BmYl"),ce=function(e){function t(){return o()(this,t),l()(this,u()(t).apply(this,arguments))}return p()(t,e),a()(t,[{key:"eventHandlerFactory",value:function(e){var t=this;return function(){"function"==typeof t.handlers[e]&&t.liElement&&(t.updateMagicDomId(),t.magicDomId&&t.handlers[e](t.magicDomId,t.liElement))}}},{key:"render",value:function(e){this.magicDomId&&te.a.render(W.a.createElement(se.a,{magicDomId:this.magicDomId,getNumberRect:this.getNumberRect,onMouseOver:this.eventHandlerFactory("mouseover"),onMouseLeave:this.eventHandlerFactory("mouseleave"),onMouseDown:this.eventHandlerFactory("mousedown"),onMouseUp:this.eventHandlerFactory("mouseup")}),e)}}]),t}(ie.b),le=n("qxQb"),ue=n.n(le),de=n("MjSh"),he=n("2ACu"),fe=n("xYHj");n("qK4o");n.d(t,"a",function(){return ve});var pe="LIST_NUMBER_HOVER_STYLE",ge="LIST_NUMBER_PRESS_STYLE_ID",me="LIST_NUMBER_ACTIVE_STYLE_ID",ve=function(e){function n(e,t){var c;return o()(this,n),(c=l()(this,u()(n).call(this,e,t))).eventNamespace=".list_".concat(Date.now()),c.listPopupRenderer=new re,c.inputNumberRenderer=new ae,c.fakeListNumberTriggerRenderer=new ce(!1),c.editable=!1,c.handleContinueWithLastList=function(e){var t,n,i=e.listInfo,r=e.upwardClosestOListInfo;c.editor&&i&&r&&(t=i.lineNum,n=i.zoneId,c.mergeList(n,r.lineNum,t),c.reportEvent(n,t,"continue_previous_number"))},c.handleStartNewList=function(e){var t,n,i=e.listInfo;c.editor&&i&&(t=i.zoneId,n=i.lineNum,c.splitList(t,n),c.reportEvent(t,n,"start_new_list"))},c.handleResetListNumber=function(e){var t=e.liElement,n=e.listInfo;c.editor&&n&&c.inputNumberRenderer.showPopup(c.editor.getRep(n.zoneId),t)},c.handleListNumberUpdate=function(e,t,n,i){var r,o,a,s;c.editor&&(r=c.editor.getRep(e),(o=Object(x.k)(r,t))&&o.order===n||(c.reportEvent(e,t,"set_number",i),Object(x.u)(r,t)?(c.splitList(e,t,n),a=c.editor.getLineListInfo(e,t).listId,(s=Object(x.n)(r,U.b.UP,t))&&s.listId!==a&&c.mergeList(e,s.lineNum,t)):c.splitList(e,t,n)))},c.handleShowPopup=function(e){var t,n=document.getElementById(e);c.editor&&n&&(t=c.editor.dom.zoneOfdom(n)||S.DEFAULT_REP_ZONE,c.editor.dom.rootNodeOfZone(t).blur()),Q.a.deleteRuleById(me),Q.a.insertRule("\n      .innerdocbody #".concat(e," ol[class^=list-number] li::before {\n        background-color: ").concat(ue()(de.B500,.15),";\n      }\n    "),me)},c.handleHidePopup=function(e){Q.a.deleteRuleById(me)},c.handleMouseOver=function(e){var t;!c.editor||c.editor.blockRender.isScrolling()||!c.editable||(t=c.editor.dom.zoneOfdom(e.currentTarget))&&c.fakeListNumberTriggerRenderer.showPopup(c.editor.getRep(t),e.currentTarget)},c.handleHoverNumber=function(e){Q.a.deleteRuleById(pe),Q.a.insertRule("\n      .innerdocbody #".concat(e," ol[class^=list-number] li::before {\n        background-color: ").concat(ue()(de.B500,.15),";\n      }\n    "),pe)},c.handleLeaveNumber=function(){Q.a.deleteRuleById(pe)},c.handlePressNumber=function(e){Q.a.deleteRuleById(ge),Q.a.insertRule("\n      .innerdocbody #".concat(e," ol[class^=list-number] li::before {\n        background-color: ").concat(ue()(de.B500,.2),";\n      }\n    "),ge)},c.handleReleaseNumber=function(e,t){var n,i,r;Q.a.deleteRuleById(ge),c.editor&&c.editable&&(c.inputNumberRenderer.getVisible()&&c.inputNumberRenderer.hidePopup(),(n=c.editor.dom.zoneOfdom(t))&&(i=c.editor.getRep(n),r=Object(x.l)(i,t).lineNum,c.listPopupRenderer.showPopup(i,t),c.reportEvent(n,r,"click_number_open")))},c.pluginReadOnly=function(){c.editable=!1},c.pluginReadWrite=function(){c.editable=!0},c.setEvents(!0),c.initPopup(),c}return p()(n,e),a()(n,[{key:"reset",value:function(){this.setEvents(!1),h()(u()(n.prototype),"reset",this).call(this)}},{key:"setEvents",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.editor&&(e=t?"on":"off",Object(z.$)(this.editor.getInnerContainer())[e]("mouseover".concat(this.eventNamespace),"[class^=list-number] > li",this.handleMouseOver))}},{key:"reportEvent",value:function(e,t,n,i){var r;this.editor&&(r="Doc_body",e!==S.DEFAULT_REP_ZONE?r="Table":Object(fe.j)(this.editor.getRep(e),t)&&(r="Heading"),Object(he.default)("list_operation",{action:n,Doc_module:r,set_number_value:i}))}},{key:"initPopup",value:function(){this.listPopupRenderer.registerHandler("continue",this.handleContinueWithLastList),this.listPopupRenderer.registerHandler("create",this.handleStartNewList),this.listPopupRenderer.registerHandler("renumber",this.handleResetListNumber),this.inputNumberRenderer.registerHandler("confirm",this.handleListNumberUpdate),this.fakeListNumberTriggerRenderer.registerHandler("mouseover",this.handleHoverNumber),this.fakeListNumberTriggerRenderer.registerHandler("mouseleave",this.handleLeaveNumber),this.fakeListNumberTriggerRenderer.registerHandler("mousedown",this.handlePressNumber),this.fakeListNumberTriggerRenderer.registerHandler("mouseup",this.handleReleaseNumber),this.listPopupRenderer.onShow(this.handleShowPopup),this.inputNumberRenderer.onShow(this.handleShowPopup),this.listPopupRenderer.onClose(this.handleHidePopup),this.inputNumberRenderer.onClose(this.handleHidePopup)}},{key:"isCursorInNumber",value:function(e){var t=-2,n=5,i=2,r=e.currentTarget,o=parseInt(window.getComputedStyle(r,"::before").width,10);J.a.isEdge&&r.firstChild&&(o=r.firstChild.getBoundingClientRect().left-r.getBoundingClientRect().left);var a=r.getBoundingClientRect(),s=a.left,c=a.top,l=a.bottom,u=s+o,d=e.clientX,h=e.clientY;return s<=d&&d<=u+t-i&&h<=l+n&&c-n<=h}},{key:"changesetApply",value:function(e,t){var n=t.callstack,i=n.isUserChange,r=n.selectionAffected;i&&r&&(this.fakeListNumberTriggerRenderer.hidePopup(),this.listPopupRenderer.hidePopup(),this.inputNumberRenderer.hidePopup(),Q.a.deleteRuleById(pe))}}]),n}(Y)},bTJL:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var i=n("7Kxq");function r(e,t){return 0<=t&&t<=e.lines.length()-1}function o(e,t){var n=e.lines.atIndex(t);return r(e,t)&&Boolean(n&&n.getInstanceByName(i.e.ACE_TABLE))}function a(e,t){var n=e.lines.atIndex(t);return r(e,t)&&Boolean(n&&n.getInstanceByName(i.e.CODE_BLOCK))}},bbVt:function(e,t,n){},bf0L:function(e,t,n){"use strict";(function(r){var e=n("q1tI"),o=n.n(e),a=n("HmyT"),s=n("uOZV"),g=n("4RhH"),c=n("y2sV"),m={userNames:{},historyRevertModal_didMount:function(e,t){t.container&&(Object(a.$)(t.container).on("mouseenter",".__edit",m.handleEditSpanMouseEnter).on("mouseleave",".__edit",m.handleEditSpanMouseLeave),Object(a.$)(t.container).find(".innerdocbody").on("click",m.handleStopPropation))},changesetRender_beforeApply:function(e,t){var n=t.root.childNodes[0];Object(a.$)(n).find("span.name").remove()},changesetRender_finishApply:function(e,t){var n=t.root.childNodes[0],i=t.ace,r=(i||{}).editorInfo;s.a.reset(n),s.a.update(n,i);var d,h,o=Array.from(n.childNodes),f=/J-replaying/.test(t.root.className),p=0;o.forEach(function(e){var t=Object(a.$)(e).find(".ace-table-cell, .J-span"),l=/aceTable-(\S+)/g.test(Object(a.$)(e).children().attr("class")||""),u=!1;t?[].forEach.call(t,function(e){var t,n,i,r,o,a,s,c=e.className;/mention-chatId/.test(c)&&g.a.mount(e),c&&(t=c.match(/author-(\d+)/),n=m.userNames,i=t?n[t[1]]:null,o=(r=c.match(/__edit_(\w+)/))&&r[1],i&&o&&(o!==h||i!==d)&&(f&&(l&&!u&&(e.className+=" __edit--always-show-name",u=!0),l||(e.className+=" __edit--always-show-name")),p++),d=r?i:null,(h=o)&&(i&&((a=document.createElement("span")).innerText=i,a.className="name",(s=/image-uploaded/.test(c)?e.querySelector(".image-container"):/J-history-border/.test(c)?e:!/aceTable/.test(c)&&e.querySelector(".J-history-border"))?s.insertBefore(a,s.firstChild):e.insertBefore(a,e.firstChild),e.setAttribute("data-area",p)),h=o,d=r?i:null))}):d=null}),g.a.finshApply(),r&&r.plugins.noteTitlePlugin&&r.plugins.noteTitlePlugin.noteTitle.checkTextStatus(0)},handleStopPropation:function(e){e.stopPropagation(),e.preventDefault()},match:function(e){return"__edit_add"===e||"__edit_del"===e||"sheet-id"===e},render:function(e){var t=e.attributes,n=e.children;if(e.class.includes("history-sheet")||e.class.includes("__edit"))return n;var i=["J-span"];return/J-span/.test(e.class)||i.push("J-span"),t["sheet-id"]&&(i.push("sheet-id-".concat(t["sheet-id"]),"history-sheet","sheet"),n=o.a.createElement(c.z,null,o.a.createElement(c.z,{className:"sheet-placeholder"},o.a.createElement(c.z,{className:"history-deleted-mask"},o.a.createElement(c.w,{className:"history-deleted-mask_text"},r("history.deleted"))),o.a.createElement(c.z,{className:"sheet-placeholder-t"},r("common.form")),o.a.createElement(c.z,{className:"sheet-placeholder-b clearfix"},new Array(24).fill(o.a.createElement(c.w,null)))))),(t.__edit_add||t.__edit_del)&&(i.push("__edit"),t.__edit_add&&i.push("__edit_add","true"===t.__edit_add?"":"__edit_add-".concat(t.__edit_add)),t.__edit_del&&i.push("__edit_del","true"===t.__edit_del?"":"__edit_del-".concat(t.__edit_del)),n=o.a.createElement(c.w,{className:"inner"},n)),e.class+=" ".concat(i.join(" ")),n},historyRevertModal_willUnmount:function(e,t){t.container&&(s.a.reset(t.container),Object(a.$)(t.container).off("mouseenter",".__edit",m.handleEditSpanMouseEnter).off("mouseleave",".__edit",m.handleEditSpanMouseLeave)),g.a.reset()},aceCopy:function(e,t){var n=t.html,i=Object(a.$)("<div></div>").html(n);Object(a.$)(".__edit .name",i).remove(),t.html=i.html()},getUserId:function(e){var t=e.className;if(!t)return null;var n=t.match(/author-(\d+)/);return n?n[1]:null},handleTableTargetClass:function(e){var t,n,i=m.getUserId(e),r=Object(a.$)(e).parents('span[class*="aceTable-"]');return 0<r.length&&(t=m.getUserId(r[0]),n=Object(a.$)(e).parents(".__edit.ace-table-cell"),r.hasClass("__edit")&&i===t&&(e=r.get(0)),0<n.length&&m.getUserId(n[0])===i&&(e=n.get(0))),e},handleEditSpanMouseEnter:function(e){var t=m.handleTableTargetClass(e.currentTarget),n=t.getAttribute("data-area"),i=m.findNearestFirstEditSpan(t);i&&Object(a.$)(i).addClass("__edit--show-name"),n&&Object(a.$)(".__edit[data-area=".concat(n,"]")).addClass("__edit--show-hightlight")},handleEditSpanMouseLeave:function(e){var t=m.handleTableTargetClass(e.currentTarget),n=t.getAttribute("data-area"),i=m.findNearestFirstEditSpan(t);i&&Object(a.$)(i).removeClass("__edit--show-name"),n&&Object(a.$)(".__edit[data-area=".concat(n,"]")).removeClass("__edit--show-hightlight")},findNearestFirstEditSpan:function(e){var t=e.className.match(/__edit_\w/);if(t){for(var n=t[0],i=e;i;){var r=i.previousElementSibling;if(!(r&&-1<r.className.indexOf(n)))break;i=r}return i}return null}};t.a=m}).call(this,n("2vAP"))},"bn+F":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("7+rO"),r=n.n(i);function o(){return{failImgSrc:r.a}}},bqU8:function(e,t,n){"use strict";n.d(t,"a",function(){return _}),n.d(t,"b",function(){return w}),n.d(t,"c",function(){return L});var i,r,o,a=n("lwsE"),s=n.n(a),c=n("W8MJ"),l=n.n(c),u=n("U+yc"),d=n.n(u),h=n("XhtD"),f=n("ukIz"),p=(n("lWGI"),n("YWBl")),g=n("7Kxq"),m=n("/MeM"),v=n("YNKm"),b=n("HmyT"),y=n("y2sV"),E=n("q1tI"),O=n.n(E),C=n("F9bh"),k=n("PcuH"),I="blockquote",S=[I],T={instanceName:"blockquote",displayType:"Inline"},_=14,w="doc-blockquote__wrapper",j={paddingLeft:"".concat(_,"px")},M=O.a.createElement(y.z,{className:w,style:j}),L=(i=Object(C.a)(),r=Object(y.J)(400),o=function(){function t(e){var c=this;s()(this,t),this.className="Quote",this.attributeKey="blockquote",this.aceRegisterBlockElements=function(){return S},this.register=function(e){e.registerAceCommand(v.h,function(e,t,n,i){var r=i.source,o=t.doInsertBlockQuote({attribKey:I,attribValue:I});Object(p.a)({action:"reference",op:o?g.g:g.f,source:r})},{statusKey:"blockquote-blockquote"})},this.handleClick=function(){c.editorInfo.callWithAce(function(e){e.doInsertBlockQuote({attribKey:I,attribValue:I})},"insertBlockQuote",!0)},this.aceAttribsToClasses=function(e,t){if(t.key===I)return["blockquote:blockquote"]},this.aceDomLineProcessLineAttributes=function(e,t){var n,i,r=t.spanClass,o=t.index,a=t.zoneId,s=/(?:^| )blockquote:([A-Za-z0-9]*)/.exec(r);s&&(n=Object(f.a)(S,s[1])),void 0!==n&&0<=n&&(t.lineClass+=" blockquote",t.processedMarker=!0,(i=c.editorInfo.getRep(a).lines.atIndex(o))&&i.registerInstance(T))},this.aceInitialized=function(e,t){var n=t.editorInfo,i=t.documentAttributeManager;c.editorInfo=n,c.documentAttributeManager=i,n.doInsertBlockQuote=c.doInsertBlockQuote,c.register(n)},this.bindEvents=function(){var e=Object(b.$)("[data-key=reference]");e.off("click",c.handleClick),e.on("click",c.handleClick)},this.unbindEvents=function(){Object(b.$)("[data-key=reference]").off("click",c.handleClick)},this.reset=function(){c.unbindEvents(),c.editorInfo=null,c.documentAttributeManager=null},this.pluginReadOnly=function(){c.unbindEvents()},this.pluginReadWrite=function(){c.bindEvents()},this.iconDom=null,e&&(this.register(e),this.aceInitialized("",Object.assign({editorInfo:e},e)),this.editor=e)}return l()(t,[{key:"isQuoteLine",value:function(e){return e.hasLineMarker()&&e.getLineAttributes().toMap()[this.attributeKey]}}]),l()(t,[{key:"match",value:function(e,t){return e===this.attributeKey}},{key:"renderWrapper",value:function(e){return"code1"!==e.lineState.getLineAttributes().toMap().list?M:null}},{key:"doInsertBlockQuote",value:function(e){var t=e.attribKey,n=e.attribValue,i=e.range,r=e.isAllHasAttrib,o=i.selStart,a=i.selEnd,s=i.attributeManager,c=Object(h.a)(o[0],a[0]+1);if(o&&a)return r?s.removeAttributeOnMultiLines(c,t,n):s.setAttributeOnMultiLinesExcludeAttrs(c,[m.a],[m.b],!0),k.a.tryConvertZone(this.editor,i,t,n),r}},{key:"serialize",value:function(e){return Object(y.Q)(e,{tagAttribute:v.h})}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement){var r=t.className,o=t.tagName;if(-1<r.indexOf(I)||"BLOCKQUOTE"===o)return Object(y.I)(n,i,{blockquote:"true"})}return n}},{key:"editorWillPaste",value:function(e){var o,a=e.lineState,t=e.deltaSet,s=e.zoneId,n=t.get(s),i=n.ops[0]&&Object(y.K)(n.ops[0].attributes,this.editor.getContentState().schema),r=n.ops[0]&&(n.ops[0].attributes||{}).lmkr&&(n.ops[0].attributes.list||n.ops[0].attributes.blockquote);return a&&this.isQuoteLine(a)&&!Object(y.L)(n,"\n")&&(i||r?t=Object(y.I)(t,s,a.getLineAttributes().toMap()):(o=new y.E({zoneId:s}),n.eachLine(function(e,t,n){var i,r;o=0!==n?(i=t.lmkr?t:{},r=t.lmkr?e.ops.slice(1):e.ops,o.insertLineMarker(Object.assign({},i,{},a.getLineAttributes().toMap())).concat(new y.E({zoneId:s,ops:r}))):o.concat(e)}),t.replace(s,o))),t}},{key:"editorWillDoReturnKey",value:function(e){var t,n=e.delta,i=e.editor,r=i.getContentState().getActiveZone(),o=r.getZoneId(),a=i.selection.getSelection(),s=a.toPosition(),c=s.start,l=s.len,u=r.getLine(a.start.line),d=u.getLineAttributes().toMap(),h=u.isEmpty();n.ops.length||!d.blockquote||l||(t=new y.E({zoneId:o}),h?(d.blockquote="",t.retain(c-1).retain(1,d)):t.retain(c).insertEnter().insertLineMarker(d),e.delta=n.compose(t))}},{key:"editorWillDoDeleteKey",value:function(e){var t,n=e.deltaSet,i=e.editor,r=i.getContentState().getActiveZone(),o=r.getZoneId(),a=i.selection.getSelection(),s=r.getLine(a.start.line).getLineAttributes().toMap(),c=a.toPosition(),l=c.start,u=c.len,d=1===a.start.offset;!n.get(o).ops.length&&s.blockquote&&d&&!u&&(s.blockquote="",t=new y.E({zoneId:o}).retain(l-1).retain(1,s),e.deltaSet=n.compose(t))}}]),t}(),d()(o.prototype,"doInsertBlockQuote",[i],Object.getOwnPropertyDescriptor(o.prototype,"doInsertBlockQuote"),o.prototype),d()(o.prototype,"editorWillDoDeleteKey",[r],Object.getOwnPropertyDescriptor(o.prototype,"editorWillDoDeleteKey"),o.prototype),o);new L},bsrO:function(e,k,I){"use strict";(function(r){I.d(k,"b",function(){return u}),I.d(k,"a",function(){return d}),I.d(k,"c",function(){return o}),I.d(k,"l",function(){return h}),I.d(k,"g",function(){return f}),I.d(k,"i",function(){return p}),I.d(k,"h",function(){return m}),I.d(k,"f",function(){return v}),I.d(k,"d",function(){return b}),I.d(k,"e",function(){return y}),I.d(k,"j",function(){return O}),I.d(k,"k",function(){return C});var o,e,t=I("lSNA"),a=I.n(t),n=I("D7h9"),i=I("rWdK"),s=I("7ZH0"),c=I("QM+C"),l=I("rLED"),u="doc_jira_filter_panel_feature",d="jira_filter_feature_tutorial_modal";function h(e,t){var n,i=(n={},a()(n,o.PERMISSION_DENY,r("doc.jira.no_match_jira_base_url")),a()(n,o.DELETED_FAILED,r("doc.jira.filter_deleted_or_no_permission")),a()(n,o.AUTH_REQUIRED,r("issue"===t?"doc.jira.insert_need_connect":"doc.jira.insert_filter_need_connect")),n);s.a.show({tip:i[e]||r("doc.jira.internet_error_tip"),type:"error"})}function f(t){return t?[/^https?:\/\/[^\s]+\.atlassian\.net/].some(function(e){return e.test(t)})?"jira_cloud":"jira_server":""}function p(){return Object(i.a)(n.default.getState()).jiraType}function g(){return Object(i.a)(n.default.getState()).baseUrl}function m(){return Object(i.a)(n.default.getState()).authState}function v(){return Object(l.K)("jira_issue_enable")}function b(){return Object(l.K)("jira_filter_enable")}function y(e){var t="temporary_filter";return Number(e)<0?t="recommend_filter":0<Number(e)&&(t="user_filter"),t}(e=o=o||{})[e.PERMISSION_DENY=95004]="PERMISSION_DENY",e[e.DELETED_FAILED=95007]="DELETED_FAILED",e[e.AUTH_REQUIRED=95012]="AUTH_REQUIRED",e[e.COLLAB_FAILED=95013]="COLLAB_FAILED",e[e.SERVER_SYNCING=95014]="SERVER_SYNCING",e[e.ISSUE_CREATE_SUCCESS_SEARCH_FAIL=95015]="ISSUE_CREATE_SUCCESS_SEARCH_FAIL";var E=new RegExp("(".concat(c.PROTOCOL,")://"));function O(e){var t=g();return!!e.includes(t.replace(E,""))}function C(e,t){var n=/[A-Z0-9]+-[0-9]+/,i=g(),r=new RegExp("".concat(i));if("issue"===t){var o=/((browse)|(projects\/[^\s]+\/issues))\//,a=/[^\s]+\/[^\s]+\?selectedIssue=/;return new RegExp("^(".concat(r.source,"/((").concat(o.source,")|(").concat(a.source,"))(").concat(n.source,"))$"),"i").test(e)}if("filter"!==t)return!1;var s=/issues\//,c=new RegExp("browse/".concat(n.source)),l=/\?jql=[^\s]*(&(amp;)?filter=-?\d*)?/,u=new RegExp("(".concat(/\?filter=-?\d*(&(amp;)?jql=[^\s]*)?/.source,")|(").concat(l.source,")"));return new RegExp("^(".concat(r.source,"/((").concat(s.source,")|(").concat(c.source,"))(").concat(u.source,"))$"),"i").test(e)}}).call(this,I("2vAP"))},bu34:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c});var i=n("i+co"),r=n("SyrE"),o=n("Trbk");function a(e){l(e,i.b.APPLIED)}function s(e,t){l(e,i.b.FAILED,t)}function c(e,t){l(e,i.b.IGNORED,t)}function l(e,t,n){r.g.emit("".concat(o.c,":").concat(o.b),{timestamp:Date.now(),uuid:e,type:t,reason:n})}},bwyh:function(e,a,s){"use strict";(function(d){var e=s("o0o1"),h=s.n(e),t=s("yXPU"),f=s.n(t),n=s("J4zp"),p=s.n(n),i=s("lwsE"),m=s.n(i),r=s("W8MJ"),g=s.n(r),v=s("hbEN"),b=s("ifKl"),y=s("BScZ"),E=s("SZqx"),O=s("BMm3"),C=s("jUga"),k=s("15MJ"),I=s("O9F5"),S=s("OX8E"),T=s("j1lG"),_="#ffeea8",o=function(){function n(e){var g=this,t=e.editor;m()(this,n),this.galleries=new Map,this.isNewGalleryPlugin=!1,this.tempComments=new Map,this.commentIDAndImageUUIDToCommentUUID=new Map,this.highlightedCommentIds=[],this.markedImageUUID=new Set,this.activeCommentId=null,this.onCommentUpdateCallback=b.default,this.onCommentStartLoadingCallback=b.default,this.onCommentLoadedCallback=b.default,this.commentData=[],this.isImageChangeByCs=!1,this.galleryToComments=function(e,t){var n,i,r,o=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a=[];return e&&(i=(n=e.getComments(g.commentData,g.tempComments)).resolvedComments,r=n.unResolvedComments,(o?i:r).forEach(function(e,t){e.forEach(function(e){a.push(g.commentIdToComment(e,t,null))})})),a},this.commentIdToComment=function(e,t,n){var i=g.getCommentUUIDByCommentIdAndImageUUID(e,t);return{commentId:e,serviceType:y.c,serviceToken:g.serviceToken,thirdPartyHeight:n,thirdPartyUUID:i,relativeTopToThirdParty:0}},this.getCommentUUIDByCommentIdAndImageUUID=function(e,t){var n="".concat(e,":").concat(t),i=g.commentIDAndImageUUIDToCommentUUID.get(n);return i||(i=Object(y.d)(),g.commentIDAndImageUUIDToCommentUUID.set(n,i)),i},this.setGalleryOnEditor=function(e,t){var n=e.selStart,i=e.selEnd,r=e.selZone;g.editor.getReps()[r].attributeManager.setAttributesOnRange(n,i,[[k.e,t]])},this.changeComment=function(t,r,o){var a=Promise.resolve(),s=!1;return g.editor.callStack.makeNondoableEvent("changeGalleryComment",function(){var e=g.editor.getCurrentCallStack();e&&"changeGalleryComment"===e.type&&(e.preventScrolling=!0),t.forEach(function(e,t){var n,i=Object(O.b)(g.editor,"gallery",t)[0];i&&(n=e.getGalleryStringWithChangeCommentAttribute(r,o),s||(a=g.changeSetCommitWatcher.addCommitWatcher("gallery",n),s=!0),g.setGalleryOnEditor(i,n))})}),s?a:Promise.reject(new Error("no gallery comment found"))},this.findImageUUIDsByCommentId=function(l){var u=[];return g.galleries.forEach(function(e){var t=e.getComments(g.commentData,g.tempComments).unResolvedComments;if(0<t.size){var n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=p()(o.value,2),c=s[0];-1<s[1].indexOf(l)&&u.push(c)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}}),u},this.collectGalleryAttributeFromEditor=function(){var n=[],e=function(e){return"gallery"===e};return g.editor.getMatchedAttributePositionOnSelection(null,e).forEach(function(e){var t=e.attrValue;t&&n.push(t)}),n},this.notifyGalleriesUpdate=function(e){var i=[],r=[];e.forEach(function(e,t){var n={serviceType:y.c,serviceToken:g.serviceToken,comments:g.galleryToComments(e,t),attributeKey:"gallery",attributeValue:t};i.push(n),e&&r.push(n)}),0<r.length&&g.onCommentLoadedCallback(r),0<i.length&&(g.onCommentUpdateCallback(i),g.updateCommentMarks(e))},this.debounceUpdateAllCommentMarks=Object(v.default)(function(){g.updateAllCommentMarks()}),this.onMount=function(){Promise.resolve().then(function(){var e=g.collectGalleryAttributeFromEditor(),n=[];e.forEach(function(e){var t=new E.a(e);g.galleries.set(e,t),n.push({serviceType:y.c,serviceToken:g.serviceToken,comments:g.galleryToComments(t,e),attributeKey:"gallery",attributeValue:e})}),g.onCommentStartLoadingCallback(n),g.onCommentLoadedCallback(n),g.isNewGalleryPlugin||g.updateAllCommentMarks()})},this.onCsImageChanged=function(){g.isImageChangeByCs=!0},this.changesetApply=function(){g.isImageChangeByCs&&(g.isImageChangeByCs=!1,g.updateGalleriesAttr())},this.updateGalleriesAttr=function(){for(var e=arguments.length,p=new Array(e),t=0;t<e;t++)p[t]=arguments[t];Promise.resolve().then(function(){var i=g.collectGalleryAttributeFromEditor(),r=[];g.galleries.forEach(function(e,t){r.push(t)});for(var o=new Map,e=r.length,t=i.length,n=Math.max(e,t),a=[],s=[],c=0,l=function(){var e,t=i[c],n=r[c];t&&(r.find(function(e){return e===t})||(e=new E.a(t),s.push(e),g.galleries.set(t,e),o.set(t,e))),n&&(i.find(function(e){return e===n})||(a.push(n),o.set(n,null))),c++};c<n;)l();for(var u=0,d=p;u<d.length;u++){var h=d[u],f=new E.a(h);s.push(f),g.galleries.set(h,f),o.set(h,f)}a.forEach(function(e){var t=g.galleries.get(e);t&&(t.getImages().forEach(function(e,t){var n=g.tempComments.get(t);n&&0!==n.length&&(s.find(function(e){return e.isImageExists(t)})||(n.forEach(function(e){g.removeHighlight(e)}),g.tempComments.delete(t)))}),g.galleries.delete(e))}),g.notifyGalleriesUpdate(o)})},this.editorSizeChange=function(){g.galleries.forEach(function(e){e.setCommentHeight(null)})},this.setIsNewImagePlugin=function(e){g.isNewGalleryPlugin=e},this.getGallery=function(e){return g.galleries.get(e)},this.getSelectedImageUUID=function(){return g.selectedImageUUID},this.setSelectedImageUUID=function(e,t){g.selectedImageUUID=e},this.setCommentData=function(e,t){var n=t.comments;g.commentData=n,g.debounceUpdateAllCommentMarks()},this.editor=t,this.serviceToken=t.getDocId(),this.changeSetCommitWatcher=new C.a}function e(e,t,n){return i.apply(this,arguments)}var i,r,o,a,s;function t(e,t){return r.apply(this,arguments)}function c(e,t){return o.apply(this,arguments)}function l(e,t){return a.apply(this,arguments)}function u(e,t){return s.apply(this,arguments)}return g()(n,[{key:"getGalleriesByCommentAttribute",value:function(n){var i=new Map;return this.galleries.forEach(function(e,t){e.isCommentAttributeExists(n)&&i.set(t,e)}),i}},{key:"hasMark",value:function(e){return this.markedImageUUID.has(e)}},{key:"addMark",value:function(e){var t;this.hasMark(e)||(this.isNewGalleryPlugin?S.a.emit(T.q.IMAGE_UPDATE_MARK,{uuid:e,mark:!0}):(t=".maindocbody #image-upload-image-".concat(e,".image-container {\n        border-bottom: 1px solid #FFEEA8;\n      }"),I.a.insertRule(t,"gallery-comment-mark-".concat(e))),this.markedImageUUID.add(e))}},{key:"removeMark",value:function(e){this.hasMark(e)&&!this.isNewGalleryPlugin?I.a.deleteRuleById("gallery-comment-mark-".concat(e)):S.a.emit(T.q.IMAGE_UPDATE_MARK,{uuid:e,mark:!1}),this.markedImageUUID.delete(e)}},{key:"removeAllMarks",value:function(){var t=this;this.markedImageUUID.forEach(function(e){t.removeMark(e)})}},{key:"addHighlight",value:function(i){var r=this;this.highlightedCommentIds.find(function(e){return e===i})||(this.findImageUUIDsByCommentId(i).forEach(function(e){var t,n;r.isNewGalleryPlugin?S.a.emit(T.q.IMAGE_SET_HIGHLIGHT,{uuid:e,highlight:!0}):(t=".maindocbody #image-upload-image-".concat(e," {\n        outline: 4px solid ").concat(_,";\n        background-color: rgb(255, 238, 168);\n      }"),I.a.insertRule(t,"gallery-".concat(e,"-").concat(i)),n="\n      .maindocbody .adit-primary-line-hover.adit-line-hover-type-gallery #image-upload-image-".concat(e," {\n        outline-width: 5px;\n      }"),I.a.insertRule(n,"highlight-".concat(e,"-").concat(i)))}),this.highlightedCommentIds.push(i))}},{key:"removeHighlight",value:function(t){var n=this;this.findImageUUIDsByCommentId(t).forEach(function(e){n.isNewGalleryPlugin?S.a.emit(T.q.IMAGE_SET_HIGHLIGHT,{uuid:e,highlight:!1}):(I.a.deleteRuleById("gallery-".concat(e,"-").concat(t)),I.a.deleteRuleById("highlight-".concat(e,"-").concat(t)))}),this.highlightedCommentIds=this.highlightedCommentIds.filter(function(e){return e!==t})}},{key:"getGalleryHeight",value:function(e){var t=this.galleries.get(e),n=t.getCommentHeight();if(null===n){var i=Object(O.b)(this.editor,"gallery",e)[0];if(!i)throw new Error("no gallery position found");var r=i.selStart,o=i.selZone,a=this.editor.getReps()[o].lines.atIndex(r[0]);if(!a)return 0;n=a.getCharRect(r[1]).height,t.setCommentHeight(n)}return n}},{key:"isCommentExists",value:function(e,t){var n=t.getComments(this.commentData,this.tempComments).unResolvedComments,i=!0,r=!1,o=void 0;try{for(var a,s=n.values()[Symbol.iterator]();!(i=(a=s.next()).done);i=!0)if(-1<a.value.indexOf(e))return!0}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return!1}},{key:"findCommentIdOnWhole",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=this.galleries[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=p()(r.value,2),s=a[0],c=a[1];if(this.isCommentExists(e,c))return s}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return null}},{key:"isUnSubmitComment",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,o=this.tempComments.values()[Symbol.iterator]();!(e=(r=o.next()).done);e=!0)if(r.value.find(function(e){return e===t}))return!0}catch(e){n=!0,i=e}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}return!1}},{key:"updateAllCommentMarks",value:function(){this.updateCommentMarks(this.galleries)}},{key:"updateCommentMarks",value:function(e){var n=this;e.forEach(function(e){var t;!e||0<(t=e.getComments(n.commentData,n.tempComments).unResolvedComments).size&&t.forEach(function(e,t){0<e.length?n.addMark(t):n.removeMark(t)})})}},{key:"getSeriveTypeAndServiceTokenByAttributeKeyAndValue",value:function(e){if("gallery"!==e)return null;var t=this.editor.getDocId();return{serviceType:y.c,serviceToken:t}}},{key:"getCommentHeight",value:function(e,t,n){var i=n.attributeValue;return this.getGalleryHeight(i)}},{key:"getComments",value:function(e,t){var n=t.attributeValue,i=this.galleries.get(n);return this.galleryToComments(i,n)}},{key:"getActiveComments",value:function(){var t=this,n=this.selectedImageUUID;if(!n)return console.error("no selectedImageUUID"),[];var e=[],i=!0,r=!1,o=void 0;try{for(var a,s=this.galleries.values()[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value;if(c.isImageExists(n)){e=(c.getComments(this.commentData,this.tempComments).unResolvedComments.get(n)||[]).map(function(e){return t.commentIdToComment(e,n,null)});break}}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return e}},{key:"getResolvedComments",value:function(){var n=this,i=[],e=!0,t=!1,r=void 0;try{for(var o,a=this.galleries.values()[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)o.value.getResolvedCommentAttributes().forEach(function(e,t){e.forEach(function(e){i.push(n.commentIdToComment(e,t,null))})})}catch(e){t=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw r}}return{serviceType:y.c,comments:i}}},{key:"startNewComment",value:function(e,t){var n=e.tempCommentId,i=t.attributeValue,r=t.context,o=this.selectedImageUUID;if(!o||!this.galleries.get(i))throw new Error("no selectedImageUUID");var a=this.tempComments.get(o)||[];if(!r||!r.choosenImageUUid)throw new Error("no context choosenImageUUid");var s=r.choosenImageUUid;return this.tempComments.set(s,a.concat(n)),this.addHighlight(n),"[".concat(d("editorbar.image"),"]")}},{key:"saveComment",value:(s=f()(h.a.mark(function e(t,n){var i,r,o,a,s,c,l,u=this;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.tempCommentId,r=t.commentId,o=n.attributeValue,this.tempComments.forEach(function(e,t){-1<e.indexOf(i)&&(a=t)}),s=this.galleries.get(o)){e.next=6;break}throw new Error("not gallery found on save comment");case 6:if(c=Object(O.b)(this.editor,"gallery",o)[0]){e.next=9;break}throw new Error("no gallery position found on save comment");case 9:return l=s.getGalleryStringWithNewCommentAttribute(a,"comment-id-".concat(r)),this.editor.callStack.makeNondoableEvent("addGalleryComment",function(){u.setGalleryOnEditor(c,l)}),e.next=13,this.changeSetCommitWatcher.addCommitWatcher("gallery",l);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}},e,this)})),u)},{key:"removeComment",value:(a=f()(h.a.mark(function e(t,n){var i,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="comment-id-".concat(n),r=this.getGalleriesByCommentAttribute(i),this.removeHighlight(n),e.next=5,this.changeComment(r,i,"");case 5:case"end":return e.stop()}},e,this)})),l)},{key:"removeTempComment",value:function(e,n,t){var i=this;t.attributeValue;this.removeHighlight(n),this.tempComments.forEach(function(e,t){-1<e.indexOf(n)&&i.tempComments.set(t,e.filter(function(e){return e!==n}))})}},{key:"resolveComment",value:(o=f()(h.a.mark(function e(t,n){var i,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="comment-id-".concat(n),r=this.getGalleriesByCommentAttribute(i),this.removeHighlight(n),e.next=5,this.changeComment(r,i,"comment-resolved-".concat(n));case 5:case"end":return e.stop()}},e,this)})),c)},{key:"reopenComment",value:(r=f()(h.a.mark(function e(t,n){var i,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="comment-resolved-".concat(n),r=this.getGalleriesByCommentAttribute(i),e.next=4,this.changeComment(r,i,"comment-id-".concat(n));case 4:return e.abrupt("return",null);case 5:case"end":return e.stop()}},e,this)})),t)},{key:"activateComment",value:function(e,t){this.activeCommentId=t,this.addHighlight(t)}},{key:"deactivateComment",value:function(e,t){this.activeCommentId=null,this.isUnSubmitComment(t)||this.removeHighlight(t)}},{key:"addHoverHighlight",value:function(e,t){this.activeCommentId!==t&&this.addHighlight(t)}},{key:"removeHoverHighlight",value:function(e,t){this.activeCommentId===t||this.isUnSubmitComment(t)||this.removeHighlight(t)}},{key:"locateComment",value:(i=f()(h.a.mark(function e(t,n,i){var r,o,a,s;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,i?(o=this.galleries.get(i.attributeValue))&&this.isCommentExists(n,o)&&(r=i.attributeValue):(a=this.findCommentIdOnWhole(n))&&(r=a),!r){e.next=7;break}if("number"==typeof(s=this.getGalleryHeight(r)))return e.abrupt("return",{top:0,height:s,attributeValue:r,attributeKey:"gallery",serviceType:y.c,serviceToken:this.serviceToken});e.next=6;break;case 6:case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}},e,this)})),e)},{key:"onCommentStartLoading",value:function(e){this.onCommentStartLoadingCallback=e}},{key:"onCommentLoaded",value:function(e){this.onCommentLoadedCallback=e}},{key:"onCommentLoadError",value:function(){}},{key:"onCommentUpdated",value:function(e){this.onCommentUpdateCallback=e}},{key:"onActiveCommentChanged",value:function(e){}},{key:"getTeaParams",value:function(e,t){}},{key:"destroy",value:function(){var t=this;this.highlightedCommentIds.forEach(function(e){t.removeHighlight(e)}),this.removeAllMarks()}}]),n}();a.a=o}).call(this,s("2vAP"))},c5mg:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},t),c.a.createElement("g",{clipPath:"url(#7691cf9e55448d623cdc160d2936745f-clip0)"},c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.3 3.3l-.5-.5c-.16-.15-.43-.13-.61.05L9.06 4.98a.35.35 0 00-.02.02l-.5.5c-.1.1-.13.23-.1.37.02.06.04.11.08.16l.06.07 2.6 2.6c.18.18.45.2.61.05l.5-.5c.15-.15.13-.43-.05-.6L11.11 6.5h7.39V17.5H9.3a.3.3 0 00-.3.3v.9c0 .17.13.3.3.3h10.3a.4.4 0 00.4-.4V5.4a.4.4 0 00-.4-.4h-8.45l1.1-1.09c.18-.18.2-.45.04-.6zm-6.55.98c.14 0 .25.12.25.26V8.2c0 .14-.11.25-.25.25h-.5A.25.25 0 015 8.2V5.5l-.72.36A.18.18 0 014 5.72v-.68c0-.1.05-.18.14-.22l.95-.5a.25.25 0 01.13-.04h.53zM7 19.38a.26.26 0 00-.26-.25h-1.3l1.24-1.3c.21-.23.32-.5.32-.78 0-.37-.15-.67-.44-.9a1.67 1.67 0 00-1.1-.37c-.4 0-.74.12-1.02.36-.27.24-.42.54-.44.9 0 .1.08.17.17.17h.69c.08 0 .15-.07.15-.15a.44.44 0 01.17-.3c.09-.07.2-.1.34-.1.15 0 .27.03.35.1.08.09.11.18.11.28 0 .04 0 .09-.02.14a.6.6 0 01-.1.15L4 19.26v.49c0 .14.12.25.26.25h2.48c.14 0 .26-.11.26-.25v-.37z",fill:"#2B2F36"})),c.a.createElement("defs",null,c.a.createElement("clipPath",{id:"7691cf9e55448d623cdc160d2936745f-clip0"},c.a.createElement("path",{fill:"#fff",d:"M0 0h24v24H0z"}))))}},cGQV:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return a});var i=n("RKCD");function r(e){return Object(i.a)(e,{evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{\{([\s\S]+?)\}\}\}/g})}function o(){var n={};return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split("&").forEach(function(e){var t=e.split("=");n[t[0]]=t[1]}),n}function a(e){return"number"==typeof e&&isFinite(e)&&!isNaN(e)}},cHHt:function(e,a,s){"use strict";(function(e){s.d(a,"a",function(){return o});var t=s("zhgJ"),n=((e("placeholder.body.blank.guide")||"").split("|||"),(e("placeholder.comment.blank.guide")||"").split("|||")),i="commentPlaceHolderGuide";var r="";function o(){if(r)return r;var e=Object(t.f)(i);return 0<e&&e<=n.length&&(r=n[e-1]),r}}).call(this,s("2vAP"))},cVBB:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n("Cy2Z"),i=n("q1tI"),a=n.n(i);function r(e,t,n){var i="image-uploaded ".concat(o.a.join(" ")," ").concat(n),r=t?{"data-ace-gallery-json":t}:{};return a.a.createElement("span",Object.assign({},r,{className:i,dangerouslySetInnerHTML:{__html:e}}))}},cgIo:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("RKCD");function r(e){return Object(i.a)(e,{evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{\{([\s\S]+?)\}\}\}/g})}},chSF:function(e,E,O){"use strict";(function(i){O.d(E,"a",function(){return y});var e=O("lwsE"),r=O.n(e),t=O("W8MJ"),n=O.n(t),o=O("a1gu"),a=O.n(o),s=O("Nsbk"),c=O.n(s),l=O("7W2i"),u=O.n(l),d=O("q1tI"),h=O.n(d),f=O("UlbS"),p=O("CnBM"),g=O.n(p),m=(O("wQU+"),O("YlgD")),v={padding:"4px"},b=g()({loader:function(){return Promise.all([O.e("commons--home_banner--reaction--user_profile--whats_new_request"),O.e("commons--reaction--user_profile"),O.e("reaction")]).then(O.bind(null,"fVNN"))},loading:function(){return null}}),y=function(e){function t(){var n;return r()(this,t),(n=a()(this,c()(t).apply(this,arguments))).handleReactionDetailClick=function(e){e.stopPropagation()},n.handleAvatarClick=function(e,t){n.props.onUserClick&&n.props.onUserClick(Object(m.b)(e),t)},n}return u()(t,e),n()(t,[{key:"render",value:function(){var e=this.props,t=e.reactions,n=e.activeReactionType;return h.a.createElement("div",{onClick:this.handleReactionDetailClick},h.a.createElement(f.Dialog,{className:"reaction-detail-dialog",visible:!0,center:!0,footer:null,width:640,title:i("reaction.detail"),animate:!1,style:v,onClose:this.props.onClose},h.a.createElement(b,{reactions:t.map(function(e){return{type:e.reactionKey,chatters:e.userList.map(function(e){return Object(m.a)(e)})}}),activeReactionType:n,onAvatarClick:this.handleAvatarClick})))}}]),t}(h.a.PureComponent)}).call(this,O("2vAP"))},chfE:function(e,t,n){"use strict";n.d(t,"d",function(){return c}),n.d(t,"f",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"b",function(){return h}),n.d(t,"a",function(){return f});var i=n("o0o1"),M=n.n(i),r=n("yXPU"),o=n.n(r),a=n("lSNA"),s=n.n(a),L=n("toa8"),R=n("Z/PY"),N=n("j1lG"),D=n("Tqb2"),x=n("15MJ"),P=n("lQZd"),B=n("jJw9"),c=function(e,t){return s()({},N.c,h(Object.assign({},e,{},t,{needSaveExternal:!0})))},l=function(e,t){return s()({},N.c,h(Object.assign({},e,{},t)))},u=function(e,t){return s()({},N.c,h(Object.assign({},e,{},t,{needSaveDriveImage:!0})))},d=function(e,t){return s()({},N.c,h(Object.assign({},e,{},t,{needTransformToGallery:!0})))},h=function(e){var t=e.uuid,n=e.width,i=e.height,r=e.needTransformToGallery,o=e.imageType,a=e.size,s=e.needSaveExternal,c=e.needSaveDriveImage,l=e.sourceFileToken,u=e.loadingShowPreview,d=e.naturalHeight,h=e.naturalWidth,f=e.comments,p=e.intermediateSrc,g=e.uploading,m=e.uploadProgress,v={items:[{uuid:t,height:i.toString(),width:n.toString(),natrualHeight:d||i.toString(),natrualWidth:h||n.toString(),image_type:o||"",size:a||0,isLocalAttribs:!0,intermediateSrc:p,loadingShowPreview:u,sourceFileToken:l,needTransformToGallery:r,needSaveDriveImage:c,needSaveExternal:s,uploading:g,uploadProgress:m,comments:f}]};return JSON.stringify(v)};function f(e){return p.apply(this,arguments)}function p(){return(p=o()(M.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k,I,S,T,_,w,j;return M.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.uuid&&(t.fileToken||t.src)){e.next=3;break}return console.error("[image plugin] generate attribs fail."),e.abrupt("return",null);case 3:if(n=t.uuid,i=t.fileToken,r=t.height,o=t.width,a=t.src,s=t.isDocImage,c=t.naturalHeight,l=t.naturalWidth,u=t.imageType,d=t.size,h=t.comments,f=void 0===h?[]:h,p=a,s?(p=Object(B.replaceImageDataSrc)(decodeURIComponent(p).replace(/\/\/file/,"/file")),g=a):i&&(p=Object(R.i)(i,Object(P.g)()),g=p),e.prev=6,v=d,b=c,y=l,(m=u)&&v&&b&&y){e.next=27;break}return e.next=14,Object(L.d)({url:p,method:"get",responseType:"blob"});case 14:return E=e.sent,O=E.data,C=URL.createObjectURL(O),e.next=19,Object(D.R)(C);case 19:k=e.sent,I=k.naturalWidth,S=k.naturalHeight,b=S.toString(),y=I.toString(),m=O.type,v=O.size,URL.revokeObjectURL(C);case 27:return T=r&&r!==N.e&&r.toString()||b.toString(),_=o&&o!==N.f&&o.toString()||y.toString(),w={uuid:n,src:encodeURIComponent(g),height:T,width:_,currHeight:T,currWidth:_,natrualHeight:b.toString(),natrualWidth:y.toString(),file_token:i||"",image_type:m,size:v,comments:f,pluginName:x.s,scale:Object(R.m)(y,b)},j={items:[Object(D.S)(w)]},e.abrupt("return",JSON.stringify(j));case 34:return e.prev=34,e.t0=e.catch(6),e.abrupt("return",null);case 37:case"end":return e.stop()}},e,null,[[6,34]])}))).apply(this,arguments)}},chgP:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var i=n("lwsE"),r=n.n(i),o=n("YWBl"),a=n("YNKm"),s=function e(t){var i=this;r()(this,e),this.aceKeyEvent=function(e,t){var n=t.evt;return!!Object(a.hb)(n,a.T)&&(n.preventDefault(),i.editor.triggerCommand(a.T),!0)},this.editor=t.editor,this.editor.registerCommand(a.T,function(e,t){t.doUndoRedo(e),Object(o.a)({action:e})})}},"d0/N":function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s="back-btn.top_to_offset",c="back-btn.offset_to_top",l="back-btn.jump_to_top",u="back-btn.doc_mounted",d="back-btn.toggle_sync";n.d(t,"a",function(){return h});var h=function(){function t(e){r()(this,t),this.emit=e}return a()(t,[{key:"destroy",value:function(){this.emit=null}},{key:"onDocMounted",value:function(e){this.emit.on(u,e)}},{key:"offDocMounted",value:function(e){this.emit.off(u,e)}},{key:"docMounted",value:function(){this.emit.trigger(u)}},{key:"clickBtn",value:function(e){var t=e.isScrollToComment;this.emit.trigger(t?s:c)}},{key:"onTopToOffset",value:function(e){this.emit.on(s,e)}},{key:"offTopToOffset",value:function(e){this.emit.off(s,e)}},{key:"onOffsetToTop",value:function(e){this.emit.on(c,e)}},{key:"offOffsetToTop",value:function(e){this.emit.off(c,e)}},{key:"onToggleSync",value:function(e){this.emit.on(d,e)}},{key:"offToggleSync",value:function(e){this.emit.off(d,e)}},{key:"toggleSync",value:function(e){this.emit.trigger(d,[e])}},{key:"onJump",value:function(e){this.emit.on(l,e)}},{key:"offJump",value:function(e){this.emit.off(l,e)}},{key:"jump",value:function(e){this.emit.trigger(l,[e])}}]),t}()},dF9M:function(e,o,a){"use strict";(function(r){a.d(o,"a",function(){return i});var e=a("wd/R"),t=a.n(e),n=(a("XDpg"),a("B55N"),a("f8Ac"));t.a.locale("en"),t.a.locale(Object(n.c)().toLowerCase()),t.a.relativeTimeThreshold("ss",0),t.a.relativeTimeThreshold("s",60),t.a.relativeTimeThreshold("m",60),t.a.relativeTimeThreshold("h",24),t.a.relativeTimeThreshold("d",31),t.a.relativeTimeThreshold("M",12);var i={TODAY:"h:mm A [Today]",YESTERDAY:"h:mm A [Yesterday]",BEFORE_YESTERDAY:"h:mm A [The day before yesterday]",SAME_YEAR:"h:mm A MMM D",BEFORE_YEAR:"MMM D, YYYY"};(function(){i.TODAY=r("space.date_format.today"),i.YESTERDAY=r("space.date_format.yesterday"),i.BEFORE_YESTERDAY=r("space.date_format.before_yesterday"),i.SAME_YEAR=r("space.date_format.same_year"),i.BEFORE_YEAR=r("space.date_format.before_year");var e=t.a.locale();t.a.locale(e,{relativeTime:{future:r("space.in_future"),past:function(e){return-1===[r("date.just")].indexOf(e)?"".concat(e).concat(r("space.time_before")):e},s:function(e,t,n,i){return r(i?"space.a_moment":"date.just")},ss:r("space.ss_seconds"),m:r("space.a_minute"),mm:r("space.mm_minutes"),h:r("space.a_hour"),hh:r("space.hh_hours")}})})()}).call(this,a("2vAP"))},dHvJ:function(e,t,n){"use strict";n.d(t,"a",function(){return E});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("PJYZ"),h=n.n(d),f=n("7W2i"),p=n.n(f),g=n("q1tI"),m=n.n(g),v=(n("17x9"),n("i8i4")),b=n.n(v),y=n("OX8E"),E=function(e){function n(e){var t;return r()(this,n),(t=c()(this,u()(n).call(this,e))).setNode=t.setNode.bind(h()(t)),t.viewportContentChange=t.viewportContentChange.bind(h()(t)),t}return p()(n,e),a()(n,[{key:"componentDidMount",value:function(){y.a.on("viewportContentChange",this.viewportContentChange),this.viewportContentChange()}},{key:"componentWillUnmount",value:function(){y.a.off("viewportContentChange",this.viewportContentChange)}},{key:"setNode",value:function(e){var t=g.Children.only(this.props.children);t.ref&&t.ref(e),this.node=b.a.findDOMNode(e)}},{key:"viewportContentChange",value:function(){if(this.node){var e=this.node.getBoundingClientRect().top,t=window.innerHeight;if(0<e&&e<t)return this.props.once&&y.a.off("viewportContentChange",this.viewportContentChange),void this.props.onAppear();this.props.onDisappear&&this.props.onDisappear()}}},{key:"render",value:function(){var e=g.Children.only(this.props.children);return Object(g.cloneElement)(e,{ref:this.setNode})}}]),n}(m.a.Component)},dIhn:function(e,t,n){"use strict";function i(e){if(window.requestIdleCallback)return window.requestIdleCallback(e);var t=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})})}function r(e){return window.cancelIdleCallback?window.cancelIdleCallback(e):clearTimeout(e)}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r})},dP4c:function(e,t,n){"use strict";n.d(t,"c",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"d",function(){return f});var i=n("hMnB"),r=n.n(i),o=n("iP/4"),a=n("ucr6"),s=n("QM+C"),c=n("Ysvc");function l(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];!o.a.isLark&&t?window.open(e):Object(c.a)()||n?r.a.href=e:a.a.push(e)}function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=new RegExp(s.LENGTH_LIMITED_EMAIL_REG).test(e);return/^https?:|^mailto:|^ftp:/.test(e)?e:t?"mailto:"+e:(e.startsWith("http")||(e="http://"+e),e)}function d(){return/^data:/.test(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")}var h="docs-open-link-iframe";function f(e){var t=document.querySelector("iframe#".concat(h));return t||((t=document.createElement("iframe")).id=h,t.style.display="none",document.body.appendChild(t)),t.src=e,t}},dQBc:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"j",function(){return o}),n.d(t,"l",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"k",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"a",function(){return d}),n.d(t,"g",function(){return h}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"m",function(){return g}),n.d(t,"f",function(){return m});var i=n("rLED"),r="CLIENT_VARS",o="SHEET_CLIENT_VARS",a="USER_CHANGESET",s="COMMITED_CHANGESET",c="CHANGES_MAP",l=1e13,u=204,d="CACHE",h="NETWORK",f=-8,p={};function g(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window.User.id;return e||console.error("author must not be undefined"),{apool:{nextNum:1,numToAttrib:{0:["author",e]}},initialAttributedText:{attribs:"*0|1+1|1+1",text:"\n\n"},initialAttributedTexts:{attribs:{0:"*0|1+1|1+1"},text:{0:"\n\n"}}}}var m=Object(i.M)("doc_max_online_retry_times",3)},dXgG:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o});var i=1e3,r=120,o=9},dXj0:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29uX3Rvb2xfaW5saW5ldmlld19ub3I8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iV2ViLTE2KjE2IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iQXJ0Ym9hcmQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC04NTQuMDAwMDAwLCAtNTMyLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0iaWNvbl90b29sX2lubGluZXZpZXdfbm9yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NTQuMDAwMDAwLCA1MzIuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0iYmciIGZpbGwtcnVsZT0ibm9uemVybyIgeD0iMCIgeT0iMCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48L3JlY3Q+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOS42LDExIEwxOS42LDExIEMxOS44MjA5MTM5LDExIDIwLDExLjE2Nzg5MzIgMjAsMTEuMzc1IEwyMCwxMi4xMjUgQzIwLDEyLjMzMjEwNjggMTkuODIwOTEzOSwxMi41IDE5LjYsMTIuNSBMOS42LDEyLjUgQzkuMzc5MDg2MSwxMi41IDkuMiwxMi4zMzIxMDY4IDkuMiwxMi4xMjUgTDkuMiwxMS4zNzUgQzkuMiwxMS4xNjc4OTMyIDkuMzc5MDg2MSwxMSA5LjYsMTEgWiBNNC40Mjg1NzE0MywxMSBMNi41NzE0Mjg1NywxMSBDNi44MDgxMjIwNCwxMSA3LDExLjE2Nzg5MzIgNywxMS4zNzUgTDcsMTIuMTI1IEM3LDEyLjMzMjEwNjggNi44MDgxMjIwNCwxMi41IDYuNTcxNDI4NTcsMTIuNSBMNC40Mjg1NzE0MywxMi41IEM0LjE5MTg3Nzk2LDEyLjUgNCwxMi4zMzIxMDY4IDQsMTIuMTI1IEw0LDExLjM3NSBDNCwxMS4xNjc4OTMyIDQuMTkxODc3OTYsMTEgNC40Mjg1NzE0MywxMSBaIiBpZD0iaWNvbl90b29sX2lubGluZS12aWV3X25vciIgZmlsbD0iIzJCMkYzNiI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},dcjY:function(e,t,n){},dd8S:function(e,B,U){"use strict";(function(H){var e=U("lSNA"),c=U.n(e),t=U("lwsE"),a=U.n(t),n=U("a1gu"),s=U.n(n),i=U("Nsbk"),l=U.n(i),r=U("W8MJ"),u=U.n(r),o=U("7W2i"),d=U.n(o),F=U("NZ+B"),V=U("yIs4"),h=U("q1tI"),W=U.n(h),f=(U("17x9"),U("TSYQ")),K=U.n(f),Z=U("uQON"),q=U("1QvZ"),Y=(U("pTmc"),U("P4CN")),J=U("YO6O"),Q=U("sTQd"),p=U("dHvJ"),g=U("OX8E"),m=U("GdfX"),v=U("VIFs"),b=U("EVj1"),y=U("lQZd"),E=U("16UX"),L=U("mOv+"),X=U("AcDe"),O=U("UlbS"),C=U("DOYj"),k=U("7I3H"),I=U("5gSl"),S=U("7ESD"),T=U("Sjdk"),$=U("VI6H"),ee=U("T7Wt"),R=U("QM+C"),_=U("m3ds"),w=U("MO5G"),j=U("WUVX"),M=U("96li"),N=U("Xngx"),D=U("8wh8"),x=U("l8+p"),P=function(e){function o(e){var M;a()(this,o),(M=s()(this,l()(o).call(this,e))).toggleExpand=function(e){e.stopPropagation(),M.setState({expanded:!M.state.expanded},function(){var e=M.props.onResize;e&&e(!0)})},M.handleRetry=function(e){e.stopPropagation();var t=M.props,n=t.onRetry,i=t.error,r=t.type,o=t.replyId;i&&n(r,o)},M.handleReply=function(e){var t=M.props,n=t.onReply,i=t.token;n&&n(e,i)},M.handleDelete=function(){var e=M.props,t=e.onDelete,n=e.replyId;t&&t(n)},M.handleTranslate=function(e,t){var n=M.props,i=n.onTranslate,r=n.replyId,o=n.translateContentCompare;M.setState({showCompare:o}),i&&i(r,t)},M.handleToggleTranslateContent=function(e){Object(I.a)(e),M.setState({showCompare:!M.state.showCompare},function(){var e=M.props.onResize;e&&e()})},M.handleReactionVisibleChange=function(e){(M.isReactionShow=e)&&M.props.onShowReactionPanel()},M.renderCommentItemControls=function(){var e=M.props,t=e.source,n=e.isMyReply,i=e.onResolve,r=e.getToolTipContainer,o=e.sending,a=e.error,s=e.readonly,c=e.enableReaction,l=e.onReactionMouseEnter,u=e.translateContent,d=e.translateStatus,h=e.transEnabled,f=e.highlight,p=e.token,g=e.equalLang,m=e.enableFullCommentStyle,v=e.enableReply,b=e.content;if(!f)return null;var y=M.state.showCompare,E=!o&&!a&!s,O=c&&E,C=E&&n,k=Object($.n)(p)&&Object($.h)()&&!Object($.j)(),I=E&&(n||k),S=E&&v&&!R.isAnonymousAccess,T=h&&"loading"!==d&&!u&&E&&b&&!b.match(/^[\s\n]+$/),_=h&&u&&E&&!y,w=M.state.showTranslate,j=E&&(!m||v);return"full_comment"===t||m?W.a.createElement(L.a,{canResolve:j,canReply:S,canReact:O,canDelete:I,canEdit:C,onResolve:i,onReact:M.handleReactionClick,onDelete:M.handleDelete,onEdit:M.handleOnEdit,onReply:M.handleReply,getToolTipContainer:r,onReactionVisibleChange:M.handleReactionVisibleChange,onReactionMouseEnter:l,onTranslate:M.handleTranslate,onToggleTranslateContent:M.handleToggleTranslateContent,canTranslate:T,equalLang:g,canShowTranslate:w,canShowContent:_,onReactionPopoverMouseEnter:M.handleMouseEnter}):W.a.createElement(L.b,{canResolve:E,canReact:O,canDelete:I,canEdit:C,canReply:S,onResolve:i,onReact:M.handleReactionClick,onDelete:M.handleDelete,onEdit:M.handleOnEdit,onReply:M.handleReply,getToolTipContainer:r,onReactionVisibleChange:M.handleReactionVisibleChange,onReactionMouseEnter:l,onTranslate:M.handleTranslate,onToggleTranslateContent:M.handleToggleTranslateContent,canTranslate:T,equalLang:g,canShowTranslate:w,canShowContent:_,onReactionPopoverMouseEnter:M.handleMouseEnter})},M.handleOnEdit=function(e){var t=M.props,n=t.onEdit,i=t.onResize,r=t.replyId;n&&n(r),M.setState(function(e){return Object.assign({},e,{edit:!0})},function(){i&&i(),M.shouldFocusTextArea&&M.handleTextareaFocus(e)}),M.toggleHighlight(!1);var o=M.props.commentId;S.a.triggerFind(o)},M.handleTextareaFocus=function(e){var t,n=M.props,i=n.content,r=n.entities,o=n.extra;M.textareaRef.handleFillHtml(i,e,r),M.getCommentImageEnabled()&&o&&o.image_list&&0<o.image_list.length&&(t=M.getImageListByToken(o.image_list),M.textareaRef.handleFillImage(t)),M.textareaRef.focus(),M.textareaRef.setCursorEnd()},M.toggleHighlight=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=M.props,i=n.onHighlightChange,r=n.replyId;"function"==typeof i&&(M.clearMouseLeaveTimer(),0<t?M.mouseLeaveTimer=setTimeout(function(){e!==M.props.highlight&&i(r,e)},t):e!==M.props.highlight&&i(r,e))},M.handleUpdateTextareaClose=function(){M.setState({edit:!1}),window.setTimeout(function(){var e=M.props.onResize;e&&e()});var e=M.props.commentId;S.a.triggerFind(e)},M.handleUpdateTextareaConfirm=function(e,t,n){var i=M.props,r=i.updateTextAreaProps,o=i.replyId,a=i.commentId;r.onConfirm(o,e,t,n,a),M.handleUpdateTextareaClose()},M.getUpdateTextareaRef=function(e){var t=M.props,n=t.updateTextAreaProps,i=t.replyId;M.textareaRef=e,n.getUpdateTextareaRef&&n.getUpdateTextareaRef(i,e)},M.renderUpdateTextarea=function(){var e=M.state.edit;if(M.props.updateTextAreaProps&&e){var t,n="comment-panel",i=K()(c()({},"".concat(n,"__textarea--expand"),e),M.props.updateTextAreaProps.className,M.props.updateTextAreaProps.expandCls),r=M.props,o=r.extra,a=r.commentImageEnabled;o&&o.image_list&&(t=M.getImageListByToken(o.image_list));var s=Object.assign({},M.props.updateTextAreaProps,{onConfirm:M.handleUpdateTextareaConfirm,getRef:M.getUpdateTextareaRef,onCancel:M.handleUpdateTextareaClose,onEscCancel:M.handleUpdateTextareaClose,alwaysShowConfirmBtn:!0,className:i,replyId:M.props.replyId,imageList:t,isGlobal:1===M.props.isWhole,commentImageEnabled:a});return W.a.createElement(T.a,s)}return null},M.renderTranslate=function(e){var t=M.props,n=t.translateStatus,i=t.translateContent,r=t.entities,o=t.content,a=t.commentId,s=t.translateContentCompare,c=t.replyId,l=t.embedObjShareEnable,u=M.state,d=u.edit,h=u.showCompare;if("loading"!==n&&"success"!==n)return null;var f=h&&!s?o:i;return W.a.createElement(W.a.Fragment,null,h&&i&&!d&&W.a.createElement(X.a,{isTranslateContent:!h,key:c,contentCls:K()(e,"comment-list-item__translate-content",{"comment-list-item__translate-content-bg":s},"clearfix"),style:"",content:f,entities:r,replyId:c,commentId:a,isEdit:d,embedObjShareEnable:l},M.renderTranslateBtn(!0)))},M.renderTranslateBtn=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=M.props.translateStatus,n=M.state,i=n.edit,r=n.showTranslate,o=n.showCompare;if("loading"!==t&&"success"!==t)return null;var a=K()("comment-list-item__translate-wrapper",{"comment-list-item__translate-wrapper-loading":"loading"===t}),s=e||!o,c=H(e?r?"comment.hide_more_content":"common.translate_text_pack":r?"common.translate_comment_original_text":"common.translate_text"),l=function(){return W.a.createElement("span",{className:K()("comment-list-item__translate"),onClick:M.handleToggleTranslateContent},W.a.createElement(k.a,{className:a}),W.a.createElement(C.a,{className:"comment-list-item__translate-A"}))};return W.a.createElement(W.a.Fragment,null,s&&!i&&W.a.createElement(O.Tooltip,{title:c,placement:"left"},e?W.a.createElement("div",{className:"comment-list-item__translate-icon-wrapper"},l()):l()))},M.handleReactionClick=function(t){if(!M.props.readonly){var e=M.props,n=e.currentUserId,i=e.reactions,r=e.replyId;if(i){var o=i.find(function(e){return e.reactionKey===t});if(o)if(o.userList.find(function(e){return e.userId===n}))return void M.props.removeReaction(o,event)}M.props.addReaction({referKey:r,reactionKey:t},event)}},M.handleReactionDetailClick=function(e,t){var n=M.props.reactions;M.props.onClickReactionDetail(e,n,t)},M.handleReactionDetailClose=function(){M.toggleHighlight(!1)},M.handleMouseEnter=function(){M.state.edit||M.toggleHighlight(!0)},M.handleMouseMove=function(){M.state.edit||M.toggleHighlight(!0)},M.handleMouseLeave=function(){M.toggleHighlight(!1,M.isReactionShow?300:0)},M.handleIPadClick=function(){_.a.isIPad&&M.handleMouseEnter()},M.handleAnimationEnd=function(){M.setState({highlightAnimationCls:void 0})};var t=M.props,n=t.translateContentCompare,i=t.translateStatus,r=!n&&"success"===i;return M.state={textOverLimit:!1,expanded:!1,edit:!1,highlightAnimationCls:void 0,showTranslate:r,showCompare:n&&"success"===i},M.mouseLeaveTimer=null,M.isReactionShow=!1,M.isAppear=!1,M.mouseDownContext=null,M}return d()(o,e),u()(o,null,[{key:"getDerivedStateFromProps",value:function(e){return{showTranslate:!e.translateContentCompare&&"success"===e.translateStatus}}}]),u()(o,[{key:"componentDidMount",value:function(){var e,t=this,n=this.props.showContentLimit;!Object(V.default)(n)||(e=this.itemRef.querySelector(".comment-list-item__content"))&&e.getBoundingClientRect().height>n&&window.setTimeout(function(){t.setState({textOverLimit:!0},function(){var e=t.props.onResize;e&&e()})})}},{key:"componentDidUpdate",value:function(e,t){var n,i=t.expanded,r=e.translateStatus,o=e.translateContentCompare,a=this.props,s=a.translateStatus,c=a.translateContentCompare;o===c&&s===r||this.setState({showCompare:c&&"success"===s}),this.state.expanded===i||(n=this.props.onResize)&&n()}},{key:"componentWillUnmount",value:function(){this.clearMouseLeaveTimer()}},{key:"clearMouseLeaveTimer",value:function(){this.mouseLeaveTimer&&(clearTimeout(this.mouseLeaveTimer),this.mouseLeaveTimer=null)}},{key:"getCommentImageEnabled",value:function(){return Object(w.a)()&&this.props.commentImageEnabled}},{key:"renderAudioComment",value:function(){var e=this.state.edit,t=this.props,n=t.source,i=t.extra,r=t.highlight;if(i&&i.attachment&&i.attachment.audio_file_token){var o=i.attachment,a=o.audio_file_token,s=o.audio_duration,c=Object(v.prependDriveStreamAPI)("/api/box/stream/download/all/".concat(a,"/")),l={mount_node_token:encodeURIComponent("obj:".concat(Object(y.l)(),":").concat(Object(y.g)())),mount_point:"comment"},u=c+Object(b.d)(l),d=K()("comment-list-item__audio",{"comment-list-item__audio--edit":e,"comment-list-item__audio--highlight":"full_comment"===n&&r});return W.a.createElement("div",{className:d},W.a.createElement(m.a,{url:u,duration:s}))}return null}},{key:"renderReactionList",value:function(){var e=this.props,t=e.reactions,n=e.enableReaction,i=this.state.edit;return t&&!i&&n?W.a.createElement(E.b,{reactions:t,onReactionClick:this.handleReactionClick,onMoreClick:this.handleReactionDetailClick,onReactionDetailClose:this.handleReactionDetailClose}):null}},{key:"startHighlightAnimation",value:function(e){this.state.highlightAnimationCls||this.setState({highlightAnimationCls:e})}},{key:"getItemRef",value:function(){return this.itemRef}},{key:"getImageListByToken",value:function(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:M.a.READY,r=Object(D.a)(),o=Object(D.b)(),a=this.props.replyId;return e.map(function(e){var t,n;return r[e]?t=n=r[e]:(t=Object(N.c)({fileToken:e,mountPoint:{token:a,type:"comment_image"}}),n=o[e]||Object(N.b)({fileToken:e,mountPoint:{token:a,type:"comment_image"},coverOptions:{width:360,height:360,shape:"square"}})),{src:t,coverSrc:n,token:e,status:i}})}},{key:"renderImage",value:function(){var e=this.state.edit,t=this.props,n=t.extra,i=t.isWhole,r=t.replyId,o=t.scrollContainer,a=t.isCalcCommentPosition,s=this.props.commentId;if(e||!n||!n.image_list||0===n.image_list.length)return null;s&&-1<s.indexOf(":")&&(s=s.split(":")[2]);var c=this.getImageListByToken(n.image_list,M.a.LOADING),l=o?[o]:Object(x.a)(1===i?"globalComment":void 0);return W.a.createElement(j.a,{style:{marginTop:8},imageList:c,lineImageCount:i?1/0:3,commentId:s,replyId:r,scrollContainer:l,isCalcCommentPosition:a})}},{key:"renderItem",value:function(){var t=this,e=this.props,n=e.readonly,i=e.userName,r=e.avatar,o=e.content,a=e.time,s=e.showContentLimit,c=e.error,l=e.sending,u=e.status,d=e.showBadge,h=e.ellipsisAuthorClass,f=e.modify,p=e.token,g=e.panelExpand,m=e.source,v=e.entities,b=e.replyId,y=e.translateContent,E=e.highlight,O=e.commentId,C=e.embedObjShareEnable,k=e.enableFullCommentStyle,I=this.state,S=I.textOverLimit,T=I.expanded,_=I.edit,w=I.highlightAnimationCls,j=I.showTranslate,M=Object(V.default)(s),L=K()("comment-list-item",w),R=M&&S,N=K()("comment-list-item__content",{"comment-list-item__content--overlimit":R,"comment-list-item__content--expanded":T}),D=!T&&R?{maxHeight:"".concat(s,"px")}:{},x=K()("comment-list-item__more",{"comment-list-item__more--expanded":!M||T}),P=K()("comment-list-item__textarea",{"comment-list-item__textarea--edit":_}),B=K()("comment-list-item__author ellipsis",h),U=j?y:o,z=g&&!!p&&!Object($.n)(p)&&!Object($.j)();return W.a.createElement("div",{className:L,ref:function(e){return t.itemRef=e},onAnimationEnd:this.handleAnimationEnd},W.a.createElement("div",{className:K()("comment-list-item__wrapper","layout-row","flex",{"highlight-comment":("full_comment"===m||k)&&E}),onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onClick:this.handleIPadClick},W.a.createElement("div",{className:"comment-list-item__avatar"},W.a.createElement(J.default,{source:m,token:p,name:i,trigger:"click",placement:"l",prefixCls:"cooperater-user-popover",usePopover:!!z,hideAction:["mouseLeave"]},W.a.createElement("div",{className:"avatar",alt:i,style:r?{backgroundImage:"url(".concat(r,")")}:{}}))),W.a.createElement("div",{className:"comment-list-item__content-wrapper layout-column flex"},W.a.createElement("div",{className:"comment-list-item__author-info layout-row"},W.a.createElement("span",{className:B},i,l||c?"":W.a.createElement("span",{className:"comment-list-item__time"},a&&W.a.createElement(ee.a,{time:Object(Q.a)(a),intervalTime:6e4})," ",a&&f?H("comment.modify"):"")),l&&W.a.createElement(q.a,{className:"comment-list-item__loading",width:"12",height:"12"}),Object(F.a)(d)||u===Y.a?W.a.createElement("div",{className:"comment-list-item__unread-dot"}):null,!n&&this.renderCommentItemControls()),U&&W.a.createElement(X.a,{isTranslateContent:!!j,key:b,contentCls:N,contentStyle:D,content:U,entities:v,replyId:b,isEdit:_,commentId:O,embedObjShareEnable:C},this.renderTranslateBtn()),this.renderTranslate(N),R&&W.a.createElement("div",{className:x,onClick:this.toggleExpand},H(T?"comment.hide_more_content":"comment.show_more_content")),this.renderImage(),c&&W.a.createElement("div",{className:"comment-list-item__error"},W.a.createElement("div",{className:"error-icon"}),W.a.createElement("div",{className:"error-tips"},W.a.createElement("span",null,Object(Z.i)(c.code)," "),W.a.createElement("span",{className:"error-retry",onClick:this.handleRetry},H("comment.error_retry")))),this.renderAudioComment(),this.renderReactionList())),W.a.createElement("div",{className:P},this.renderUpdateTextarea()))}},{key:"handleAppear",value:function(){var e=this.props,t=e.busNameSpace,n=e.messageId,i=e.status,r=e.replyId,o="".concat(t,".inViewport"),a="".concat(t,".unreadyInViewport");i===Y.a&&g.a.trigger(o,[n]),void 0===i&&g.a.trigger(a,[r]),this.isAppear||(this.isAppear=!0)}},{key:"handleDisappear",value:function(){this.isAppear&&(this.isAppear=!1)}},{key:"render",value:function(){var e=this,t=this.props.replyId;return W.a.createElement(p.a,{onAppear:function(){return e.handleAppear()},onDisappear:function(){return e.handleDisappear()},key:t},this.renderItem())}},{key:"shouldFocusTextArea",get:function(){return this.textareaRef&&!this.textareaRef.isFocus()}}]),o}(W.a.Component);B.a=P}).call(this,U("2vAP"))},ddk1:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("XiKa"),r=n.n(i),o=function(e){return r()(e,{allowedTags:[],allowedAttributes:[]})}},djbN:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"h",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"g",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"d",function(){return h}),n.d(t,"f",function(){return f});var i=n("USG6"),r=n("6SzI"),o=Object(r.createAction)(i.FREEZE_SPREAD_TOGGLE),a=function(e){var t=e.isExport,n=e.fileType;return{type:i.EXPORT_FILE,payload:{isExport:t,fileType:n}}},s=function(){return{type:i.TOGGLE_HISTORY}},c=function(e){return{type:i.TOGGLE_TITLE_FOCUS_STATUS,payload:{isFocus:e}}},l=function(e){return{type:i.CONTENT_VISIBLE,payload:e}},u=Object(r.createAction)(i.HIDE_DROPDOWN_MENU),d=function(){return{type:i.HIDE_HYPER_LINK_EDITOR}},h=Object(r.createAction)(i.HIDE_FILTER_MENU),f=function(e){return{type:i.SET_EMBED_SHEET_ALLOW_COMMENT,payload:e}}},dn8U:function(e,t,n){"use strict";function i(e){if("string"!=typeof e)return"";var t=e.split(" "),n="",i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,l=/author-(\d+)/.exec(c);l&&(n=l[0])}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}n.d(t,"a",function(){return i})},dnly:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(){return Promise.all([n.e("doc_index_css"),n.e("commons--advanced-search-modal--suite_header"),n.e("commons--anonymous_suite_header--suite_header"),n.e("vendors--suite_header"),n.e("suite_header")]).then(n.bind(null,"vIN0"))}},domO:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNTRweCIgaGVpZ2h0PSI0OHB4IiB2aWV3Qm94PSIwIDAgNTQgNDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT7liqDovb3lpLHotKU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0i5Yqg6L29IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0i5Yqg6L295aSx6LSlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjk0LjAwMDAwMCwgLTgwNC4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9Iueql+WPoy3luKbmoIfpopgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2MC4wMDAwMDAsIDYwOC4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSLliqDovb3lpLHotKUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI5Ni4wMDAwMDAsIDE5Ni4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzOC4wMDAwMDAsIDAuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTM2LDMgQzM2LDExLjQ4OTcxNjUgMjkuMDcxNTA1NiwxOC42MDY2Nzg4IDIyLjk5OTk1MjMsMjAuNTAzODcwNSBMMjIuOTk5OTUyMywyNS40OTYxMjk1IEMyOS4wNzE1MDU2LDI3LjM5MzMyMTIgMzYsMzQuNTEwMjgzNSAzNiw0MyBMNCw0MyBMNCw0MyBDNCwzNC41MDk4MTcxIDEwLjkyOTI1NTcsMjcuMzkyNTM5MyAxNy4wMDEwNDgzLDI1LjQ5NTgxNjkgTDE3LjAwMTA0ODMsMjAuNTA0MTgzMSBDMTAuOTI5MjU1NywxOC42MDc0NjA3IDQsMTEuNDkwMTgyOSA0LDMgTDQsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMzYsMyBDMzYsMTEuNDg5NzE2NSAyOS4wNzE1MDU2LDE4LjYwNjY3ODggMjIuOTk5OTUyMywyMC41MDM4NzA1IEwyMi45OTk5NTIzLDI1LjQ5NjEyOTUgQzI5LjA3MTUwNTYsMjcuMzkzMzIxMiAzNiwzNC41MTAyODM1IDM2LDQzIEw0LDQzIEw0LDQzIEM0LDM0LjUwOTgxNzEgMTAuOTI5MjU1NywyNy4zOTI1MzkzIDE3LjAwMTA0ODMsMjUuNDk1ODE2OSBMMTcuMDAxMDQ4MywyMC41MDQxODMxIEMxMC45MjkyNTU3LDE4LjYwNzQ2MDcgNCwxMS40OTAxODI5IDQsMyBMNCwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIHN0cm9rZT0iI0JCQkZDNCIgc3Ryb2tlLXdpZHRoPSIzIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjAsMzMgQzIyLDMzIDI5LjUsMzggMjkuNSw0MCBMMTAuNSw0MCBMMTAuNSw0MCBDMTAuNSwzOCAxOCwzMyAyMCwzMyBaIE0yOS41LDExIEMyOS41LDEzIDIyLjUsMTggMjAsMTggQzE3LjUsMTggMTAuNSwxMyAxMC41LDExIEwxMC41LDExIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNERUUwRTMiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNCQkJGQzQiIHg9IjAiIHk9IjAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0IiByeD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0JCQkZDNCIgeD0iMCIgeT0iNDIiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0IiByeD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjcuMDAwMDAwLCAyMS4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxjaXJjbGUgaWQ9IuakreWchuW9oiIgc3Ryb2tlPSIjQkJCRkM0IiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9IiNGRkZGRkYiIGN4PSIxMy41IiBjeT0iMTMuNSIgcj0iMTIiPjwvY2lyY2xlPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0JCQkZDNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMuNzAwMDAwLCAxMy41MDAwMDApIHJvdGF0ZSg0NS4wMDAwMDApIHRyYW5zbGF0ZSgtMTMuNzAwMDAwLCAtMTMuNTAwMDAwKSAiIHg9IjEyLjIiIHk9IjYuNSIgd2lkdGg9IjMiIGhlaWdodD0iMTQiIHJ4PSIxIj48L3JlY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjQkJCRkM0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMy43MDAwMDAsIDEzLjUwMDAwMCkgcm90YXRlKC00NS4wMDAwMDApIHRyYW5zbGF0ZSgtMTMuNzAwMDAwLCAtMTMuNTAwMDAwKSAiIHg9IjEyLjIiIHk9IjYuNSIgd2lkdGg9IjMiIGhlaWdodD0iMTQiIHJ4PSIxIj48L3JlY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPgo="},duSr:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var i=n("rLED");function r(){return Object(i.K)("mention_optimization")}function o(){return Object(i.K)("mention_height_adaptive")}},dvZ7:function(e,t,n){"use strict";var y=n("7EGn"),o=n("BmhO"),a=n("TtEC"),i=n("WzBf");function r(e){return{token:"DRIVE_PREVIEW_EVENT_".concat(e),resourceType:"DRIVE_PREVIEW_EVENT",routeType:"local",routeKey:""}}function s(e,t){var n=r(e);i.a.register(n,t),i.a.onError(n,function(e){console.error("[MessageBoxError]:",e)})}function c(e,t){var n=r(e);i.a.deregister(n,t)}var l={register:s,deregister:c},E=n("Xngx"),u=n("rLED"),d=n("vE74"),h=n("QM+C"),f=n("iP/4"),O=n("skFV"),p=n("f8Ac"),C=n("5dbN"),g=n("omim"),m=n("EVj1"),v=n("VI6H"),b=n("EQyw"),k=n("erPj"),I=n("wCm6"),S=n("zaV1"),T=n("2ACu"),_=n("lgTS"),w=n("ucr6"),j=n("1dfU");function M(e){var t=e.file,n=e.files;if(!t||t instanceof _.e)return null;var i=t.get("type"),r=(t.get("subtype")||"").toLowerCase();return i===h.NUM_SUITE_TYPE.FILE&&o.u.includes(r)?n.filter(function(e){var t=e.get("type"),n=(e.get("subtype")||"").toLowerCase();return e instanceof _.f&&t===h.NUM_SUITE_TYPE.FILE&&o.u.includes(n)}).map(function(e){return e.get("obj_token")}):null}function L(e){var t=h.mapTypeToSuite[Object(E.d)(e).toLowerCase()]||"";return h.NUM_SUITE_TYPE[t.toUpperCase()]}function R(e){var t=e.action,n=void 0===t?"":t,i=e.fileToken,r=void 0===i?"":i,o=e.fileName,a=void 0===o?"":o,s=e.status,c=void 0===s?"success":s,l=e.subConfirmType,u=void 0===l?"":l,d=e.source,h=void 0===d?"":d,f=e.isCrossTenant,p=e.dummyToken,g=Object(E.d)(a),m=Object(C.getCurrentRouteObj)(),v=m&&m.module?m.module:"",b=m&&m.subModule?m.subModule:"";Object(T.default)("client_content_management",{action:n,source:h,sub_file_type:g,file_id:r?Object(j.a)(r):"",dummy_token:p&&Object(j.a)(p),module:v,sub_module:b,status_name:c,sub_confirm_type:u,file_is_cross_tenant:f,api_host:O.d,location_country:Object(y.default)(window,"User.locationCountry")})}function N(e){var t=e.action,n=void 0===t?"":t,i=e.status,r=void 0===i?"success":i,o=e.subConfirmType,a=void 0===o?"":o,s=e.source,c=void 0===s?"":s,l=e.isCrossTenant,u=Object(C.getCurrentRouteObj)(),d=u&&u.module?u.module:"",h=u&&u.subModule?u.subModule:"";Object(T.default)("client_content_management",{action:n,source:c,file_type:"folder",sub_file_type:"",file_id:"",module:d,sub_module:h,status_name:r,sub_confirm_type:a,file_is_cross_tenant:l||void 0,api_host:O.d,location_country:Object(y.default)(window,"User.locationCountry")})}function D(e){var t,n=e.action,i=void 0===n?"":n,r=e.source,o=void 0===r?"direct":r,a=e.eventType,s=void 0===a?"mouseclick":a,c=e.commentId,l=void 0===c?"":c,u=e.replyId,d=void 0===u?"":u,h=e.statusCode,f=void 0===h?0:h,p=e.statusName,g=void 0===p?"success":p,m=e.commentType,v=void 0===m?"full_comment":m,b=Object(S.a)();b&&b.type&&(t=b.type,Object(T.default)("client_comment",{action:i,eventType:s,source:o,comment_type:v,comment_id:l,reply_id:d,comment_target_type:"whole_file",zone:"full_comment",mode:"drive_view",status_code:f,status_name:g,sub_file_type:t||""}))}function x(e){var t=e.action,n=void 0===t?"":t,i=e.source,r=void 0===i?"":i,o=e.eventType,a=void 0===o?"mouseclick":o,s=e.subFileType,c=Object(S.a)(),l=s||c&&c.type||"";Object(T.default)("toggle_attribute",{product_type:"drive",eventType:a,sub_file_type:l,mode:"drive_view",action:n,source:r})}function P(e){var t=e.source,n=e.action,i=e.subFileType,r=e.fileToken,o=Object(C.getCurrentRouteObj)(),a=o&&o.module?o.module:"";Object(T.default)("office_online_edit",{source:t,action:n,module:a,file_type:"file",sub_file_type:i,file_id:r?Object(j.a)(r):""})}function B(e){var t=e.costTime,n=e.fileToken,i=e.stage;Object(T.default)("dev_box_load_performance",{stage:i,file_id:n?Object(j.a)(n):"",cost_time:t})}function U(){window.dispatchEvent(Object(d.b)("resize"))}n.d(t,"i",function(){return M}),n.d(t,"k",function(){return L}),n.d(t,"b",function(){return R}),n.d(t,"d",function(){return N}),n.d(t,"a",function(){return D}),n.d(t,"f",function(){return x}),n.d(t,"e",function(){return P}),n.d(t,"c",function(){return B}),n.d(t,"p",function(){return U}),n.d(t,"h",function(){return F}),n.d(t,"j",function(){return K}),n.d(t,"g",function(){return q}),n.d(t,"m",function(){return Y}),n.d(t,"l",function(){return J}),n.d(t,"o",function(){return Q}),n.d(t,"n",function(){return X});var z={isOnlineEnv:!(Object(O.D)()||Object(O.z)()),apiHosts:Object(O.r)(),driveApiHosts:Object(O.i)(),fileUrlPrefix:Object(O.k)().fileURLPrefix||"",isLocalhost:Object(O.z)(),fileWebOfficeDomain:Object(O.k)().fileWebOfficeDomain||"",updatePreviewTplSeed:Object(O.k)().updatePreviewTplSeed},H=Object(O.g)().tea;function F(e){var t=Object(v.c)(),i=[],n=f.a.isInVC;n&&i.push(o.n.SHEET),(n||h.isAnonymousAccess||f.a.isFeed||!e)&&i.push(o.n.WPS);var r=function(e){var t=i.slice(),n=Y(e);return n.edit||n.preview||t.push(o.n.WPS),t};return{customRequest:I.a,PreviewMessageHandler:l,envConfig:z,seclinkEnabled:a.j,languageType:Object(p.a)(),userId:t.get("id")||window.User.id,tenantId:t.get("tenant_id")||window.User.tenantId,showDownloadProgress:g.g,enablePDFProgressCache:!0,enableSheetProgressCache:!0,enableMediaProgressCache:!0,getDisabledPreviewComponents:r,maxPollCount:Object(a.f)(),pdfRangeChunkSize:Object(a.g)(),showPDFDigitalSign:!0,unsupportedVideoCodec:Object(a.h)(),authority:{downloadable:Object(k.c)(),printable:Object(k.e)(),exportable:Object(k.d)(),copyable:Object(k.b)()},floatingToolbarHiddenOnStart:f.a.isInVC}}H&&!0===H.open&&(z.teaConfig={sdkAppId:Object(y.default)(H,"config.appId.drive_sdk"),suiteAppId:Object(y.default)(H,"config.appId.doc"),singleProductAppID:Object(y.default)(H,"config.appId.single_product"),channelDomain:Object(y.default)(H,"config.channel_domain")}),z.slardarConfig={slardarCommonConfig:Object(O.g)().slardar,slardarMinaConfig:Object(u.L)("slardar_config"),sentryConfig:Object(O.g)().sentry,sentryMinaConfig:Object(u.L)("sentry_filter_config"),scm:Object(y.default)(window,"scm"),rvRev:Object(y.default)(window,"rv_rev")};var V=["pdf","csv"];function W(e){return!V.includes(e)&&o.l.includes(e)}function K(e){return Boolean(e&&e.weboffice)}function Z(e){var t=Object(E.d)(e);return Object(a.a)()&&o.H.includes(t)}function q(e){return Object(a.d)()&&W(Object(E.d)(e))||Z(e)}function Y(e){if(!e)return{preview:!1,edit:!1};var t=K(e);return Z(e.name)?{preview:t,edit:t}:{preview:Boolean(t&&Object(a.e)()),edit:Boolean(t&&Object(a.d)()&&!V.includes(Object(E.d)(e.name)))}}function J(e,t){var n=Y(e);return t?n.edit:n.preview}function Q(e){var t=Object(m.l)(w.a.location.search)||{};e?t.office_edit="1":delete t.office_edit,w.a.replace({search:Object(m.d)(t)})}function X(e){return e&&!Object(b.a)()}},dzTx:function(e,t,n){"use strict";n.d(t,"a",function(){return y});var i=n("lwsE"),a=n.n(i),r=n("W8MJ"),s=n.n(r),o=n("cDf5"),c=n.n(o),l=n("7EGn"),u=n("hbEN"),d=n("Hj9z"),h=n("4PSP"),f=n("jp/M"),p=n("7Kxq"),g=n("H6oK"),m=n("AiBH"),v=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},b=".block-type-MINDNOTE_BLOCK",y=function(){function o(e){var t=this,n=e.editor,i=e.mindnoteBridgePlugin,r=e.eventEmitter;a()(this,o),this.className="Mindnote",this.debounceSelectionChange=Object(u.default)(function(){t.iteratorBitableBlocks(function(e){e.selectionChange()})},500),this.editor=n,this.eventEmitter=r,this.mindnoteBridgePlugin=i,this.bindEvents()}return s()(o,[{key:"reset",value:function(){this.unbindEvents(),this.mindnoteBridgePlugin.destroy()}},{key:"aceKeyEvent",value:function(e,t){try{var n=t.rep,i=t.evt,r=i.keyCode===m.t.DELETE||i.keyCode===m.t.BACKSPACE;if(!n.selStart||!n.selEnd||!r)return;if(!(n.selStart[0]===n.selEnd[0]))return;var o=Object(l.default)(n.lines.atIndex(n.selStart[0]),"lineNode",void 0),a=o&&o.querySelector(b);if(!a)return;var s=a.dataset.metaBlockProps,c=JSON.parse(s).blockId;if(this.editor.plugins.blockPlugin.getBlockById(c).minder.getService("Selection").selections.size)return t.preventOtherHooksHandle=!0}catch(e){}return!1}},{key:"bindEvents",value:function(){this.editor.eventEmitter.on("aceSelectionChanged",this.debounceSelectionChange),this.eventEmitter.on(f.events.PC.MINDNOTE.INSERT_MINDNOTE,this.insertMindnote)}},{key:"unbindEvents",value:function(){this.editor.eventEmitter.off("aceSelectionChanged",this.debounceSelectionChange),this.eventEmitter.off(f.events.PC.MINDNOTE.INSERT_MINDNOTE,this.insertMindnote)}},{key:"iteratorBitableBlocks",value:function(i){var r=this;this.editor.plugins.blockPlugin.blockInfos.forEach(function(e,t){var n=e.instance;n.blockType===g.BlockType.MINDNOTE_BLOCK&&i.apply(r,[n,t])})}},{key:"insertMindnote",value:function(e){var t=this.editor;if(t&&e){var n=$(".".concat(p.a).concat(e));if(0===n.length)return;var i=t.domToRep(n.get(0));if(!i)return;var r=i.selStart,o=i.selEnd;t.inCallStack("deleteBitbleAtHolder",function(){t.fastIncorp(),t.callStack.makeNewEvent("nonundoable",function(){t.performDocumentReplaceRange("0",r,o,"")})})}Object(d.insertMindnoteBlock)(t)}}]),o}();v([Object(h.Bind)()],y.prototype,"iteratorBitableBlocks",null),v([Object(h.Bind)()],y.prototype,"insertMindnote",null)},"e+wO":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29uX2dsb2JhbF9saW5rX25vcjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJXZWItMTYqMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTg1NC4wMDAwMDAsIC03MzYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPGcgaWQ9Imljb25fZ2xvYmFsX2xpbmtfbm9yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NTQuMDAwMDAwLCA3MzYuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMzk0NTI1LDkuNjAxMDQ3NDEgQzEyLjcxNTM2ODMsOS43MzU0NTM2NSAxMy4wMjI3NDc2LDkuOTE3MTEzNjkgMTMuMzA2NzIyOCwxMC4xNDcwNzIzIEMxNC45MTYyNDQ4LDExLjQ1MDQzNzUgMTUuMTY0NDMzOSwxMy44MTE3OTkxIDEzLjg2MTA2ODcsMTUuNDIxMzIxMSBMMTEuNzM3MTEyNCwxOC4wNDQxODg3IEMxMC40MzM3NDcyLDE5LjY1MzcxMDcgOC4wNzIzODU1NSwxOS45MDE4OTk4IDYuNDYyODYzNTcsMTguNTk4NTM0NiBDNC44NTMzNDE1OCwxNy4yOTUxNjk0IDQuNjA1MTUyNDcsMTQuOTMzODA3OCA1LjkwODUxNzY4LDEzLjMyNDI4NTggTDcuOTM5OTM2NDEsMTAuODE1NjkyNSBMOC4wMDQ2Nzg2MiwxMS40MzE2NzM1IEM4LjA1MDIxMjcsMTEuODY0OTAxMyA4LjE5ODY4MzUzLDEyLjI2MjM5MDUgOC40MjMyMzQzLDEyLjYwMjM5MjkgTDcuMDc0MjM2NjIsMTQuMjY4MjY2NCBDNi4yOTIyMTc1LDE1LjIzMzk3OTUgNi40NDExMzA5NiwxNi42NTA3OTY1IDcuNDA2ODQ0MTUsMTcuNDMyODE1NiBDOC4zNzI1NTczNCwxOC4yMTQ4MzQ4IDkuNzg5Mzc0MzIsMTguMDY1OTIxMyAxMC41NzEzOTM0LDE3LjEwMDIwODEgTDEyLjY5NTM0OTgsMTQuNDc3MzQwNSBDMTMuNDc3MzY4OSwxMy41MTE2MjczIDEzLjMyODQ1NTQsMTIuMDk0ODEwMyAxMi4zNjI3NDIyLDExLjMxMjc5MTIgQzEyLjA2NzIzMjIsMTEuMDczNDkxOSAxMS43Mjk0ODIxLDEwLjkyMTM2MjQgMTEuMzgwNjA2NCwxMC44NTMxMzI2IEwxMi4zOTQ1MjUsOS42MDEwNDc0MSBMMTIuMzk0NTI1LDkuNjAxMDQ3NDEgWiBNMTEuMjYzNzMxMSwxNC4zMjk2Mjg3IEMxMC45NDI4ODc3LDE0LjE5NTIyMjQgMTAuNjM1NTA4NCwxNC4wMTM1NjI0IDEwLjM1MTUzMzMsMTMuNzgzNjAzOCBDOC43NDIwMTEyNywxMi40ODAyMzg2IDguNDkzODIyMTYsMTAuMTE4ODc3IDkuNzk3MTg3MzcsOC41MDkzNTUgTDExLjkyMTE0MzcsNS44ODY0ODczOCBDMTMuMjI0NTA4OSw0LjI3Njk2NTM5IDE1LjU4NTg3MDUsNC4wMjg3NzYyOCAxNy4xOTUzOTI1LDUuMzMyMTQxNDkgQzE4LjgwNDkxNDUsNi42MzU1MDY2OSAxOS4wNTMxMDM2LDguOTk2ODY4MzMgMTcuNzQ5NzM4NCwxMC42MDYzOTAzIEwxNS43MTgzMTk3LDEzLjExNDk4MzUgTDE1LjY1MzU3NzUsMTIuNDk5MDAyNSBDMTUuNjA4MDQzNCwxMi4wNjU3NzQ3IDE1LjQ1OTU3MjYsMTEuNjY4Mjg1NSAxNS4yMzUwMjE4LDExLjMyODI4MzEgTDE2LjU4NDAxOTUsOS42NjI0MDk3MiBDMTcuMzY2MDM4Niw4LjY5NjY5NjUzIDE3LjIxNzEyNTEsNy4yNzk4Nzk1NSAxNi4yNTE0MTE5LDYuNDk3ODYwNDMgQzE1LjI4NTY5ODcsNS43MTU4NDEzMSAxMy44Njg4ODE4LDUuODY0NzU0NzcgMTMuMDg2ODYyNiw2LjgzMDQ2Nzk3IEwxMC45NjI5MDYzLDkuNDUzMzM1NTggQzEwLjE4MDg4NzIsMTAuNDE5MDQ4OCAxMC4zMjk4MDA3LDExLjgzNTg2NTggMTEuMjk1NTEzOCwxMi42MTc4ODQ5IEMxMS41OTEwMjM5LDEyLjg1NzE4NDIgMTEuOTI4Nzc0LDEzLjAwOTMxMzYgMTIuMjc3NjQ5NywxMy4wNzc1NDM1IEwxMS4yNjM3MzExLDE0LjMyOTYyODcgTDExLjI2MzczMTEsMTQuMzI5NjI4NyBaIiBmaWxsPSIjMkIyRjM2Ij48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPgo="},e3py:function(e,k,I){"use strict";(function(o){I.d(k,"a",function(){return C});var e=I("lwsE"),n=I.n(e),t=I("W8MJ"),i=I.n(t),r=I("a1gu"),a=I.n(r),s=I("Nsbk"),c=I.n(s),l=I("7W2i"),u=I.n(l),d=I("Bw5p"),h=I("XIp8"),f=I("GdWO"),p=I("cqCN"),g=I("n/R6"),m=I("2ACu"),v=I("+om4"),b=I("rLED"),y=I("lQZd"),E=I("QM+C"),O={zone_changesets:{},apool:{nextNum:0,numToAttrib:{},attribToNum:{}}};function C(e){return function(e){function t(){return n()(this,t),a()(this,c()(t).apply(this,arguments))}return u()(t,e),i()(t,[{key:"initSyncBuffer",value:function(){var r=this,n=Object(b.L)("sync_buffer_config"),e=function(e){e.forEach(function(e){r.processNewChangeItem(e)})},t=function(e){var t=Object(h.default)(e[e.length-1]),n=r.engineSyncBuffer.composedResult,i=Object.assign({},Object(d.a)(t,["type","note_revision"]),{},n,{changeset:n.zone_changesets[0]});r.processNewChangeItem(i,e)},i=0;this.engineSyncBuffer=Object(p.createSyncBuffer)({logger:m.default,isActiveModeEnabled:Object(b.I)("sync_buffer_active_enable"),checkIfEnable:b.lb,onEnterInactive:function(){r.sync.io.switchHeartbeatInactive(),r.sync.io.setEntityExternalInfo([{entity:{type:E.SUITE_ENGINE_TYPE.DOC,token:Object(y.g)()},inactive:1}])},onEnterActive:function(){r.sync.io.switchHeartbeatActive(),r.sync.io.setEntityExternalInfo([{entity:{type:E.SUITE_ENGINE_TYPE.DOC,token:Object(y.g)()},inactive:0}]),n&&n.isEnableToast&&g.a.show({key:"reactivate_tab_apply_data",type:"loading",content:o("common.reactivate_tab_apply_data"),keepAlive:!0}),i=r.engineSyncBuffer.composedResult&&r.engineSyncBuffer.composedResult.zone_changesets&&r.engineSyncBuffer.composedResult.zone_changesets[0]&&r.engineSyncBuffer.composedResult.zone_changesets[0].length},onSwitchToActiveMode:function(e){n&&n.isEnableToast&&g.a.remove("reactivate_tab_apply_data");var t=Object.assign({},e,{changesetSize:i||0});Object(m.collectSuiteEvent)("syncBuffer_reactiveInfo",t),i=0},composeBuffer:function(e,t){return e.reduce(function(e,t){try{var n={apool:{nextNum:t.apool.nextNum,numToAttrib:Object.assign({},t.apool.numToAttrib)},zone_changesets:t.zone_changesets};return Object(v.composeOps)(e,n)}catch(e){return void r.editor.fatal(e,"collab","compose buffer error",f.a)}},t||O)},handleMessage:e,handleMessageOnReActive:t,handleMessageOnActive:t,getVersionFromMessage:function(e){return{from:e.note_revision,to:e.note_revision}},getClientVersion:function(){return r.getRev()}},{isFullPipe:!1})}},{key:"destroySyncBuffer",value:function(){this.engineSyncBuffer.destroy()}}]),t}(e)}}).call(this,I("2vAP"))},eAOf:function(e,t,n){"use strict";var i=n("o0o1"),r=n.n(i),o=n("yXPU"),a=n.n(o),s=n("lwsE"),c=n.n(s),l=n("W8MJ"),u=n.n(l),d=n("+4eN"),h=function(){function n(e){c()(this,n),this.editor=e,this.waitZoneMountPromiseMap=new Map,this.mountedZoneSet=new Set}function e(e){return t.apply(this,arguments)}var t;return u()(n,[{key:"mountZone",value:function(e){var t=this.waitZoneMountPromiseMap.get(e);t&&t.forEach(function(e){return e()}),this.waitZoneMountPromiseMap.delete(e),this.mountedZoneSet.add(e)}},{key:"waitZoneMount",value:(t=a()(r.a.mark(function e(t){var n,i=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.selZone,!Object(d.g)(n)||this.mountedZoneSet.has(n))return e.abrupt("return",Promise.resolve());e.next=3;break;case 3:return e.next=5,this.editor.scrollToSelection(t,{scrollFn:function(){return Promise.resolve()}});case 5:return e.abrupt("return",new Promise(function(e){var t=i.waitZoneMountPromiseMap.get(n)||[];i.waitZoneMountPromiseMap.set(n,t.concat(e))}));case 6:case"end":return e.stop()}},e,this)})),e)},{key:"destroy",value:function(){this.mountedZoneSet.clear(),this.waitZoneMountPromiseMap.clear()}}],[{key:"getInstance",value:function(e){var t=n.instance||new n(e);return n.instance=t}}]),n}();h.instance=null,t.a=h},eKYS:function(e,t,n){},eOIy:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return k});var u,i,r=n("lSNA"),d=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("a1gu"),h=n.n(l),f=n("Nsbk"),p=n.n(f),g=n("7W2i"),m=n.n(g),v=n("q1tI"),b=n("t/UT"),y=n("TSYQ"),E=n.n(y);n("KVeW");(i=u=u||{})[i.Normal=0]="Normal";var O={handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],wheelSpeed:1,wheelPropagation:!(i[i.Small=1]="Small"),swipeEasing:!0,scrollingThreshold:1e3,useBothWheelAxes:!1,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,minScrollbarLength:20},C={"ps-scroll-y":"onScrollY","ps-scroll-x":"onScrollX","ps-scroll-up":"onScrollUp","ps-scroll-down":"onScrollDown","ps-scroll-left":"onScrollLeft","ps-scroll-right":"onScrollRight","ps-y-reach-start":"onYReachStart","ps-y-reach-end":"onYReachEnd","ps-x-reach-start":"onXReachStart","ps-x-reach-end":"onXReachEnd"};Object.freeze(C);var k=function(e){function t(){var r;return a()(this,t),(r=h()(this,p()(t).apply(this,arguments))).ps=null,r.bindDragStart=function(){var e;!r.container||(e=r.container.querySelector(".ps__thumb-y"))&&(e.addEventListener("mousedown",r.handleYDragStart),e.addEventListener("touchstart",r.handleYDragStart))},r.unbindDragStart=function(){var e;!r.container||(e=r.container.querySelector(".ps__thumb-y"))&&(e.removeEventListener("mousedown",r.handleYDragStart),e.removeEventListener("touchstart",r.handleYDragStart))},r.bindDragEnd=function(){document.addEventListener("mouseup",r.handleYDragEnd),document.addEventListener("touchend",r.handleYDragEnd)},r.unbindDragEnd=function(){document.removeEventListener("mouseup",r.handleYDragEnd),document.removeEventListener("touchend",r.handleYDragEnd)},r.handleRef=function(e){r.container=e,r.props.containerRef&&r.props.containerRef(e)},r.handleYDragStart=function(e){var t=r.props.onYDragStart;t&&t(e),r.bindDragEnd(),e.stopPropagation()},r.handleYDragEnd=function(e){var t=r.props.onYDragEnd;t&&t(e),r.unbindDragEnd()},r.updateEventHook=function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Object.keys(C).forEach(function(e){var t=r.props[C[e]],n=i[C[e]];n!==t&&r.container&&(n&&r.container.removeEventListener(e,n,!1),t&&r.container.addEventListener(e,t,!1))})},r.handleScroll=function(e){var t=r.props,n=t.onScrollX,i=t.onScrollY;n&&n(e),i&&i(e)},r}return m()(t,e),c()(t,[{key:"componentDidMount",value:function(){this.ps=new b.a(this.container,Object.assign({},O,{},this.props.options)),this.bindDragStart()}},{key:"componentDidUpdate",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.updateEventHook(e),this.ps&&"function"==typeof this.ps.update&&this.ps.update()}},{key:"componentWillUnmount",value:function(){var n=this;this.unbindDragStart(),Object.keys(C).forEach(function(e){var t=n.props[C[e]];t&&"function"==typeof t&&n.container&&n.container.removeEventListener(e,t,!1)}),this.ps&&"function"==typeof this.ps.destroy&&this.ps.destroy(),this.ps=null}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.className,r=e.style,o=e.tabIndex,a=e.size,s=e.onContextMenu,c=e.onDoubleClick,l=e.onWheel;return v.createElement("div",{id:t,className:E()("scrollbar-container ".concat(i),d()({},"scrollbar-container-small",a===u.Small)),style:r,onWheel:l,tabIndex:o,ref:this.handleRef,onScroll:this.handleScroll,onContextMenu:s,onDoubleClick:c},n)}}]),t}(v.Component)},eYgS:function(e,t,n){},efCe:function(e,g,m){"use strict";(function(r){m.d(g,"a",function(){return p});var e=m("o0o1"),o=m.n(e),t=m("yXPU"),a=m.n(t),n=m("lwsE"),s=m.n(n),i=m("W8MJ"),c=m.n(i),l=m("HIeq"),u=m("9oD+"),d=m("J21X"),h=m("oJoF"),f=m("QtEt"),p=function(){function i(e,t){var n=this;s()(this,i),this.aceInitialized=function(e){e.on(h.b,a()(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)();case 2:t=e.sent,n.uploader=n.createBoxUploader(t);case 4:case"end":return e.stop()}},e)})))},e&&this.aceInitialized(e),this.handlers=t.handlers,this.preventBeforeUnload=t.preventBeforeUnload,this.preventBeforeUnload&&(this.BeforeUnloadReminder=new d.a({unsavedTip:r("CreationDoc_Docs_Upload_Image_Decs")}))}return c()(i,[{key:"createBoxUploader",value:function(e){return e({parentToken:Object(l.e)(),mountPoint:u.a},{onTasksAdded:this.onTasksAdded.bind(this),onTaskAdded:this.onTaskAdded.bind(this),onTaskSuccess:this.onTaskSuccess.bind(this),onTaskError:this.onTaskError.bind(this),onFileProgress:this.onFileProgress.bind(this),onCancel:this.onCancel.bind(this),onCancelAll:this.onCancelAll.bind(this)})}},{key:"upload",value:function(e,t){e&&this.uploader.addFile(e,t)}},{key:"onTaskAdded",value:function(e){this.handlers.onTaskAdded(e),this.BeforeUnloadReminder.addReminder()}},{key:"onTasksAdded",value:function(e){this.uploader.upload()}},{key:"onTaskSuccess",value:function(e,t){this.handlers.onSuccess(e),this.onComplete()}},{key:"onTaskError",value:function(e,t){this.handlers.onFailure(e,t),this.onComplete()}},{key:"onFileProgress",value:function(e){this.handlers.onProgress(e)}},{key:"onCancel",value:function(e){this.onComplete()}},{key:"onCancelAll",value:function(){console.log("[image plugin] onCancelAll")}},{key:"onComplete",value:function(){this.BeforeUnloadReminder&&this.BeforeUnloadReminder.removeReminder()}},{key:"cancel",value:function(e){var t=e.uuid;t&&this.uploader.cancel(t)}},{key:"destroy",value:function(){this.uploader.cancelAll(),this.BeforeUnloadReminder&&this.BeforeUnloadReminder.destroy()}}]),i}()}).call(this,m("2vAP"))},elsr:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var i="0",r="clientside",o={LOCAL:r,PREFIX_LOCAL:"".concat(r,"-"),DEFAULT_REP_ZONE:i}},erPj:function(e,t,n){"use strict";n.d(t,"f",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"e",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return l});var i=n("kS6I");function r(){return Object(i.d)(i.b.FILE_UPLOAD)!==i.a.DENY}function o(){return Object(i.d)(i.b.FILE_DOWNLOAD)!==i.a.DENY}function a(){return Object(i.d)(i.b.FILE_COPY)!==i.a.DENY}function s(){return Object(i.d)(i.b.FILE_PRINT)!==i.a.DENY}function c(){return Object(i.d)(i.b.FILE_EXPORT)!==i.a.DENY}function l(){return Object(i.d)(i.b.FILE_COPY)!==i.a.DENY}},euE0:function(e,t,n){"use strict";var i,r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),c=n("NZ+B"),l=n("hbEN"),d=n("CpTu"),h=n("HmyT"),f=n("AkIV"),p=n("PQAI"),g=(n("+ECM"),n("FJEn")),m=n("8wYP"),u=n("U5G9"),v=n("D7h9"),b=n("RBWZ"),y=n("OJOY"),E=n("OX8E"),O=n("sLU5"),C=n("lQZd"),k=n("KiYW"),I=n("QM+C"),S=n("qOLP"),T=n("y2sV"),_=n("rLED"),w=n("/spq");function j(e,t){var n=e.deltaSet,i=t.selection.getSelection().start,r=i.line,o=i.offset,a=i.zoneId,s=t.getContentState(),c=s.getActiveZone().getLine(0),l=c&&c.hasLineMarker()?1:0;if(a!==g.DEFAULT_REP_ZONE||0!==r||o!==l)return n;var u=s.schema,d=n.get(a).ops,h=d[0];if(h&&h.attributes)for(var f=["blockquote","list","heading"],p=0;p<f.length;p++)delete h.attributes[f[p]];return(Object(T.K)(d[0]&&d[0].attributes,u)||Object(T.K)(d[1]&&d[1].attributes,u))&&d.unshift({insert:T.f,attributes:{lineguid:Object(g.genGuid)()}}),n}n.d(t,"a",function(){return N});var M=g.RepManager.DEFAULT_REP_ZONE,L=[37,38,39,40],R=Object(u.b)({module:u.a.NOTE_TITLE}),N=Object(w.a)(["aceInitialized","aceEditEvent"])(i=function(){function e(r){var u=this;o()(this,e),this.className="NoteTitlePlugin",this.titleShouldUpdate=!1,this.iconInfo=null,this.customIconEnable=Object(_.n)(),this.isReadOnly=!0,this.isBindHoverEvent=!1,this.isMounted=!1,this.getTitle=function(){var n=u.editorContext,e=n.getReps()[0],t=e.lines.atIndex(0);return t?Object(m.b)({changesetHelper:R,rep:e,selStart:[0,0],selEnd:[0,t.text.length]}).reduce(function(e,t){return e+Object(m.e)(n,t)},""):""},this.getTitleIconInfo=function(){var e=u.editorContext.getAllAttributesOnLine(M,0).reduce(function(e,t){return e[t[0]]=t[1],e},{});return e.icon?JSON.parse(e.icon):null},this.handleSetTitleIcon=function(n){var i;u.customIconEnable&&(i="changeTitleIcon",u.editor.callWithAce(function(e){var t=e.getCurrentCallStack();t&&t.type===i&&(t.preventScrolling=!0),n&&n.key?u.editor.setAttributeOnLine(M,0,"icon",JSON.stringify(n)):u.editor.removeAttributeOnLine(M,0,"icon")},i))},this.handleNavigationSetTitleIcon=function(e,t,n){var i=t.icon_key,r=t.icon_type,o=t.icon_fsunit;u.handleSetTitleIcon({type:r,key:i,fs_unit:o})},this.collectContentPre=function(e,t){var n=t.cls,i=void 0===n?"":n,r=t.state,o=/(?:^| )diy-icon-(\S+)/.exec(i);o&&(r.lineAttributes.icon=unescape(o[1]))},this.handleImgTitle=function(){var e,t,n,i,r,o,a=u.editorContext,s=a.getRep();s.selEnd&&s.selStart&&s.lines&&"0"===s.zoneId&&((e=s.lines.atIndex(0))&&(t={selStart:[0,0],selEnd:[0,e.text.length]},n=s.zoneId,i=a.getMatchedAttributeOnSelection(n,t,"image-previewer"),(0<(r=a.getMatchedAttributeOnSelection(n,t,"image-uploaded")).length||0<i.length)&&(r[0]&&(o=r[0].selStart),i[0]&&(o=i[0].selStart),o&&a.makeNondoableEvent("startNewLine",function(){a.performDocumentReplaceRange(n,s.startPoint,o,"\n"),s.selStart=s.selEnd=o,a.updateBrowserSelectionFromRep(!0)}))))},this.onMount=function(){u.isMounted=!0,u.noteTitle.checkTitleAndBodyStatus()},this.postAceInit=function(){var e=u.editorContext,t=e.getInnerContainer();u.noteTitle=new p.a(t,e);var n=y.a.getItem("__template__");n&&Object(c.a)(n.visible)?v.default.dispatch(Object(b.q)(n.visible)):v.default.dispatch(Object(b.q)(!0))},this.aceCopy=function(e,t){var n,i,r=t.html,o=u.editorContext.getRep(),a=o.selStart;o.zoneId===M&&a&&0===a[0]&&((n=Object(h.$)("<div>")).html(r),(i=n[0].firstChild)&&i.classList&&i.classList.forEach(function(e){-1<e.indexOf("diy-icon-")&&i.classList.remove(e)}),t.html=n.html())},this.aceCut=function(e,t){return u.aceCopy(e,t)},this.UNSAFE_editorNormalizePasteNode=function(e){var t,n,i,r,o=e.data.node,a=u.editorContext;"0"===a.getRep().zoneId&&(1===(t=a.caretLine())&&u.noteTitle.setTextStatus(t,!0),u.isReadOnly||0!==t||(n=["meta","style"],!(i=Array.from(o.children).find(function(e){return!n.includes(Object(f.a)(e))}))||(-1<(r=["table","ol","ul","li","img","hr","checkbox","code"]).indexOf(Object(f.a)(i))||0<Object(h.$)(i).find(r.join(",")).length)&&Object(h.$)("<br/>").insertBefore(i)))},this.editorAlinesDidSplice=function(e,t){var n,i,r=t.start,o=t.prevState,a=t.currentState,s=t.zoneId;r<=1&&s===M&&(u.titleShouldUpdate=!0,n=(a.alinesAttribs[0]||[]).reduce(function(e,t){return e[t[0]]=t[1],e},{}),i=(o.alinesAttribs[0]||[]).reduce(function(e,t){return e[t[0]]=t[1],e},{}),n.icon!==i.icon&&(u.iconInfo=n.icon?JSON.parse(n.icon):null))},this.aceDomLineProcessLineAttributes=function(e,t){var n=t.attrObj;n.icon&&(t.lineClass+=" diy-icon-".concat(escape(n.icon)),t.processedMarker=!0)},this.aceSelectionChanged=function(e,t){var n,i,r,o=t.rep,a=o.selStart,s=o.selEnd,c=o.zoneId,l=a[0];!u.isMounted||0!==l&&1!==l||u.titleShouldUpdate||u.noteTitle.checkTextStatus(1),!u.customIconEnable||u.isReadOnly||u.iconInfo||(n=c===M,i=0===l,r=a[0]===s[0]&&a[1]===s[1],n&&i&&r?(u.emitUpdateAddIconVisible(!0),u.unbindHoverEvent()):(u.emitUpdateAddIconVisible(!1),u.bindHoverEvent()))},this.onLineDomMouseEnter=function(e){e.target.parentNode&&"innerdocbody"===e.target.parentNode.id&&(e.target.previousSibling?u.emitUpdateAddIconVisible(!1):(u.onLineDomMouseLeave.cancel(),u.emitUpdateAddIconVisible(!0)))},this.onLineDomMouseLeave=Object(l.default)(function(e){e.target.parentNode&&"innerdocbody"===e.target.parentNode.id&&(e.target.previousSibling||u.emitUpdateAddIconVisible(!1))},200),this.editorKeyDown=function(e,t){var n,i,r,o,a,s,c;t.isTypeForCmdKey&&t.evt.metaKey&&!Object(f.b)(t.evt)||t.specialHandled||(n=t.rep,i=t.inInternationalComposition,n.selStart&&n.zoneId===M&&(0!==(r=n.selStart[0])&&1!==r||(16===(o=t.evt.keyCode)||(a=Object(d.a)(L,function(e){return e===o}),c=(s=n.lines.atIndex(r)).text.length-s.lineMarker==0,!i&&c&&a||u.noteTitle.setTextStatus(r,!0)))))},this.editorKeyUp=function(e,t){var n;t.specialHandled||(0!==(n=u.editorContext.caretLine())&&1!==n||u.noteTitle.checkTextStatus(n))},this.pluginReadOnly=function(e){var t=u.editorContext;u.isReadOnly=!0,Object(h.$)(t.getInnerContainer()).removeClass("docbody--write"),E.a.emit(O.a.PC.DOCS.PLACEHOLDER.READ_ONLY),u.unbindHoverEvent()},this.pluginReadWrite=function(e){var t=u.editorContext;u.isReadOnly=!1,Object(h.$)(t.getInnerContainer()).addClass("docbody--write"),E.a.emit(O.a.PC.DOCS.PLACEHOLDER.READ_WRITE),Object(f.c)("mention_box"),u.customIconEnable&&!u.iconInfo&&u.bindHoverEvent()},this.reset=function(){u.unbindHoverEvent(),u.editor.off(S.c,u.handleSetTitleIcon),E.a.off(O.a.PC.SUITE.UPDATE_CUSTOM_ICON_START,u.handleNavigationSetTitleIcon),u.changeNoteTitle&&u.changeNoteTitle.flush(),u.changeNoteTitle=null,u.isReadOnly=!0,u.noteTitle.destory()},this.lineNodesRendered=function(e,t){var n,i,r,o;u.isReadOnly||(i=(n=t.data).lineEntries,-1!==(r=n.renderedLines.indexOf(0))&&(o=i[r].lineNode,u.noteTitle.setTitlePlaceholder(o)))},r&&(this.editor=r,this.editorContext=r,this.aceInitialized("",Object.assign({editorInfo:r},r)),this.postAceInit(),r.on("paint",function(e){var t,n,i=e.data[0];!i||u.isReadOnly||(t=i.data).getZoneId&&"0"===t.getZoneId()&&t.isEmpty()&&(n=r.getRep("0").lines.atIndex(0),u.noteTitle.setTitlePlaceholder(n.lineNode))}))}return s()(e,[{key:"aceInitialized",value:function(e,t){var n=this;this.changeNoteTitle=Object(l.default)(function(){var e=n.editorContext.getDocId(),t=n.getTitle();n.iconInfo=n.getTitleIconInfo(),n.handleImgTitle(),n.editorContext.call(S.a,{token:e,title:t,iconInfo:n.iconInfo}),n.customIconEnable&&(n.emitNativgationTitleIconEvent(),n.isReadOnly||(n.iconInfo?n.unbindHoverEvent():n.bindHoverEvent()))},200),this.changeNoteTitle(),this.editor.on(S.c,this.handleSetTitleIcon),E.a.on(O.a.PC.SUITE.UPDATE_CUSTOM_ICON_START,this.handleNavigationSetTitleIcon)}},{key:"emitNativgationTitleIconEvent",value:function(){var e=this.iconInfo||{type:I.NUM_CUSTOM_ICON_TYPE.UNSET,key:"",fs_unit:""};Object(k.d)(Object(C.g)(),e)}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement){var r=/(?:^| )diy-icon-(\S+)/.exec(t.className);return r?Object(T.I)(n,i,{icon:r[1]}):n}}},{key:"editorWillPaste",value:function(e){return j(e,this.editor)}},{key:"aceEditEvent",value:function(){this.titleShouldUpdate&&(this.noteTitle.checkTitleAndBodyStatus(),this.changeNoteTitle(),this.titleShouldUpdate=!1)}},{key:"emitUpdateAddIconVisible",value:function(e){this.editorContext.call(S.d,e)}},{key:"bindHoverEvent",value:function(){this.editorContext&&!this.isBindHoverEvent&&(Object(h.$)(this.editorContext.getInnerContainer()).on("mouseenter",".ace-line",this.onLineDomMouseEnter),Object(h.$)(this.editorContext.getInnerContainer()).on("mouseleave",".ace-line",this.onLineDomMouseLeave),this.isBindHoverEvent=!0)}},{key:"unbindHoverEvent",value:function(){this.editorContext&&(Object(h.$)(this.editorContext.getInnerContainer()).off("mouseenter",".ace-line",this.onLineDomMouseEnter),Object(h.$)(this.editorContext.getInnerContainer()).off("mouseleave",".ace-line",this.onLineDomMouseLeave),this.isBindHoverEvent=!1)}}]),e}())||i;new N},eySY:function(e,t,n){"use strict";n.d(t,"a",function(){return g}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var i=n("J4zp"),d=n.n(i),r=n("EVdn"),h=n.n(r),o=n("dKDz"),f=n.n(o),u=n("EVj1"),p=n("VIFs");function g(e,t,n){var i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],r=4<arguments.length?arguments[4]:void 0,o='class="author-'.concat(n," link-mention-holder ").concat(t,' url" style="white-space: pre;"'),a=r?m(r):[[""],[""]],s=d()(a,2),c=s[0],l=s[1],u="<span ".concat(o,">").concat(i?" ":"",'<a href="').concat(e,'">').concat(e,"</a></span>");return c.join("")+u+l.join("")}function m(e){return e.map(function(e){return e.split(/[\r\n]/).map(function(e,t){return(0<t?"<br><span>":"<span>").concat(f()(e),"</span>")})})}function a(e){var t=e.wrapper,o=e.pureUrl,a=e.holderCls,s=e.author,n=e.useSpace,i=e.filteredTextGroup,c=!1;if(!t.innerHTML)return t.innerHTML=g(o,a,s,n,i),!0;var l=f()(v(o)),u=0;return t.querySelectorAll("a").forEach(function(e){var t,n,i=f()(e.href),r=f()(e.textContent);l===i&&l===r&&(c=!0,t=0<u?"".concat(a,"-").concat(u):a,n=g(o,t,s),h()(e).replaceWith(n),u++)}),c}function v(e){return e.replace(/[^\x00-\x7F]$/g,"")}function s(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=Object(u.f)(e);if(t||(n=n.split(/https?:\/\//).pop()||""),!Object(p.isSuiteUrl)(n))return null;var i=Object(u.k)(e,!0,t),r=i.token,o=i.type,a=i.protocol,s=i.preText,c=void 0===s?"":s,l=i.restText;return r&&o?{preText:c,token:r,type:o,restText:void 0===l?"":l,protocol:a}:null}},"f9b/":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i="member"},fHYd:function(e,o,a){"use strict";(function(n){var e=a("Ngi8"),t=a("Qvr1"),i=a.n(t),B=a("yGdm"),U=a("HmyT"),r=a("cgIo"),z=(a("IQA7"),{editorInfo:null,showStatus:!1,referenceCount:0,iframeKey:"",init:function(){var e,t;this.referenceCount++,Object(U.$)(".link-popup").length||(z.outContainer=Object(U.$)(".doc-popup-container"),e=n("etherpad.text"),t=n("etherpad.link"),Object(U.$)(Object(r.a)(i.a)({text:e,link:t,sure:n("common.determine"),addLinkInfo:n("etherpad.addLink"),addTextInfo:n("etherpad.enter_text"),help:n("CreationDocs_Embeds_URL_HelpCenter"),showExample:n("block.iframe_show_example"),iframeInputPlaceholder:n("block.iframe_input_placeholder"),insert:n("common.confirm"),icon:""})).appendTo(z.outContainer),z.linkPopUp=Object(U.$)(".link-popup"),z.triangle=z.linkPopUp.find(".link-popup__triangle"),z.textInput=z.linkPopUp.find(".text-input"),z.linkInput=z.linkPopUp.find(".link-input"),z.linkGroup=z.linkPopUp.find(".link-popup__input-group"),z.linkIframe=z.linkPopUp.find(".link-iframe"),z.linkIframeTitle=z.linkPopUp.find(".link-iframe__title"),z.linkIframeClose=z.linkPopUp.find(".link-iframe__close"),z.linkIframeMain=z.linkPopUp.find(".link-iframe__main"),z.linkIframeInput=z.linkPopUp.find(".link-iframe__input"),z.linkIframeHelp=z.linkPopUp.find(".link-iframe__help"),z.linkIframeExample=z.linkPopUp.find(".link-iframe__example"),z.linkIframeSubmit=z.linkPopUp.find(".link-iframe__submit"))},resetIframeKey:function(){this.iframeKey=""},hidePopUp:function(){this.editorInfo&&this.editorInfo.call("editorbar:toggleAButtonVisible",!0),z.showStatus=!1,Object(U.$)(".comment-line-popup-container").show(),z.linkPopUp.addClass("link-popup_hidden"),z.linkIframeHelp.addClass("hidden")},showPopUp:function(e){var t=e.editorInfo,n=e.isCollapsed,i=e.type,r=e.title,o=e.placeholder,a=e.exampleLink,s=e.helpLink,c=e.link,l=e.text,u=e.exsitLink,d=e.iframeKey,h=(this.editorInfo=t).selection,f=h.getRealEndLine,p=h.getRealFirstLine,g=h.getSelectionRange,m=t.getRep();"iframe"===i?(z.linkIframe.removeClass("hidden"),z.linkGroup.addClass("hidden"),s&&(z.linkIframeHelp.removeClass("hidden"),z.linkIframeHelp.attr("href",s)),z.linkIframeTitle.text(r),z.linkIframeClose.on("click",this.hidePopUp),z.linkIframeInput.val(""),z.linkIframeInput.attr("placeholder",o),z.linkIframeInput.on("focus",this.handleFocus),z.linkIframeInput.on("blur",this.handleBlur),z.linkIframeExample.attr("href",a),z.linkPopUp.addClass("link-popup--iframe")):(z.linkIframe.addClass("hidden"),z.linkGroup.removeClass("hidden"),z.linkIframeHelp.addClass("hidden"),z.linkPopUp.removeClass("link-popup--iframe")),z.linkPopUp.removeClass("link-popup_hidden link-popup__uncollapsed"),n||u||z.linkPopUp.addClass("link-popup__uncollapsed"),z.textInput.val(""),z.linkInput.val(""),c&&l&&(z.textInput.val(l),z.linkInput.val(c));var v=m.selStart,b=m.selEnd,y={selStart:v,selEnd:b},E=f(m.zoneId,y),O=p(m.zoneId,y),C={};O===v[0]&&O===E?C.selStart=v:C.selStart=[E,0],E===b[0]?C.selEnd=b:C.selEnd=[E,m.lines.atIndex(E).text.length];var k=g({selStart:C.selStart,selEnd:C.selEnd,zoneId:m.zoneId},t);k.collapsed&&"BR"===k.startContainer.tagName&&k.selectNode(k.startContainer);var I,S=k.getBoundingClientRect(),T=S.left+S.width/2,_=z.outContainer[0].getBoundingClientRect(),w=B.d,j=Object(U.$)(".etherpad-client-container")[0].getBoundingClientRect(),M=j.width,L=j.right,R=w/2,N=L-R,D=Math.min(T,N)-R-_.left,x=S.top+S.height-_.top+3,P=M+T-R-_.left;z.triangle.css({"margin-left":""}),P<0?(z.triangle.css({"margin-left":"".concat(6+P,"px")}),D=-M-15):N<T&&(I=R-(L-T)-8,z.triangle.css({"margin-left":"".concat(I,"px")})),z.linkPopUp.css({left:"".concat(D,"px"),top:"".concat(x+5,"px")}),z.showStatus=!0,this.iframeKey=d},handleFocus:function(){z.linkIframeMain&&z.linkIframeMain.css({borderColor:e.B500})},handleBlur:function(){z.linkIframeMain&&z.linkIframeMain.css({borderColor:e.N300})},getContainer:function(){return z.outContainer},destroy:function(){this.referenceCount--,this.resetIframeKey(),0===this.referenceCount&&(z.outContainer=null,z.linkPopUp=null,z.triangle=null,z.textInput=null,z.linkInput=null,z.linkGroup=null,z.linkIframe=null,z.linkIframeTitle=null,z.linkIframeClose.off(),z.linkIframeClose=null,z.linkIframeInput.off(),z.linkIframeInput=null,z.linkIframeHelp=null,z.linkIframeExample=null,z.linkIframeSubmit=null)}});o.a=z}).call(this,a("2vAP"))},fJND:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return i});var u=n("EVj1"),d=n("VIFs");function h(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=Object(u.f)(e);if(t||(n=n.split(/https?:\/\//).pop()||""),!Object(d.isDocUrl)(n))return null;var i=Object(u.k)(e,!0,t),r=i.token,o=i.type,a=i.protocol,s=i.preText,c=void 0===s?"":s,l=i.restText;return r&&o?{preText:c,token:r,type:o,protocol:a,restText:void 0===l?"":l}:null}function i(e,t,n){if(!e||!t)return!1;var i=h(e)||{},r=i.token,o=i.type,a=h(t)||{},s=a.token,c=a.type,l=Boolean(r&&s&&r===s);return l&&n?n===o&&n===c:l}},fJxK:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return h});var a,s,i,r=n("lwsE"),o=n.n(r),c=n("W8MJ"),l=n.n(c),u=n("7EGn"),d=n("2ACu");(a=a||{}).ClientComment="client_comment",(i=s=s||{}).InputBox="input_box",i.SubmitBox="submit_box",i.CancelSubmit="cancel_submit",i.StartEditComment="start_edit_comment",i.SubmitEdit="submit_edit",i.ClickCommentEdit="submit_edit",i.DeleteComment="delete_comment",i.ReplyComment="reply_comment",i.UpBtn="up_btn",i.DownBtn="down_btn",i.ClickTarget="click_target",i.FinishComment="finish_comment",i.ViewHistory="view_history",i.ShowReactionPanel="show_reaction_panel",i.SelectReaction="select_reaction",i.CancelReaction="cancel_reaction",i.ShowReactionPage="show_reaction_page",i.ShowReactionPanelFull="show_reaction_page_full";var h=function(){function e(){o()(this,e),this.logContext=null}return l()(e,[{key:"setLogContext",value:function(e){this.logContext=e}},{key:"logClientComment",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i="";e!==s.InputBox&&e!==s.SubmitBox&&e!==s.ReplyComment||(i="direct");var r=this.logContext?this.logContext(e,t):{},o=Object.assign({comment_id:Object(u.default)(t,"commentId",null)},n,{},r);Object(d.collectSuiteEvent)(a.ClientComment,Object.assign({action:e},o,{source:o.source||i,comment_type:"part_comment"}))}}]),e}()},fOP3:function(e,t,n){},fOmz:function(e,t,n){"use strict";n.d(t,"a",function(){return I});var i=n("o0o1"),a=n.n(i),r=n("lSNA"),s=n.n(r),o=n("yXPU"),c=n.n(o),l=n("lwsE"),u=n.n(l),d=n("W8MJ"),h=n.n(d),f=n("a1gu"),p=n.n(f),g=n("Nsbk"),m=n.n(g),v=n("7W2i"),b=n.n(v),y=n("jp/M"),E=n("7HY0"),O=n("D7h9"),C=n("cyON"),k=O.default.dispatch,I=function(e){function t(e){var o;return u()(this,t),(o=p()(this,m()(t).call(this,e))).fetchComments=function(){var n,r=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return k({type:"COMMENT_SERVICE",COMMENT:(n=c()(a.a.mark(function e(t,n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s()({type:y.actionTypes.commentData.FETCH_COMMENTS,payload:{}},C.a,{resetWhenSuiteTokenChange:!0}),e.abrupt("return",o.wrapperDispatchAction(t,i,function(){return o.commentService.fetchComments(r)}));case 2:case"end":return e.stop()}},e)})),e)});function e(e,t){return n.apply(this,arguments)}},o.fetchComment=function(r){return k({type:"COMMENT_SERVICE",COMMENT:(n=c()(a.a.mark(function e(t,n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s()({type:y.actionTypes.commentData.FETCH_COMMENT,payload:{}},C.a,{resetWhenSuiteTokenChange:!0}),e.abrupt("return",o.wrapperDispatchAction(t,i,function(){return o.commentService.fetchComment(r)}));case 2:case"end":return e.stop()}},e)})),e)});function e(e,t){return n.apply(this,arguments)}var n},o.startNewComment=function(e){return k({type:y.actionTypes.commentData.START_NEW_COMMENT,payload:Object.assign({rootType:o.rootType,rootToken:o.rootToken,subCommentToken:o.subCommentToken},e)})},o.addComment=function(i){return k({type:"COMMENT_SERVICE",COMMENT:(t=c()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:y.actionTypes.commentData.ADD_COMMENT,payload:{addCommentParams:i}},e.abrupt("return",o.wrapperDispatchAction(t,n,function(){return o.commentService.addComment(i)}));case 2:case"end":return e.stop()}},e)})),e)});function e(e){return t.apply(this,arguments)}var t},o.resolveComment=function(i){return k({type:"COMMENT_SERVICE",COMMENT:(t=c()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:y.actionTypes.commentData.RESOLVE_COMMENT,payload:{rootToken:o.rootToken}},e.abrupt("return",o.wrapperDispatchAction(t,n,function(){return o.commentService.resolveComment(i)}));case 2:case"end":return e.stop()}},e)})),e)});function e(e){return t.apply(this,arguments)}var t},o.resolveCommentAnimationEnd=function(e){var t=e.commentId;return k({type:y.actionTypes.commentData.RESOLVE_COMMENT_ANIMATION_END,payload:{rootType:o.rootType,rootToken:o.rootToken,subCommentToken:o.subCommentToken,commentId:t}})},o.replyComment=function(i){return k({type:"COMMENT_SERVICE",COMMENT:(t=c()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:y.actionTypes.commentData.REPLY_COMMENT,payload:{replyCommentParams:i}},e.abrupt("return",o.wrapperDispatchAction(t,n,function(){return o.commentService.replyComment(i)}));case 2:case"end":return e.stop()}},e)})),e)});function e(e){return t.apply(this,arguments)}var t},o.updateComment=function(i){return k({type:"COMMENT_SERVICE",COMMENT:(t=c()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:y.actionTypes.commentData.UPDATE_COMMENT,payload:{updateCommentParams:i}},e.abrupt("return",o.wrapperDispatchAction(t,n,function(){return o.commentService.updateComment(i)}));case 2:case"end":return e.stop()}},e)})),e)});function e(e){return t.apply(this,arguments)}var t},o.deleteComment=function(i){return k({type:"COMMENT_SERVICE",COMMENT:(t=c()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:y.actionTypes.commentData.DELETE_COMMENT,payload:{deleteCommentParams:i}},e.abrupt("return",o.wrapperDispatchAction(t,n,function(){return o.commentService.deleteComment(i)}));case 2:case"end":return e.stop()}},e)})),e)});function e(e){return t.apply(this,arguments)}var t},o.reopenComment=function(i){return k({type:"COMMENT_SERVICE",COMMENT:(t=c()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:y.actionTypes.commentData.REOPEN_COMMENT,payload:{reopenCommentParams:i,rootType:o.rootType,rootToken:o.rootToken,subCommentToken:o.subCommentToken}},e.abrupt("return",o.wrapperDispatchAction(t,n,function(){return o.commentService.reopenComment(i)}));case 2:case"end":return e.stop()}},e)})),e)});function e(e){return t.apply(this,arguments)}var t},o.genReplyId=function(i){return k({type:"COMMENT_SERVICE",COMMENT:(t=c()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:y.actionTypes.commentData.GEN_REPLY_ID,payload:Object.assign({},i)},e.abrupt("return",o.wrapperDispatchAction(t,n,function(){return o.commentService.genReplyId(i)}));case 2:case"end":return e.stop()}},e)})),e)});function e(e){return t.apply(this,arguments)}var t},o.deleteTemplateComment=function(e){var t=e.commentId,n=e.replyId,i=e.type,r=e.oldContent;return k({type:y.actionTypes.commentData.DELETE_TEMPLATE_COMMENT,payload:{commentId:t,replyId:n,type:i,oldContent:r,subCommentToken:o.subCommentToken,rootType:o.rootType,rootToken:o.rootToken}})},o.linkCommentToDoc=function(e){var t=e.commentId,n=e.replyId,i=e.tempReplyId;return k({type:y.actionTypes.commentData.LINK_COMMENT_TO_DOC,payload:{commentId:t,tempReplyId:i,replyId:n,subCommentToken:o.subCommentToken,rootType:o.rootType,rootToken:o.rootToken}})},o.linkCommentToDocOK=function(e){var t=e.commentId,n=e.tempCommentId,i=e.replyId;return k({type:y.actionTypes.commentData.LINK_COMMENT_TO_DOC_OK,payload:{commentId:t,tempCommentId:n,replyId:i,rootType:o.rootType,rootToken:o.rootToken,subCommentToken:o.subCommentToken}})},o.linkCommentToDocError=function(e){var t=e.commentId,n=e.error,i=e.replyId;return k({type:y.actionTypes.commentData.LINK_COMMENT_TO_DOC_ERROR,payload:{commentId:t,replyId:i,error:n,rootType:o.rootType,rootToken:o.rootToken,subCommentToken:o.subCommentToken}})},o.mergeComments=function(e){return k({type:y.actionTypes.commentData.MERGE_COMMENTS,payload:Object.assign({rootToken:o.rootToken,rootType:o.rootType,subCommentToken:o.subCommentToken},e),ADD_USER:function(){return e.entities.users}})},o.commentService.setupCommentRecord(),o}return b()(t,e),h()(t,[{key:"destroyComments",value:function(){this.destroy(),k({type:y.actionTypes.commentPosition.SET_COMMENT_POSITION_DATA,payload:{commentPositions:[],rootToken:this.rootToken,rootType:this.rootType,subCommentToken:this.subCommentToken,isLoaded:!1}}),k({type:y.actionTypes.commentData.RESET_COMMENTS,payload:{rootToken:this.rootToken,rootType:this.rootType,subCommentToken:this.subCommentToken,comments:[]}})}}]),t}(E.a)},fRrQ:function(e,t,n){"use strict";n.d(t,"a",function(){return E});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n.n(f),g=n("VI6H"),m=n("lQZd"),v=n("AiBH"),b=n("rLED"),y=n("XsFf"),E=function(e){function n(e){var t;return r()(this,n),(t=c()(this,u()(n).call(this,e))).state={userAvatar:Object(g.k)(t.props.userId)},t}return h()(n,e),a()(n,[{key:"componentDidMount",value:function(){var t=this;Object(b.G)()&&Object(y.b)(this.props.userId,v.z.DOC,Object(m.g)()).then(function(e){t.setState({userAvatar:e.avatar_url})})}},{key:"render",value:function(){var e=this.state.userAvatar;return p.a.createElement("div",{className:"at-user-avatar"},p.a.createElement("img",{src:e}))}}]),n}(f.Component)},fRsX:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"f",function(){return u});var i,r,o=n("rLED");(r=i=i||{}).TOP_BOTTOM="v1",r.LEFT_RIGHT="v2";var a=function(){var e=i.LEFT_RIGHT;return Object(o.L)("doc_template_v3_layout")||e},s=Object(o.K)("doc_template_v3_custom_enabled"),c=Object(o.I)("doc_template_v3_mindnote_enabled"),l=Object(o.I)("doc_template_v3_from_v2"),u=Object(o.K)("doc_template_v3_corporate_enabled");a(),i.LEFT_RIGHT},fUG1:function(e,t,n){"use strict";n.r(t);var i=n("m/+l"),r=n("lwsE"),a=n.n(r),o=n("W8MJ"),s=n.n(o),c=n("a1gu"),l=n.n(c),u=n("Nsbk"),d=n.n(u),h=n("7W2i"),f=n.n(h),p=n("cDf5"),g=n.n(p),m=n("7EGn"),v=n("UXvI"),b=n("q1tI"),y=n.n(b),E=(n("CA4f"),n("tAHg")),O=n("OX8E"),C=n("4PSP"),k=n("SGN9"),I=n("G8Hj"),S=n("r06y"),T=n("o0o1"),_=n.n(T),w=n("yXPU"),j=n.n(w),M=n("TSYQ"),L=n.n(M),R=n("kUgE"),N=n("2ACu"),D=n("EVdn"),x=n.n(D),P=n("wd/R"),B=n.n(P),U=(n("7tiO"),n("WHPX")),z=n("mR6P"),H=n.n(z),F=n("aYrm"),V=n.n(F),W=n("A0zn"),K=n.n(W),Z=n("MjSh"),q=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":g()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Y={black:"black",white:"white",gray1:Z.N400,gray2:Z.N300},J={"zh-cn":H.a,"en-us":V.a,"ja-jp":K.a},Q=function(e){function t(){var e;return a()(this,t),(e=l()(this,d()(t).apply(this,arguments))).$selected=null,e}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.removeElementTitle(),this.setColor(),x()(".cp-calendar-prev-month-btn").on("click",this.handleMonthChange),x()(".cp-calendar-next-month-btn").on("click",this.handleMonthChange)}},{key:"componentDidUpdate",value:function(e){this.props.value!==e.value&&this.setColor()}},{key:"componentWillUnmount",value:function(){this.resetColor(),x()(".cp-calendar-prev-month-btn").off("click",this.handleMonthChange),x()(".cp-calendar-next-month-btn").off("click",this.handleMonthChange)}},{key:"removeElementTitle",value:function(){x()(".cp-calendar .cp-calendar-prev-month-btn").removeAttr("title"),x()(".cp-calendar .cp-calendar-next-month-btn").removeAttr("title"),x()(".cp-calendar .cp-calendar-year-select").removeAttr("title"),x()(".cp-calendar .cp-calendar-month-select").removeAttr("title"),x()(".cp-calendar .cp-calendar-cell").removeAttr("title"),x()(".cp-calendar .cp-calendar-column-header").removeAttr("title")}},{key:"resetColor",value:function(){null!==this.$selected&&this.setStyle(this.$selected,{background:"",color:""})}},{key:"setColor",value:function(){this.resetColor(),this.$selected=x()(".date-picker .cp-calendar-selected-day .cp-calendar-date"),this.setStyle(this.$selected,{background:this.props.color,color:Y.white})}},{key:"setStyle",value:function(e,t){e.length&&e.css(t)}},{key:"handleChange",value:function(e){(0,this.props.onChange)(e)}},{key:"handleMonthChange",value:function(){this.props.onMonthChange()}},{key:"handleSelect",value:function(){this.props.onDateChange()}},{key:"render",value:function(){var e=this.props,t=e.lang,n=e.value;return y.a.createElement(U.a,{prefixCls:"cp-calendar",className:"date-picker",locale:J[t],mode:"date",value:B()(n),showDateInput:!1,onChange:this.handleChange,onSelect:this.handleSelect})}}]),t}(y.a.Component);q([Object(C.Bind)()],Q.prototype,"resetColor",null),q([Object(C.Bind)()],Q.prototype,"handleChange",null),q([Object(C.Bind)()],Q.prototype,"handleMonthChange",null),q([Object(C.Bind)()],Q.prototype,"handleSelect",null);var X=Q,$=n("Ngj4"),ee=n("HJz/"),te=(n("uVPH"),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":g()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a}),ne=function(e){function t(){var e;return a()(this,t),(e=l()(this,d()(t).apply(this,arguments))).state={isWholeDay:!1,shouldNotify:!0,datePickerDate:0,jetLag:0},e}function n(e){return i.apply(this,arguments)}var i,r;function o(){return r.apply(this,arguments)}return f()(t,e),s()(t,[{key:"componentDidUpdate",value:function(e){var t=e.visible,n=e.reminderProps,i=this.props,r=i.visible,o=i.reminderProps;(t!==r&&r||n.reminderBlockId!==o.reminderBlockId)&&this.initState()}},{key:"initState",value:function(){var e=this.props.reminderProps,t=e.isWholeDay,n=void 0!==t&&t,i=e.shouldNotify,r=void 0===i||i,o=e.expireTime,a=e.notifyTime;o&&a&&this.setState({datePickerDate:o,isWholeDay:n,shouldNotify:r,jetLag:a-o})}},{key:"setDefaultJetLag",value:(r=j()(_.a.mark(function e(){return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({jetLag:this.jetLagList[0].value});case 2:case"end":return e.stop()}},e,this)})),o)},{key:"updateReminder",value:function(){var e=this.state,t=e.isWholeDay,n=e.shouldNotify,i=e.datePickerDate,r=e.jetLag;this.props.onUpdateProps({isWholeDay:t,shouldNotify:n,expireTime:i,notifyTime:i+r})}},{key:"logAction",value:function(e){Object(N.default)("client_reminder_operation",{action:e,source:"click",file_is_have_edit:!0})}},{key:"handleDatePickerChange",value:function(e){var t=e.valueOf();this.setState({datePickerDate:t})}},{key:"handleDatePickerMonthChange",value:function(){this.logAction("select_month")}},{key:"handleDatePickerDateChange",value:function(){this.logAction("select_date"),this.updateReminder()}},{key:"handleNotifyChange",value:(i=j()(_.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.isWholeDay,i=t.shouldNotify,r=t.setTime,o=t.jetLag,a=this.state,s=a.isWholeDay,c=a.shouldNotify,l=a.datePickerDate,u=a.jetLag,d=B()(l).set(S.d).valueOf(),h=l-d,p=c!==i,(f=s!==n)&&!n&&(r=Object(S.j)()),f&&n&&(d=B()(d).set(S.e).valueOf(),r=0),e.next=10,this.setState({isWholeDay:n,shouldNotify:i,datePickerDate:d+r,jetLag:o});case 10:if(f||p)return e.next=13,this.setDefaultJetLag();e.next=13;break;case 13:this.updateReminder(),f?this.logAction(n?"cancel_client_time":"client_time"):(r!==h&&this.logAction("select_time"),p?"intact"===this.props.source&&this.logAction(i?"client_card_reminder":"client_cancel_card_reminder"):u!==o&&this.logAction("select_reminder_time"));case 15:case"end":return e.stop()}},e,this)})),n)},{key:"handleUserChange",value:function(e){var t=this,n=e.shouldNotify;this.setState(function(e){return{shouldNotify:n}},function(){t.updateReminder()}),this.logAction(n?"hover_card_client_reminder":"hover_card_client_cancel_reminder")}},{key:"renderDatePicker",value:function(){var e=this.props,t=e.visible,n=e.source,i=this.state.datePickerDate,r={lang:this.lang,value:i,color:Object(S.c)(i),onChange:this.handleDatePickerChange,onMonthChange:this.handleDatePickerMonthChange,onDateChange:this.handleDatePickerDateChange};return t&&"intact"===n?y.a.createElement(X,Object.assign({},r)):null}},{key:"renderNotify",value:function(){var e=this.props,t=e.source,n=e.isShowNotify,i=this.state,r=i.jetLag,o=i.isWholeDay,a=i.shouldNotify;return"intact"===t?y.a.createElement($.a,{isWholeDay:o,isShowNotify:n,shouldNotify:a,setTime:this.setTime,setTimeList:this.setTimeList,jetLag:r,jetLagList:this.jetLagList,onChange:this.handleNotifyChange}):null}},{key:"renderUser",value:function(){var e=this.props,t=e.source,n=e.reminderProps,i=e.isShowUser,r=e.isOpenEntry,o=n.userProps;return i?y.a.createElement(ee.a,{showCheckbox:"simple"===t,shouldNotify:this.state.shouldNotify,users:o,lang:this.lang,checkboxDisabled:!r,onChange:this.handleUserChange}):null}},{key:"renderDateTime",value:function(){var e=this.props,t=e.source,n=e.reminderProps;return"simple"===t?y.a.createElement("div",{className:"reminder-popover-date-time"},y.a.createElement("span",{className:"year-month-date"},B()(n.expireTime).format("LL")),y.a.createElement("span",{className:"reminder-time"},!n.isWholeDay&&"".concat(B()(n.expireTime).format("LT")))):null}},{key:"render",value:function(){var e=this.props,t=e.style,n=e.visible,i=e.onPopoverMouseEnter,r=e.onPopoverMouseLeave,o=L()("reminder-popover-wrapper",{visible:n});return y.a.createElement("div",{className:o,style:t,onMouseEnter:i,onMouseLeave:r},y.a.createElement("div",{className:"gap"}),y.a.createElement("div",{className:"reminder-popover"},this.renderDateTime(),this.renderDatePicker(),this.renderNotify(),this.renderUser()))}},{key:"lang",get:function(){return R.LANG_MAP.zh?S.a.ZH:R.LANG_MAP.ja?S.a.JA:S.a.EN}},{key:"jetLagList",get:function(){return this.state.isWholeDay?S.f:S.b}},{key:"setTime",get:function(){var e=this.state.datePickerDate;return e-B()(e).set(S.d).valueOf()}},{key:"setTimeList",get:function(){return Object(S.l)(this.setTime)}}]),t}(b.PureComponent);te([Object(C.Debounce)(200)],ne.prototype,"updateReminder",null),te([Object(C.Bind)()],ne.prototype,"handleDatePickerChange",null),te([Object(C.Bind)()],ne.prototype,"handleDatePickerMonthChange",null),te([Object(C.Bind)()],ne.prototype,"handleDatePickerDateChange",null),te([Object(C.Bind)()],ne.prototype,"handleNotifyChange",null),te([Object(C.Bind)()],ne.prototype,"handleUserChange",null),te([Object(C.Bind)()],ne.prototype,"renderDatePicker",null),te([Object(C.Bind)()],ne.prototype,"renderNotify",null),te([Object(C.Bind)()],ne.prototype,"renderUser",null),te([Object(C.Bind)()],ne.prototype,"renderDateTime",null);var ie=n("D28M"),re=n("sLU5"),oe=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":g()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},ae={leading:!1,trailing:!0},se=function(e){function t(e){var n;return a()(this,t),(n=l()(this,d()(t).call(this,e))).activeLine=null,n.handleUpdateDomLine=function(e,t){n.activeLine===e&&(n.activeLine=t)},n.state={popoverVisible:!1,popoverSource:"",popoverStyle:{},reminderProps:Object(S.g)(),hoverPopover:!1},n.debounceHideSimplePopover=Object(v.default)(n.hideSimplePopover,S.i,ae),n.debounceShowPopover=Object(v.default)(n.showPopover,S.h,ae),n.controller=new E.a(O.a),n.controller.onClickReminder(n.handleClickReminder),n.controller.onHoverReminder(n.handleHoverReminder),n.controller.onClickAddReminderBtn(n.handleAddReminder),n.controller.onReminderDelete(n.handleReminderDelete),n.controller.onPropsChange(n.handlePropsChange),n.controller.onKeyDownEvent(n.handleKeyDownEvent),n.controller.onShowGuide(n.showGuide),n.controller.onUpdatePlaceholder(n.updatePlaceholder),n.controller.onUpdateDomLine(n.handleUpdateDomLine),n}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){O.a.on(re.a.PC.DOCS.REMINDER_GUIDE_INSERT,this.insertGuideReminder),document.addEventListener("selectionchange",this.handleSelectLine),document.addEventListener("mousedown",this.hideIntactPopover)}},{key:"componentWillUnmount",value:function(){this.controller&&(this.controller.offClickReminder(this.handleClickReminder),this.controller.offHoverReminder(this.handleHoverReminder),this.controller.offClickAddReminderBtn(this.handleAddReminder),this.controller.offReminderDelete(this.handleReminderDelete),this.controller.offPropsChange(this.handlePropsChange),this.controller.offKeyDownEvent(this.handleKeyDownEvent),this.controller.offShowGuide(this.showGuide),this.controller.offUpdatePlaceholder(this.updatePlaceholder),this.controller.offUpdateDomLine(this.handleUpdateDomLine),this.controller=null),O.a.off(re.a.PC.DOCS.REMINDER_GUIDE_INSERT,this.insertGuideReminder),document.removeEventListener("selectionchange",this.handleSelectLine),document.removeEventListener("mousedown",this.hideIntactPopover)}},{key:"showGuide",value:function(e){var t,n=Object(ie.l)(e,"ace-table");!this.props.canShowGuide||n||(t=e.querySelector(".add-reminder"))&&(t.setAttribute("data-selector","add-reminder"),Object(k.b)(I.STEP_TYPES.enter_reminder_guide))}},{key:"insertGuideReminder",value:function(){var e;this.controller&&(e=this.props.currentUser.toJS(),this.controller.insertGuide({currentUser:e}))}},{key:"handleKeyDownEvent",value:function(e){var t=this,n=e.target,i=e.char;setTimeout(function(){t.togglePlaceholder(t.domHasText(n,i),n.id)})}},{key:"showPlaceholder",value:function(e){this.controller&&this.controller.togglePlaceholder(e,!0)}},{key:"hidePlaceholder",value:function(e){this.controller&&this.controller.togglePlaceholder(e,!1)}},{key:"togglePlaceholder",value:function(e,t){e?this.hidePlaceholder(t):this.showPlaceholder(t)}},{key:"updatePlaceholder",value:function(e){var t=this.activeLine;t&&e.id===t.id&&this.togglePlaceholder(this.domHasText(e),e.id)}},{key:"domHasText",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";if("Backspace"!==t&&" "!==t&&0<t.length)return!0;if(!e)return!0;var n=this.props.editor;if(n.getInInternationalComposition())return!0;var i=e.id,r=n.getRep().lines.atKey(i);return!r||0<r.text.substring(r.lineMarker).length}},{key:"focusNodeIsReminder",value:function(e,t){var n="reminder-inline-block";if(Object(ie.l)(e,"reminder-popover")||Object(ie.l)(e,n))return!0;var i=Object(m.default)(e,"parentNode.previousSibling.firstChild");if(i)return Object(ie.f)(i,"block-type-REMINDER_BLOCK");var r=e.parentElement&&e.parentElement.closest("[data-leaf]");if(!r)return!1;if(r.querySelector(".".concat(n)))return!0;if(0===t||r.querySelector("[data-enter]")){var o=r.previousElementSibling;if(o&&o.querySelector(".".concat(n)))return!0}return!1}},{key:"handleSelectLine",value:function(e){if(this.isOpenEntry){var t=this.activeLine,n=this.state.popoverVisible,i=window.getSelection();if(i){var r=i.anchorNode;if(r&&!Object(ie.l)(r,"reminder-popover")){var o=i.anchorOffset;n&&!this.focusNodeIsReminder(r,o)&&this.setState({popoverVisible:!1,popoverSource:""});var a=Object(ie.o)(r,"ace-line");if(a)if(t&&a.id===t.id&&(a!==t||a.id===a.oldId)||this.togglePlaceholder(this.domHasText(a),a.id),a.children[0]){if(a.querySelector("[class^=list-check],[class^=list-done]"))return t&&(Object(ie.g)(a,"lineguid")===Object(ie.g)(t,"lineguid")&&a.id===t.id||(this.hideToolbar(t,!0),this.hidePlaceholder(t.id))),this.activeLine=a,void this.showToolbar(a,!0);this.activeLine=null,t&&!n&&(this.hideToolbar(t,!0),this.hidePlaceholder(t.id))}}}}}},{key:"handleAddReminder",value:function(e){this.controller&&this.controller.generateReminder(Object(S.g)(),e,this.handleGenerateColla)}},{key:"handleGenerateColla",value:function(e,t){this.setReminderProps(e,t),this.showPopover("intact")}},{key:"handlePropsChange",value:function(e,t){e===this.state.reminderProps.reminderBlockId&&this.setState(function(e){return{reminderProps:Object.assign({},e.reminderProps,{},t)}})}},{key:"setReminderProps",value:function(t,n){this.setState(function(e){return{popoverStyle:n||e.popoverStyle,reminderProps:Object.assign({},S.g,{},t)}})}},{key:"handleUpdateProps",value:function(t){var e=this,n=Object(m.default)(this.state.reminderProps,"reminderBlockId");n&&this.setState(function(e){return{reminderProps:Object.assign({},e.reminderProps,{},t)}},function(){e.controller&&e.controller.setReminderProps(n,e.state.reminderProps)})}},{key:"getPopoverProps",value:function(){var e=this.state;return{visible:e.popoverVisible,source:e.popoverSource,reminderProps:e.reminderProps,style:e.popoverStyle,onUpdateProps:this.handleUpdateProps,onPopoverMouseEnter:this.onPopoverMouseEnter,onPopoverMouseLeave:this.onPopoverMouseLeave,isOpenEntry:this.isOpenEntry,isShowUser:this.isShowUser,isShowNotify:this.isShowNotify}}},{key:"preventShakeShowPopover",value:function(e,t,n){this.debounceHideSimplePopover.cancel(),this.setReminderProps(Object.assign({},t,{reminderBlockId:e}),n),this.debounceShowPopover("simple")}},{key:"handleClickReminder",value:function(e,t,n){this.isOpenEntry&&(this.debounceShowPopover.cancel(),this.setReminderProps(Object.assign({},t,{reminderBlockId:e}),n),this.showPopover("intact"))}},{key:"handleHoverReminder",value:function(e,t,n,i){!e||"intact"===this.state.popoverSource||t.notCheckboxEntry||t.userProps&&!Object.keys(t.userProps).length||(n?this.preventShakeShowPopover(e,t,i):(this.debounceShowPopover.cancel(),this.debounceHideSimplePopover()))}},{key:"showPopover",value:function(e){"intact"===this.state.popoverSource&&"simple"===e||(this.setState({popoverVisible:!0,popoverSource:e}),Object(N.default)("client_reminder_operation",{action:"simple"===e?"hover_reminder_card":"click_reminder_card",source:"simple"===e?"hover":"click",file_is_have_edit:this.props.isEditable}))}},{key:"hideSimplePopover",value:function(){var e=this.state,t=e.popoverVisible,n=e.popoverSource,i=e.hoverPopover;t&&!i&&"simple"===n&&this.setState({popoverVisible:!1})}},{key:"hideIntactPopover",value:function(e){var t=this.state,n=t.popoverVisible,i=t.popoverSource,r=t.hoverPopover,o="intact"===i,a=e.target&&Object(ie.f)(e.target,"reminder-inline-block");n&&!r&&o&&!a&&this.setState({popoverVisible:!1,popoverSource:""})}},{key:"onPopoverMouseEnter",value:function(){this.setState({hoverPopover:!0})}},{key:"onPopoverMouseLeave",value:function(){this.setState({hoverPopover:!1}),this.debounceHideSimplePopover()}},{key:"showToolbar",value:function(e,t){this.controller&&this.isOpenEntry&&this.controller.showToolbar(e,t)}},{key:"hideToolbar",value:function(e,t){this.controller&&this.isOpenEntry&&this.controller.hideToolbar(e,t)}},{key:"handleReminderDelete",value:function(e){e===this.state.reminderProps.reminderBlockId&&this.setState(function(e){return{popoverVisible:!1,popoverSource:"simple"}})}},{key:"render",value:function(){var e=this.getPopoverProps();return y.a.createElement("div",{className:"reminder"},y.a.createElement(ne,Object.assign({},e)))}},{key:"isOpenEntry",get:function(){var e=this.props,t=e.isFullscreenMode;return e.isEditable&&!t}},{key:"isShowUser",get:function(){var e=this.state.reminderProps,t=e.userProps,n=e.notCheckboxEntry;return!!t&&(0!==Object.keys(t).length&&!n)}},{key:"isShowNotify",get:function(){return!this.state.reminderProps.notCheckboxEntry}}]),t}(b.PureComponent);oe([Object(C.Bind)()],se.prototype,"showGuide",null),oe([Object(C.Bind)()],se.prototype,"insertGuideReminder",null),oe([Object(C.Bind)()],se.prototype,"handleKeyDownEvent",null),oe([Object(C.Bind)()],se.prototype,"updatePlaceholder",null),oe([Object(C.Bind)()],se.prototype,"handleSelectLine",null),oe([Object(C.Bind)()],se.prototype,"handleAddReminder",null),oe([Object(C.Bind)()],se.prototype,"handleGenerateColla",null),oe([Object(C.Bind)()],se.prototype,"handlePropsChange",null),oe([Object(C.Bind)()],se.prototype,"setReminderProps",null),oe([Object(C.Bind)()],se.prototype,"handleUpdateProps",null),oe([Object(C.Bind)()],se.prototype,"handleClickReminder",null),oe([Object(C.Bind)()],se.prototype,"handleHoverReminder",null),oe([Object(C.Bind)()],se.prototype,"showPopover",null),oe([Object(C.Bind)()],se.prototype,"hideSimplePopover",null),oe([Object(C.Bind)()],se.prototype,"hideIntactPopover",null),oe([Object(C.Bind)()],se.prototype,"onPopoverMouseEnter",null),oe([Object(C.Bind)()],se.prototype,"onPopoverMouseLeave",null),oe([Object(C.Bind)()],se.prototype,"showToolbar",null),oe([Object(C.Bind)()],se.prototype,"hideToolbar",null),oe([Object(C.Bind)()],se.prototype,"handleReminderDelete",null);var ce=n("5cZX"),le=n("qKwb"),ue=n("ZGZ5"),de=n("n3ZB"),he=n("jzcD"),fe=function(e){var t=Object(he.b)(e).status.translated;return{isEditable:Object(ce.c)(e)&&!t,isFullscreenMode:Object(le.f)(e),currentUser:Object(ue.a)(e),canShowGuide:0===Object(de.j)(e).getIn(["reminder","has_used_reminder"])&&5<=Object(de.b)(e).createFileNum}},pe=Object(i.connect)(fe)(se),ge=n("p6Xf"),me=n("K9kX");n.d(t,"ReminderToolbar",function(){return ge.a}),n.d(t,"ReminderPlaceholder",function(){return me.a});t.default=pe},fZmJ:function(e,r,o){"use strict";(function(c){var e=o("lwsE"),t=o.n(e),l=o("toa8"),u=o("2ACu"),d=o("ahx2"),h=o("n/R6"),f=o("lQZd"),i="/api/xhistory/revert_preview/",p="/api/xhistory/revert/",n=function e(){t()(this,e)};n.fetchRevertHistory=function(e){var t=e.historyId,n=e.metaId;return l.d.get(i,{params:{history_id:t,meta_id:n,token:Object(f.g)()}}).then(function(e){var t=e.data;return{clientVars:{changes:t.changes,snapshots:t.snapshots},entities:t.entities}})},n.revert=function(e,t){var n=t.historyId,i=t.metaId,r=t.memberId,o=t.token,a=t.revision,s=t.editor;return l.d.post(p,{history_id:n,member_id:r,meta_id:i,token:Object(f.g)()}).then(function(e){var t,n,i=e.data;Object(u.collectSuiteEvent)("click_history_restore_confirm",{status_name:d.ERROR_CODE_MAP[0].msg,status_code:0,block_id:"",block_type:"",revision_id:a,action:"confirm"}),i&&i[o]&&(t=JSON.parse(i[o]),n={type:"DOC",req_id:-1,data:{type:"NEW_CHANGES",token:s.getDocId(),connect_type:"",over_size:0,changeset_list:[{user_id:s.getAuthor(),member_id:0,note_revision:t.revision,changeset:t.changeset,apool:JSON.parse(t.changeset_apool),zone_changesets:t.zone_changesets||[]}]}},s.plugins.sync.handleMessageFromServer(n)),h.a.success({closable:!0,content:c("etherpad.restored_successfully")})}).catch(function(e){var t;e.code&&(t=d.ERROR_CODE_MAP[e.code],Object(u.collectSuiteEvent)("click_history_restore_confirm",{status_name:t&&t.msg,status_code:e.code,block_id:"",block_type:"",revision_id:a,action:"confirm"}))})},r.a=n}).call(this,o("2vAP"))},faYQ:function(e,t,n){},gBrI:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i=n("J4zp"),r=n.n(i),o=n("cDf5"),a=n.n(o),s=n("lwsE"),c=n.n(s),l=n("W8MJ"),u=n.n(l),d=n("gq0T"),h=n("DNsP"),f=n("FEfn"),p=n("3b/h"),g=function(){function e(){c()(this,e),this.storedColor=Object(p.a)()[1]}return u()(e,[{key:"getHighlightAttributes",value:function(e,t){var n=e.colorData,i=this.parseColorData(n);return this.resetStoredColor(i),this.getAttributePairs(i)}},{key:"doSupportComposeColor",value:function(){return!0}},{key:"parseColorData",value:function(e){if(Object(d.i)(e))return null;var t=e?Object(f.a)(e):this.storedColor;return"object"===a()(t)?t:null}},{key:"getAttributePairs",value:function(e){return e?Object.entries(e).map(function(e){var t=r()(e,2),n=t[0],i=t[1];return[h.a[n.toUpperCase()],i]}):[[h.a.BACKGROUND,""],[h.a.TEXT,""]]}},{key:"resetStoredColor",value:function(e){e&&(this.storedColor=Object.assign({},this.storedColor,{},e))}}]),e}()},gI2E:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return u});var i,r=n("q1tI"),o=n.n(r),a=n("i8i4"),s=n.n(a),c=n("mUiD");function l(){return i=document.createElement("div"),document.body.appendChild(i),s.a.render(o.a.createElement(c.a,null),i)}function u(){i&&(s.a.unmountComponentAtNode(i),document.body.removeChild(i),i=null)}},gNEk:function(e,t,n){"use strict";n.d(t,"b",function(){return R}),n.d(t,"d",function(){return N}),n.d(t,"c",function(){return P}),n.d(t,"g",function(){return z}),n.d(t,"f",function(){return H}),n.d(t,"e",function(){return F}),n.d(t,"a",function(){return V});var i=n("lSNA"),y=n.n(i),r=n("J4zp"),E=n.n(r),o=n("RIqP"),O=n.n(o),C=(n("RKCD"),n("FJEn")),a=n("hMnB"),l=n.n(a),k=n("QM+C"),s=n("OX8E"),c=n("jJw9"),u=n("hjac"),d=n("sLU5"),I=n("U5G9"),g=n("HmyT"),m=n("iP/4"),v=n("kmoK"),b=n("ucr6"),S=n("VIFs"),T=n("EzSe"),h=n("U6jp"),f=n("lQZd"),p=n("yGdm"),_=n("M8cP"),w=n("D7h9"),j=n("vc5i"),M=C.utils.getAllAttribKeysFromAline;function L(e,t){var n=e.metaKey,i=e.ctrlKey,r=Object(c.parseAnchorUrl)(t),o=r.isCurDocAnchor,a=r.guid;return o&&(n||i?window.open(t):(e.preventDefault(),v.a.isWiki()&&e.originalEvent&&e.originalEvent.stopImmediatePropagation(),Object(u.a)(a),s.a.emit(d.a.PC.DOCS.EDITOR_JUMP_TO_GUID_POSITION,a))),o}function R(e){var t,n,i,r,o,a,s,c,l,u,d,h,f=1<arguments.length&&void 0!==arguments[1]&&arguments[1],p="A"===e.target.tagName?Object(g.$)(e.target):Object(g.$)(e.currentTarget);"A"===p.prop("tagName")&&(L(e,t=x(p))||(e.preventDefault(),v.a.isWiki()?(r=void 0===(i=(n=new URL(t)).search)?"":i,a=void 0===(o=n.hash)?"":o,e.originalEvent&&e.originalEvent.stopImmediatePropagation(),s=p.data("href")||p.attr("href"),c=v.a.getToken(s).token,l=1===e.button,u=e.ctrlKey&&m.a.isWindows,!v.a.isDocInCurrentSpace(c)||e.metaKey||l||u?(f?Object(T.c):Object(T.b))(t):(d=v.a.getToken(t).token,h=Object(S.prependSpace)("/".concat(k.FILE_TYPE_URL_MAP[k.NUM_SUITE_TYPE.WIKI],"/").concat(d).concat(r).concat(a)),b.a.push(h))):(f?Object(T.c):Object(T.b))(t)))}function N(e){var t,n="A"===e.target.tagName?Object(g.$)(e.target):Object(g.$)(e.currentTarget);"A"===n.prop("tagName")&&(e.preventDefault(),t=x(n),Object(T.b)(t))}function D(t,e,n){try{var i=new URL(t);return i.searchParams.set(e,n),i.href}catch(e){return t}}function x(e){var t=e.data("href")||e.attr("href"),n=v.a.isWiki()?v.a.getWikiUrl(t):t;return Object(S.isSuiteUrl)(n)&&(n=D(n,"from",Object(f.d)()&&Object(h.o)()?k.FROM_SOURCE_TYPE.LARK_ANNOUNTCEMENT:k.FROM_SOURCE_TYPE.PARENT_DOC)),n}function P(e){var t,n;1===e.button&&v.a.isWiki()&&(e.preventDefault(),"A"===(t="A"===e.target.tagName?Object(g.$)(e.target):Object(g.$)(e.currentTarget)).prop("tagName")&&(n=x(t),Object(T.b)(n)))}function B(a,s){var c=0,l=0;if(s)for(;c<s.length&&0===s[c];)c++;function u(e,t){var n,i,r,o;!s||c>=s.length?(a(e,t),l+=e.length):(n=s[c]-l,(i=e.length)<=n?(a(e,t),l+=e.length,n===i&&c++):(r=e,0<n&&(o=r.substring(0,n),a(o,t),l+=n),c++,u(r.substring(n),t)))}return u}var U=function(l,c){k.LINK_REG.lastIndex=0;for(var r,s=null,o=null,u=!1,a=new Map([["(",")"],["[","]"],["{","}"],["<",">"]]),d=null,h=function(){var e=0,t=[],n=!0,i=!1,r=void 0;try{for(var o,a=l[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s,c=o.value;c.insert&&"\n"!==c.insert?(e+=s=c.insert.length,l.getAttributes(e-s,e).find(function(e){var t=E()(e,2),n=t[0];t[1];return n.includes("mention-token")})?t.push([e-s,e]):t.push(null)):t.push(null)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t.filter(Boolean)},f=l.hasLineMarker()?1:0,e=l.getModelText().slice(f,-1),t=function(){s||(s=[],o=[]);var t=r.index+f,n=r[0];g(n,a)&&(n=m(r[0],a));var e,i=(d=d||h()).filter(function(e){return t<e[0]&&t+n.length>=e[0]});if(i.length&&(e=i[0][0],n=n.slice(0,e-t)),d.some(function(e){return t>=e[0]&&t+n.length<=e[1]}))return"continue";s.push([t,n]),o.push(t,t+n.length)};r=k.LINK_REG.exec(e);)t();if(!s)return null;function p(e){return e.map(function(e){return"\\"+e}).join("")}function g(e,t){var n,i=p((n=O()(t.keys())).concat.apply(n,O()(t.values())));return new RegExp("[".concat(i,"]")).test(e)}function m(e,t){for(var n=[],i=e.length,r=e,o=0;o<i;o++){var a=e[o],s=new RegExp("[".concat(p(O()(t.values())),"]")).test(a);if(t.has(a))n.push([t.get(a),o]);else if(s){var c=n.pop();if(!c)return r=e.slice(0,o);if(a!==c[0])return r=n[0]?r=e.slice(0,n[0][1]):e.slice(0,c[1])}}return n.length&&(r=e.slice(0,n[0][1])),r}function v(e,t,n,i){for(var r=0;r<s.length;r++){var o=s[r];if(e>=o[0]&&e<o[0]+o[1].length){if(!n){if(i){k.LINK_REG.lastIndex=0;var a=k.LINK_REG.exec(o[1].substring(t.length));return a?s.splice(r,1,[o[0]+t.length,a[0]]):s.splice(r,1),o[1]}return o[1]}s.splice(r,1),r--}}return!1}var b,n,i=B((b=0,n=function(e,t){t.list&&/code/.test(t.list)&&(u=!0);var n,i=e.length,r=Object.keys(t),o=r.find(function(e){return e.includes("url-")||e.includes("manual")}),a=r.find(function(e){return"removeLink"===e}),s=v(b,e,o,t.removeLink);!s||u||a?c.retain(i):(n="url:",c.retain(i,y()({},n,encodeURIComponent(s)))),b+=i},Object(I.c)(n,I.a.HYPERLINK)),o);l._getOps().forEach(function(e){return i(e.insert,e.attributes||{})})},z=function(y,E){var e=function(e,l,t,r){y.lastIndex=0;for(var o,s=null,a=null,u=!1,c=new Map([["(",")"],["[","]"],["{","}"],["<",">"]]),d=null,h=function(){var e=t.split(/([^+]*\+\w+)/).filter(Boolean),i=0;return e.map(function(e){var t=e.split("+");if(!t)return null;var n=parseInt(t[1],36);return i+=n,M(e,r).join("").includes("mention-token")?[i-n,i]:null}).filter(Boolean)},n=function(){s||(s=[],a=[]);var t=o.index,n=o[0];p(n,c)&&(n=g(o[0],c));var e,i=(d=d||h()).filter(function(e){return t<e[0]&&t+n.length>=e[0]});if(i.length&&(e=i[0][0],n=n.slice(0,e-t)),d.some(function(e){return t>=e[0]&&t+n.length<=e[1]}))return"continue";s.push([t,n]),a.push(t,t+n.length)};o=y.exec(e);)n();if(!s)return l;function f(e){return e.map(function(e){return"\\"+e}).join("")}function p(e,t){var n,i=f((n=O()(t.keys())).concat.apply(n,O()(t.values())));return new RegExp("[".concat(i,"]")).test(e)}function g(e,t){for(var n=[],i=e.length,r=e,o=0;o<i;o++){var a=e[o],s=new RegExp("[".concat(f(O()(t.values())),"]")).test(a);if(t.has(a))n.push([t.get(a),o]);else if(s){var c=n.pop();if(!c)return r=e.slice(0,o);if(a!==c[0])return r=n[0]?r=e.slice(0,n[0][1]):e.slice(0,c[1])}}return n.length&&(r=e.slice(0,n[0][1])),r}function m(e,t,n,i){for(var r=0;r<s.length;r++){var o=s[r];if(e>=o[0]&&e<o[0]+o[1].length){if(!n){if(i){y.lastIndex=0;var a=y.exec(o[1].substring(t.length));return a?s.splice(r,1,[o[0]+t.length,a[0]]):s.splice(r,1),o[1]}return o[1]}s.splice(r,1),r--}}return!1}var v,i,b=(v=0,i=function(e,t,n,i,r){-1!==t.indexOf("list:code")&&(u=!0);var o=e.length,a=t,s=-1<t.indexOf("url-")&&-1===t.indexOf("manual"),c=m(v,e,s,n.removeLink);c&&!u&&(a+=" "+E+":"+c),l(e,a,n,i,r),v+=o},Object(I.c)(i,I.a.HYPERLINK));return C.LineStyleFilter.textAndClassFuncSplitter(b,a)};return Object(I.c)(e,{module:I.a.HYPERLINK})}(k.LINK_REG,"url"),H=U;function F(e){var t=!0,n=!1,i=void 0;try{for(var r,o=p.m[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;if(e.includes(a))return!0}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}var s=Object(_.a)(e);if(-1!==p.k.indexOf(s))return!1;var c=/^https:\/\/[\S]+/;return"http:"===l.a.protocol||c.test(e)}function V(){var e=w.default.getState();return Object(j.k)(e)?Object.assign({},p.b,{tiktok:p.g.tiktok,youtube:p.g.youtube,gmaps:p.g.gmaps}):Object(j.A)(e)?p.g:p.b}},gQL9:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDBweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgNDAgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5UcmlhbmdsZTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSIyLjRfSU3ogYrlpKnpobVf5YWt57G76K+t6Z+z5raI5oGvX+aLluWKqOeKtuaAgSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEzNi4wMDAwMDAsIC02OTUuMDAwMDAwKSIgZmlsbD0iIzE0MUYzMyI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC00LUNvcHkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMyLjAwMDAwMCwgMzIwLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9IkJ1YmJsZS0xLUNvcHkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgwLjAwMDAwMCwgMC4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iR3JvdXAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAxNDMuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxnIGlkPSJHcm91cC0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMjA4LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI0LjAwMDAwMCwgMjQuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEyLDggTDE0LDggQzE0LjU1MjI4NDcsOCAxNSw4LjQ0NzcxNTI1IDE1LDkgTDE1LDMxIEMxNSwzMS41NTIyODQ3IDE0LjU1MjI4NDcsMzIgMTQsMzIgTDEyLDMyIEMxMS40NDc3MTUzLDMyIDExLDMxLjU1MjI4NDcgMTEsMzEgTDExLDkgQzExLDguNDQ3NzE1MjUgMTEuNDQ3NzE1Myw4IDEyLDggWiBNMjYsOCBMMjgsOCBDMjguNTUyMjg0Nyw4IDI5LDguNDQ3NzE1MjUgMjksOSBMMjksMzEgQzI5LDMxLjU1MjI4NDcgMjguNTUyMjg0NywzMiAyOCwzMiBMMjYsMzIgQzI1LjQ0NzcxNTMsMzIgMjUsMzEuNTUyMjg0NyAyNSwzMSBMMjUsOSBDMjUsOC40NDc3MTUyNSAyNS40NDc3MTUzLDggMjYsOCBaIiBpZD0iU2hhcGUiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"},gUre:function(e,t,n){"use strict";n.d(t,"a",function(){return S});var i=n("J4zp"),y=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),c=n("cDf5"),l=n.n(c),u=n("FJEn"),d=n("l2V6"),h=n("4PSP"),f=n("4nzr"),p=n("OX8E"),g=n("4D8z"),E=n("yIs4"),m=n("bTJL"),v=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},O="0",b=-1,C=1,k=u.tableIds.getRowAndColIdFromAttributeValue,I=u.tableIds.getCellIdFromRowAndCol,S=function(){function t(e){o()(this,t),this.className="ViewportObserver",this.inViewTopLine=null,this.inViewBottomLine=null,this.visibleRangeInMainZone=[-1,-1],this.visibleZones=[O],this.controller=new f.a(p.a),this.editor=e,this.scroller=this.editor.getScrollContainer(),this.scroll=new d.a({editor:this.editor,scroller:this.scroller,limit:1,listener:this.handleVisibleRange,isSearchZone:!0}),this.controller.onViewportReady(this.collectViewData),window.addEventListener("resize",this.handleWindowResize)}return s()(t,[{key:"aceEditEvent",value:function(e,t){var n=t.callstack.type;n!==g.e.ADD_COL&&n!==g.e.DELETE_COL||this.collectViewData()}},{key:"reset",value:function(){this.scroll.destroy(),this.controller.offViewportReady(this.collectViewData),this.controller.destroy(),window.removeEventListener("resize",this.handleWindowResize)}},{key:"collectViewData",value:function(){this.scroll&&this.scroller&&this.scroll.collectViewData()}},{key:"handleWindowResize",value:function(){this.collectViewData()}},{key:"isTableLine",value:function(e){var t=this.editor.getRep(O);return Object(m.b)(t,e)}},{key:"getRowAndColIds",value:function(e){var t=this.editor.getAttributeOnLine(O,e,"aceTable"),n=k(t),i=n.rowId,r=n.colId,o=this.editor.vectorReps;return{rowIds:o[i].vectorIds,colIds:o[r].vectorIds}}},{key:"findFirstUnmergedRowIndex",value:function(e,t,n,i){var r=this.getRowAndColIds(e),o=r.rowIds,a=r.colIds[n],s=I(o[t],a);if(!this.editor.plugins.table.isMergedCell(s))return t;for(var c=t+i;c<o.length&&0<=c;){var l=I(o[c],a);if(!this.editor.plugins.table.isMergedCell(l)||!this.editor.plugins.table.isInSameMergedCell([s,l]))break;c+=i}return c-i}},{key:"collectTableZones",value:function(e,t){var n=this.getRowAndColIds(e),i=n.rowIds,r=n.colIds,o=[];if(!i.length||!r.length)return o;for(var a=0;a<r.length;a++)for(var s=this.findFirstUnmergedRowIndex(e,t[0],a,b),c=this.findFirstUnmergedRowIndex(e,t[1],a,C),l=s;l<=c;l++){var u=I(i[l],r[a]);u&&o.push(u)}return o}},{key:"getLineRange",value:function(e,t){return this.scroll.getLineNumberRange(e,t)}},{key:"getVisibleZones",value:function(e){var t=[e.overViewLineNu,e.underViewLineNu],n=[e.overViewLine,e.underViewLine];return this.collectVisibleZones(t,n),this.visibleZones}},{key:"collectVisibleZones",value:function(e,t){var n,i=e||this.visibleRangeInMainZone,r=y()(i,2),o=r[0],a=r[1],s=t||[],c=y()(s,2),l=c[0],u=void 0===l?this.inViewTopLine:l,d=c[1],h=void 0===d?this.inViewBottomLine:d,f=u&&Object(E.default)(u.selRowIndex),p=h&&Object(E.default)(h.selRowIndex),g=o,m=a;if(this.visibleZones=[O],o===a&&f&&p)this.visibleZones=this.visibleZones.concat(this.collectTableZones(o,[u.selRowIndex,h.selRowIndex]));else{f&&(n=this.getRowAndColIds(o).rowIds,this.visibleZones=this.visibleZones.concat(this.collectTableZones(o,[u.selRowIndex,n.length-1])),g++),p&&(this.visibleZones=this.visibleZones.concat(this.collectTableZones(a,[0,h.selRowIndex])),m--);for(var v,b=g;b<=m;b++)this.isTableLine(b)&&(v=this.getRowAndColIds(b).rowIds,this.visibleZones=this.visibleZones.concat(this.collectTableZones(b,[0,v.length-1])))}}},{key:"triggerViewportChange",value:function(){var e;this.editor&&(e={visibleRangeInMainZone:this.visibleRangeInMainZone,visibleZones:this.visibleZones,visibleLineZone:[this.inViewTopLine,this.inViewBottomLine]},this.editor.hook.callAll("viewportChange",e),this.editor.call("viewportChange",e))}},{key:"updateLineZone",value:function(e,t){var n=e.lineNumInMainZone,i=e.selRowIndex,r=this.getRowAndColIds(n),o=r.rowIds,a=r.colIds,s=this.findFirstUnmergedRowIndex(n,i,0,t),c=I(o[s],a[0]);e.selRowIndex=s,e.selZone=c}},{key:"updateInViewLineZoneIfNecessary",value:function(){var e=this.inViewTopLine&&Object(E.default)(this.inViewTopLine.selRowIndex),t=this.inViewBottomLine&&Object(E.default)(this.inViewBottomLine.selRowIndex);e&&this.updateLineZone(this.inViewTopLine,b),t&&this.updateLineZone(this.inViewBottomLine,C)}},{key:"handleVisibleRange",value:function(e){var t,n;e&&(t=e.inViewTopLine,n=e.inViewBottomLine,this.inViewTopLine=Object.assign({},t),this.inViewBottomLine=Object.assign({},n),this.visibleRangeInMainZone=[t.lineNumInMainZone,n.lineNumInMainZone],this.collectVisibleZones(),this.updateInViewLineZoneIfNecessary(),this.triggerViewportChange())}},{key:"getVisibleRange",value:function(){return this.visibleRangeInMainZone}},{key:"getVisibleLineZone",value:function(){return[this.inViewTopLine,this.inViewBottomLine]}}]),t}();v([Object(h.Bind)()],S.prototype,"collectViewData",null),v([Object(h.Bind)(),Object(h.Debounce)(200)],S.prototype,"handleWindowResize",null),v([Object(h.Bind)()],S.prototype,"handleVisibleRange",null),v([Object(h.Bind)()],S.prototype,"getVisibleRange",null),v([Object(h.Bind)()],S.prototype,"getVisibleLineZone",null)},"gX+J":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),u=n("HmyT"),s=n("YNKm"),c=(n("6JVS"),n("y2sV")),l=function(){function t(e){var l=this;r()(this,t),this.regist=function(e){e.registerAceCommand(s.TEMPLATEINBLOCK,function(e,t){t.doInsertTemplateBlock()},{statusKey:null})},this.aceInitialized=function(e,t){var n=t.editorInfo.getClientVars();l.isTemplate=n&&n.is_template,l.isTemplate&&l.bindEvent(),l._editorInfo=t.editorInfo,l._editorInfo.doInsertTemplateBlock=l.doInsertTemplateBlock,l.regist(l._editorInfo)},this.handleMouseDownOnMagicDom=function(e){var t,n,i,r,o,a,s,c;l.isTemplateBlockLine(e.currentTarget)&&(t=l._editorInfo,e.preventDefault(),n=-1,i=1,r=e.offsetX<=40?n:i,o=Object(u.$)(e.currentTarget).index()+r,s=(a=t.getRep()).lines.atIndex(o),c=r===n?s.text.length:s.lineMarker,t.selection.setWithSelection(a.zoneId,[o,c],[o,c],!1),t.updateBrowserSelectionFromRep(!0))},this.doInsertTemplateBlock=function(){for(var e=l._editorInfo,t=e.getRep(),n=t.selStart[0];n<=t.selEnd[0];++n)e.setAttributeOnLine(t.zoneId,n,"template","block")},this.aceAttribsToClasses=function(e,t){if("template"===t.key)return l.isTemplate=!0,"template-".concat(t.value)},this.aceDomLineProcessLineAttributes=function(e,t){var n=t.spanClass;/(?:^| )template-block/.exec(n)&&(t.lineClass+=" template-block",t.processedMarker=!0)},this.acePostWriteDomLineHTML=function(e,t){var n=t.node;l.isTemplateBlockLine(n)&&(n.setAttribute?n.setAttribute("contenteditable","false"):n.editable=!1)},e&&(this.editor=e,this.aceInitialized("",Object.assign({editorInfo:e},e)))}return a()(t,[{key:"reset",value:function(){this.removeEvent(),this.editor=null,this._editorInfo=null}},{key:"bindEvent",value:function(){this.removeEvent(),Object(u.$)("#innerdocbody").delegate('div[id^="magicdomid"]',"mousedown",this.handleMouseDownOnMagicDom)}},{key:"removeEvent",value:function(){Object(u.$)("#innerdocbody").undelegate('div[id^="magicdomid"]',"mousedown",this.handleMouseDownOnMagicDom)}},{key:"isTemplateBlockLine",value:function(e){return-1<e.className.indexOf("template-block")||-1<e.className.indexOf("template-abstract")}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;return t instanceof HTMLElement&&-1<t.className.indexOf("template-block")?Object(c.I)(n,i,{template:"block"}):n}}]),t}()},gaI2:function(e,t,n){},gpFw:function(e,l,u){"use strict";(function(n){u.d(l,"a",function(){return s});var e=u("hMnB"),t=u.n(e),i=u("q1tI"),r=u.n(i),o=u("q4SO"),a=u("Ngi8");function s(e){var t=e.loginText;return r.a.createElement("a",{onClick:c,style:{color:a.B500}},t||n("anonymous.login"))}function c(){Object(o.c)(t.a.href)}}).call(this,u("2vAP"))},gpLn:function(e,t){e.exports=navigator.cdn_host+"/ccm/pc/web/resource/bear/images/many-users-avatar.svg"},gpe9:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return f});var y,i,r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),c=n("i8i4"),l=n.n(c),u=n("+KmE"),d=n("iP/4");(i=y=y||{})[i.TOP=0]="TOP",i[i.BOTTOM=1]="BOTTOM";var E=4.5,O=8,C=64,h=3.5,k=-2,f=function(){function n(){var b=this,e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];o()(this,n),this.autoHide=e,this.mountedNode=null,this.handleShowPopup=null,this.handleHidePopup=null,this.visible=!1,this.rep=null,this.liElement=null,this.oListInfo=null,this.magicDomId=null,this.handlers={},this.getNumberRect=function(){if(!b.mountedNode||!b.liElement)return null;var e=b.numberWidth,t=b.mountedNode.getBoundingClientRect(),n=t.left,i=t.top,r=b.liElement.getBoundingClientRect(),o=r.left,a=r.top,s=parseInt(window.getComputedStyle(b.liElement).lineHeight||"0",10),c=parseInt(window.getComputedStyle(b.liElement,"::before").height||"0",10),l=0<c?(s-c)/2:h;return{top:a-i+l,left:b.getNumberLeft(o,e)-n+k,width:e,height:0<c?c:s-2*l}},this.calcRenderStyle=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:y.BOTTOM,i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r={};if(!b.mountedNode||!b.liElement)return r;var o=b.numberWidth,a=b.mountedNode.getBoundingClientRect(),s=a.left,c=a.top,l=b.liElement.getBoundingClientRect(),u=l.left,d=l.top,h=b.getNumberLeft(u,o),f=parseInt(window.getComputedStyle(b.liElement).lineHeight||"0",10),p=d+f,g=window.innerHeight-p,m=d-C,v=e+E+O;return r.left=h-s+k,i&&(r.left=h-s+k-t/2+o/2,r.left+s<0&&(r.left=O-s)),n===y.BOTTOM?r.top=d-c+f+E:r.top=d-c-e-E,n===y.BOTTOM&&g<v&&v<=m?r.top=d-c-e-E:n===y.TOP&&m<v&&v<=g&&(r.top=d-c+f+E),r},this.popupContainerRef=function(e){e.addEventListener("mousemove",function(e){return e.stopPropagation()})},this.hidePopup=function(){b.visible&&b.mountedNode&&(l.a.unmountComponentAtNode(b.mountedNode),b.rep=null,b.oListInfo=null,b.liElement=null,b.visible=!1,b.autoHide&&document.removeEventListener("click",b.hidePopup),b.handleHidePopup&&b.magicDomId&&b.handleHidePopup(b.magicDomId))};var t=document.getElementsByClassName("doc-popup-container")[0];t&&(this.mountedNode=document.createElement("div"),t.appendChild(this.mountedNode))}return s()(n,[{key:"getNumberLeft",value:function(e,t){if(!this.liElement)return e;var n=window.getComputedStyle(this.liElement).textAlign,i=e;if("center"===n||"right"===n){var r=this.liElement.firstElementChild;if(!r)return e;i=r.getBoundingClientRect().left-t}return i}},{key:"updateMagicDomId",value:function(){var e;this.liElement&&this.rep&&((e=this.rep.repManager.editor.dom.getAceLineForNode(this.liElement))&&(this.magicDomId=e.id))}},{key:"showPopup",value:function(e,t){var n;this.liElement===t||(n=Object(u.l)(e,t))&&this.mountedNode&&(this.hidePopup(),this.rep=e,this.oListInfo=n,this.liElement=t,this.updateMagicDomId(),this.render(this.mountedNode),this.visible=!0,this.autoHide&&document.addEventListener("click",this.hidePopup),this.handleShowPopup&&this.magicDomId&&this.handleShowPopup(this.magicDomId))}},{key:"registerHandler",value:function(e,t){this.handlers[e]=t}},{key:"onShow",value:function(e){this.handleShowPopup=e}},{key:"onClose",value:function(e){this.handleHidePopup=e}},{key:"getVisible",value:function(){return this.visible}},{key:"getLineNum",value:function(){return this.oListInfo?this.oListInfo.lineNum:null}},{key:"numberWidth",get:function(){if(!this.liElement)return 0;var e=parseInt(window.getComputedStyle(this.liElement,"::before").width,10)||0;return d.a.isEdge&&this.liElement.firstChild&&(e=this.liElement.firstChild.getBoundingClientRect().left-this.liElement.getBoundingClientRect().left),e}}]),n}()},gq0T:function(e,t,n){"use strict";n.d(t,"l",function(){return h}),n.d(t,"f",function(){return f}),n.d(t,"g",function(){return p}),n.d(t,"i",function(){return g}),n.d(t,"c",function(){return m}),n.d(t,"d",function(){return v}),n.d(t,"b",function(){return b}),n.d(t,"h",function(){return y}),n.d(t,"e",function(){return E}),n.d(t,"k",function(){return O}),n.d(t,"j",function(){return C}),n.d(t,"a",function(){return k});var i=n("J4zp"),c=n.n(i),r=n("lSNA"),l=n.n(r),o=n("RIqP"),a=n.n(o),s=n("fujP"),u=n("DNsP"),d=n("EDbJ");n("FEfn");function h(e){if(window.localStorage)try{localStorage.setItem(u.m,JSON.stringify(e))}catch(e){console.error("setting highlight color failed. ",e)}}function f(){if(window.localStorage)try{return localStorage.getItem(u.m)}catch(e){return console.info("localStorage get error from highlight: ".concat(e)),null}return null}function p(e){return u.h.has(e)}function g(e){return e===u.e[u.d]||e===u.d}function m(e){return new RegExp("(^| )(".concat(e,"):(rgba?.*?\\))"),"g")}function v(){var t=a()(u.t.map(function(e){return Object(d.a)(e)}));Object.values(u.f).forEach(function(e){return t.push.apply(t,a()(e.map(function(e){return b(e)})))});var e=a()(u.k.values());return new Set(t.concat(e))}function b(e){return e.replace(/\s+/g,"")}var y=function(e){if(!e)return!1;var t=e.style,n=t.color,i=t.backgroundColor;return!!n&&!Object(d.b)("text",n)||!!i&&!Object(d.b)("background",i)};function E(e){var t,a=(t={},l()(t,u.a.BACKGROUND,{type:"background",count:0,value:null}),l()(t,u.a.TEXT,{type:"text",count:0,value:null}),t);Object.keys(e).forEach(function(e){var t=e.split("-"),n=c()(t,2),i=n[0],r=n[1],o=a[i];o&&(++o.count,o.value=r)});var s=null;return Object.entries(a).forEach(function(e){var t=c()(e,2),n=(t[0],t[1]),i=n.type,r=n.count,o=n.value;1===r&&o&&u.h.has(o)&&(s=Object.assign({},s,l()({},i,o)))}),s}function O(){var e={},t=document.queryCommandValue("backColor"),n=document.queryCommandValue("foreColor");return Object(d.b)("background",t)||(e.background=t),Object(d.b)("text",n)||(e.text=n),Object(s.default)(e)?null:e}var C=function(t){return u.s.some(function(e){return-1<t.indexOf("block-type-".concat(e))||-1<t.indexOf("image-uploaded")||-1<t.indexOf("ace-table-mount-point")})};function k(t){return!!(t.aceTable||t.gallery||t.dataMetaBlockProps&&u.s.some(function(e){return t.dataMetaBlockProps.includes(e)}))}},grVa:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("hbEN"),p=n("BScZ"),g=n("Vor4"),m=n("8kCL"),E=n("SCx9"),O=n("H6oK"),v=n("OX8E"),C=n("Z/PY"),b=n("xYHj"),k=n("kESg"),I="client_performance_doc_handle_resize_comment_list",y=function(e){function t(e){var y;return r()(this,t),(y=c()(this,u()(t).call(this,e))).tops=new Map,y.notify=null,y.logger=new g.a,y.commentToDisplayComment=function(e,t){var n,i=e.commentId,r=e.serviceType,o=e.serviceToken,a=e.isSubmitted,s=e.visible,c=e.quote,l=e.docPositions,u=y.keyOfComment(e),d=y.editor.getRep(l[0].selZone),h=l[0].selStart[0],f=y.tops.get(u);return!s&&0!==t||void 0!==f||(n=y.getRectByCommentId(r,o,i,0))&&(f=n.top,Object(b.e)(d,h)&&(f+=k.j),y.tops.set(u,f)),{commentId:i,serviceType:r,serviceToken:o,isSubmitted:a,top:f,visible:s,quote:c,line:h}},y.getTopBySelection=function(e,t){return y.editor.getLineTop(e,t)},y.handleLogPositionUpdate=function(){var e=y.attributeManagerController.getPositions({groupId:"comment"});y.logger.logPositionUpdate(e,y.comments)},y.handleResize=Object(f.default)(function(e){y.reizeComment(e)},100),y.handleResizeComment=function(e,t){t?y.reizeComment(e):y.handleResize(e)},y.reizeComment=function(e){var t=y.editor;t.profile&&t.profile.start(I);var n=y.comments.some(function(e){var t=e.commentId,n=e.serviceType,i=e.serviceToken,r=e.visible,o=y.keyOfComment(e);if(r){var a=y.getRectByCommentId(n,i,t,0);return!a||a.top!==y.tops.get(o)}return!1});n&&(y.tops.clear(),y.renderComments([],{source:"",forceUpdate:n})),y.logger.logPcUpdateComments(e),t.profile&&t.profile.end(I,{minimumUsedTime:20})},y.detectActiveComment=function(e){var t=y.getCoveredCommentBySelection(e);if(!t)return y.deactivateComment(),void(y.notify&&y.notify(E.c.CLEAR_ACTIVE_COMMENT,void 0));var n=t.comment,i=t.matchedSelection,r=n.serviceType,o=n.serviceToken,a=n.commentId,s=n.relativeTopToThirdParty,c=i.selStart,l=i.selZone,u=y.getTopBySelection(l,c)+(s||0),d=y.getCurrentActiveComment();if(!(d&&y.isSameComment(n,d))){d&&y.deactivateComment();var h=y.editor.getDocBody();if(window.getSelection()){var f=$(window.getSelection().focusNode),p=[".bitable-editor-container"].join(",");if(0!==f.parents("#"+h.id).length||0!==f.parents(p).length||f.is(p)){var g=y.editor.selection.getSelection(),m=y.editor.getEntities(g);if(1===m.length){var v=m[0];if(v.attributes&&v.attributes.dataMetaBlockProps){var b=Object(C.C)(v.attributes.dataMetaBlockProps);if(b&&b.blockType===O.BlockType.IFRAME_BLOCK)return}}y.activateComment(r,o,a,function(){y.notify&&y.notify(E.c.CLICK_COMMENT_ON_DOC,{serviceType:r,serviceToken:o,commentId:a,activeTop:u})})}}}},y.onNotify=function(e){y.notify=e},y.handleEventBinding("on"),y.highlight=new m.a,y.attributeManagerController.onPositionsUpdate(y.handleLogPositionUpdate),y}return h()(t,e),a()(t,[{key:"handleEventBinding",value:function(e){}},{key:"hasCommentInComments",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e.values()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)return 0<r.value.length}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return!1}},{key:"beforeCommentsUpdate",value:function(e){var s=this,c=e.comments,t=e.newComments,n=e.addedComments,i=e.deletedComments,l=!1;(this.hasCommentInComments(n)||this.hasCommentInComments(i))&&(l=!0);var r=this.getCurrentActiveComment();return i.forEach(function(e){e.forEach(function(e){var t=e.serviceType,n=e.serviceToken,i=e.commentId;s.tops.delete(s.keyOfComment({serviceType:t,serviceToken:n,commentId:i})),r&&s.isSameComment(e,r)&&s.deactivateComment()})}),t.forEach(function(t){var e,n,i,r,o,a=c.find(function(e){return s.isSameComment(e,t)});a?(a.visible!==t.visible?l=!0:t.visible&&(e=a.docPositions[0],n=t.docPositions[0],i=e.selZone===n.selZone,r=Object(p.e)(e.selStart,n.selStart),o=Object(p.e)(e.selEnd,n.selEnd),i&&r&&o||(l=!0)),l&&s.tops.delete(s.keyOfComment(t))):l=!0}),l}},{key:"onPositionInited",value:function(){this.notify&&this.notify(E.c.COMMENT_FIRST_START_LOADING,0<this.comments.length)}},{key:"onCommentResized",value:function(e){this.handleResize(e)}},{key:"onCommentDeleted",value:function(){}},{key:"onThirdPartyError",value:function(){}},{key:"onThirdPartyStartLoading",value:function(e){0!==e.length&&this.notify&&this.notify(E.c.THIRD_PARTY_LOADIND,e)}},{key:"onThirdPartyLoaded",value:function(e){0!==e.length&&this.notify&&this.notify(E.c.THIRD_PARTY_LOADED,e)}},{key:"onDestroy",value:function(){this.tops.clear(),this.handleEventBinding("off"),this.handleResize.cancel()}},{key:"onThirdPartyActiveCommentChanged",value:function(e){var t=e?Object.assign({},e,{zoneId:e.selZone}):this.editor.getRep(),n=t.selStart,i=t.selEnd,r=t.zoneId;n&&i&&r&&this.detectActiveComment({selStart:n,selEnd:i,selZone:r})}},{key:"getLineTop",value:function(e,t){return this.editor.getLineTop(e,t)}},{key:"getActiveTop",value:function(){var e=this.getCurrentActiveComment();if(!e)return null;var t=this.editor.getRep(),n=t.selStart,i=t.selEnd,r=t.zoneId;if(!n||!i||!r)return null;var o={selStart:n,selEnd:i,selZone:r},a=this.getCoveredCommentBySelection(o);if(!a)return null;var s=a.comment;if(!this.isSameComment(s,e))return null;var c=s.relativeTopToThirdParty;return this.getTopBySelection(r,n)+(c||0)}},{key:"emitInvakeCollapse",value:function(e,t,n){v.a.emit("invokeCollapse",{zoneId:n,range:{selStart:e,selEnd:t},source:"activateMention"})}},{key:"renderComments",value:function(e,t){var n=this.comments.map(this.commentToDisplayComment),i=this.getActiveTop();this.notify&&this.notify(E.c.RENDER_COMMENTS,Object.assign({commentIds:e,activeTop:i,allComments:n,allMessages:n},t))}}]),t}(p.a);t.a=y},gt4j:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTkuNDM1MDQgOC4yOTYxM0w1LjY0NTY1IDEyLjQyOTlMOS4yMjQ5MiAxNi41NjQ1QzkuMzUyMTIgMTYuNzExNSA5LjM0NTk4IDE2LjkzMTIgOS4yMTA3OCAxNy4wNzA5TDguNzE5OTcgMTcuNTc3NkM4LjU3NTg5IDE3LjcyNjQgOC4zMzg0OCAxNy43MzAyIDguMTg5NzEgMTcuNTg2MUM4LjE4MjMyIDE3LjU3OSA4LjE3NTIyIDE3LjU3MTUgOC4xNjg0NCAxNy41NjM4TDMuODk1MSAxMi42ODI3QzMuNzY5MTQgMTIuNTM4OCAzLjc3MTYxIDEyLjMyMzIgMy45MDA4MiAxMi4xODIzTDguMzkxODcgNy4yODMwNUM4LjUzMTgyIDcuMTMwMzggOC43NjkwMyA3LjEyMDA3IDguOTIxNyA3LjI2MDAxQzguOTI3MTggNy4yNjUwNCA4LjkzMjUxIDcuMjcwMjIgOC45Mzc2OCA3LjI3NTU2TDkuNDI3OTkgNy43ODE4NEM5LjU2NjA1IDcuOTI0NCA5LjU2OTE0IDguMTQ5ODQgOS40MzUwNCA4LjI5NjEzWk0xOC40NjI4IDEyLjQyOTlMMTQuODM5NCA4LjI5NTUxQzE0LjcxMDcgOC4xNDg2OSAxNC43MTYyIDcuOTI3NyAxNC44NTIgNy43ODc0NkwxNS4zNDI3IDcuMjgwNzZDMTUuNDg2OCA3LjEzMTk4IDE1LjcyNDIgNy4xMjgxOCAxNS44NzMgNy4yNzIyNkMxNS44Nzk5IDcuMjc4OTkgMTUuODg2NiA3LjI4NiAxNS44OTMgNy4yOTMyNUwyMC4yMTEgMTIuMTc3QzIwLjMzODIgMTIuMzIwOCAyMC4zMzYyIDEyLjUzNzMgMjAuMjA2NSAxMi42Nzg4TDE1LjcxNjYgMTcuNTc2OEMxNS41NzY3IDE3LjcyOTUgMTUuMzM5NCAxNy43Mzk4IDE1LjE4NjggMTcuNTk5OEMxNS4xODEzIDE3LjU5NDggMTUuMTc2IDE3LjU4OTYgMTUuMTcwOCAxNy41ODQzTDE0LjY4MDUgMTcuMDc4QzE0LjU0MjQgMTYuOTM1NCAxNC41MzkzIDE2LjcxIDE0LjY3MzQgMTYuNTYzN0wxOC40NjI4IDEyLjQyOTlaTTEyLjc1MjMgNC4wODE2OEwxMy40OTczIDQuMTY4M0MxMy43MDMgNC4xOTIyMiAxMy44NTA0IDQuMzc4MzkgMTMuODI2NSA0LjU4NDExTDEyLjAzODEgMTkuOTY0MUMxMi4wMTQyIDIwLjE2OTggMTEuODI4IDIwLjMxNzIgMTEuNjIyMyAyMC4yOTMzTDEwLjg3NzMgMjAuMjA2N0MxMC42NzE2IDIwLjE4MjggMTAuNTI0MiAxOS45OTY2IDEwLjU0ODEgMTkuNzkwOUwxMi4zMzY1IDQuNDEwODVDMTIuMzYwNCA0LjIwNTEzIDEyLjU0NjYgNC4wNTc3NiAxMi43NTIzIDQuMDgxNjhaIiBmaWxsPSIjMkIyRjM2Ii8+Cjwvc3ZnPgo="},gviE:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("J4zp"),a=n.n(i),s=n("q1tI"),c=n("RxHm");function r(t){var e=Object(s.useState)(navigator.onLine),n=a()(e,2),i=n[0],r=n[1],o=Object(s.useCallback)(function(e){r(e.connected),"function"==typeof t&&t(e)},[]);return Object(s.useEffect)(function(){return c.b.isWatching||c.b.watch(),c.b.on(o),function(){c.b.off(o)}},[]),[i]}},gvyE:function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{})[r.WAITING=-1]="WAITING",r[r.PROCESSING=0]="PROCESSING",r[r.SUCCESS=1]="SUCCESS",r[r.FAILED=2]="FAILED",r[r.ERROR=3]="ERROR"},h6Hi:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBvcGFjaXR5PSIwLjQiIGN4PSIzMCIgY3k9IjMwIiByPSIzMCIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg=="},hBgL:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"f",function(){return i});var i,r,o="ace-table-toolbar-popover",a=8,s=32,c=a+s,l=8;(r=i=i||{}).Row="row",r.Column="col"},hJmJ:function(e,t,n){"use strict";n.d(t,"b",function(){return ee}),n.d(t,"c",function(){return te}),n.d(t,"a",function(){return ie});var i,r,o=n("lSNA"),d=n.n(o),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),l=n.n(c),u=n("U+yc"),h=n.n(u),f=n("RIqP"),p=n.n(f),g=n("ukIz"),m=n("hbEN"),v=n("XhtD"),b=(n("lTlB"),n("YWBl")),y=n("7Kxq"),E=n("F9bh"),O=n("LFUy"),C=n("q1tI"),k=n.n(C),I=n("i8i4"),S=n.n(I),T=n("PCTH"),_=n("HmyT"),w=n("OX8E"),j=n("elsr"),M=n("puQj"),L=n.n(M),R=n("SGN9"),N=n("G8Hj"),D=n("UeI0"),x=n("+0ye"),P=n("SyrE"),B=n("Trbk"),U=n("2ACu"),z=n("y2sV"),H=n("Poi8"),F=n("PcuH"),V=n("182n"),W=n("YNKm"),K="DocHeading",Z=j.b.PREFIX_LOCAL,q="0",Y=[].concat(p()(V.a),["code"]),J={24:"h1",20:"h2",18:"h3"},Q="heading",X="collapse",$="heading",ee="IGNORE_HEADING",te="MAX_HEADING_LEVEL_CHANGE";function ne(e,t){return-1<e.indexOf(t)}var ie=(i=Object(E.a)({ignoreAttrs:[["aceTable"]]}),r=function(){function n(e,t){var h=this;s()(this,n),this.className="Heading",this.needUpdateCollapse=!1,this.headingCount={},this.headingMaxLevel=1,this.lineNumberForPaste=-1,this.lineForPasteIsCollapse=null,this.bindEvent=function(){h.removeEvent(),Object(_.$)(h.editor.getInnerContainer()).on("mouseenter",'[class*="collapsable-section-handle"]',h.onBoarding),P.g.on("".concat(B.g,":").concat(K),h.onVCFollowHandler),h.editor&&h.editor.eventEmitter.on("lineTrackerUpdate",h.lineTrackerUpdateHandler),Object(U.default)("bind_vc_event",{module:K,operation:"on"})},this.lineTrackerUpdateHandler=function(e){var t,n;e.dirtyLines.length&&(t=e.dirtyLines[0].lineNum,n=e.dirtyLines[0].output.startOfCollapseSection,w.a.emit(B.a,{module:K,actionType:"DocHeadingToggle",data:{lineNum:t,isCollapse:n}}))},this.onBoarding=function(e){var t=Object(_.$)(e.target),n=t.hasClass("collapsable-section-handle")?t:t.closest(".collapsable-section-handle"),i="toggle-heading-btn"===n.attr("data-selector");n.length&&0===h.guideCount&&!i&&(n.attr("data-selector","toggle-heading-btn"),Object(R.b)(N.STEP_TYPES.toggle_heading_intro),h.guideCount++)},this.removeEvent=function(){Object(_.$)(h.editor.getInnerContainer()).off("mouseenter",'[class*="collapsable-section-handle"]',h.onBoarding),P.g.off("".concat(B.g,":").concat(K),h.onVCFollowHandler),h.editor&&h.editor.eventEmitter.off("lineTrackerUpdate",h.lineTrackerUpdateHandler),Object(U.default)("bind_vc_event",{module:K,operation:"off"})},this.onHeadingMaxLevel=function(e){h.headingMaxLevel=e},this.getHeadingMaxLevel=function(){return h.headingMaxLevel},this.checkCollapse=function(e){var t,n,i=e.dom,r=e.multiRange,o=e.range,a=e.zoneId,s=e.source;h.editor&&(t=o,n=a||"",i&&(t=h.editor.domToRep(i),n=t.selStart[2]),n&&t&&h.notifyCollapse({sel:[t.selStart,t.selEnd],selZone:n,source:s}),n&&r&&r.forEach(function(e){h.notifyCollapse({sel:[e.start,e.end],selZone:n,source:s})}))},this.getTargetLineHTML=function(e,t,n,i){var r=h.editor.getRep(e).lines.atIndex(t);if(!r||!r.lineNode)return"";var o=document.createRange(),a=h.editor.selection.getPointForChatAtLeafNode(r,n,!0);return i&&r.lineNode.previousSibling?(o.setStart(r.lineNode.previousSibling,0),o.setEnd(a.node,a.index),o.cloneContents().lastChild.outerHTML):!i&&r.lineNode.nextSibling?(o.setStart(a.node,a.index),o.setEnd(r.lineNode.nextSibling,0),o.cloneContents().firstChild.outerHTML):""},this.isSelectionContainsCollapsedLine=function(t,e,n){return t===j.a&&(h.editor.lineTracker.collapseLines&&Object(v.a)(e[0],n[0]+1).some(function(e){return h.checkIsLineCollapsed(t,e)}))},this.aceCutRangeReplaceSeletion=function(e,t){var n=t.range,i=t.rep;i.attributeManager.getAttributeOnLine(i.selEnd[0],"heading")&&2===n.length&&h.cutCollapseRange(n)},this.cutCollapseRange=function(e){var t=h.editor.performDocumentReplaceRangeWithAttributes,n=[e[0],0],i=e[1],r=h.editor.getRep(),o=[i,r.lines.atIndex(i).text.length];t(r.zoneId,n,o,"",[])},this.notifyCollapse=function(e){var t,n,i,r,o,a=e.sel,s=e.selZone,c=e.source,l=h.editor;l&&(t=a[0],n=a[1],i=[],o=t[0],r=n[0],s!==q&&(o=r=l.getLineNumInRootZone(s,t)),i.push(o,r),i=p()(new Set(i)),Object(D.a)(l,q,i,c))},this.aceDoDeleteKey=function(e,t){var n,i,r=t.editor,o=t.rep,a=t.caretLine;r.isCaret()&&(n=a(),i=o.lines.atIndex(n),o.selStart[1]===i.lineMarker||h.handleDeleteCollapse(r,o,n))},this.editorAfterDoDeleteKey=function(e,t){var n=t.editor,i=n.getRep(),r=i.selStart[0];h.handleDeleteCollapse(n,i,r)},this.handleDeleteCollapse=function(e,t,n){var i,r,o,a=e.getContentState().getActiveZone().getLine(n),s=a.getLineAttributes().toMap();s.list&&s.list.includes("code")||(i=Boolean(s.heading),a.isEmpty()||(r=Object(D.b)(s),(i||r)&&(o=Object(T.e)(n,t),h.editor.getAttributeOnLine(j.a,n,X)&&Object(T.d)(e,o,!0,e.isEditable(),!1))))},this.aceRegisterBlockElements=function(){return Y},this.init=function(t){[W.r].concat(V.a).forEach(function(e,a){t.registerAceCommand(e,function(e,t,n,i){var r=i.source,o=h.doInsertHeading({attribKey:Q,attribValue:"h".concat(a)});Object(b.a)({action:"heading-h".concat(a),op:o?y.g:y.f,source:r})},{statusKey:"heading-h".concat(a)})})},this.onVCFollowHandler=function(e){var t,n,i,r=e.actionType,o=e.data;"DocHeadingToggle"===r&&h.editor&&(t=o.lineNum,n=o.isCollapse,(i=h.editor.getRep().lines.atIndex(t))&&i.domInfo.isCollapsedHeading()!==n&&i.lineNode.querySelector(".collapsable-section-handle").click())},this.handleClick=function(t){t.data.context.ace.callWithAce(function(e){h.doInsertHeading({attribKey:Q,attribValue:"h".concat(t.data.headingType+1)})},"insertheading",!0)},this.aceAttribsToClasses=function(e,t){return t.key===Q?["heading:".concat(t.value)]:t.key===X&&"true"===t.value?["".concat(X,"-all:true")]:t.key==="".concat(Z).concat(X)&&"false"===t.value?["collapse-onlymenot:true"]:t.key==="".concat(Z).concat(X)&&"true"===t.value?["collapse-onlyme:true"]:void 0},this.willChangesetApply=function(e,t){var n=t.editor,i=t.changeset,r=[],o=n.getApool();n.changesetHelper.eachAttribNumber(i,function(e){r.push(o.getAttribKey(e))}),h.needUpdateCollapse=r.find(function(e){return e===$})},this.editorAlinesDidSplice=function(e,t){var n,i,r=t.start,o=t.deleteCount,a=t.prevState,s=t.currentState,c=t.editor,l=t.zoneId;h.needUpdateCollapse||(i=(n=c.callStack.getCurrentCallStack())&&n.type===T.a,h.needUpdateCollapse=i||h.hasKey(a.numToAttrib,X)||h.hasKey(s.numToAttrib,X)||h.hasKey(a.numToAttrib,$)&&!h.hasKey(s.numToAttrib,$)),c.lineTracker.splice(l,r,o,s.alinesSplice);var u,d=h.getHeadingCountChange(a,s);for(u in d)h.headingCount[u]=(h.headingCount[u]||0)+d[u];h.notifyHeadingCountChange()},this.notifyHeadingCountChange=Object(m.default)(function(){for(var e=1,t=9;1<=t;t--){var n="h".concat(t);if(h.headingCount[n]){e=t;break}}h.headingMaxLevel!==e&&h.editor&&h.editor.call(te,e),h.headingMaxLevel=e},200),this.hasKey=function(e,t){if(e)for(var n in e)if(e[n][0]===t)return!0;return!1},this.aceCreateDomLine=function(e,t){var n=t.lineClass,i=t.text,r=t.index,o=t.zoneId;h.checkIsLineCollapsed(o,r)&&!n.includes("ace-line-collapsed")&&(t.lineClass+=" ace-line-collapsed");var a=Object(x.a)(n),s=h.editor.getRep().zoneId!==q,c=ne(n,"list-code");if(a&&!s&&h.hasCollapse&&!c){var l=t.spanClass,u=[];if(ne(n,y.b)&&(t.lineClass=t.lineClass.replace(/heading-h\d/,"")),l.replace(/(^| )collapse((-)*[a-z]{0,9}):true/g,function(e,t,n){u.push("collapse".concat(n)),l=l.replace(e,"")}),u.length)return t.spanClass="".concat(l),void(t.lineClass="".concat(t.lineClass," ").concat(u.join(" ")));l||u.length||""!==i||!1===t.collapseStatus.collapseOnlyMe&&(t.lineClass="".concat(t.lineClass," collapse-onlymenot"))}},this.acePreWriteDomLineHTML=function(e,t){var n,i,r,o,a,s,c;t.info&&(i=(n=t.info).lineClass,r=n.lineMarker,a=(o=n.zone)&&o!==q,s=i&&Object(x.a)(i)&&!ne(i,"list-code"),c=i&&ne(i,"single-line"),!s||!(r&&1===r)||h.disCollapse||a||c||(t.isPocket=!0))},this.aceShouldPocketReuse=function(e,t){var n=t.oldLineNode,i=t.newLineEntry,r=t.type,o=n.pocket.lineEntry,a=i.domInfo.lineClass;if(!ne(a,"list-code")&&(Object(x.a)(a)&&Object(x.a)(o.domInfo.lineClass)&&h.hasCollapse))return!(o.domInfo.isCollapsedHeading()!==i.domInfo.isCollapsedHeading())&&"collapseble-header-handle"===r||void 0},this.addPocketToLine=function(e,t){var n,i,r,u=t.editor,o=t.lineEntry,a=t.linePocket,s=o.domInfo.lineClass;ne(s,"list-code")||Object(x.a)(s)&&h.hasCollapse&&o&&o.lineNode&&o.zone===q&&(n=Object(_.$)(o.lineNode).find(".ace-line-pocket")[0],i=Object(_.$)("#editorcontainerbox")[0],r=function(e){var t,n,i,r,o,a,s,c,l=Object(_.$)(e.target).closest(".ace-line");!l.length||(t=u.domToRep(l.get(0)))&&(n=t.selStart[0],i=t.selStart[2],r=u.getContentState().getZoneState(i).getLine(n),o=Number(r.hasLineMarker()),a=r.getAttributes(0,r.length()-1).toMap(),s=Object(D.b)(a),c=Object(T.f)(t,o),Object(T.h)(u,c,s,e))},o.collapsibleSectionHandleRef||(o.collapsibleSectionHandleRef=a.put([{uniqueClass:"collapseble-header-handle",mount:function(e){S.a.render(k.a.createElement(T.b,{editor:u,line:o,container:n,etherpadContainer:i,onClick:r}),e)},unmount:function(e){S.a.unmountComponentAtNode(e)}}])))},this.findCollapsedSecetion=function(){for(var e=h.editor.getRep().lines,t=e.numNodes,n=[],i=0;i<t;i++){var r=e.atIndex(i).domInfo,o=r.collapseStatus,a=r.lineClass;Object(x.a)(a)&&!ne(a,"list-code")&&(o.collapseOnlyMe||o.collapseAll&&!1!==o.collapseOnlyMe)&&n.push(i)}return n},this.beforeFullscreenEnter=function(e,t){var n,i;1===t.mode&&(n=h.findCollapsedSecetion(),i=h.editor.getRep(),n.forEach(function(e){var t=Object(T.e)(e,i);Object(T.c)(h.editor,t,!0,h.editor.isEditable())}))},this.beforeFullscreenModeChange=this.beforeFullscreenEnter,this.changesetApply=function(e,t){var n=t.editor,i=!h.needUpdateCollapse;n.lineTracker.doUpdate(i),h.needUpdateCollapse=!1},this.doReturnKey=function(e){var t,n,i,r,o,a=h.editor,s=a.getRep();s.zoneId===q&&(t=s.selStart[0],n=s.lines.atIndex(t),s.selStart[1]===n.lineMarker?0!==(i=t<1?0:t-1)&&Object(D.a)(a,q,[i]):(r=0<Object(_.$)(n.lineNode).find(".collapsable-section-handle-collapsed").length,o=Object(T.e)(t,s),r&&Object(T.d)(a,o,!0,a.isEditable(),!1)))},this.updateCollapse=function(e,t,n){var c,l,u,i;e&&t&&0<t.length&&n&&(u=!(c=[]),t.length&&(t.length&&t.forEach(function(e,t){var n,i,r=h.editor.getRep(j.a).lines,o=e.lineNum,a=r.atIndex(o),s=h.editor.getContentState().getZoneState(j.a).getLine(o).getLineAttributes().toMap();a&&((n=a.lineNode)&&(l=0===t?o:l,i=e.output.renderCollapsed&&!e.output.startOfCollapseSection,c.push(o),L.a.msie?(i&&Object(_.$)(n).addClass("ace-line-collapsed"),i||Object(_.$)(n).removeClass("ace-line-collapsed")):n.classList.toggle("ace-line-collapsed",i)),e.output.startOfCollapseSection&&0===t&&(u=Object(D.b)(s)))}),(i=h.editor.plugins.sheetBridge.getBridge())&&i.syncVirtualScroll(),w.a.trigger("collapseLineChange",[{startOfCollapseSection:l,collapseRange:c,collapsed:u}])))},this.performUndoRedo=function(e,t){var n=h.editor,i=!h.needUpdateCollapse;n.lineTracker.doUpdate(i),h.needUpdateCollapse=!1},this.lineTrackerUpdate=function(e,t){var n=t.isDirtyZone,i=t.dirtyLines,r=t.root;h.updateCollapse(n,i,r)},this.aceDomLineProcessLineAttributes=function(e,t){var n,i=t.spanClass,r=/(?:^| )heading:([Hh0-9]*)/.exec(i);r&&(n=Object(g.a)(Y,r[1])),void 0!==n&&0<=n&&(t.lineClass+=" heading-".concat(r[1]),t.processedMarker=!0)},this.removeCollapse=function(e){var t,n,i,r,o,a=h.editor.getRep();a.zoneId===q&&(n=(t=a.lines.atIndex(e)).text,i=[e,t.lineMarker],r=[e,n.length],o=[[X,""]],a.attributeManager.setAttributesOnRange(i,r,o))},this.getHeadingType=function(e,t,n){var i=/(?:^| |Mso)[hH]eading-?(\S+)/.exec(t);if(i){var r="h".concat(i[1].replace(/[^\d]/g,""));if(V.a.includes(r))return r}if(/^h[1-9]$/.test(e))return e;var o=/font-size: (\d+)px/.exec(n);return n&&(-1<n.indexOf("font-weight: bold;")||-1<n.indexOf("font-weight: 700;"))&&o&&J[o[1]]?J[o[1]]:null},this.getCollapseType=function(e){var t=e.cls,n=/collapse-([a-z]{3,})/.exec(t);if(n)return n[0]},this.deserialize=function(e){var t=e.node,i=e.deltaSet,r=e.zoneId;if(t instanceof HTMLElement){var n=t.tagName,o=t.className,a=t.getAttribute("style")||"",s=h.getHeadingType(n.toLowerCase(),o,a),c=i,l=h.getCollapseType(o);s&&(c=Object(z.I)(i,r,d()({},Q,s)));var u=function(e,t){var n=c||i;return Object(z.H)(n,r,d()({},e,t))};if(l){if("collapse-all"===l)return u(X,"true");if("collapse-onlymenot"===l)return u("".concat(Z,"collapse"),"false");if("collapse-onlyme"===l)return u("".concat(Z,"collapse"),"true")}return c}return i},this.pluginReadOnly=function(){},e&&(this.hasCollapse=t&&t.hasCollapse,this.editor=e,this.nodes=new Set,this.guideCount=0,this.init(e),this.bindEvent()),this.hasCollapse&&w.a.on("invokeCollapse",this.checkCollapse)}return l()(n,[{key:"acePaste",value:function(e,t){var n=t.rep,i=n.selStart;this.lineNumberForPaste=i[0],this.lineForPasteIsCollapse="true"===n.attributeManager.getAttributeOnLine(this.lineNumberForPaste,"collapse")}},{key:"afterPaste",value:function(e,t){var n=t.rep,i=n.selStart,r=n.zoneId,o="true"===n.attributeManager.getAttributeOnLine(this.lineNumberForPaste,"collapse");(0<=this.lineNumberForPaste&&i[0]!==this.lineNumberForPaste&&o||!1===this.lineForPasteIsCollapse&&o)&&w.a.emit("invokeCollapse",{zoneId:r,range:{selStart:[this.lineNumberForPaste,0],selEnd:[this.lineNumberForPaste,0]},source:"paste"}),this.lineNumberForPaste=-1,this.lineForPasteIsCollapse=null}},{key:"reset",value:function(){this.removeEvent(),this.editor=null,w.a.off("invokeCollapse",this.checkCollapse)}},{key:"clientVars",value:function(){var e=this.editor.getMatchedAttributePositionOnSelection(null,function(e){return"heading"===e}),t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value.attrValue;this.headingCount[a]=1+(this.headingCount[a]||0)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}this.notifyHeadingCountChange()}},{key:"editorWillCopy",value:function(e){var t,i,n=this.editor,r=e.range,o=r.end,a=o.line,s=o.offset,c=o.zoneId,l=n.getContentState().getLineAttributes(c,a).toMap().heading,u=this.checkIsCollapsedHeading(c,a),d=n.getContentState().getZoneState(c),h={};l&&u&&s>=d.getLine(a).length()-2&&(t=d.getContent(),i=a,t.eachLine(function(e,t,n){if(a<n){if(t.heading&&t.heading>=l)return!1;i++}}),h.zoneId=c,h.line=i,h.offset=d.getLine(a).length()-1,r.end=h,e.range=r,e.deltaSet=this.editor.clipboard.slice(r))}},{key:"doInsertHeading",value:function(e){var i=this,r=e.attribKey,o=e.attribValue,a=e.range,s=e.isAllHasAttrib,t=o?o.slice(1):-1;if(!(0<=t&&void 0===Y[t])){var n=a.selStart,c=a.selEnd,l=a.attributeManager,u=a.zoneId,d=Object(v.a)(n[0],c[0]+1),h=[],f=this.editor&&Object(H.i)(this.editor,u),p=!0,g=!0;return d.forEach(function(e){var t,n=a.lines.atIndex(e);!n||!n.lineNode||-1<n.lineNode.className.indexOf(ee)||-1<n.lineNode.className.indexOf(y.b)||Object(O.a)(n.lineNode)||(f||i.editor&&Object(H.f)(i.editor,u,e)?s=p=!1:h.push(e),p&&i.editor&&(t=i.editor.getAttributeOnLine(u,e,r),p=t===o,t&&(g=!1)))}),s||p||o===W.r?o===W.r&&g||(l.removeAttributeOnMultiLines(d,r),this.hasCollapse&&d.forEach(function(e){i.removeCollapse(e)})):l.setAttributeOnMultiLinesExcludeAttrs(h,[[r,o]],[["aceTable",""]]),this.editor&&F.a.tryConvertZone(this.editor,a,r,o),s}}},{key:"serialize",value:function(e){var t,n=e.type,i=e.node,r=e.lineAttributes,o=r&&r[$];return n===z.u.LINE&&o&&((t=document.createElement(o)).appendChild(i),e.node=t),e}},{key:"pluginReadWrite",value:function(){}},{key:"alineToLineInput",value:function(e,t){if(t&&"string"==typeof t.value){var n=Object(D.c)(t.value)||{},i=n.type,r=n.indent;if("h"===i&&"number"==typeof r&&0<r&&r<=9)return r}}},{key:"checkIsLineCollapsed",value:function(e,t){if(void 0!==t){var n=this.editor.lineTracker;if(e&&e!==q||!n||!n.collapseLines||!n.collapseLines.trackers[q])return!1;var i=n.collapseLines.trackers[q].entries[t].output,r=i.renderCollapsed,o=i.startOfCollapseSection;return r&&!o}}},{key:"checkIsCollapsedHeading",value:function(e,t){if(void 0!==t){var n=this.editor.lineTracker;return(!e||e===q)&&n&&n.collapseLines&&n.collapseLines.trackers[q]?!!n.collapseLines.trackers[q].entries[t].output.startOfCollapseSection:!1}}},{key:"getHeadingCountChange",value:function(e,t){var n,i,r=this.getHeadingCountByState(e),o=this.getHeadingCountByState(t),a={};for(n in Object.assign({},r,o))(r[n]||o[n])&&(i=(o[n]||0)-(r[n]||0),a[n]=i);return a}},{key:"getHeadingCountByState",value:function(e){var t={},n=!0,i=!1,r=void 0;try{for(var o,a=e.alinesAttribs[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=!0,l=!1,u=void 0;try{for(var d,h=s[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var f=d.value;if("heading"===f[0]){var p=f[1];t[p]=1+(t[p]||0);break}}}catch(e){l=!0,u=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw u}}}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}},{key:"editorWillDoReturnKey",value:function(e){var t,n,i=e.delta,r=e.editor,o=r.selection.getSelection(),a=r.getContentState().getActiveZone(),s=a.getZoneId(),c=a.getLine(o.start.line),l=c.getLineAttributes().toMap(),u=o.toPosition(),d=u.start,h=u.len,f=c.isEndOfLine(o.end.offset);l.heading&&!h&&(t=c.isEmpty(),n=new z.E({zoneId:s}),i.ops.length?t||n.retain(d+1).retain(1,{heading:f?"":l.heading}):(f&&(l.heading=""),n.retain(d).insertEnter().insertLineMarker(l)),e.delta=i.compose(n))}},{key:"editorWillDoDeleteKey",value:function(e){var t,n,i,r,o,a,s=e.deltaSet,c=e.editor,l=c.selection.getSelection(),u=c.getContentState().getActiveZone(),d=u.getZoneId(),h=u.getLine(l.start.line),f=h.previousSibling(),p=h.getLineAttributes().toMap(),g=l.toPosition(),m=g.start,v=g.len,b=1===l.start.offset;f&&!v&&p.heading&&b&&(t=Number(f.hasLineMarker()),n=f.isEmpty(),i=f.getLineAttributes().toMap(),r=Object.keys(i).find(function(e){return!["author","lmkr","insertorder","lineguid","align"].includes(e)}),o=s.get(d).ops.length,r||!n||o||(a=new z.E({zoneId:d}),(t?a.retain(m-3).retain(1,Object.assign({},i,{heading:p.heading})):a.retain(m-2).insertLineMarker(Object.assign({},i,{heading:p.heading}))).delete(2),e.deltaSet=s.compose(a)))}}]),n}(),h()(r.prototype,"doInsertHeading",[i],Object.getOwnPropertyDescriptor(r.prototype,"doInsertHeading"),r.prototype),r);new ie},hKza:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r,i,o=n("lSNA"),a=n.n(o),s=n("J4zp"),N=n.n(s),v=n("716e");function D(e,t,n,i){return e===r.x?{pw:n+t,ph:i}:{pw:n,ph:i+t}}function x(e,t,n,i){return e===v.a.left?{x:n-t,y:i}:e===v.a.right?{x:n+t,y:i}:e===v.a.bottom?{x:n,y:i-t}:{x:n,y:i+t}}function c(e){if(e.isSamplePopup)return W(e);var t=e.container||document.body,n=e.referTarget,i=e.popup,r=e.gapToContainer,o=e.gapToTarget,a=t.getBoundingClientRect(),s=a.left,c=a.top,l=t.offsetWidth,u=t.offsetHeight;r&&(s+=r,c-=r,l-=2*r,u-=2*r);var d=n.getBoundingClientRect(),h=d.left,f=d.top,p=n.offsetWidth,g=n.offsetHeight,m=h-s,v=c+u-f-g,b=i.offsetWidth,y=i.offsetHeight,E=N()(e.placement,2),O=E[0],C=E[1],k=B(O);if(!k)throw new Error("no axis found by direction ".concat(O));var I,S=U(k),T=k,_=O;do{var w=P(T),j=D(T,o||0,b,y),M={tx:m,ty:v,tw:p,th:g,pw:j.pw,ph:j.ph,cw:l,ch:u};if(w.mustMatch(M)){var L=w[_];if(L&&0<L(M)){I=V(_,C,M);break}if(!(_=z(_)))throw new Error("no opposite direction found by direction ".concat(_));I=V(_,C,M);break}}while(_=H(T=S),T!==k);if(I){var R=x(_,o||0,I[0],I[1]);return{point:C,direction:_,position:F(R.x,R.y,{containerLeftToViewport:s,containerTopToViewport:c,ph:y,ch:u})}}return null}function P(e){var t;if(e!==r.x)return t={mustMatch:function(e){var t=e.pw;return 0<e.cw-t}},a()(t,v.a.top,function(e){return d(e.ty,e.th,e.ph,e.ch)}),a()(t,v.a.bottom,function(e){return h(e.ty,e.ph)}),t;var n={mustMatch:function(e){var t=e.ph;return 0<e.ch-t}};return a()(n,v.a.left,function(e){return l(e.tx,e.pw)}),a()(n,v.a.right,function(e){return u(e.tx,e.tw,e.pw,e.cw)}),n}function l(e,t){return e-t}function u(e,t,n,i){return i-(e+t+n)}function d(e,t,n,i){return i-(e+t+n)}function h(e,t){return e-t}function B(e){return e===v.a.left||e===v.a.right?r.x:e===v.a.top||e===v.a.bottom?r.y:null}function U(e){return e===r.x?r.y:r.x}function z(e){switch(e){case v.a.left:return v.a.right;case v.a.right:return v.a.left;case v.a.top:return v.a.bottom;case v.a.bottom:return v.a.top;default:return null}}function H(e){return e===r.x?v.a.left:v.a.top}function b(e,t){return e===v.b.start?0:e===v.b.center?t/2:t}function F(e,t,n){return{left:n.containerLeftToViewport+e,top:n.containerTopToViewport+n.ch-t-n.ph}}function V(e,t,n){var i=n.tx,r=n.ty,o=n.tw,a=n.th,s=n.pw,c=n.ph,l=n.cw,u=n.ch;if(e===v.a.left||e===v.a.right){var d=i-s;e===v.a.right&&(d=i+o);var h=r+b(t,a)-c/2,f=u-h-c;return f<0&&h<0?void 0:0<f&&0<h?[d,h]:f<0?[d,u-c]:[d,0]}var p=r-c;e===v.a.top&&(p=r+a);var g=i+b(t,o)-s/2,m=l-s-g;if(!(g<0&&m<0))return 0<g&&0<m?[g,p]:g<0?[0,p]:[l-s,p]}function W(e){var t=e.referTarget.getBoundingClientRect(),n=t.left;return{position:{top:t.top+t.height/2,right:window.innerWidth-n+20}}}(i=r=r||{}).x="x",i.y="y"},hLHa:function(e,t,n){"use strict";var i,r,o=n("w+xF"),v=n.n(o),a=n("lSNA"),b=n.n(a),s=n("2ACu"),h=n("8mZy"),c=n("ANjH"),l=n("O7eI"),u=n("6SzI"),y=n("LaDK"),E=n("bsrO"),d=n("MFtX");function O(n,i,r,o,a){setTimeout(function(){var e=Object(E.i)(),t={block_type:i===h.a.Issue?"isv_jiramaster":"isv_jiramaster_filter",source:n,refresh_status:r,jira_type:e};i===h.a.Filter&&(t.issue_num=o),t.response_code=a,Object(s.default)("client_refresh_data",t)},0)}function f(e,t){setTimeout(function(){Object(s.default)("client_fetch_auth",{auth_obj:"jira",fetch_status:e,jira_type:t})},0)}var p=Object(u.handleActions)((i={},b()(i,l.a.jira.FETCH_SYNC_JIRA_START,function(e,t){if(!t.payload)return e;var n=t.payload.blockToken;return Object.assign({},e,b()({},n,y.b.SYNCING))}),b()(i,l.a.jira.FETCH_SYNC_JIRA_SUCCESS,function(e,t){if(!t.payload)return e;var n=t.payload,i=n.type,r=n.blockToken,o=n.teaSource,a=n.issueCount,s=void 0===a?0:a,c=n.issues,l=void 0===c?[]:c,u=y.b.COMMON,d=l.length;return i===h.a.Filter&&d<s&&d<1e3&&(u=y.b.SOME_ISSUES_SYNC_FAIL),o&&O(o,i,u===y.b.COMMON?"success":"fail",s),Object.assign({},e,b()({},r,u))}),b()(i,l.a.jira.FETCH_SYNC_JIRA_FAIL,function(e,t){var n,i,r,o,a,s;if(!t.payload)return e;var c=t.payload,l=c.type,u=c.blockToken,d=c.teaSource,h=c.authState,f=c.baseUrl,p=t.error.code,g=(i={},b()(i,y.a.NO_JIRA,y.b.FAIL_NO_JIRA),b()(i,y.a.OPEN_JIRA,y.b.FAIL_CAN_NOT_USE),(r={})[n=y.a.WITHIN_JIRA]=r[n]||{},r[n].get=function(){return!f&&y.b.FAIL_NO_BASE_URL},v()(i,r),i),m=(a={},(s={})[o=E.c.AUTH_REQUIRED]=s[o]||{},s[o].get=function(){return g[h]||y.b.FAIL_AUTH},b()(a,E.c.PERMISSION_DENY,y.b.FAIL_PERMISSION),b()(a,E.c.SERVER_SYNCING,y.b.SERVER_SYNCING),v()(a,s),a)[p]||y.b.FAIL_RETRY;return d&&O(d,l,"fail",void 0,p),Object.assign({},e,b()({},u,m))}),b()(i,l.a.jira.FAKE_SYNC_JIRA_START,function(e,t){if(!t.payload)return e;var n=t.payload.blockToken;return Object.assign({},e,b()({},n,y.b.SYNCING))}),b()(i,l.a.jira.FAKE_SYNC_JIRA_SUCCESS,function(e,t){if(!t.payload)return e;var n=t.payload.blockToken;return Object.assign({},e,b()({},n,y.b.COMMON))}),b()(i,l.a.jira.FAKE_SYNC_JIRA_FAIL,function(e,t){if(!t.payload)return e;var n=t.payload.blockToken;return Object.assign({},e,b()({},n,y.b.FAIL_RETRY))}),b()(i,l.a.jira.FAKE_SYNC_JIRA_END,function(e,t){if(!t.payload)return e;var n=t.payload.blockToken;return Object.assign({},e,b()({},n,y.b.COMMON))}),i),d.a.syncStatus),g=Object(u.handleActions)((r={},b()(r,l.a.jira.FETCH_JIRA_AUTH_STATUS_SUCCESS,function(e,t){if(!t.payload)return e;var n=t.payload,i=n.baseUrl,r=n.authed,o=n.statusCode,a=n.authUrl,s=n.adminInfo,c=n.canApply,l=Object(E.g)(i),u=e.authState;switch(o){case 1:u=y.a.NO_JIRA;break;case 2:u=y.a.OPEN_JIRA;break;case 0:u=r?y.a.HAS_CONNECTED:y.a.WITHIN_JIRA}return f("success",l),Object.assign({},e,{baseUrl:i,authUrl:a,authState:u,jiraType:l,canApply:c,adminInfo:Object.assign({},d.a.authStatus.adminInfo,{},s)})}),b()(r,l.a.jira.FETCH_JIRA_AUTH_STATUS_FAIL,function(e,t){return t.payload?(f("fail"),Object.assign({},e,{authState:y.a.FETCH_FAIL})):e}),r),d.a.authStatus),m=Object(u.handleActions)(b()({},l.a.jira.FETCH_JIRA_ISSUE_INIT_DATA_SUCCESS,function(e,t){var n=t.payload.issue;return Object.assign({},e,b()({},n.linkUrl,n))}),d.a.initDataMap);t.a=Object(c.combineReducers)({syncStatus:p,authStatus:g,initDataMap:m})},hNo0:function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{}).DOC="doc",r.BITABLE="bitable",r.BITABLE_IMAGE="bitable_image",r.BITABLE_FILE="bitable_file",r.EXPLORER="explorer",r.SHEET_IMAGE="sheet_image",r.DOC_IMAGE="doc_image",r.COMMENT_IMAGE="comment_image"},hNoK:function(e,t,n){"use strict";n.r(t);var i=n("+v7G");t.default=i.a},hjac:function(e,t,n){"use strict";n.d(t,"a",function(){return o});n("hMnB");var i=n("5dbN"),r=(n("jp/M"),n("ucr6"));function o(e){"function"!=typeof window.docsInLarkHistoryReplace||Object(i.isUnderWiki)()?window.history.replaceState(null,null,"#".concat(e)):window.docsInLarkHistoryReplace(r.a.nativeReplace,{hash:e})}},hqaq:function(e,g,m){"use strict";(function(n){m.d(g,"a",function(){return p});var e=m("lwsE"),i=m.n(e),t=m("W8MJ"),r=m.n(t),o=m("a1gu"),a=m.n(o),s=m("Nsbk"),c=m.n(s),l=m("7W2i"),u=m.n(l),d=m("ifKl"),h=m("q1tI"),f=m.n(h),p=(m("17x9"),m("85Se"),function(e){function t(){return i()(this,t),a()(this,c()(t).apply(this,arguments))}return u()(t,e),r()(t,[{key:"render",value:function(){return f.a.createElement("div",{className:"comment-list-placeholder",onClick:this.props.onClick},f.a.createElement("span",null,n("comment.number_collapsed_comment",this.props.count)))}}]),t}(f.a.Component));p.defaultProps={onClick:d.default}}).call(this,m("2vAP"))},hrO2:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i,r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),c=n("HmyT"),l=n("iP/4"),u=n("nVH4"),d=n("/spq"),h=n("D28M"),f=n("H6oK"),p=Object(d.a)(["bindEvents"])(i=function(){function t(e){var r=this;o()(this,t),this.className="CheckAll",this.selectionFun=function(e){r.checkAll&&r.Range(e),null==r._ace.selection.getSelection()&&!0===r.afterCheckAll&&(r._ace.inCallStackIfNecessary("selectionchange",function(){r._ace.selection.setWithSelection("0",[0,0],[0,0])}),r.afterCheckAll=!1)},this.handleEventKey=function(e){var t,n,i=l.a.isMac?e.metaKey:e.ctrlKey;e.keyCode===u.c.A&&i&&(t=document.activeElement,"true"!==Object(c.$)(t).attr("contenteditable")&&(n=t.tagName.toLowerCase(),["textarea","input"].includes(n)||Object(h.l)(t,"block-type-".concat(f.BlockType.ISV_BLOCK))||(r.checkAll=!0,r._ace.isSelectingAll=!0)))},this.Range=function(e){r.innerBody=r._ace.getInnerContainer(),r.checkAll=!1,e.preventDefault(),r._ace.selection.selectAll()},this.reset=function(){r.$root&&(r.$root.off("selectionchange",r.selectionFun),r.$root.off("keydown",r.handleEventKey))},e&&(this._ace=e,this.checkAll=!1,this.afterCheckAll=!1,this.bindEvents())}return s()(t,[{key:"bindEvents",value:function(){this.$root=Object(c.$)(document),this.$root.on("keydown",this.handleEventKey),this.$root.on("selectionchange",this.selectionFun)}}]),t}())||i;new p},hzE9:function(e,t){e.exports='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g id="-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="icon_global_close_nor">\n            <g id="bg"></g>\n            <g transform="translate(4.000000, 4.000000)" fill="#646A73" id="fill-area">\n                <g transform="translate(0.500000, 0.500000)">\n                    <rect id="" transform="translate(7.750000, 7.500000) rotate(45.000000) translate(-7.750000, -7.500000) " x="7" y="-1" width="1.5" height="17"></rect>\n                    <rect id="" transform="translate(7.500000, 7.750000) rotate(45.000000) translate(-7.500000, -7.750000) " x="-1" y="7" width="17" height="1.5"></rect>\n                </g>\n            </g>\n        </g>\n    </g>\n</svg>\n'},i4Hx:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var f=n("OX8E"),p=n("rUU8"),g=n("Tqb2"),m=n("nVH4"),i=function(o,a,e){var s=e.setImageState,c=e.getImageState,i=!1,t=null,n=function(){o.off("editorbar:changedSelection",h),f.a.off(p.c.MOUSE_ENTER_SELECTION_POPOVER,l),f.a.off(p.c.MOUSE_LEAVE_SELECTION_POPOVER,d)},l=function(){t&&clearTimeout(t),t=null},r=function(e){var t,n,i,r;l(),s({hoveredImageUuid:e}),0<c().selectedImageSet.size||0!==(t=Object(g.o)({uuid:e},o)).length&&(i=(n=t[0]).start,r=n.end,a&&a.setSelectedImageUUID(e),o.call("customPopupControl",{zoneId:i.zoneId,status:!0,selStart:[i.line,i.offset],selEnd:[r.line,r.offset]}))},u=function(){l(),s({hoveredImageUuid:null}),0<c().selectedImageSet.size||!i||o.call("customPopupControl",{status:!1})},d=function(){t=setTimeout(u,500)},h=function(e){var t=e.popupType,n=e.customPopup;i=t===m.d.IMAGE&&n.visible};return o.on("editorbar:changedSelection",h),f.a.on(p.c.MOUSE_ENTER_SELECTION_POPOVER,l),f.a.on(p.c.MOUSE_LEAVE_SELECTION_POPOVER,d),{destroy:n,showPopup:r,hidePopupImmediately:u,hidePopupDelay:d,cleanMouseLeaveTimer:l}}},iaE7:function(e,t,n){"use strict";var i=n("J4zp"),f=n.n(i),r=n("lSNA"),u=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("a1gu"),d=n.n(l),h=n("Nsbk"),p=n.n(h),g=n("iWIM"),m=n.n(g),v=n("7W2i"),b=n.n(v),y=n("cDf5"),E=n.n(y),O=n("q1tI"),C=n.n(O),k=n("y2sV"),I=n("CnBM"),S=n.n(I),T=n("l9PA"),_=n("kESg"),w=n("7Kxq"),j=n("ciJ8"),M=n("zAQS"),L=n("YNKm"),R=n("F9bh"),N=n("AiBH"),D=n("DIyy"),x=n("Muja"),P=n("3Hq1"),B=n("4PSP"),U=n("FEfn"),z=n("uirG"),H=n("FJEn"),F=n("+4eN"),V=n("Uy54"),W=["editorWillCopy","serialize","editorWillSetClipboard","deserialize","editorWillPaste"],K=function(e){function n(e){var t;return a()(this,n),(t=d()(this,p()(n).call(this,e))).editor=e,t}return b()(n,e),c()(n,[{key:"matchOp",value:function(e){return Object(M.k)(e)}},{key:"matchZoneDeltaOp",value:function(e){return Object(M.k)(e)||Object(V.c)(e)}},{key:"isBlockOp",value:function(e){var t=this.editor.getContentState().schema;return Object(k.K)(e.attributes,t)||Object(F.e)(_.l.CalloutBlock,e)}},{key:"afterEnterSpan",value:function(e){}},{key:"editorWillCopy",value:function(e){this.collectZoneDelta(e)}},{key:"serialize",value:function(e){var t=e.type,n=e.op,i=n&&n.attributes||{},r=n&&this.matchOp(n);if(t===k.u.LEAF&&r){var o=i[_.k.ZoneId],a=document.createElement("div"),s=document.createElement("div"),c=e.zoneId;e.zoneId=o;var l=this.editor.clipboard.serialize(e).node;return a.className=j.h.CONTAINER,a.dataset.emojiId=i[j.i.EmojiId],s.className=j.h.CALLOUT,s.style.color=i[j.i.TextColor],s.style.borderColor=i[j.i.BorderColor],s.style.backgroundColor=i[j.i.BackgroundColor],s.appendChild(l),a.appendChild(s),Object.assign(e,{node:a,zoneId:c})}return e}},{key:"editorWillSetClipboard",value:function(e){e.deltaSet=this.replaceZoneInDeltaSet(e.deltaSet)}},{key:"deserialize",value:function(e){var t=e.node,n=e.zoneId,i=e.deltaSet;if(!(t instanceof HTMLDivElement))return i;var r,o,a,s,c,l=Object(M.d)(t);return l&&(o=Object(M.i)(),a=Object.assign({},o,{},Object(M.l)(Object.assign({},o,{},l))),s=i.get(n),c=Object(F.b)(),i.replace(n,s.create(Object.assign({},s,{zoneId:c}))),i=i.concat(new k.E({zoneId:H.DEFAULT_REP_ZONE}).insert("*",Object.assign((r={},u()(r,_.k.ZoneType,_.l.CalloutBlock),u()(r,_.k.ZoneId,c),r),a)))),i}},{key:"editorWillPaste",value:function(e){var t=this.replaceZoneInDeltaSet(e.deltaSet,!0),n=this.editor.selection.getZone();return Object(M.j)(this.editor,n)&&(t=this.flattenZoneDelta(t),t=this.filterUnexpectedOp(t)),t}}]),n}(z.a),Z=n("YWBl"),q=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":E()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Y=S()({loader:function(){return Promise.all([n.e("doc_index_css"),n.e("chunk_adit"),n.e("commons--doc_index_delay--voteEmoji--votePicker"),n.e(16),n.e("commons--doc_index_delay--jira"),n.e("doc_index_delay")]).then(n.bind(null,"6tYG"))},loading:function(){return C.a.createElement("div",{dangerouslySetInnerHTML:{__html:_.m}})},render:function(e,t){var n=e.default;return C.a.createElement(n,Object.assign({},t,{ref:t.containerRef}))}}),J=function(e){function i(e,t){var n;return a()(this,i),(n=d()(this,p()(i).call(this,e))).editor=e,n.toolbarManager=t,n.className="CalloutPlugin",n.zoneAceClassName="".concat(j.e," ").concat(j.h.ACE_LINE),n.spanClassName=j.h.SPAN,n.zoneParentClassName=j.h.CALLOUT,n.zoneType=_.l.CalloutBlock,n.instanceName=w.e.CALLOUT,n.clipboard=new K(n.editor),n.registerCommand(),W.forEach(function(e){n[e]=n.clipboard[e].bind(n.clipboard)}),n}return b()(i,e),c()(i,[{key:"registerCommand",value:function(){var c=this,e=j.h.SPAN;this.editor.commands.registerAceCommand(L.E,function(e,t,n,i){var r=i.source;c.doInsertCallout({source:r})},{statusKey:e}),this.editor.commands.registerAceCommand(N.b.CALLOUT_BLOCK,function(e,t,n,i){var r=i.source;c.doInsertCallout({source:r})},{statusKey:e}),this.editor.commands.registerCommand(L.k,function(e,t,n,i){var r=i.button,o=i.value,a=c.toolbarManager&&c.toolbarManager.getCurrentZone(),s=r&&$(r).attr("data-color")||o||"";a&&"string"==typeof s&&s&&c.setHighlightColor(a,s)},{statusKey:e})}},{key:"doInsertCallout",value:function(e){var t=e.dRep,n=e.range,i=e.correctRange,r=e.source,o=t||i||n;o&&o.selStart&&o.selEnd&&(D.a.convertToCalloutBlock(this.editor,r,o),Object(Z.a)({action:j.g,op:w.f,source:r}))}},{key:"toggleAttributes",value:function(e,t){var n,i,r,o,a,s,c,l,u,d=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],h=this.editor.getContentState(),f=Object(M.f)(this.editor,e);f&&(n=f.start,i=f.end,r=n.zoneId,o=h.getAttributes(f.start,f.end).toMap(),s=(a=h.getZoneState(r)).pointToOffset(n),c=a.pointToOffset(i),l=Object.assign({},t),d&&[j.i.TextColor,j.i.BorderColor,j.i.BackgroundColor].forEach(function(e){Object(P.default)(l[e])||l[e]!==o[e]||(l[e]="")}),(l=Object.assign({},o,{},Object(M.l)(Object.assign({},o,{},l))))&&!Object(x.default)(o,l)&&(u=new k.E({zoneId:r}).retain(a.pointToOffset(n)).retain(c-s,l),h.apply(u,{preventScrolling:!0}),Object(M.a)(o,t),Object(M.m)(l),this.toolbarManager&&this.toolbarManager.colorChanged(l)))}},{key:"setEmoji",value:function(e,t){this.toggleAttributes(e,u()({},j.i.EmojiId,t))}},{key:"setHighlightColor",value:function(e,t){var n,i,r,o,a,s=Object(U.a)(t)||Object(M.i)();"object"===E()(s)?(i=(n=Object(M.f)(this.editor,e))?this.editor.getContentState().getAttributes(n.start,n.end).toMap():{},r={},s.border?(o=Object(M.b)(j.q,s.border),a=Object(M.g)(i[j.i.BackgroundColor]),o&&(r[j.i.BorderColor]=a.get(o))):s.text?r[j.i.TextColor]=s.text:s.background&&(r[j.i.BackgroundColor]=Object(M.n)(s.background)),this.toggleAttributes(e,r)):s===j.v?(this.toggleAttributes(e,j.l,!1),Object(Z.a)({action:"reset_".concat(j.g)})):s===j.t&&(this.toggleAttributes(e,Object(M.c)(this.editor,e),!1),Object(Z.a)({action:"random_".concat(j.g)}))}},{key:"handleCalloutMouseEnter",value:function(e){this.toolbarManager&&this.toolbarManager.showToolbarImmediately(e)}},{key:"handleCalloutMouseLeave",value:function(){this.toolbarManager&&this.toolbarManager.hideToolbarDelay()}},{key:"getZoneId",value:function(e,t,n){return Object(M.h)(e,t,n)}},{key:"insertTabImpl",value:function(e,t,n,i){var r,o,a,s=e.zoneId,c=this.editor.getContentState().getZoneState(s).getLine(n);c&&(r=c.getLineAttributes().toMap(),o=i===c.getLineMarker(),a=r["text-indent"],r.list||(!o||a||t?o&&a&&t?e.attributeManager.removeAttributeOnLine(n,"text-indent"):t||(a?(e.attributeManager.removeAttributeOnLine(n,"text-indent"),this.editor.setLineListType(s,n,"indent2")):this.editor.setLineListType(s,n,"indent1")):e.attributeManager.setAttributeOnLine(n,"text-indent","true")))}},{key:"renderLine",value:function(e){var t=e.lineState.getZoneId();return Object(M.j)(this.editor,t)&&(e.lineClass+=" ".concat(j.h.LINE)),e.children}},{key:"renderCustomZoneView",value:function(e){var t=this,n=e.lineEntry,i=e.attributes.zoneId;return C.a.createElement(Y,{editor:this.editor,zoneId:i,lineEntry:n,onEmojiSelect:function(e){return t.setEmoji(i,e)},onMouseEnter:this.handleCalloutMouseEnter,onMouseLeave:this.handleCalloutMouseLeave,onMount:this.handleZoneMount,onUnmount:this.handleZoneUnmount,containerRef:function(e){t.handleRef(n,i,e)}})}},{key:"aceSelectionChanged",value:function(e,t){m()(p()(i.prototype),"aceSelectionChanged",this).call(this,e,t),this.toolbarManager&&this.toolbarManager.selectionChanged()}},{key:"collectText",value:function(e,t){var r=this,n=t.attributes||[];if(n.some(function(e){var t=f()(e,2),n=t[0],i=t[1];return n===_.k.ZoneType&&i===r.zoneType})){var i=n.find(function(e){return f()(e,1)[0]===_.k.ZoneId}),o=i&&i[1];if(o){var a="",s=this.editor.getContentState().getZoneState(o),c=!0,l=!1,u=void 0;try{for(var d,h=s[Symbol.iterator]();!(c=(d=h.next()).done);c=!0)a+=d.value.getText()}catch(e){l=!0,u=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw u}}return a}}}},{key:"pluginReadOnly",value:function(){this.editor.call(j.d.EDIT_STATUS_CHANGE,!1)}},{key:"pluginReadWrite",value:function(){this.editor.call(j.d.EDIT_STATUS_CHANGE,!0)}},{key:"reset",value:function(){this.toolbarManager&&this.toolbarManager.destroy()}}]),i}(T.a);q([Object(R.a)()],J.prototype,"doInsertCallout",null),q([Object(B.Bind)()],J.prototype,"handleCalloutMouseEnter",null),q([Object(B.Bind)()],J.prototype,"handleCalloutMouseLeave",null);t.a=J},ibWA:function(e,t,n){"use strict";function i(e,t){var n=[];if(!e||!e.length)return n;for(var i="",r=0;r<e.length;++r)e[r]!==t?i+=e[r]:(i&&(n.push(i),i=""),n.push(e[r]));return i&&n.push(i),n}function r(e){var t=[],n="";return e.split("").forEach(function(e){"\n"===e?(n&&(t.push(n),n=""),t.push(e)):n+=e}),n&&t.push(n),t}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r})},ifGE:function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"g",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"h",function(){return a}),n.d(t,"d",function(){return d}),n.d(t,"b",function(){return h}),n.d(t,"f",function(){return f});var s=n("1fXG"),c=n("MOd6"),l=n("3poY"),u=function(e,t){for(var n=t;n.parentElement&&!(n instanceof HTMLElement);)n=n.parentElement;var i=e.advancedDomToRep(n);return i?{lineNum:i.selStart[0],zoneId:i.selStart[2]}:null},i=function(e,t){var n=Object(s.c)(t,[c.j,c.g]),i=u(e,t);if(n&&n.matches(c.j)){var r=function(e){return e.length?Array.from(e).slice(-1)[0]:null}(n.querySelectorAll(c.g));if(!r)return console.error("There should be at least one lineNode in the table cell"),null;i=u(e,r)}if(!i)return null;var o=Object(l.b)(e,i.zoneId,i.lineNum);o.length&&(i.lineNum=o[o.length-1]);var a=e.getRep(i.zoneId);return{zoneId:i.zoneId,lineNum:i.lineNum,selection:[i.lineNum,a.alinesWidth[i.lineNum]-1]}},r=function(e){return Array.isArray(e)?e:[e]},o=function(e,t){var n=r(t).map(function(e){return".".concat(e)});return Object(s.c)(e,n)};function a(e,t){Object.assign(e.style,t)}function d(e,t,n){for(var i=e.getRep(t),r=i.lines.indexOfOffset(n[0]),o=i.lines.indexOfOffset(n[1]),a=[],s=r;s<=o;s+=1)a.push(s);return a}function h(e,t){var n;"string"==typeof t&&(n=t,t=function(e){return e instanceof Element&&e.matches(n)});for(var i=e;i;){if(t(i))return i;i=i.parentElement}return null}function f(){var e=document.querySelector(".navigation-bar");return e?e.offsetHeight+20:84}},ijLc:function(e,t,i){"use strict";i.r(t);var n=i("m/+l"),r=i("peh1"),o=i("QILm"),T=i.n(o),a=i("RIqP"),s=i.n(a),c=i("SA+Z"),l=i.n(c),u=i("lwsE"),d=i.n(u),h=i("W8MJ"),f=i.n(h),p=i("a1gu"),g=i.n(p),m=i("Nsbk"),v=i.n(m),b=i("7W2i"),y=i.n(b),E=i("cDf5"),O=i.n(E),C=i("hbEN"),k=i("Q9/D");k.a.start=Date.now();var I=i("Qazs"),S=i("dnly"),_=i("SebV");function w(n){return function(e){var t="Doc: Failed to preload ".concat(n);window.Slardar&&Object(_.b)(t),console.error(t,e)}}Object(S.a)().catch(w("suite_header")),Object(I.a)().catch(w("utils_store"));var j=i("q1tI"),M=i.n(j),L=i("17x9"),R=i.n(L),N=i("4PSP"),D=i("TSYQ"),x=i.n(D),P=i("4Ef3"),B=i("5qEQ"),U=i("ANjH"),z=i("lzTj"),H=i("3AGV"),F=i("qup3"),V=i("jp/M"),W=function(e){return{type:V.actionTypes.commentLoadStatus.SET_COMMENT_LOAD_STATUS,payload:{statusData:e}}},K=i("ZSG8"),Z=i("3M86"),q=i("qYkn"),Y=i("DJKl"),J=i("vc5i"),Q=i("5cZX"),X=i("wIs1"),$=i("NltJ"),ee=i("Q9MD"),te=i("myFJ"),ne=i("Qqsi"),ie=i("jzcD"),re=i("1tpT"),oe=i("QM+C"),ae=i("HvQa"),se=i("ZhRG"),ce=i("XfSZ"),le={initComments:H.d,resolveCommentAnimated:H.g,updateComments:H.k,resetComments:H.f,updateReplyComment:H.l,deleteReplyComment:H.a,setCommentMessageRead:H.i,updatePCMessageListData:Z.b,copyTextWithoutPermission:q.a,setHelpBtnVisible:K.p,setCommentPositionData:F.a,toggleDocComment:H.j,setCommentLoadStatus:W,mergeCommentMessageStatuses:H.e,setCommentReaction:Y.a,setCommentReactionEntities:Y.b,setCommentReactionLoadStatus:Y.c,setMessagePositionData:re.b,setActiveNotification:re.a,toggleCommentShown:F.b,updateBusinessStage:ae.c},ue=function(e){var t=Object(ne.b)(e),n=Object(J.o)(e),i=Object(J.n)(e),r=Object(ie.a)(e),o=Object(ie.b)(e),a=!oe.isAnonymousAccess,s=o.status.translated&&a;return Object.assign({objectType:n,noteToken:i,isTemplateMode:t,user:Object($.d)(e),member:Object(ee.a)(e),commentData:Object($.a)(e),commentList:Object($.p)(e),commentPositions:Object($.j)(e),haveEditPermission:Object(Q.c)(e),haveCommentPermission:Object(Q.b)(e),otherPermissions:Object(Q.u)(e),isCommentsDataLoaded:Object($.o)(e),isCommentPositionsLoaded:Object($.m)(e),isCommentsDataReady:Object($.n)(e),commentMessageMap:Object($.b)(e),shown:Object($.h)(e),enterTransMode:s,transEnabled:a,opendocSidebarConfig:Object(se.b)("sidebar")(e)||Object(se.a)(ce.a.SIDEBAR)(e),opendocCommentConfig:Object(se.a)(ce.a.COMMENT)(e)},r)},de=Object(U.compose)(Object(n.connect)(ue,le),te.a,X.a)(z.a),he=i("lrrv"),fe=i("PSAx"),pe=i("vE74"),ge=i("9+L6"),me=i("OX8E"),ve=i("521f"),be=i("ywOK"),ye=(i("Ovl5"),i("/z8v"),i("SGN9")),Ee=i("G8Hj"),Oe=i("xKvl"),Ce=i("HcED"),ke=i("zhgJ"),Ie=i("lQZd"),Se=i("KgLa"),Te=i("CnBM"),_e=i.n(Te),we=i("DC6e"),je=i("EjhX"),Me=i("pf04"),Ae=i("90Nm"),Le=Object(j.memo)(function(){return Object(j.useEffect)(function(){return je.d(),Object(Me.a)(),Object(Ae.b)(!0),function(){Object(Ae.b)(!1)}},[]),null}),Re=i("o0o1"),Ne=i.n(Re),De=i("yXPU"),xe=i.n(De),Pe=i("D7h9");function Be(){return Ue.apply(this,arguments)}function Ue(){return(Ue=xe()(Ne.a.mark(function e(){var t,n;return Ne.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e("onboarding-doc_modules").then(i.bind(null,"MeAF"));case 2:return t=e.sent,n=t.getOnboardingDocModule(),e.abrupt("return",Pe.default.addModule(n));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ze,He=i("1lbP"),Fe=i("nYlk"),Ve=function(n){return Object(j.useEffect)(function(){var t=new He.a;return t.toPromise(Be()).then(function(e){n.prepareCreateDocGuide(),n.prepareSharedDocGuide(),n.unusedDocFeatureGuide(),t.destroy$.subscribe(function(){n.cancelUnusedDocFeatureGuide(),e.remove()})}),function(){return t.destroy()}},[]),null},We={prepareCreateDocGuide:Fe.e,prepareSharedDocGuide:Fe.g,unusedDocFeatureGuide:Fe.q,cancelUnusedDocFeatureGuide:Fe.a},Ke=Object(n.connect)(null,We)(Ve),Ge=i("KrGf"),Ze=i("8mZy"),qe=i("bsrO"),Ye=function(e){return Object(j.useEffect)(function(){(Object(qe.f)()||Object(qe.d)())&&(Object(Ge.b)()?e.setJiraAuthStatusFail():e.fetchJiraAuthStatus())},[]),null},Je={fetchJiraAuthStatus:Ze.g,setJiraAuthStatusFail:Ze.h},Qe=Object(n.connect)(null,Je)(Ye),Xe=i("AW8B"),$e=i("SyrE"),et=i("Trbk"),tt=i("k2k2"),nt=Object(j.memo)(function(){return Object(j.useEffect)(function(){$e.g.emit("".concat(et.c,":FINISH_RENDER"),Object(tt.getRenderId)())},[]),null}),it=i("rLED"),rt=i("iP/4"),ot=(i("QQnO"),i("sLU5")),at=i("R/2b"),st=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":O()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},ct=_e()({loader:function(){return i.e("translate_doc").then(i.bind(null,"jQMZ"))},loading:function(){return null},render:function(e,t){var n=e.default;return M.a.createElement(n,Object.assign({},t))}}),lt=_e()({loader:function(){return Promise.all([i.e("doc_index_css"),i.e("chunk_adit"),i.e("commons--doc_index_delay--voteEmoji--votePicker"),i.e(16),i.e("commons--doc_index_delay--jira"),i.e("doc_index_delay")]).then(i.bind(null,"2QRo"))},loading:function(){return null}}),ut=_e()({loader:function(){return i.e("NewHistory").then(i.bind(null,"pQ2j"))},loading:function(){return null}}),dt=Object(ke.e)().open;window.SheetPackagesStatusInDoc=((ze=window).SheetPackagesStatus=ze.SheetPackagesStatus||{},{IO:ze.SheetPackagesStatus.IO||!1,Shell:ze.SheetPackagesStatus.Shell||!1,Core:ze.SheetPackagesStatus.Core||!1,Components:ze.SheetPackagesStatus.Components||!1}),be.c.updateStage(ve.a.DOC_JS_LOADED,oe.FILE_TYPE.DOC);var ht=function(e){function t(){var c;return d()(this,t),(c=g()(this,v()(t).apply(this,arguments)))._scrollbarWidth=0,c.triggerDiffHeight=null,c.DEBOUNCE_SCROLL_TIME=300,c.hasUpdateSectionNavBusinessStage=!1,c.isSupportTranslate=Object(Xe.d)(),c.isHadShownComment=!1,c.checkScrollToBottomDebounced=Object(C.default)(function(){c.checkScrollToBottom()},c.DEBOUNCE_SCROLL_TIME),c.checkSafariScrollX=function(){c.wrapperRef&&0<c.wrapperRef.scrollLeft&&(c.wrapperRef.scrollLeft=0)},c.checkScrollToBottom=function(){var e,t,n,i,r,o;c.wrapperRef&&(Object(ye.n)(c.props.userGuide,Ee.STEP_TYPES.shared_doc_group_create)||(t=(e=c.wrapperRef).scrollTop,n=e.scrollHeight,i=e.offsetHeight,null===c.triggerDiffHeight&&(o=0,(r=document.getElementById("globalComment"))&&(o=r.clientHeight+200),c.triggerDiffHeight=o),t+i>=n-c.triggerDiffHeight&&Object(ye.b)(Ee.STEP_TYPES.shared_doc_group_create)))},c.calcAndSetHeight=function(){c.calcAndSetDocMainHeight(),c.props.noteToken&&c.calcScrollHeight()},c.calcScrollHeight=function(){var e=document.querySelector("#innerdocbody");if(e){for(var t=e,n=e.offsetTop;t.offsetParent;)n+=t.offsetParent.offsetTop,t=t.offsetParent;var i=window.innerHeight-n;e.style.minHeight=i+"px"}},c.calcAndSetDocMainHeight=function(){var e,t,n,i,r,o,a,s;!c.wrapperRef||(e=document.querySelector(".suite-body"))&&(n=(t=c.wrapperRef).clientHeight,i=t.offsetHeight,r=document.querySelector(".navigation-bar"),o=n<i?c._scrollbarWidth:0,a=r?r.getBoundingClientRect().height:0,s=window.innerHeight-a-o,e.style.height=s+"px")},c.saveWrapperRef=function(e){c.wrapperRef=e},c}return y()(t,e),f()(t,[{key:"componentDidMount",value:function(){this._scrollbarWidth=Object(pe.e)(),this.calcAndSetHeight(),window.addEventListener("resize",this.calcAndSetHeight,!1)}},{key:"shouldComponentUpdate",value:function(e){return this.props.noteType===e.noteType}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.noteToken,i=t.noteType,r=t.createDocGuideOn,o=t.sharedDocGuideOn,a=t.editor;i!==e.noteType&&n&&e.noteToken!==n&&this.calcScrollHeight(),a&&!e.editor?this.bindGuideEvents():e.editor&&!a&&this.handleFullscreenExited();var s=!e.createDocGuideOn&&r,c=!e.sharedDocGuideOn&&o;(r||o)&&this.toggleOnBoardingSteps({addCreateDocSteps:s,addSharedDocSteps:c})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.calcAndSetHeight),this.props.editor&&this.unBindGuideEvents(),this.toggleOnBoardingSteps(!1)}},{key:"bindGuideEvents",value:function(){var e=this.props.editor;e.on("imageFirstUpload",this.handleShowImageGuide),e.on("imageDragged",this.handleRemoveImagerGuide),e.on("fullscreenEntering",this.handleFullscreenEntered),e.on("fullscreenExited",this.handleFullscreenExited),e.on(ot.a.PC.DOCS.CLOSE_SELECTION_POPUP_GUIDE,this.closeSelectionPopupGuide)}},{key:"unBindGuideEvents",value:function(){var e=this.props.editor;e.off("imageFirstUpload",this.handleShowImageGuide),e.off("imageDragged",this.handleRemoveImagerGuide),e.off("fullscreenEntering",this.handleFullscreenEntered),e.off("fullscreenExited",this.handleFullscreenExited),e.off(ot.a.PC.DOCS.CLOSE_SELECTION_POPUP_GUIDE,this.closeSelectionPopupGuide)}},{key:"handleShowImageGuide",value:function(){Object(ye.b)(Ee.STEP_TYPES.gallery_image_guide)}},{key:"handleRemoveImagerGuide",value:function(){Object(ye.q)(Ee.STEP_TYPES.gallery_image_guide)}},{key:"handleFullscreenEntered",value:function(){this.props.toggleFullscreen(!0)}},{key:"handleFullscreenExited",value:function(){this.props.toggleFullscreen(!1)}},{key:"closeSelectionPopupGuide",value:function(){var e=this.props.editor;e.focus(),e.setSel([1,0],[1,0],!0)}},{key:"toggleOnBoardingSteps",value:function(e){var t,n,i;!1===e?(t=l()(Ee.GROUP_STEPS[Ee.GROUP_TYPE.CREATE_DOC]).slice(1),n=l()(Ee.GROUP_STEPS[Ee.GROUP_TYPE.SHARED_DOC]).slice(1),ye.q.apply(void 0,s()(t).concat(s()(n)))):(e.addCreateDocSteps&&(i=l()(Ee.GROUP_STEPS[Ee.GROUP_TYPE.CREATE_DOC]).slice(1),ye.b.apply(void 0,s()(i))),e.addSharedDocSteps&&(Object(ye.b)(Ee.STEP_TYPES.shared_doc_group_toc,Ee.STEP_TYPES.shared_doc_group_comment_guide),this.checkScrollToBottom()))}},{key:"gotoHelpDoc",value:function(){Object(Ce.a)(ge.h)}},{key:"handleHelperSidebarBtnClick",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.noteToken,n=e.commentList,i=e.sharedDocGuideOn,r=e.docCommentShown,o=e.onClientVarsReady,a=e.onClientVarsError,s=e.shouldHandOutError,c=e.editor,l=e.noteType,u=e.wikiRelationEnabled,d=e.isWiki,h=e.canRead,f=e.enterTransMode,p=e.embedSidebarVisible,g=e.opendocContentConfig,m=T()(e,["noteToken","commentList","sharedDocGuideOn","docCommentShown","onClientVarsReady","onClientVarsError","shouldHandOutError","editor","noteType","wikiRelationEnabled","isWiki","canRead","enterTransMode","embedSidebarVisible","opendocContentConfig"]),v=Object.assign({onClientVarsReady:o,onClientVarsError:a,shouldHandOutError:s,sharedDocGuideOn:i},m),b=Object(it.j)(),y=n.length&&dt,E=Object(Ie.g)(),O=c&&c.getDocId()===E,C=c&&c.plugins.comment&&r&&b&&(n.length||this.isHadShownComment)||!b&&n.length||y&&r||p&&n.length;C&&!this.isHadShownComment&&(this.isHadShownComment=C);var k=x()({"has-comment":C,"has-comment-toggle":b,"has-comment-new":y&&r,"has-comment-new-close":y&&!r}),I=x()("etherpad-container-wrapper",k,"clearfix",{"wide-mode":g&&"wide"===g.mode}),S=!1===u&&(!d||f);return S||this.hasUpdateSectionNavBusinessStage||(this.hasUpdateSectionNavBusinessStage=!0,this.props.updateBusinessStage(at.b.Doc,at.c.SectionNavRendered)),M.a.createElement(j.Fragment,null,M.a.createElement(P.default,{bus:me.a},M.a.createElement(Se.a,{className:I,onScrollX:rt.a.safari&&b?this.checkSafariScrollX:void 0,onScrollY:i?this.checkScrollToBottomDebounced:void 0,containerRef:this.saveWrapperRef,options:{suppressScrollX:!0}},S&&M.a.createElement(B.a,{sharedDocGuideOn:i,editor:c}),b?M.a.createElement("div",{className:"etherpad-container-sub-wrapper"},t&&M.a.createElement(he.default,Object.assign({},v)),O&&M.a.createElement(de,{editor:c})):M.a.createElement(M.a.Fragment,null,t&&M.a.createElement(he.default,Object.assign({},v)),O&&M.a.createElement(de,{editor:c})),Object(it.t)()&&M.a.createElement(fe.a,null),M.a.createElement(we.a,{business:at.b.Doc,renderWhen:at.c.Done,renderOnTimeout:!0},M.a.createElement(lt,null),h&&this.isSupportTranslate&&M.a.createElement(ct,{editor:c,noteToken:t,noteType:l}),M.a.createElement(Le,null),M.a.createElement(Ke,null),M.a.createElement(Qe,null),rt.a.isInVC&&M.a.createElement(nt,null)))),c&&M.a.createElement(ut,null))}}]),t}(j.Component);ht.displayName="Etherpad",ht.contextTypes={openSideBar:R.a.func},ht.defaultProps={commentList:[]},st([Object(N.Bind)()],ht.prototype,"handleFullscreenEntered",null),st([Object(N.Bind)()],ht.prototype,"handleFullscreenExited",null),st([Object(N.Bind)()],ht.prototype,"closeSelectionPopupGuide",null),st([Object(N.Bind)(),Object(Oe.b)("click_help_doc",function(){return{withFileInfo:!0}})],ht.prototype,"gotoHelpDoc",null),st([Object(N.Bind)(),Object(Oe.b)("click_efficiency_guide",function(){return{withFileInfo:!0}})],ht.prototype,"handleHelperSidebarBtnClick",null);var ft=ht;k.a.end=Date.now();var pt=i("/PhZ"),gt=i("G2xZ"),mt=i("n3ZB"),vt=i("x/dr"),bt=i("qKwb"),yt=i("IyQe"),Et=i("t2s0"),Ot={fetchRecentObjs:pt.fetchRecentObjs,toggleFullscreen:gt.i,updateBusinessStage:ae.c},Ct=Object(r.createSelector)(ie.b,Q.j,J.q,J.n,J.o,$.p,mt.i,vt.a,vt.d,bt.c,$.h,J.v,Object(se.a)(ce.a.CONTENT),Object(se.b)("content"),function(e,t,n,i,r,o,a,s,c,l,u,d,h,f){var p=e.status.translated,g=Object(yt.getUserPermissions)(t.toJS()).readable;return{noteToken:i,noteType:r,commentList:o,userGuide:a,createDocGuideOn:s,sharedDocGuideOn:c,editor:l,docCommentShown:u,isWiki:n===oe.NUM_SUITE_TYPE.WIKI,wikiRelationEnabled:Et.i&&!p,canRead:g,enterTransMode:p,embedSidebarVisible:d,opendocContentConfig:f||h}}),kt=Object(n.connect)(Ct,Ot)(ft);t.default=kt},j1lG:function(e,t,n){"use strict";n.d(t,"J",function(){return o}),n.d(t,"l",function(){return a}),n.d(t,"M",function(){return s}),n.d(t,"K",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"r",function(){return d}),n.d(t,"s",function(){return h}),n.d(t,"x",function(){return f}),n.d(t,"t",function(){return p}),n.d(t,"u",function(){return g}),n.d(t,"v",function(){return m}),n.d(t,"y",function(){return v}),n.d(t,"B",function(){return b}),n.d(t,"n",function(){return y}),n.d(t,"o",function(){return E}),n.d(t,"m",function(){return O}),n.d(t,"w",function(){return C}),n.d(t,"D",function(){return i}),n.d(t,"j",function(){return _}),n.d(t,"g",function(){return w}),n.d(t,"I",function(){return j}),n.d(t,"A",function(){return M}),n.d(t,"C",function(){return L}),n.d(t,"L",function(){return R}),n.d(t,"z",function(){return N}),n.d(t,"P",function(){return D}),n.d(t,"p",function(){return x}),n.d(t,"e",function(){return P}),n.d(t,"f",function(){return B}),n.d(t,"H",function(){return U}),n.d(t,"N",function(){return z}),n.d(t,"O",function(){return H}),n.d(t,"k",function(){return F}),n.d(t,"q",function(){return k}),n.d(t,"E",function(){return S}),n.d(t,"h",function(){return q}),n.d(t,"i",function(){return Y}),n.d(t,"b",function(){return J}),n.d(t,"a",function(){return Q}),n.d(t,"F",function(){return V}),n.d(t,"G",function(){return K});var i,r,o="new-gallery",a="gallery-line",s="image-uploaded",c="gallery",l="clientside-gallery",u="clientside-image-uploaded",d="image-container-wrap",h="image-draggable",f="image-loading",p="data-image-guide",g="true",m="[".concat(p,'="').concat(g,'"]'),v="image-loading-view",b=" ",y=("".concat(b,"\n"),"drop-animate-left"),E="drop-animate-right",O=220,C=6;(r=i=i||{}).Drive="Drive",r.Doc="Doc",r.External="External";var k,I,S,T,_=/\/api\/box\/stream\/download\/(?:v\d+\/)?(all|cover)\/(\w*)/,w=/\/api\/file\/f\/(\w*)/,j=20,M=2,L=0,R="",N=20971520,D="TOGGLE_IMAGE_BORDER",x=[s,c,l,u],P=120,B=120,U=16/9,z=200,H=200,F="text/gallery";(I=k=k||{}).IMAGE_SET_HIGHLIGHT="IMAGE_SET_HIGHLIGHT",I.IMAGE_UPDATE_MARK="IMAGE_UPDATE_MARK",(T=S=S||{}).Initial="Initial",T.Loading="Loading",T.Finished="Finished",T.GifPreLoading="GifPreLoading",T.GifLoading="GifLoading",T.LoadingWithPreview="LoadingWithPreview";var V,W,K,Z,q=20,Y=40,J=8,Q={left:"flex-start",center:"center",right:"flex-end"};(W=V=V||{}).APanel="APanel",W.Drag="Drag",W.Paste="Paste",(Z=K=K||{}).Success="Success",Z.Fail="Fail"},jBvr:function(e,C,k){"use strict";(function(i){k.d(C,"a",function(){return O});var e=k("lwsE"),n=k.n(e),t=k("W8MJ"),r=k.n(t),o=k("a1gu"),a=k.n(o),s=k("Nsbk"),l=k.n(s),c=k("7W2i"),u=k.n(c),d=k("7EGn"),h=k("q1tI"),f=k.n(h),p=k("UlbS"),g=k("+/Fj"),m=(k("SFb0"),k("jp/M")),v=k("IyQe"),b=k("mRaX"),y=k("AiBH"),E=k("9g7G"),O=function(e){function t(e){var c;return n()(this,t),(c=a()(this,l()(t).call(this,e))).checkThisInEmbedPermissions=function(e){var t,n=e.embedObjPermissions,i=e.token,r=n?n.get(i):null;r&&(t=r.toJS(),c.checkShowPermissionPopup(t))},c.checkShowPermissionPopup=function(e){var t=e.ownersWithoutPerm,n=void 0===t?[]:t,i=e.ownersWithPerm,r=void 0===i?[]:i,o=e.permission,a=Object(v.embedObjPermission2Booleans)(o);c.embedObjPermission={permission:a,ownersWithoutPerm:n,ownersWithPerm:r}},c.handleOpenEmbedShareModal=function(){var e=c.props,t=e.openModal,n=e.token,i=e.title,r=e.closePopover,o=e.type,a=c.embedObjPermission,s=Object.assign({token:n,type:o,title:i},a);t(m.ui.MODAL_TYPES.EMBED_SHARE,{embedObj:s}),Object(b.L)(y.u.CLICK_EMBED_QUICK_SHARE,{from:"insert"}),r&&r()},c.isOpenInLark=Object(E.j)(),c.embedObjPermission={permission:{canInvite:!1,canPublicize:!1,canPublicizeWidely:!1},ownersWithoutPerm:[],ownersWithPerm:[]},c}return u()(t,e),r()(t,[{key:"UNSAFE_componentWillMount",value:function(){this.checkThisInEmbedPermissions(this.props)}},{key:"componentDidMount",value:function(){this.checkThisInEmbedPermissions(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.checkThisInEmbedPermissions(e)}},{key:"render",value:function(){var e=Object(d.default)(this.embedObjPermission,["permission","canInvite"],!1);if(this.isOpenInLark||!e)return null;var t=this.props.style,n="permission-prompt";return f.a.createElement("div",{style:t,className:"mention-popover comment-ignore-blur ".concat(n)},f.a.createElement("section",{className:"mention-pop-share"},f.a.createElement("div",{className:"mention-pop-share__quick-share"},f.a.createElement("div",{className:"share-notify"},f.a.createElement(g.a,{className:"permission-warning-icon"}),f.a.createElement("span",{className:"warning-text"},i("permission.embed.share_tips_2"))),f.a.createElement(p.Button,{type:"primary",onClick:this.handleOpenEmbedShareModal},i("permission.embed.share_btn")))))}}]),t}(f.a.PureComponent)}).call(this,k("2vAP"))},jDul:function(e,t,n){},jIuk:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var s=n("elsr"),c=n("Tqb2"),l=n("Muja"),i=n("SebV");function r(e,t){var n=e.getImageState(),i=n.inViewImages,r=n.demandLoadImages,o=t.inViewImages,a=t.demandLoadImages;return!Object(l.default)(o,i)||!Object(l.default)(a,r)}function o(e,t,n){return a(n,[{startLine:e,endLine:t},{startLine:e-5,endLine:t+5}])}function a(i,e){var r=e.map(function(e){return[]}),t=u(e);return d(i,t).forEach(function(n){e.forEach(function(e,t){f(i,n,e)&&r[t].push(n)})}),r}function u(e){return e.reduce(function(e,t){var n=Math.min(e.startLine,t.startLine);return e.startLine=Math.max(n,0),e.endLine=Math.max(e.endLine,t.endLine),e},e[0])}function d(t,e){try{return h(t,e)}catch(e){return console.error("[image plugin] getMatchedRangeImageEntities failed. Fall back to return all image entities."),Object(i.a)("[image plugin] getMatchedRangeImageEntities failed. Fall back to return all image entities."),Object(c.h)(t)}}function h(e,t){var n={line:t.startLine,offset:0,zoneId:s.a},i=e.getContentState().getZoneState(s.a),r=Math.min(t.endLine,i.length()-1),o=i.getLine(r),a={line:r,offset:o&&o.length()||0,zoneId:s.a};return Object(c.B)(e,n,a)}function f(e,t,n){var i=t.start,r=n.startLine,o=n.endLine,a=Object(c.y)(e,i);return r<=a&&a<=o}},jSUa:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var i,r,o="j-block-container";(r=i=i||{}).IFRAME_BLOCK="IFRAME_BLOCK",r.REACTION_BLOCK="REACTION_BLOCK",r.SHEET_BLOCK="SHEET_BLOCK",r.BITABLE_BLOCK="BITABLE_BLOCK",r.POLL_BLOCK="POLL_BLOCK",r.REMINDER_BLOCK="REMINDER_BLOCK",r.PLACEHOLDER_BLOCK="PLACEHOLDER_BLOCK",r.JIRA_ISSUE_BLOCK="JIRA_ISSUE_BLOCK",r.JIRA_FILTER_BLOCK="JIRA_FILTER_BLOCK",r.MINDNOTE_BLOCK="MINDNOTE_BLOCK",r.MENTION_BLOCK="mentionBlock",r.JEST_BLOCK="JEST_BLOCK",r.AT_USER_BLOCK="AT_USER_BLOCK",r.FILE_CARD_BLOCK="FILE_CARD_BLOCK",r.HTML_BLOCK="HTML_BLOCK",r.CHAT_CARD_BLOCK="CHAT_CARD_BLOCK",r.READ_PROCESS_BLOCK="READ_PROCESS_BLOCK",r.APPLICATION_CONTROL_BLOCK="APPLICATION_CONTROL_BLOCK",r.ISV_BLOCK="ISV_BLOCK"},jUga:function(e,t,n){"use strict";var i=n("J4zp"),c=n.n(i),r=n("lwsE"),o=n.n(r),a=function e(){var s=this;o()(this,e),this.changesetResolver=new Map,this.genKey=function(e,t){return"".concat(e,":").concat(t)},this.handleClientMessage_ACCEPT_COMMIT=function(e,t){var a,n=t.msg;0!==s.changesetResolver.size&&n&&n.changeset_apool&&(a=n.changeset_apool.numToAttrib||{},Object.keys(a).forEach(function(e){var t=c()(a[e],2),n=t[0],i=t[1],r=s.genKey(n,i),o=s.changesetResolver.get(r);o&&(c()(o,1)[0].call(null),s.changesetResolver.delete(r))}))},this.handleClientMessage_ERROR=function(e,t){var n=t.msg;0!==s.changesetResolver.size&&s.changesetResolver.forEach(function(e,t){e[1].call(null,n),s.changesetResolver.delete(t)})},this.sendMessageError=function(e,t){t.error;var n=t.msg;"USER_CHANGES"===n.type&&0!==s.changesetResolver.size&&s.changesetResolver.forEach(function(e,t){e[1].call(null,n),s.changesetResolver.delete(t)})},this.addCommitWatcher=function(i,r){return new Promise(function(e,t){var n=s.genKey(i,r);s.changesetResolver.set(n,[e,t])})}};t.a=a},jVwk:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var b=n("7Kxq"),y=n("y2sV"),i=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=t||e,r=i.selStart,o=i.selEnd,a=n.selStart,s=n.selEnd,c=e.lines.atIndex(e.selEnd[0])||{},l=c.text,u=c.lineMarker,d=(l||"").length,h=o[1]<d,f=" ";if(!r||!o)return"\n \n";0===r[0]&&"0"===e.zoneId&&(f="\n".concat(f));var p=0;a&&s&&a[0]===s[0]&&a[0]===r[0]&&s[1]===r[1]&&(p=s[1]-a[1]);var g,m=e.repManager.editor,v=r[1]>u+p;return m.version.includes(y.y)?(g=m.getContentState().getZoneState(e.zoneId).getLine(r[0]))&&(g.getLineAttributes().every(function(e){return b.c.includes(e[0])})||(v=!0)):v=Boolean(u)||v,v&&(f="\n "),h&&(f+="\n"),"sp"===e.attributeManager.findAttributeOnLine(e.selEnd[0],"template-placeholder")&&(f="\n \n"),f}},jbvk:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24"},t),c.a.createElement("path",{d:"M18.01 5.74l.5.5a.4.4 0 010 .56l-5.45 5.45 5.2 5.2a.4.4 0 010 .56l-.5.5a.4.4 0 01-.56 0L12 13.3l-4.95 4.95a.4.4 0 01-.56 0l-.5-.5a.4.4 0 010-.56l4.95-4.95-5.2-5.2a.4.4 0 010-.56l.5-.5a.4.4 0 01.56 0l5.2 5.2 5.45-5.45a.4.4 0 01.56 0z",fill:"#646A73",fillRule:"nonzero"}))}},jm1x:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 16 16"},t),c.a.createElement("g",{transform:"translate(-53 -4)",fill:"none",fillRule:"evenodd"},c.a.createElement("rect",{stroke:"#F1F2F3",x:".5",y:".5",width:"74",height:"23",rx:"11.5"}),c.a.createElement("path",{d:"M53 4h16v16H53z"}),c.a.createElement("path",{d:"M61 5a7 7 0 110 14 7 7 0 010-14zm0 1a6 6 0 100 12 6 6 0 000-12zm3.1 4.02l.34.33c.1.1.1.26 0 .36l-3.89 3.89c-.1.1-.25.1-.35 0l-.33-.34-.04-.04-1.92-1.95a.25.25 0 010-.36l.34-.33c.1-.1.25-.1.35 0l1.78 1.82 3.38-3.38c.1-.1.25-.1.35 0z",fill:"#646A73"})))}},jnLa:function(e,U,z){"use strict";(function(t){z.d(U,"a",function(){return B});var e=z("lSNA"),r=z.n(e),n=z("lwsE"),i=z.n(n),o=z("W8MJ"),a=z.n(o),h=z("xpYl"),s=z("hbEN"),f=z("7EGn"),p=z("Muja"),c=z("q1tI"),l=z.n(c),u=z("4ngZ"),d=z("tzkP"),g=z("YWBl"),m=z("n/R6"),b=z("kVAj"),y=z("SQ87"),E=z("OX8E"),O=z("YdHx"),C=z("Z5sO"),k=z("HmyT"),I=z("9BhA"),S=z("4D8z"),T=z("SyrE"),_=z("Trbk"),v=z("tRMT"),w=(z("It3V"),z("El0g"),z("QM+C")),j=z("vAXZ"),M=z("L1JX"),L="DocTable",R=S.f.DO_MERGE_CELL,N=S.f.DO_UN_MERGE_CELL,D=S.v.paddingLeft,x=S.v.paddingRight;function P(){}var B=(new(function(){function e(){var v=this;i()(this,e),this.verticalCrossCommentIndex=new Set,this.VCFllowPositionData={},this.loadingBlockMap={},this.handlesMap=new WeakMap,this.init=function(t,e){var n=!!e&&!!e.fullWidth,i=Object(f.default)(e,"platform"),r=Object(f.default)(e,"docInfo"),o={editor:t,isCommentCross:!1,isHovering:!1,hasCrossComment:!1,docbodyRect:void 0,positionData:[],fullWidth:n,fullWidthTag:n,platform:i,containerRect:v.getContainerRect(t),docInfo:r};return new u.h(t,{isCustomBackgroundColor:!1,isCustomBorder:!1,isCustomFont:!1,autoFocus:!1,isScrollable:!0,disableVertResize:!0,customContext:o,tableInit:function(e){v.initTablePicker(),v.registerCommand(e,t),v.bindEvents(e,t),v.unBindVCEvent=v.bindVCEvent()},render:function(e){return w.isPDFAccess&&j.b.do(j.a.PDF_TABLE,{table:e}),l.a.createElement(O.a,{instance:e})},tableWillMount:function(e){var t=e.editor,n=e.customContext.docInfo,i=v.getDocbodyRect(t,n);e.customContext.docbodyRect=i},tableDidMount:function(e){var t,n,i,r=e.editor,o=e.tableId,a=e.setCustomContext,s=e.getCustomContext,c=e.tableInstance,l=s(),u=l.fullWidthTag,d=l.docInfo;v.wrapHandleDocbodyResize=Object(h.a)(v.handleDocbodyResize,e),v.wrapHandleFullscreenEntered=Object(h.a)(v.handleFullscreenEntered,e),v.wrapHandleFullscreenExited=Object(h.a)(v.handleFullscreenExited,e),v.wrapHandleContentChange=Object(h.a)(v.handleContentChange,e),v.wrapHandleDragStatusChange=Object(h.a)(v.handleDragStatusChange,e),v.bindInstanceEvents(e),v.changeEditorBarVisible(!1,r),u&&(t=!!Object(f.default)(d,"withoutComment"),n={tableId:o,setCustomContext:a,getCustomContext:s,tableInstance:c},v.verticalCrossCommentIndex=new Set,t||0<(i=b.a.register(o)).length&&v.handleTableChange({data:i,context:n,forceUpdate:!0}),v.wrapHandleTableFullWidth=Object(h.a)(v.handleTableFullWidth,n),b.a.onhalfFullStartToChange(v.wrapHandleTableFullWidth),a({handleDocbodyResize:v.wrapHandleDocbodyResize,handleFullscreenEntered:v.wrapHandleFullscreenEntered,handleFullscreenExited:v.wrapHandleFullscreenExited,handleContentChange:v.wrapHandleContentChange,handleTableFullWidth:v.wrapHandleTableFullWidth,handleDragStatusChange:v.wrapHandleDragStatusChange}))},tableWillUnMount:function(e){v.removeInstanceEvents(e),v.wrapHandleDocbodyResize=P,v.wrapHandleFullscreenEntered=P,v.wrapHandleFullscreenExited=P,v.wrapHandleContentChange=P,v.wrapHandleDragStatusChange=P,v.wrapHandleTableFullWidth=P},tableDidUpdate:function(e){var t=e.prevState,n=e.nextState,i=(0,e.getCustomContext)().editor;t.selectedCellIds.length!==n.selectedCellIds.length&&v.changeEditorBarVisible(!(0<n.selectedCellIds.length),i)},tableDeleted:function(e){var t=e.type,n=e.tableId;e.tableInstance;Object(I.a)(n,t)},enterBuffer:function(e){e.idleTimer=Object(C.b)(function(){v.handleContentChange(e),e.idleTimer=0})},leaveBuffer:function(e){var t=e.idleTimer;t&&(Object(C.a)(t),t=0)},KeyDownEvent:function(){var e=document.getElementsByClassName("editbar-line__popover--visible");return!!(t.plugins.mention&&t.plugins.mention.docMention.isMentionBoxVisible()||e&&0<e.length)},destroy:function(e){var t=e.editor,n=e.tablePlugin;v.removeEvents(n,t),v.unBindVCEvent(),v.tablePicker.destroy(),v.tablePicker=null}})},this.showToast=function(){m.a.show({type:"success",closable:!0,duration:1e3,content:t("common.copied")})},this.onScroll=function(e){var t=e.scrollDirection,n=e.tableId,i=e.eventType,r=e.editor,o=Object(f.default)(r,"plugins.client");Object(I.g)(t,n,i,o),v.hideAButtonTemporary(e),v.triggerVCScroll(e)},this.changeEditorBarVisible=Object(s.default)(function(e,t){e?t.call("updateLinePopover"):t.call("editorbar:updateCaretPosition",{visible:!1,lineType:[]})},0),this.bindEvents=function(e,t){e.on("afterPasteInsert",I.d),e.on("afterCopy",v.showToast),e.on("insertTable",I.b),e.on("headerMouseDown",v.focusCellWhileHoveringTable),e.on("aceBlur",v.handleTableBlur),t.on("tableDidRender",I.c)},this.removeEvents=function(e,t){e.off("afterPasteInsert",I.d),e.off("afterCopy",v.showToast),e.off("insertTable",I.b),e.off("headerMouseDown",v.focusCellWhileHoveringTable),e.off("aceBlur",v.handleTableBlur),t.off("tableDidRender",I.c),v.tablePicker&&v.tablePicker.highlight.off("click")},this.removeInstanceEvents=function(e){var t=e.tableInstance,n=e.getCustomContext,i=e.editor,r=n(),o=r.fullWidthTag,a=r.handleDragStatusChange,s=r.blockContentRendered,c=r.handleBlockDidCreate;t.off("colHorzResize",v.hideAButtonTemporary),t.off("colHorzResize",v.tableHorzResizeCall),t.off("scroll",v.onScroll);var l,u=n(),d=u.handleContentChange,h=u.handleFullscreenExited,f=u.handleFullscreenEntered,p=u.handleTableFullWidth;o&&(l=e.tableId,b.a.unRegister(l),b.a.offhalfFullStartToChange(p),i.off("fullscreenEntered",f),i.off("fullscreenExited",h)),t.off(S.o.CONTEXT_CHANGE,d);var g=v.handlesMap.get(t);E.a.off("editorRectChange",g.editorRectChange),E.a.off("editorSizeChange",g.editorSizeChange),v.handlesMap.delete(t),i.off("blockContentRendered",s),i.eventEmitter.off("blockDidCreate",c),i.eventEmitter.off("blockDropSuccess",c),t.setTableHovering=function(){},t.toggleTableHeaderSelect=function(){},i.off("draggable:dragstatuschange",a)},this.bindInstanceEvents=function(e){var n=e.tableInstance,t=e.getCustomContext,i=e.setCustomContext,r=e.editor,o=t().fullWidthTag,a=v.handleBlockDidCreate.bind(v,e),s=v.handleBlockDidRendered.bind(v,e);i({handleBlockDidCreate:a,handleBlockDidRendered:s}),n.on("colHorzResize",v.hideAButtonTemporary),n.on("colHorzResize",v.tableHorzResizeCall),n.on("scroll",v.onScroll,r),r.on("blockContentRendered",s),r.eventEmitter.on("blockDidCreate",a),r.eventEmitter.on("blockDropSuccess",a),o&&(r.on("fullscreenExited",v.wrapHandleFullscreenExited),r.on("fullscreenEntered",v.wrapHandleFullscreenEntered)),n.on(S.o.CONTEXT_CHANGE,v.wrapHandleContentChange),E.a.on("editorRectChange",v.wrapHandleDocbodyResize),E.a.on("editorSizeChange",v.wrapHandleDocbodyResize),v.handlesMap.set(n,{editorRectChange:v.wrapHandleDocbodyResize,editorSizeChange:v.wrapHandleDocbodyResize}),n.setTableHovering=function(e){i({isHovering:e})},n.toggleTableHeaderSelect=function(e){var t=n.getTableHeaderRef();t&&t.onToggleSelect(e)},r.on("draggable:dragstatuschange",v.wrapHandleDragStatusChange)},this.registerCommand=function(o,a){a.commands.registerCommand(S.p,function(e,t,n,i){v.tablePicker.toggleDisplay(i),Object(g.a)({action:"table",source:i.source})},{statusKey:null}),a.commands.registerCommand(S.n,function(e,t,n,i){var r;a&&(r=0===a.selection.currentSelection.start.line),o.doInsertTable(i,!0,r)},{statusKey:null}),a.commands.registerCommand(R,function(){o.doMergeCell()},{statusKey:"merge-cell-true"}),a.commands.registerCommand(N,function(){o.doUnMergeCell()},{statusKey:"split-cell-true"}),v.tablePicker&&v.tablePicker.highlight.on("click",function(){var e=v.tablePicker.handleClickHighLight();a.commands.triggerCommand(S.n,{rect:e})})},this.triggerVCScroll=Object(s.default)(function(e){var t,n=e.tableId,i=e.scrollLeft;n&&(t=n.split(" ")[0],v.VCFllowPositionData=Object.assign({},v.VCFllowPositionData,r()({tableId:n,scrollLeft:i},t,i)),T.g.emit(_.i,L))},300),this.replayFollowActionHandler=function(e){var s=e.data;Object.keys(s).forEach(function(e){var t,n,i,r,o,a;"tableId"===e?(t=s.tableId,n=s.scrollLeft,t&&(i=t.split(" ")[0],Object(k.$)(".".concat(i," .tb-scrollable-content")).animate({scrollLeft:n}))):"scrollLeft"!==e&&(r=e.split(" ")[0],o=Object(k.$)(".".concat(r," .tb-scrollable-content")),a=s[e],o.scrollLeft!==a&&o.animate({scrollLeft:a}))})},this.handleTableBlur=function(e){e.toggleBorderHighlight(!1)},this.focusCellWhileHoveringTable=function(e){e&&e.checkIsFocused()||e.focusAndCollapseSelectionOntoCell(0,0)},this.handleDragStatusChange=function(e,t){var n=t.isDragging,i=e.tableInstance;n&&(i.disposeTableMouseSelection(),i.setState({selectedCellIds:[],selectType:u.g.MOVE})),i.customStatus.isAditDragging=n},this.handleFullscreenExited=function(e){var t=e.setCustomContext,n=(0,e.getCustomContext)().fullWidthTag;M.b.setIsFSMode(!1),n&&t({fullWidth:!0})},this.handleFullscreenEntered=function(e){var t=e.setCustomContext,n=(0,e.getCustomContext)().fullWidthTag;M.b.setIsFSMode(!0),n&&t({fullWidth:!1})},this.tableHorzResizeCall=function(e){var t=e.colWidth,n=e.diffX,i=e.colCellIds,r=e.editor;t&&n&&i&&r.call(S.B,{colWidth:t,diffX:n,colCellIds:i})},this.hideAButtonTemporary=function(e){var t,n,i,r,o,a,s,c,l,u,d=(0,e.getCustomContext)(),h=d.fullWidthTag,f=d.docbodyRect,p=d.isCommentCross,g=d.platform,m=d.containerRect;h&&(t=e.isCellIdBelongToTableId,n=e.getOffsetOfCellLeftToTableLeft,i=e.getTableScrollWidth,r=e.scrollLeft,o=e.editor,t&&(v.linePopoverTimer&&clearTimeout(v.linePopoverTimer),o.call("editorbar:toggleAButtonVisible",!1),a=i(),c=(s=Object(y.a)({fullWidth:h,docbodyRect:f,tableTotalWidth:a,isCommentCross:p,scrollLeft:r,platform:g,containerRect:m})).marginLeft,l=s.marginRight,u=f.innerWidth-x-D-l-c,n()<u&&(v.linePopoverTimer=window.setTimeout(function(){o.call("updateLinePopover")},150))))},this.getDocbodyRect=function(e,t){var n=e.getRect(),i=n.width,r=n.right,o=n.left,a=Object(f.default)(t,"paddingLeft",S.l),s=Object(f.default)(t,"paddingRight",S.m);return{width:i,right:r,left:o,innerWidth:i-a-s,paddingLeft:a,paddingRight:s}},this.getContainerRect=function(e){var t=e.getScrollContainer();if(t){var n=t.getBoundingClientRect(),i=t.clientWidth;return{left:n.left,right:n.left+i,width:i,height:n.height}}return{left:0,right:0,width:0,height:0}},this.handleDocbodyResize=function(e){var t,n,i,r,o,a,s,c=e.getCustomContext,l=e.setCustomContext,u=e.isInBuffer,d=e.containerRect;u&&(n=(t=c()).docbodyRect,i=t.editor,r=t.docInfo,o=v.getDocbodyRect(i,r),a={},Object(p.default)(n,o)||(a.docbodyRect=o),s=v.getContainerRect(i),Object(p.default)(d,s)||(a.containerRect=s),l(a))},this.initTablePicker=function(){v.tablePicker=new d.a},this.handleTableChange=function(e){var t,n,i,r=e.data,o=e.context,a=e.forceUpdate,s=o.tableId,c=o.setCustomContext,l=o.getCustomContext,u=o.tableInstance,d=l(),h=d.hasCrossComment;d.platform===S.q&&(v.tableId=s,t=r.map(function(e){return[e.top,e.top+e.height]}),n=l().positionData,Object(p.default)(t,n)?v.halfFullIsChanged():(v.getTableShowStatus("COMMENT_CHANGE",u,t),i=!!v.verticalCrossCommentIndex.size,document.querySelector(".".concat(s.split(" ")[0]," .tb-scrollable-width-over"))||a?h!==i?(c({isCommentCross:i,hasCrossComment:i,positionData:t},v.halfFullIsChanged),Object(I.f)(i,s)):c({positionData:t},v.halfFullIsChanged):c({positionData:t,hasCrossComment:i,isCommentCross:i},v.halfFullIsChanged)))},this.handleTableFullWidth=function(e,t,n){v.uuid=t,v.handleTableChange({data:n,context:e})},this.getTableShowStatus=function(e,t,n){var i=t.getCustomContext().positionData;if(!t.calcUpdateTableRectInfo()&&e===S.o.CONTEXT_CHANGE)return!1;var r=e!==S.o.CONTEXT_CHANGE?n:i;v.verticalCrossCommentIndex.clear();var o=t.tableRectInfo,a=o.get("top"),s=o.get("bottom");return r&&r.forEach(function(e,t){a>=e[0]&&a<=e[1]&&v.verticalCrossCommentIndex.add(t),s>=e[0]&&s<=e[1]&&v.verticalCrossCommentIndex.add(t),a<=e[0]&&s>=e[1]&&v.verticalCrossCommentIndex.add(t)}),!0},this.handleContentChange=function(e){var t,n=e.tableInstance,i=e.getCustomContext,r=e.setCustomContext;if(e.isInBuffer){var o=i(),a=o.hasCrossComment,s=o.platform,c=v.getTableShowStatus(S.o.CONTEXT_CHANGE,n);if(s&&s===S.q){if(!c)return;t=!!v.verticalCrossCommentIndex.size}a!==t&&(r({isCommentCross:t,hasCrossComment:t}),Object(I.f)(t,n.tableId))}},this.halfFullIsChanged=function(){b.a.halfFullIsChanged(v.tableId,v.uuid)},this.getZoneIdByBlockId=function(e){var t=document.querySelector(".block-id-".concat(e)),n=t&&t.closest(".ace-editor");return n?n.getAttribute("data-zone-id"):null},this.getBlockTypeByBlockId=function(e,t){var n=e.editor,i=n&&n.plugins&&n.plugins.blockPlugin.getBlockInfo(t),r=i&&i.instance;return r?r.blockType:null},this.fixCellWidthToBlock=function(e,t){var n,i,r=e.tableInstance,o=v.getZoneIdByBlockId(t);o&&r.getAllChildZones().includes(o)&&(n=r.getCellLayoutWidth(o),i=r.getRowAndColIndicesForCellId(o),n&&i&&(r.setColumnWidth(i.colIndex,n),e.editor.call("horzResizeEnd")))},this.handleBlockDidCreate=function(e,t,n){var i=n||v.getBlockTypeByBlockId(e,t);i&&(S.c.includes(i)||S.d.includes(i))&&(S.d.includes(i)?v.loadingBlockMap[t]=!0:v.fixCellWidthToBlock(e,t))},this.handleBlockDidRendered=function(e,t,n){var i=n||v.getBlockTypeByBlockId(e,t);i&&S.d.includes(i)&&v.loadingBlockMap[t]&&(delete v.loadingBlockMap[t],v.fixCellWidthToBlock(e,t))}}return a()(e,[{key:"bindVCEvent",value:function(){var e=this;return Object(v.registerVCModule)({moduleName:L,getCurrentModuleState:function(){return{data:e.VCFllowPositionData}}}),T.g.on("".concat(_.g,":").concat(L),this.replayFollowActionHandler),function(){T.g.off("".concat(_.g,":").concat(L),e.replayFollowActionHandler),Object(v.unregisterVCModule)(L)}}}]),e}())).init}).call(this,z("2vAP"))},jq0X:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("J4zp"),d=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),h=n("FJEn"),c=n("2ACu"),l=200,u=function(){function t(e){var u=this;o()(this,t),this.guidCountMap={},this.countStarted=!1,this.taskTimeout=null,this.duplicatedCount=0,this.totalLineGuidCount=0,this.onMount=function(){u.countStarted||(u.countStarted=!0,u.collectCount())},this.endCount=function(){u.guidCountMap={},u.totalLineGuidCount=0,u.duplicatedCount=0},this.getBatchRange=function(e,t){var n=t*l,i=n+l-1,r=!1;return e<=i&&(i=e-1,r=!0),[n,i,r]},this.collectCount=function(){var e=function c(l){return function(){for(var e=u.editor.getRep(h.DEFAULT_REP_ZONE).lines.length(),t=u.getBatchRange(e,l),n=d()(t,3),i=n[0],r=n[1],o=n[2],a=i;a<=r;a++){var s=u.editor.getAttributeOnLine(h.DEFAULT_REP_ZONE,a,"lineguid");""!==s&&(u.guidCountMap[s]=u.guidCountMap[s]?u.guidCountMap[s]+1:1,u.totalLineGuidCount=u.totalLineGuidCount+1)}o?(u.taskTimeout=null,u.collectStatistics()):u.taskTimeout=setTimeout(c(l+1),0)}};u.taskTimeout=setTimeout(e(0),0)},this.collectStatistics=function(){for(var e=0,t=Object.values(u.guidCountMap);e<t.length;e++)t[e]<=1||(u.duplicatedCount=u.duplicatedCount+1);Object(c.default)("doc_duplicated_lineguid",{duplicated_count:u.duplicatedCount,all_count:u.totalLineGuidCount}),u.endCount()},this.editor=e}return s()(t,[{key:"destroy",value:function(){this.taskTimeout&&clearTimeout(this.taskTimeout),this.endCount(),this.countStarted=!1}}]),t}()},juOH:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 16 16"},t),c.a.createElement("path",{d:"M5 4a2 2 0 114 0 2 2 0 01-4 0zM7 .66a3.33 3.33 0 100 6.67A3.33 3.33 0 007 .66zM2.75 12.02c.3-1.15 1.34-2 2.58-2H8.7c.18 0 .33-.15.33-.33v-.67a.33.33 0 00-.33-.33H5.33a4 4 0 00-4 4V14.33c0 .37.3.67.67.67h6.69c.18 0 .33-.15.33-.34V14a.33.33 0 00-.33-.34H2.67v-.97c0-.23.03-.46.08-.67zM13 9h-.67a.33.33 0 00-.33.33V11h-1.67a.33.33 0 00-.33.33V12c0 .18.15.33.33.33H12V14c0 .18.15.33.33.33H13c.18 0 .33-.15.33-.33v-1.67H15c.18 0 .33-.15.33-.33v-.67A.33.33 0 0015 11h-1.67V9.33A.33.33 0 0013 9z",fill:"#646a73",fillRule:"evenodd"}))}},juX9:function(e,t){e.exports='<div id="aceTablePicker" class="ace-table-picker hidden">\n    <div class="tips">{{{tips}}}</div>\n    <div class="unhighlight"></div>\n    <div class="highlight"></div>\n</div>\n'},k2k2:function(e,t,n){"use strict";n.r(t);var i=n("o0o1"),s=n.n(i),r=n("yXPU"),o=n.n(r),a=n("OX8E"),c=n("Trbk"),l=n("tRMT"),u=n("mUXZ"),d=n("5dbN"),h=n("EVj1"),f=n("lQZd"),p=n("wAsq"),g=n("toa8"),m=n("AESI"),v=n("QM+C"),b=n("VIFs"),y=n("iP/4"),E=n("2ACu"),O=n("1dfU"),C=n("i+co"),k={application:["render"],SheetImage:["SheetImage"]},I=function(e,t,n){var i=e.body[t];return i&&n.forEach(function(e){var t=i[e];t&&Object.keys(t.data).map(function(e){t.data[e]=Object(O.a)(t.data[e])})}),JSON.stringify(e)};function S(t){var e=t.event,n=t.message,i=t.followState,r=t.module,o=t.actionType,a=Object.keys(k);if(i)try{var s=JSON.parse(i);r&&(t.followState=I(s,r,a[r]))}catch(e){t.followState=Object(O.a)(i)}return-1<[C.c.ON_FOLLOW_ACTION,C.c.DISPATCH_MODULE].indexOf(e)&&r&&-1<a.indexOf(r)&&o&&-1<k[r].indexOf(o)&&n&&(t.message=Object(O.a)(n)),t}var T,_,w=n("lwsE"),j=n.n(w),M=n("W8MJ"),L=n.n(M),R=n("QILm"),N=n.n(R),D=n("vEhQ");(_=T=T||{})[_.android=1]="android",_[_.ios=2]="ios",_[_.unknown=3]="unknown";var x="bear://return/_fetchQueue/",P="window.lark.";function B(){var e=navigator.userAgent;return/android|LKPDesktop/i.test(e)?T.android:/iPad|iPhone|iPod/.test(e)?T.ios:T.unknown}var U={debug:!1,logPrefix:"bridge",report:E.default},z=function(){function t(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};j()(this,t),this.config=e,this.eventMap={},this.androidEntrance="lkpDesktopApi",this.handleMessageFromNative=function(e){var t=r.parseMessageFromNative(e);try{var n=t.responseId,i=t.responseData;n&&r.trigger(n,i)}catch(e){r.log("in handleMessage",e,!0)}},this.config=Object.assign({},U,{},e),window.lark=this.getProxy("")}return L()(t,[{key:"setConfig",value:function(e){this.config=Object.assign({},this.config,{},e)}},{key:"register",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(t.isBridgeCall)throw new Error("cant register an existing method");this.on(e,t,n),this.setIsKeep(e,!(!n||!i))}},{key:"unregister",value:function(e,t){if(this.eventMap[e])if(t){for(var n=this.eventMap[e].length-1;0<=n;n--)if(this.eventMap[e][n]===t)return void this.eventMap[e].splice(n,1)}else delete this.eventMap[e]}},{key:"initNative",value:function(o){var a=this,s=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],c=2<arguments.length?arguments[2]:void 0,l=3<arguments.length?arguments[3]:void 0,u=4<arguments.length?arguments[4]:void 0,e=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.callback,n=void 0===t?null:t,i=N()(e,["callback"]);c&&console.info("".concat(a.config.logPrefix," ").concat(o," ").concat(c(i)));var r=l?l(i):i;a.invoke(o,r,n,s,!!u)};this.on(o,e,!0),this.setCallNative(o,!0)}},{key:"clear",value:function(){for(var e in this.eventMap)this.eventMap[e].isCallNative||this.eventMap[e].isKeep||delete this.eventMap[e]}},{key:"getProxy",value:function(r){try{var o=this;return new Proxy(function(){},{get:function(e,t){var n=r?"".concat(r,".").concat(t):t;if(o.eventMap[n]){var i=o.call.bind(o,n);return i.isBridgeCall=!0,i}return e[t]||(e[t]=o.getProxy(n))},set:function(){return!1}})}catch(e){return this.config.report&&this.config.report("doc_mobile_proxy_error",{errorMsg:e.message}),console.error("in bridge Proxy",e.message),this.noProxy=!0,{}}}},{key:"on",value:function(i,e,t){var n,r=this;i&&(this.addCallbackToMap(i,e,t),this.noProxy&&((n=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.call.apply(r,[i].concat(t))}).isBridgeCall=!0,Object(D.a)(window.lark,i,n)))}},{key:"call",value:function(t){for(var n,e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];if(this.log("call ".concat(t),i),this.eventMap[t]){try{this.eventMap[t].forEach(function(e){var t=e.apply(null,i);null!=t&&(n=t)}),this.eventMap[t].isOnce&&delete this.eventMap[t]}catch(e){this.log("message:  ".concat(e.message,"\n stack:").concat(e.stack),Object.assign({},i,{method:t}),!0)}return n}}},{key:"genCallbackId",value:function(e){return"callback.func_".concat(e.replace(/\./g,"")).concat(Date.now(),"_").concat(Math.floor(1e4*Math.random()))}},{key:"addCallbackToMap",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(this.eventMap[e]||(this.eventMap[e]=[]),!this.eventMap[e].isCallNative)if(n)this.eventMap[e]=[t];else{for(var i=this.eventMap[e].length-1;0<=i;i--)if(this.eventMap[e][i]===t)return;this.eventMap[e].push(t)}}},{key:"setCallNative",value:function(e,t){this.eventMap[e]&&(this.eventMap[e].isCallNative=t)}},{key:"setIsOnce",value:function(e,t){this.eventMap[e]&&(this.eventMap[e].isOnce=t)}},{key:"setIsKeep",value:function(e,t){this.eventMap[e]&&(this.eventMap[e].isKeep=t)}},{key:"injectCallback",value:function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=3<arguments.length?arguments[3]:void 0;this.on(e,t,!0),this.setIsOnce(e,n),i&&this.setIsKeep(e,i)}},{key:"invoke",value:function(e,t,n,i,r){var o;n&&(o=this.genCallbackId(e),this.injectCallback(o,n,i,r),o="".concat(P).concat(o)),this.postMessage({handlerName:e,callbackId:o,data:t})}},{key:"trigger",value:function(e,t){this.call(e.replace(P,""),t)}},{key:"log",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];(this.config.debug||n)&&console.log("".concat(this.config.logPrefix||""," ").concat(n?"error":""),e,t)}},{key:"parseMessageFromNative",value:function(t){var n;if("string"==typeof t)try{n=JSON.parse(t)}catch(e){n=JSON.parse(t.replace(/\n/g,"")),this.log("JSON.parse",t,!0)}else n=t;var e=n.responseId,i=n.responseData;if(e)try{n.responseData=JSON.parse(i)}catch(e){n.responseData=i}return n}},{key:"postMessage",value:function(e){var t=B(),n=e.handlerName,i=e.callbackId,r=e.data;switch(t){case T.android:this.postMessageToAndroid({handlerName:n,callbackId:i,data:r});break;case T.ios:try{window.webkit&&window.webkit.messageHandlers.invoke.postMessage({method:n,args:Object.assign({},r,{callback:i})})}catch(e){this.log("postMessage to Native ".concat(e.message),null,!0)}}}},{key:"postMessageToAndroid",value:function(e){var t=JSON.stringify([e]),n=this.androidEntrance||"";window[n]&&window[n].prompt(x+encodeURIComponent(t))}}],[{key:"getInstance",value:function(e){return t.instance?e&&t.instance.setConfig(e):t.instance=new t(e),t.instance}}]),t}().getInstance();z.initNative("biz.vcSdk.onFollow"),z.initNative("biz.vcSdk.followReady"),z.initNative("biz.vcSdk.onTitleChanged"),z.initNative("biz.vcSdk.onLocationEvent");var H=z,F="PRESENTER_FOLLOWER_LOCATION",V="SUITE_TITLE_CHANGE",W=function(){function t(e){var n=this;j()(this,t),this.vcSdk=null,this.sendFollowReady=function(){return window.lark.biz.vcSdk.followReady()},this.sendNewActionsToNative=function(e){window.lark.biz.vcSdk.onFollow({event:c.j,actions:e})},this.sendFollowLocation=function(e){return window.lark.biz.vcSdk.onLocationEvent(e)},this.sendChangeTitle=function(e){return window.lark.biz.vcSdk.onTitleChanged(e)},this.startRecord=function(){n.vcSdk&&(n.vcSdk.on(c.j,n.sendNewActionsToNative),n.vcSdk.startRecord())},this.getCurrentStatus=function(){if(n.vcSdk)return n.vcSdk.getCurrentStatus()},this.replayActions=function(e){var t;n.vcSdk&&(t=e.actions||e.states,n.vcSdk.replayActions(t))},this.vcSdk=e,this.bridgeBinding("on"),this.init()}return L()(t,[{key:"init",value:function(){this.vcSdk&&(this.sendFollowReady(),this.vcSdk.on(F,this.sendFollowLocation),this.vcSdk.on(V,this.sendChangeTitle))}},{key:"destroy",value:function(){this.bridgeBinding("off"),this.vcSdk&&this.vcSdk.destroy(),this.vcSdk=null}},{key:"bridgeBinding",value:function(e){var t;this.vcSdk&&(H[t="on"===e?"register":"unregister"]("biz.vcSdk.on",this.vcSdk.on),H[t]("biz.vcSdk.startRecord",this.startRecord),H[t]("biz.vcSdk.stopRecord",this.vcSdk.stopRecord),H[t]("biz.vcSdk.startReplay",this.vcSdk.startFollow),H[t]("biz.vcSdk.stopReplay",this.vcSdk.stopReplay),H[t]("biz.vcSdk.replayActions",this.replayActions),H[t]("biz.vcSdk.getCurrentStatus",this.getCurrentStatus),H[t]("biz.vcSdk.getActions",this.vcSdk.getActions))}}],[{key:"init",value:function(e){t.lkpVcSdk=new t(e)}}]),t}();n.d(t,"getRenderId",function(){return ie}),n.d(t,"init",function(){return re});var K=y.a.isLKP?"".concat(Object(f.g)()).concat(Object(h.l)(location.href).vcwebid||""):"vcId".concat(Date.now());a.a.on("".concat(c.c,":").concat(c.e,":").concat(K),function(e){Object(E.default)("follow_action",S(e))});var Z,q,Y=new l.default({id:K,eventEmitter:a.a});function J(e){Object(p.c)("presenter",Object(O.a)(Object(f.g)(e))),Object(p.c)("follower",Object(O.a)(Object(f.g)(e)))}var Q=function(){var n=o()(s.a.mark(function e(t,n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,q=n,a.a.emit("".concat(c.c,":BEFORE_RENDER"),n),Object(p.a)(),Y.refresh(),J(t),e.next=8,Z(t);case 8:return e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",!1);case 14:case"end":return e.stop()}},e,null,[[0,11]])}));return function(e,t){return n.apply(this,arguments)}}(),X=function(e){var t=Object(h.m)(e).pathname,n=Object(d.locateRoute)(t),i=n.isDoc,r=n.isSheet,o=n.isMindnote,a=n.isFile;return i||r||o||a},$=function(){Object(l.registerVCFunc)("getTitleByUrl",ee),Object(l.registerVCFunc)("checkRenderURL",X),Object(l.registerVCFunc)("render",Q),Object(l.registerVCFunc)("setVcWaterMark",ne)};function ee(e){return te.apply(this,arguments)}function te(){return(te=o()(s.a.mark(function e(t){var n,i,r,o,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(b.isDocUrl)(Object(h.f)(t))){e.next=2;break}return e.abrupt("return",null);case 2:if(n=Object(h.k)(t,!0),i=n.token,r=n.type,i&&r){e.next=5;break}return e.abrupt("return",null);case 5:return e.prev=5,e.next=8,g.d.get(m.GET_META,{params:{type:v.mapFileType2TypeNum[r],token:i}});case 8:return o=e.sent,a=o.data.title,e.abrupt("return",a);case 13:return e.prev=13,e.t0=e.catch(5),e.abrupt("return",null);case 16:case"end":return e.stop()}},e,null,[[5,13]])}))).apply(this,arguments)}function ne(){a.a.emit("setVcWaterMark")}function ie(){return q}var re=function(e){Z=e,window.vcSdk=Y,$(),J(),y.a.isLKP?W.init(Y):Object(u.a)(Y)}},k5zB:function(e,S,T){"use strict";(function(c){T.d(S,"a",function(){return I});var e=T("o0o1"),d=T.n(e),t=T("yXPU"),i=T.n(t),n=T("lwsE"),r=T.n(n),o=T("W8MJ"),a=T.n(o),s=T("a1gu"),l=T.n(s),u=T("Nsbk"),h=T.n(u),f=T("7W2i"),p=T.n(f),g=T("xpYl"),m=T("q1tI"),v=T.n(m),b=(T("NHsQ"),T("SCx9")),y=T("TSYQ"),E=T.n(y),O=T("5gSl"),C=T("aXiW"),k=T("UlbS"),I=function(e){function t(e){var u;return r()(this,t),(u=l()(this,h()(t).call(this,e))).handleClick=function(){var n=i()(d.a.mark(function e(t,n){var i,r,o,a,s,c,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(O.a)(n),u.props.handleToggleOpen(),i=u.props.commentNumbers[t].commentIds,r=i[0],o=u.props.commentPosition.find(function(e){return e.commentId===r})){e.next=7;break}return e.abrupt("return");case 7:return a=o.context,s=a.serviceToken,c=a.serviceType,(l=u.props.editor.plugins.comment).deactivateComment(),e.next=12,l.activateComment(c,s,r,null,!1);case 12:u.props.editor.call(b.c.CLICK_COMMENT_ON_DOC,{serviceType:c,serviceToken:s,commentId:r,activeTop:t}),Object(C.a)("client_comment_panel").push({source:"bubble"});case 14:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),u.state={activeTop:null,show:!1},u}return p()(t,e),a()(t,[{key:"componentDidMount",value:function(){var e=this;this.showTimeId=window.setTimeout(function(){e.setState({show:!0})},100)}},{key:"componentWillUnmount",value:function(){this.showTimeId&&window.clearTimeout(this.showTimeId)}},{key:"renderNumberView",value:function(){var e,t,n,i,r=this.props.commentNumbers,o=this.state.activeTop,a=[],s=25;for(e in 0<Object.keys(r).length&&Object.keys(r).map(Number).sort(function(e,t){return e-t}).reduce(function(e,t){if(t<e+s){var n=r[e],i=r[t];return r[e]={listCount:n.listCount+i.listCount,line:n.line,commentIds:n.commentIds.concat(i.commentIds)},delete r[t],e}return t}),r)e&&(t=r[e].listCount,n=Number(e),i=E()("comment-number-item",{"comment-number-item--hl":n===o}),a.push(v.a.createElement(k.Tooltip,{key:n,title:c("comment.show_comment"),placement:"left"},v.a.createElement("div",{className:i,style:{top:n},onClick:Object(g.a)(this.handleClick,n)},v.a.createElement("div",{className:"comment-number-item__text"},t)))));return a}},{key:"render",value:function(){return this.state.show?v.a.createElement("div",{className:"comment-numbers comment-number-view"},this.renderNumberView()):null}}]),t}(m.PureComponent)}).call(this,T("2vAP"))},k7EW:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u});var i=n("rLED"),r=n("U6jp"),o=n("EyGs"),a=Object(r.j)("appVersion"),s=Object(i.N)("download_manager_least_version",""),c=Object(o.a)(a,s),l=Object(i.N)("native_download_manager_least_version",""),u=Object(i.I)("native_download_manager_enabled",!1)&&Object(o.a)(a,l)},k8MZ:function(e,t,n){"use strict";var i=n("yG8O"),r=n.n(i),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("U+yc"),u=n.n(l),g=(n("1ABj"),n("7EGn")),f=n("OZf9"),w=n("HmyT"),d=n("YWjA"),h=n("iP/4"),p=n("FJEn"),m=n("D7h9"),v=n("qYkn"),j=n("H6oK"),M=n("+0ye"),b=n("J4zp"),y=n.n(b);function L(e){if(!(void 0!==e.editorInfo.ace_getAttributesOnSelection().attribs.find(function(e){return"list"===y()(e,1)[0]})))return!1;var t=e.rep,n=t.selStart[0];if(n!==t.selEnd[0])return!1;var i=t.selStart[1];return t.selEnd[1]-i==t.lines.atIndex(n).text.length-1}var E,O,C,k=n("HIeq"),I=n("Ngi8"),S=n("D28M"),T=n("y2sV"),R=n("dn8U"),N=n("zTCG"),D=n("p3Wu");n.d(t,"a",function(){return W});var x=p.config.EDITOR_EVENTS,P=/doc-token-(\S+)/,_="solid ".concat("#e3e5ea"," 1px"),B={borderLeft:_,borderRight:_,borderBottom:_,borderTop:_,verticalAlign:"top"},U={border:"none",borderCollapse:"collapse"},z=["number","bullet","check","done"],H="",F=!1;function V(e,t){return e.isBlockElement(t)&&"\n"!==t.innerText}var W=(E=Object(T.J)(1e4),O=function(){function t(e){var _=this;a()(this,t),this.postAceInit=function(e,t){_.ace=t.editorInfo},this.getStyleForNode=function(m,v,b){Object(f.a)(m,function(e,t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g=Object(w.$)(e);_.docToken=_.getDocToken(e),_.maybeCopyZone(g,"ace-table",!0)||_.maybeCopyZone(g,N.a.CODE_BLOCK)||((n=g.find(".pocket-ignore")).length&&n.remove(),i=t===m.length-1,_.getCommonStyle(e,i,v,b),e=_.convertIndent(e),o=Object(w.$)(e).hasClass("blockquote"),a=Object(M.b)(e),s=Object(w.$)(e).find('[class^="list-check"],[class^="list-done"]'),c=Object(w.$)(e).find('[class^="list-number"],[class^="list-bullet"]'),l=0<s.length,u=0<c.length,d=_.list(c,u),h=_.checkBox(s,l),f=d||h,o&&(p="margin: 0 0 0 22px;\n                      border-left: solid 2px ".concat(I.N600," !important;\n                      color: ").concat(I.N600,";\n                      padding-left: 12px!important;"),d?d.firstChild.innerHTML='<blockquote style="'.concat(p,'">').concat(d.firstChild.innerHTML,"</blockquote>"):(r=Object(w.$)("<blockquote></blockquote>").attr("style",_.styles+p).addClass(_.docToken),_.quoteKeepOtherClass(g,r))),f?(a&&Object(w.$)(f).addClass(a),r?(r.html(f),Object(w.$)(e).replaceWith(r)):Object(w.$)(e).replaceWith(f)):r&&(r.html(Object(w.$)(e).html()),Object(w.$)(e).replaceWith(r)))})},this.getDocToken=function(e){var t=e.classList,n=P.exec(t);if(n)return n[0]},this.aceCopy=function(e,t){if(""===t.html&&!t.text)return t;var n=Object(w.$)("<span></span>"),i=!Object(k.h)(t.html);n.html(t.html),_.wrapTextsInSingleLine(n,t);var r=n.children();0===r.length&&(F=!0),_.getStyleForNode(r,t.e.target,i),_.mergeListDom(n);var o=n.find("img");return 0<o.length&&Object(d.c)(o),Object(d.b)(),F?(F=!1,h.a.isEdge?{html:t.html,text:n.text()}:void 0):(t.html=n.html(),t.text=H.replace(/\u00A0|\u200B|\u0008/g,_.convertTextChar),H="",t)},this.wrapTextsInSingleLine=function(e,t){var n=e.children().length&&["span","b","i","u","s","a"].includes(e.children()[0].nodeName.toLowerCase()),i=0===e.children().length,r=t.e,o=t.editorInfo,a=t.rep,s=r.target,c=Object(w.$)(s).closest(".ace-line")[0];if(c&&(i||n)){for(var l,u=null,d=_.correctAtUserEventTarget(s),h=o.getLine(),f=a.lines.atIndex(h),p=a.selStart[1]===f.lineMarker&&a.selEnd[1]===f.text.length,g=L(t),u=i?(l=document.createElement(s.tagName||"span"),d&&(l.className=Object(R.a)(d.className)),l.innerHTML=t.html,Object(w.$)(l)):1===e.children().length?e.children()[0]:e.clone();d&&d!==c;){var m,v=Object(w.$)(d).parent().clone(),b=v.is("li, ol, ul"),y=v.is(".blockquote")&&p,E=b&&g,O=d.parentElement===c,C=-1<c.className.indexOf("heading-"),k=O&&(y||g||C),I=v.length&&!v.attr(j.DATA_META_BLOCK_PROPS)&&(!b||E);v.length&&!p&&O&&(m=/list-div|(list-start-number\s+)|ol-[0-9a-z]+|blockquote/gi,v[0].className=v[0].className.replace(m," ")),(k||I&&(i||n||E))&&(u=v.html(u)),d=d.parentElement}var S,T=Object(M.b)(u.get(0));!T||(S=Object(M.c)(T))<7&&(u=Object(w.$)("<h".concat(S,">")).html(u)),e.html(u)}},this.editorWillCopy=function(e){var t,n,i,r=_.editor,o=e.deltaSet,a=e.range,s=a.start,c=s.zoneId,l=s.line,u=s.offset,d=r.getContentState(),h=d.hasLineMarker(a.start)?1===u:0===u,f=d.getZoneState(a.end.zoneId).getLine(a.end.line).isEndOfLine(a.end.offset),p=a.start.line===a.end.line;p&&a.start.offset===a.end.offset||(t=p&&(h&&!f||!h),n=d.getLineAttributes(c,l).toMap(),t&&n.list&&z.some(function(e){return n.list.includes(e)})&&(n.list="",n.start="",n["ol-id"]="",n["origin-start"]="",n[D.d]=""),t&&n.blockquote&&delete n.blockquote,t&&n["text-indent"]&&delete n["text-indent"],n&&n.lmkr&&!Object(g.default)(o.get(c),"ops[0].attributes.lmkr")&&(n.lineguid="",i=new T.E({zoneId:c}).insertLineMarker(n),e.deltaSet=o.compose(i)))},r()(this,"editorWillSetClipboard",C,this),this.getListText=function(e){var t=e.querySelectorAll("[data-list]")||[];return t.length?Array.from(t).reduce(function(e,t){var n=/(number|bullet|check|done)(\d+)/.exec(t.dataset.list),i=_.getLiTextWithoutInnerIndent(t);if(n){var r="",o=n[1],a=Math.max(parseInt(n[2]),1),s="  ".repeat(a-1);switch(o){case"number":r=s+t.dataset.start+". "+i;break;case"done":r=s+"[x] "+i;break;case"check":r=s+"[ ] "+i;break;case"bullet":r=s+"- "+i}e+=r}return e},"")||e.textContent:""},this.getLiTextWithoutInnerIndent=function(e){var t=Array.from(e.childNodes);return!t[t.length-1]||"OL"!==t[t.length-1].tagName&&"UL"!==t[t.length-1].tagName||t.pop(),t.map(function(e){return e.textContent}).join("")||""},this.convertTextChar=function(e){return""===e||"\b"===e?"":""===e?" ":void 0},this.getBase64Imgage=function(e){var t=e[0],n=document.createElement("canvas"),i=e.attr("src");n.width=t.naturalWidth,n.height=t.naturalHeight,n.getContext("2d").drawImage(t,0,0,n.width,n.height,0,0,n.width,n.height);var r=n.toDataURL();e.attr("src",r),e.attr("data-src",i)},this.list=function(e,t){if(t){var n=/list-(number|bullet)(\d+)/,i=/ol-id([\w]{8})/,r=e[0].className,o=e[0].parentElement.className,a=e[0].dataset.originStart,s=e[0].start,c=n.exec(r),l=i.exec(o),u=c?c[2]:null,d=c?c[1]:null,h=l?l[0]:null,f=e.children();return _.creatList(u,d,s,a,f,h)}},this.checkBox=function(e,t){if(t){var n=/list-(check|done)(\d+)/,i=e[0].className,r=n.exec(i),o=r?r[2]:null,a=r?r[1]:null,s=e[0].innerHTML;return _.creatCheckBox(o,a,s)}},this.creatCheckBox=function(e,t,n){if(!e||!t)return!1;e<1&&(e=1);for(var i,r,o=e,a=_.styles+"list-style-type: none; margin: 0;",s='<input type="checkbox"  style="margin-right: 2px;">',c='<input type="checkbox" checked  style="margin-right: 2px;">';0<e;){e--;var l=Object(w.$)("<ul></ul>").addClass("list-"+t+o).addClass(_.docToken).css("padding-left",0);if(r||(r=l).attr("style",a).css("padding-left","".concat(e,"em")),i&&Object(w.$)(i).html(l),0===e){l.append(n);var u=l.find("li");return u.css("list-style-type","none"),"check"===t?u.prepend(s):u.prepend(c),r}i=l}},this.creatList=function(e,t,n,i,r,o){if(!e||!t)return!1;e=Number(e);for(var a,s,c=_.styles+"margin: 0",l="number"===t?"ol":"ul",u=0;u<e;){u++;var d=document.createElement(l);if(d.classList.add(t+u,"ace-line"),o&&d.classList.add(o),_.docToken&&Object(w.$)(d).addClass(_.docToken),s||(s=d,Object(w.$)(s).attr("style",c)),a&&Object(w.$)(a).html(d),e===u)return Object(w.$)(d).append(r),n&&Object(w.$)(d).attr("start",n),i&&(d.dataset.originStart=i),s;a=d}},this.getLineText=function(e){var t=Object(w.$)(e).find("ol,ul"),n=0<t.length,i=e.innerText;if(n){for(var r=/list-(number|bullet|check|done)(\d+)/,o=t[0].className,a=t[0].start,s=r.exec(o),c=s?s[2]:null,l=s?s[1]:null,u="",d=0;d<c-1;d++)u+="  ";switch(l){case"number":i=u+a+". "+i;break;case"done":i=u+"[x] "+i;break;case"check":i=u+"[ ] "+i;break;case"bullet":i=u+"- "+i}}return i},this.getCommonStyle=function(e,t,n,i){var r=_.getLineText(e);H+=r,!t&&V(_.ace,e)&&(H+="\n");var o,a,s,c,l,u,d,h=e.id||e.children[0]&&e.children[0].id,f=_.getRealDomByMagicDomId(e,h);f&&(o=i?window.getComputedStyle(n,null):window.getComputedStyle(f,null)),o?(a=o.backgroundColor||"",s=o.fontSize||"",c=o.textAlign||"",l=o.fontWeight||"",u=o.color||"",d=o.lineHeight||"",_.styles="background-color: ".concat(a,";\n                      font-size: ").concat(s,";\n                      text-align: ").concat(c,";\n                      font-weight: ").concat(l,";\n                      line-height: ").concat(d,";\n                      color: ").concat(u,";"),Object(w.$)(e).attr("style",_.styles),Object(w.$)("#".concat(h),e).attr("style",_.styles)):_.styles="",Object(w.$)(e).removeClass(function(e,t){return(t.match(/(^|\s)lineguid-\S+/g)||[]).join(" ")})},this.getRealDomByMagicDomId=function(e,t){var n,i=(Object(w.$)(e).closest(".ace-editor, #innerdocbody")[0]||document).querySelector("#".concat(t));return i||(n=_.ace.getRep().lines.indexOfKey(t),i=_.ace.preRenderer.getLineNodeInPreRenderer(n)),i},this.aceCut=function(e,t){return _.aceCopy(e,t)},this.handleCopyTextFail=function(e){e.on(x.COPY_WITHOUT_PERMISSION,function(){m.default.dispatch(Object(v.a)())})},e&&(this.editor=e,this.postAceInit("",Object.assign({editorInfo:e},e)),this.handleCopyTextFail(e))}return c()(t,[{key:"quoteKeepOtherClass",value:function(e,t){var n=e.attr("class"),i=n.match(/align-\S+/),r=n.match(/heading-\S+/);i&&i[0]&&t.addClass(i[0]),r&&r[0]&&t.addClass(r[0])}},{key:"maybeCopyZone",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=e.find(".".concat(t));if(i.length||e.hasClass(t)&&(i=e),!i.length)return!1;n&&(i.css(U),i.find("td").css(B),this.docToken&&i.addClass(this.docToken));for(var r,o,a=e.find(".ace-editor"),s=0;s<a.length;++s)this.getStyleForNode(Object(w.$)(a[s].children));return n&&(!(r=e.find("span").get(0))||(o=Object(R.a)(r.className))&&i.addClass(o),e.replaceWith(i[0].outerHTML)),!0}},{key:"getListInfoFromDom",value:function(e){if(!e)return null;var t=e.className,n=/(number|bullet)(\d+)/.exec(t),i=/ol-id([\w]{8})/.exec(t);return{listType:n?n[1]:null,listNum:n?Number(n[2]):null,olId:i?i[1]:null}}},{key:"getInheritClassNameList",value:function(e){var t=[];return e.classList.forEach(function(e){0===e.indexOf("heading")&&t.push(e)}),t}},{key:"mergeListDom",value:function(e){var d=this,t=e.children(),h=null;Object(f.a)(t,function(e,t){var n=Object(w.$)(e).find("[class^=number],[class^=bullet]").last()[0]||e;if(!("TABLE"===e.tagName||0<Object(w.$)("table",e).length)&&/(number|bullet)(\d+)/.test(n.className)&&n){var i=e.getAttribute("style"),r=d.getInheritClassNameList(e);0<r.length&&Object(w.$)(n).removeClass(r),n.removeAttribute("style");var o=d.getListInfoFromDom(n),a=d.getListInfoFromDom(h);if(!a||a.olId!==o.olId){var s=Object(w.$)(n).children();return s.addClass(r),i&&s.attr("style",i),void(h=n)}for(;a.listNum>o.listNum;)if(h=h.parentElement,!(a=d.getListInfoFromDom(h)))return void(h=n);var c=a.listNum<o.listNum,l=Object(w.$)(n).children();l.addClass(r),i&&l.attr("style",i);for(var u=a.listNum;u<o.listNum;u++)l=l.parent();Object(w.$)(e).replaceWith(""),Object(w.$)(h).append(l),c&&(h=n)}else h=null})}},{key:"convertIndent",value:function(e){if(!e.classList.contains("ace-line"))return e;var t,n=0,i=0;return e.classList.contains("text-indent")&&(n=1),!e.children.length||(t=/list-indent(\d+)/.exec(e.children[0].className))&&(i=parseInt(t[1])),i&&1===e.children.length&&e.children[0]instanceof HTMLUListElement&&1===e.children[0].children.length&&e.children[0].children[0]instanceof HTMLLIElement&&(Object(w.$)(e.children[0]).css("list-style-type","none"),Object(w.$)(e.children[0].children[0]).css("list-style-type","none"),Object(w.$)(e.children[0]).css("padding-left","0"),Object(w.$)(e.children[0].children[0]).css("padding-left","0"),Object(w.$)(e.children[0]).css("vertical-align","bottom"),Object(w.$)(e.children[0].children[0]).css("vertical-align","bottom"),Object(w.$)(e.children[0]).css("margin-top","0").css("margin-bottom","0")),(n||i)&&Object(w.$)(e).css("margin-left","".concat(i+2*n,"em")),e}},{key:"correctAtUserEventTarget",value:function(e){var t=Object(S.o)(e,"mention-type_0");return t?Object(S.o)(t,"block-type-AT_USER_BLOCK"):e}}]),t}(),C=u()(O.prototype,"editorWillSetClipboard",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var n=this;return function(e){var t;e.node&&e.node.childNodes&&(t="",Array.from(e.node.childNodes).forEach(function(e){["ol","ul"].includes(e.tagName.toLowerCase())?t+=n.getListText(e):t+=e.textContent}),e.text=t)}}}),O);new W},kESg:function(e,t,n){"use strict";n.d(t,"h",function(){return f}),n.d(t,"j",function(){return p}),n.d(t,"k",function(){return a}),n.d(t,"a",function(){return v}),n.d(t,"l",function(){return g}),n.d(t,"e",function(){return b}),n.d(t,"b",function(){return y}),n.d(t,"m",function(){return E}),n.d(t,"f",function(){return O}),n.d(t,"c",function(){return C}),n.d(t,"d",function(){return k}),n.d(t,"g",function(){return I}),n.d(t,"i",function(){return S});var i,r,o,a,s,c=n("lSNA"),l=n.n(c),u=n("H6oK"),d=n("AiBH"),h=n("YNKm"),f=10,p=8;(s=a=a||{}).ZoneId="zoneId",s.ZoneType="zoneType";var g,m,v="aceTable";(m=g=g||{}).Table="table",m.CodeBlock="codeBlock",m.CalloutBlock="calloutBlock",m.Default="default";var b={SPAN:"zone-plugin-region",ACE_LINE:"zone-plugin-ace-line",SELECTED:"zone-selected",SCROLL_CONTAINER:"zone-scroll-container"},y=[g.CodeBlock,g.CalloutBlock],E='<div class="ace-zone-loading-container"><div class="ace-zone-loading"><div class="ace-zone-loader"><svg class="circular" viewBox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4" stroke-miterlimit="10"></circle></svg></div></div></div>',O={ALL_ZONE_DID_RENDER:"ALL_ZONE_DID_RENDER"},C=(i={},l()(i,g.CodeBlock,[u.BlockType.AT_USER_BLOCK,u.BlockType.REMINDER_BLOCK,u.BlockType.EQUATION_BLOCK]),l()(i,g.CalloutBlock,[u.BlockType.AT_USER_BLOCK,u.BlockType.REMINDER_BLOCK,u.BlockType.EQUATION_BLOCK]),i),k=(r={},l()(r,g.CodeBlock,{blocks:Object.values(u.BlockType).filter(function(e){return!C[g.CodeBlock].includes(e)}),attribs:["list","heading","blockquote","image-uploaded","gallery","clientside-gallery","image-previewer","horizontal-line",d.h,a.ZoneType]}),l()(r,g.CalloutBlock,{blocks:Object.values(u.BlockType).filter(function(e){return!C[g.CalloutBlock].includes(e)}),attribs:["image-uploaded","gallery","clientside-gallery","image-previewer","horizontal-line",d.h,a.ZoneType]}),r),I=(o={},l()(o,g.CodeBlock,[h.Q,h.c,h.a,h.d,h.b,h.F,h.h,h.I,h.K,h.L,h.V,h.g,h.f,h.e,h.C,h.o,h.N]),l()(o,g.CalloutBlock,[h.Q,h.F,h.K,h.L,h.V,h.g,h.f,h.e,h.C,h.o,h.N]),o),S={ZONE_DID_MOUNT:"zone_did_mount"}},kGVy:function(e,s,c){"use strict";(function(h){var e=c("lwsE"),t=c.n(e),n=c("hMnB"),f=c.n(n),i=c("q1tI"),p=c.n(i),g=c("toa8"),m=c("2ACu"),u=c("1PvN"),v=c("6jTl"),b=c("VIFs"),y=c("lQZd"),r=c("F4ZU"),o=c("6s36"),a=function e(){t()(this,e)};a.fetchRevertHistory=function(e){var s=e.historyId,c=e.userId,t=e.token,l=e.hooks;return Object(o.a)(r.a,t).then(function(e){return u.a.formatHistoryRecordsFromLocal(e)}).then(function(e){var t=e.find(function(e){return e.key===s});if(t){var n=u.a.getAlinesData(t.data,c,l),i=n.initialAttributedText,r=n.apool,o=n.initialAttributedTexts,a=n.tableMeta;return{clientVars:{snapshots:[{content:JSON.stringify({table_meta:JSON.stringify({rows:o.rows,cols:o.cols,attribs:a,pool:r}),attributed_texts:JSON.stringify({texts:o.text,attribs:o.attribs}),text:i.text,attribs:i.attribs,pool:JSON.stringify(r)})}]}}}})},a.revert=function(e,t){if(!t)return Promise.resolve();var n=t.snapshots[0],i=JSON.parse(n.content),r=i.text,o=i.attribs,a=i.attributed_texts,s=i.table_meta,c=i.pool,l=JSON.parse(a),u=JSON.parse(s),d=JSON.stringify({text:r,attribs:o,pool:c,attributed_texts:JSON.stringify({texts:l.texts,attribs:l.attribs}),table_meta:JSON.stringify({rows:u.rows,cols:u.cols,attribs:u.attribs,pool:c})});return Object(m.collectSuiteEvent)("history",{action:"revert",source:"local-history",eventType:"click",targetId:e.id||"",targetClass:e.className||""}),Object(m.default)("dev_revert_local_history",{content_length:d.length}),Object(m.collectSuiteEvent)("create_new_objs",{action:"clone_new_doc",source:"local_restore",eventType:"click",targetId:"",targetClass:"",create_file_type:"doc"}),g.d.post("/api/explorer/create/",{type:2,origin_content:d,token:Object(y.g)()}).then(function(e){var t=e.data,n=f.a.origin+Object(b.prependSpace)("/doc/".concat(t.obj_token,"/"));v.a.show({title:h("etherpad.restored_successfully"),body:p.a.createElement("div",null,p.a.createElement("div",null,h("etherpad.local_restored_tips")),p.a.createElement("a",{className:"local-url",target:"_blank",href:n},n)),footer:null})})},s.a=a}).call(this,c("2vAP"))},kOe7:function(e,b,y){"use strict";(function(e){y.d(b,"i",function(){return i}),y.d(b,"f",function(){return o}),y.d(b,"h",function(){return s}),y.d(b,"a",function(){return h}),y.d(b,"c",function(){return f}),y.d(b,"g",function(){return p}),y.d(b,"b",function(){return g}),y.d(b,"e",function(){return m}),y.d(b,"d",function(){return v});var t,n,i,r,o,a,s,c,l=y("lSNA"),u=y.n(l),d=y("QM+C");(r=i=i||{})[r.USER=0]="USER",r[r.DOC=1]="DOC",r[r.FOLDER=2]="FOLDER",r[r.SHEET=3]="SHEET",r[r.SHEET_DOC=4]="SHEET_DOC",r[r.CHAT=5]="CHAT",r[r.GROUP=6]="GROUP",r[r.BLOCK=7]="BLOCK",r[r.BITABLE=8]="BITABLE",r[r.TABLE=9]="TABLE",r[r.INLINE_BLOCK=10]="INLINE_BLOCK",r[r.MINDNOTE=11]="MINDNOTE",r[r.BOX=12]="BOX",r[r.SLIDE=15]="SLIDE",r[r.WIKI=16]="WIKI",(a=o=o||{})[a.DOC=0]="DOC",a[a.DOC_COMMENT=1]="DOC_COMMENT",a[a.SHEET=2]="SHEET",a[a.SHEET_COMMENT=3]="SHEET_COMMENT",a[a.BITABLE=4]="BITABLE",a[a.OPEN_DOC=6]="OPEN_DOC",a[a.BOX_COMMENT=9]="BOX_COMMENT",a[a.MINDNOTE=10]="MINDNOTE",a[a.MINDNOTE_COMMENT=11]="MINDNOTE_COMMENT",(c=s=s||{})[c.LARK=0]="LARK";var h=[i.DOC,i.SHEET,i.BITABLE,i.MINDNOTE,i.BOX,i.SLIDE,i.WIKI],f=(t={},u()(t,i.DOC,d.NUM_FILE_TYPE.DOC),u()(t,i.SHEET,d.NUM_FILE_TYPE.SHEET),u()(t,i.BITABLE,d.NUM_FILE_TYPE.BITABLE),u()(t,i.MINDNOTE,d.NUM_FILE_TYPE.MINDNOTE),u()(t,i.BOX,d.NUM_FILE_TYPE.FILE),u()(t,i.SLIDE,d.NUM_FILE_TYPE.SLIDE),u()(t,i.WIKI,d.NUM_FILE_TYPE.WIKI),t),p=(n={},u()(n,d.NUM_FILE_TYPE.DOC,i.DOC),u()(n,d.NUM_FILE_TYPE.SHEET,i.SHEET),u()(n,d.NUM_FILE_TYPE.BITABLE,i.BITABLE),u()(n,d.NUM_FILE_TYPE.MINDNOTE,i.MINDNOTE),u()(n,d.NUM_FILE_TYPE.FILE,i.BOX),u()(n,d.NUM_FILE_TYPE.SLIDE,i.SLIDE),u()(n,d.NUM_FILE_TYPE.WIKI,i.WIKI),n),g={1:e("etherpad.server_abnormal"),2:e("error.args_error"),3:e("error.object_not_found"),4:e("error.no_permission"),5:e("warn.login_required_tips"),6:e("error.request_timeout")},m=420,v=390}).call(this,y("2vAP"))},kPRI:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("BScZ"),r=n("2ACu"),o=n("BMm3"),a=n("8wYP"),s=n("PCTH"),c=n("X4VC"),l=n("xKvl"),u=!1;function d(){u||(u=!0,Object(i.f)({LogService:{teaLogger:l.b,collectEvent:r.default,collectSuiteEvent:r.collectSuiteEvent,collectCommentLog:r.collectCommentLog},Utils:{findDocPositions:o.b,getExistZoneIdsInEditor:c.a,getAttributeTextList:a.b,notifyCollapse:s.g}}))}},kSYH:function(e,t,n){},"kVV+":function(e,t,n){"use strict";var o=n("OZf9"),i=n("b6qs"),r=n("1PvN"),a=n("zLXu"),s=n("AiBH"),c={reset:function(){i.a.reset()},update:function(e){var t=l(e);Object(a.a)(null,t,s.z.DOC,r.b,"history-list")}};function l(e){var i=[],r=/\smention-chatId_(\S*)\s/;return Object(o.a)(e,function(e){e&&e.change&&Object(o.a)(e.change,function(e){var t,n=e.match(r);n&&n[1]&&(t=n[1],i.push(t))})}),i}t.a=c},kWuU:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("lwsE"),r=n.n(i),o=n("UXvI"),a=n("NRFK"),s=n("OX8E"),c=n("8VaN"),l=function e(t){var i=this;r()(this,e),this.aceInitialized=function(e,t){i._ace=t.editorInfo,a.a.init(i._ace)},this.aceSelectionChanged=function(e,t){var n=t.rep;i.Rep=n,i._ace.selection.isCaret(i.Rep)?i._setVisible(!1):i._showRangecodeBomb(i._ace)},this.handleSpecialSelectionChange=function(e){var t=e.reps,n=e.selectedCellIds;t&&n&&t.length===n.length&&i._showRangecodeBomb(i._ace,t)},this.reset=function(){s.a.off(c.a,i._setVisible),i._showRangecodeBomb=null,i._ace=null,a.a.destory()},this._setVisible=function(e){e?a.a.showEntry(i._ace):a.a.hideEntry()},this._showRangecodeBomb=Object(o.default)(a.a.showEntry,300,{trailing:!0}),t&&(this.aceInitialized("",Object.assign({editorInfo:t},t)),s.a.on(c.a,this._setVisible),t.on("specialSelectionChange",this.handleSpecialSelectionChange))};new l},kaax:function(e,t,n){"use strict";var i=n("7EGn"),r=n("VIFs");function o(e,t){if(t instanceof RegExp){if(!t.global)throw new TypeError("matchAll called with a non-global RegExp argument: ".concat(t))}else t=new RegExp(e,"g");t.lastIndex=0;for(var n=null,i=t.exec(e);null!==i;)n?n.push(i):n=[i],i=t.exec(e);return n}var a=n("toa8"),s="pano/api/BatchGetMentionEntitiesByUrl",c=function(){var e=Object(r.isStagingEnv)()?"oa.feishu-staging.cn":"oa.feishu.cn",t=Object(i.default)(window,"globalConfig.common.domain.pano",e);return"https://".concat(t,"/").concat(s)};function l(e){return a.d.post(c(),e,{headers:{"Content-Type":"application/json"},withCredentials:!0})}var u,d,h,f,p=/https?:\/\/(?=\S*\/client\/pano\/tag\-view\/open)\S+/gi,g=function(e){var t=o(e,p);return t?t.map(function(e){return e[0]}):null},m=function(e){return l({userId:window.User.id,tenantId:window.User.tenantId,urls:e})};(d=u=u||{})[d.Click=1]="Click",(f=h=h||{})[f.None=0]="None",f[f.Redirect=1]="Redirect",n.d(t,"b",function(){return g}),n.d(t,"c",function(){return m})},kmoK:function(e,t,n){"use strict";var i=n("lwsE"),o=n.n(i),r=n("W8MJ"),a=n.n(r),l=n("7EGn"),u=n("QM+C"),d=n("vc5i"),h=n("D7h9"),s=n("EVj1"),f=n("jJw9"),c=n("o0o1"),p=n.n(c),g=n("J4zp"),m=n.n(g),v=n("yXPU"),b=n.n(v),y=n("hbEN"),E=n("ZSG8"),O=n("lQZd"),C=function(){function e(){var r=this;o()(this,e),this.tasks=[],this.spaceInfoMapping={},this.fetchSpaceInfo=b()(p.a.mark(function e(){var t,n,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===r.tasks.length)return e.abrupt("return");e.next=2;break;case 2:return t={objs:r.tasks.map(function(e){return{obj_token:e,obj_type:u.NUM_FILE_TYPE.DOC}}),need_all_space:!1},e.prev=3,e.next=6,h.default.dispatch(Object(E.c)(t));case 6:n=e.sent,i=n.payload,r.tasks=[],r.spaceInfoMapping=Object.assign({},r.spaceInfoMapping,{},Object.entries(i).reduce(function(e,t){var n=m()(t,2),i=n[0],r=n[1];return e[i]=r.map(function(e){return{wikiToken:e.wiki_token,spaceName:e.space_name,spaceId:e.space_id}}),e},{})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(e.t0);case 15:case"end":return e.stop()}},e,null,[[3,12]])})),this.fetchSpaceInfo=Object(y.default)(this.fetchSpaceInfo,50)}return a()(e,[{key:"addTask",value:function(e){var t=Object(s.k)(e,!0),n=t.token;t.type===u.FILE_TYPE.DOC&&Object(O.b)(n)&&(this.tasks.push(n),this.fetchSpaceInfo())}},{key:"getSpaceInfo",value:function(){return this.spaceInfoMapping}}]),e}(),k=n("lSNA"),I=n.n(k),S=function(){function e(){var r=this;o()(this,e),this.tasks=[],this.spaceInfoMapping={},this.fetchSpaceInfo=b()(p.a.mark(function e(){var t,n,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===r.tasks.length)return e.abrupt("return");e.next=2;break;case 2:return t=r.tasks,e.prev=3,e.next=6,h.default.dispatch(Object(E.b)({wikiTokens:t}));case 6:n=e.sent,i=n.payload,r.tasks=[],r.spaceInfoMapping=Object.assign({},r.spaceInfoMapping,{},Object.entries(i).reduce(function(e,t){var n=m()(t,2),i=n[0],r=n[1];return Object.assign({},e,I()({},i,[{wikiToken:r.wiki_token,spaceName:r.space_name,spaceId:r.space_id}]))},{})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(e.t0);case 15:case"end":return e.stop()}},e,null,[[3,12]])})),this.fetchSpaceInfo=Object(y.default)(this.fetchSpaceInfo,50)}return a()(e,[{key:"addTask",value:function(e){var t=Object(s.k)(e,!0),n=t.token;t.type===u.FILE_TYPE.WIKI&&Object(O.b)(n)&&(this.tasks.push(n),this.fetchSpaceInfo())}},{key:"getSpaceInfo",value:function(){return this.spaceInfoMapping}}]),e}(),T=new(function(){function e(){o()(this,e),this.handlers=[new C,new S],this.addTask=this.addTask.bind(this)}return a()(e,[{key:"parseHTML",value:function(e){var n=this;e&&0!==e.length&&e.forEach(function(e){var t=n.genDom(e).querySelectorAll("a");Array.prototype.map.call(t,function(e){return e.href}).forEach(function(e){return n.addTask(e)}),t=null})}},{key:"addTask",value:function(t){this.handlers.forEach(function(e){return e.addTask(t)})}},{key:"findSpaceInfos",value:function(t){return this.handlers.map(function(e){return e.getSpaceInfo()}).find(function(e){return e[t]})||{}}},{key:"isDocInCurrentSpace",value:function(e){var t=Object(d.c)(h.default.getState()),n=Object(l.default)(t,"spaceId"),i=this.findSpaceInfos(e);if(!i[e])return!1;var r=i[e].find(function(e){return e.spaceId===n});return!!r&&r.spaceId===n}},{key:"getWikiUrl",value:function(e){var t=this.getToken(e),n=t.token,i=t.hash,r=this.findSpaceInfos(n);if(!r[n])return e;var o=Object(d.c)(h.default.getState()),a=Object(l.default)(o,"spaceId"),s=r[n][0],c=r[n].find(function(e){return e.spaceId===a})||s;return Object(f.getFullUrl)({type:u.FILE_TYPE_URL_MAP[u.NUM_SUITE_TYPE.WIKI],token:c.wikiToken,hash:i})}},{key:"genDom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t}},{key:"getToken",value:function(e){return Object(s.k)(e,!0)}},{key:"isWiki",value:function(){return Object(d.q)(h.default.getState())===u.NUM_SUITE_TYPE.WIKI}}]),e}());t.a=T},kohC:function(e,t,n){"use strict";var i=n("o0o1"),p=n.n(i),r=n("yXPU"),o=n.n(r),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),l=n.n(c),m=n("LrWZ"),v=n("Muja"),u=n("Mpt7"),b=n("D7h9"),g=n("MUo5"),d=n("5cZX"),h=n("eL/v"),f=n("vc5i"),y=n("IyQe"),E=n("2spZ"),O=10,C=new(function(){function e(){s()(this,e),this.instances={}}return l()(e,[{key:"reroll",value:function(e){var t=this.getEmbedObjMap(e),n=Object(d.K)(b.default.getState()).getIn([e,"embedObjects"]),i=[];if(n){var r=!0,o=!1,a=void 0;try{for(var s,c=n.keys()[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;t[l]||i.push(l)}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}0<i.length&&b.default.dispatch(Object(g.removeEmbedObjects)(e,i))}}},{key:"ensureToken",value:function(e){this.instances[e]||(this.instances[e]=new Set)}},{key:"getEmbedObjMap",value:function(e){if(!this.instances[e])return{};var t={},n=!0,i=!1,r=void 0;try{for(var o,a=this.instances[e][Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.getEmbedObjs(),c=!0,l=!1,u=void 0;try{for(var d,h=s[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var f=d.value;t[f.token]=f}}catch(e){l=!0,u=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw u}}}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}},{key:"add",value:function(e,t){this.ensureToken(e),this.instances[e].add(t),this.reroll(e)}},{key:"delete",value:function(e,t){this.ensureToken(e),this.instances[e].delete(t),this.reroll(e)}},{key:"destroyToken",value:function(e){delete this.instances[e]}}]),e}()),k=function(){function r(e){var g=this,t=e.embedObjList,n=e.onPermissionChange,i=e.onError;s()(this,r),this.ready=!1,this.olbEmbedObjPermission=Object(u.Map)({}),this.oldEmbedObjList=[],this.handleStoreChangeForNetworkState=function(){var e=Object(h.a)(b.default.getState());e&&!g.isOnline&&(g.isOnline=e,g.fetchEmbedObjPermissions()),g.isOnline=e},this.handleStoreChangeForPermission=function(){if(g.ready){var e=g.selectEmbedObjPermission();if(e!==g.olbEmbedObjPermission||!Object(v.default)(g.oldEmbedObjList,g.embedObjList)){var n=g.oldEmbedObjList,t=g.olbEmbedObjPermission.filter(function(e,t){return 0<n.filter(function(e){return e.token===t}).length});g.olbEmbedObjPermission=e,g.oldEmbedObjList=g.embedObjList.slice(0);var i=[],r=!0,o=!1,a=void 0;try{for(var s,c=g.embedObjList[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l,u,d,h=s.value,f=e.get(h.token),p=t.get(h.token);Object(m.a)(f)||(!Object(m.a)(f)&&Object(m.a)(p)||!Object(m.a)(p)&&f.get("permission")!==p.get("permission")||!Object(m.a)(p)&&f.get("userPermissions")!==p.get("userPermissions"))&&(l=f.get("permission"),u=f.get("userPermissions"),d=Object.assign({},h,Object.assign({},f.toJS(),{permission:Object(y.embedObjPermission2Booleans)(l),userPermissions:Object(y.permission2Booleans)(u)})),i.push(d))}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}0<i.length&&g.onPermissionChange&&g.onPermissionChange(i)}}else g.checkEnvReady()},this.embedObjList=t&&t.slice(0)||[],this.onPermissionChange=n,i&&(this.onError=i),this.unsubscribePermission=b.default.subscribe(this.handleStoreChangeForPermission),this.unsubscribeNetworkState=b.default.subscribe(this.handleStoreChangeForNetworkState),this.isOnline=Object(h.a)(b.default.getState()),this.checkEnvReady()}function e(e){return t.apply(this,arguments)}var t;return l()(r,[{key:"checkEnvReady",value:function(){var e=b.default.getState(),t=Object(f.n)(e),n=Object(f.o)(e);Object(m.a)(t)||Object(m.a)(n)||(this.ready=!0,this.envInfos={token:t,type:n},this.bootstrap(),this.fetchEmbedObjPermissions())}},{key:"bootstrap",value:function(){C.add(this.envInfos.token,this)}},{key:"fetchEmbedObjPermissions",value:(t=o()(p.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ready&&this.isOnline){e.next=2;break}return e.abrupt("return");case 2:n=this.envInfos,i=n.token,r=n.type,a=!(o=!0),s=void 0,e.prev=6,c=this.getSplitedEmbedObjList(t)[Symbol.iterator]();case 8:if(o=(l=c.next()).done){e.next=18;break}return u=l.value,d=u.map(function(e){return{token:e.token,type:e.type}}),h=b.default.dispatch(Object(g.fetchEmbedObjectPermissions)(i,r,d)),f=b.default.dispatch(Object(g.fetchUserPermissionOnEmbedObj)(d,i)),e.next=15,Promise.all([h,f,Object(E.c)(1e3)]);case 15:o=!0,e.next=8;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(6),a=!0,s=e.t0;case 24:e.prev=24,e.prev=25,o||null==c.return||c.return();case 27:if(e.prev=27,a)throw s;e.next=30;break;case 30:return e.finish(27);case 31:return e.finish(24);case 32:case"end":return e.stop()}},e,this,[[6,20,24,32],[25,,27,31]])})),e)},{key:"getSplitedEmbedObjList",value:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:O;return(e||this.getEmbedObjs()).reduce(function(e,t){return e.slice(-1)[0].length===n&&e.push([]),e.slice(-1)[0].push(t),e},[[]])}},{key:"findEmbedObj",value:function(e,n){var i=-1;return e.forEach(function(e,t){e.token===n.token&&(i=t)}),i}},{key:"selectEmbedObjPermission",value:function(){return this.ready&&Object(d.K)(b.default.getState()).getIn([this.envInfos.token,"embedObjects"])||Object(u.Map)({})}},{key:"fetchEmbedObjsAllPerm",value:function(){this.fetchEmbedObjPermissions()}},{key:"updateEmbedObjList",value:function(e){Object(v.default)(this.embedObjList,e)||(this.removeEmbedObjs(this.embedObjList),this.addEmbedObjs(e))}},{key:"addEmbedObjs",value:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=this.findEmbedObj(this.embedObjList,s);-1===c?(t.push(s),this.embedObjList.push(s)):this.embedObjList[c].title!==s.title&&(this.embedObjList[c]=s,t.push(s))}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}0<t.length&&this.fetchEmbedObjPermissions(t)}},{key:"removeEmbedObjs",value:function(e){var t=[],n=[],i=!0,r=!1,o=void 0;try{for(var a,s=this.embedObjList[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value;-1===this.findEmbedObj(e,c)?t.push(c):n.push(c.token)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}this.embedObjList=t,0<n.length&&b.default.dispatch(Object(g.removeEmbedObjects)(this.envInfos.token,n))}},{key:"getEmbedObjs",value:function(){return this.embedObjList}},{key:"getEmbedObjsAllBoolPerm",value:function(){var e=this.selectEmbedObjPermission(),t=this.getEmbedObjs(),n={},i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,l=e.get(c.token);n[c.token]=l?Object.assign({},l.toJS(),{permission:Object(y.embedObjPermission2Booleans)(l.get("permission")),userPermissions:Object(y.permission2Booleans)(l.get("userPermissions"))}):null}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}},{key:"getEmbedObjAllBoolPermByToken",value:function(e){var t=this.selectEmbedObjPermission().get(e);return t?Object.assign({},t.toJS(),{permission:Object(y.embedObjPermission2Booleans)(t.get("permission")),userPermissions:Object(y.permission2Booleans)(t.get("userPermissions"))}):null}},{key:"getEmbedObjPermissions",value:function(){var e=this.selectEmbedObjPermission(),t=this.getEmbedObjs(),n={},i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,l=e.get(c.token);n[c.token]=l?Object(y.embedObjPermission2Booleans)(l.get("permission")):null}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}},{key:"getPermissionByToken",value:function(e){var t=this.selectEmbedObjPermission().get(e);return t?Object(y.embedObjPermission2Booleans)(t.get("permission")):null}},{key:"getOwnerByToken",value:function(e){var t=this.selectEmbedObjPermission().get(e);return t?t.get("owner"):null}},{key:"destroy",value:function(){this.embedObjList=[],this.unsubscribePermission&&this.unsubscribePermission(),this.unsubscribeNetworkState&&this.unsubscribeNetworkState(),this.ready&&C.delete(this.envInfos.token,this)}}],[{key:"destroyToken",value:function(e){C.destroyToken(e)}}]),r}();n("5f2W");n.d(t,"b",function(){return C});t.a=k},kooH:function(e,t,n){},l077:function(e,I,S){"use strict";(function(l){S.d(I,"a",function(){return k});var e=S("lwsE"),t=S.n(e),n=S("W8MJ"),i=S.n(n),r=S("a1gu"),o=S.n(r),a=S("Nsbk"),s=S.n(a),c=S("7W2i"),u=S.n(c),d=S("cDf5"),h=S.n(d),f=S("q1tI"),p=S.n(f),g=S("UlbS"),m=S("TSYQ"),v=S.n(m),b=S("4PSP"),y=S("G7AY"),E=S("PKWG"),O=S("jm1x"),C=(S("LrxS"),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a}),k=function(e){function c(){return t()(this,c),o()(this,s()(c).apply(this,arguments))}return u()(c,e),i()(c,[{key:"render",value:function(){var e=c.TOOLTIP_HIDE_ACTIONS,t=this.props,n=t.canSwitchToNextComment,i=t.canSwitchToPrevComment,r=t.getToolTipContainer,o="top",a="topRight",s={position:"relative",right:"-14px"};return p.a.createElement("div",{hidden:this.props.hidden,className:"comment-list__controls"},p.a.createElement("div",{className:"comment-list__switch-to-next-comment-container"},p.a.createElement(g.Tooltip,{title:"".concat(l("comment.next")," ()"),placement:o,hideActions:e,getContainer:r},p.a.createElement("div",{className:this.getSwitchBtnClassName(!n),onClick:this.onSwitchToNextComment},p.a.createElement(E.a,null)))),p.a.createElement("div",{className:"comment-list__switch-to-prev-comment-container"},p.a.createElement(g.Tooltip,{title:"".concat(l("comment.previous")," ()"),placement:o,hideActions:e,getContainer:r},p.a.createElement("div",{className:this.getSwitchBtnClassName(!i),onClick:this.onSwitchToPrevComment},p.a.createElement(y.a,null)))),this.props.canResolve&&p.a.createElement("div",{className:"comment-list__resolve-container"},p.a.createElement(g.Tooltip,{title:l("comment.solve_tip"),style:s,placement:a,hideActions:e,getContainer:r},p.a.createElement("div",{className:this.getSwitchBtnClassName(),onClick:this.props.onResolveComment},p.a.createElement(O.a,null)))))}},{key:"getSwitchBtnClassName",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return v()("comment-list__controls-button",{"comment-list__controls-button_disabled":e})}},{key:"onSwitchToPrevComment",value:function(e){this.props.canSwitchToPrevComment&&this.props.onSwitchToPrevComment({event:e,activeSource:"switchCommentByClick"})}},{key:"onSwitchToNextComment",value:function(e){this.props.canSwitchToNextComment&&this.props.onSwitchToNextComment({event:e,activeSource:"switchCommentByClick"})}}]),c}(f.PureComponent);k.TOOLTIP_HIDE_ACTIONS=["onMouseLeave","onClick"],C([Object(b.Bind)()],k.prototype,"onSwitchToPrevComment",null),C([Object(b.Bind)()],k.prototype,"onSwitchToNextComment",null)}).call(this,S("2vAP"))},l2V6:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),p=n("hbEN"),s=n("3Hq1"),m=n("2hu8"),c=function(){function n(e){var t=this;if(r()(this,n),this.canCalculate=function(e){return!0},this.handleScroll=function(e){t.srollingListener&&t.srollingListener(),t.debounceCalculate()},this.calculate=function(){t.currScrollTop=t.scroller.scrollTop,t.currOffsetHeight=t.scroller.offsetHeight,t.canCalculate(t.currScrollTop)&&t.collectViewData()},!e)return this;this.setProps(e),e.immediately&&this.handleScroll()}return a()(n,[{key:"setProps",value:function(e){var t=e.duration,n=void 0===t?200:t,i=e.scroller,r=e.editor,o=e.listener,a=e.limit,s=void 0===a?0:a,c=e.scrollOffset,l=void 0===c?0:c,u=e.srollingListener,d=e.canCalculate,h=e.isSearchZone,f=void 0!==h&&h;this.duration=n,this.scroller=i,this.scrollOffset=l,this.srollingListener=u,this.editor=r,this.limit=s,this.listener=o,d&&(this.canCalculate=d),this.isSearchZone=f,this.currScrollTop=i.scrollTop,this.currOffsetHeight=i.offsetHeight,this.debounceCalculate=Object(p.default)(this.calculate,this.duration),o&&this.bindEvents()}},{key:"destroy",value:function(){this.reset()}},{key:"reset",value:function(){this.unBindEvents(),this.editor=void 0,this.scroller=void 0,this.listener=void 0,this.srollingListener=void 0,this.debounceCalculate.cancel()}},{key:"bindEvents",value:function(){this.scroller&&this.editor&&(this.scroller.addEventListener("scroll",this.handleScroll),this.editor.eventEmitter.on("editorSizeChange",this.debounceCalculate))}},{key:"unBindEvents",value:function(){this.scroller&&this.editor&&(this.scroller.removeEventListener("scroll",this.handleScroll),this.editor.eventEmitter.off("editorSizeChange",this.debounceCalculate))}},{key:"collectViewData",value:function(){this.listener&&this.listener(this.getLineNumberRange())}},{key:"getLineNumberRange",value:function(i,r){var o=this;if(!this.editor||!this.scroller)return 0;var t=function(e){var t=Object(s.default)(i)?o.currScrollTop+e:i,n=Object(s.default)(r)?o.limit:r;return 0===n?o.getLineByScrollTop(t):o.getViewLinesByScrollTop(t,n)};return Array.isArray(this.scrollOffset)?this.scrollOffset.map(function(e){return t(e)}):t(this.scrollOffset)}},{key:"getLineByScrollTop",value:function(e){if(!this.editor)return 0;var t=Object(m.e)(this.editor);return this.binarySearchTopLine(e,[0,t-1]).lineNumInMainZone}},{key:"getViewLinesByScrollTop",value:function(e,t){if(!this.editor)return 0;var n=Math.ceil(t/2)-1,i=t-n,r=[e-this.currOffsetHeight*n,e,e+this.currOffsetHeight*i];return this.calculateInViewLine(this.editor.getRep("0"),r)}},{key:"calculateInViewLine",value:function(e,t){if(this.scroller&&this.editor){var n=t[0],i=t[2],r=t[1],o=this.scroller.scrollHeight,a=r+this.currOffsetHeight;n<0&&(n=0),o<i&&(i=o),i<a&&(a=i);var s,c,l=Object(m.e)(this.editor),u=this.binarySearchTopLine(n,[0,l-1]),d=u.lineNumInMainZone,h=this.binarySearchTopLine(i,[d,l-1]),f=h.lineNumInMainZone,p=0,g=0,p=n===r?(s=u,d):(s=this.binarySearchTopLine(r,[d,f])).lineNumInMainZone,g=a===i?(c=h,f):(c=this.binarySearchTopLine(a,[p,f])).lineNumInMainZone;return{overViewLine:u,inViewTopLine:s,inViewBottomLine:c,underViewLine:h,overViewLineNu:d,inViewTopLineNu:p,inViewBottomLineNu:g,underViewLineNu:f}}}},{key:"binarySearchTopLine",value:function(e,t){var n={lineNumInMainZone:-1,selZone:"0",lineNum:-1};if(!this.editor)return n;var i,r=this.editor.getRep("0");if(this.isSearchZone?null!==(i=Object(m.a)(r,e,t))&&(n=i):n.lineNum=n.lineNumInMainZone=Object(m.b)(r,e,t),-1===n.lineNumInMainZone){var o=Object(m.c)(r,t[0]),a=Object(m.c)(r,t[1]);if(null!==a&&Object(m.g)(r,e,a))return n.lineNum=n.lineNumInMainZone=a,n;if(null!==o&&Object(m.f)(r,e,o))return n.lineNum=n.lineNumInMainZone=o,n}return n}}]),n}()},"l8+p":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("RIqP"),c=n.n(i),r=n("lSNA"),l=n.n(r),u=n("lQZd"),d=n("QM+C"),h=n("m3ds"),o=function(e){var t,i=Object(u.l)(),r=(t={},l()(t,d.NUM_SUITE_TYPE.DOC,[".etherpad-container-wrapper"]),l()(t,d.NUM_SUITE_TYPE.SHEET,[".sheet-comment-content__wrapper",".bitable-comment__panel-list"]),l()(t,d.NUM_SUITE_TYPE.MINDNOTE,[".mindnote-main",".mindnote-minder-comment__container"]),t),n=function(){var e,t=[];return i!==d.NUM_SUITE_TYPE.DOC||(e=document.querySelector(r[i].join(",")))&&t.push(e),t},o=function(){var e,t,n=[];return h.a.isFeed?(0===(e=document.querySelectorAll(".message-container_scrollwrap")).length&&console.warn("Can not find scroll container."),n.push.apply(n,c()(e))):r[i]&&(0===(t=document.querySelectorAll(r[i].join(","))).length&&console.warn("Can not find scroll container."),n.push.apply(n,c()(t))),n},a=function(){var e=[],t=document.querySelector(".J-card-edit-modal-body");return t&&e.push(t),e};if(!e){var s=[].concat(c()(o()),c()(a()));return h.a.isFeed&&s.push.apply(s,c()(n())),s}switch(e){case"globalComment":return n();case"commentContainer":return o();case"STModal":return a();default:return[]}}},l9PA:function(e,t,n){"use strict";var i=n("J4zp"),d=n.n(i),r=n("RIqP"),s=n.n(r),o=n("lwsE"),a=n.n(o),c=n("W8MJ"),l=n.n(c),u=n("cDf5"),h=n.n(u),f=n("xnu4"),p=n("Muja"),g=n("y2sV"),m=n("FJEn"),v=n("4ngZ"),b=n("aBgF"),y=n("kESg"),E=function(e,t,n){for(var i=e.parentNode;i&&i.matches;){if(i.parentNode===n)return;if(i.matches(t))return i;i=i.parentElement}return null},O=function(){function n(e,t){a()(this,n),this.editor=e,this.zoneId=t}return l()(n,[{key:"getLineAndChar",value:function(e){var t=this.editor.dom.rootNodeOfZoneContaining(e);if(!t)return null;var n=this.editor.dom.zoneOfRootNode(t);if(!n)return null;var i=e.getAttribute("id");if(!i)return null;var r=this.editor.getRep(n),o=r.lines.indexOfKey(i);if(o<0)return null;var a=r.lines.atIndex(o);return a?{selStart:[o,0,n],selEnd:[o,1+a.lineMarker,n]}:null}},{key:"hasSelectedZonesForSpecialSelection",value:function(){return!0}},{key:"getSelectedZonesForSpecialSelection",value:function(){return[this.zoneId]}},{key:"getScrollable",value:function(){var e=this.editor.getInnerContainer(),t=e.querySelector(".".concat(y.k.ZoneId,"-").concat(this.zoneId));return t?"function"==typeof t.closest?t.closest(".".concat(y.e.SCROLL_CONTAINER)):E(t,".".concat(y.e.SCROLL_CONTAINER),e):null}}]),n}(),C=n("+4eN"),k=n("iP/4"),I=n("D28M");function S(e,t,n,i){var r=t.text.length,o=d()(n,2),a=o[0],s=o[1],c=d()(i,2),l=c[0],u=c[1];return!(l<a||a===l&&u<s)&&(a<=e&&e<=l&&(e===a?s===t.lineMarker&&(e<l||u===r):e!==l||u===r&&(a<e||0===s)))}var T=n("VeEP"),_=n("xYHj"),w=n("4PSP"),j=(n("M6dX"),n("FKAX")),M=n("2ACu"),L=n("eAOf"),R=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},N=function(){function u(e){var p=this;a()(this,u),this.renderedLines=new Map,this.selectedZoneEntries=[],this.attrNumReg=null,this.matchedAttrs=[],this.handleRef=function(e,t,n){var i=e.lineNode&&e.lineNode.lineManager||new O(p.editor,t);p.registerInstance(e,i,n)},this.managerCache=new Map,this.handleContentChange=function(e){var t=e.changes,i=e.deltaSet;if(!e.options.isRemote){var n,r,o=new g.e,a=[];for(n in t)t[n].forEach(function(e){e.inserts.forEach(function(e){var t=Object(C.k)(e);t&&a.push(t)})});for(r in t)t[r].forEach(function(e){e.deletes.forEach(function(e){var t,n=Object(C.k)(e);!n||i.get(n)||a.includes(n)||(t=new g.E({zoneId:n}).delete(p.editor.repManager.reps[n].lines.totalWidth()-1),o=o.compose(t))})});var s,c,l,u,d,h=Object.keys(o.deltas),f=h.length;f&&(p.editor.getContentState().apply(o),1===f&&p.forceUnmountZone(h[0])),1===a.length&&(s=Object.keys(t),c=Object.values(t),l=function(e){1===c[e].length&&1===c[e][0].inserts.length&&Object(C.p)(p.editor,a[0])},1===s.length?l(0):2===s.length&&(u=s.findIndex(function(e){return Object(C.g)(e)}),d=s.findIndex(function(e){return!Object(C.g)(e)}),~u&&~d&&l(d)))}},this.handleTableRegisterZoneEnd=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];p.collectZoneMatchedAttrsFromApool(),e.forEach(function(e){p.initZoneRepInParentZone(e)})},this.handleMouseEvent=function(e){var t=Object(f.a)(j.b),n=p.editor.plugins[t];n&&("mouseenter"===e.type?n.setLockScrollToActive():n.clearLockScrollToActive())},this.searchStringRange=function(e,t){var n,i,r=t.attributeMap,o=t.searchKey,a=t.matcher;r[y.k.ZoneType]===p.zoneType&&r[y.k.ZoneId]&&(t.isSearchable=!0,(i=p.editor.searchString(r[y.k.ZoneId],o,a))&&(n=t.searchStringList).push.apply(n,s()(i)))},this.zoneLoader=L.a.getInstance(e),e.on(g.k.CONTENT_CHANGE,this.handleContentChange),e.on(v.f.TABLE_REGISTER_ZONE_END,this.handleTableRegisterZoneEnd)}return l()(u,[{key:"match",value:function(e,t){return y.k.ZoneType===e&&t===this.zoneType}},{key:"aceSelectionChanged",value:function(e,t){var n=t.rep,i=n.selStart,r=n.selEnd;if(i&&r){for(var o=[],a=i[0];a<=r[0];a++){var s=n.lines.atIndex(a);this.getZoneId(this.editor,n.zoneId,a)&&s&&S(a,s,i,r)&&o.push(s)}this.toggleSelectedHighlight(o)}}},{key:"aceKeyEvent",value:function(e,t){var n=t.evt,i=t.rep,r=t.isTypeForSpecialKey,o=n.which,a=n.shiftKey,s=n.metaKey,c=n.ctrlKey;if("keydown"!==n.type)return!1;var l=!1;return(b.a.includes(o)||b.b.includes(o))&&(a||s||c||(l=this.handleArrowOrDeleteKeysDown(o,i))),o===b.c.Tab&&(l=this.handleTabKeyDown(i,n.shiftKey)),o===b.c.Enter&&(l=this.handleZoneEnterKeyDown(i)),(k.a.isMac?n.metaKey:n.ctrlKey)&&o===b.c.A&&r&&Object(C.n)(this.editor,i.zoneId)===this.zoneType&&!this.editor.getInInternationalComposition()&&(this.handleSelectAll(i.zoneId),l=!0),!!l&&(t.preventOtherHooks&&t.preventOtherHooks(),n.preventDefault(),!0)}},{key:"handleSelectAll",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:m.DEFAULT_REP_ZONE,t=this.editor.getRep(e).lines,n=t.length()-1,i=[0,0],r=[n,t.atIndex(n).text.length];this.editor.selection.setWithSelection(e,i,r,!0),this.editor.selection.internalUpdateSelectionFromRep(!0)}},{key:"getNextFocusLine",value:function(e,t){var n=t.selStart,i=t.selEnd,r=t.zoneId;if(!n||!i||!Object(p.default)(n,i))return null;var o=d()(i,1)[0];if(!this.checkCursorAtBoundary(e,t))return null;var a=[b.c.Down,b.c.Right,b.c.Delete].includes(e),s=o+(a?1:-1),c=t.lines.length();if(-1===s||s===c){var l=this.editor.managers.zoneToLineEntry[r];if(!l)return null;var u=l.zone,r=u,s=this.editor.getRep(u).lines.indexOfEntry(l)+(a?1:-1)}return{zoneId:r,line:s}}},{key:"handleArrowOrDeleteKeysDown",value:function(e,t){var n=this.getNextFocusLine(e,t);if(!n)return this.tryToCorrectSelection(e,t);var i=n.zoneId,r=n.line;return b.a.includes(e)?this.tryToEnterOrLeaveZone(t,n,e):this.tryToSelectZone(r,i,e)}},{key:"isSelectSingleZone",value:function(e){var t=e.selStart,n=e.selEnd,i=e.zoneId;return!(!t||!n)&&!(t[0]!==n[0]||!this.getZoneId(this.editor,i,t[0]))}},{key:"checkCursorAtBoundary",value:function(e,t){var n=t.selStart,i=t.selEnd;if(!n||!i)return!1;var r=d()(i,2),o=r[0],a=r[1];if([b.c.Left,b.c.Right,b.c.BackSpace,b.c.Delete].includes(e)){var s=t.lines.atIndex(o);if(!s)return!0;if(e===b.c.BackSpace&&Object(_.p)(t,o))return!1;var c=s.lineMarker,l=s.text;return[b.c.Left,b.c.BackSpace].includes(e)?a===c:a===l.length}return!Object(C.g)(t.zoneId)||(0===o||o===t.lines.length()-1)}},{key:"tryToEnterOrLeaveZone",value:function(e,t,n){if(this.editor.plugins.mention.docMention.isMentionBoxVisible())return!1;var i=t.zoneId,r=t.line,o=Object(C.g)(e.zoneId)?e.zoneId:"",a=this.isSelectSingleZone(e),s=Object(C.l)(this.editor,i,r),c=s&&s.zoneId||"";if(a&&(c=t.zoneId),!c&&!o)return!1;var l=a||!(!o||c),u=l?t.zoneId:c;if(u===e.zoneId)return!1;var d=0,h=this.editor.getRep(u);!l&&n!==b.c.Up&&n!==b.c.Left||(d=l?r:h.lines.length()-1);var f=n===b.c.Left?h.alinesWidth[d]:0,p=l?{zoneType:Object(C.m)(e)}:Object(C.l)(this.editor,i,r);if(p&&p.zoneType!==this.zoneType)return!1;var g=[d,f];return this.editor.selection.setWithSelection(u,g,g),this.editor.selection.updateBrowserSelectionFromRep(),!0}},{key:"tryToSelectZone",value:function(e,t,n){if(!this.getZoneId(this.editor,t,e))return!1;var i=this.editor.getRep(t),r=i.lines.atIndex(e);if(n===b.c.BackSpace){if(this.getZoneId(this.editor,t,e+1)||Object(_.d)(i,e+1)||Object(_.p)(i,e+1))return!1;var o=i.lines.atIndex(e+1);o&&o.text.length===o.lineMarker&&this.editor.performDelete(e+1)}return this.editor.selection.setWithSelection(t,[e,0],[e,r.text.length]),this.editor.selection.updateBrowserSelectionFromRep(),!0}},{key:"tryToCorrectSelection",value:function(e,t){var n,i,r,o,a=this,s=t.selStart,c=t.selEnd;if(!s||!c)return!1;if(b.b.includes(e)&&!this.editor.isCaret()&&(i=(n=t.lines.atIndex(c[0]))&&c[1]===n.lineMarker,r=!!this.getZoneId(this.editor,t.zoneId,c[0]-1),c[0]>s[0]&&r&&i&&((o=t.lines.atIndex(c[0]-1))&&this.editor.inCallStackIfNecessary("correctSelection",function(){a.editor.performSelectionChange(t.zoneId,s,[c[0]-1,o.text.length])}))),[b.c.Up,b.c.Down].includes(e)&&Object(C.f)(this.editor)){var l=s[0]+(b.c.Up===e?-1:1);if(l<0||l>t.lines.length())return!1;var u=[l,t.lines.atIndex(l).lineMarker];return this.editor.inCallStackIfNecessary("correctSelection",function(){a.editor.selection.setWithSelection(t.zoneId,u,u,!0),a.editor.selection.updateBrowserSelectionFromRep()}),!0}return!1}},{key:"handleTabKeyDown",value:function(e,t){if(Object(C.n)(this.editor,e.zoneId)!==this.zoneType)return!1;var n=e.selStart,i=e.selEnd;return Object(p.default)(n,i)?this.insertTabAfter(e,t):this.insertTabBefore(e,t),this.editor.selection.updateBrowserSelectionFromRep(),!0}},{key:"handleZoneEnterKeyDown",value:function(e){var t=this,n=e.selStart,i=e.selEnd,r=e.zoneId;if(!n||!i||n[0]!==i[0])return!1;if(this.isSelectSingleZone(e)){var o=n[0]+1,a=this.editor.getContentState(),s=a.getZoneState(r).getLine(n[0]).getOffset().end,c=new g.E({zoneId:r}).retain(s).insertEnter();return a.apply(c),this.editor.once("paint",function(){t.editor.selection.setWithSelection(r,[o,0],[o,0],!1,!0)}),!0}return!1}},{key:"toggleSelectedHighlight",value:function(e){var t=this;this.editor.getObserver().withoutRecordingMutations(function(){t.selectedZoneEntries.forEach(function(e){var t=e.lineNode;t&&Object(I.p)(t,y.e.SELECTED)}),e.forEach(function(e){var t=e.lineNode;t&&Object(I.a)(t,y.e.SELECTED)}),t.selectedZoneEntries=e})}},{key:"insertTabAfter",value:function(e,t){var n=e.selStart;this.insertTabImpl(e,t,n[0],n[1])}},{key:"insertTabBefore",value:function(e,t){for(var n=e.selStart,i=e.selEnd,r=n[0],o=i[0],a=r;a<=o;a++)this.insertTabImpl(e,t,a)}},{key:"render",value:function(e){var t=e.domLine,n=e.lineState,i=e.attributes,r=e.index,o=n.getZoneId(),a=i.zoneId;if(!a)return e.children;var s=this.editor.getRep(o),c=s.lines.keyAtIndex(r),l=s.lines.atIndex(r);return l?(u.zonePropsMap[c]=Object.assign({},i,{outZone:o}),e.lineClass+=" ".concat(y.e.ACE_LINE," ").concat(this.zoneAceClassName," "),t.editable=!1,e.class+=" ".concat(y.e.SPAN," ").concat(this.zoneType,"-").concat(y.k.ZoneId,"-").concat(a," ").concat(this.spanClassName),this.editor.initZoneRep(a),this.addLineManager(a,l),this.onZoneRepInit&&this.onZoneRepInit(o),this.renderCustomZoneView({attributes:i,lineEntry:l})):e.children}},{key:"forceUnmountZone",value:function(e){var t=this.editor.managers.zoneToLineEntry[e],n=t&&t.getInstanceByName(this.instanceName);n&&n.container.forceUnmountZone()}},{key:"registerInstance",value:function(e,t,n){e.registerInstance({instanceName:this.instanceName,displayType:m.DisplayType.Block,container:n,lineManager:t})}},{key:"collectZoneMatchedAttrsFromApool",value:function(){var e,c,l=this;this.attrNumReg||(e=this.editor.getRep(m.DEFAULT_REP_ZONE).apool,c=[],Object.entries(e.numToAttrib).forEach(function(e){var t=d()(e,2),n=t[0],i=t[1],r=Number(n),o=d()(i,2),a=o[0],s=o[1];a===y.k.ZoneId&&(c.push(r.toString(36)),l.matchedAttrs.push({attrNum:r,attrKey:a,attrValue:s}))}),c.length&&(this.attrNumReg=new RegExp("\\*(".concat(c.join("|"),")[+\\*|]"))))}},{key:"onAlinesInited",value:function(){this.collectZoneMatchedAttrsFromApool(),this.initZoneRepInParentZone(m.DEFAULT_REP_ZONE)}},{key:"initZoneRepInParentZone",value:function(e){var o=this,t=this.editor.getRep(e),a=t.alines,s=t.lines,c=this.editor.managers;if(this.attrNumReg)for(var n=function(i,e){var t=a[i];if(t.match(o.attrNumReg))for(var n=o.editor.changesetHelper.opIterator(t);n.hasNext();){var r=n.next();o.editor.changesetHelper.eachAttribNumber(r.attribs,function(n){o.matchedAttrs.forEach(function(e){var t;n===e.attrNum&&(t=e.attrValue,o.editor.initZoneRep(t),c.registerZoneForLine(t,s.atIndex(i)),c.registerZoneWithMatchAttr([t],e.attrKey,e.attrValue),o.onZoneRepInit&&o.onZoneRepInit(t))})})}},i=0,r=a.length;i<r;i++)n(i,r)}},{key:"addLineManager",value:function(e,t){var n=this.managerCache.get(e)||0;this.managerCache.set(e,n+1),this.editor.managers.registerZoneForLine(e,t),t.lineNode&&(t.lineNode.lineManager=new O(this.editor,e)),t.domInfo&&(t.domInfo.lineManagerType=this.zoneType),this.editor.managers.registerZoneWithMatchAttr([e],y.k.ZoneId,e)}},{key:"handleZoneMount",value:function(e,t,n){this.renderedLines.set(n.key,n),e.addEventListener("mouseenter",this.handleMouseEvent),e.addEventListener("mouseleave",this.handleMouseEvent);var i,r=this.editor.blockRender.isSkipAboveRender(),o={};r?(o={zoneId:n.zone,lineEntry:n,loadingDom:null,type:"zone"},this.editor.call(m.ASYNC_NODE_WILL_SHOW_LOADING_EVENT,Object.assign({},o))):this.editor.call(m.ASYNC_NODE_WILL_UPDATE_EVENT,{zoneId:n.zone,key:n.key}),e&&this.editor.dom.rootNodeOfZone(t,!1)!==e&&(this.editor.call("innerZoneMount",{el:e,zoneId:t,className:v.b}),this.editor.dom.rootNodeOfZone(t,!1),(i=this.editor.innerZoneEditorNodes[t]).mountVNode(e),i.bindEvent()),r?this.editor.call(m.ASYNC_NODE_DID_SHOW_LOADING_EVENT,Object.assign({},o,{loadingDom:null})):this.editor.call(m.ASYNC_NODE_DID_UPDATE_EVENT,{zoneId:n.zone,key:n.key}),delete u.zonePropsMap[n.key],this.editor.call("newZoneDidRender",{zoneIds:[t],lineEntry:n}),this.zoneLoader.mountZone(t),0===Object.keys(u.zonePropsMap).length&&T.a.allZoneDidRender(),Object(M.collectSuiteEvent)(y.i.ZONE_DID_MOUNT,{zoneId:t,zone:this.zoneType})}},{key:"handleZoneUnmount",value:function(e){var t,n=this.managerCache.get(e)||0;this.managerCache.set(e,n-1),0<n-1||(e&&(this.editor.managers.unregisterZone(e),this.editor.managers.unregisterZoneWithMatchAttr(e)),this.editor.innerZoneEditorNodes[e]&&this.editor.innerZoneEditorNodes[e].dispose(),(t=this.editor.dom.rootNodeOfZone(e))&&t instanceof HTMLElement&&(t.removeEventListener("mouseenter",this.handleMouseEvent),t.removeEventListener("mouseleave",this.handleMouseEvent)))}},{key:"reset",value:function(){this.attrNumReg=null,this.matchedAttrs=[],u.zonePropsMap={},this.zoneLoader.destroy(),this.editor.off(g.k.CONTENT_CHANGE,this.handleContentChange),this.editor.off(v.f.TABLE_REGISTER_ZONE_END,this.handleTableRegisterZoneEnd)}},{key:"checkIsExistClass",value:function(e){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"").split(" ").includes(e)}}]),u}();N.zonePropsMap={},R([Object(w.Bind)()],N.prototype,"handleZoneMount",null),R([Object(w.Bind)()],N.prototype,"handleZoneUnmount",null);t.a=N},lAOT:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s});var i=n("vYB2"),r=n.n(i),o=r.a.CancelToken,a=r.a.isCancel,s=r.a.Cancel},lIbB:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"b",function(){return h}),n.d(t,"d",function(){return f});var i=n("J4zp"),s=n.n(i),r=n("FJEn"),c=n("H6oK"),o=n("m3ds");function a(){return!o.a.isEdge}function l(e,t,n){var i=[t,n],r=[t,n+1];return e.attributeManager.getAttributesOnSelection(i,r,e).attribs.some(function(e){return s()(e,1)[0].startsWith("mention-link_")})}function u(e){if(e.nodeType!==Node.TEXT_NODE)return e;var t=document.createRange();return t.setStart(e,0),t.setEnd(e,0),t}function d(e,t,n){var i=n+1,r=e.selection.getPointForChatAtLeafNode(t,i,!0),o=u(e.selection.getRealPointAtFakeText(r).node),a=2,s=r.node;return s.nodeType===Node.TEXT_NODE&&(s=s.parentElement),o.getBoundingClientRect().left-s.getBoundingClientRect().left+a}function h(e,t){return(t!==r.DEFAULT_REP_ZONE?e.dom.getRootForZone(t):e.getOuterContainer()).getBoundingClientRect()}function f(e,t,n,i){var r=e.getAttributesOnPosition(t.zoneId,n,i.text.length).filter(function(e){return e[0]===c.BLOCK_DATA_META_BLOCK_PROPS}).map(function(e){return e[1]}),o=s()(r,1)[0];if(Boolean(o)){var a=JSON.parse(o);if(a&&a.props&&a.props.displayMode===c.BlockDisplayMode.INLINE)return!0}return!1}},lJ7m:function(e,N,D){"use strict";(function(e){D.d(N,"a",function(){return R});var t,a,n,i=D("lSNA"),r=D.n(i),o=D("J4zp"),s=D.n(o),c=D("lwsE"),l=D.n(c),u=D("W8MJ"),d=D.n(u),h=D("cDf5"),f=D.n(h),p=D("H6oK"),g=D("K9Ia"),m=D("kERW"),v=D("dzgT"),b=D("t9fZ"),y=D("VnD/"),E=D("1lbP"),O=D("4PSP"),C=D("n/R6"),k=D("2ACu"),I=D("D7h9"),S=D("MUo5"),T=D("JPM6"),_=D("2IYG"),w=D("90Nm"),j=D("y2sV"),M=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};function L(e){if(window.requestIdleCallback){var t=window.requestIdleCallback(e);return function(){return window.cancelIdleCallback(t)}}var n=window.setTimeout(e);return function(){return window.clearTimeout(n)}}(n=a=a||{}).PASTE="paste",n.INSERT="insert";var R=function(){function n(e){var t=this;l()(this,n),this.editor=e,this.className="DocLocker",this.state={isLockedByDepLoading:!1,isInFullscreen:!1},this.depLoadingSource=null,this.lastDepLoadingSource=null,this.hasDepLoadingError=!1,this.afterPasteInsert$=new g.a,this.rxOp=new E.a,this.setIsDocLockedByPlugin=function(e){I.default.dispatch(Object(S.setIsDocLockedByPlugin)(e))},this.handleDidPaste=function(){t.depLoadingSource===a.PASTE&&t.afterPasteInsert$.next()},this.editor.on(p.DEP_LOADING_BLOCK_WILL_CREATE,this.onDepLoadingBlockWillCreate),this.editor.on(p.DEP_LOADING_BLOCK_DID_ERROR,this.onDepLoadingBlockDidError),this.editor.on(p.DEP_LOADING_BLOCK_DID_DELETE,this.onDepLoadingBlockDidDelete),this.editor.on(p.INITIAL_BLOCK_MOUNTED,this.preloadDependencyLoadingBlocks),this.editor.on(j.k.DID_PASTE,this.handleDidPaste)}return d()(n,[{key:"updateState",value:function(e){var t=this.state,n=Object.assign({},this.state,{},e);this.state=n,this.checkAndHandleIsReadonlyChange(t,n),this.checkAndHandleIsNoCollabChange(t,n)}},{key:"getIsReadonly",value:function(e){return e.isLockedByDepLoading||e.isInFullscreen}},{key:"checkAndHandleIsReadonlyChange",value:function(e,t){var n,i=this,r=this.getIsReadonly(e),o=this.getIsReadonly(t);r!==o&&(n=function(){return i.setIsDocLockedByPlugin(o)},this.depLoadingSource===a.PASTE?this.afterPasteInsert$.pipe(Object(b.a)(1),this.rxOp.takeUntil()).subscribe(n):n())}},{key:"getIsNoCollab",value:function(e){return e.isLockedByDepLoading}},{key:"checkAndHandleIsNoCollabChange",value:function(e,t){var n,i=this.getIsNoCollab(e),r=this.getIsNoCollab(t);i===r||(n=this.editor.plugins.client)&&(r?n.disable():n.enable())}},{key:"getSource",value:function(e){if(!e.initData)return null;try{return Object(p.parseEscapedInitData)(e.initData).source}catch(e){return null}}},{key:"onDepLoadingBlockWillCreate",value:function(e){var t;this.state.isLockedByDepLoading||(t=this.getSource(e))&&(this.depLoadingSource=t,this.lastDepLoadingSource=t,this.updateState({isLockedByDepLoading:!0}),this.hasDepLoadingError=!1,this.showDepLoadingToast(),this.collectDepLoading("lock"))}},{key:"onDepLoadingBlockDidError",value:function(e){var t=s()(e,2),n=t[0],i=t[1];this.hasDepLoadingError||(this.hasDepLoadingError=!0,this.showDepLoadingErrorOops(n,i),this.removeDepLoadingToast(),this.collectDepLoading("error",{blockId:n,depLoadingSource:this.lastDepLoadingSource}))}},{key:"onDepLoadingBlockDidDelete",value:function(){var e;this.state.isLockedByDepLoading&&(this.hasDepLoadingError=!1,(e=this.editor.plugins.blockPlugin).hasDepLoadingBlock&&!e.hasDepLoadingBlock()&&this.unlockDepLoading())}},{key:"unlockDepLoading",value:function(){this.depLoadingSource=null,this.updateState({isLockedByDepLoading:!1}),this.removeDepLoadingToast(),this.collectDepLoading("unlock")}},{key:"preloadDependencyLoadingBlocks",value:function(){var i=this,e=Object(w.a)().pipe(Object(y.a)(function(e){return!0===e})),t=Object(m.a)(function(e){return L(function(){return e()})},function(e,t){return t()});Object(v.b)(e,t).pipe(Object(b.a)(1),this.rxOp.takeUntil()).subscribe(function(){var e=i.editor.plugins,t=e.sheet,n=e.bitable;t&&Object(T.f)(),n&&Object(_.f)()})}},{key:"fullscreenEntering",value:function(){this.updateState({isInFullscreen:!0})}},{key:"fullscreenExited",value:function(){this.updateState({isInFullscreen:!1})}},{key:"destroy",value:function(){this.rxOp.destroy(),this.editor.off(j.k.DID_PASTE,this.handleDidPaste),this.getIsReadonly(this.state)&&I.default.dispatch(Object(S.setIsDocLockedByPlugin)(!1)),this.state.isLockedByDepLoading&&this.removeDepLoadingToast()}},{key:"showDepLoadingToast",value:function(){var e;null!==this.depLoadingSource&&(e=n.DEP_LOADING_TOAST_MESSAGE_MAP[this.depLoadingSource],C.a.show({key:n.DEP_LOADING_TOAST_KEY,type:"loading",content:e.loading,duration:0}))}},{key:"showDepLoadingErrorOops",value:function(e,t){var n="Failed to handle dependency loading for block",i=t instanceof Error?t:new Error(String(t));console.error("".concat(n,", blockId = ").concat(e,", depLoadingSource = ").concat(this.lastDepLoadingSource)),this.editor.fatal(i,"plugin",n,-1e3)}},{key:"removeDepLoadingToast",value:function(){C.a.remove(n.DEP_LOADING_TOAST_KEY)}},{key:"collectDepLoading",value:function(e,t){Object(k.default)("dev_dep_loading_block",Object.assign({action:e},t))}}]),n}();R.DEP_LOADING_TOAST_KEY="DEP_LOADING_TOAST_KEY",R.DEP_LOADING_TOAST_MESSAGE_MAP=(t={},r()(t,a.PASTE,{loading:e("doc.pasting_loading_block")}),r()(t,a.INSERT,{loading:e("doc.inserting_loading_block")}),t),M([Object(O.Bind)()],R.prototype,"onDepLoadingBlockWillCreate",null),M([Object(O.Bind)()],R.prototype,"onDepLoadingBlockDidError",null),M([Object(O.Bind)()],R.prototype,"onDepLoadingBlockDidDelete",null),M([Object(O.Bind)()],R.prototype,"preloadDependencyLoadingBlocks",null)}).call(this,D("2vAP"))},lTlB:function(e,t,n){},lWGI:function(e,t,n){},laI6:function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),(r=i=i||{}).Drive="Drive",r.Doc="Doc",r.External="External"},lrrv:function(e,t,c){"use strict";c.r(t);var n=c("m/+l"),o=c("peh1"),i=c("ZSG8"),r=c("/PhZ"),a=c("G2xZ"),s=c("3AGV"),l=c("GoHq"),u=c("vc5i"),d=c("ZGZ5"),h=c("qKwb"),f=c("5cZX"),p=c("ZhRG"),g=c("XfSZ"),m=c("yG8O"),v=c.n(m),b=c("lwsE"),y=c.n(b),E=c("W8MJ"),O=c.n(E),C=c("a1gu"),k=c.n(C),I=c("Nsbk"),S=c.n(I),T=c("PJYZ"),_=c.n(T),w=c("7W2i"),j=c.n(w),M=c("U+yc"),L=c.n(M),R=(c("1ABj"),c("7EGn")),N=c("17x9"),D=c.n(N),x=c("q1tI"),P=c.n(x),B=c("i8i4"),U=c("QM+C"),z=c("z4jg"),H=c("AiBH"),F=c("CnBM"),V=c.n(F),W=c("DC6e"),K=c("R/2b"),Z=c("5PMV"),q=c("HvQa"),Y={resetClientVars:a.b,updateDocTitle:i.u,syncNoteMeta:i.s,setEditor:a.f,destroyEditor:a.a,updateBusinessStage:q.c},J=function(e){return{noteToken:Object(u.n)(e),currentSuitePermission:Object(f.j)(e),opendocContentConfig:Object(p.b)("content")(e)||Object(p.a)(g.a.CONTENT)(e),createSource:Object(u.g)(e)}},Q=Object(n.connect)(J,Y)(Z.a),X=c("Vr4U"),ee=c("J4zp"),te=c.n(ee),ne=c("o0o1"),ie=c.n(ne),re=c("yXPU"),oe=c.n(re),ae=c("QILm"),se=c.n(ae),ce=c("iWIM"),le=c.n(ce),ue=c("cDf5"),de=c.n(ue),he=c("Bw5p"),fe=c("/1FC"),pe=c("XIp8"),ge=c("5gS9"),me=c("D7h9"),ve=c("77Gt"),be=c("1+jt"),ye=c("OX8E");function Ee(e){ye.a.emit("emitVc",e)}function Oe(e){ye.a.emit("meetingChange",e)}var Ce=c("iP/4"),ke=c("MUo5"),Ie=c("X+Le"),Se=c("ahx2"),Te=c("2ACu"),_e=c("2spZ"),we=c("5dbN"),je=c("1dfU"),Me=c("yH1+"),Ae=c("0toH"),Le=c("FJEn"),Re=c("cqCN"),Ne=c("rLED");function De(e){return function(e){function t(){return y()(this,t),k()(this,S()(t).apply(this,arguments))}return j()(t,e),O()(t,[{key:"initSyncBuffer",value:function(){var t=this,e=function(e){e.forEach(t.processMemberChannelMessage)};this.membersSyncBuffer=Object(Re.createSyncBuffer)({logger:Te.default,checkIfEnable:Ne.lb,handleMessage:e,handleMessageOnActive:e,handleMessageOnReActive:e,getVersionFromMessage:function(e){var t=e.version;return{from:t,to:t}},getClientVersion:function(){return t.memberVersion}},{isFullPipe:!0})}},{key:"destroySyncBuffer",value:function(){this.membersSyncBuffer.destroy()}},{key:"setup",value:function(){le()(S()(t.prototype),"setup",this).call(this),this.initSyncBuffer()}},{key:"destroy",value:function(){le()(S()(t.prototype),"destroy",this).call(this),this.destroySyncBuffer()}},{key:"memberVersion",get:function(){return this._memberVersion},set:function(e){this._memberVersion=e}}]),t}(e)}var xe,Pe,Be=c("kfiP"),Ue=c("TYER"),ze=c("hQ6Y"),He=c("JaxG"),Fe=function(){function e(){y()(this,e)}return O()(e,[{key:"channel",get:function(){return ze.a}},{key:"heartbeat",get:function(){return Object(He.d)()[ze.a]}}]),e}(),Ve=c("f9b/"),We="push_channel",Ke=-1,Ge="PUSH",Ze=function(){function n(e,t){y()(this,n),this.token=e,this.io=t,this.entity={type:Ge,token:this.token}}return O()(n,[{key:"register",value:function(){var e=this.entity;this.io.register(e,{heartbeats:{push_channel:this.heartbeat},message:{handler:function(){console.log(We,"register success")},filter:e}})}},{key:"unRegister",value:function(){this.io.unRegister(this.entity)}},{key:"heartbeat",get:function(){var r=this;return{interval:1,callback:function(e,t){var n,i;e<=t||(n=r.entity,r.io.setHeartbeatVersion(n,We,e),t!==Ke&&(i={token:r.token,name:We,client_version:t,type:Ue.h.MESSAGE_CHANNEL},r.io.request({type:Ge,data:i}).then(function(e){var t;e.data.key&&((t=document.createElement("script")).src=e.data.key,document.body.appendChild(t))})))}}}}]),n}(),qe=c("+4eN"),Ye=c("kESg"),Je=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":de()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Qe="ACCEPT_WATCH",Xe="USER_NEWINFO",$e="USER_LEAVE",et="CLIENT_VARS",tt="ENGAGEMENT_CURSOR",nt="COLLABROOM",it=2,rt="VC",ot="MEETING_ROOM",at=1e3,st=me.default.dispatch,ct=[Se.STATUS_CODE.INVALID_PARAMETERS,Se.STATUS_CODE.NOT_FOUND,Se.STATUS_CODE.FORBIDDEN,Se.STATUS_CODE.LOGIN_REQUIRED,Se.SERVER_STATUS_CODE.NOTE_DELETE],lt=xe=Je([De],xe=function(e){function t(e){var s;return y()(this,t),(s=k()(this,S()(t).call(this,e))).channelChangeCbs=[],s.networkState=ge.c.online,s.missVersionLimit=at,s.clearTemplateClientVars=function(){window.DATA&&delete window.DATA},s.handleMessage=function(e){var t=Object(he.a)(e,["type","code","request_id"]);if(e.data){console.log("doc sync received! ".concat(e.data.type," ").concat(e.data.new_rev||e.data.revision),"req_id: ".concat(e.req_id),"request_id: ".concat(e.request_id));var n=e.type,i=n===nt&&e.data.type===tt;if(n===U.SUITE_ENGINE_TYPE.DOC||i){var r=e.data,o=r.type;if(o===et||o===Qe||s.receiveClientVars){var a=Object(R.default)(s.editor,"plugins.client");switch(o){case et:s.handleReceivedClientVars(r);break;case tt:a&&a.handleMessageFromServer(s.convertCursorMsg(e));break;case rt:Ee(r);break;case ot:Oe(r);break;default:a&&a.handleMessageFromServer(e)}return e}Object(Te.default)("dev_doc_sync_return_no_receivedClientVars",{type:o,receivedClientVars:s.receiveClientVars})}else Object(Te.default)("dev_doc_sync_error_type",{wrapInfo:t})}else Object(Te.default)("dev_doc_sync_no_msgData",{wrapInfo:t})},s.convertCursorMsg=function(e){if(!(e.type===nt)){var t=e.data.cursor_info;return t.selZone||(t.selZone="0"),e}var n=e.note_token,i=e.member_id,r=e.authorId,o=e.authorName,a=e.isActive,s=e.locationX,c=e.locationY,l=e.selStart,u=e.selEnd,d=e.selFocusAtStart,h=e.selZone||"0";return{type:"DOC",req_id:-1,data:{type:tt,token:n,connect_type:"connect_type",user_token:"",member_id:parseInt(i,10),cursor_info:{authorId:r,authorName:o,isActive:a,locationX:s,locationY:c,selStart:l,selEnd:u,selZone:h,selFocusAtStart:d}}}},s.handleReFetchMemberList=function(e){var t=s.channels[Ve.a];t&&s.networkState!==e&&(s.networkState=e,s.networkState===ge.c.online&&t.refetchMessageIfVersionBreak(-2,0))},s.bindMemberChannelEvents=function(){var e=s.channels[Ve.a];e&&(e.on(Ue.h.ROOM_MEMBERS,s.pipeMemberChannelMessage),e.on(Ue.h.USER_LEAVE,s.pipeMemberChannelMessage),e.on(Ue.h.USER_NEWINFO,s.pipeMemberChannelMessage),s.registerChannelChange(s.handleReFetchMemberList))},s.unbindMemberChannelEvents=function(){var e=s.channels[Ve.a];e&&(e.off(Ue.h.ROOM_MEMBERS,s.pipeMemberChannelMessage),e.off(Ue.h.USER_LEAVE,s.pipeMemberChannelMessage),e.off(Ue.h.USER_NEWINFO,s.pipeMemberChannelMessage),s.unregisterChannelChange(s.handleReFetchMemberList))},s.pipeMemberChannelMessage=function(e){s.memberVersion=e.version,s.membersSyncBuffer.pipe(e)},s.processMemberChannelMessage=function(e){var t=e.type;t===Xe?s.handleUserNewInfo(e):t===$e?s.handleUserLeave(e):s.handleMembersMessage(e)},s.handleMembersMessage=function(e){var t,n,i,r=e.count;Object(ve.f)("doc",Object.assign(e,{token:s.token,members:s.assignMemberInfo(e,e.members),count:r})),s.editor&&(n=(t=s.editor.plugins).cursorTrack,i=t.sheetBridge,n&&n.removeUselessCursor(e),i&&e.members&&i.notifyMembersUpdate(e.members))},s.handleUserLeave=function(e){Object(ve.i)("doc",e)},s.handleUserNewInfo=function(e){var t=e.entities,n=se()(e,["entities"]),i=Object(R.default)(t,"users",{});i[n.user_id].color_id=Object(be.b)(n.user_id);var r=Object.assign(n,i[n.user_id],{count:t.users_count});Object(ve.j)("doc",r)},s.onChannelChanges=function(t,n){s.channelChangeCbs.forEach(function(e){e(t,n)})},s.destroyed=!1,s.setup(),"function"==typeof e.getClientVarsRequestExtraParams&&(s.getClientVarsRequestExtraParams=e.getClientVarsRequestExtraParams),s}function n(){return i.apply(this,arguments)}var i;return j()(t,e),O()(t,[{key:"setup",value:function(){this.io.registerChannelState(this.onChannelChanges),this.entity={type:U.SUITE_ENGINE_TYPE.DOC,token:this.token},this.bindMemberChannelEvents(),this.pushChannel=new Ze(this.token,this.io),this.pushChannel.register()}},{key:"setEditor",value:function(e){this.editor=e}},{key:"connectDoc",value:function(){var e=this,t=Object(pe.default)(Object(R.default)(window,"DATA.clientVars"));if(t&&this.clearTemplateClientVars(),this.checkClientVars(t)){Object(Te.default)("dev_doc_sync_check_client_vars");var n=Promise.resolve(t);return Ce.a.isFeed&&setTimeout(function(){return e.io.sendHeartbeats()},0),n}if(this.shouldFetchClientVars(t))return this.fetchClientVars();var i=Object(R.default)(t,"data.code");return-1<ct.indexOf(i)?(console.warn("=== Suite load end, will not try to re-fetch"),Promise.reject(new Error("=== Suite is unavailable, reason code ".concat(i)))):Promise.reject(new Error("unhandle error"))}},{key:"fetchClientVars",value:(i=oe()(ie.a.mark(function e(){var i,t,n,r=this,o=arguments;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=0<o.length&&void 0!==o[0]?o[0]:3,t=1<o.length?o[1]:void 0,n=Object(Be.a)(location.href).open_type||0,e.abrupt("return",this._sendMessage(et,{base_rev:0,version:0,open_type:t||parseInt(n,10)},{channel:ge.a.http}).then(function(){var t=oe()(ie.a.mark(function e(t){var n;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,Object(Te.default)("dev_doc_sync_fetch_client_vars_then",{retCode:Object(R.default)(t,"code"),dataCode:Object(R.default)(n,"code"),canRetryTimes:i}),!n||!n.code||n.code===Se.STATUS_CODE.FORBIDDEN||n.code===Se.STATUS_CODE.NOT_FOUND||n.code===Se.STATUS_CODE.NOTE_DELETED){e.next=14;break}if(0<i)return e.next=6,Object(_e.c)(3/i*1e3);e.next=10;break;case 6:return--i,e.abrupt("return",r.fetchClientVars(i));case 10:return me.default.dispatch(Object(Ie.showToast)({content:Se.REQUEST_TIMEOUT})),e.abrupt("return",t);case 12:e.next=15;break;case 14:return e.abrupt("return",t);case 15:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){return Object(Te.default)("dev_doc_sync_fetch_client_vars_catch",{err:e,times:i}),console.error(e),0<i?(--i,r.fetchClientVars(i)):Promise.reject(new Error("sevice error"))}));case 4:case"end":return e.stop()}},e,this)})),n)},{key:"handleReceivedClientVars",value:function(e){console.log("received clientVars!",Object(R.default)(e,"collab_client_vars.rev")),this.mockNewClientVars(e),Object(Ae.a)(e),this.setClientVars(Object(R.default)(e,"collab_client_vars.rev")),st(Object(a.d)(e)),Object(fe.a)(e.permissions)&&e.token&&st(Object(ke.setUserPermissionFromClientVars)(e.token,e.permissions))}},{key:"getTicket",value:function(){return this.io.getTicket()}},{key:"getMemberId",value:function(){return this.io.getMemberId()}},{key:"sendMessage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return e===Ue.h.USER_CHANGES?(this.logMessage(e,t),this.sendUserChange(Object.assign({type:e,token:this.token},t))):this._sendMessage(e,t,n).then(this.handleMessage)}},{key:"_sendMessage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this.logMessage(e,t);var i={};"function"==typeof this.getClientVarsRequestExtraParams&&(i=Object.assign({},this.getClientVarsRequestExtraParams()));var r={type:U.SUITE_ENGINE_TYPE.DOC,data:Object.assign({},t,{type:e,token:t.token||this.token},i),version:it};return this.io.request(r,n)}},{key:"getZoneForMsg",value:function(e){if(e.zone_changesets){var t=Object.keys(e.zone_changesets),n=t.length;if(1===n&&t[0])return"default";if(t.find(function(e){return e.length===Ye.h}))return"zone_plugin";if(1<n)return"table"}return"default"}},{key:"logMessage",value:function(e,t){var n;e===Ue.h.USER_CHANGES&&(n=this.editor?Object(qe.m)(this.editor.getRep()):this.getZoneForMsg(t),Object(Te.default)("client_file_edit",Object.assign({zone:n,network_status:Object(Me.c)()?Me.b:Me.a,user_changes:Object(he.a)(t,["uuid_v4","baseRev","member_id","retryTimes","onlineRetryTimes"])},Object(we.isUnderWikiIndex)()?{wiki_space_id:Object(je.a)(Object(R.default)(Object(u.c)(window.store.getState()),"spaceId")),wiki_area_id:Object(je.a)(Object(R.default)(Object(u.c)(window.store.getState()),"areaId"))}:{})));var i="";if(t.zone_changesets){for(var r={},o=0,a=Object.entries(t.zone_changesets);o<a.length;o++){var s=te()(a[o],2),c=s[0],l=s[1];r[c]=Le.Changeset.replaceCsCharsToPlaceHolder(l)}try{i=JSON.stringify(r)}catch(e){i=""}}console.log("send! ".concat(e," ").concat(t.baseRev||t.rev_list||null),"req_id: ".concat(this.io.reqId),"cs: ".concat(i),"uuid_v4: ".concat(t.uuid_v4))}},{key:"shouldFetchClientVars",value:function(e){var t=!e,n=this.token!==Object(R.default)(e,"data.token"),i=ct.indexOf(Object(R.default)(e,"data.code"))<0;return Object(Te.default)("dev_doc_sync_should_fetch_clientVars",{isDataClientVarsEmpty:t,isTokenInvaild:n,isCodeInvaild:i}),t||n||i}},{key:"mockNewClientVars",value:function(e){var t=Object.assign({},e.collab_client_vars.initialAttributedText);e.collab_client_vars.initialAttributedText={0:t}}},{key:"checkClientVars",value:function(e){if(!e||!e.data)return!1;var t=e.data;if(t.token!==this.token)return!1;var n=Number(Object(R.default)(t,"collab_client_vars.time"));return!(!Ce.a.isFeed&&n&&30<(new Date).getTime()/1e3-n)&&!t.code}},{key:"assignMemberInfo",value:function(e,t){var n=Object(R.default)(e,"entities.users",{}),i=Object.assign(t);return i.forEach(function(e){var t=e.suid||e.user_id;e=Object.assign(e,n[t],{color_id:Object(be.b)(t)})}),i}},{key:"registerChannelChange",value:function(e){this.channelChangeCbs.push(e)}},{key:"unregisterChannelChange",value:function(e){var t=this.channelChangeCbs.indexOf(e);-1<t&&this.channelChangeCbs.splice(t,1)}},{key:"getChannelVersion",value:function(e){var t=(this.io.getHeartbeatInfo(U.SUITE_ENGINE_TYPE.DOC,this.token)||{})[e];if(t)return t.version}},{key:"addHeartbeat",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.io.addHeartbeat(this.entity,e,Object.assign({},t))}},{key:"removeHeartbeat",value:function(e){this.io.removeHeartbeat(this.entity,e)}},{key:"getVersionOfOversize",value:function(e){return e.note_version}},{key:"getVersionOfChangeset",value:function(e){return e.note_revision}},{key:"getChangesets",value:function(e){return e.changeset_list}},{key:"getVersionOfClientVars",value:function(e){return e.collab_client_vars.rev}},{key:"getVersionOfAcceptCommit",value:function(e){return e.note_revision}},{key:"isSelfChangeset",value:function(e){return(this.editor?this.editor.changesetTracker.getSubmittedChanges().uuid_v4:null)===e.uuid_v4}},{key:"destroy",value:function(){this.destroyed||(this.destroyed=!0,le()(S()(t.prototype),"destroy",this).call(this),console.log("doc disconnect"),this.io&&(this.token&&(Object(ve.g)("doc",this.token),this.pushChannel.unRegister()),this.io.unregisterChannelState(this.onChannelChanges)),Object(be.c)(),this.channelChangeCbs=[],this.unbindMemberChannelEvents(),this.editor=null)}}],[{key:"create",value:function(e){return new xe(Object.assign({type:Ue.d.DOC,io:ge.b.getInstance(),requestMessageOptions:{version:it},registerChannels:function(e){var t={};return t[Ve.a]=new Ue.f(e,{fetchMemberList:function(){return Object(ve.b)(e.memberId,e.token,U.NUM_SUITE_TYPE.DOC)},shouldFetchMemberList:function(){return Object(ve.d)(U.SUITE_ENGINE_TYPE.DOC,e.token).length<150}}),t[ze.a]=new Fe,t},logger:{log:Te.default}},e))}}]),t}(Ue.j)),ut=c("521f"),dt=c("ywOK"),ht=c("GIL9"),ft=c("lQZd"),pt=c("qOLP"),gt=c("4PSP"),mt=(c("QQnO"),c("AqxG"),c("YL5g")),vt=c("Qqsi"),bt=c("RBWZ"),yt=c("Bog0"),Et={toggleTemplateVisible:bt.q,callTemplateCenter:bt.a},Ot=function(e){return{isTemplateVisible:Object(vt.c)(e),isBodyBlank:Object(h.d)(e),isShowBlankDocPlaceholder:Object(vt.a)(e)}},Ct=Object(n.connect)(Ot,Et)(yt.a),kt=c("Ehz1"),It=c("VI6H"),St=c("6AXZ"),Tt=V()({loader:(Pe=oe()(ie.a.mark(function e(){var t,n,i;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Promise.all([c.e("doc_index_css"),c.e("commons--line-popover--selection-popup"),c.e("line-popover")]).then(c.bind(null,"WpYc")),Object(St.b)().catch()]);case 2:return t=e.sent,n=te()(t,1),i=n[0],e.abrupt("return",i);case 6:case"end":return e.stop()}},e)})),_t),loading:function(){return null}});function _t(){return Pe.apply(this,arguments)}var wt,jt=c("hBgL"),Mt=c("vAXZ"),At=c("sXyB"),Lt=c.n(At),Rt=c("RIqP"),Nt=c.n(Rt),Dt=c("lSNA"),xt=c.n(Dt),Pt=c("H6oK"),Bt=c("wd/R"),Ut=c.n(Bt),zt=c("toa8"),Ht=c("EjhX"),Ft=c("D28M"),Vt=c("HIeq"),Wt=c("kVAj"),Kt=c("4PFL"),Gt=c("5UUe"),Zt=c("KhU0"),qt=c("n/R6"),Yt=c("y9S/"),Jt=c("vE74"),Qt=c("rFy5"),Xt=c("EzSe"),$t=c("bn+F"),en=c("iR+8"),tn=c("IyQe"),nn=c("kUgE"),rn=c("Kwn9"),on=c("xKvl"),an=c("FnDM"),sn=c("KrGf"),cn=c("CVSs"),ln=c("qYkn"),un=c("Hj9z"),dn=(c("YnAa"),{browser:Ce.a,getLanguage:nn.getLanguage,getLocale:nn.getLocale,getUserPermissions:tn.getUserPermissions,moment:Ut.a,getDocSecureLink:Xt.a,sendSecLinkClickEvent:Xt.d}),hn={selectCurrentUser:d.a,selectCurrentSuiteOtherPermissions:f.u,selectCanEditInvolvingEditMode:f.e,selectFromMinaConfig:f.A,selectAnonymousAccess:function(e){return Object(sn.b)()}},fn={createCustomEvent:Jt.b,getPageToken:Vt.e,encryptTea:je.a,htmlEncode:Qt.b,htmlDecode:Qt.a,queryParents:Ft.o,getIsCurrentUserToCUser:It.g,isShortCut:ht.a,isAnonymousAccess:sn.b},pn={copyTextWithoutPermission:ln.a,clearFailedServices:cn.clearFailedServices},gn=(wt={},xt()(wt,Pt.BlockType.AT_USER_BLOCK,{creator:un.AtUserCreator,getParams:function(e){var t=e.blockWidthNotifyModule;return[{ExternalServices:rn.a.AtUserCreator,moduleConfigs:Nt()(t)}]}}),xt()(wt,Pt.BlockType.FILE_CARD_BLOCK,{creator:un.FileCardCreator,getParams:function(e){var t=e.blockWidthNotifyModule;return[{ExternalServices:rn.a.FileCardCreator,moduleConfigs:Nt()(t)}]}}),xt()(wt,Pt.BlockType.IFRAME_BLOCK,{creator:un.IframeCreator,getParams:function(e){var t=e.blockWidthNotifyModule,n=Object(rn.e)({regionSelector:".etherpad-container-wrapper",ignoreComment:!1});return[{ExternalServices:rn.a.IframeCreator,moduleConfigs:[].concat(Nt()(n),Nt()(t))}]}}),xt()(wt,Pt.BlockType.POLL_BLOCK,{creator:un.PollCreator,getParams:function(e){var t=e.blockWidthNotifyModule;return[{ExternalServices:{LogService:{teaLogger:on.b,collectEvent:Te.default,collectSuiteEvent:Te.collectSuiteEvent},t:en.b,Utils:fn,Helpers:dn,Redux:{store:me.default,selectors:hn,actions:pn},Toast:qt.a,VotePicker:rn.c,VoteEmoji:rn.b,io:ge.b.getInstance(),EventEmitter:ye.a},moduleConfigs:Nt()(t)}]}}),xt()(wt,Pt.BlockType.SHEET_BLOCK,{creator:un.SheetCreator,getParams:function(e){var t=e.sheetBridgePlugin;return[{ExternalServices:Object.assign({LogService:{teaLogger:on.b,collectEvent:Te.default,collectSuiteEvent:Te.collectSuiteEvent},t:en.b,Utils:fn,Helpers:dn,EventEmitter:ye.a,Events:{halfFullController:Wt.a}},Object($t.a)(),{},Object(Kt.b)(t))}]}}),xt()(wt,Pt.BlockType.PLACEHOLDER_BLOCK,{creator:un.PlaceholderCreator,getParams:function(){return[{ExternalServices:{t:en.b}}]}}),xt()(wt,Pt.BlockType.REMINDER_BLOCK,{creator:un.ReminderCreator,getParams:function(){return[{ExternalServices:rn.a.ReminderCreator(ye.a)}]}}),xt()(wt,Pt.BlockType.CHAT_CARD_BLOCK,{creator:un.ChatCardCreator,getParams:function(e){var t=e.blockWidthNotifyModule;return[{ExternalServices:{Redux:{store:me.default,selectors:hn,actions:pn},LogService:{teaLogger:on.b,collectEvent:Te.default,collectSuiteEvent:Te.collectSuiteEvent,getFileType:an.f,getEncryptToken:an.d},Toast:qt.a,Constants:{SOURCE:H.z.DOC,SUITE_TYPE:U.NUM_FILE_TYPE.DOC,JOIN_CHAT_ERROR_MSG:H.s},Utils:fn,Request:zt.d,t:en.b},moduleConfigs:Nt()(t)}]}}),xt()(wt,Pt.BlockType.BITABLE_BLOCK,{creator:un.BitableCreator,getParams:function(e){var t=e.bitableBridgePlugin;return[{ExternalServices:Object.assign({},rn.a.BitableCreator(ye.a),{},Object(Gt.b)(t))}]}}),xt()(wt,Pt.BlockType.MINDNOTE_BLOCK,{creator:un.MindnoteCreator,getParams:function(e){var t=e.mindnoteBridgePlugin,n=e.blockWidthNotifyModule,i=Object(rn.f)({ignoreComment:!1,regionPadding:0});return[{ExternalServices:Object.assign({},rn.a.MindnoteCreator(ye.a),{},Object(Zt.b)(t)),moduleConfigs:Object(ht.a)()?Nt()(n):[].concat(Nt()(i),Nt()(n))}]}}),xt()(wt,Pt.BlockType.JIRA_ISSUE_BLOCK,{creator:un.JiraIssueCreator,getParams:function(){return[{ExternalServices:Object.assign({},rn.a.JiraCreator(ye.a),{components:{JiraIssueCard:Ht.b,SyncBtn:Ht.c,JiraFieldConfigurePopover:Ht.a},request:zt.d})}]}}),xt()(wt,Pt.BlockType.JIRA_FILTER_BLOCK,{creator:un.JiraFilterCreator,getParams:function(){return[{ExternalServices:Object.assign({},rn.a.JiraCreator(ye.a),{components:{SyncBtn:Ht.c},viewManager:Yt.a.getInstance})}]}}),xt()(wt,Pt.BlockType.DIAGRAM_BLOCK,{creator:un.DiagramCreator,getParams:function(e){var t=e.blockWidthNotifyModule;return[{ExternalServices:rn.a.DiagramCreator(ye.a),moduleConfigs:Nt()(t)}]}}),xt()(wt,Pt.BlockType.EQUATION_BLOCK,{creator:un.EquationCreator,getParams:function(){return[{ExternalServices:rn.a.EquationCreator}]}}),xt()(wt,Pt.BlockType.ISV_BLOCK,{creator:un.ISVCreator,getParams:function(){return[{ExternalServices:rn.a.ISVCreator(ye.a)}]}}),xt()(wt,Pt.BlockType.LINK_BLOCK,{creator:un.LinkBlockCreator,getParams:function(){return[{ExternalServices:rn.a.LinkBlockCreator}]}}),xt()(wt,Pt.BlockType.OKR_BLOCK,{}),wt),mn=c("5TLL"),vn=c("Nv5K"),bn=c("uPgH"),yn=c("uGsk"),En=c("VN5G"),On=c("bsrO"),Cn=c("5J3U"),kn=c("OIAp"),In=c("chgP"),Sn=c("nMtL"),Tn=c("KhPb"),_n=c("DCy2"),wn=c("6pAE"),jn=c("jUga"),Mn=c("hJmJ"),An=c("0Hpa"),Ln=c("njD1"),Rn=c("5Ucn"),Nn=c("bqU8"),Dn=c("A9Q4"),xn=c("bPgG"),Pn=c("/Mcf"),Bn=c("grVa"),Un=c("IcLG"),zn=c("46iY"),Hn=c("WtIE"),Fn=c("TBry"),Vn=c("3UIW"),Wn=c("ZuTZ"),Kn=c("UXvI"),Gn=c("vFlG"),Zn=c("y2sV"),qn=c("56Fm"),Yn=c("soGB"),Jn=c("2XSo"),Qn=c("Np3H"),Xn=c("TYVn"),$n=c("TqgO"),ei=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":de()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},ti=function(){function t(e){y()(this,t),this.editor=e,this.overLayMap=new Map,this.blockMap=new Map,this.bindEvents(),this.viewEditorsMenuStatus=!1}return O()(t,[{key:"bindEvents",value:function(){ye.a.on("updateBlockEditbar",this.handleUpdateBlockOffset),ye.a.on("viewEditorsStatusUpdate",this.handleViewEditorsMenuUpdate),this.editor&&(this.editor.on(un.BLOCK_RESIZE_EVENT_NAME.INIT,this.onBlockResize),this.editor.on(un.BLOCK_RESIZE_EVENT_NAME.ING,this.onBlockResize),this.editor.on(un.BLOCK_RESIZE_EVENT_NAME.COMMENT_OVERLAY_CHANGE,this.onBlockResize))}},{key:"handleViewEditorsMenuUpdate",value:function(e){this.viewEditorsMenuStatus=e}},{key:"handleUpdateBlockOffset",value:function(e){var t,n,i;document.body.classList.contains("showing-history")||(t=e.callerBlockId,n=e.callerTableId,i=e.leftOffset,t&&this.updateOpLine(t,i),n&&this.updateOpLine(n,i))}},{key:"updateOpLine",value:function(e,t){"number"!=typeof t&&(t=parseFloat(t)),t=Math.ceil(t);var n,i,r=this.overLayMap.get(e);this.blockMap.has(e)&&this.viewEditorsMenuStatus&&(!(n=this.blockMap.get(e))||(i=n.host.querySelector(".op-author-line"))&&t&&(n.host.style.bottom="0px",t===r?i.style.display="none":(i.style.display="inline-block",i.style.right=$n.e+Math.abs(t)+"px",i.classList.add(Object(qn.a)(n.author))))),this.overLayMap.set(e,t),0!==r&&0===t&&ye.a.trigger($n.b,[{blockId:e,halfFullStatus:!1}]),r||0===t||ye.a.trigger($n.b,[{blockId:e,halfFullStatus:!0}])}},{key:"onBlockResize",value:function(e){var t,n;e&&(document.body.classList.contains("showing-history")||(t=e.callerBlockId,n=e.leftOffset,this.updateOpLine(t,n)))}},{key:"addBlock",value:function(e,t){var n=t.host,i=t.author;n.querySelector(".op-author-line")&&this.blockMap.set(e,{host:n,author:i})}},{key:"isHalfFullStatus",value:function(e){return!!this.getLeftOffset(e)}},{key:"getLeftOffset",value:function(e){return this.overLayMap.get(e)}},{key:"destroy",value:function(){ye.a.off("updateBlockEditbar",this.handleUpdateBlockOffset),ye.a.off("viewEditorsStatusUpdate",this.handleViewEditorsMenuUpdate),this.editor&&(this.editor.off(un.BLOCK_RESIZE_EVENT_NAME.INIT,this.onBlockResize),this.editor.off(un.BLOCK_RESIZE_EVENT_NAME.ING,this.onBlockResize),this.editor.off(un.BLOCK_RESIZE_EVENT_NAME.COMMENT_OVERLAY_CHANGE,this.onBlockResize)),this.overLayMap.clear(),this.blockMap.clear(),this.editor=null}}]),t}();ei([Object(gt.Bind)()],ti.prototype,"handleViewEditorsMenuUpdate",null),ei([Object(gt.Bind)()],ti.prototype,"handleUpdateBlockOffset",null),ei([Object(gt.Bind)()],ti.prototype,"onBlockResize",null);var ni,ii=c("hbEN"),ri=(c("7rIt"),c("TSYQ")),oi=c.n(ri),ai=c("EVdn"),si=c.n(ai),ci=c("Tqb2"),li=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":de()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},ui=8,di=(ni=null,{getLabel:function(){return ni||(ni=document.createElement("span"),document.body.appendChild(ni)),ni},removeLabel:function(){ni&&(ni.classList.remove("op-author-label"),ni.style.display="none")}}),hi=function(e){function n(){var t;return y()(this,n),(t=k()(this,S()(n).apply(this,arguments))).handleMouseOver=Object(ii.default)(function(e){Jn.a.getViewEditorsMenuStatus()&&t.handleHighlightDom(e)},50),t}return j()(n,e),O()(n,[{key:"handleHighlightDom",value:function(e){var t=this.props.editor,n=e.evtTargetSelection,i=e.clientY,r=e.currentTarget;if(n){var o,a,s,c,l=n.start,u=n.end,d=this.isLineBlock({start:l,end:u}),h=this.isImage({start:l,end:u});if(d||h)h&&(o=r,Object(Ft.o)(r,"new-gallery")||(o=this.queryDom("image-container-wrap",o))),d&&(o=Object(Ft.o)(r,"ace-line")),this.queryDom($n.c,o)&&(a=this.getUserInfo({start:l,end:u}),this.isHoverOnBlockBottom(o,i)?(s=h?this.queryDom("image-container-wrap",o):this.queryDom("block-placeholder",o))&&(c=s.getBoundingClientRect(),this.createLabelSpan({top:c.bottom,left:c.left},a),this.collectTea()):di.removeLabel());else{var f=l.zoneId,p=l.line,g=t.getContentState().getZoneState(f).getEntities([]),m=g.findIndex(function(e){return e.start.line===p&&e.start.offset>=l.offset}),v=Object(Ft.f)(r,$n.c);if(!(m<0)&&v){for(var b=g[m].attributes.author,y=m;0<y;y--){var E=g[y-1],O=E.attributes,C=E.text;if(/\n/.test(C)||Object(Gn.a)(O,"lmkr"))break;if(b!==O.author)break}for(var k,I=this.getUserInfo(g[y]),S=si()(r).closest("[data-leaf=true]");S.parent("span").length;)S=S.parent("span");for(;y!==m;)S=S.prev(),y++;S.length&&(S.has(".".concat(Pt.BLOCK_PLACEHOLDER)).length&&(S=S.find(".".concat(Pt.BLOCK_PLACEHOLDER))),k=S.get(0).getBoundingClientRect(),this.createLabelSpan({top:k.top,left:k.left},I),this.collectTea())}}}}},{key:"collectTea",value:function(){Object(Te.default)("doc_main_body_author",{action_source:"user",action:"hover_part_author"})}},{key:"handleMouseOut",value:function(e){var t,n;Jn.a.getViewEditorsMenuStatus()&&(this.handleMouseOver.cancel(),t=e.relatedTarget,n=e.currentTarget,si.a.contains(n,t)||di.removeLabel())}},{key:"queryDom",value:function(e,t){return t?Object(Ft.f)(t,e)?t:t.querySelector("."+e):null}},{key:"createLabelSpan",value:function(e,t){if(!t.name)return null;var n=di.getLabel();return n.style.cssText="\n      position: absolute;\n      top: ".concat(e.top,"px;\n      left: ").concat(e.left,"px;\n      background: ").concat(t.color,";\n    "),n.classList.add("op-author-label"),n.innerText=t.name,n}},{key:"getUserInfo",value:function(e){var t=this.props.editor.getContentState().getEntities(e);if(!t||!t.length)return{name:"",color:""};var n=t[0].attributes.author;return{name:Jn.a.getUserNameById(n)||"",color:Object(be.a)(n)}}},{key:"isHoverOnBlockBottom",value:function(e,t){var n=e.getBoundingClientRect().bottom;return Math.floor(Math.abs(n-t))<=ui}},{key:"isImage",value:function(e){var t=this.props.editor.getContentState().getEntities(e);if(!t||!t.length)return!1;var n=t[0].attributes;return!!n.gallery||!!n["image-uploaded"]}},{key:"isLineBlock",value:function(e){var t=this.props.editor;try{var n=t.getContentState().getEntities(e);if(!n||!n.length)return!1;var i=n[0].attributes.dataMetaBlockProps,r=i&&JSON.parse(i).props.displayMode===Pt.BlockDisplayMode.INLINE;return!!i&&!r}catch(e){return!1}}},{key:"isEquationeBlock",value:function(e){try{var t=e.dataMetaBlockProps;return t?"EQUATION_BLOCK"===JSON.parse(t).blockType:!1}catch(e){return!1}}},{key:"render",value:function(){var e=this.props.context,t=e.children,n=e.attributes,i=oi()("".concat(Object(qn.a)(n.author)," ").concat($n.f),{"equation-block-op":this.isEquationeBlock(n),"gallery-op":Object(Ne.Q)()&&Object(ci.M)(e)});return P.a.createElement(Zn.w,{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,className:i},t)}}]),n}(P.a.Component);li([Object(gt.Bind)()],hi.prototype,"handleHighlightDom",null),li([Object(gt.Bind)()],hi.prototype,"handleMouseOut",null);c("EpUM");var fi,pi,gi,mi,vi=c("QEec"),bi=c("vEhQ"),yi=c("fujP");(pi=fi=fi||{}).INSERT="+",pi.DELETE="-",(mi=gi=gi||{}).REPLACE="replace",mi.DELETE="delete",mi.ADD="add";var Ei=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":de()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Oi=Le.tableIds.getRowAndColIdFromAttributeValue,Ci=Le.tableIds.getSortedTableCellIdsByTableIdFromVectorReps,ki=function(){function t(e){y()(this,t),this.tracker={},this.opLines={},this.editor=e,this.lineSet=new Set}return O()(t,[{key:"setOpRecord",value:function(e,t,n){Object(bi.a)(this.tracker,[e,t],n)}},{key:"setOpLine",value:function(e,t,n){Object(bi.a)(this.opLines,[e,t],n)}},{key:"getOpRecord",value:function(e,t){return Object(R.default)(this.tracker,[e,t],{})}},{key:"getOpLine",value:function(e,t){if(Object(qn.e)(e,t,this.editor)){for(var n=this.editor.getContentState().getZoneState(e),i=this.getOpRecord(e,t),r=t-1,o=t+1;0<=r&&Object(qn.e)(e,r,this.editor);)Object.assign(i,this.getOpRecord(e,r)),r--;for(;o<n.length&&Object(qn.e)(e,o,this.editor);)Object.assign(i,this.getOpRecord(e,o)),o++;return this.getOpLineByRecord(i)}return Object(R.default)(this.opLines,[e,t],[])}},{key:"spliceOpRecord",value:function(e,t,n,i){var r;this.tracker[e]||(this.tracker[e]=[]),(r=this.tracker[e]).splice.apply(r,[t,n].concat(Nt()(i)))}},{key:"spliceOpLine",value:function(e,t,n,i){var r;this.opLines[e]||(this.opLines[e]=[]),(r=this.opLines[e]).splice.apply(r,[t,n].concat(Nt()(i)))}},{key:"mergeOpRecord",value:function(e,t,n){for(var i in e){var r=Object(R.default)(t,i,0),r=n===fi.INSERT?r+e[i]:r-e[i];Object(bi.a)(t,i,r)}}},{key:"getOpLineByRecord",value:function(e){var n=["",0];return Object(vi.a)(e,function(e,t){e>n[1]&&(n=[t,e])}),n}},{key:"getTableZones",value:function(e){var t=this.editor.vectorReps,n=Oi(e);return n?Ci(t,n):[]}},{key:"isValidAttr",value:function(e){return Object(Gn.a)(e,"author")&&!Object(Gn.a)(e,"lmkr")}},{key:"isEmpty",value:function(e){if(Object(yi.default)(e))return!0;var t,n=0;for(t in e)n+=e[t];return n<=0}},{key:"emitOpEditorsChange",value:function(){var e,t=new Set;for(e in this.tracker){var n=this.tracker[e],i=!0,r=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c,l=a.value;for(c in l)l[c]&&t.add(c)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}ye.a.emit("opEditorsChange",Nt()(t))}},{key:"emitOpLineNumchange",value:function(){ye.a.emit("opLineNumChange",Nt()(this.lineSet)),this.lineSet.clear()}},{key:"init",value:function(){this.initOpOnZone(Le.DEFAULT_REP_ZONE),this.emitOpEditorsChange()}},{key:"initOpOnZone",value:function(e){var t=this.editor.getContentState().getZoneState(e);if(t)for(var n=0;n<t.length();n++){var i,r=t.getLine(n),o=this.getOpByEntity(r.getEntities([])),a=o.opRecord,s=o.opLine,c=r.getAttributes().toMap();if(Object(qn.c)(c)){var l=c.aceTable,u=this.getTableZones(l),d=!0,h=!1,f=void 0;try{for(var p,g=u[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var m=p.value;this.initOpOnZone(m)}}catch(e){h=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(h)throw f}}s=this.getTableOpLine(e,n)}else Object(qn.d)(c)&&(i=c.zoneId,Object(qe.h)(e)?a=this.getTotalOpOnNewZone(e,n):e===Le.DEFAULT_REP_ZONE&&(this.initOpOnZone(i),s=this.getNewZoneOpLine(e,n)));e===Le.DEFAULT_REP_ZONE?this.initOpOnLine(e,n,a,s):this.initOpOnLine(e,n,a)}}},{key:"genOpLine",value:function(e,t){var n=this.getOpRecord(e,t),i=this.editor.getContentState().getZoneState(e).getLine(t),r=this.getOpLineByRecord(n),o=i.getAttributes().toMap();return Object(qn.c)(o)?r=this.getTableOpLine(e,t):Object(qn.d)(o)&&(r=this.getNewZoneOpLine(e,t)),r}},{key:"update",value:function(m){var v=this;if(m.length)try{this.editor.once("paint",function(){setTimeout(function(){var e=0,t=!0,n=!1,i=void 0;try{for(var r,o=m[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){for(var a=r.value,s=a.start,c=a.deletes,l=a.inserts,u=Nt()(c),d=Nt()(l),h=s+e,f=h;u.length||d.length;){var p=u.shift(),g=d.shift();switch(v.updateState(p,g,f)){case gi.ADD:h++,f++;break;case gi.REPLACE:f++;break;case gi.DELETE:h--}}e=h-s}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}v.emitOpLineNumchange(),v.emitOpEditorsChange()},0)})}catch(e){console.log("opTracker contentchange error",e)}}},{key:"updateState",value:function(e,t,n){var i=(e||t)._entry.zone,r=e&&t?gi.REPLACE:e?gi.DELETE:gi.ADD;if(!i)return r;var o,a,s,c,l=e?this.getOpByEntity(e.getEntities([])).opRecord:{},u=t?this.getOpByEntity(t.getEntities([])).opRecord:{},d=Object(qe.h)(i),h=this.editor.managers.zoneToLineEntry[i],f=h&&h.zone,p=n;if(d||f&&f!==Le.DEFAULT_REP_ZONE){if(d?(s=h,c=i,e&&(o=e.getAttributes(0,e.length()-1).toMap(),Object(qn.d)(o)&&(l=this.getOpRecord(c,n))),t&&(a=t.getAttributes(0,t.length()-1).toMap(),Object(qn.d)(a)&&(u=this.getOpRecord(c,n)))):(s=this.editor.managers.zoneToLineEntry[f],c=f,p=this.editor.getRep(h.zone).lines.indexOfEntry(h),r=gi.REPLACE),!s)return r;var g=this.editor.getRep(s.zone).lines.indexOfEntry(s);this.updateOp({type:r,zone:c,index:p,insertRecord:u,deleteRecord:l,isRoot:!1,rootIndex:g})}else if(Object(qe.g)(i)){if(!h)return r;var m=this.editor.getRep(h.zone).lines.indexOfEntry(h);this.updateOp({type:r,zone:i,index:p,insertRecord:u,deleteRecord:l,isRoot:!1,rootIndex:m})}else this.updateOp({type:r,zone:i,index:p,insertRecord:u,deleteRecord:l});return r}},{key:"updateOp",value:function(e){var t,n,i=e.type,r=e.zone,o=e.index,a=e.isRoot,s=void 0===a||a,c=e.deleteRecord,l=e.insertRecord,u=e.rootIndex;if(-1!==o){if(i===gi.DELETE&&(this.spliceOpRecord(r,o,1,[]),s))return this.spliceOpLine(r,o,1,[]),void this.lineSet.add(o);i===gi.REPLACE&&(n=this.getOpRecord(r,o),this.mergeOpRecord(c,n,fi.DELETE),this.mergeOpRecord(l,n,fi.INSERT),this.spliceOpRecord(r,o,1,[n])),i===gi.ADD&&this.spliceOpRecord(r,o,0,[l]),!s&&u?u<0||(this.lineSet.add(u),t=this.genOpLine(Le.DEFAULT_REP_ZONE,u),this.setOpLine(Le.DEFAULT_REP_ZONE,u,t)):(this.lineSet.add(o),t=this.genOpLine(r,o),this.spliceOpLine(r,o,i===gi.REPLACE?1:0,[t]))}}},{key:"getNewZoneOpLine",value:function(e,t){var n=this.editor.getContentState().getZoneState(e).getLine(t),i=n.getAttributes().toMap(),r=this.getOpByEntity(n.getEntities([])).opLine;if(Object(qn.d)(i)){var o=i.zoneId,a=this.tracker[o]||[],s={},c=!0,l=!1,u=void 0;try{for(var d,h=a[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var f=d.value;this.mergeOpRecord(f,s,fi.INSERT)}}catch(e){l=!0,u=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw u}}this.isEmpty(s)||(r=this.getOpLineByRecord(s))}return r}},{key:"getTableOpLine",value:function(e,t){var n=this.editor.getContentState().getZoneState(e).getLine(t),i=n.getAttributes().toMap(),r=this.getOpByEntity(n.getEntities([])).opLine;if(Object(qn.c)(i)){var o=i.aceTable,a=this.getTableZones(o),s={},c=!0,l=!1,u=void 0;try{for(var d,h=a[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var f=d.value,p=this.tracker[f]||[],g=!0,m=!1,v=void 0;try{for(var b,y=p[Symbol.iterator]();!(g=(b=y.next()).done);g=!0){var E=b.value;this.mergeOpRecord(E,s,fi.INSERT)}}catch(e){m=!0,v=e}finally{try{g||null==y.return||y.return()}finally{if(m)throw v}}}}catch(e){l=!0,u=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw u}}this.isEmpty(s)||(r=this.getOpLineByRecord(s))}return r}},{key:"initOpOnLine",value:function(e,t,n,i){this.setOpRecord(e,t,n),i&&this.setOpLine(e,t,i)}},{key:"getTotalOpOnNewZone",value:function(e,t){var n=this.editor.getContentState().getZoneState(e);if(!n)return{};var i=n.getLine(t),r=i.getAttributes().toMap(),o=this.getOpByEntity(i.getEntities([])).opRecord,a={};if(Object(qn.d)(r))for(var s=r.zoneId,c=this.editor.getContentState().getZoneState(s),l=0;l<c.length();l++){var u,d=c.getLine(l);d&&(u=this.getOpByEntity(d.getEntities([])).opRecord,this.mergeOpRecord(u,a,fi.INSERT))}return this.isEmpty(a)?o:a}},{key:"getOpByEntity",value:function(e){var t={},n=["",0],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c,l,u,d=a.value,h=d.attributes,f=d.text;this.isValidAttr(h)&&(c=Object(qn.b)(f),l=h.author,u=Object(R.default)(t,l,0),Object(bi.a)(t,l,u+c.length),t[l]>n[1]&&(n=[l,t[l]]))}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return{opRecord:t,opLine:n}}},{key:"destroy",value:function(){this.editor=null,this.tracker={},this.opLines={},this.lineSet.clear()}}]),t}();Ei([Object(gt.Bind)(),Object(gt.Throttle)(300,{leading:!0,trailing:!0})],ki.prototype,"emitOpEditorsChange",null),Ei([Object(gt.Bind)()],ki.prototype,"getNewZoneOpLine",null);var Ii=c("K9Ia"),Si=c("909l"),Ti=c("VnD/"),_i=c("t9fZ"),wi=c("1lbP"),ji=c("90Nm"),Mi=c("SGN9"),Ai=c("G8Hj"),Li=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":de()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Ri=Le.tableIds.isRowsZoneId,Ni=Le.tableIds.isColsZoneId,Di=26,xi=function(e){function n(e){var r;y()(this,n),(r=k()(this,S()(n).call(this))).authorOnLineCache=new Set,r.authorOnOpCache=new Set,r.authorOnLinePending=new Set,r.requestAnimationFrameId=null,r.needUpdateLines=new Set,r.hasDocMounted$=new Ii.a,r.hasInit=!1,r.fullscreenEntered=function(){r.viewEditorsMenuStatus&&Object(Mi.f)(Ai.STEP_TYPES.doc_view_editors_guide)},r.fullscreenExited=function(){r.onResize()},r.onResize=Object(Kn.default)(function(){r.setMaxOpLineWidth();for(var e=document.querySelectorAll(".".concat($n.d)),t=0,n=e.length;t<n;t++)e[t].style.width=r.opLineMaxWidth+"px"},500,{trailing:!0}),r.getPocketTypesOfLine=function(e,t){if(r.viewEditorsMenuStatus){var n=t.lineEntry;if(r.editor&&n){var i=n.zone;if(i&&i===Le.DEFAULT_REP_ZONE)return $n.d}}},r.editor=e,r.opTracker=new ki(r.editor),r.halfFullTracker=new ti(r.editor),Jn.a.init(),r.rxOp=new wi.a;var t=Object(ji.a)().pipe(Object(Ti.a)(function(e){return!0===e}));return Object(Si.b)(Xn.c,t,r.hasDocMounted$).pipe(Object(_i.a)(1),r.rxOp.takeUntil()).subscribe(function(){ye.a.once("viewEditorsMenuChange",r.onViewEditorsMenuChange),!Object(Qn.d)()||Object(Qn.b)()&&!Object(Qn.e)()||r.init()}),r}return j()(n,e),O()(n,[{key:"bindEvents",value:function(){ye.a.on("viewEditorsStatusUpdate",this.handleViewEditorsMenuUpdate),ye.a.on("updateDocEditors",this.handleDocEditorsUpdate),ye.a.on($n.b,this.handleHalfFullScreenUpdate),ye.a.on("opLineNumChange",this.updatePocketRegion),this.editor.on("contentchange",this.onEditorContentChange),window.addEventListener("resize",this.onResize)}},{key:"unbindEvents",value:function(){ye.a.off("viewEditorsStatusUpdate",this.handleViewEditorsMenuUpdate),ye.a.off("updateDocEditors",this.handleDocEditorsUpdate),ye.a.off($n.b,this.handleHalfFullScreenUpdate),ye.a.off("opLineNumChange",this.updatePocketRegion),this.editor.off("contentchange",this.onEditorContentChange),ye.a.off("viewEditorsMenuChange",this.onViewEditorsMenuChange),window.removeEventListener("resize",this.onResize),this.onResize.cancel()}},{key:"init",value:function(){this.hasInit||(this.hasInit=!0,this.bindEvents(),this.setMaxOpLineWidth(),this.opTracker.init())}},{key:"onViewEditorsMenuChange",value:function(e){e&&!this.viewEditorsMenuStatus&&this.init()}},{key:"handleViewEditorsMenuUpdate",value:function(e){(this.viewEditorsMenuStatus=e)?(this.renderViewEditors(),Object(Mi.b)(Ai.STEP_TYPES.doc_view_editors_guide),Object(Mi.r)(Ai.STEP_TYPES.doc_view_editors_guide)):(Object(Mi.f)(Ai.STEP_TYPES.doc_view_editors_guide),this.unMountViewEditors())}},{key:"handleHalfFullScreenUpdate",value:function(e){var t,n,i,r,o;this.viewEditorsMenuStatus&&(t=e.blockId,n=e.halfFullStatus,(i=this.getLineBlockById(t))&&(n||this.needUpdateLines.add(i.line),(r=this.getPrevLine(i.zoneId,i.line))&&this.needUpdateLines.add(r.line),(o=this.getNextLine(i.zoneId,i.line))&&this.needUpdateLines.add(o.line),this.updatePocket()))}},{key:"handleDocEditorsUpdate",value:function(e){var t=e.users,n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.authorOnLinePending.has(s)&&(this.addHighlightStyleOnline(s),this.authorOnLinePending.delete(s))}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}},{key:"renderViewEditors",value:function(){for(var e=this.editor.getContentState().getZoneState(Le.DEFAULT_REP_ZONE),t=1;t<e.length();t++)this.needUpdateLines.add(t);this.updatePocket()}},{key:"unMountViewEditors",value:function(){for(var t=this,e=this.editor.getContentState().getZoneState(Le.DEFAULT_REP_ZONE),n=1;n<e.length();n++){var i=e.getLine(n)._entry,r=i.lineNode;this.removePocket(i);var o=r.querySelectorAll(".".concat($n.f)),a=!0,s=!1,c=void 0;try{for(var l,u=function(){var e=l.value;t.editor.getObserver().withoutRecordingMutations(function(){e.classList.remove($n.c)})},d=o[Symbol.iterator]();!(a=(l=d.next()).done);a=!0)u()}catch(e){s=!0,c=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw c}}}}},{key:"onMount",value:function(e,t){this.hasDocMounted$.next()}},{key:"reset",value:function(){this.requestAnimationFrameId&&window.cancelAnimationFrame(this.requestAnimationFrameId),this.viewEditorsMenuStatus&&Object(Mi.f)(Ai.STEP_TYPES.doc_view_editors_guide),this.viewEditorsMenuStatus=!1,this.opTracker.destroy(),this.unbindEvents(),Jn.a.destroy(),this.hasDocMounted$.complete(),this.rxOp.destroy(),this.editor=null,this.hasInit=!1}},{key:"editorSizeChange",value:function(e,t){var n=t.prev,i=t.next;n.width!==i.width&&this.onResize()}},{key:"setMaxOpLineWidth",value:function(){var e=this.etherpadLeftSpaceWidth-$n.e;this.opLineMaxWidth=e<0?0:e}},{key:"getLineBlockById",value:function(n){return n?(n.startsWith("aceTable-")&&(e=this.editor.getEntities(function(e,t){return"aceTable"===e&&-1<t.indexOf(n.replace("aceTable-",""))})),(e=e||this.editor.getEntities(function(e,t){return"dataMetaBlockProps"===e&&-1<t.indexOf(n)})).length?e[0].start:null):null;var e}},{key:"addHighlightStyleDom",value:function(){var e=document.createElement("style");return e.id="author-highlight-style",$("head").append(e),e}},{key:"addHighlightStyleOnline",value:function(e){var t,n,i;this.authorOnLineCache.has(e)||((t=Jn.a.getUserNameById(e))?(this.authorOnLineCache.add(e),n=this.addHighlightStyleDom(),i="\n      .author-".concat(e,".").concat($n.d,"::after {\n        content: '").concat(t,"';\n        display: inline-block;\n        position: absolute;\n        top: 0;\n        right: 0;\n        padding: 2px 4px;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        font-size: 14px;\n        line-height: 22px;\n        background: rgba(255, 255, 255, 0.8);\n        border-radius: 4px;\n        max-width: 100%;\n      }\n    "),n.innerText=i):this.authorOnLinePending.add(e))}},{key:"addHighLightStyleOnOp",value:function(e){var t,n,i;this.authorOnOpCache.has(e)||(t=Object(be.a)(e),this.authorOnOpCache.add(e),n=this.addHighlightStyleDom(),i="\n      .author-".concat(e,".").concat($n.c," {\n        border-bottom: 2px dotted ").concat(t," !important;\n      }\n    "),n.innerText=i)}},{key:"updateOpPlaceHolder",value:function(e,t){var n=this;if(e.isRendered&&e.lineNode&&t){var i=e.lineNode.querySelectorAll(".".concat($n.f)),r=!0,o=!1,a=void 0;try{for(var s,c=function(){var e=s.value;n.editor.getObserver().withoutRecordingMutations(function(){e.classList.contains(Object(qn.a)(t))?e.classList.remove($n.c):e.classList.add($n.c)})},l=i[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)c()}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}}}},{key:"linesWillReplace",value:function(e,t){var n=t.newLineEntries;if(this.viewEditorsMenuStatus){var i=!0,r=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,l=this.getRootEntry(c),u=this.editor.getRep(l.zone).lines.indexOfEntry(l),d=this.opTracker.getOpLine(Le.DEFAULT_REP_ZONE,u);d&&d[1]&&0!==u&&this.updateOpPlaceHolder(l,d[0])}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}}},{key:"bufferChanged",value:function(e,t){if(this.viewEditorsMenuStatus){var n=t.enteredLines;if(n){for(var i=[],r=0;r<n.length;r++){var o=n[r],a=o.zone,s=o.lineNum;a===Le.DEFAULT_REP_ZONE&&i.push(s)}this.updatePocketRegion(i)}}}},{key:"acePreWriteDomLineHTML",value:function(e,t){t&&t.info&&t.info.zone===Le.DEFAULT_REP_ZONE&&(t.isPocket=!0,t.isPocketWithoutFakeText=!0)}},{key:"match",value:function(e){return"author"===e}},{key:"render",value:function(e){var t=e.attributes,n=e.children;return this.addHighLightStyleOnOp(t.author),Object(Gn.a)(t,"lmkr")||Object(Gn.a)(t,"zoneType")||t.enter?n:P.a.createElement(hi,{editor:this.editor,context:e})}},{key:"renderLine",value:function(e){var t=e.lineState,n=e.children;if(Object(Ne.Q)())return n;var i=t.getOps();if(!this.isNewGalleryStructure(i))return n;var r=t.getAttributes(t.getLineMarker(),t.length()).toMap();return r.author?P.a.createElement(hi,{editor:this.editor,context:{children:n,attributes:r}}):n}},{key:"isNewGalleryStructure",value:function(e){var n=0;return e.forEach(function(e){var t=e.attributes;(void 0===t?{}:t).gallery&&(n+=1)}),1<n}},{key:"getCurrentLine",value:function(e,t){var n=t;if(Object(qn.e)(e,n,this.editor))for(;0<=n-1&&Object(qn.e)(e,n-1,this.editor);)n--;return{zone:e,line:n}}},{key:"getPrevLine",value:function(e,t){if(!e||e===Le.DEFAULT_REP_ZONE&&t<=1||t<0)return null;var n=t;if(Object(qn.e)(e,n,this.editor))for(;0<=n-1&&Object(qn.e)(e,n-1,this.editor);)n--;var i=Object(Yn.e)(this.editor,e,n-1);return null===i?null:{zone:e,line:i=this.getCurrentLine(e,i).line}}},{key:"getNextLine",value:function(e,t){if(!e||t<0)return null;var n=t;if(Object(qn.e)(e,n,this.editor))for(var i=this.editor.getContentState().getZoneState(e);n+1<i.length()&&Object(qn.e)(e,n+1,this.editor);)n++;var r=Object(Yn.f)(this.editor,e,n+1);return r?{zone:e,line:r=this.getCurrentLine(e,r).line}:null}},{key:"updatePocketRegion",value:function(e){if(this.viewEditorsMenuStatus){var t=new Set(e),n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.needUpdateLines.add(s);var c=this.getCurrentLine(Le.DEFAULT_REP_ZONE,s);this.needUpdateLines.add(c.line);var l=this.getPrevLine(Le.DEFAULT_REP_ZONE,s);l&&this.needUpdateLines.add(l.line);var u=this.getNextLine(Le.DEFAULT_REP_ZONE,s);u&&this.needUpdateLines.add(u.line)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}this.updatePocket()}}},{key:"updatePocket",value:function(){var c=this;this.requestAnimationFrameId=window.requestAnimationFrame(function(){var e=!(c.requestAnimationFrameId=null),t=!1,n=void 0;try{for(var i,r=c.needUpdateLines[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value,a=c.opTracker.getOpLine(Le.DEFAULT_REP_ZONE,o),s=c.editor.getContentState().getZoneState(Le.DEFAULT_REP_ZONE).getLine(o);s&&(a[1]?(0!==o&&c.updateOpPlaceHolder(s._entry,a[0]),Object(qn.e)(Le.DEFAULT_REP_ZONE,o,c.editor)&&Object(qn.e)(Le.DEFAULT_REP_ZONE,o-1,c.editor)?c.removePocket(s._entry):c.addPocket(Le.DEFAULT_REP_ZONE,o,a[0])):c.removePocket(s._entry))}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}c.needUpdateLines.clear()})}},{key:"removePocket",value:function(e){var t,n,i;!e||(t=e.lineNode)&&(!(n=t.pocket)||(i=n.pocketItems.find(function(e){return e.aceLineClassType===$n.d}))&&this.editor.getObserver().withoutRecordingMutations(function(){var e=i.id;n.remove(e)}))}},{key:"addPocket",value:function(t,n,i){var r=this,e=this.editor.getContentState().getZoneState(t).getLine(n)._entry;if(e&&(e.isActive||e.isRetained)&&(t!==Le.DEFAULT_REP_ZONE||0!==n)){var o,a=this.getIsHalfFullStatus(t,n),s=!0,c=!1,l=this.getNextLine(t,n);!l||a||this.getIsHalfFullStatus(l.zone,l.line)||(o=this.opTracker.getOpLine(l.zone,l.line))&&o[0]===i&&(c=!0);var u,d=this.getPrevLine(t,n);!d||a||this.getIsHalfFullStatus(d.zone,d.line)||(u=this.opTracker.getOpLine(d.zone,d.line))&&u[0]===i&&(s=!1);var h=Object(be.a)(i),f=e.lineNode.pocket;if(f){var p=f.pocketItems.find(function(e){return e.aceLineClassType===$n.d}),g=document.createElement("span");g.className="".concat($n.d).concat(s?" author-".concat(i):""),g.dataset.selector="doc_view_edtiors_guide",g.style.cssText="border-right: 2px solid ".concat(h,";\n                              color: ").concat(h,";\n                              width: ").concat(this.opLineMaxWidth,"px;\n                              ");var m=this.getLineBlockInfo(t,n).blockId,v=m?this.halfFullTracker.getLeftOffset(m):0;if(v&&(g.style.right=$n.e+Math.abs(v)+"px"),p)return this.editor.getObserver().withoutRecordingMutations(function(){r.addHighlightStyleOnline(i),p.host.innerHTML=g.outerHTML,p.host.style.bottom=c?"-".concat(Di,"px"):"0px"}),void this.updateHalfFullTracker(t,n,{host:p.host,author:i});this.editor.getObserver().withoutRecordingMutations(function(){f.put([{uniqueClass:$n.d,mount:function(e){return r.addHighlightStyleOnline(i),e.style.bottom=c?"-".concat(Di,"px"):"0px",e.className="op-author-host",e.innerHTML=g.outerHTML,r.updateHalfFullTracker(t,n,{host:e,author:i}),e}}])})}}}},{key:"updateHalfFullTracker",value:function(e,t,n){var i=this.getLineBlockInfo(e,t),r=i.blockId,o=i.blockType;"SHEET_BLOCK"!==o&&"BITABLE_BLOCK"!==o&&"JIRA_FILTER_BLOCK"!==o&&"ACE_TABLE"!==o||r&&this.halfFullTracker.addBlock(r,n)}},{key:"getIsHalfFullStatus",value:function(e,t){var n=this.getLineBlockInfo(e,t).blockId;return!!n&&this.halfFullTracker.isHalfFullStatus(n)}},{key:"getLineBlockInfo",value:function(e,t){var n={blockId:"",blockType:""};try{var i,r,o=this.editor.getContentState().getZoneState(e).getLine(t),a=o.getAttributes(0,o.length()-1).toMap();return Object(Gn.a)(a,"dataMetaBlockProps")&&(r=(i=JSON.parse(a.dataMetaBlockProps)).blockId,n={blockType:i.blockType,blockId:r}),Object(Gn.a)(a,"aceTable")&&(n={blockType:"ACE_TABLE",blockId:"aceTable-"+a.aceTable}),n}catch(e){return n}}},{key:"onEditorContentChange",value:function(e){var t=e.changes,n=Object.keys(t);if(n.length){n.sort(function(e,t){return t.length-e.length});for(var i=0,r=n;i<r.length;i++){var o=r[i];Ni(o)||Ri(o)||this.opTracker.update(t[o])}}}},{key:"getRootEntry",value:function(e){var t=Object(qe.h)(e.zone),n=this.editor.managers.zoneToLineEntry[e.zone],i=n&&n.zone;return t?n:i&&i!==Le.DEFAULT_REP_ZONE?this.editor.managers.zoneToLineEntry[i]:n&&i===Le.DEFAULT_REP_ZONE?n:e}},{key:"etherpadLeftSpaceWidth",get:function(){var e=$(".etherpad-container"),t=e.offset();return 0!==e.length&&t?t.left:0}}]),n}(Zn.p);Li([Object(gt.Bind)()],xi.prototype,"onViewEditorsMenuChange",null),Li([Object(gt.Bind)()],xi.prototype,"handleViewEditorsMenuUpdate",null),Li([Object(gt.Bind)()],xi.prototype,"handleHalfFullScreenUpdate",null),Li([Object(gt.Bind)()],xi.prototype,"handleDocEditorsUpdate",null),Li([Object(gt.Bind)()],xi.prototype,"updatePocketRegion",null),Li([Object(gt.Bind)()],xi.prototype,"onEditorContentChange",null);var Pi=c("CXkg"),Bi=c("4xyU"),Ui=c("CJfy"),zi=c("SNYb"),Hi=c("QgWq"),Fi=c("8hcq"),Vi=c("raF6"),Wi=c("Vw45"),Ki=c("tvAd"),Gi=c("RooE"),Zi=c("sxjD"),qi=c("YeJo"),Yi=c("8qB3"),Ji=c("XC0b"),Qi=c("EupG"),Xi=c("bNqd"),$i=c("+DGl"),er=c("dzTx"),tr=c("euE0"),nr=c("FKAX"),ir=c("trzc"),rr=c("MEJ+"),or=c("kWuU"),ar=c("CHKa"),sr=c("SLR9"),cr=c("XUVG"),lr=c("EIW1"),ur=c("gX+J"),dr=c("WP/d"),hr=c("DKi5"),fr=c("mELL"),pr=c("hrO2"),gr=c("k8MZ"),mr=c("CZAk"),vr=c("jnLa"),br=c("Kboj"),yr=c("v2yP"),Er=c("IrCn"),Or=c("nyf+"),Cr=c("m3gH"),kr=c("A1RT"),Ir=c("uj+v"),Sr=c("VXMt"),Tr=c("y9eh"),_r=c("5XQB"),wr=c("QdK8"),jr=c("oXmN"),Mr=c("vlE4"),Ar=c("3K16"),Lr=c("7pLJ"),Rr=c("3iI8"),Nr=c("/WRf"),Dr=c("p7Cg"),xr=c("90+h"),Pr=c("FrgG"),Br=c("2tnv"),Ur=c("Muja"),zr=(c("/cTv"),c("aBgF")),Hr=c("3xnr"),Fr=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":de()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},Vr="inline-attribs-placeholder",Wr="placeholder-active",Kr="placeholder-invisible",Gr="".concat(U.FAKETEXT_PREFIX,'<span class="').concat(Hr.a,'" contenteditable="false">'),Zr="</span>".concat(U.FAKETEXT_SUFFIX),qr=function(e){function d(e){var t;return y()(this,d),(t=k()(this,S()(d).call(this))).editor=e,t.$activeDom=null,t.processing=!1,si()(e.getDocBody()).on("click","."+Hr.a,t.handlePlaceholderClick),t}return j()(d,e),O()(d,[{key:"aceAttribsToClasses",value:function(e,t){return t.key===d.formatKey?[Vr]:[]}},{key:"aceCreateDomLine",value:function(e,t){var n=t.spanClass,i=t.htmls;0===i.length&&(this.processing=!1),n.includes(Vr)?(this.processing||t.htmls.push(Gr),this.processing=!0):this.processing&&(i.push(Zr),this.processing=!1)}},{key:"aceSelectionChanged",value:function(e,t){var n=t.rep,i=n.selStart,r=n.selEnd,o=n.zoneId;this.$activeDom=null,i&&r&&Object(Ur.default)(i,r)&&this.updateActivePlaceholder(o,i,r)}},{key:"aceKeyEvent",value:function(e,t){var n,i,r,o,a=t.evt;"keydown"===a.type&&(a.keyCode===zr.c.Enter?this.removePlaceholder():!this.$activeDom||a.metaKey||a.ctrlKey||a.altKey||!String.fromCharCode(a.keyCode).match(/(\w|\s)/g)||!this.$activeDom.hasClass(Wr)||this.$activeDom.hasClass(Kr)?a.keyCode===zr.c.Z&&(a.metaKey||a.ctrlKey)&&(this.editor.fastIncorp(),i=(n=this.editor.getRep()).zoneId,r=n.selEnd,o=n.selStart,this.updateActivePlaceholder(i,o,r)):this.hidePlaceholder())}},{key:"aceCompositionEvent",value:function(e,t){var n=t.evt;this.$activeDom&&"compositionstart"===n.type&&this.$activeDom.hasClass(Wr)&&!this.$activeDom.hasClass(Kr)&&this.hidePlaceholder()}},{key:"destroy",value:function(){si()(this.editor.getDocBody()).off("click","."+Hr.a,this.handlePlaceholderClick)}},{key:"updateActivePlaceholder",value:function(e,t,n){var i,r,o,a,s,c,l,u=this;Object(Ur.default)(t,n)&&(r=(i=te()(t,2))[0],o=i[1],a=this.editor.getAttributesOnSelection(e,{selStart:[r,o,e],selEnd:[r,o+1,e]}).attribs,s=this.editor.getObserver(),!this.$activeDom||(c=si()(this.editor.getDocBody()).find("."+Wr)).length&&s.withoutRecordingMutations(function(){c.removeClass(Wr)}),!a.some(function(e){return te()(e,1)[0]===d.formatKey})||(l=this.getPlaceholder(e,t,n))&&s.withoutRecordingMutations(function(){u.$activeDom=l,u.$activeDom&&u.$activeDom.addClass(Wr)}))}},{key:"handlePlaceholderClick",value:function(n){var i=this;this.editor.inCallStackIfNecessary("clickPlaceholder",function(){i.editor.fastIncorp();var e,t=i.editor.domToRep(si()(n.currentTarget).find("."+Vr)[0]);t&&(e=t.selStart,i.editor.selection.setWithSelection(e[2],e,e),i.editor.selection.updateBrowserSelectionFromRep(!0))})}},{key:"hidePlaceholder",value:function(){var e=this;this.editor.getObserver().withoutRecordingMutations(function(){e.$activeDom&&e.$activeDom.addClass(Kr)})}},{key:"removePlaceholder",value:function(){var o=this;this.editor.inCallStackIfNecessary("removePlaceholder",function(){o.editor.fastIncorp();var e,t,n,i,r=o.editor.domToRep(o.$activeDom&&o.$activeDom[0]);r&&(e=r.selStart,t=r.selEnd,o.$activeDom=null,n=e.slice(0,2),i=t.slice(0,2),o.editor.performDocumentReplaceRange(e[2],n,i,""))})}},{key:"getPlaceholder",value:function(e,t,n){var i=this,r=this.editor.getRep(e).lines.atIndex(t[0]);if(!r||t[0]!==n[0])return null;var o=si()(r.lineNode).find("."+Hr.a),a=[];o.each(function(e,t){a.push(i.editor.domToRep(t))});var s=t[1],c=n[1],l=-1;return a.forEach(function(e,t){var n=e.selEnd,i=e.selStart;-1===l&&(i[1]>=s&&i[1]<=c||n[1]>=s&&n[1]<=c)&&(l=t)}),-1!==l?o.slice(l,l+1):null}}],[{key:"collect",value:function(e){var t=[];return e.classList.contains(Vr)&&t.push([d.formatKey,"true"]),{attributes:t}}}]),d}(Le.TreeFormatter);qr.formatKey="placeholder",qr.formatType=Le.TreeFormatter.FormatType.INLINE,qr.formatValueType=Le.TreeFormatter.FormatValueType.Object,qr.toggleable=!0,Fr([Object(gt.Bind)()],qr.prototype,"updateActivePlaceholder",null),Fr([Object(gt.Bind)()],qr.prototype,"handlePlaceholderClick",null);var Yr,Jr=c("Obi4"),Qr=c("9GRl"),Xr=c("y7Jg"),$r=c("DGTj"),eo=c("D6hs"),to=c("58X4"),no=c("1D29"),io=c("uyOI"),ro=c("w2ss"),oo=c("76Lu"),ao=c("IGcA"),so=c("lJ7m"),co=c("gBrI"),lo=c("qTk9"),uo=c("jq0X"),ho=c("PGru"),fo=c("xnu4"),po=c("jU1f"),go=c("xYHj"),mo=c("MZhh"),vo=function(){function t(e){var s=this;y()(this,t),this.editor=e,this.jumpToGuid=function(){var t=oe()(ie.a.mark(function e(t){var n,i,r,o,a;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(po.f)(s.editor,t)){e.next=3;break}return e.abrupt("return");case 3:return i=n.selZone,r=n.selStart,o=s.getSectionNavPlugin(),a=i===Le.DEFAULT_REP_ZONE&&Object(go.j)(s.editor.getRep(i),r[0]),o&&a&&o.setLockScrollToActive(),e.next=9,s.onScrollTop(n,function(){o&&a&&o.clearLockScrollToActive()});case 9:if(i!==Le.DEFAULT_REP_ZONE)return e.next=12,Promise.all([c.e("doc_index_css"),c.e("chunk_adit"),c.e("commons--doc_index_delay--voteEmoji--votePicker"),c.e(16),c.e("commons--doc_index_delay--jira"),c.e("doc_index_delay")]).then(c.bind(null,"uPGt"));e.next=15;break;case 12:e.sent.horizontalScrollToZone(s.editor,n),o&&o.checkSectionNavState();case 15:Object(po.g)(s.editor,n,!0),i===Le.DEFAULT_REP_ZONE&&o&&Object(go.j)(s.editor.getRep(i),r[0])&&o.updateNavActiveGuid(t);case 17:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()}return O()(t,[{key:"getSectionNavPlugin",value:function(){var e=Object(fo.a)(nr.b);return this.editor.plugins[e]}},{key:"onScrollTop",value:function(e,t){return Object(po.i)({editor:this.editor,offsetTop:mo.a,selection:e,complete:t,animate:!1,source:"hash"})}}]),t}(),bo=c("EVj1"),yo=c("hMnB"),Eo=c.n(yo),Oo=c("sLU5"),Co=Object.keys(mo.b),ko=function(){function n(e){var t=this;y()(this,n),this.editor=e,this.handleQueryChange=function(){t.maybeDoQueryJump()},ye.a.on(Oo.a.PC.DOCS.HISTORY.QUERY_CHANGE,this.handleQueryChange)}function e(e,t){return i.apply(this,arguments)}var i;return O()(n,[{key:"maybeDoQueryJump",value:function(){var e,t=Object(bo.l)(location.href),n=Co.find(function(e){return!!t[e]});n&&(e=t[n],this.queryJump(n,e))}},{key:"queryJump",value:(i=oe()(ie.a.mark(function e(t,n){var i,r;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=mo.b[t],r=i.getSelection(this.editor,n)){e.next=4;break}return e.abrupt("return",this.showDeleteToast(t,i.deletedMsg));case 4:return e.next=6,Object(po.i)({editor:this.editor,offsetTop:mo.a,selection:r,animate:!1,source:"query"});case 6:if(r.selZone!==Le.DEFAULT_REP_ZONE)return e.next=9,Promise.all([c.e("doc_index_css"),c.e("chunk_adit"),c.e("commons--doc_index_delay--voteEmoji--votePicker"),c.e(16),c.e("commons--doc_index_delay--jira"),c.e("doc_index_delay")]).then(c.bind(null,"uPGt"));e.next=11;break;case 9:e.sent.horizontalScrollToZone(this.editor,r);case 11:Object(po.g)(this.editor,r,!0),Object(bo.c)(Eo.a.href,t);case 13:case"end":return e.stop()}},e,this)})),e)},{key:"showDeleteToast",value:function(e,t){qt.a.error({closable:!0,content:t,key:e})}},{key:"destroy",value:function(){ye.a.off(Oo.a.PC.DOCS.HISTORY.QUERY_CHANGE,this.handleQueryChange)}}]),n}(),Io=c("rxZW"),So=function(){function n(e){var t=this;y()(this,n),this.editor=e,this.className="JumpContent",this.hashJump=new vo(this.editor),this.queryJump=new ko(this.editor),this.handleEditorMount=function(){var e=t.getLocationHash();e?t.hashJump.jumpToGuid(e):t.queryJump.maybeDoQueryJump()}}return O()(n,[{key:"onMount",value:function(){Object(Io.a)()?this.editor.on(Oo.a.PC.DOCS.REMOVE_SSR,this.handleEditorMount):this.handleEditorMount(),ye.a.on(Oo.a.PC.DOCS.EDITOR_JUMP_TO_GUID_POSITION,this.hashJump.jumpToGuid)}},{key:"getLocationHash",value:function(){return Eo.a.hash.slice(1)}},{key:"reset",value:function(){this.editor.off(Oo.a.PC.DOCS.REMOVE_SSR,this.handleEditorMount),ye.a.off(Oo.a.PC.DOCS.EDITOR_JUMP_TO_GUID_POSITION,this.hashJump.jumpToGuid),this.queryJump.destroy()}}]),n}(),To=c("on5/"),_o=c("LT0/"),wo=c("EBUI"),jo=c("Q2zD"),Mo=c("rPvU"),Ao=function(){function e(){y()(this,e)}return O()(e,[{key:"editorWillPaste",value:function(e){var t=e.deltaSet,n=e.zoneId,i=t.get(n),r=i.ops[0];return r&&r.attributes&&r.attributes.lmkr&&Object(Mo.a)(r.attributes)&&i.ops.shift(),t}}]),e}(),Lo=c("RPIr"),Ro=c("/2EM"),No=c("avPc"),Do=c("gUre"),xo=c("M/LR"),Po=c("69iA"),Bo=c("5TP0"),Uo=c("VIFs"),zo=function(){function e(){y()(this,e)}return O()(e,[{key:"UNSAFE_editorNormalizePasteNode",value:function(e){this.compatEdgeUrl(e)}},{key:"compatEdgeUrl",value:function(e){var t,n,i,r,o=e.event,a=e.data.node;Ce.a.isWindows&&(!(t=o.clipboardData||window.clipboardData)||(n=t.types).includes("text/plain")&&n.includes("text/html")&&(i=t.getData("text/html").replace(/>\s*?</g,"><"),new RegExp('<html><body>\x3c!--StartFragment--\x3e<a href="(.*?)">.*?</a>\x3c!--EndFragment--\x3e</body></html>').test(i)&&(r=t.getData("text/plain"),Object(Uo.isSuiteUrl)(r)&&(a.innerHTML=""))))}}]),e}(),Ho=c("iaE7"),Fo=c("4/Xm"),Vo=(c("GM7c"),function(){function t(e){var o=this;y()(this,t),this.editor=e,this.className="AsyncDomLoadingManager",this.viewportStart=0,this.handleAsyncNodeWillLoading=function(e){var t,n,i=e.zoneId,r=e.lineEntry;r&&i===Le.DEFAULT_REP_ZONE&&r.lineNode&&(r.isRetained||r.isActive?o.addLineLoading(r.lineNode):o.editor.listView&&(t=o.editor.getRep(Le.DEFAULT_REP_ZONE).lines.indexOfEntry(r),n=o.editor.listView._getLayoutForLine(t),o.addLineLoading(r.lineNode,"".concat(n.height,"px"))))},this.handleAsyncNodeDidLoading=function(e){var t,n,i=e.zoneId,r=e.lineEntry;r&&i===Le.DEFAULT_REP_ZONE&&r.lineNode&&(t=o.editor.getRep(Le.DEFAULT_REP_ZONE).lines.indexOfEntry(r),0!==o.viewportStart||(n=o.editor.blockRender.getViewportLines()[0]||[])[0]!==o.viewportStart&&(o.viewportStart=n[0]),t<o.viewportStart||o.removeLineLoading(r))},this.bindEvent()}return O()(t,[{key:"bufferChanged",value:function(e,t){var n=t.viewportLines[Le.DEFAULT_REP_ZONE];this.viewportStart=n[0]||0,this.removeViewportLoading()}},{key:"reset",value:function(){this.unbindEvent()}},{key:"aceScrollEndInViewport",value:function(e,t){var n=t.viewportLines[Le.DEFAULT_REP_ZONE];n&&(this.viewportStart=n[0]||0,this.removeViewportLoading())}},{key:"bindEvent",value:function(){this.editor.on(Le.ASYNC_NODE_WILL_SHOW_LOADING_EVENT,this.handleAsyncNodeWillLoading),this.editor.on(Le.ASYNC_NODE_DID_SHOW_LOADING_EVENT,this.handleAsyncNodeDidLoading)}},{key:"unbindEvent",value:function(){this.editor.off(Le.ASYNC_NODE_WILL_SHOW_LOADING_EVENT,this.handleAsyncNodeWillLoading),this.editor.off(Le.ASYNC_NODE_DID_SHOW_LOADING_EVENT,this.handleAsyncNodeDidLoading)}},{key:"addLineLoading",value:function(e,t){this.editor.getObserver().withoutRecordingMutations(function(){e.style.height=t||e.offsetHeight+"px",e.classList.add("show-line-loading")})}},{key:"removeLineLoading",value:function(e){var t=this,n=e.lineNode,i=e.key,r=e.zone;n&&this.editor.getObserver().withoutRecordingMutations(function(){n.classList.remove("show-line-loading"),n.style.height="",t.editor.call(Le.ASYNC_NODE_DID_UPDATE_EVENT,{key:i,zoneId:r})})}},{key:"removeViewportLoading",value:function(){for(var e=this.editor.blockRender.getCurrentBufferRange(),t=this.viewportStart;t<=e[1];t++){var n,i=this.editor.getRep(Le.DEFAULT_REP_ZONE).lines.atIndex(t);i&&((n=i.lineNode)&&n.classList.contains("show-line-loading")&&this.removeLineLoading(i))}}}]),t}()),Wo=c("9hjO").a,Ko=c("YNKm"),Go=c("3HEd");function Zo(t){$("#".concat(Go.b)).length||(Yr=$("<input name='upload' type='file' multiple='multiple' id='".concat(Go.b,"'  style='display: none' />")),$("body").append(Yr),t&&Yr.on("change",function(e){return t(e.originalEvent),e.target.value="",!1}))}function qo(){Yr&&(Yr.attr("accept",Go.c),Yr.trigger("click"))}function Yo(){var e=$("#".concat(Go.b));e.length&&(e.off(),e.remove())}var Jo,Qo=function(){function n(e,t){var i=this;y()(this,n),this.editor=e,this.plugins=t,this.name=Go.d,this.className=Go.d,this.handleUpload=function(t,n){i.plugins.forEach(function(e){e.upload({event:n,source:t})})},this.registerEditorCommand()}return O()(n,[{key:"reset",value:function(){Yo()}},{key:"registerEditorCommand",value:function(){var o=this;this.editor.commands.registerAceCommand(Ko.L,function(e,t,n,i){var r=i.source;Go.a.includes(r)&&(Zo(o.handleUpload.bind(o,r)),qo())})}}]),n}(),Xo=(Jo={},xt()(Jo,vn.a.OpAuthor,{plugin:xi}),xt()(Jo,vn.a.ContextPreprocess,{plugin:zo}),xt()(Jo,vn.a.TextInputTime,{plugin:kr.a}),xt()(Jo,vn.a.ScrollFps,{plugin:wr.a}),xt()(Jo,vn.a.Delete,{plugin:Cn.a}),xt()(Jo,vn.a.Undo,{plugin:kn.default}),xt()(Jo,vn.a.Redo,{plugin:In.default}),xt()(Jo,vn.a.TextNodeDeserializer,{plugin:Zn.x}),xt()(Jo,vn.a.BlockElementDeserializer,{plugin:Zn.b}),xt()(Jo,vn.a.PasteStyleInherit,{plugin:Lo.a}),xt()(Jo,vn.a.Indent,{plugin:Sn.default}),xt()(Jo,vn.a.ViewportObserver,{plugin:Do.a}),xt()(Jo,vn.a.DocPosition,{plugin:Qr.a}),xt()(Jo,vn.a.Rect,{plugin:Tn.a}),xt()(Jo,vn.a.Range,{plugin:_n.a}),xt()(Jo,vn.a.CursorTrack,{plugin:wn.a}),xt()(Jo,vn.a.AttributePositionManager,{plugin:To.AttributePositionManager,getParams:function(e){return[e.editor,ye.a]}}),xt()(Jo,vn.a.WordCopySupport,{plugin:Ui.a}),xt()(Jo,vn.a.TencentDocCopySupport,{plugin:zi.a}),xt()(Jo,vn.a.GDCopySupport,{plugin:Vi.a}),xt()(Jo,vn.a.OneNoteCopySupport,{plugin:Hi.a}),xt()(Jo,vn.a.OneDriveWordCopySupport,{plugin:Fi.a}),xt()(Jo,vn.a.EditorCopy,{plugin:cr.a}),xt()(Jo,vn.a.Align,{plugin:Vn.a}),xt()(Jo,vn.a.Author,{plugin:Wn.a}),xt()(Jo,vn.a.Line,{plugin:Pi.a}),xt()(Jo,vn.a.PCHeadings,{plugin:An.a,getParams:function(e){return[e.editor,{hasCollapse:!0}]}}),xt()(Jo,vn.a.Heading,{plugin:Mn.a,getParams:function(e){return[e.editor,{hasCollapse:!0}]}}),xt()(Jo,vn.a.Horizontal,{plugin:Ln.a}),xt()(Jo,vn.a.ShortKeyTea,{plugin:jr.a}),xt()(Jo,vn.a.HyperLinks,{plugin:Rn.HyperLinks,getParams:function(e){return[{editor:e.editor,parseJiraIssueEnable:Object(On.f)(),parseJiraFilterEnable:Object(On.d)()}]}}),xt()(Jo,vn.a.HyperLinksRemoveLink,{plugin:Rn.HyperLinksRemoveLink}),xt()(Jo,vn.a.HyperLinksBackground,{plugin:Rn.HyperLinksBackground}),xt()(Jo,vn.a.Simpletags,{plugin:Or.a}),xt()(Jo,vn.a.Quote,{plugin:Nn.c}),xt()(Jo,vn.a.TabKey,{plugin:Dn.a}),xt()(Jo,vn.a.PCList,{plugin:xn.a}),xt()(Jo,vn.a.Table,{plugin:vr.a,getParams:function(e){return[e.editor,{fullWidth:!U.isPDFAccess,platform:"pc"}]}}),xt()(Jo,vn.a.SheetBridgePlugin,{plugin:Kt.a,getParams:function(e){return[{editor:e.editor}]}}),xt()(Jo,vn.a.BitableBridgePlugin,{plugin:Gt.a,getParams:function(e){return[{editor:e.editor}]}}),xt()(Jo,vn.a.MindnoteBridgePlugin,{plugin:Zt.a,getParams:function(e){return[{editor:e.editor}]}}),xt()(Jo,vn.a.BlockPlugin,{plugin:Object(Pt.Commentable)(Pt.BlockPlugin),dependencies:{sheetBridgePlugin:vn.a.SheetBridgePlugin,bitableBridgePlugin:vn.a.BitableBridgePlugin,mindnoteBridgePlugin:vn.a.MindnoteBridgePlugin},getParams:function(e){var r=e.editor,o=e.sheetBridgePlugin,a=e.bitableBridgePlugin,s=e.mindnoteBridgePlugin,t=Object(mn.a)().blocks,n=Object(rn.g)(),c=Object(rn.d)(),i=t.map(function(e){if(e&&gn[e]){var t=gn[e],n=t.creator,i=(0,t.getParams)({blockWidthNotifyModule:c,sheetBridgePlugin:o,bitableBridgePlugin:a,mindnoteBridgePlugin:s});return Lt()(n||Object(Pt.getBlockCreator)(e,r),Nt()(i))}});return[{editor:r,modules:[].concat(Nt()(n),Nt()(c)),blockManager:new Pt.BlockManager(i.filter(function(e){return e})),appConfig:{lazyBlockRender:!0,blockFiberRender:!1},defaultSupportModules:new Map([[Pt.HalfFullScreenModule,!Object(ht.a)()]])}]},execAfterGenerate:function(e,t){var n=t.sheetBridgePlugin,i=t.bitableBridgePlugin,r=t.mindnoteBridgePlugin;n.setBlockEventEmitter(e.event),i.setBlockEventEmitter(e.event),r.setBlockEventEmitter(e.event)}}),xt()(Jo,vn.a.CommentPlugin,{plugin:Pn.a,dependencies:{blockPlugin:vn.a.BlockPlugin},getParams:function(e){var t=e.editor,n=e.blockPlugin,i=e.galleryComment,r=Object(En.a)(U.NUM_FILE_TYPE.DOC,t.getDocId()),o=new To.AttributePositionManagerController(ye.a);return Object(yn.b)({CommentService:r}),[{editor:t,comment:new Bn.a({changeSetCommitWatcher:new jn.a,editor:t,attributePositionController:o,commentService:r,plugins:[n,i]})}]}}),xt()(Jo,vn.a.Bold,{plugin:Un.a}),xt()(Jo,vn.a.Italic,{plugin:zn.b}),xt()(Jo,vn.a.Underline,{plugin:Hn.b}),xt()(Jo,vn.a.Strikethrough,{plugin:Fn.b}),xt()(Jo,vn.a.Sheet,{plugin:Qi.a,dependencies:{sheetBridgePlugin:vn.a.SheetBridgePlugin},getParams:function(e){return[{editor:e.editor,sheetBridgePlugin:e.sheetBridgePlugin}]}}),xt()(Jo,vn.a.Bitable,{plugin:Xi.a,dependencies:{bitableBridgePlugin:vn.a.BitableBridgePlugin},getParams:function(e){return[{editor:e.editor,bitableBridgePlugin:e.bitableBridgePlugin,eventEmitter:ye.a}]}}),xt()(Jo,vn.a.ISVBlock,{plugin:$i.a,getParams:function(e){return[e.editor]}}),xt()(Jo,vn.a.Mindnote,{plugin:er.a,dependencies:{mindnoteBridgePlugin:vn.a.MindnoteBridgePlugin},getParams:function(e){return[{editor:e.editor,mindnoteBridgePlugin:e.mindnoteBridgePlugin,eventEmitter:ye.a}]}}),xt()(Jo,vn.a.Save,{plugin:Bi.a}),xt()(Jo,vn.a.DocHistory,{plugin:Wi.a}),xt()(Jo,vn.a.Checkbox,{plugin:Ki.a}),xt()(Jo,vn.a.CodeBlock,{plugin:Gi.b}),xt()(Jo,vn.a.Markdown,{plugin:Zi.a}),xt()(Jo,vn.a.MobileEditBarStatusManager,{plugin:qi.a}),xt()(Jo,vn.a.EditBarManager,{plugin:Yi.a}),xt()(Jo,vn.a.SelectionPopup,{plugin:Ji.a,getParams:function(e){return[{editor:e.editor}]}}),xt()(Jo,vn.a.NoteTitlePlugin,{plugin:tr.a}),xt()(Jo,vn.a.InputCompatible,{plugin:ir.a}),xt()(Jo,vn.a.HighlightColor,{plugin:wo.a,getParams:function(e){return[{editor:e.editor,adaptor:new co.a}]}}),xt()(Jo,vn.a.InlineCode,{plugin:sr.b}),xt()(Jo,vn.a.DriveUpload,{plugin:mr.a,getParams:function(e){return[{editor:e.editor,eventEmitter:ye.a}]}}),xt()(Jo,vn.a.ReminderLine,{plugin:xr.a,getParams:function(e){return[{editor:e.editor,eventEmitter:ye.a}]}}),xt()(Jo,vn.a.SingleLineManage,{plugin:rr.a}),xt()(Jo,vn.a.SectionNavPlugin,{plugin:nr.a}),xt()(Jo,vn.a.Rangecode,{plugin:or.a}),xt()(Jo,vn.a.TemplateInline,{plugin:lr.a}),xt()(Jo,vn.a.TemplateBlock,{plugin:ur.a}),xt()(Jo,vn.a.PlaceHolder,{plugin:dr.a}),xt()(Jo,vn.a.TemplateWrap,{plugin:hr.a}),xt()(Jo,vn.a.TemplateAbstract,{plugin:fr.a}),xt()(Jo,vn.a.OfflineEditor,{plugin:ar.a}),xt()(Jo,vn.a.CheckAll,{plugin:pr.a}),xt()(Jo,vn.a.EditorCopyStyle,{plugin:gr.a}),xt()(Jo,vn.a.Link2Mention,{plugin:br.a}),xt()(Jo,vn.a.LinkToBlock,{plugin:Bo.default,getParams:function(e){var t=e.editor;return[{editor:t,linkToBlockAdaptor:new Bo.LinkToBlockAdaptor({editor:t,linkConfigMap:Bo.linkConfigMap})}]}}),xt()(Jo,vn.a.TripleClick,{plugin:Br.a}),xt()(Jo,vn.a.FsController,{plugin:Cr.a.plugin}),xt()(Jo,vn.a.DocsRenderTime,{plugin:Ir.a}),xt()(Jo,vn.a.UnsupportFeature,{plugin:No.a}),xt()(Jo,vn.a.InserDomLineBetweenPicture,{plugin:yr.a}),xt()(Jo,vn.a.UserChangeTea,{plugin:Mr.a}),xt()(Jo,vn.a.BackBtn,{plugin:Ar.a,getParams:function(e){return[{editor:e.editor,eventEmitter:ye.a}]}}),xt()(Jo,vn.a.LimitEditModeQuantityPlugin,{plugin:Lr.a}),xt()(Jo,vn.a.MemoryMonitor,{plugin:Rr.a}),xt()(Jo,vn.a.SuspensionComment,{plugin:Nr.a,getParams:function(e){return[{editor:e.editor}]}}),xt()(Jo,vn.a.FindReplacePlugin,{plugin:Dr.a}),xt()(Jo,vn.a.ReminderPlugin,{plugin:jo.a,getParams:function(e){return[{editor:e.editor,eventEmitter:ye.a}]}}),xt()(Jo,vn.a.FileCardSwitchView,{plugin:Pr.a}),xt()(Jo,vn.a.Translate,{plugin:_o.a,getParams:function(e){return[e.editor,ye.a]}}),xt()(Jo,vn.a.Placeholder,{plugin:qr}),xt()(Jo,vn.a.ImageRelayPlugin,{plugin:Jr.a}),xt()(Jo,vn.a.BlockRenderStatistics,{plugin:Sr.a}),xt()(Jo,vn.a.BlockRenderAutoRender,{plugin:Tr.a}),xt()(Jo,vn.a.ScrollPosition,{plugin:_r.a}),xt()(Jo,vn.a.AutoCapitalization,{plugin:Xr.a}),xt()(Jo,vn.a.AutoSpace,{plugin:$r.a}),xt()(Jo,vn.a.DocDraggable,{plugin:to.a}),xt()(Jo,vn.a.LoadableInlineDraggable,{plugin:no.a}),xt()(Jo,vn.a.LineMenuOperate,{plugin:ro.a}),xt()(Jo,vn.a.LineMenuPollInsert,{plugin:oo.a}),xt()(Jo,vn.a.LineHover,{plugin:io.a}),xt()(Jo,vn.a.GrammarChecker,{plugin:kt.d}),xt()(Jo,vn.a.SmartCompose,{plugin:bn.b}),xt()(Jo,vn.a.UserChangeDetector,{plugin:ao.a}),xt()(Jo,vn.a.ModalSelectAll,{plugin:eo.a}),xt()(Jo,vn.a.DocLockerPlugin,{plugin:so.a}),xt()(Jo,vn.a.DocTimingHooksPlugin,{plugin:lo.a}),xt()(Jo,vn.a.LineGuidMonitor,{plugin:uo.a}),xt()(Jo,vn.a.LastEmptyLinePlaceholder,{plugin:Er.a}),xt()(Jo,vn.a.PCDiagram,{plugin:ho.a}),xt()(Jo,vn.a.Image,{plugin:Ro.b,getParams:function(e){var t=e.editor,n=e.galleryComment;return[{editor:t,moduleMap:Object.assign({},Object(Ro.a)(),{galleryComment:n}),eventEmitter:ye.a,newGalleryEnable:Object(Ne.Q)()}]}}),xt()(Jo,vn.a.JumpContent,{plugin:So}),xt()(Jo,vn.a.CodeBlockV2,{plugin:xo.a}),xt()(Jo,vn.a.CodeBlockLineNum,{plugin:Po.a}),xt()(Jo,vn.a.Callout,{plugin:Ho.a,getParams:function(e){var t=e.editor;return[t,new Fo.a(t)]}}),xt()(Jo,vn.a.PlainTextHandler,{plugin:Ao}),xt()(Jo,vn.a.SmartLink,{plugin:Wo}),xt()(Jo,vn.a.AsyncDomLoadingManager,{plugin:Vo}),xt()(Jo,vn.a.UploadImgOrVideo,{plugin:Qo,dependencies:{imagePlugin:vn.a.Image},getParams:function(e){return[e.editor,[e.mention,e.imagePlugin]]}}),Jo),$o=c("bwyh"),ea=c("kPRI"),ta=c("1CG5");function na(u,e){var t=Object(mn.a)().plugins,n=void 0===t?[]:t,i=n.includes(vn.a.Image)||n.includes(vn.a.CommentPlugin)?new $o.a({editor:u}):void 0,d={editor:u,mention:e,galleryComment:i},h=Object.create(null),r=function r(e){if(e&&Xo[e]){var o=Object.create(null),t=Xo[e],n=t.plugin,i=t.getParams,a=t.dependencies,s=t.execAfterGenerate;a&&Object.entries(a).forEach(function(e){var t=te()(e,2),n=t[0],i=t[1];return o[n]=h[i]||r(i)});var c=i?i(Object.assign({},d,{},o)):[u],l="object"===de()(n)?n:n.constructor?Lt()(n,Nt()(c)):n.apply(void 0,Nt()(c));return h[e]=l,s&&s(l,Object.assign({},d,{},o)),l}};return n.map(function(e){return h[e]||r(e)}).filter(function(e){return e})}Object(ta.a)(),Object(ea.a)(),Object(yn.a)();var ia=c("AW8B"),ra=c("D+Jz"),oa=c("MkHE"),aa=c("dDhe"),sa=c("U6jp");function ca(){return Ce.a.isOpendoc||Ce.a.isInVC||Object(ht.a)()||Object(aa.c)()||Object(sn.b)()||Ce.a.isLark&&!Object(sa.p)()&&!Object(sa.q)()||Object(we.locateRoute)().isWikiIndex}function la(){return!ca()}var ua,da,ha,fa,pa,ga=c("kS6I"),ma=V()({loader:function(){return c.e("translate_doc").then(c.bind(null,"q51M"))},loading:function(){return mt.a}}),va=V()({loader:function(){return Promise.all([c.e("doc_index_css"),c.e("commons--box_right_bar--global-like--sheet_doc_components"),c.e("global-like")]).then(c.bind(null,"p7J5"))},loading:function(){return null}}),ba=V()({loader:function(){return Promise.all([c.e("doc_index_css"),c.e(9),c.e("vendors--global-comment"),c.e("global-comment")]).then(c.bind(null,"RNF+"))},loading:function(){return null}}),ya=V()({loader:function(){return c.e("suspension-comment").then(c.bind(null,"+69G"))},loading:function(){return null}}),Ea=V()({loader:function(){return Promise.resolve().then(c.bind(null,"fUG1"))},loading:function(){return null}}),Oa=V()({loader:function(){return Promise.all([c.e(3),c.e("commons--line-popover--selection-popup"),c.e("selection-popup")]).then(c.bind(null,"p0V6"))},loading:function(){return null}}),Ca=V()({loader:function(){return c.e("block-editorbar").then(c.bind(null,"jpF+"))},loading:function(){return null}}),ka=V()({loader:function(){return c.e("doc-template").then(c.bind(null,"50iY"))},loading:function(){return null}}),Ia=V()({loader:function(){return Promise.all([c.e("doc_index_css"),c.e("commons--PCDocSheetBridge--bear-bitable-external--bear-external--bear-sheet-external--btn_groups--d--dba25785"),c.e(1),c.e("commons--add_to_modal--clone_modal--create-by-template--create_by_template_smartable--move_modal--s--98118f8b"),c.e("commons--add_to_modal--advanced-search-modal--clone_modal--move_modal--search-modal--search_note--w--d70aa5ef"),c.e("wiki_relation")]).then(c.bind(null,"JKZl"))},loading:function(){return null}}),Sa=V()({loader:function(){return c.e("DocTitleDiyIcon").then(c.bind(null,"l0la"))},loading:function(){return null}}),Ta=V()({loader:function(){return c.e("FeatureTutorialModal").then(c.bind(null,"NoEH"))},loading:function(){return null}}),_a=V()({loader:function(){return c.e("opendoc-footer").then(c.bind(null,"Ngzs"))},loading:function(){return null}}),wa=V()({loader:function(){return c.e("bidirectional-link-list").then(c.bind(null,"dXsP"))},loading:function(){return null}}),ja=V()({loader:function(){return c.e("DocViewEditorsIcon").then(c.bind(null,"rQIk"))},loading:function(){return null}}),Ma=Object(R.default)(window,"User.isPDF"),Aa=Object(ft.a)("Component-Etherpad","suiteInjectProps is missing, please ensure this meet the expectation"),La=(ua=Object(gt.Debounce)(50),pa=fa=function(e){function t(){var s;return y()(this,t),(s=k()(this,S()(t).call(this))).getAuthorityCopyable=function(){return Object(ga.f)(ga.b.FILE_COPY)},s.getCopyable=function(){return s.props.copyable&&s.getAuthorityCopyable()},v()(s,"checkDocHasText",ha,_()(s)),s.initSync=function(){var e=s.props,t=e.setCurrentMemberId,n=e.noteToken;t(s.Sync.memberId),s.switch(n)},s.destroySync=function(){s.Sync&&(s.Sync.destroy(),s.Sync=null)},s.resetSync=function(e){s.destroySync(),s.Sync=lt.create({token:e,getClientVarsRequestExtraParams:Object(R.default)(s.props.wikiContainerInjectedProps,"getClientVarsRequestExtraParams")})},s.switch=function(e,t){var n=Date.now();ut.b.renderDocAppStart(),ut.b.renderDocFetchClientvarStart(n),window.requestAnimationFrame(function(){ut.b.renderDocAppEnd(Date.now())});var i=s.props,o=i.onClientVarsReady,a=i.onClientVarsError,r=i.updateBusinessStage;t&&(s.resetSync(e),s.props.setCurrentMemberId(s.Sync.memberId)),s.setState({fetching:!0}),s.Sync.connectDoc().then(function(e){var t=e.data;if(!t)return Promise.reject(new Error("No data is fetched"));var n=t.code,i=t.permission_status_code;if(n)return s.setState({fetching:!1}),a&&a({code:n,permission_status_code:i}),Promise.reject(new Error("On etherpad load clientVars Error. code: ".concat(n)));var r=Date.now();return dt.c.updateStage(ut.a.FETCH_DOC_CLIENTVARS_SUCCESS,U.FILE_TYPE.DOC),ut.b.renderDocFetchClientvarEnd(r),ut.b.renderDocEtherpadStart(r),void Object(B.unstable_batchedUpdates)(function(){o({permissions:t.permissions}),s.Sync&&s.Sync.handleMessage(e),s.setState({fetching:!1})})}).catch(function(e){dt.c.renderFail(dt.a.FETCH_CLIENTVAR_ERROR),"function"==typeof ut.b.rendderDocAllFail&&ut.b.rendderDocAllFail(),r(K.b.Doc,K.c.Done),console.error(e),s.setState({fetching:!1})})},s.onMouseDown=function(e){var t=e.target;e.button===U.MOUSE_BUTTON.MIDDLE&&"A"===t.nodeName.toUpperCase()&&-1!==t.href.indexOf("http")&&window.open(t.href)},s.registPlugins=function(e,t){var n=la()&&{controller:new oa.a(ye.a)},i=new X.default(Object.assign({editor:e},e,{type:"doc",showable:!0,postAddMentionId:!0,hoverArea:"#innerdocbody",showChatCards:!0,source:H.z.DOC,container:".doc-position"},n));return[i].concat(na(e,i))},s.state={editor:null},ye.a.on(pt.b,s.checkDocHasText),s.transCommentEnable=Object(ia.e)(),s}return j()(t,e),O()(t,[{key:"componentDidMount",value:function(){dt.c.updateStageByNextRender(ut.a.RENDER_DOC_ETHERPAD_SUCCESS,U.FILE_TYPE.DOC);var e=this.props,t=e.noteToken,n=e.opendocCommentConfig,i=e.updateBusinessStage,r=e.wikiContainerInjectedProps;this.Sync=lt.create({token:t,getClientVarsRequestExtraParams:Object(R.default)(r,"getClientVarsRequestExtraParams")}),this.initSync(),Ce.a.isOpendoc&&n&&!n.partial.enable&&i(K.b.Doc,K.c.CommentRendered)}},{key:"shouldComponentUpdate",value:function(e){return e.noteType===this.props.noteType}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.noteToken,i=t.noteType,r=t.enterTransMode,o=t.translateExiting,a=e.noteType===i;r&&!e.enterTransMode&&this.destroySync(),(o&&!e.translateExiting||!r&&e.enterTransMode)&&(this.Sync||(this.resetSync(n),this.initSync())),e.noteToken!==n&&this.Sync&&(Ma&&Mt.default.reset(),a&&(dt.c.updateStageByNextRender(ut.a.RENDER_DOC_ETHERPAD_SUCCESS,U.FILE_TYPE.DOC),this.switch(n,!0)))}},{key:"componentWillUnmount",value:function(){this.props.resetClientVars(),this.destroySync(),this.outerdoc=null,ye.a.off(pt.b,this.checkDocHasText)}},{key:"render",value:function(){var t=this,e=this.props,n=e.noteToken,i=e.canEdit,r=e.haveCommentPermission,o=e.clientVars,a=e.currentUser,s=e.editor,c=e.sharedDocGuideOn,l=e.enterTransMode,u=e.noteType,d=e.wikiRelationEnabled,h=e.isWiki,f=e.isBodyBlank,p=e.isTemplateVisible,g=e.opendocCommentConfig,m=e.opendocLikeConfig,v=e.translating,b=e.outerContainerConfig,y=this.state.fetching;if(!n)return null;var E=i,O=this.getCopyable(),C=Object(ft.g)(),k=s&&s.getDocId()===C,I=k&&this.outerdoc&&r&&!(Ce.a.isOpendoc&&g&&!g.partial.enable),S=o&&o.token===C&&!y&&Boolean(this.Sync),T=k,_=s;l&&!v&&(T=T&&this.transCommentEnable,I=I&&this.transCommentEnable);var w=f,j=!l&&k&&E&&!U.isAnonymousAccess&&!Object(ra.b)(),M=j&&w&&p,L=k&&!M&&!(Ce.a.isOpendoc&&g&&!g.global.enable),R=k&&!Object(ht.a)()&&!M&&!(Ce.a.isOpendoc&&m&&!m.enable)&&String(a.get("user_type"))!==U.USER_TYPE.APPUSER,N=S&&!l&&!M&&la();return P.a.createElement("div",{className:"etherpad-container flex layout-row",ref:function(e){return t.outerdoc=e}},P.a.createElement("div",{className:"etherpad-client-container flex layout-column"},P.a.createElement("div",{id:z.a,className:"flex layout-column",contentEditable:!1},P.a.createElement("div",{id:"doc-container"},P.a.createElement("div",{id:"outerdocbody",className:"outerdocbody"},P.a.createElement("div",{id:"innerdocbodyWrap"},l?P.a.createElement(W.a,{business:K.b.Doc,renderWhen:K.c.Done,renderOnTimeout:!0},P.a.createElement(ma,{editor:s,noteToken:n,noteType:u,fetching:y,copyable:O})):S&&P.a.createElement(Q,{key:o.token,noteToken:o.token,clientVars:o,id:"innerdocbody",Sync:this.Sync,className:"innerdocbody maindocbody syntax notranslate",role:"application",spellCheck:Object(kt.c)(),editable:E,copyable:O,renderConfig:Object(ht.a)()?void 0:U.USE_BLOCK_RENDER,hasCollapse:!0,autoCorrect:"false",registPlugins:this.registPlugins,onMouseDown:E?this.onMouseDown:null}),!Ce.a.isLark&&!Ce.a.isOpendoc&&d&&!h&&P.a.createElement(W.a,{business:K.b.Doc,renderWhen:K.c.EditorMount,renderOnTimeout:!0},P.a.createElement(Ia,null))),P.a.createElement(W.a,{business:K.b.Doc,renderWhen:K.c.Done,renderOnTimeout:!0},T&&P.a.createElement(Oa,{editor:s,ifhaveEditPermission:i&&!l,haveCommentPermission:r,innerdoc:s.getDocBody(),outerdoc:s.getOuterContainer(),sharedDocGuideOn:c}),T&&P.a.createElement("div",{className:jt.a}),T&&P.a.createElement(Tt,{useContainerBoundary:b&&b.useContainerBoundary,isUseScrollContainer:b&&b.isUseScrollContainer,getOuterPopoverContainer:b&&b.getPopoverContainer,editor:s,ifhaveEditPermission:i&&!l}),_&&P.a.createElement(Ca,{ifhaveEditPermission:i&&!l,editor:s}),s&&!Ce.a.isOpendoc&&s&&Object(Ne.n)()&&!Object(It.x)()&&P.a.createElement(Sa,{editor:s,editable:E}),s&&Object(qn.f)()&&P.a.createElement(ja,{editable:E})),f&&s&&E&&P.a.createElement(Ct,{editor:s}))),P.a.createElement(W.a,{business:K.b.Doc,renderWhen:K.c.Done,renderOnTimeout:!0},N&&P.a.createElement(wa,null),R&&!U.isAnonymousAccess&&P.a.createElement(va,null),L&&P.a.createElement(ba,{editor:s}),S&&Ce.a.isOpendoc&&P.a.createElement(_a,null))),j&&P.a.createElement(W.a,{business:K.b.Doc,renderWhen:K.c.Done,renderOnTimeout:!0},P.a.createElement(ka,{editor:s,visible:w})),Object(Ne.K)("jira_onboarding_enable")&&f&&P.a.createElement(Ta,null)),S&&P.a.createElement("div",{className:"doc-popup-container"}),P.a.createElement(W.a,{business:K.b.Doc,renderWhen:K.c.Done,renderOnTimeout:!0},I&&P.a.createElement(ya,{editor:s,enterTransMode:l,isUseScrollContainer:b&&b.isUseScrollContainer}),k&&P.a.createElement(Ea,{editor:s})))}}]),t}(x.Component),fa.displayName="Etherpad",fa.defaultProps={ready:Object(ht.a)(),onClientVarsReady:Aa,onClientVarsError:Aa,shouldHandOutError:Aa},fa.contextTypes={openSideBar:D.a.func},da=pa,ha=L()(da.prototype,"checkDocHasText",[ua],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var t=this;return function(e){t.state.docHasText!==e&&t.setState({docHasText:e})}}}),da),Ra=c("jzcD"),Na=c("t2s0"),Da={resetClientVars:a.b,fetchRecentObjs:r.fetchRecentObjs,fetchComments:s.b,updateDocTitle:i.u,syncNoteMeta:i.s,setCurrentMemberId:l.d,updateBusinessStage:q.c},xa=function(e,t){var n=Object(f.u)(e),i=Object(Ra.b)(e),r=i.status.translated;return{noteType:Object(u.o)(e),noteToken:Object(u.n)(e),clientVars:Object(h.a)(e),currentSuitePermission:Object(f.j)(e),currentUser:Object(d.a)(e),canEdit:Object(f.e)(e),haveCommentPermission:Object(f.b)(e),copyable:n&&n.copyable,editor:Object(h.c)(e),enterTransMode:r,translating:i.status.translating,translateExiting:i.status.translate_exiting,wikiRelationEnabled:Na.i&&!r,isWiki:Object(o.createSelector)(u.q,function(e){return e===U.NUM_SUITE_TYPE.WIKI})(e),isBodyBlank:Object(h.d)(e),isTemplateVisible:Object(vt.c)(e),opendocCommentConfig:Object(p.a)(g.a.COMMENT)(e),opendocLikeConfig:Object(p.a)(g.a.LIKE)(e)}},Pa=Object(n.connect)(xa,Da)(La);t.default=Pa},lzTj:function(e,et,tt){"use strict";(function(C){var e,t,n,i,r,o,a,s,c,l,u,d,h,f=tt("RIqP"),k=tt.n(f),p=tt("lSNA"),w=tt.n(p),g=tt("J4zp"),I=tt.n(g),m=tt("o0o1"),z=tt.n(m),v=tt("yXPU"),S=tt.n(v),b=tt("lwsE"),T=tt.n(b),y=tt("W8MJ"),_=tt.n(y),E=tt("a1gu"),j=tt.n(E),O=tt("Nsbk"),M=tt.n(O),L=tt("PJYZ"),R=tt.n(L),N=tt("7W2i"),D=tt.n(N),x=tt("U+yc"),P=tt.n(x),B=tt("m8R6"),U=tt("Muja"),H=tt("oTSI"),F=tt("7EGn"),V=tt("xpYl"),W=tt("hMnB"),K=tt.n(W),Z=tt("q1tI"),q=tt.n(Z),Y=tt("i8i4"),J=tt.n(Y),Q=(tt("17x9"),tt("TSYQ")),X=tt.n(Q),$=tt("QM+C"),ee=tt("521f"),te=tt("s1mk"),ne=tt("uQON"),ie=tt("hNoK"),re=tt("Kwn6"),oe=tt("xi4d"),ae=tt("2z0X"),se=(tt("+l4x"),tt("H6Gw")),ce=tt("SebV"),le=tt("CO9V"),ue=tt("x/Yo"),de=tt("BScZ"),he=tt("Najy"),fe=tt("zhgJ"),pe=tt("OX8E"),ge=tt("iP/4"),me=tt("OJOY"),ve=tt("kVAj"),be=tt("ubJt"),ye=tt("4PSP"),Ee=tt("yJ+g"),Oe=tt("n/R6"),Ce=tt("PIny"),ke=tt("Ux/T"),Ie=tt("VI8A"),Se=tt("7ESD"),Te=tt("sFgt"),_e=tt("HmyT"),we=tt("aXiW"),je=tt("SyrE"),Me=tt("Trbk"),Ae=tt("UlbS"),Le=tt("ABxt"),Re=tt("jbvk"),Ne=tt("2spZ"),De=tt("R/2b"),xe=tt("SCx9"),Pe=tt("2ACu"),Be=tt("rLED"),Ue=tt("MO5G"),ze=tt("9ajS"),He=tt("2BcA"),Fe=tt("UAY2"),Ve=Object(Be.e)("comment_panel_perf"),We=30,Ke=function(){return Promise.all([tt.e("doc_index_css"),tt.e(50)]).then(tt.bind(null,"PJ+2"))},Ge=Object(fe.e)().open,Ze=de.c,qe="DocComment",Ye="doc-comment__toggle-container",Je={START_NEW_COMMENT:"start_new_comment",DOC:"doc",SWITCH_COMMENT_BY_CLICK:"switchCommentByClick",NULL:"",GO_FIRST_COMMENT:"goFirstComment",ITEM_EDIT:"itemEdit",ITEM_EDIT_TEXTAREA_CLICK:"itemEditTextareaClick",REACTION_CLICK:"reaction_click"},Qe=function(){return"comment-id-".concat(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")},Xe=function(e){return"comment-resolved-".concat(e)},$e=(e=Object(ye.Bind)(),t=Object(ye.Bind)(),n=Object(ye.Bind)(),i=Object(ye.Bind)(),r=Object(ye.Bind)(),o=Object(ye.Bind)(),a=Object(ye.Bind)(),s=Object(ye.Bind)(),c=Object(ye.Bind)(),l=Object(ye.Bind)(),h=d=function(e){function n(e){var _;T()(this,n),(_=j()(this,M()(n).call(this,e))).replayFollowActionHandler=function(){var n=S()(z.a.mark(function e(t,n){var i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.actionType,r=t.data,o=n.muteModulesPlay,"CommentActive"!==i)return e.abrupt("return");e.next=4;break;case 4:if((a=r.commentId)&&o(1e3,["DocPosition"]),_.logger.logVcFollowCommentData({commentId:a}),a){e.next=9;break}return e.abrupt("return",_.setState({activeCommentId:null}));case 9:if(s=_.props.shown,!Object(Be.j)()||!1!==s){e.next=15;break}if(e.t0=_.animationRef,e.t0)return e.next=15,_.animationRef.handleToggleOpen();e.next=15;break;case 15:if(!(1<a.split(":").length)){e.next=29;break}if(c=_.valueOf(a),l=c.commentId,(u=_.findCommentById(a))||_.logger.logVcFollowNoCommentData(),u&&!u.visible)return e.next=22,_.waitCommentRendered(a);e.next=22;break;case 22:(d=document.querySelector(".comment-panel.comment-id-".concat(l)))||_.logger.logVcFollowNoCommentPanel(),h=d?Je.SWITCH_COMMENT_BY_CLICK:Je.NULL,_.vcActiveCommentId=a,_.handlePanelActiveChange({commentId:a},h,_.animationRef&&_.animationRef.childRefs[a]),e.next=44;break;case 29:if(f=K.a.pathname.split("/"),p=f[f.length-1],g=_.props.commentPositions.find(function(e){return-1<a.indexOf(e.commentId)}),m="DOC:".concat(p,":").concat(a),g&&(v=g.serviceType,b=g.serviceToken,m="".concat(v,":").concat(b,":").concat(a)),(y=_.findCommentById(m))||_.logger.logVcFollowNoCommentData(),y&&!y.visible)return e.next=39,_.waitCommentRendered(m);e.next=39;break;case 39:(E=document.querySelector(".comment-panel.comment-id-".concat(a)))||_.logger.logVcFollowNoCommentPanel(),O=E?Je.SWITCH_COMMENT_BY_CLICK:Je.NULL,_.vcActiveCommentId=m,_.handlePanelActiveChange({commentId:m},O,_.animationRef&&_.animationRef.childRefs[m]);case 44:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),_.animationRef=null,_.getAnimationRef=function(e){_.animationRef=e},_.getCurrentAnimationRef=function(){return _.animationRef},_.handleTranslateError=function(){Oe.a.remove("translate_error"),Oe.a.error({duration:3e3,closable:!0,content:C("common.translated_fail"),key:"translate_error"})},_.getUnSaveTip=function(){return C("comment.leave_page_warning_message")},_.getLocalStoreShownKey=function(){return"docCommentShown"},_.handlePanelChanged=function(){var t=S()(z.a.mark(function e(t){var n,i,r,o,a;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=_.animationRef,e.t0)return e.next=4,_.animationRef.waitUntilPanelChanged();e.next=4;break;case 4:n=_.props.editor.plugins.comment,i=_.valueOf(t),r=i.serviceType,o=i.serviceToken,a=i.commentId,n.fixHorizontalScroll(r,o,a);case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),_.getStoreShown=function(){if(me.b){var e=_.getLocalStoreShownKey();return me.a.getItem(e)}return null},_.setStoreShown=function(e){if(me.b&&!ge.a.isInVC&&!ge.a.isFeishuRooms){var t=_.getLocalStoreShownKey();try{me.a.setItem(t,e)}catch(e){console.warn(e)}}},_.valueOf=function(e){var t=e.split(":"),n=I()(t,3);return{serviceType:n[0],serviceToken:n[1],commentId:n[2]}},_.keyOf=function(e,t,n){return"".concat(e,":").concat(t,":").concat(n)},_.handleGetCommentId=function(e){var t=_.props,n=t.objectType,i=t.noteToken,r=Object(ke.a)(e,n,i),o=r.serviceType,a=r.serviceToken;return _.keyOf(o,a,e.commentId)},_.listProps={busNameSpace:"docComment",onRetry:_.handleRetry,onDelete:_.handleDelete,onEdit:_.handleEdit,onTranslate:_.handleTranslate,onResolve:_.handleResolve,addReaction:_.handleAddReaction,removeReaction:_.handleRemoveReaction,onClickReactionDetail:_.handleReactionDetailClick,onShowReactionPanel:_.handleShowReactionPanel,more:!0,getToolTipContainer:_.getScrollContainer},_.makeTextareaPropsWithCommentId=Object(H.a)(function(e){return{mentionContainer:".doc-position",onFocus:_.makeEventWithCommentId(_.handlePanelFocus,e),onConfirm:_.makeEventWithCommentId(_.handleConfirm,e),onCancel:_.makeEventWithCommentId(_.handleCancel,e),onEscCancel:_.makeEventWithCommentId(_.handleCancel,e),editorDidUpdate:_.makeEventWithCommentId(_.handleEditorContentChange,e),source:1}}),_.makeUpdateTextareaPropsWithCommentId=Object(H.a)(function(e){return Object.assign({},_.makeTextareaPropsWithCommentId(e),{onConfirm:Object(V.a)(_.handleUpdateConfirm,e)})}),_.makeEventWithCommentId=function(e,t){var n=_.cachedEvents.get(t);if(n){var i=n.get(e);if(i)return i}else n=new Map,_.cachedEvents.set(t,n);var r=Object(V.a)(e,t);return n.set(e,r),r},_.clearCachedProps=function(){_.makeTextareaPropsWithCommentId.cache.clear(),_.makeUpdateTextareaPropsWithCommentId.cache.clear(),_.cachedEvents.clear(),_.makeTextareaPropsWithCommentId=null,_.makeUpdateTextareaPropsWithCommentId=null},_.handleCommentLoadindStatus=function(e){_.debounceSetCommentLoadStatus.apply(R()(_),e.map(function(e){return Object.assign({},e,{isLoading:!0})}))},_.handleCommentLoadedStatus=function(e){_.debounceSetCommentLoadStatus.apply(R()(_),e.map(function(e){return Object.assign({},e,{isLoading:!1})}))},_.debounceSetCommentLoadStatus=Object(ae.a)(function(e){_.props.setCommentLoadStatus(e)},200),_.handleReopenDocComment=function(){var t=S()(z.a.mark(function e(t){var n,i,r,o;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.commentId,i=t.serviceType,r=t.serviceToken,o=_.props.editor,e.next=4,o.plugins.comment.reopenCommentOnDoc(i,r,n);case 4:_.handleReopenCommentSuccess(i,r,n);case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),_.handleFsToggleComment=function(e){var t=e.newIsCommentOpen,n=_.state.stateShown;t&&!n?_.animationRef&&_.animationRef.handleToggleOpen():!t&&n&&_.handleToggleClose()},_.handleOnCommentChange=function(e,t){var n=e.comments,i=e.entities;_.commentDataActions.mergeComments({comments:n.concat(t.deletedComments),entities:i})},_.handleOnMessageChange=function(e,t){_.messageDataActions.setMessages(e),t&&_.handleRemoveCacheReadReplyIds(t)},_.setFixedBtnVisible=function(e){_.props.setHelpBtnVisible(e),_.rangeCodeController.setVisible(e)},_.handleCommentListCopy=function(e){var t=_.props.otherPermissions;if(t&&!t.copyable)return e.preventDefault(),_.props.copyTextWithoutPermission(),!1},_.genCommentPanel=function(e){var t,n,i,r,o=_.props,a=o.user,s=o.haveCommentPermission,c=o.isTemplateMode,l=o.transEnabled,u=o.translateContentCompare,d=o.commentPositions,h=_.state,f=h.activeCommentId,p=h.resolving,g=e.commentId,m=e.comment_list,v=e.top,b=d.find(function(e){return-1<g.indexOf(e.commentId)}),y=b&&b.quote||e.quote,E=f===g,O=-1!==p.indexOf(g),C=Ge?"doc-comment-new":"doc-comment",k=_.valueOf(g).commentId,I=k?"comment-id-".concat(k):"",S=X()("".concat(C,"__panel-item"),I,(t={},w()(t,"".concat(C,"__panel-item--active"),E),w()(t,"".concat(C,"__panel-item--hidden"),O),t)),T="".concat(C,"__ellipsis-author");return 1===m.length&&(i=(n=m[0]).error,r=n.sending,(i||r)&&(T="")),q.a.createElement(ie.default,{key:_.idMap[g]||g,enableReaction:Object(Be.i)(),commentId:g,quote:y,readOnly:!s&&!c,className:S,ellipsisAuthorClass:T,userName:a.name,userAvatarUrl:a.avatar_url,myUserId:a.user_id,top:v,list:m,listProps:_.listProps,expand:E,observer:_.viewPortObserver,textareaProps:_.makeTextareaPropsWithCommentId(g),updateTextAreaProps:_.makeUpdateTextareaPropsWithCommentId(g),onPanelMouseEnter:_.makeEventWithCommentId(_.handleMouseEvent,g),onPanelMouseLeave:_.makeEventWithCommentId(_.handleMouseEvent,g),onTransitionEnd:_.makeEventWithCommentId(_.handleTransitionEnd,g),onCommentListCopy:_.handleCommentListCopy,translateContentCompare:u,transEnabled:l,embedObjShareEnable:Object(Be.s)()})},_.getOuterBodyTop=function(){var e=_.props.editor;if(e){var t=e.getOuterContainer();if(t)return t.offsetTop}},_.getScrollContainer=Object(H.a)(function(){var e=_.props.editor;return e&&e.getScrollContainer()}),_.handleVisibilityChange=function(){_.cacheReadIds.length&&Object(ne.l)()&&_.markReadStatus(_.cacheReadIds,function(){_.cacheReadIds=[]})},_.setCacheReadReplyIds=function(e){_.cacheReadReplyIds.add(e)},_.handleRemoveCacheReadReplyIds=function(e){var r,t=e.addedMessages;_.cacheReadReplyIds.size<=0||t.length<=0||(r=[],t.forEach(function(e){var t=e.replyId,n=e.messageId,i=e.status;t&&_.cacheReadReplyIds.has(t)&&(1===i&&r.push(n),_.cacheReadReplyIds.delete(t))}),0<r.length&&_.debounceMarkReadStatus(r))},_.handleTransitionEnd=function(e,t){e===_.state.activeCommentId&&_.activeSource!==Je.START_NEW_COMMENT&&(_.activeSource===Je.DOC||_.activeSource.startsWith("switchCommentBy")||_.activeSource===Je.ITEM_EDIT||_.activeSource===Je.ITEM_EDIT_TEXTAREA_CLICK||t&&t.target.classList.contains("comment-image-item")||_.animationRef.focus(e),_.activeSource=Je.NULL)},_.handleContainerTransitionEnd=S()(z.a.mark(function e(){return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(Be.j)()){e.next=2;break}return e.abrupt("return");case 2:if(_.activeSource===Je.START_NEW_COMMENT)return e.next=5,Object(Ne.c)(0);e.next=7;break;case 5:_.animationRef.focus(_.state.activeCommentId),_.activeSource=Je.NULL;case 7:_.setState({shownTransitionEnd:!0});case 8:case"end":return e.stop()}},e)})),_.hasUnFinishComment=function(){return _.props.commentList.find(function(e){var t=e.commentId,n=_.animationRef.childRefs[t];return!!n&&n.hasUnFinishComment()})},_.findCommentById=function(t){return _.props.commentList.find(function(e){return e.commentId===t})},_.markReadStatus=S()(z.a.mark(function e(){var t,n,i,r,o=arguments;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<o.length&&void 0!==o[0]?o[0]:[],n=1<o.length&&void 0!==o[1]?o[1]:function(){},i=Object(ne.l)(),!t.length){e.next=17;break}if(i)return e.prev=5,e.next=8,_.messageDataActions.markRead({messageIds:t});e.next=16;break;case 8:r=e.sent,n(r),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0);case 15:return e.abrupt("return");case 16:_.cacheReadIds=_.cacheReadIds.concat(t);case 17:case"end":return e.stop()}},e,null,[[5,12]])})),_.handleCommentStartLoading=function(e){e&&_.setState({placeholder:!0},function(){_.props.editor.call("commentFirstLoaded")})},_.handleRenderComments=function(e){e.commentIds;var t=e.allComments,n=e.allMessages,i=(e.source,e.activeTop);if(e.forceUpdate){var r,o=_.props,a=o.objectType,s=o.noteToken,c=o.setCommentPositionData,l=o.setMessagePositionData,u=o.commentPositions,d=o.isCommentPositionsLoaded,h=o.transEnabled;if(Object(U.default)(u,t))return void(d||c({commentPositions:t,rootToken:s,rootType:a}));!h||(r=_.commentDataActions.getCommentTranslate())&&r.addTranslateCommentId(t),c({commentPositions:n,rootToken:s,rootType:a}),l(n)}i!==_.state.activeTop&&_.setState({activeTop:i})},_.handleReset=function(e){_.dataActionsManager.destroy();var t=_.props,n=t.objectType,i=t.noteToken;(0,t.setCommentPositionData)({commentPositions:[],rootToken:i,rootType:n,isLoaded:!1}),_.toggleCommentShown(!!_.getStoreShown()),_.logger.logResetComments({fromEditor:!1!==e}),_.newCommentIdMap={},_.idMap={},_.dirtyTextareaCollector={},_.setState({placeholder:!1})},_.handleOpenPanel=function(){var t=S()(z.a.mark(function e(t){var n;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.resolve,Object(Be.j)()){e.next=3;break}return e.abrupt("return",n());case 3:if(e.t0=_.animationRef,e.t0)return e.next=7,_.animationRef.handleToggleOpen();e.next=7;break;case 7:n();case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),_.handleStartNewComment=function(){var t=S()(z.a.mark(function e(t){var n,i,r,o,a,s,c,l;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.serviceType,i=t.serviceToken,r=t.tempCommentId,o=t.quote,a=t.selection,s=_.props.editor,_.props.enterTransMode&&Ke().then(function(e){(0,e.showTranslateCommentGuideIfNecessary)(a,s)}),Object(Be.j)()&&_.animationRef)return _.activeSource=Je.START_NEW_COMMENT,e.next=7,_.animationRef.handleToggleOpen();e.next=10;break;case 7:_.animationRef.handleClearTransform(),e.next=11;break;case 10:_.activeSource=Je.NULL;case 11:c=_.keyOf(n,i,r),l=R()(_),l.commentDataActions.startNewComment({commentId:r,quote:o,isWhole:0}),_.setState({activeCommentId:c},S()(z.a.mark(function e(){return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ge&&(_.props.shown||_.logger.logClickShowCommentPanel({source:"new_comment"}),_.props.toggleDocComment(!0),_.animationRef&&_.animationRef.handleCommentScroll(c)),!Object(Be.j)()||!_.animationRef){e.next=12;break}if(!_.state.stateShown){e.next=10;break}if(_.state.shownTransitionEnd){e.next=6;break}return e.next=6,Object(Ne.c)(300);case 6:return _.animationRef.focus(c),_.activeSource=Je.NULL,e.next=10,_.animationRef.waitUntilPanelChanged();case 10:e.next=13;break;case 12:_.animationRef.focus(c);case 13:case"end":return e.stop()}},e)})));case 15:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),_.handleClickCommentOnDoc=function(e){var t=e.serviceType,n=e.serviceToken,i=e.commentId,r=e.activeTop,o=_.keyOf(t,n,i),a=_.state.activeCommentId;o===a&&_.state.activeTop===r||(Object(we.a)("client_comment_panel").push({source:"content"}),_.setState({activeCommentId:o,activeTop:r},function(){_.handleNewCommentScroll(o)}),_.activeSource=Je.DOC,Ge||_.animationRef&&_.animationRef.handleClearTransform(),_.logger.logClickCommentPop())},_.handleClickSameCommentOnPopup=function(e){var t=e.serviceType,n=e.serviceToken,i=e.commentId,r=_.state.activeCommentId,o=_.keyOf(t,n,i);r?(_.handleNewCommentScroll(o),_.animationRef.focus(o)):_.setState({activeCommentId:o},function(){_.handleNewCommentScroll(o),_.animationRef.focus(o)})},_.handleClearActiveComment=function(){_.state.activeCommentId&&(Object(Be.j)()&&_.activeSource===Je.START_NEW_COMMENT||_.setState({activeCommentId:null,activeTop:null}))},_.handleClearResolving=function(e){var t=_.state.resolving,n=Array.from(t),i=t.indexOf(e);-1!==i&&(n.splice(i,1),_.setState({resolving:n}))},_.handleHideResolvingEle=function(t){_.setState(function(e){return{resolving:[].concat(k()(e.resolving),[t])}})},_.handleReactionChange=function(e){_.props.setCommentReaction(e.reactions),_.props.setCommentReactionEntities(e)},_.handleMouseEvent=function(e,t){var n=_.valueOf(e),i=n.serviceType,r=n.serviceToken,o=n.commentId,a=_.props.editor.plugins.comment;"mouseenter"===t.type&&a.addHoverHighlight(i,r,o),"mouseleave"===t.type&&a.removeHoverHighlight(i,r,o)},_.handleEditorContentChange=function(e,t){_.dirtyTextareaCollector[e]=t},_.handleReopenCommentSuccess=function(e,t,n){var i=_.keyOf(e,t,n);_.setState({activeCommentId:i},function(){_.props.editor.plugins.comment.activateComment(e,t,n)})},_.deleteNewCommentIfNecessary=function(e,t){var n,i,r,o,a,s,c;Object(ne.k)(e)&&(n=e.commentId,i=_.animationRef&&_.animationRef.childRefs[n],r=_.props.editor.plugins.comment,(i&&!i.hasText()||t||!_.animationRef)&&(a=(o=_.valueOf(n)).serviceType,s=o.serviceToken,c=o.commentId,r.deleteCommentOnDoc(a,s,c)))},_.handlePanelActiveChange=function(){var r=S()(z.a.mark(function e(r,o,a,t){var n,s,i,c,l,u,d,h,f,p,g,m;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=_.state.activeCommentId,s=Boolean(o),i=_.props.editor.plugins.comment,s){e.next=12;break}if(_.props.editor){e.next=6;break}return e.abrupt("return");case 6:if(c=_.props.editor.getOuterContainer(),!t||!c.contains(t)){e.next=12;break}if(l=_.valueOf(n),u=l.serviceType,d=l.serviceToken,h=l.commentId,i.shouldDeactivate(u,d,h)){e.next=12;break}return e.abrupt("return");case 12:if(o!==Je.REACTION_CLICK||_.props.shown||(_.toggleCommentShown(!0),_.toggleCommentStateShown(!0)),_.activeSource=o,s)return f=_.valueOf(r.commentId),p=f.serviceType,g=f.serviceToken,m=f.commentId,i.deactivateComment(),e.next=19,i.activateComment(p,g,m,null,!1);e.next=21;break;case 19:e.next=22;break;case 21:r&&r.commentId===n&&i.deactivateComment();case 22:_.setState({activeCommentId:s?r.commentId:null,activeTop:null},S()(z.a.mark(function e(){var t,n,i;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=a&&a.getCurPanelNode())||!s){e.next=15;break}if(n=-1<[Je.ITEM_EDIT,Je.ITEM_EDIT_TEXTAREA_CLICK].indexOf(o),Ge||_.animationRef&&_.animationRef.handleClearTransform(),Ge){e.next=13;break}if(i=o.startsWith("switchCommentBy"),e.t0=_.animationRef,e.t0)return e.next=10,_.animationRef.waitUntilPanelChanged();e.next=10;break;case 10:if(r.commentId!==_.state.activeCommentId)return e.abrupt("return");e.next=12;break;case 12:n||_.fixScroll(r,t,{useSwitchCommentStrategy:i});case 13:_.handleTransitionEnd(r.commentId),_.vcActiveCommentId=null;case 15:pe.a.trigger("viewportContentChange");case 16:case"end":return e.stop()}},e)})));case 23:case"end":return e.stop()}},e)}));return function(e,t,n,i){return r.apply(this,arguments)}}(),_.fixVerticalScroll=function(e,t,n){var i=_.getScrollContainer();if(i){var r=_.getOffsetTop(i,_.docCommentRef);e+=r;var o=i.scrollTop,a=i.clientHeight,s=100+r;if(n.useSwitchCommentStrategy||e<o||o+a<e)return i.scrollTop=e-s,void _.logger.logClientCommentPanel({reason:"scroll_top_has_set"});var c,l,u=e+t,d=o+a;d<u&&(l=(c=parseInt(.8*a,10))<t?e+c:u,i.scrollTop+=l+40-d)}else _.logger.logClientCommentPanel({reason:"no_scroll_container"})},_.fixScroll=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=_.props.commentList.find(function(e){return e.commentId===t.commentId});_.fixVerticalScroll(i.top,e.offsetHeight,n)},_.handlePanelFocus=function(e,t){var n=t.target.innerText,i=!n||"\n"===n,r=_.findCommentById(e),o=_.props.editor,a=_.valueOf(e),s=a.serviceType,c=a.serviceToken,l=a.commentId,u=o.plugins.comment.getTeaParams,d=u&&u(s,c,l);i&&(_.logger.logClickCommentInput({isFirst:Object(ne.k)(r),pluginTeaParams:d}),_.logger.logClientCommentInputBox({isFirst:Object(ne.k)(r),pluginTeaParams:d}))},_.handleConfirm=function(){var o=S()(z.a.mark(function e(t,n,i,r,o){var a,s;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=_.findCommentById(t),s=_.valueOf(a.commentId),_.props.enterTransMode||_.props.editor.plugins.comment.invokeCollapse(Object.assign({},s,{source:"insert_comment"})),Object(ne.k)(a))return e.next=6,_.handleAddComment({tempId:t,content:n,imageList:r,replyId:o,stage:he.a,onComplete:i});e.next=7;break;case 6:return e.abrupt("return");case 7:return i(),e.next=10,_.handleAddReply({id:t,content:n,imageList:r,replyId:o,stage:he.a});case 10:case"end":return e.stop()}},e)}));return function(e,t,n,i,r){return o.apply(this,arguments)}}(),_.handleViolatePolicies=function(e){var t,n,i,r,o,a,s,c=e.error,l=e.type,u=e.commentId,d=e.replyId,h=e.oldContent;c&&Object(Ce.d)(c.code)&&(t=R()(_).commentDataActions,n=_.valueOf(u).commentId,!(i=_.findCommentById(u))||(r=i.comment_list.find(function(e){return e.reply_id===d}))&&(o=r.content,a=r.entities,(s=_.animationRef.childRefs[u])&&(s.setPrevContentToTextarea({type:l,replyId:d,content:o,entities:a}),t.deleteTemplateComment({commentId:n,replyId:d,type:l,oldContent:h}),Oe.a.error({duration:3e3,closable:!0,content:C("mobile.comment_verified_failed")}))))},_.linkCommentToDoc=function(){var t=S()(z.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.serviceType,i=t.tempReplyId,r=t.serviceToken,o=t.tempCommentId,a=t.commentId,s=t.replyId,c=t.localStartTime,l=t.notNotifyUsers,_.logger.logDevCommentEvent({commentId:a,replyId:"",stage:"link_comment_to_doc",extra:o}),u=R()(_),d=u.commentDataActions,h=_.keyOf(n,r,o),f=_.keyOf(n,r,a),_.idMap[f]=h,d.linkCommentToDoc({commentId:o,tempReplyId:i,replyId:s}),_.newCommentIdMap[h]={commentId:a,replyId:s,tempReplyId:i,localStartTime:c,notNotifyUsers:l},p=_.props.editor.plugins.comment,e.prev=9,_.props.enterTransMode)return g=ze.a.getInstance(),e.next=14,g.waitForReady();e.next=21;break;case 14:if(m=_.props.editor.plugins.comment.comment,(v=m.findComment(n,r,o))&&v.docPositions.length){e.next=18;break}return e.abrupt("return");case 18:b=v.docPositions[0],y=Qe(a),g.performAttributes(b.selZone,b,[[y,!0]]);case 21:return e.next=23,p.saveCommentOnDoc({serviceType:n,serviceToken:r,commentId:a,tempCommentId:o});case 23:e.next=30;break;case 25:return e.prev=25,e.t0=e.catch(9),_.logger.logDevCommentEvent({commentId:a,replyId:"",stage:"link_comment_to_doc_failed",extra:o}),d.linkCommentToDocError({commentId:o,replyId:s,error:e.t0}),e.abrupt("return");case 30:_.logger.logDevCreateCommentCost({localStartTime:c}),_.logger.logDevCommentEvent({commentId:a,replyId:s,stage:"link_comment_to_doc_success",extra:a}),d.linkCommentToDocOK({commentId:a,tempCommentId:o,replyId:s}),Object(Te.g)(l),E=_.keyOf(n,r,a),_.setState({activeCommentId:E},function(){_.animationRef.focus(E)}),_.newCommentIdMap[o]&&delete _.newCommentIdMap[o];case 37:case"end":return e.stop()}},e,null,[[9,25]])}));return function(e){return t.apply(this,arguments)}}(),_.handleCancel=function(e,t){var n=_.findCommentById(e);Object(ne.k)(n)&&_.deleteNewCommentIfNecessary(n,"click"===t.type),_.state.activeCommentId&&(_.props.editor.plugins.comment.deactivateComment(),_.setState({activeCommentId:null,activeTop:null}))},_.saveDocCommentRef=function(e){_.docCommentRef=e},_.toggleCommentShown=function(e){var t=_.props,n=t.objectType,i=t.noteToken,r=t.toggleCommentShown;_.setStoreShown(e),r({shown:e,rootToken:i,rootType:n})},_.toggleCommentStateShown=function(e){Object(we.a)("client_comment_panel").report({is_empty:_.props.commentPositions&&_.props.commentPositions.length?0:1,action:e?"open":"close"}),_.setState({stateShown:e,shownTransitionEnd:!1,openBtnTransitionEnd:!1})},_.handleToggleClose=function(){_.animationRef&&_.animationRef.handleToggleClose()},_.handleCommentVisible=function(){_.state.commentVisible||_.setState({commentVisible:!0})},_.handleOpenTransitionEnd=function(){_.setState({openBtnTransitionEnd:!0})},_.handleGoFirstComment=S()(z.a.mark(function e(){var t,n,i,r,o,a,s;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=_.props.commentPositions,n=t[0],Object(Pe.default)("client_comment_panel",{action:"jump to 1st comment"}),n){e.next=5;break}return e.abrupt("return");case 5:return i=n.serviceToken,r=n.serviceType,o=n.commentId,a=n.top,(s=_.props.editor.plugins.comment).deactivateComment(),e.next=10,s.activateComment(r,i,o,null,!1);case 10:_.props.editor.call(xe.c.CLICK_COMMENT_ON_DOC,{serviceType:r,serviceToken:i,commentId:o,activeTop:a});case 11:case"end":return e.stop()}},e)}));var t=!Object(Be.j)()||!!_.getStoreShown();return ge.a.isOpendoc&&e.opendocCommentConfig&&(t=e.opendocCommentConfig.partial.open),_.state={activeCommentId:null,activeTop:null,resolving:[],stateShown:t,shownTransitionEnd:!0,openBtnTransitionEnd:!0,commentVisible:!1,loadingVisible:!1},_.logger=new he.c,_.debounceMarkReadStatus=Object(ae.a)(_.markReadStatus,200),_.newCommentIdMap={},_.dirtyTextareaCollector={},_.cacheReadIds=[],_.cacheReadReplyIds=new Set,_.activeSource=Je.NULL,_.idMap={},_.submittingCommentIds={},_.cachedEvents=new Map,_.rangeCodeController=new le.a,_.docCommentRef=null,_.dataActionsManager=new Ee.a(R()(_)),_.afterAnimationFrame=new Ie.a,_.dataToRenderStageCollector=new te.a(R()(_)),_.isUnmounted=!1,_.vcActiveCommentId=null,_.viewPortObserver=null,_.timer=null,_}function t(e,t,n,i,r){return o.apply(this,arguments)}var o,i,r,a,s,c,l,u,d,h;function f(e,t,n){return i.apply(this,arguments)}function p(e,t){return r.apply(this,arguments)}function g(e){return a.apply(this,arguments)}function m(e){return s.apply(this,arguments)}function v(e){return c.apply(this,arguments)}function b(e){return l.apply(this,arguments)}function y(e){return u.apply(this,arguments)}function E(e){return d.apply(this,arguments)}function O(e,t){return h.apply(this,arguments)}return D()(n,e),_()(n,[{key:"componentDidMount",value:function(){var e,t=this,n=this.props,i=n.objectType,r=n.noteToken,o=n.commentList;this.initCommentDataActions(),this.initMessageDataActions(),this.bindPadEvents(),Object(Be.j)()&&(!1===(e=ge.a.isOpendoc?V.a.open:this.getStoreShown())&&(this.props.toggleDocComment(!1),this.toggleCommentStateShown(!1)),setTimeout(function(){return t.toggleCommentShown(e)})),pe.a.on("docComment.clearActiveComment",this.handleClearActiveComment),pe.a.on("docComment.inViewport",this.debounceMarkReadStatus),pe.a.on("docComment.unreadyInViewport",this.setCacheReadReplyIds),pe.a.on("reopenDocComment",this.handleReopenDocComment),pe.a.on("fullscreenToggleComment",this.handleFsToggleComment),je.g.on("".concat(Me.g,":").concat(qe),this.replayFollowActionHandler),document.addEventListener("visibilitychange",this.handleVisibilityChange);var a=this.getOrCreateReactionSDK(this.props);this.fetchReactionData(i,r),a.register($.COMMENT_REACTION_MODULE,this.handleReactionChange);var s=this.getOrCreateReactionSDK(this.props).getReactionData($.COMMENT_REACTION_MODULE);this.props.setCommentReaction(s.reactions),this.props.setCommentReactionEntities(s),this.commentFindProvider?this.commentFindProvider.setCommentList(o):this.loadCommentFindProvider(),this.state.loadingVisible||(this.timer=window.setTimeout(function(){t.state.commentVisible||t.setState({loadingVisible:!0}),t.timer=null},500)),this.sendVCDefaultState(),Object(Pe.default)("bind_vc_event",{module:qe,operation:"on"})}},{key:"componentWillUpdate",value:function(e,t){var n,i;Object(Be.j)()&&(n=this.props.commentList,i=e.commentList,0<n.length&&i.length<=0&&this.setState({placeholder:!1}),0!==n.length||1!==i.length||this.state.commentVisible||this.setState({commentVisible:!0}),0===n.length&&0<i.length&&(!1!==this.getStoreShown()||1===i.length&&i[0].un_submit_comment)&&(this.toggleCommentShown(!0),this.toggleCommentStateShown(!0)))}},{key:"componentDidUpdate",value:function(e,t){var n,i=e.objectType,r=e.noteToken,o=e.commentList,a=e.setCommentReactionLoadStatus,s=e.editor,c=this.props,l=c.objectType,u=c.noteToken,d=c.commentList,h=c.enableTranslate,f=c.targetLang,p=c.editor,g=c.transEnabled;u===r&&(s!==p&&(this.bindPadEvents(),this.getScrollContainer.cache.clear()),g&&this.dataActionsManager.translateOptions$.next({enableAutoTranslate:h,translateLang:f}),o!==d&&(o.length||d.length)&&(pe.a.trigger("viewportContentChange"),this.commentFindProvider&&this.commentFindProvider.setCommentList(d),this.vcActiveCommentId&&this.handlePanelActiveChange({commentId:this.vcActiveCommentId},"switchCommentByClick",this.animationRef&&this.animationRef.childRefs[this.vcActiveCommentId])),e.translateContentCompare!==this.props.translateContentCompare&&this.commentFindProvider&&this.commentFindProvider.setTranslateContentCompare(this.props.translateContentCompare)),u!==r&&(this.bindPadEvents(),this.newCommentIdMap={},this.idMap={},this.dirtyTextareaCollector={},this.activeSource=Je.NULL,this.cacheReadReplyIds=new Set,this.getOrCreateReactionSDK(e).unregister($.COMMENT_REACTION_MODULE,this.handleReactionChange),be.a.destroy({suiteType:i,suiteToken:r,broadcastType:$.COMMENT_REACTION_MODULE}),this.getScrollContainer.cache.clear(),window.setTimeout(function(){a({suiteType:i,suiteToken:r,status:!1})}),l&&u&&(n=this.getOrCreateReactionSDK(this.props),this.fetchReactionData(l,u),n.register($.COMMENT_REACTION_MODULE,this.handleReactionChange),this.initCommentDataActions(),this.initMessageDataActions()),this.dataToRenderStageCollector.switchDocToken());var m,v=this.state.activeCommentId,b=t.activeCommentId,y=null!==v,E=null!==b,O=E&&!y;!E&&y&&this.setFixedBtnVisible(!1),O&&this.setFixedBtnVisible(!0),v!==b&&(b&&(m=this.findCommentById(b),Object(ne.k)(m)&&this.deleteNewCommentIfNecessary(m)),v&&this.handlePanelChanged(v),null!==v&&Object(ne.k)(this.findCommentById(v))||pe.a.emit(Me.a,{module:qe,actionType:"CommentActive",data:{commentId:v}})),this.dataToRenderStageCollector.didUpdate(ee.a.RENDER_DOC_COMMENT_SUCCESS,$.FILE_TYPE.DOC)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.removePadEvents(),pe.a.off("docComment.inViewport",this.debounceMarkReadStatus),pe.a.off("docComment.unreadyInViewport",this.setCacheReadReplyIds),pe.a.off("reopenDocComment",this.handleReopenDocComment),pe.a.off("fullscreenToggleComment",this.handleFsToggleComment),je.g.off("".concat(Me.g,":").concat(qe),this.replayFollowActionHandler),ve.a.destory(),this.dataActionsManager.destroy(),this.handleReset(!1),this.clearCachedProps(),this.debounceMarkReadStatus=null,this.newCommentIdMap={},this.dirtyTextareaCollector={},this.cacheReadIds=[],this.activeSource=Je.NULL,this.idMap={},this.cachedEvents.clear(),this.cachedEvents=null,this.cacheReadReplyIds=new Set,this.rangeCodeController=null,this.animationRef=null,this.vcActiveCommentId=null,this.getScrollContainer.cache.clear(),this.props.setHelpBtnVisible(!0),this.getOrCreateReactionSDK(this.props).unregister($.COMMENT_REACTION_MODULE,this.handleReactionChange),be.a.destroy({suiteType:this.props.objectType,suiteToken:this.props.noteToken,broadcastType:$.COMMENT_REACTION_MODULE});var e=this.props;(0,e.setCommentReactionLoadStatus)({suiteType:e.objectType,suiteToken:e.noteToken,status:!1}),this.debounceSetCommentLoadStatus.cancel(),this.timer&&(window.clearTimeout(this.timer),this.timer=null),this.afterAnimationFrame.cancel(),this.commentFindProvider&&this.commentFindProvider.destroy(),this.isUnmounted=!0,Object(Pe.default)("bind_vc_event",{module:qe,operation:"off"})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.isCommentsDataLoaded&&this.dataToRenderStageCollector.dataReady(ee.a.FETCH_DOC_COMMENT_SUCCESS,$.FILE_TYPE.DOC)}},{key:"getViewPortObserver",value:function(){if(!this.viewPortObserver&&window.IntersectionObserver&&Ve){var e=this.props.editor.getScrollContainer();if(e){var t={root:e,rootMargin:window.screen.height+"px",threshold:0};return new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting?e.target.classList.remove("comment-panel--out-viewport"):e.target.classList.add("comment-panel--out-viewport")})},t)}}}},{key:"sendVCDefaultState",value:function(){pe.a.emit(Me.a,{module:qe,actionType:"CommentActive",data:{commentId:this.state.activeCommentId}});var e=this.state.stateShown;pe.a.emit(Me.a,{module:qe,actionType:"CommentToggle",data:{isOpen:e}})}},{key:"loadCommentFindProvider",value:function(){var t=this,e=Se.a.setupCommentFindProvider();e&&e.then(function(e){t.isUnmounted||(t.commentFindProvider=e,t.commentFindProvider.setup(t,t.props.translateContentCompare),t.commentFindProvider.setCommentList(t.props.commentList))})}},{key:"activeCommentMessage",value:(h=S()(z.a.mark(function e(t,n){var i,r,o,a,s,c,l,u,d,h=this;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.replyId,r=n.isWhole,o=n.finish,a=this.props,s=a.commentList,c=a.setActiveNotification,r)return e.abrupt("return");e.next=4;break;case 4:if(o)return Oe.a.removeAll(),Oe.a.info({duration:3e3,closable:!0,content:C("feed.comment_resolve")}),c({commentId:null,commentOption:{}}),e.abrupt("return");e.next=9;break;case 9:if(l=i,u=s.find(function(e){return h.valueOf(e.commentId).commentId===t})){e.next=16;break}return Oe.a.removeAll(),Oe.a.info({duration:3e3,closable:!0,content:C("feed.comment_deleted")}),c({commentId:null,commentOption:{}}),e.abrupt("return");case 16:if(l||(d=u.comment_list,l=d[0].reply_id),e.t0=this.animationRef,e.t0)return e.next=21,this.animationRef.scrollToCommentMessageReply({commentId:t,replyId:l});e.next=21;break;case 21:c({commentId:null});case 22:case"end":return e.stop()}},e,this)})),O)},{key:"activeMentionMessage",value:(d=S()(z.a.mark(function e(t){var n,i,r,o,a,s=this;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.editor.plugins.comment,e.next=3,n.activateMention(t);case 3:if(i=e.sent){e.next=9;break}return Oe.a.removeAll(),Oe.a.error({duration:3e3,closable:!0,content:C("feed.mention_deleted")}),this.props.setActiveNotification({mentionId:null}),e.abrupt("return");case 9:if("inSheet"===i)return this.props.setActiveNotification({mentionId:null}),e.abrupt("return");e.next=12;break;case 12:r=i.top,o=r-100,a=this.props.editor.getScrollContainer(),Object(_e.$)(a).animate({scrollTop:o},80,function(){s.highlightMentionSelf(t),s.props.setActiveNotification({commentId:null})}),this.props.setActiveNotification({mentionId:null});case 17:case"end":return e.stop()}},e,this)})),E)},{key:"highlightMentionSelf",value:function(e){var t=this,n=Object(_e.$)(".mention-id_".concat(e,", .mention-id_").concat(e," a"),this.scrollBody);this.props.editor.getObserver().withoutRecordingMutations(function(){n.removeClass("highlight-comment-mention"),setTimeout(function(){t.props.editor.getObserver().withoutRecordingMutations(function(){n.addClass("highlight-comment-mention").on("animationend",function(){t.props.editor.getObserver().withoutRecordingMutations(function(){n.removeClass("highlight-comment-mention")})})})},200)})}},{key:"waitCommentRendered",value:(u=S()(z.a.mark(function e(t){var n,i,r,o,a,s,c;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props.editor,i=n.plugins.comment){e.next=5;break}return console.warn("waitCommentRendered: commentPLugin not found",JSON.stringify(this.selection)),e.abrupt("return");case 5:return r=t.split(":"),o=I()(r,3),a=o[0],s=o[1],c=o[2],e.next=8,i.locateComment(a,s,c);case 8:return e.next=10,this.afterAnimationFrame.request(!0);case 10:case"end":return e.stop()}},e,this)})),y)},{key:"initCommentDataActions",value:function(){var e=this.props,t=e.objectType,n=e.noteToken,i=e.isTemplateMode,r=e.enableTranslate,o=e.targetLang,a=e.transEnabled;this.dataActionsManager.initComments({rootType:t,rootToken:n,isTemplate:i,enableAutoTranslate:r,translateLang:o,transEnabled:a,shouldSetBroadcast:!0})}},{key:"initMessageDataActions",value:function(){var e=this.props,t=e.objectType,n=e.noteToken,i=e.isTemplateMode;this.dataActionsManager.initMessages({rootType:t,rootToken:n,isTemplate:i})}},{key:"onFirstRenderAfterDataReady",value:function(){this.props.updateBusinessStage(De.b.Doc,De.c.CommentRendered)}},{key:"getOrCreateReactionSDK",value:function(e){var t=e.objectType,n=e.noteToken;return be.a.getOrCreate({suiteType:t,suiteToken:n,broadcastType:$.COMMENT_REACTION_MODULE})}},{key:"fetchReactionData",value:function(e,t){var n=this;this.getOrCreateReactionSDK(this.props).fetchReactionData().then(function(){n.props.setCommentReactionLoadStatus({suiteType:e,suiteToken:t,status:!0})}).catch(function(){n.props.setCommentReactionLoadStatus({suiteType:e,suiteToken:t,status:!0})})}},{key:"shouldRecreateCommentDataActions",value:function(e){return this.isDocType(e)}},{key:"shouldRecreateMessageDataActions",value:function(e){return this.isDocType(e)&&!$.isAnonymousAccess}},{key:"isDocType",value:function(e){return 2===e}},{key:"onNewCommentDataActions",value:function(e){var t=this,n=e.getCommentService();this.onCommentServiceBinding("on",n);var i=e.getCommentTranslate();return i&&i.onTranslateError(this.handleTranslateError),function(){t.onCommentServiceBinding("off",n),i&&i.offTranslateError(t.handleTranslateError)}}},{key:"onCommentServiceBinding",value:function(e,t){if("on"===e)return t.setupCommentRecord(),t.setupMessageRecord(),t.onCommentChange(this.handleOnCommentChange),void t.onMessageChange(this.handleOnMessageChange);t.offCommentChange(this.handleOnCommentChange),t.offMessageChange(this.handleOnMessageChange)}},{key:"bindPadEvents",value:function(){var e=this.props.editor;e.on("commentFirstStartLoading",this.handleCommentStartLoading),e.on("clickCommentOnDoc",this.handleClickCommentOnDoc),e.on("clickSameCommentOnPopup",this.handleClickSameCommentOnPopup),e.on("clearActiveComment",this.handleClearActiveComment),e.on("renderComments",this.handleRenderComments),e.on("startNewComment",this.handleStartNewComment),e.on("reset",this.handleReset),e.on("thirdPartyLoading",this.handleCommentLoadindStatus),e.on("thirdPartyLoaded",this.handleCommentLoadedStatus),e.on("openPanel",this.handleOpenPanel)}},{key:"removePadEvents",value:function(){var e=this.props.editor;e.off("commentFirstStartLoading",this.handleCommentStartLoading),e.off("clickCommentOnDoc",this.handleClickCommentOnDoc),e.off("clickSameCommentOnPopup",this.handleClickSameCommentOnPopup),e.off("clearActiveComment",this.handleClearActiveComment),e.off("renderComments",this.handleRenderComments),e.off("startNewComment",this.handleStartNewComment),e.off("reset",this.handleReset),e.off("thirdPartyLoading",this.handleCommentLoadindStatus),e.off("thirdPartyLoaded",this.handleCommentLoadedStatus),e.off("openPanel",this.handleOpenPanel)}},{key:"handleNewCommentScroll",value:(l=S()(z.a.mark(function e(t){var n,i,r;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ge&&(this.props.shown||this.logger.logClickShowCommentPanel({source:"click_comment"}),this.props.toggleDocComment(!0),this.animationRef&&this.animationRef.handleCommentScroll(t)),this.logger.logClientCommentPanel({reason:"start_scroll"}),Object(Be.j)()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.animationRef.handleToggleOpen();case 6:if(n=this.animationRef.childRefs[t]){e.next=10;break}return this.logger.logClientCommentPanel({reason:"no_panel"}),e.abrupt("return");case 10:if(i=n&&n.getCurPanelNode()){e.next=14;break}return this.logger.logClientCommentPanel({reason:"no_panel_dom"}),e.abrupt("return");case 14:if(r=this.findCommentById(t)){e.next=18;break}return this.logger.logClientCommentPanel({reason:"no_comment"}),e.abrupt("return");case 18:this.fixScroll(r,i);case 19:case"end":return e.stop()}},e,this)})),b)},{key:"handleAddReaction",value:function(e){var t,n=e.referKey,i=e.reactionKey,r=this.getOrCreateReactionSDK(this.props),o="",a=this.props.commentList.find(function(e){return e.comment_list.find(function(e){return e.reply_id===n})});a&&(o=(t=a.commentId.split(":"))[t.length-1]),r.addReaction($.COMMENT_REACTION_MODULE,n,i),this.logger.logSelectReaction({referKey:n,reactionKey:i,commentId:o})}},{key:"handleRemoveReaction",value:function(e){var t=e.referKey,n=e.reactionKey;this.getOrCreateReactionSDK(this.props).removeReaction($.COMMENT_REACTION_MODULE,t,n);var i,r="",o=this.props.commentList.find(function(e){return e.comment_list.find(function(e){return e.reply_id===t})});o&&(r=(i=o.commentId.split(":"))[i.length-1]),this.logger.logCancelReaction({referKey:t,reactionKey:n,commentId:r})}},{key:"handleReactionDetailClick",value:function(e,t,n){n.stopPropagation(),this.logger.logShowReactionPage({reactionKey:e}),t.some(function(e){return e.userList.length<e.totalCount})&&(this.getOrCreateReactionSDK(this.props).fetchReactionDetail($.COMMENT_REACTION_MODULE,t[0].referKey),this.logger.logShowReactionPageFull({reactionKey:e}))}},{key:"handleShowReactionPanel",value:function(){this.logger.logShowReactionPanel()}},{key:"handleResolve",value:(c=S()(z.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,i=n.editor,r=n.user,o=n.isTemplateMode,a=this.valueOf(t),s=a.serviceType,c=a.serviceToken,l=a.commentId,u=i.plugins.comment.getTeaParams,d=u&&u(s,c,l),this.logger.logClickCommentFinish({id:t,pluginTeaParams:d}),h=this.commentDataActions,e.next=8,this.animationRef.handleResolveAnimation(t,o,this.handleHideResolvingEle);case 8:if(h.resolveCommentAnimationEnd({commentId:l}),e.prev=9,this.props.enterTransMode)return f=ze.a.getInstance(),e.next=14,f.waitForReady();e.next=26;break;case 14:if(p=this.props.editor.plugins.comment.comment,(g=p.findComment(s,c,l))&&g.docPositions.length){e.next=18;break}return e.abrupt("return");case 18:return m=g.docPositions[0],v=Qe(l),b=Xe(l),f.performAttributes(m.selZone,m,[[v,""],[b,"true"]]),e.next=24,p.changeSetCommitWatcher.addCommitWatcher(b,"true");case 24:e.next=28;break;case 26:return e.next=28,i.plugins.comment.resolveCommentOnDoc(s,c,l);case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(9),Object(ce.a)(e.t0);case 33:return e.next=35,h.resolveComment({commentId:l,userId:r.user_id});case 35:this.handleClearActiveComment(),this.handleClearResolving(t);case 37:case"end":return e.stop()}},e,this,[[9,30]])})),v)},{key:"getOffsetTop",value:function(e,t){if(!t)return 0;for(var n=t,i=0;n!==e&&null!==n;)i+=n.offsetTop,n=n.offsetParent;return i}},{key:"getBlockIsInDomByToken",value:function(e){var t=this.props.editor,n=t.plugins.blockPlugin.getBlockByToken(e);if(!n)return!1;var i=n.mountPoint;return!!i&&t.getDocBody().contains(i)}},{key:"handleAddComment",value:(s=S()(z.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k,I,S,T,_,w,j,M,L,R,N,D,x,P,B,U;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.tempId,i=t.tempReplyId,r=t.content,o=t.imageList,a=t.replyId,s=t.stage,c=t.onComplete,this.submittingCommentIds[n]=!0,c&&c(),l=this.findCommentById(n),u=l.quote,d=l.source,h=this.props,f=h.editor,p=h.user,g=this.commentDataActions,m=p.user_id,v=this.valueOf(n),b=v.serviceType,y=v.serviceToken,E=v.commentId,O=f.plugins.comment.getCommentTargetType(b,y,E),C=Object(ne.h)({content:r,extra:{image_list:o}}),k=f.plugins.comment.getTeaParams,I=k&&k(b,y,E),S=this.newCommentIdMap[n],this.logger.logDevCommentEvent({commentId:"",replyId:"",stage:s.INIT,extra:E}),i=i||Object(ue.generateReplyId)(),S){e.next=43;break}return w=Date.now(),e.prev=18,L=l.serviceType!==Ze,R={content:r,quote:u,userId:m,replyId:i,commentId:E,parentType:L?l.serviceType:void 0,parentToken:L?l.serviceToken:void 0},Object(Ue.a)()&&o&&0<o.length&&(R.realReplyId=a,R.extra={image_list:o}),e.next=24,g.addComment(R);case 24:M=e.sent,e.next=35;break;case 27:return e.prev=27,e.t0=e.catch(18),this.handleViolatePolicies({error:e.t0,type:"add",commentId:n,replyId:i}),Object(ce.a)(e.t0),N=e.t0.code,D=e.t0.msg,this.logger.logSubmitEventError({msg:D,code:N,pluginTeaParams:I,translate_source:this.translateSource}),this.logger.logDevCommentEvent({commentId:"",replyId:"",stage:s.FAILURE,extra:E}),e.abrupt("return");case 35:x=M.comment,P=x.commentId,B=x.commentList,U=B[0].replyId,_=P,T=U,j=Object(F.default)(M,"entities.not_notify_users",{}),e.next=47;break;case 43:T=S.replyId,_=S.commentId,w=S.localStartTime,j=S.notNotifyUsers;case 47:this.logger.logCommentSubmitSuccess({commentId:_,replyId:T,isFirst:"true",commentTargetType:O,source:d,pluginTeaParams:I,translate_source:this.translateSource}),this.logger.logClientCommentSumbitBox({commentId:_,replyId:T,isFirst:"true",commentTargetType:O,commentContentType:C,source:d,pluginTeaParams:I}),this.logger.logDevCommentEvent({commentId:_,replyId:T,stage:s.SUCCESS,extra:E}),this.linkCommentToDoc({serviceType:b,serviceToken:y,tempCommentId:E,commentId:_,replyId:T,tempReplyId:i,localStartTime:w,notNotifyUsers:j}),delete this.submittingCommentIds[n];case 52:case"end":return e.stop()}},e,this,[[18,27]])})),m)},{key:"handleAddReply",value:(a=S()(z.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k,I,S,T,_,w,j;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,i=t.tempReplyId,r=t.content,o=t.imageList,a=t.replyId,s=t.stage,c=this.findCommentById(n),l=c.source,u=this.props,d=u.editor,h=u.user,f=this.commentDataActions,p=h.user_id,g=this.valueOf(n),m=g.serviceType,v=g.serviceToken,b=g.commentId,y=d.plugins.comment.getCommentTargetType(m,v,b),E=Object(ne.h)({content:r,extra:{image_list:o}}),i=i||Object(ue.generateReplyId)(),O=b,this.logger.logDevCommentEvent({commentId:O,replyId:"",stage:s.INIT,extra:""}),C=d.plugins.comment.getTeaParams,k=C&&C(m,v,b),e.prev=14,S={replyId:i,userId:p,commentId:O,content:r},Object(Ue.a)()&&o&&0<o.length&&(S.realReplyId=a,S.extra={image_list:o}),e.next=19,f.replyComment(S);case 19:I=e.sent,e.next=30;break;case 22:return e.prev=22,e.t0=e.catch(14),this.handleViolatePolicies({error:e.t0,type:"reply",commentId:n,replyId:i}),Object(ce.a)(e.t0),T=e.t0.code,_=e.t0.msg,this.logger.logDevCommentEvent({commentId:O,replyId:"",stage:s.FAILURE,extra:""}),this.logger.logSubmitEventError({msg:_,code:T,pluginTeaParams:k,translate_source:this.translateSource}),e.abrupt("return");case 30:w=I.replyId,j=Object(F.default)(I,"entities.not_notify_users",{}),Object(Te.g)(j),this.logger.logDevCommentEvent({commentId:O,replyId:"",stage:s.SUCCESS,extra:""}),this.logger.logCommentSubmitSuccess({commentId:O,replyId:w,isFirst:"false",commentTargetType:y,source:l,pluginTeaParams:k,translate_source:this.translateSource}),this.logger.logClientCommentReplyComment({commentId:O,replyId:w,isFirst:"false",commentTargetType:y,commentContentType:E,source:l,pluginTeaParams:k}),this.animationRef.focus(O);case 37:case"end":return e.stop()}},e,this,[[14,22]])})),g)},{key:"handleDelete",value:(r=S()(z.a.mark(function e(t,n){var i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.reply_id,r=this.props,o=r.editor,a=r.haveEditPermission,s=this.valueOf(t),c=s.serviceType,l=s.serviceToken,u=s.commentId,d=this.findCommentById(t),h=d.comment_list,f=o.plugins.comment.comment.findComment(c,l,u),!a&&f&&1===h.length&&0===f.positionId.indexOf("gallery:"))return Oe.a.error({duration:3e3,content:C("comment.gallery_readonly_delete"),key:"readonly-gallery-comment-delete-toast"}),e.abrupt("return");e.next=9;break;case 9:if(p=this.commentDataActions,e.prev=10,!(h.length<=1)){e.next=29;break}if(this.props.enterTransMode)return g=ze.a.getInstance(),e.next=16,g.waitForReady();e.next=27;break;case 16:if(m=this.props.editor.plugins.comment.comment,(v=m.findComment(c,l,u))&&v.docPositions.length){e.next=20;break}return e.abrupt("return");case 20:return b=v.docPositions[0],y=Qe(u),g.performAttributes(b.selZone,b,[[y,""]]),e.next=25,m.changeSetCommitWatcher.addCommitWatcher(y,"");case 25:e.next=29;break;case 27:return e.next=29,this.props.editor.plugins.comment.deleteCommentOnDoc(c,l,u);case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(10),console.error(e.t0);case 34:return e.next=36,p.deleteComment({replyId:i,commentId:u});case 36:this.logger.logCommentDelete({commentId:u,replyId:i});case 37:case"end":return e.stop()}},e,this,[[10,31]])})),p)},{key:"handleEdit",value:function(e,t){var n=t.reply_id,i=this.valueOf(e).commentId;this.logger.logCommentEdit({commentId:i,replyId:n,translate_source:this.translateSource})}},{key:"handleTranslate",value:(i=S()(z.a.mark(function e(t,n,i){var r,o;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=this.valueOf(t),o=r.commentId,this.commentDataActions.getCommentTranslate().translateCommentItem(o,n,i);case 3:case"end":return e.stop()}},e,this)})),f)},{key:"handleUpdateConfirm",value:(o=S()(z.a.mark(function e(t,n,i,r,o){var a,s,c,l,u,d,h,f,p,g,m,v,b,y,E;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.valueOf(t),s=a.commentId,c=a.serviceType,l=a.serviceToken,u=this.commentDataActions,this.logger.logCommentEditConfirm({commentId:s,replyId:n}),d=this.findCommentById(t),h=d.comment_list,f=h.find(function(e){return e.reply_id===n}),p=f.content,g={commentId:s,content:i,replyId:n},Object(Ue.a)()&&o&&(g.extra={image_list:o}),e.prev=9,e.next=12,u.updateComment(g);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),this.handleViolatePolicies({error:e.t0,type:"update",commentId:t,oldContent:p,replyId:n});case 17:r&&r(),m=this.props.editor,v=m.plugins.comment.getTeaParams,b=v&&v(c,l,s),y=m.plugins.comment.getCommentTargetType(c,l,s),E=Object(ne.h)({replyId:n,content:i,extra:{image_list:o}}),this.logger.logClientCommentEditComment({commentId:s,replyId:n,commentTargetType:y,commentContentType:E,pluginTeaParams:b});case 24:case"end":return e.stop()}},e,this,[[9,14]])})),t)},{key:"handleRetry",value:function(t,e,n){var i,r=this,o=e.content,a=e.reply_id,s=e.extra,c=e.realReplyId;if(Object(Ue.a)()&&s&&s.image_list&&(i=s.image_list),n&&"update"===n)this.handleUpdateConfirm(t,a,o,void 0,i);else if(n&&"delete"===n)this.handleDelete(t,{reply_id:a});else{var l=this.valueOf(t).commentId;if(this.newCommentIdMap[t])this.handleAddComment({tempId:t,tempReplyId:a,content:o,imageList:i,stage:"link_comment_to_doc_retry"});else{var u=this.findCommentById(t);if(Object(F.default)(u,"comment_list[0].error")&&!u.isSubmitted)return this.logger.logDevCommentEvent({commentId:"",replyId:"",stage:he.b.INIT,extra:l}),void this.handleAddComment({tempId:t,tempReplyId:a,content:o,imageList:i,stage:he.b});setTimeout(S()(z.a.mark(function e(){return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.handleAddReply({id:t,tempReplyId:a,replyId:c,content:o,imageList:i,stage:he.b});case 2:case"end":return e.stop()}},e)})))}}}},{key:"getOpendocSidebarStyle",value:function(){if(!ge.a.isOpendoc)return{};var e,t,n,i,r,o=this.props.opendocSidebarConfig;return o&&o.borderSide?(t=(e=I()(o.borderSide,4))[0],n=e[1],i=e[2],r=e[3]):o&&o.border&&(t=o.border.top,r=o.border.left||!0,n=o.border.right,i=o.border.bottom),{borderTopWidth:t?"1px":0,borderLeftWidth:r?"1px":0,borderRightWidth:n?"1px":0,borderBottomWidth:i?"1px":0}}},{key:"renderCommentHeader",value:function(){var e=this.state.stateShown,t=this.props.commentList,n="doc-comment";return q.a.createElement("div",{className:"".concat(n,"__list-header"),style:Object(B.default)(this.getOpendocSidebarStyle(),["borderBottomWidth"])},q.a.createElement("span",null,C("comment.side_header_text",t.length)),q.a.createElement(Ae.Tooltip,{title:C("comment.hide_comment"),placement:"left",showActions:["onMouseEnter"],style:{display:e?"block":"none"}},q.a.createElement("div",{className:"".concat(n,"__close"),onClick:this.handleToggleClose},q.a.createElement(Re.a,{width:24,height:24}))))}},{key:"renderContainer",value:function(){var e,t=this.props,n=t.commentList,i=t.history,r=t.shown,o=t.isCommentsDataLoaded,a=t.commentMessageMap,s=this.state,c=s.activeTop,l=s.activeCommentId,u=s.placeholder,d=s.resolving,h=s.stateShown,f=s.commentVisible,p=s.loadingVisible,g=Object(Be.j)();if(!1===g&&!u&&n.length<=0)return null;if(!0===g&&void 0===u&&n.length<=0)return null;var m=d&&-1!==d.indexOf(l),Container=oe.b,v=Ge?"doc-comment-new":"doc-comment",b=X()(v,(e={},w()(e,Ye,g),w()(e,"".concat(Ye,"-shown"),g&&h),e));return n.length>=We&&!this.viewPortObserver&&(this.viewPortObserver=this.getViewPortObserver()),q.a.createElement(se.a,{history:i,hasUnSaveData:this.hasUnFinishComment,getUnSaveTip:this.getUnSaveTip},q.a.createElement("div",{className:b,ref:this.saveDocCommentRef,onTransitionEnd:this.handleContainerTransitionEnd},q.a.createElement("div",{className:"doc-comment__white-space"}),g&&this.renderCommentHeader(),g&&0<n.length&&!f&&p?this.renderLoading():null,g&&h&&q.a.createElement(He.a,{editor:this.props.editor,commentList:this.props.commentList,handleGoFirstComment:this.handleGoFirstComment,getAnimationRef:this.getCurrentAnimationRef}),q.a.createElement(Container,{editor:this.props.editor,ref:this.getAnimationRef,isEmptyComment:!1===u&&n.length<=0,className:"".concat(v,"__panel-list"),activeCommentId:m?null:l,activeTop:m?null:c,list:n,docCommentRef:this.docCommentRef,onActiveChange:this.handlePanelActiveChange,toggleCommentShown:this.toggleCommentShown,toggleCommentStateShown:this.toggleCommentStateShown,commentToggleEnabled:g,shown:r,commentMessageMap:a,isCommentsDataLoaded:o,setStoreShown:this.setStoreShown,onGetCommentId:this.handleGetCommentId,opendocSidebarStyle:Object(B.default)(this.getOpendocSidebarStyle(),["borderTopWidth"]),commentData:this.props.commentData,onCommentVisible:this.handleCommentVisible},0<n.length&&n.map(this.genCommentPanel))))}},{key:"renderToggle",value:function(e){var t=this,n=this.props.commentList,i=this.state,r=i.placeholder,o=i.openBtnTransitionEnd;if(!0===Object(Be.j)()&&void 0===r&&n.length<=0)return null;var a="doc-comment",s=o?["onMouseEnter"]:["onKeyDown"];return q.a.createElement("div",{className:"doc-comment__open-container"},q.a.createElement(Ae.Tooltip,{title:C("comment.show_comment"),placement:"left",style:{display:e?"none":"block"},showActions:s},q.a.createElement("div",{className:"doc-comment__open-wrapper"},q.a.createElement("div",{className:X()("".concat(a,"__open"),{"doc-comment__open--hide":e}),onClick:function(){return t.animationRef&&t.animationRef.handleToggleOpen()},onTransitionEnd:this.handleOpenTransitionEnd},q.a.createElement(Le.a,{width:24,height:24})))))}},{key:"renderLoading",value:function(){var e="doc-comment";return q.a.createElement("div",{className:"".concat(e,"__loading")},q.a.createElement(Fe.a,null))}},{key:"render",value:function(){var e=this,t=this.state,n=t.stateShown,i=t.shownTransitionEnd,r=t.placeholder,o=this.props,a=o.commentList,s=o.editor;if(!!!s.plugins.comment)return null;if(ge.a.isIE&&Ge)return J.a.createPortal(this.renderContainer(),document.body);var c=Object(Be.j)(),l=X()({"doc-comment__wiki":c,"doc-comment__wiki-shown":c&&n}),u=void 0===r&&a.length<=0;return q.a.createElement(q.a.Fragment,null,c&&!n&&i&&q.a.createElement(re.a,{editor:s,handleToggleOpen:function(){return e.animationRef&&e.animationRef.handleToggleOpen()}}),c&&this.renderToggle(n),c&&!u&&q.a.createElement("div",{style:{top:10},className:l}),this.renderContainer())}},{key:"translateSource",get:function(){return this.props.enterTransMode?"translated":"original"}},{key:"commentDataActions",get:function(){return this.dataActionsManager.getCommentDataActions()}},{key:"messageDataActions",get:function(){return this.dataActionsManager.getMessageDataActions()}}]),n}(Z.Component),d.defaultProps={user:{},commentList:[],commentPositions:[],enableTranslate:!1,targetLang:"en"},u=h,P()(u.prototype,"handleAddReaction",[e],Object.getOwnPropertyDescriptor(u.prototype,"handleAddReaction"),u.prototype),P()(u.prototype,"handleRemoveReaction",[t],Object.getOwnPropertyDescriptor(u.prototype,"handleRemoveReaction"),u.prototype),P()(u.prototype,"handleReactionDetailClick",[n],Object.getOwnPropertyDescriptor(u.prototype,"handleReactionDetailClick"),u.prototype),P()(u.prototype,"handleShowReactionPanel",[i],Object.getOwnPropertyDescriptor(u.prototype,"handleShowReactionPanel"),u.prototype),P()(u.prototype,"handleResolve",[r],Object.getOwnPropertyDescriptor(u.prototype,"handleResolve"),u.prototype),P()(u.prototype,"handleDelete",[o],Object.getOwnPropertyDescriptor(u.prototype,"handleDelete"),u.prototype),P()(u.prototype,"handleEdit",[a],Object.getOwnPropertyDescriptor(u.prototype,"handleEdit"),u.prototype),P()(u.prototype,"handleTranslate",[s],Object.getOwnPropertyDescriptor(u.prototype,"handleTranslate"),u.prototype),P()(u.prototype,"handleUpdateConfirm",[c],Object.getOwnPropertyDescriptor(u.prototype,"handleUpdateConfirm"),u.prototype),P()(u.prototype,"handleRetry",[l],Object.getOwnPropertyDescriptor(u.prototype,"handleRetry"),u.prototype),u);et.a=$e}).call(this,tt("2vAP"))},m3gH:function(e,t,i){"use strict";var n=i("o0o1"),r=i.n(n),o=i("yXPU"),a=i.n(o),s=i("oJoF"),c=null;function l(e,t){e.reset(),t&&e.setEditor(t)}var u={plugin:function(n){var e={className:"PresentationMode",reset:function(e,t){c&&c.reset(),n=null},changesetApply:function(e,t){c&&c.changesetApply(t)},processBeforeInsertNode:function(e,t){c&&c.onNewLineEntry(t)}};return c?l(c,n):n&&n.on(s.b,a()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([i.e("doc_index_css"),i.e("chunk_adit"),i.e("commons--doc_index_delay--voteEmoji--votePicker"),i.e(16),i.e("commons--doc_index_delay--jira"),i.e("doc_index_delay")]).then(i.bind(null,"tO+E"));case 2:t=e.sent,l(c=t.default,n);case 5:case"end":return e.stop()}},e)}))),e},isInFullscreen:function(){return!!c&&c.isInFullscreen()}};t.a=u},m9Pg:function(e,t,n){"use strict";var i=n("o0o1"),y=n.n(i),r=n("yXPU"),o=n.n(r),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),l=n.n(c),E=n("j1lG"),u=n("efCe"),d=n("2ACu"),h=n("1dfU"),f=n("NbI8"),p=function(e){return Object(d.default)(f.e,e)},g=function(e){var t=Object.assign({},e,{uuid:Object(h.a)(e.uuid)});Object(d.default)(f.f,t)},m=function(e){var t=Object.assign({},e,{uuid:Object(h.a)(e.uuid),file_token:e.file_token?Object(h.a)(e.file_token):null,upload_error_msg:JSON.stringify(e.upload_error_msg)});Object(d.default)(f.d,t)},v=function(e){var t,n;return"string"==typeof e?t=e.length:(t=e.size,n=e.type),{file_size:t,mime_type:n}},O=n("XJJA"),b=n("J4zp"),C=n.n(b),k=n("lSNA"),I=n.n(k),S=n("y2sV"),T=n("Tqb2"),_=n("vEhQ");function w(e,t){var n=Object(T.U)(e).items;return n.forEach(function(e){j(t,e)}),JSON.stringify({items:n})}function j(e,t){var n,i,r,o,a=+t.natrualHeight/+t.natrualWidth;return a>E.H&&((i=(n=e.getDocBody())&&n.dataset&&n.dataset.lastWidth)&&(r=Math.floor(+i/3).toString(),o=(Math.floor(+i/3)*a).toString(),Object.assign(t,{height:o,width:r}))),t}function M(e,t){return L.apply(this,arguments)}function L(){return(L=o()(y.a.mark(function e(t,n){var i,r,o,a,s,c,l,u;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.b)(t.uuid,t.file);case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return");case 5:r=w(i,n),o=n.selection.getSelection(),a=o.toPosition(),s=a.start,c=a.zoneId,l=a.len,(u=new S.E({zoneId:c})).retain(s),o.isCollapsed()||u.delete(l),(Object(T.P)(o,n)||Object(T.Q)(o))&&u.insertEnter(),u.insert(E.B,I()({},E.c,r)).insertEnter(),n.getContentState().apply(u);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function R(e,t){return N.apply(this,arguments)}function N(){return(N=o()(y.a.mark(function e(t,n){var i,r,o,a,s,c,l,u;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.progress,r=t.uuid,o=Object(T.A)(r,n)){e.next=4;break}return e.abrupt("return");case 4:if(a=o.start,s=o.end,c=o.attributes,l=x(c,i)){e.next=8;break}return e.abrupt("return");case 8:c[E.c]=l,u=n.getContentState(),n.inCallStackIfNecessary("upload-image-update-progress",function(){u.setAttributes({start:a,end:s},c,{nonundoable:!0,preventScrolling:!0})});case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(e,t,n){var i,r,o,a,s,c,l=Object(T.A)(e,n);l&&(i=l.start,r=l.end,a=(o=l.attributes)[E.c],(s=Object(T.U)(a))&&(Object(_.a)(s,"items[0].uuid",t),o[E.c]=JSON.stringify(s),c=n.getContentState(),n.inCallStackIfNecessary("upload-insert-image-uuid",function(){c.setAttributes({start:i,end:r},o,{nonundoable:!0,preventScrolling:!0})})))}function x(e,t){var n=e[E.c],i=Object(T.U)(n);if(i)return Object(_.a)(i,"items[0].uploadProgress",t),JSON.stringify(i)}function P(e,t,n,i){return B.apply(this,arguments)}function B(){return(B=o()(y.a.mark(function e(t,n,i,r){var o,a,s,c,l,u,d,h,f,p,g,m,v,b;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i.mergeUndoStack,a=t.uuid,s=Object(T.A)(a,n)){e.next=5;break}return e.abrupt("return");case 5:return c=s.attributes,l=Object(T.W)(c),u=C()(l,1),d=u[0],h={width:d.width,height:d.height,currWidth:d.width,currHeight:d.height},e.next=10,Object(O.a)(t,h,r);case 10:if(f=e.sent){e.next=13;break}return e.abrupt("return");case 13:if(s=Object(T.A)(a,n)){e.next=16;break}return e.abrupt("return");case 16:p=s.start,g=s.end,m=w(f,n),v=n.getContentState(),c[E.K]=m,delete c[E.c],b=o?{mergeEvent:"uploadImage-success"}:{},n.inCallStackIfNecessary("upload-image-success",function(){v.setAttributes({start:p,end:g},c,{preventScrolling:!0})},b);case 23:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U(e,t){var n,i,r,o=e.uuid,a=Object(T.A)(o,t);a&&(n=a.start,i=a.end,r=t.getContentState(),t.inCallStackIfNecessary("upload-image-fail",function(){r.replaceText({start:n,end:i},E.L,{},{nonundoable:!0,preventScrolling:!0})}))}var z=function(){function t(e){s()(this,t),this.editor=e,this.insertViewTasks=[]}function e(){return n.apply(this,arguments)}var n;return l()(t,[{key:"executeNextTask",value:(n=o()(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0<this.insertViewTasks.length)return e.prev=1,e.next=4,M(this.insertViewTasks[0],this.editor);e.next=8;break;case 4:return e.prev=4,this.insertViewTasks.shift(),this.executeNextTask(),e.finish(4);case 8:case"end":return e.stop()}},e,this,[[1,,4,8]])})),e)},{key:"addTask",value:function(e){this.insertViewTasks.push(e),1===this.insertViewTasks.length&&this.executeNextTask()}},{key:"clear",value:function(){this.insertViewTasks=[]}}]),t}(),H=n("+4eN"),F=function(){function i(e){var t=this,n=e.editor;s()(this,i),this.taskInfoMap=new Map,this.onUploadSuccessCallback=null,this.setOnUploadSuccessCallback=function(e){t.onUploadSuccessCallback=e},this.editor=n,this.uploader=new u.a(n,{preventBeforeUnload:!0,handlers:{onFailure:this.onUploadFailure.bind(this),onSuccess:this.onUploadSuccess.bind(this),onProgress:this.onUpdateUploadProgress.bind(this),onTaskAdded:this.onTaskAdded.bind(this)}}),this.insertViewTaskQueue=new z(n)}function e(e){return t.apply(this,arguments)}var t,n;function r(e){return n.apply(this,arguments)}return l()(i,[{key:"upload",value:(n=o()(y.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.resource,i=t.event,r=t.source,o=t.continuously,a=t.insertedUuid,Object(O.e)(Object(H.m)(this.editor.getRep()))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Object(O.c)(n);case 5:if(s=e.sent,c=v(n),l=c.file_size,u=c.mime_type,d={file_size:l,mime_type:u,source:r},s){e.next=13;break}return console.warn("[doc image uploader] upload wrong type;"),d.error_case=f.b.EXEC_URL_TO_FILE_FAIL,p(d),e.abrupt("return");case 13:if(Object(O.d)(s)){e.next=18;break}return Object(O.g)(),d.error_case=f.b.OVER_FILE_SIZE_LIMIMT,p(d),e.abrupt("return");case 18:p(d),this.setTaskInfo(s,{source:r,mergeUndoStack:!!o,insertedUuid:a,noNeedInsert:!!a,startTime:performance.now()}),this.uploader.upload(s,i);case 21:case"end":return e.stop()}},e,this)})),r)},{key:"onTaskAdded",value:function(e){var t=e.uuid,n=e.size,i=e.type,r=e.file,o=this.getTaskInfo(r),a=o.source,s=o.noNeedInsert,c=o.insertedUuid;g({uuid:t,file_size:n,mime_type:i,source:a}),this.setTaskInfo(r,{task:e}),s?D(c,t,this.editor):this.insertViewTaskQueue.addTask(e)}},{key:"onUploadSuccess",value:function(e){var t=e.uuid,n=e.fileToken,i=e.size,r=e.type,o=e.file,a=this.getTaskInfo(o),s=a.source,c=a.mergeUndoStack,l=a.startTime,u=a.noNeedInsert;m({uuid:t,file_token:n,file_size:i,mime_type:r,source:s,upload_status:E.G.Success,cost_time:performance.now()-l}),P(e,this.editor,{mergeUndoStack:c},u),this.onUploadSuccessCallback&&this.onUploadSuccessCallback({uuid:t})}},{key:"onUploadFailure",value:function(e,t){var n=e.uuid,i=e.fileToken,r=e.size,o=e.type,a=e.file,s=this.getTaskInfo(a),c=s.source,l=s.startTime;m({uuid:n,file_token:i,file_size:r,mime_type:o,source:c,upload_status:E.G.Fail,upload_error_msg:t,cost_time:performance.now()-l}),Object(O.f)(),U(e,this.editor)}},{key:"onUpdateUploadProgress",value:(t=o()(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:R(t,this.editor);case 1:case"end":return e.stop()}},e,this)})),e)},{key:"cancel",value:function(t){var e=Array.from(this.taskInfoMap.values()).find(function(e){return e.task.uuid===t});e&&e.task&&e.task.isUploading&&this.uploader.cancel(e.task)}},{key:"setTaskInfo",value:function(e,t){var n=this.taskInfoMap.get(e);this.taskInfoMap.set(e,Object.assign({},n,t))}},{key:"getTaskInfo",value:function(e){return this.taskInfoMap.get(e)}},{key:"destroy",value:function(){this.taskInfoMap.clear(),this.uploader.destroy(),this.insertViewTaskQueue.clear()}}]),i}();t.a=F},"mDY+":function(e,t,n){},mELL:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("YNKm"),c=(n("avrJ"),n("y2sV")),l=function(){function t(e){var n=this;r()(this,t),this.regist=function(e){e.registerAceCommand(s.Y,function(e,t){t.doInsertTemplateAbstract()},{statusKey:null})},this.aceInitialized=function(e,t){n._editorInfo=t.editorInfo,n._editorInfo.doInsertTemplateAbstract=n.doInsertTemplateAbstract,n.regist(n._editorInfo)},this.aceDomLineProcessLineAttributes=function(e,t){var n=t.spanClass;/(?:^| )template-abstract/.exec(n)&&(t.lineClass+=" template-abstract",t.processedMarker=!0)},this.doInsertTemplateAbstract=function(){var e=n._editorInfo.getRep(),t=e.selStart[0];n._editorInfo.setAttributeOnLine(e.zoneId,t,"template","abstract")},this._editorInfo=null,e&&this.aceInitialized("",Object.assign({editorInfo:e},e))}return a()(t,[{key:"reset",value:function(){this._editorInfo=null}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId;return t instanceof HTMLElement&&-1<t.className.indexOf("template-abstract")?Object(c.I)(n,i,{template:"abstract"}):n}}]),t}();new l},mHIB:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),l=n("WzBf"),u=n("SebV"),s=n("fHNB"),c=function(){function e(){r()(this,e),this.enabled=!1,this.documentDeleted=!1}return a()(e,[{key:"getConfig",value:function(e,t){var n=this;return[{options:{token:"NOTICE_".concat(e,"_").concat(t),resourceType:"NOTICE_".concat(e),routeType:"token",routeKey:t,subtype:"DELETE"},handler:function(e){n.documentDeleted=!0,Object(s.a)(!0)}}]}},{key:"register",value:function(e,t){var n=this;this.tagOptions=this.getConfig(e,t);var i=!0,r=!1,o=void 0;try{for(var a,s=this.tagOptions[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value;l.a.register(c.options,c.handler),l.a.onError(c.options,function(e){console.error("[MessageBoxError]:",e),Object(u.a)(e)})}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return this.enabled=!0,function(){return n.deregister()}}},{key:"deregister",value:function(){if(this.enabled){var e=!0,t=!1,n=void 0;try{for(var i,r=this.tagOptions[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;l.a.deregister(o.options,o.handler)}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}this.tagOptions=[],this.enabled=!1,this.documentDeleted=!1}}},{key:"isDocumentDeleted",value:function(){return this.documentDeleted}},{key:"isEnabled",value:function(){return this.enabled}}]),e}();t.a=new c},"mOv+":function(e,R,N){"use strict";(function(f){N.d(R,"a",function(){return M}),N.d(R,"b",function(){return L});var p,e,t=N("lwsE"),i=N.n(t),n=N("W8MJ"),r=N.n(n),o=N("a1gu"),a=N.n(o),s=N("Nsbk"),l=N.n(s),c=N("7W2i"),u=N.n(c),d=N("oTSI"),h=N("q1tI"),g=N.n(h),m=N("UlbS"),v=N("29OK"),b=N("XjP5"),y=N("3HGU"),E=N("16UX"),O=N("TSYQ"),C=N.n(O),k=N("5gSl"),I=N("GuAe"),S=(N("v2yF"),N("fco7")),T=N("2ACu");(e=p=p||{}).Top="top",e.Bottom="bottom";var _=["onMouseLeave","onClick"],w={cursor:"pointer"},j=function(e){function t(){var c;return i()(this,t),(c=a()(this,l()(t).apply(this,arguments))).handleClickEdit=function(e){c.props.onEdit&&c.props.onEdit(),c.setMoreShow(!1)},c.handleClickDelete=function(e){Object(k.a)(e),c.props.onDelete&&c.props.onDelete(e),c.setMoreShow(!1)},c.handleClickResolve=function(e){Object(k.a)(e),c.props.onResolve&&c.props.onResolve(e)},c.handleClickReply=function(e){Object(k.a)(e),c.props.onReply&&c.props.onReply(e)},c.handleClickTranslate=function(e,t){Object(T.default)("client_comment",{action:"translate_comment"}),Object(k.a)(e),c.props.onTranslate&&c.props.onTranslate(e,t),c.setMoreShow(!1)},c.handleClickToggleTranslateContent=function(e){Object(k.a)(e),c.props.onToggleTranslateContent&&c.props.onToggleTranslateContent(e),c.setMoreShow(!1)},c.setMoreShow=function(e){c.setState({moreShow:e})},c.getMoreMenuSetting=Object(d.a)(function(e,t){var n=t.canEdit,i=t.canDelete,r=t.canTranslate,o=t.canShowTranslate,a=t.canShowContent,s=t.equalLang;return[{id:"edit",text:f("comment.edit"),className:"",visible:n,onClick:c.handleClickEdit},{id:"delete",text:f("comment.delete"),className:"",visible:i,onClick:c.handleClickDelete},{id:"translate",text:s?f("common.translate",""):f("common.ai_translate"),className:"",children:s?S.a.langs.reduce(function(e,t){return e[t]=S.a.getText(t),e},{}):void 0,visible:r,onClick:c.handleClickTranslate},{id:"originContent",text:f(o?"common.translate_original_text":"common.translate_text"),className:"",visible:a,onClick:c.handleClickToggleTranslateContent}]}),c}return u()(t,e),r()(t,[{key:"renderMoreMenu",value:function(){var e=this.props,t=e.canEdit,n=e.canDelete,i=e.canTranslate,r=e.canShowContent,o=e.canShowTranslate,a=e.equalLang;return g.a.createElement(I.a,{list:this.getMoreMenuSetting("".concat(t,":").concat(n,":").concat(i,":").concat(r,":").concat(o,":").concat(a),{canEdit:t,canDelete:n,canTranslate:i,canShowContent:r,canShowTranslate:o,equalLang:a})})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.canEdit,n=e.canDelete,i=e.canTranslate,r=e.canShowContent;t||n||i||r||!this.state.moreShow||this.setMoreShow(!1)}}]),t}(h.PureComponent),M=function(e){function h(e){var t;return i()(this,h),(t=a()(this,l()(h).call(this,e))).state={moreShow:!1},t}return u()(h,e),r()(h,[{key:"handleMoreMenuHover",value:function(){Object(T.default)("client_comment",{action:"click_addition"})}},{key:"render",value:function(){var e=this.props,t=e.canReact,n=e.canEdit,i=e.canDelete,r=e.canResolve,o=e.getToolTipContainer,a=e.canTranslate,s=e.canShowContent,c=e.canReply;if(!(r||t||n||i||a||s))return null;var l=this.state.moreShow,u=n||i||a||s,d=C()("comment-list-item__controls-more-icon",{"comment-list-item__controls-more-icon--toggle-show":l});return g.a.createElement("div",{className:"comment-list-item__resolve-more-btn",onClick:function(e){return e.stopPropagation()}},t&&g.a.createElement(E.a,{defaultRecentReactionPlacement:p.Bottom,onReactionClick:this.props.onReact,onVisibleChange:this.props.onReactionVisibleChange,onMouseEnter:this.props.onReactionMouseEnter,onPopoverMouseEnter:this.props.onReactionPopoverMouseEnter}),c&&g.a.createElement(m.Tooltip,{title:f("comment.placeholder.rely_comment"),placement:"top",hideActions:_,getContainer:o},g.a.createElement("button",{className:C()("comment-list-item__controls-resolve",{"comment-list-item__resolve-btn":!u}),onClick:this.handleClickReply},g.a.createElement("span",{style:w},g.a.createElement(y.a,null)))),r&&g.a.createElement(m.Tooltip,{title:f("comment.solve_tip"),placement:"top",hideActions:_,getContainer:o},g.a.createElement("button",{className:C()("comment-list-item__controls-resolve",{"comment-list-item__resolve-btn":!u}),onClick:this.handleClickResolve},g.a.createElement("span",{style:w},g.a.createElement(b.a,null)))),u&&g.a.createElement(m.Popover,{placement:"bottomRight",content:this.renderMoreMenu(),showActions:h.POPOVER_SHOW_ACTIONS,hideActions:h.POPOVER_HIDE_ACTIONS,className:"comment-item-more",popoverClassName:"comment-item-more-popover",onVisibleChange:this.setMoreShow,arrow:!1,destroyAfterClose:!0,gap:0},g.a.createElement("button",null,g.a.createElement(v.a,{className:d,onMouseEnter:this.handleMoreMenuHover}))))}}]),h}(j);M.POPOVER_SHOW_ACTIONS=["onMouseEnter"],M.POPOVER_HIDE_ACTIONS=["onMouseLeave"];var L=function(e){function n(e){var t;return i()(this,n),(t=a()(this,l()(n).call(this,e))).handleControlClick=function(e){e.stopPropagation()},t.state={moreShow:!1},t}return u()(n,e),r()(n,[{key:"handleMoreMenuHover",value:function(){Object(T.default)("client_comment",{action:"click_addition"})}},{key:"render",value:function(){var e=this.props,t=e.canReact,n=e.canEdit,i=e.canDelete,r=e.canTranslate,o=e.canShowContent,a=e.canReply,s=e.getToolTipContainer,c=this.state.moreShow;if(!(t||n||i||r||o))return null;var l=n||i||r||o,u=C()("comment-list-item__controls-more-icon",{"comment-list-item__controls-more-icon--toggle-show":c});return g.a.createElement("span",{className:"comment-list-item__controls-separate layout-row",onClick:this.handleControlClick},Boolean(t)&&g.a.createElement(E.a,{defaultRecentReactionPlacement:p.Bottom,onReactionClick:this.props.onReact,onVisibleChange:this.props.onReactionVisibleChange,onMouseEnter:this.props.onReactionMouseEnter,onPopoverMouseEnter:this.props.onReactionPopoverMouseEnter}),a&&g.a.createElement(m.Tooltip,{title:f("comment.placeholder.rely_comment"),placement:"top",hideActions:_,getContainer:s},g.a.createElement("button",{className:"comment-list-item__controls-reply",onClick:this.props.onReply},g.a.createElement(y.a,null))),l&&g.a.createElement(m.Popover,{placement:"bottomRight",content:this.renderMoreMenu(),hideDelay:500,className:"comment-item-more",popoverClassName:"comment-item-more-popover",onVisibleChange:this.setMoreShow,arrow:!1,destroyAfterClose:!0,gap:0,getContainer:s},g.a.createElement("button",{className:"comment-list-item__controls-more-dropdown"},g.a.createElement(v.a,{className:u,onMouseEnter:this.handleMoreMenuHover}))))}}]),n}(j)}).call(this,N("2vAP"))},mRaX:function(e,Ke,Ge){"use strict";(function(b){Ge.d(Ke,"k",function(){return D}),Ge.d(Ke,"X",function(){return x}),Ge.d(Ke,"H",function(){return P}),Ge.d(Ke,"Z",function(){return B}),Ge.d(Ke,"m",function(){return U}),Ge.d(Ke,"d",function(){return X}),Ge.d(Ke,"I",function(){return z}),Ge.d(Ke,"v",function(){return H}),Ge.d(Ke,"w",function(){return F}),Ge.d(Ke,"j",function(){return V}),Ge.d(Ke,"y",function(){return W}),Ge.d(Ke,"Q",function(){return K}),Ge.d(Ke,"l",function(){return Z}),Ge.d(Ke,"x",function(){return ee}),Ge.d(Ke,"t",function(){return te}),Ge.d(Ke,"R",function(){return ne}),Ge.d(Ke,"h",function(){return re}),Ge.d(Ke,"K",function(){return oe}),Ge.d(Ke,"b",function(){return se}),Ge.d(Ke,"A",function(){return ce}),Ge.d(Ke,"F",function(){return le}),Ge.d(Ke,"p",function(){return ue}),Ge.d(Ke,"V",function(){return de}),Ge.d(Ke,"W",function(){return he}),Ge.d(Ke,"i",function(){return pe}),Ge.d(Ke,"G",function(){return ge}),Ge.d(Ke,"n",function(){return ve}),Ge.d(Ke,"M",function(){return be}),Ge.d(Ke,"g",function(){return Ee}),Ge.d(Ke,"q",function(){return Oe}),Ge.d(Ke,"r",function(){return Ce}),Ge.d(Ke,"u",function(){return ke}),Ge.d(Ke,"J",function(){return Ie}),Ge.d(Ke,"U",function(){return _e}),Ge.d(Ke,"E",function(){return we}),Ge.d(Ke,"T",function(){return je}),Ge.d(Ke,"O",function(){return Ae}),Ge.d(Ke,"B",function(){return Le}),Ge.d(Ke,"Y",function(){return Re}),Ge.d(Ke,"S",function(){return Ne}),Ge.d(Ke,"s",function(){return De}),Ge.d(Ke,"c",function(){return xe}),Ge.d(Ke,"f",function(){return Pe}),Ge.d(Ke,"N",function(){return Be}),Ge.d(Ke,"e",function(){return Ue}),Ge.d(Ke,"o",function(){return ze}),Ge.d(Ke,"P",function(){return He}),Ge.d(Ke,"L",function(){return Fe}),Ge.d(Ke,"a",function(){return Ve}),Ge.d(Ke,"z",function(){return We});var e=Ge("lSNA"),r=Ge.n(e),t=Ge("RIqP"),l=Ge.n(t),n=Ge("J4zp"),u=Ge.n(n),i=Ge("hjf3"),q=Ge("HmyT"),o=(Ge("D7h9"),Ge("7EGn")),a=(Ge("jp/M"),Ge("G8Hj"),Ge("nN3d")),Y=Ge("HA5h"),h=(Ge("Z0Cl"),Ge("AiBH")),y=Ge("PyL4"),s=Ge("TSYQ"),E=Ge.n(s),c=Ge("nHtH"),J=Ge("iP/4"),d=Ge("kUgE"),f=(Ge("n3ZB"),Ge("m1/u"),Ge("yaX4"),Ge("1dfU")),p=Ge("2ACu"),g=Ge("FnDM"),m=Ge("JznU"),v=Ge("Xngx"),O=Ge("QM+C"),C=Ge("lQZd"),k=Ge("3xnr"),I=Ge("APdQ"),S=Ge.n(I),T=Ge("D28M"),_=Ge("7Kxq"),w=Ge("rbSl"),j=Ge("duSr"),M=Ge("y2sV"),Q=Ge("vE74"),L=Ge("I4N/");Ge.d(Ke,"C",function(){return L.a}),Ge.d(Ke,"D",function(){return L.b});var R="data-contentcollector-ignore-space-at",N="inline-block-placeholder",D=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:16,i=document.createElement("span"),r="";e.forEach(function(e){return r+=e}),i.innerHTML=r,i.style.cssText+="visibility: hidden; position: absolute; top: -9999em; font-size: ".concat(n,"px"),document.body.appendChild(i);var o=i.offsetWidth+t;return document.body.removeChild(i),o},x=function(e){var t=new RegExp("&amp;","g");return e.replace(t,"&")},P=function(e){var t={};return Object(i.a)(e).filter(Boolean).forEach(function(e){t[e]?++t[e]:t[e]=1}),t},B=function(n,i){var r=[];return Object.keys(n).forEach(function(e){var t={};i[e]||(t[e]=n[e]),i[e]&&i[e]<n[e]&&(t[e]=n[e]-i[e]),t[e]&&r.push(t)}),r};function U(n){return function(e){var o=new Array(n.length),t=e.numSet,a=e.tokensMap;if(0===t.length)return o;var s=new RegExp("[*](".concat(t.join("|"),")[*+]"),"g");return n.forEach(function(e,t){for(var n;null!==(n=s.exec(e));){var i=a[n[1]],r=o[t];r?r.push(i):o[t]=[i]}}),o}}var X={horizontalAlign:"left",boxWidth:Object(j.b)()?360:540,boxMaxHeight:417,boxMinHeight:Object(j.a)()?152:350};function z(e){var t=/mention-token_(?=.*[a-z])[a-z0-9]+$/gi;if(!e)return[];var n,i={},r=[];for(n in e){var o,a=u()(e[n],2),s=a[0],c=a[1];s&&c&&t.test(s)&&(i[(o=parseInt(n,10)).toString(36)]=s.split("_")[1],r=[].concat(l()(r),[o.toString(36)]))}return{tokensMap:i,numSet:r}}function H(e,t){if(e){var n=Object(q.$)(e),i=Object.assign({},X,{},t,{lineHeight:Number.parseInt(getComputedStyle(n.get(0))["line-height"]),getFallbackBoxContainer:function(){return n.closest(".innerdocbody").parent().get(0)}}),r=i.mouseY,o=i.zoom,a=void 0===o?1:o,s=W(n.get(0),r,a);if(s)return F(s,i)}}function F(e,t){var n=(t=Object(Y.a)({},X,t)).horizontalAlign,i=t.boxWidth,r=void 0===i?X.boxWidth:i,o=t.boxMaxHeight,a=t.boxMinHeight,s=t.upFirst,c=void 0!==s&&s,l=t.coverNavBar,u=void 0!==l&&l,d=t.flatDom,h=void 0!==d&&d,f=t.closeContainerBottom,p=void 0!==f&&f,g=t.gap,m=void 0===g?0:g,v=t.bottomGap,b=void 0===v?0:v,y=t.getFallbackBoxContainer,E=t.$boxContainer,O=void 0===E?Object(q.$)(".doc-position"):E;O.length||(O=Object(q.$)(y()));var C,k,I,S,T="left"===n,_="center"===n,w=O.offset(),j=O.outerHeight(),M=Object(q.$)(".navigation-bar-wrapper").height()||0;S=window.bestPracticeToken?(C=document.querySelector(".create-by-template__editor.etherpad-container-wrapper"),k=getComputedStyle(C),I=parseInt(k.width,10),parseInt(k.height,10)):(I=window.innerWidth,window.innerHeight);var L,R=e.top,N=e.left,D=e.height,x=e.width,P=w.top,B=w.left,U=S-R-D-b,z=u?R:R-M,H=I-Object(Q.e)()-N-(_?x/2:x)-m;T?(L=N+x-B+m,H<r&&(L-=r+x+2*m),L=Math.max(L,-B)):_&&(L=N+x/2-r/2-B,H<r/2&&(L-=r/2-H)),L=Math.max(L,-B);var F,V,W=t.lineHeight||18,K=h?R-P:R+W-P,Z=J.a.isIPad?window.scrollY:0;return c?(F=-R+P+j-Z,K=void 0,z<o&&o<U&&(F=void 0,K=R+W-P)):(o<z&&U<o&&(F=-R+P+j-Z,K=void 0),U<o&&p&&(F=10,K=void 0)),U<o&&z<o&&(a<z&&U<z?(F=-R+P+j-Z,V=z,K=void 0):V=Math.max(U-10,a)),o===a&&(V=o),{left:L,bottom:!isNaN(F)&&_?F+m:F,top:!isNaN(K)&&_?K+m:K,height:V}}function V(e,t){var n,i,r=t.gap,o=void 0===r?0:r,a=t.$boxContainer,s=void 0===a?Object(q.$)(".doc-position"):a,c=t.coverNavBar,l=s.offset(),u=s.outerHeight(),d=window.innerHeight,h=Object(q.$)(".navigation-bar-wrapper").height(),f=e.top,p=e.left,g=e.height,m=e.width,v=l.top;return d-f-g<f-(c?h:0)?i=-f+v+u+o:n=f-v+g+o,{top:n,left:p-l.left+m/2,bottom:i}}function W(e,t,n){if(!e.getClientRects)return Object(m.a)(e.getBoundingClientRect(),n);var i=e.getClientRects();if(1===i.length)return Object(m.a)(i[0],n);if(!t)return Object(m.a)(i[i.length-1],n);for(var r=0;r<i.length;r++){var o=Object(m.a)(i[r],n),a=o.top,s=o.top+o.height;if(a-3<=t&&t<=s+3)return o}}function K(e){return e.getAttribute(R)}function Z(){var e=ce().focusNode;if(!e)return null;var t=e.parentNode,n=e;return 3===e.nodeType&&t&&(n=t),K(n)||n.hasAttribute(M.g)||n.hasAttribute(M.C)?n:null}function $(e,t,n){var i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],r=[],o=ce();if(e)for(e.get(0)instanceof HTMLElement||(e=e.parent());e.length&&!/magicdomid/.test(e.attr("id"));){var a=e.text(),s=0===t&&"next"===n;if(e.hasClass("mention")&&(s||0!==t))return e;if("prev"===n){var c=0===t&&Ae(o);if((e.prev().hasClass("mention")||e.prev().hasClass(k.a)||e.prev().hasClass(N)||e.prev().find("."+N).length)&&(c||!i)){r=e.prev();break}}else{var l=t===a.length||1===t&&" "===a.slice(-1);if((e.next().hasClass("mention")||e.next().hasClass(k.a)||e.next().hasClass(N)||e.next().find("."+N).length)&&(l||!i)){r=e.next();break}}e=e.parent()}return r}function ee(e){var t=ce(),n=[],i=t.baseNode,r=t.baseOffset,o=t.focusNode,a=t.focusOffset,s=Z(),c=o,l=a;s&&(c=s,l=0);var u,d=$(Object(q.$)(c),l,"prev",e);return!Me(t)||(u=$(Object(q.$)(i),r,"prev",e)).length&&n.push(u.get(0)),d.length&&n.push(d.get(0)),n.length&&n.sort(function(e,t){return e.compareDocumentPosition(t)===h.k.PREV?-1:1}),Object(q.$)(n)}function te(e){var t=ce(),n=t.focusNode,i=t.focusOffset,r=Z(),o=n,a=i;return r&&(o=r,a=1),$(Object(q.$)(o),a,"next",e)}function ne(e){var t=Object(q.$)(e).parents("span");return!(!t.length||t.text()!==Object(q.$)(e).text()||!/mention-type/.test(t.attr("class")))}var ie=0;function re(){return ie++,Object(a.c)(12)+"-"+ie}function oe(e,t){var n=new RegExp(t+"_([^\\s]+)");return Object(o.default)(e.match(n),"[1]")||""}var ae=[h.E.USER,h.E.FILE,h.E.FOLDER,h.E.SHEET,h.E.SHEET_DOC,h.E.BITABLE].map(function(e){return{attr:"mention-type_".concat(e),value:"true"}});function se(e,t){var n,i,r,o,a,s,c,l,u,d,h,f,p=t.documentAttributeManager,g=t.newRep;e.selection.isCaret(g)||(n=g.selStart,i=g.selEnd,r=g.selFocusAtStart,a=i,s=!1,c=ae,l=(o=n)[0]===i[0],u=n[0],p.getAttributesPoints(c,u,u+1).forEach(function(e){var t=e.selStart,n=e.selEnd;t[1]<o[1]&&n[1]>o[1]&&(o=t,s=!0);var i=n[1]>a[1]&&t[1]<a[1];l&&i&&(a=n,s=!0)}),l||(d=i[0],p.getAttributesPoints(c,d,d+1).forEach(function(e){var t=e.selStart,n=e.selEnd;n[1]>a[1]&&t[1]<a[1]&&(a=n,s=!0)})),s&&(g.selStart=o,g.selEnd=a,f=(h=o!==n)&&a!==i?r:!!h,g.selFocusAtStart=f))}function ce(){return window.getSelection?window.getSelection():{}}function le(e){var t=e.left,n=e.top,i=e.bottom,r={left:t,height:e.height};return void 0!==i?r.bottom=i:r.top=n,r}function ue(){return h.f.joined}function de(){var e='<div class="mention-chat-ct layout-column layout-main-center flex">\n    <div class="'.concat("mention-chat-tit",'" >').concat(Object(y.escapeHTML)(b("anonymous.lark_group_card_default_name")),"</div>\n  </div>");return'<div class="layout-row layout-cross-center mention-chat ignore-collect hold-when-replace" contenteditable="false"\n    '.concat(J.a.isEdge?'tabindex="-1"':"",'>\n        <span class="mention-chat-icon">\n          <img src="').concat(S.a,'" />\n        </span>\n        ').concat(e,"\n    </div>").replace(/>[\n\s]+</g,"><")}function he(){var e,t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.url,r=void 0===i?"":i,o=n.buttonText,a=void 0===o?"":o,s=n.content,c=void 0===s?b("anonymous.lark_group_card_default_name"):s,l=n.desc,u=void 0===l?"":l,d=n.joinConfirm,h=n.chatId,f=n.notAllowedJoin,p="",g="mention-chat-tit",m="",v="";return p=d?'<div class="layout-row mention-chat-button-opt layout-cross-center" ><button\n      class="button-cancel">'.concat(b("common.cancel"),'</button><button\n      class="button-confirm">').concat(b("common.confirm"),"</button></div>"):(e=a===ue(),t=E()("mention-chat-button no-ace-listen",{"js-open-lark":e,"open-lark":e}),'<div data-id="'.concat(Object(y.escapeHTMLAttribute)(h),'" class="').concat(t,'" onclick="(function handleOpenLark(e){\n      if (').concat(!e,") return;\n      if (").concat(J.a.isIE,") return;\n      e.stopPropagation();\n      var openLarkEvent = document.createEvent('Event');\n      openLarkEvent.initEvent('openLark',true,true);\n      dispatchEvent(openLarkEvent);\n    }).apply(this, arguments)\">").concat(a,"</div>")),u&&(g+=" mt12",m='<div class="mention-chat-desc">'.concat(Object(y.escapeHTML)(u),"</div>")),v=f?'<div class="mention-chat-ct layout-column layout-main-center flex">\n    <div class="'.concat(g,'" >').concat(b("mention.chat_notallowed_join"),"</div></div>"):'<div class="mention-chat-ct layout-column layout-main-center flex">\n    <div class="'.concat(g,'" >').concat(Object(y.escapeHTML)(c),"</div>\n    ").concat(m,"\n    </div>\n    ").concat(p),'<div class="layout-row layout-cross-center mention-chat ignore-collect hold-when-replace" contenteditable="false"\n    '.concat(J.a.isEdge?'tabindex="-1"':"",'>\n        <span class="mention-chat-icon">\n          <img src="').concat(Object(y.escapeHTMLAttribute)(ye(r)),'" />\n        </span>\n        ').concat(v,"\n    </div>").replace(/>[\n\s]+</g,"><")}var fe="";function pe(e){fe=fe||getComputedStyle(document.body)["font-family"];var t=Object(q.$)("<p>".concat(Object(y.escapeHTML)(e),"</p>"));t.css({fontSize:14,fontFamily:fe,lineHeight:"20px",width:204,position:"absolute",left:-1e4,"word-break":"break-all"}),Object(q.$)("body").append(t);var n=t.height();return t.remove(),n}function ge(e){if(!e)return"";var t=e.type,n=e.desc,i=e.edit_time,r=me(e),o=h.E.CHAT;return[h.E.SHEET,h.E.FILE,h.E.BITABLE,h.E.BOX,h.E.MINDNOTE,h.E.SLIDE].includes(t)&&(r=b("mention.last_update2",Object(c.a)(i))),t===o&&(r=n||b("mention.no_desc_tips")),r}function me(e){var t=e.department,n=e.i18n_department,i=e.i18n_tenant,r=e.is_external,o=Object(d.formatLanguageToLowerCase)(Object(d.getLocale)()),a=r?i:n;return a&&a[o]||t||""}function ve(){for(var e=arguments.length,t=0,n="";t<e;)n+=t<0||arguments.length<=t?void 0:arguments[t],t!==e-1&&(n+=","),t++;return n}var be=function(){return/comment-(local-)?id-[\S]+/.test(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")};function ye(e){return e&&e.replace(/^https?:/,"")}function Ee(e){if(!e)return"";var t=e.replace(/image_size=\d+x\d+/,"image_size=640x540");return t===e?t.replace(/~([^\\.]+)/,"~cs_640x540"):t}function Oe(e,t){for(var n=t.numToAttrib,i={},r=0,o=e.length;r<o;r++){var a=n[parseInt(e[r],36)]||[],s=/mention-token|mention-type|mention-link|mention-notify|mention-sharePermHeldBack|mention-icon/.exec(a[0]);s&&(i[s[0]]=a[0].split("_")[1]||a[1])}return i}function Ce(i){return i?Object.keys(i).reduce(function(e,t){var n=/mention-token|mention-type|mention-link|mention-notify|mention-sharePermHeldBack|mention-icon/.exec(t);return n&&(e[n[0]]=t.split("_")[1]||i[t]),e},{}):{}}function ke(){return Object(C.g)()}function Ie(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i="en-US"===Object(d.getLocale)()?"en_name":"cn_name";return n&&(i=i.replace("_n","N")),t[e]&&(t[e][i]||t[e].name||t[e].cn_name||t[e].en_name||"")}function Se(){var e,t,n=ce(),i=n.focusOffset,r=n.focusNode,o=n.extentNode,a=n.extentOffset;return r||o?(t=o?(e=a,o.nodeValue||""):(e=i,r.nodeValue||""),{sel:n,offset:e,nodeValue:t}):{sel:n,offset:null,nodeValue:null}}function Te(e){var t=Se(),n=t.sel,i=t.offset,r=t.nodeValue;return(null!==i||null!==r)&&((J.a.isIE||"Caret"===n.type)&&e(r,i))}function _e(e){return Te(function(e,t){return"@"===e[t-1]})}function we(){var e=Se(),t=e.offset,n=e.nodeValue;if(null===t&&null===n)return null;for(var i=null,r=t-1;0<=r;r--)if("@"===n[r]){i=r;break}return null===i?null:n.substring(i,t)}function je(){return Te(function(e,t){var n=0<=t-2?e[t-2]:"";return/^[a-zA-Z0-9]$/.test(n)})}function Me(e){return J.a.isIE?e&&0<e.toString().length:e&&"Range"===e.type}function Ae(e){return J.a.isIE?e&&0===e.toString().length:e&&"Caret"===e.type}function Le(e){var t=Object(g.f)(),n=e.parents(".comment-list-item"),i=e.parents(".comment-textarea__input"),r=n.length||i.length,o={};return r&&(o.isWhole=0<e.parents(".global-comment").length),o.source="doc"===t?r?h.z.DOC_COMMENT:h.z.DOC:r?h.z.SHEET_COMMENT:h.z.SHEET,o}function Re(e,t,n,i){Object(p.default)("show_hover_card",{source:e||"sheet",chat_btn_status:t?"true":"false",mention_type:n,mention_obj_id:Object(f.a)(i)})}function Ne(e){var t=e.status,n=e.source,i=e.type,r=e.token,o=e.reason,a=e.cost_time;Object(p.default)("doc_hover_shortcut",{source:n||"unkown",status:String(t),mention_type:i,mention_obj_id:Object(f.a)(r),reason:o||"",cost_time:a})}function De(e){return{1:"recent_view_user",2:"recent_mention_user",3:"lark_search_user"}[e]}var xe=String.fromCharCode(8203);function Pe(e){var t=new RegExp(xe,"g");return e.replace(t,"")}function Be(e){return 0===Pe(e).length}function Ue(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split(" "),i={};return e.forEach(function(e){var t,n=e.match(/mention-([a-zA-Z]+)_(.+)/);n&&(t=n[1],i[t]=n[2])}),i}function ze(e,t){var n,i=e===O.NUM_SUITE_TYPE.FILE?Object(v.e)(t):"";return E()((n={"m-mention-box__item_icon":!0},r()(n,"m-mention-box__item_icon_".concat(e),!0),r()(n,"m-mention-box__item_icon_box_".concat(i),e===O.NUM_SUITE_TYPE.FILE),n))}function He(e){var t=e.selection.currentSelection,n=t.start,i=t.end;if(n.line!==i.line||n.col!==i.col)return!1;var r=e.getCurrentLineEntry();return 0===e.getTextAndAttrsOnSelection({selStart:[n.line,0],selEnd:[n.line,r.text.length],selZone:r.zone}).reduce(function(e,t){return e+t.text},"").trim().length}function Fe(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Object(p.default)(e,t)}function Ve(e){var t="new-mention-ui";Object(T.f)(e,t)||Object(T.a)(e,t)}function We(e,t){return Object(w.a)({editor:e,attrib:["".concat(_.a).concat(t),!0],checkSelLineFirst:!0})}}).call(this,Ge("2vAP"))},mUiD:function(e,v,b){"use strict";(function(n){b.d(v,"a",function(){return m});var e=b("lwsE"),i=b.n(e),t=b("W8MJ"),r=b.n(t),o=b("a1gu"),a=b.n(o),s=b("Nsbk"),c=b.n(s),l=b("7W2i"),u=b.n(l),d=b("q1tI"),h=b.n(d),f=b("UlbS"),p=b("5fLR"),g=b.n(p),m=(b("3Iah"),function(e){function t(){var e;return i()(this,t),(e=a()(this,c()(t).apply(this,arguments))).state={visible:!1},e.modalId="",e.handleOnCancel=function(){e.hide(e.modalId)},e}return u()(t,e),r()(t,[{key:"show",value:function(e){this.setState({visible:!0}),this.modalId=e}},{key:"hide",value:function(e){this.modalId===e&&this.setState({visible:!1})}},{key:"render",value:function(){var e=this.state.visible;return h.a.createElement(f.Dialog,{dialogClassName:"relay-image-modal",center:!0,title:n("image.upload_from_mobile_title"),visible:e,width:480,onClose:this.handleOnCancel,footer:null},h.a.createElement("img",{className:"relay-image-gif",src:g.a}),h.a.createElement("div",{className:"relay-image-content"},h.a.createElement("div",null,h.a.createElement("span",null,n("image.upload_from_mobile_tips"))),h.a.createElement("div",null,h.a.createElement("span",null,n("image.upload_from_lark_version_tips")),h.a.createElement("a",{href:n("image.relay_from_mobile_help_url"),target:"_blank"},n("image.image_from_mobile_help")))))}}]),t}(h.a.Component))}).call(this,b("2vAP"))},mWyS:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return l});var i=n("j1lG"),r=n("Pozx");function o(e){return i.j.test(e)}function a(e){return i.g.test(e)}function s(e){var t=i.j.exec(e);return t&&t[2]}function c(e){var t=i.g.exec(e);return t&&t[1]}function l(e){switch(Object(r.a)(e)){case i.D.Doc:return c(e);case i.D.Drive:return s(e);case i.D.External:default:return null}}},mbpr:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("2ACu"),c=function(){function e(){r()(this,e),this.timeRecoder={},this.log={},this.notSendLog=!1}return a()(e,[{key:"setNotSendLog",value:function(e){this.notSendLog=e}},{key:"logStartTime",value:function(e){this.timeRecoder[e]=performance.now()}},{key:"logEndTime",value:function(e){this.log[e]=Math.round(performance.now()-this.timeRecoder[e])}},{key:"logValue",value:function(e,t){this.log[e]=t}},{key:"getLogValue",value:function(e){return this.log[e]}},{key:"getLog",value:function(){return this.log}},{key:"mergeLog",value:function(e){this.log=Object.assign({},this.log,{},e)}},{key:"sendLog",value:function(e,t){this.notSendLog||Object(s.default)(e,Object.assign({},t,{},this.log))}},{key:"clear",value:function(){this.timeRecoder={},this.log={}}}]),e}()},"n+Ky":function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),o=n("o0o1"),a=n.n(o),s=n("J4zp"),c=n.n(s),l=n("yXPU"),u=n.n(l),d=n("ECCn"),h=n.n(d),f=n("8Kqh"),p=n.n(f),g=n("8Pgg"),m=n.n(g),v=n("r5rv"),b=n.n(v),y=n("H+UY"),E=n.n(y),O=n("mK8d"),C=n.n(O),k=n("Agkw"),I=n.n(k),S=n("qZUF"),T=n.n(S),_=n("ebWy"),w=n.n(_),j=n("jctj"),M=n.n(j),L=n("wB1n"),R=n.n(L),N=n("WtIr"),D=n.n(N),x=n("My+Z"),P=n.n(x),B=n("TdF3"),U=n.n(B),z=n("el66"),H=n.n(z),F=n("9U8A"),V=n.n(F),W=n("m/If"),K=n.n(W),Z=n("KQfT"),q=n.n(Z),Y=n("alHH"),J=n.n(Y),Q=n("lRCX"),X=n.n(Q),$=n("gst6"),ee=n.n($),te=n("3gkP"),ne=n.n(te),ie=n("CyL5"),re=n.n(ie),oe=n("YROV"),ae=n.n(oe),se=n("7P7d"),ce=n.n(se),le=n("0kiY"),ue=n.n(le),de=n("RLXu"),he=n.n(de),fe=n("tluB"),pe=n.n(fe),ge=n("qUGr"),me=n.n(ge),ve=["Apache","Bash","C#","C++","CoffeeScript","HTML","XML","HTTP","JSON","Java","JavaScript","Makefile","Nginx","Objective-C","PHP","Perl","Python","Ruby","SQL","Shell","Go","SCSS","Lua","Django","Kotlin"];h.a.registerLanguage("apache",p.a),h.a.registerLanguage("bash",m.a),h.a.registerLanguage("c-like",b.a),h.a.registerLanguage("c",E.a),h.a.registerLanguage("cs",C.a),h.a.registerLanguage("cpp",I.a),h.a.registerLanguage("python",X.a),h.a.registerLanguage("coffeescript",T.a),h.a.registerLanguage("htmlbars",w.a),h.a.registerLanguage("xml",M.a),h.a.registerLanguage("http",R.a),h.a.registerLanguage("json",D.a),h.a.registerLanguage("java",P.a),h.a.registerLanguage("javascript",U.a),h.a.registerLanguage("makefile",H.a),h.a.registerLanguage("nginx",V.a),h.a.registerLanguage("objectivec",K.a),h.a.registerLanguage("php",q.a),h.a.registerLanguage("perl",J.a),h.a.registerLanguage("ruby",ee.a),h.a.registerLanguage("sql",ne.a),h.a.registerLanguage("go",re.a),h.a.registerLanguage("scss",ae.a),h.a.registerLanguage("lua",ce.a),h.a.registerLanguage("django",ue.a),h.a.registerLanguage("dockerfile",he.a),h.a.registerLanguage("shell",pe.a),h.a.registerLanguage("kotlin",me.a);var be=h.a,ye=n("WC6B");n.d(t,"b",function(){return Ee});var Ee=function(){var e=u()(a.a.mark(function e(){var o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([n.e("doc_index_css"),n.e("chunk_adit"),n.e("commons--doc_index_delay--voteEmoji--votePicker"),n.e(16),n.e("commons--doc_index_delay--jira"),n.e("doc_index_delay")]).then(n.bind(null,"SD29"));case 3:o=e.sent,Object.entries(ye.d).forEach(function(e){var t=c()(e,2),n=t[0],i=t[1],r=o[n.toLowerCase()];r&&be.registerLanguage(i.toLowerCase(),r)}),be.registerLanguage(ye.d.HTML.toLowerCase(),o.xml),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Load languages error: ",e.t0);case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}();be.configure({languages:[].concat(r()(ve),r()(ye.b))});t.a=be},n2k8:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var y=n("Z/PY"),E=n("j1lG"),s=n("lQZd"),O=n("+Xq6"),i=function(e,m){for(var t=e.deltaSet,n=e.customCopyDatas,i=t.deltas,v=Object(s.g)(),b={},r=function(){var e=a[o],p=e.ops;if(!p)return"continue";var g=[],t=p.reduce(function(e,t,n){var i=t.attributes,r=Object(y.k)(i);if(!r)return e.push(t),e;if(r===E.K){var o=JSON.parse(i[E.K]).items;if(0===(o=m(o)).length)return e;var a=!0,s=!1,c=void 0;try{for(var l,u=o[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var d=l.value;i.author&&(b[d.uuid]=i.author),g.push(d)}}catch(e){s=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw c}}var h=p[n+1];if(h&&Object(y.k)(h.attributes))return e;var f={insert:E.B,attributes:{author:i.author,gallery:JSON.stringify({items:g}),suiteData:Object(O.e)({objToken:v})}};e.push(f),g.length=0}else t.attributes.suiteData=Object(O.e)({objToken:v}),e.push(t);return e},[]);e.ops=t},o=0,a=Object.values(i);o<a.length;o++)r();n&&n.push({key:E.k,data:JSON.stringify(b)})}},n67m:function(e,t,n){"use strict";var i=n("J4zp"),p=n.n(i),r=n("lwsE"),o=n.n(r),a=n("hbEN"),s=n("0X7r"),c=n("kohC"),l=function e(){var f=this;o()(this,e),this.userList=new Set,this.changeUserList=new Map,this.embedObjList=new Map,this.embedTokenList=new Set,this.changeEmbedTokenList=new Map,this.instances={},this.addInstance=function(e,t){f.instances[e]=t},this.addComment=function(e){f.userManager||f.initUserManager();var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;f.userList.add(a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}f.updateUserPermission()},this.initUserManager=function(){f.userManager||(f.userManager=new s.b({onPermissionChange:f.handlePermissionChange}))},this.initEmbedObjManager=function(){f.embedObjManager||(f.embedObjManager=new c.a({onPermissionChange:f.handlePermissionChange}))},this.handlePermissionChange=function(e){for(var t in f.instances)f.instances[t].handlePermissionChange(e)},this.getPermissions=function(e){return"users"===e?f.userManager&&f.userManager.getUserPermissions():"docs"===e?f.embedObjManager&&f.embedObjManager.getEmbedObjPermissions():null},this.initUsers=function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;f.userList.add(a)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}f.addUsers(e),f.debounceUpdateUserPermission()},this.addUsers=function(e){f.addTokens("users",e)},this.removeUsers=function(e){f.removeTokens("docs",e)},this.updateUserPermission=function(){var e;f.userManager&&(e=Array.from(f.userList),f.userManager.updateUserList(e))},this.debounceUpdateUserPermission=Object(a.default)(function(){f.updateUserPermission()},100),this.initDocs=function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.token;f.embedObjList.set(c,s),f.embedTokenList.add(c),t.push(c)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}f.addDocs(e),f.debounceUpdateEmbedObjPermission()},this.updateEmbedObjPermission=function(){var e;f.embedObjManager&&(e=Array.from(f.embedObjList.values()),f.embedObjManager.updateEmbedObjList(e))},this.debounceUpdateEmbedObjPermission=Object(a.default)(function(){f.updateEmbedObjPermission()},100),this.addDocs=function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.token;t.push(c),f.embedObjList.set(c,s)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}f.addTokens("docs",t)},this.removeDocs=function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.token;t.push(s)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}f.removeTokens("docs",t)},this.getChangeList=function(e){return"users"===e?f.changeUserList:"docs"===e?f.changeEmbedTokenList:null},this.getTokenList=function(e){return"users"===e?f.userList:"docs"===e?f.embedTokenList:null},this.addTokens=function(e,t){var n=f.getChangeList(e);if(n){var i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,l=n.get(c);l?n.set(c,l+1):n.set(c,1)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}f.addRemoveTokenPermission(e)}},this.removeTokens=function(e,t){var n=f.getChangeList(e);if(n){var i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,l=n.get(c);l?l-1==1?n.delete(c):n.set(c,l-1):n.set(c,-1)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}f.addRemoveTokenPermission(e)}},this.addTokenPermission=function(e,t){if("users"===e&&f.userManager.addUsers(t),"docs"===e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,l=f.embedObjList.get(c);l&&n.push(l)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}f.embedObjManager&&f.embedObjManager.addEmbedObjs(n)}},this.removeTokenPermission=function(e,t){if("users"===e&&f.userManager.removeUsers(t),"docs"===e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value,l=f.embedObjList.get(c);l&&(n.push(l),f.embedObjList.delete(c))}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}f.embedObjManager&&f.embedObjManager.removeEmbedObjs(n)}},this.addRemoveTokenPermission=Object(a.default)(function(e){var t=f.getChangeList(e);if(t&&0!==t.size){var n=[],i=[],r=f.getTokenList(e);if(r){var o=!0,a=!1,s=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=p()(c.value,2),d=u[0],h=u[1];0<h&&!r.has(d)&&(r.add(d),n.push(d)),h<0&&r.has(d)&&(r.delete(d),i.push(d))}}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}0<n.length&&f.addTokenPermission(e,n),0<i.length&&f.removeTokenPermission(e,i)}}},100),this.delete=function(e){delete f.instances[e],0===Object.keys(f.instances).length&&f.destory()},this.destory=function(){f.userList=new Set,f.changeUserList=new Map,f.userManager&&f.userManager.destroy(),f.userManager=null,f.embedTokenList=new Set,f.embedObjList=new Map,f.embedObjManager&&f.embedObjManager.destroy(),f.embedObjManager=null,f.debounceUpdateUserPermission.cancel(),f.addRemoveTokenPermission.cancel(),f.debounceUpdateEmbedObjPermission.cancel()}};t.a=new l},n6KG:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAn8AAAFECAIAAADZec9fAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAxVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgSW1hZ2VSZWFkeSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBNjg3MTczNEE4QjgxMUU5OTdFM0Q4NTIxRkZEQUY4QiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBNjg3MTczNUE4QjgxMUU5OTdFM0Q4NTIxRkZEQUY4QiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE2ODcxNzMyQThCODExRTk5N0UzRDg1MjFGRkRBRjhCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE2ODcxNzMzQThCODExRTk5N0UzRDg1MjFGRkRBRjhCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+F9jXuwAACoFJREFUeNrs3Qlz02YCgGFkybdDgC5toSkQ6DXb3c529///hp3Zme22hRa6LPeV044lWdqPMsNAkmIF7Ph6HjqeRnEy9udRXn+SLEVlWZ4BAE5RzRAAgPoCgPoCAOoLAOoLAKgvAKgvAKC+AKC+AKC+AID6AoD6AgDqCwDqCwCoLwCoLwCoLwCgvgCgvgCA+gKA+gIA6gsA6gsA6gsAqC8AqC8AoL4AoL4AgPoCgPoCAOoLAOoLAOoLAKgvAKgvAKC+AKC+AID6AoD6AoD6AgDqCwDqCwCoLwCoLwCgvgCgvgCgvgCA+gKA+gIA6gsA6gsAqC8AqC8AoL4AoL4AoL4AgPoCgPoCAOoLAOoLAKgvAKgvAKgvAKC+AKC+AID6AoD6AgDqCwDqCwDqCwCoLwCoLwCgvgCgvgCA+gKA+gKA+gIA6gsA6gsAqC8AqC8AoL4AoL4AgPoCgPoCgPoCAOoLAOoLAKgvAKgvAKC+AKC+AKC+AID6AoD6AgDqCwDqCwCoLwCoLwCoLwCgvgCgvgDAhCSGAN5Pno+yPCtGRVGWxcubcn4eW/S7Wi0K/5J6+JeEL71kMEcr6Vz9yYD5F1aZg+EwTbMFWndCeuM4brea4dYrCOoLCyZ0N5R3cdeaer0eGlyr2eUE6gsLMuXd7w/yPF/4dT6Kup12ktjrBOoL860oir39frhdktU+ilqtZrPR8MrCrNgABeNnvcuU3lfPaDA4OBgOvbigvjCn9vuDZUrvayG/AgzqC3OZqOFwCfb1CjCoLyyMsiyHw3TJ314IMKgvzNvEdxUOSxRgUF+YI2marcr7DAEG9YV5kOejlfo8ngDDafKJezhellea+NZqtXarlSTxzE+kvLW98+EBDretZtOrD+oLs1GMxn/KKKR3rddbpusXCDCcDlue4Q/qW2Gzc5j1Lt+lg2yCBvWF2dW3whk2kmQ5LxkkwKC+MBtVDrla4ovmCjCoLyDAoL7AYmq3WgIM6gucqmazIcCgvoAAg/oCAizAoL6AAIP6AgIMqC8gwKC+gAAD6gsIMKgvIMCgvgACDOoLnNiHX/JBgEF9gROuzLXxq/NoNBJgUF9gcitzhblvmmZmwKC+wMREFea+aZbl46a/AgzqC1RVT+Kx9ynLst8fTC/AwzT1QoD6wgpJknqVA6+Kotjf7w8GB1PaB5znudcCxq+whgCWQyhvEsdZhfiFGXCYpE5jnhp+cyj7Wq9b5RAwMPcFlkGj2Zj5YwgBHhzYAQzqCyujnrw084eRZdmowq5lUF9gSbRbzXl4GKa/oL6wQuI4bjZnH+Aw9y3L0ssB6gsrNP2t12e8/TmkN3PwM6gvrJROpxMmwbN9DHmmvqC+sEqiM2d6ve5sZ8BFWXghQH1h5QLc7XRmuA+4KOz3BfWFldRuNdd63Zl8DMlRV/AOznUFC+DF1vbW9u7u7t4wTX8/lWNUryeNRmP9bO/8ufWza713/Gwcx71uJ8vzdJjmp3gosvrCO0TWEDjW1vbO2PuE8E07YPcePHrw8PFw+K6zQna7nSsblz+6cK7CLzyT5y+vc1QWRVG+upniX4Bpjw+oL6jvhO3t92/eur3fH1S8/8cXP/ri+tVTO8HyPLw7gcVlyzPMo+2d3R9+vHWi8zU+fvJscDD865+/rtUiAwhzzlFXMHfCrPeHH2++x6mSd3f3bv5y2wCC+gInUxTlzzdvj0bv+WHZJ0+fP3u+ZRhhztnyDPPl/oNH/cEx+3p73c7lS590u51Ws1GWZwYHB3t7+3fvPUjT7NA9/3v3XpUjsAD1BV4qy/L+w0eHFkZR9OWNax9f/OjNhWu9bvgvLLz5y52nz168+a39/mBnd+/dH0MCZsuWZ5gjL7a2j85lj6b3tTiOw3cbjfrR32MwQX2BSrZ3dg8t6XU7f5Te1wH+/LNLR37PnsEE9QUq2dndP7Tk8qVPxv5Ut9s5tCRNU4MJ6gtUEr99rowois6fWx/7U51269CSzNX9QH2BijavbrxOaZIk1699XuUqgUfPb+UcdjDnHPMMc6Tb7fz9b3856U9leT62x4C5LzBJW1uHT7ncajYMC6gvMC2jorh3/9HRObSRAfUFpqIoiv/8dOvoubHe/SElYObs94VF1R8c/PjTL0fT22631s+uGR9QX2DCnjx9fuvX3469DtKVjcvGB9QXmKSyLH+9c/fBw8fHfvezy59e/NMFowTqC0zSTzd/PXRZhdcunD+3eXXDEIH6ApP0863bf5TeTz+5eGPziiEC9QUmKXT38ZNnR5fHcRy66zhnUF9gwoqivH3n7tHl3W7nmy+vt4+c6hlQX+BDbW3vDI9cuejC+fVvvrrhvJKgvsBUPH+xdXjW22l/89UXtVpkcGDheMsMi2F37/Clfzc+uyS9oL7AFCVx/OaXURSdO3fWsID6AlO0ee3z9puX/t28Uk/sOYKFfT9tCGAh9Lqdf5z80r+AuS8AoL4AoL4AsArs94XFkKbZ7d/+t72zG/5//eza5tWNRqNuWEB9gSmm95//+neW5a++fPL02db29vfffSvAsKBseYYFEGa9r9P7SvgyLDQyoL7AtLza4FxlIaC+AID6wmJaP7tWcSGgvsBkbF7dqNffOkYyfBkWGhlYUI55hgXQaNS//+5bnzgC9QVOO8Bff7lpHGA52PIMAOoLAOoLAKgvAKgvAKC+AKC+AID6AoD6AoD6AgDqCwDqCwCoLwCoLwCgvgCgvjC/oigae5+yLFdzcKo88SoDCOoLvL1u1MavHXk+Ws3BqfLEqwwgqC/w9rpRYeo2ODhYwdlveMrhiU9kAEF9gbfXjXj82lEUxe7eXpblK7IJOjzN8GTDUw5PfCIDCCsrMQRwrHpSHw7TKgHe7/cN17EDaBDA3BdO+M40iR039N7C0IUBNA6gvnBijYbZm6ED9YXT1Wo2TX/fb+Ibhs44gPrCe1ak2WwYh5MKg+ZdC6gvfND0N0kcnHgCYbhMfEF94UN1O20njqj6B6VWC8NlHEB94UNFUdTrdgS4SnrDQNnmDJX+sKzsiWrhRMKast8f5HluKI6VJEmY9UovqC9M3sEwSK01h7YNNJsN+3pBfWG6k+DQ4DTNrDuhu41G3eeyQH3h9OT5KMuzYlQUZVm8vFn+VSlUthaE27hWT+rOZgXqCwALw2GcAKC+AKC+AID6AoD6AgDqCwDqCwCoLwCoLwCoLwCgvgCgvgCA+gKA+gIA6gsA6gsA6gsAqC8AqC8AoL4AoL4AgPoCgPoCgPoCAOoLAOoLAKgvAKgvAKC+AKC+AID6AoD6AoD6AgDqCwDqCwCoLwCoLwCgvgCgvgCgvgCA+gKA+gIA6gsA6gsAqC8AqC8AqC8AoL4AoL4AgPoCgPoCAOoLAOoLAKgvAKgvAKgvAKC+AKC+AID6AoD6AgDqCwDqCwDqCwCoLwCoLwCgvgCgvgCA+gKA+gKA+gIA6gsA6gsAqC8AqC8AoL4AoL4AoL4AgPoCgPoCAOoLAOoLAKgvAKgvAKC+AKC+AKC+AID6AoD6AgDqCwDqCwCoLwCoLwCoLwCgvgCgvgCA+gKA+gIA6gsA6gsA6gsAqC8AqC8AMCn/F2AAGJdT04NaH+8AAAAASUVORK5CYII="},nHtH:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return u});var s=n("yIs4"),i=n("wd/R"),c=n.n(i),l=(n("XDpg"),n("dF9M")),r=n("sTQd");function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:(new Date).getTime(),n=2<arguments.length?arguments[2]:void 0,i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(!Object(s.default)(e)||!e)return"";e=e<1e12?1e3*e:e,i&&t<e&&(t=e);var r=c()(e),o=c()(t);if(!e||r.isSame(o,"day"))return n?r.format(l.a.TODAY):r.from(o);var a=o.clone().subtract(1,"day");return r.isSame(a,"day")?r.format(l.a.YESTERDAY):r.isSame(o,"year")?r.format(l.a.SAME_YEAR):r.format(l.a.BEFORE_YEAR)}function a(e){return c.a.duration(1e3*e).humanize()}function u(e,t){return e&&"number"==typeof e?o(Object(r.a)(e),(new Date).getTime(),!!t):""}},nMtL:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return p});var i,r,o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("U+yc"),u=n.n(l),f=n("y2sV"),d=9,h="0",p=(i=Object(f.J)(200),r=function(){function t(e){var u=this;a()(this,t),this.aceKeyEvent=function(e,t){var n=t.evt,i=u.editor,r=i.performSelectionChange,o=i.doIndentOutdent,a=i.doTabKey,s=n.keyCode;if("keydown"!==n.type||s!==d||n.metaKey||n.ctrlKey)return!1;u.editor.fastIncorp();var c,l=u.editor.getRep();return l&&l.zoneId===h&&l.selStart&&0<l.selStart.length&&0===l.selStart[0]&&1<l.lines.length()?(c=[1,l.lines.atIndex(1).lineMarker],l.selEnd&&0<l.selEnd.length&&0!==l.selEnd[0]?o(l.zoneId,n,c,l.selEnd):r(l.zoneId,c,c)):a(n),n.preventDefault(),!0},this.doIndent=function(e){u.editor.inCallStackIfNecessary("fastIncorp",function(){u.editor.fastIncorp()}),u.editor.doTabKey({shiftKey:e,stopImmediatePropagation:function(){}})};var n=this;this.editor=e.editor,this.editor.registerCommand("indentleft",function(e,t){n.doIndent(!0)}),this.editor.registerCommand("indentright",function(e,t){n.doIndent()})}return c()(t,[{key:"editorWillDoReturnKey",value:function(e){var t,n,i=e.delta,r=e.editor,o=r.getContentState().getActiveZone(),a=o.getZoneId(),s=r.selection.getSelection(),c=o.getLine(s.start.line),l=c.getLineAttributes().toMap(),u=s.toPosition(),d=u.start,h=u.len;l["text-indent"]&&!h&&(t=c.isEmpty(),n=new f.E({zoneId:a}),l["text-indent"]="",t?i.ops.length||n.retain(d-1).retain(1,l):i.ops.length?n.retain(d+1).retain(1,l):n.retain(d).insertEnter().insertLineMarker(l),e.delta=i.compose(n))}},{key:"editorWillDoDeleteKey",value:function(e){var t,n=e.deltaSet,i=e.editor,r=i.getContentState().getActiveZone(),o=r.getZoneId(),a=i.selection.getSelection(),s=r.getLine(a.start.line).getLineAttributes().toMap(),c=1===a.start.offset,l=a.toPosition(),u=l.start,d=l.len;!n.get(o).ops.length&&s["text-indent"]&&c&&!d&&(s["text-indent"]="",t=new f.E({zoneId:o}).retain(u-1).retain(1,s),e.deltaSet=n.compose(t))}}]),t}(),u()(r.prototype,"editorWillDoDeleteKey",[i],Object.getOwnPropertyDescriptor(r.prototype,"editorWillDoDeleteKey"),r.prototype),r)},nQY9:function(e,t,n){"use strict";var i=n("o0o1"),m=n.n(i),r=n("yXPU"),a=n.n(r),o=n("lwsE"),s=n.n(o),c=n("W8MJ"),l=n.n(c),u=n("2ACu");function v(t){return new Promise(function(e){return window.setTimeout(e,t)})}var b=n("XVMX"),y=n("AvAw"),E=n("t5Ac"),d=n("HIeq"),h=n("5u9u"),O=n("lZ5r");n.d(t,"a",function(){return g});var f,p,C=100;(p=f=f||{}).permise="permise",p.external="external";var g=function(){function o(e){var t=e.editor,n=e.boxType,i=e.fileType,r=e.fileToken;s()(this,o),this.editor=t,this.boxType=n,this.isDocBody="doc"===n,this.currentUserId=Object(d.d)(),this.fileType=i,this.fileToken=r}function e(e,t){return n.apply(this,arguments)}var n,t;function i(e){return t.apply(this,arguments)}return l()(o,[{key:"addMentionNotify",value:(t=a()(m.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p,g;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.userId,i=t.userName,r=t.isExternal,o=t.blockId,a=t.notNotify,s=t.blockNotify,this.isDocBody){e.next=3;break}return e.abrupt("return");case 3:if(n===this.currentUserId)return e.abrupt("return");e.next=5;break;case 5:if(a)return e.abrupt("return",Object(O.b)({notNotifyUsers:[{name:i,id:n}]}));e.next=9;break;case 9:if(s)return e.abrupt("return",Object(O.b)({blockedUsers:[{name:i,id:n}]}));e.next=11;break;case 11:if(c="user",l=this.editor,u=Object(E.a)(),d=u.externalAccess,h=Object(E.b)(),f=this.getToastType(r,d,h),p=this.getConfirmToast(f,i)){e.next=19;break}return e.abrupt("return");case 19:return y.default.register(n,p,b.a),e.next=22,v(C);case 22:return e.next=24,Promise.race([p,v(b.a)]);case 24:if(g=e.sent,b.b.CANCELED===g)return this.handleHoldBack({editor:l,collaborateType:c,blockId:o}),e.abrupt("return");e.next=28;break;case 28:return e.next=30,v(500);case 30:this.addDocBodyNotify(n,o);case 31:case"end":return e.stop()}},e,this)})),i)},{key:"getToastType",value:function(e,t,n){return e&&!t&&n?f.external:f.permise}},{key:"getConfirmToast",value:function(e,t){var n=(e===f.external?Object(b.c):Object(b.d))([t]);return n}},{key:"addMentionIdToBlock",value:function(i,r,o){var a=".block-id-".concat(i),e=function(){var e,t,n;o&&$(a).length&&(e=r.code,t=r.data.mention_id,e||void 0===t||(n=o.plugins.blockPlugin.blockInfos.get(i))&&n.instance&&n.instance.setProps({data:{mentionId:t}}))};o&&o.getInInternationalComposition()?o.call("asyncNotifyCallback",e):e()}},{key:"addDocBodyNotify",value:(n=a()(m.a.mark(function e(t,n){var i,r,o,a,s,c;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.fileType,r=this.fileToken,o=this.currentUserId,a=this.boxType,s=".block-id-".concat(n),$(s).length)return e.next=6,Object(h.a)(o,{fileType:i,fileToken:r,userId:t,source:a});e.next=9;break;case 6:(c=e.sent).data&&Object(O.b)({notNotifyUsers:c.data.not_notify_users,blockedUsers:c.data.blocked_users}),this.addMentionIdToBlock(n,c,this.editor);case 9:case"end":return e.stop()}},e,this)})),e)},{key:"handleHoldBack",value:function(e){var t=e.editor,n=e.collaborateType,i=e.blockId,r=t.plugins.blockPlugin.blockInfos.get(i),o=t.getRep(),a=o.selEnd,s=o.zoneId;r&&r.instance&&(r.instance.setProps({data:{sharePermHeldBack:!0}}),a&&(t.selection.setWithSelection(s,a,a,!0),t.selection.internalUpdateSelectionFromRep(!0)));var c=this.boxType;Object(u.default)("click_undo_permission",{collaborate_type:n,reminder_type:"toast",source:c})}}]),o}()},nVH4:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return a});var i={RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,ESC:27,BACKSPACE:8,AT:50,A:65,DELETE:46,H:72},r={UP:i.UP,DOWN:i.DOWN,LEFT:i.LEFT,RIGHT:i.RIGHT},o={IMAGE:"POPUP_IMAGE",CARD:"POPUP_CARD",TEXT:"POPUP_TEXT",SHEET:"POPUP_SHEET",BLOCK:"POPUP_BLOCK",TABLE:"POPUP_TABLE",TABLE_CELL:"POPUP_TABLE_CELL",CODE_BLOCK_V2:"CODE_BLOCK_V2",CALLOUT_BLOCK:"CALLOUT_BLOCK"},a="fake-list-number-trigger"},njD1:function(e,t,n){"use strict";n.d(t,"a",function(){return O});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("J4zp"),c=n.n(s),l=(n("SRA/"),n("YWBl")),u=n("7Kxq"),d=n("YNKm"),h=n("/MeM"),f=n("FJEn"),p=n("xYHj"),g=n("y2sV"),m=n("q1tI"),v=n.n(m),b=n("MjSh"),y={display:"block",boxSizing:"content-box",padding:"13px 0 12px",overflow:"hidden",height:"1px",backgroundOrigin:"content-box",backgroundImage:"linear-gradient(90deg, ".concat(b.N400,", ").concat(b.N400,")"),backgroundRepeat:"no-repeat",border:"0"},E=function(){var e=Object(m.useState)(!1),t=c()(e,2),n=t[0],i=t[1],r=Object(m.useCallback)(function(){i(!0)},[i]),o=Object(m.useCallback)(function(){i(!1)},[i]),a=n?Object.assign({},y,{backgroundImage:"linear-gradient(90deg, ".concat(b.B500,", ").concat(b.B500,")")}):y;return v.a.createElement(g.l,{leftZeroSpace:!1,contentEditable:!1,style:a,"data-faketext":" ",onSelect:r,onDeselect:o})},O=function(){function t(e){var u=this;r()(this,t),this.name="horizontal-line",this.className="Horizontal",this.match=function(e){return e===u.name},this.aceInitialized=function(e,t){var n=t.editorInfo;u.editorInfo=n,u.register(n),u.documentAttributeManager=t.documentAttributeManager,n.doInserHorizontalLine=u.doInserHorizontalLine},this.aceAttribsToClasses=function(e,t){if(-1<t.key.indexOf("horizontal-line"))return"horizontal-line"},this.doInserHorizontalLine=function(e){var t=e.getRep(),n=t.selStart,i=t.selEnd,r=e.getLineListType(t.zoneId,n[0]),o=t.lines.atIndex(n[0]).lineMarker,a=n[0]===i[0]&&n[1]===i[1],s=i[0]===t.alines.length-1;a?i[1]!==o&&t.lines.isEndOfLine(i[0],i[1])?s?(e.performDocumentReplaceRangeWithAttributes(t.zoneId,n,i,"\n\n"),e.performDocumentReplaceRangeWithAttributes(t.zoneId,[i[0]+1,0],[i[0]+1,0]," ",[h.b])):(e.performDocumentReplaceRangeWithAttributes(t.zoneId,n,i,"\n",[]),e.performDocumentReplaceRangeWithAttributes(t.zoneId,[i[0]+1,0],[i[0]+1,0]," ",[h.b]),e.selection.setWithSelection(t.zoneId,[n[0]+2,0],[n[0]+2,0],!1),e.updateBrowserSelectionFromRep()):0===i[0]&&0===i[1]&&t.zoneId===f.DEFAULT_REP_ZONE?e.performDocumentReplaceRangeWithAttributes(t.zoneId,[n[0],0],[i[0],0],["\n"," ","\n"],[h.b]):i[1]===o?e.performDocumentReplaceRangeWithAttributes(t.zoneId,n,i,[" ","\n"],[h.b]):o&&i[1]===o?(e.performDocumentReplaceRangeWithAttributes(t.zoneId,[n[0],o],[n[0],o],"\n"),e.performDocumentReplaceRangeWithAttributes(t.zoneId,[n[0]+1,0],[n[0]+1,0],[" ","\n"],[h.b])):(e.performDocumentReplaceRangeWithAttributes(t.zoneId,n,i,"\n\n"),e.performDocumentReplaceRangeWithAttributes(t.zoneId,[n[0]+1,0],[n[0]+1,0]," ",[h.b]),r&&e.renumberList(t.zoneId,i[0]+3)):(e.performDocumentReplaceRangeWithAttributes(t.zoneId,n,i,"\n\n"),e.performDocumentReplaceRangeWithAttributes(t.zoneId,[n[0]+1,0],[n[0]+1,0]," ",[h.b])),r&&e.renumberList(t.zoneId,i[0]+2)},this.aceRegisterBlockElements=function(){return["hr"]},this.aceCreateDomLine=function(e,t){var n;-1<t.spanClass.indexOf("horizontal-line")&&(n={contenteditable:"false"},t.lineClass+=" single-line",t.attributes=Object.assign({},t.attributes,{},n),t.rawHtml='<hr class="horizontal-line" data-faketext="'.concat(t.text,'"/>'))},this.render=function(e){return e.class+=" horizontal-line",v.a.createElement(E,null)},this.handleSelectionChange=function(e){var t,n,i,r,o,a,s,c,l=e.current;l.isCollapsed()&&(n=(t=l.start).zoneId,i=t.line,(r=u.editor.getContentState().getZoneState(n).getLine(i)).getAttributes().toMap()[u.name]&&(o=l.start,a=l.end,s=r.getModelText().length-1,c=new g.q({editor:u.editor,start:Object.assign({},o,{offset:r.getLineMarker()}),end:Object.assign({},a,{offset:Math.min(s,r.getLineMarker()+1)})}),u.editor.selection.setSelection(c)))},e&&(this.editor=e,this.register(e),this.aceInitialized("",Object.assign({editorInfo:e},e)),e.on(g.k.SELECTION_CHANGE,this.handleSelectionChange))}return a()(t,[{key:"reset",value:function(){this.editorInfo=null,this.documentAttributeManager=null}},{key:"register",value:function(e){e.registerAceCommand(d.I,function(e,t,n,i){var r=i.source;t.doInserHorizontalLine(t),Object(l.a)({action:"insertseparator",op:u.f,source:r})},{statusKey:null})}},{key:"setHTMLWhenOnlySelectHorizontalLine",value:function(e){var t,n,i=e.rep,r=i.selStart,o=i.selEnd,a=i.selStart[0];r[0]!==o[0]||!Object(p.k)(i,a)||(n=(t=i.lines.atIndex(a))&&t.lineNode)&&(e.html=n.outerHTML)}},{key:"aceCopy",value:function(e,t){this.setHTMLWhenOnlySelectHorizontalLine(t)}},{key:"aceCut",value:function(e,t){this.setHTMLWhenOnlySelectHorizontalLine(t)}},{key:"serialize",value:function(e){var t,n,i=e.type,r=e.op,o=r&&r.attributes&&r.attributes["horizontal-line"];return i===g.u.LEAF&&o&&((t=document.createElement("span")).classList.add("horizontal-line"),(n=document.createElement("hr")).classList.add("horizontal-line"),t.appendChild(n),e.node=t),e}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,i=e.zoneId,r=new g.e;if(t instanceof HTMLElement){var o=t.tagName,a=t.className;if("SPAN"===o&&a.includes("horizontal-line"))return n.forEach(function(e,t){var n;r=t===i&&e instanceof g.E?((n=e.create(e)).insert(" ",{"horizontal-line":"true"}),r.concat(n)):r.concat(e)}),r}return n}}]),t}()},nuq8:function(e,t,r){"use strict";r.d(t,"b",function(){return c}),r.d(t,"a",function(){return u});var n=r("o0o1"),o=r.n(n),i=r("yXPU"),a=r.n(i),s=null;function c(e){return l.apply(this,arguments)}function l(){return(l=a()(o.a.mark(function e(t){var n,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s)return s.onmessage=t,e.abrupt("return",s);e.next=3;break;case 3:return e.next=5,Promise.all([r.e("doc_index_css"),r.e("chunk_adit"),r.e("commons--doc_index_delay--voteEmoji--votePicker"),r.e(16),r.e("commons--doc_index_delay--jira"),r.e("doc_index_delay")]).then(r.t.bind(null,"O8gP",7));case 5:return n=e.sent,i=n.default,(s=new i).onmessage=t,e.abrupt("return",s);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function u(){s&&s.terminate(),s=null}},"nyf+":function(e,t,n){"use strict";t.a={aceCreateDomLine:function(e,t){var i,r,n,o,a=t.spanClass;0<=a.indexOf("tag")&&(r=[],(i=a).replace(/(^| )tag:([bisu])/g,function(e,t,n){return r.push(n.toLowerCase()),i=i.replace(e,""),t+n}),o=n="",0<r.length&&(r.sort(),n=n+"<"+r.join("><")+">",r.reverse(),o="</"+r.join("></")+">"+o),t.spanClass="".concat(i," ").concat(r.join(" ")),t.extraOpenTags="".concat(t.extraOpenTags).concat(n),t.extraCloseTags="".concat(o).concat(t.extraCloseTags))}}},oGkr:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},t),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.7 17.5c.17 0 .3.13.3.3v.9a.3.3 0 01-.3.3h-9.4a.3.3 0 01-.3-.3v-.9c0-.17.13-.3.3-.3h9.4zm0-6.5c.17 0 .3.13.3.3v.9a.3.3 0 01-.3.3h-9.4a.3.3 0 01-.3-.3v-.9c0-.17.13-.3.3-.3h9.4zM5.75 4.28c.14 0 .25.12.25.26V8.2c0 .14-.11.25-.25.25h-.5A.25.25 0 015 8.2V5.5l-.72.36A.18.18 0 014 5.72v-.68c0-.1.05-.18.14-.22l.95-.5a.25.25 0 01.13-.04h.53zM19.7 5c.17 0 .3.13.3.3v.9a.3.3 0 01-.3.3h-9.4a.3.3 0 01-.3-.3v-.9c0-.17.13-.3.3-.3h9.4zM4.9 11h.7c.22 0 .4.14.4.31v5.6l1.15-1.15c.18-.18.45-.2.6-.05l.5.5c.16.15.14.43-.04.6l-2.6 2.6a.53.53 0 01-.07.07.36.36 0 01-.17.07.39.39 0 01-.37-.09l-.5-.5-.02-.02-2.13-2.13c-.18-.18-.2-.45-.04-.6l.5-.5c.15-.16.42-.14.6.04l1.09 1.08v-5.52c0-.17.18-.31.4-.31z",fill:"#2B2F36"}))}},oJoF:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o});var i="DOC_TIMING_AFTER_FIRST_SCREEN",r="DOC_TIMING_ON_DOC_STAGE_DONE",o="DOC_TIMING_ON_DOC_STAGE_DONE_AND_EDITABLE"},oXmN:function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),d=n("3Hq1"),p=n("Jmo2"),o=n("iP/4"),g=n("YWBl"),a=n("OX8E"),h=n("KJZc"),f=n("Z5sO"),s="shortKeysTeaFor",m=o.a.isMac,c=function e(t){var u=this;r()(this,e),this.editor=t,this.actions={},this.aceKeyEvent=function(e,t){var n,i,r=t.evt,o=r.type,a=r.keyCode,s=r.metaKey,c=r.ctrlKey,l=r.shiftKey;"keydown"===o&&(n=m?s:c,i=u.actions[u.getHandlerKey(a,l,n)],Object(d.default)(i)||i===p.a||Object(f.b)(function(){var e="copy"===i?Object(h.a)(u.editor,u.editor.getRep()):null;Object(g.a)({action:i,extraParams:e})}))},this.actionsRegister=function(){p.b.forEach(function(e){var t=e.action,n=e.keyCode,i=e.isCtrlOrCmd,r=e.isShift;u.actions[u.getHandlerKey(n,r,i)]=t})},this.getHandlerKey=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return"".concat(s,"KeyCode").concat(e,"IsShift").concat(t,"IsCtrl").concat(n)},this.logPasteSource=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o={word:"content=Word.Document",excel:"content=Excel.Sheet",ppt:"content=PowerPoint.Slide",google_docs:'id="docs-internal-guid-',google_spreadsheet:'name="generator" content="Sheets"',table_in_doc:"data-ace-table-col-widths",space_bitable:'<table class="byte-bitable"',space_sheet:'<table data-type="byte-sheet"',web_pages:"</table>"},a={paste_source:"",paste_cotent_type:"has_table",paste_to_type:"table_in_doc",op_item:0},s=t.find("table"),c=s?s.length:0;if((i||!c)&&!r){var l={action:p.a};return/block-type-ISV_BLOCK/.test(e)&&(l.paste_cotent_type="has_blockit"),void Object(g.a)(l)}a.op_item=c;for(var u=0,d=Object.keys(o);u<d.length;u++){var h=d[u];if(-1!==e.indexOf(o[h])){a.paste_source=h;break}}var f=[];n<c&&f.push("table"),0<n&&f.push("sheet"),0<r&&(a.paste_source="bitable_in_doc",f.push("bitable")),0<f.length&&(a.paste_cotent_type=["has"].concat(f).join("_"),a.paste_to_type=[].concat(f,["in_doc"]).join("_")),Object(g.a)({action:p.a,extraParams:a})},this.reset=function(){u.actions={}},this.actionsRegister(),a.a.on("PASTE_TO_DOC",this.logPasteSource)};t.a=c},okfw:function(e,t,n){"use strict";var i=n("J4zp"),o=n.n(i),r=n("lSNA"),V=n.n(r),a=n("U5G9"),s=n("H6oK"),c=n("mRaX"),W=Object(a.b)({module:a.a.HISTORY}),K="=",Z="+",q="-",Y=function(e){var t=e.match(/\n/g);return t?t.length:0},J={getInitAlines:function(e,t,n,i){var r={text:e,attribs:t},o=W.smartOpAssembler(),a=W.newOp("-");a.chars=0,a.lines=0,o.append(a),a.chars=0,a.lines=0,o.append(a),W.appendATextToAssembler(r,o);var s=1+o.getLengthChange(),c=W.pack(1,s,o.toString(),r.text.slice(0,-1)),l=W.moveOpsToNewPool(c,n,i),u=W.splitAttributionLines(W.makeAttribution("\n"),"\n");return W.mutateAttributionLines(l,function(){return u},i),u},deleteAuthorInfo:function(e,t,n){for(var i=J.unpack(e,t),r=W.opIterator(i.ops),o=W.opAssembler(),a=i.itemType,s=function(){var e=r.next(),t=[];W.eachAttribNumber(e.attribs,function(e){"author"!==n.getAttribKey(e)&&t.push(W.numToString(e))}),e.attribs=0<t.length?"*".concat(t.join("*")):"",o.append(e)};r.hasNext();)s();return W._pack(V()({},t,{itemType:a,oldLen:i.oldLen,newLen:i.newLen,ops:o.toString(),charBank:i.charBank}))},changeBlockIdForCS:function(e,t,n){var i=J.unpack(e,t),r=i.itemType,o=J.getChangeBlockIdForOp(i.ops,n);return W._pack(V()({},t,{itemType:r,oldLen:i.oldLen,newLen:i.newLen,ops:o,charBank:i.charBank}))},getEditDelAttribNumList:function(r){var e=Object.keys(r.numToAttrib).reduce(function(e,t){var n,i=Number(t);return"__edit_del"===o()(r.numToAttrib[t],1)[0]&&(n=W.numToString(i),e.add(n)),e},new Set);return Array.from(e)},getChangeBlockIdForOp:function(e,r){for(var t=W.opIterator(e),n=W.opAssembler(),i=J.getEditDelAttribNumList(r),o=new RegExp("\\*(".concat(i.join("|"),")(\\*|$)"),"ig");t.hasNext();){var a=t.next();a.opcode===Z&&a.attribs&&0<i.length&&o.test(a.attribs)&&function(){var i=[];W.eachAttribNumber(a.attribs,function(e){var t,n;r.getAttribKey(e)===s.BLOCK_DATA_META_BLOCK_PROPS?((t=JSON.parse(r.getAttribValue(e))).blockId+="-fake-".concat(Object(c.h)()),n=r.putAttrib([s.BLOCK_DATA_META_BLOCK_PROPS,JSON.stringify(t)]),i.push(W.numToString(n))):i.push(W.numToString(e))}),a.attribs=0<i.length?"*".concat(i.join("*")):""}(),n.append(a)}return n.toString()},inverseChangeset:function(e,c,l,u){return W._checkRep(W.csMapPack(e,function(e,t){if("Z"===t.itemType){var n=c[e],i=["\n"],r=["|1+1"];return n&&n.lines&&(i=n.lines),n&&n.alines&&(r=n.alines),W.inverse(t,i,r,u)}var o=l[e],a=o?[o.vectorIds]:[[]],s=o?o.alines:[""];return W.inverse(t,a,s,u)}))},reverseChangeset:function(e,c,l,u){return W.csMapPack(e,function(e,t){if("Z"===t.itemType){var n=c[e],i=["\n"],r=["|1+1"];return n&&n.lines&&(i=n.lines),n&&n.alines&&(r=n.alines),W.reverse(t,i,r,u)}var o=l[e],a=o?[o.vectorIds]:[[]],s=o?o.alines:[""];return W.reverse(t,a,s,u)})},unpack:function(e,t){return W.unpack(e)[t]},computeDiffChangeset:function(e,t,n,i,r){var o,a=W.formatCs(J.reverseChangeset(e,n,i,r)),s=W.formatCs(e),c={};for(o in s){var l,u,d,h,f,p,g,m,v,b=a[o],y=s[o],E=void 0,E=t?W.addAttributesToChangesetByOp(J.deleteAuthorInfo(y,o,r),o,r,[["__edit_add","true"],["author",t]],["+"]):W.addAttributesToChangesetByOp(y,o,r,[["__edit_add","true"]],["+"]),O=W.addAttributesToChangesetByOp(J.deleteAuthorInfo(b,o,r),o,r,[["__edit_del","true"],["author",t]],["+"]),C=J.changeBlockIdForCS(O,o,r),k=J.unpack(E,o),I=J.unpack(C,o),S=W.smartOpAssembler(),T=k.itemType,_="Z"===T,w=W.bankAssembler(T),j=W.bankIterator(k.charBank),M=W.bankIterator(I.charBank),L=0,R=W.opIterator(k.ops),N=W.opIterator(I.ops),D=R.next(),x=N.next();do{if(!D.opcode||!x.opcode)break;if(D.opcode!==K)if(D.opcode!==Z){if(D.opcode!==q){console.error("computeDiffChangeset error");break}if(x.opcode!==Z){console.error("changeset and its reverse changeset mismatched, changeset=".concat(y));break}x.chars<=D.chars?(u=void 0,(l=W.opAssembler()).opcode=q,_?(u=n[o].alltext.slice(L,L+x.chars),l.lines=Y(u)):l.lines=0,l.chars=x.chars,l.attribs="",S.append(l),S.append(x),d=M.take(x.chars),w.append(d),D.chars-=x.chars,L+=x.chars,_?(u=n[o].alltext.slice(L,L+D.chars),D.lines=Y(u)):D.lines=0,0===D.chars&&(D=R.next()),x=N.next()):(S.append(D),h=M.take(D.chars),(f=W.opAssembler()).opcode=Z,f.chars=D.chars,f.lines=_?Y(h):0,f.attribs=x.attribs,S.append(f),w.append(h),x.chars-=D.chars,_?(h=M.peek(x.chars),x.lines=Y(h)):x.lines=0,L+=D.chars,D=R.next())}else{if(x.opcode!==q){console.error("changeset and its reverse changeset mismatched, changeset=".concat(y));break}D.chars<=x.chars?(S.append(D),p=j.take(D.chars),w.append(p),x.chars-=D.chars,0===x.chars&&(x=N.next()),D=R.next()):(g=M.take(x.chars),(m=W.opAssembler()).opcode=Z,m.chars=x.chars,m.lines=_?Y(g):0,m.attribs=D.attribs,S.append(m),w.append(g),D.chars-=x.chars,_?(v=j.peek(D.chars),D.lines=Y(v)):D.lines=0,x=N.next())}else{if(x.opcode!==K){console.error("changeset and its reverse changeset mismatched, changeset=".concat(y));break}var P,B,U,z=D.chars<=x.chars?x:D,H=D.chars<=x.chars?D:x;S.append(H),z.chars-=H.chars,_?(P=n[o].alltext,B=Y(P.slice(L+H.chars)),U=Math.max(z.lines-B,0),z.lines=U):z.lines=0,L+=H.chars,z===D?(0===D.chars&&(D=R.next()),x=N.next()):(0===x.chars&&(x=N.next()),D=R.next())}}while(D&&x&&D.opcode&&x.opcode);S.endDocument();var F=k.oldLen;c[o]=W._pack(V()({},o,{itemType:T,oldLen:F,newLen:F+S.getLengthChange(),ops:S.toString(),charBank:w.toResult()}))}return W.formatCsFromObj(c)}};t.a=J},omim:function(e,l,u){"use strict";(function(e){u.d(l,"a",function(){return a}),u.d(l,"g",function(){return s}),u.d(l,"d",function(){return r}),u.d(l,"c",function(){return i}),u.d(l,"f",function(){return o}),u.d(l,"e",function(){return c});var t=u("iP/4"),n=u("k7EW");u.d(l,"b",function(){return n.a});var i=e||t.a.isLarkWindow,r=t.a.isLark&&!/electron/i.test(navigator.userAgent),o=e&&r&&n.b,a=!0;r?a=n.b:i&&(a=n.a);var s=i&&!n.a,c=!r&&e&&n.a}).call(this,u("kCIs"))},ouE1:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return E});var i=n("RIqP"),g=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),m=n("HmyT"),c=n("FJEn"),v=n("mRaX"),b=n("PX10"),y=(n("NdYY"),"mention-placeholder"),E="".concat(c.config.LOCAL,"-").concat(y),O="data-placeholder",l=function(){function e(){o()(this,e),this.enable=!1,this.textWidthMap=Object.create(null)}return s()(e,[{key:"setEnable",value:function(e){this.enable=e}},{key:"getEnable",value:function(){return this.enable}},{key:"show",value:function(e,t){var n={cursor_position:"middle",show_placeholder:0};if(!this.enable)return n;var i=e.getSelectedRep();if(!i||!i.selEnd)return n;var r=i.zoneId,o=i.lines,a=i.selEnd,s=a[0],c=0<a[1]?a[1]:1,l=o.atIndex(s);if(!l)return n;var u=l.width-1===c;if(n.cursor_position=u?"end":0===c?"beginning":"middle",n.show_placeholder=1,!this.checkHasEnoughWidth(e,t)||!u)return n.show_placeholder=0,this.hide(!1),n;var d,h,f,p=Object(m.$)(".".concat(y));return p.length?e.getObserver().withoutRecordingMutations(function(){return p.attr(O,t)}):(h=(d=e.getAttributesOnSelection(r,i).attribs)&&d.find(function(e){return e[0]===E}),f=l&&"@"===l.text[1<=c?c-1:0],h||Object(b.e)(e,[s,c-1],[s,c],f?l.text[c-1]:v.c,[].concat(g()(this.filterAttr(d)),[[E,!0]]))),n}},{key:"hide",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=Object(m.$)(".".concat(y));t.removeAttr(O),e&&t.removeClass(y)}},{key:"checkHasEnoughWidth",value:function(e,t){var n=e.getSelectedRep();if(!n)return!1;var i=n.zoneId,r=n.selEnd,o=n.lines;if(!r)return!1;var a,s,c,l=r[0],u=0<r[1]?r[1]:1,d=o.atIndex(l),h=e.getAllAttributesOnLine(i,l),f=h.find(function(e){return"align"===e[0]}),p=f&&1<f.length?f[1]:"left";return!(!d||!d.lineNode||"right"===p)&&(c=!!h.find(function(e){return"list"===e[0]})?(a=Object(m.$)(".".concat(y))[0],s=Object(m.$)(d.lineNode).find("li")[0]||Object(m.$)(d.lineNode).find("code")[0],a&&s?s.getBoundingClientRect().right-a.getBoundingClientRect().right:d.lineNode.offsetWidth-d.getCharRect(u).left):d.lineNode.offsetWidth-d.getCharRect(u).left,"center"===p&&(c/=2),c>this.getTextWidth(t,d))}},{key:"getTextWidth",value:function(e,t){var n=parseFloat(Object(m.$)(t.lineNode).css("font-size"));return this.textWidthMap[e]||(this.textWidthMap[e]=Object.create(null)),this.textWidthMap[e][n]||(this.textWidthMap[e][n]=Object(v.k)([e],1,n)),this.textWidthMap[e][n]}},{key:"filterAttr",value:function(e){return e.filter(function(e){return["backcolor","bold","inline-code","italic","underline","strikethrough","author","at-holder","lineguid"].includes(e[0])||Object(v.M)(e[0])||e[0].includes("at-uuid_")})}}]),e}();t.c=new l},ozNJ:function(e,Z,q){"use strict";(function(m){q.d(Z,"b",function(){return U}),q.d(Z,"a",function(){return z});var e,t=q("lwsE"),n=q.n(t),i=q("W8MJ"),r=q.n(i),o=q("a1gu"),a=q.n(o),s=q("Nsbk"),c=q.n(s),l=q("7W2i"),u=q.n(l),d=q("lSNA"),v=q.n(d),h=q("q1tI"),b=q.n(h),f=q("TSYQ"),y=q.n(f),p=q("bf0L"),g=q("/OTu"),E=q("nHtH"),O=q("1PvN"),C=(q("Z7ZV"),q("n/R6")),k=q("kGVy"),I=q("fZmJ"),S=q("GEp8"),T=q("79iT"),_=q("Vr4U"),w=q("O9F5"),j=q("6jTl"),M=q("XDkv"),L=q("2ACu"),R=q("4Jzg"),N=q("uOFk"),D=(q("kSYH"),q("OX8E")),x=q("Q3NX"),P=q("DVUE"),B=q("kS6I"),U="REVERT_REMOTE",z="REVERT_LOCAL",H=(e={},v()(e,"".concat(z),m("history.restore_local")),v()(e,"".concat(U),m("history.restore")),e),F=200,V="history-replaying",W="J-replaying",K=function(e){function t(e){var f;return n()(this,t),(f=a()(this,c()(t).call(this,e))).handleKeydownInModal=function(e){var t;!e.metaKey||"a"!==e.key||(t=$(".doc-history-revert__wrap")[0])&&(Object(x.a)(t),e.preventDefault(),e.stopImmediatePropagation())},f.getContainerRef=function(e){f.containerRef=e},f.renderOverview=function(){setTimeout(function(){f.replay.renderOverview(),f.scrollToEditDom()})},f.renderNext=function(){setTimeout(function(){f.setState({replaying:!0}),f.replay.renderNext(),f.scrollToEditDom()})},f.renderPrev=function(){setTimeout(function(){f.replay.renderPrev(),f.scrollToEditDom()})},f.onInit=function(e){f.editor=e,f.replay.setEditor(e),f.hooks=e.hooks,f.replay.setHooks(f.hooks),f.replay.renderOverview();var t={container:f.containerRef};f.hooks.callAll("historyRevertModal_didMount",t);var n=f.replay.changes&&1<f.replay.changes.length;f.setState({hasMultipleChanges:n})},f.fetchRevertHistory=function(){var e=f.props.type,t=f.props,n=t.historyId,i=t.metaId,r=t.editor;if(e===U)return I.a.fetchRevertHistory({historyId:n,metaId:i});var o=f.props,a=o.userId,s=o.token;return k.a.fetchRevertHistory({historyId:n,userId:a,token:s,hooks:r.hooks})},f.setReplayingColor=function(t){var n=Object(M.b)(t);[".__edit .name "].forEach(function(e){w.a.insertRule(".".concat(W," .author-").concat(t).concat(e," { background-color: ").concat(n,"!important; }"),"".concat(V,"-").concat(e))});var i=Object(M.a)(n);[".__edit_del .inner",".__edit--show-hightlight .inner",".__edit_add .inner",".__edit_add .J-history-border",".__edit_add.J-history-border",".__edit_add .image-container",".__edit_add.ace-table-cell"].forEach(function(e){w.a.insertRule(".".concat(W," .author-").concat(t).concat(e," { background-color: ").concat(i,"!important; }"),"".concat(V,"-").concat(e))}),[".__edit.horizontal-line hr"].forEach(function(e){w.a.insertRule(".".concat(W," .author-").concat(t).concat(e," { outline-color: ").concat(i,"!important; }"),"".concat(V,"-").concat(e))}),[".ace-table-cell.__edit .inner"].forEach(function(e){w.a.insertRule(".".concat(W," .author-").concat(t).concat(e," { background-color: transparent!important; }"),"".concat(V,"-").concat(e))})},f.unsetReplayingColor=function(){w.a.deleteRulesByRegExp(new RegExp(V),!0)},f.handleRevertClick=function(e){var t,n,i,r,o,a,s,c,l,u;!f.state.reverting&&f.state.clientVars&&(t=e.currentTarget,i=(n=f.props).type,r=n.historyTime,o=Object(E.a)(Number(r)),a=m(i===U?"history.confirmModal.title":"history.restore_local"),s=m(i===U?"history.confirmModal.message":"history.confirmModalLocal.message",o),i===U&&(c=f.replay.changes,l=f.state.replaying?f.replay.curIndex:c.length-1,Object(L.collectSuiteEvent)("click_history_restore",{block_id:"",block_type:"",revision_id:c&&c[l]&&c[l].revision})),u=function(){f.setState({reverting:!0},function(){f.revert(t).then(function(){f.props.onClose(null,!0)}).catch(function(e){f.setState({reverting:!1}),C.a.error({closable:!0,content:e.msg||m("etherpad.server_desert")})})})},j.a.show({title:a,body:s,confirmText:H[i],cancelText:m("history.cancel"),onConfirm:u}))},f.revert=function(e){var t=f.props,n=t.type,i=t.historyId,r=t.memberId,o=t.token,a=t.editor;if(n!==U)return k.a.revert(e,f.state.clientVars);var s=f.state,c=s.clientVars,l=s.progress,u=s.replaying;if(!c||!c.changes)return Promise.reject("not changes");var d=f.replay.changes,h=u?d[l-1]:d[d.length-1];return h?I.a.revert(e,{historyId:i,memberId:r,metaId:h.metaId,token:o,revision:h.revision,editor:a}):Promise.reject("not change meta")},f.handleReplayClick=function(){f.setState({progress:1,replaying:!0},function(){f.replay.renderNext();var e,t,n=f.state.clientVars&&f.state.clientVars.changes;n&&(e=n[n.length-1],t=n[0],Object(L.collectSuiteEvent)("click_history_playback",{last_revision:e.revision,first_revision:t.revision}))})},f.handlePrevClick=function(){var e=f.state.progress-1;f.setState({progress:e},function(){f.replay.renderPrev(),f.collectReplayRuningEvent("back")})},f.handleNextClick=function(){var e=f.state.progress+1;f.setState({progress:e},function(){f.replay.renderNext(),f.collectReplayRuningEvent("head")})},f.collectReplayRuningEvent=function(e){var t,n=f.replay.changes;n&&(t=n[f.replay.curIndex],Object(L.collectSuiteEvent)("click_playback_running",{direction:e,revision_id:t.revision,block_id:"",block_type:""}))},f.offsetTopToNode=function(e,t){for(var n=e.offsetParent,i=e.offsetTop;n&&n!==t;)i+=n.offsetTop,n=n.offsetParent;return i},f.scrollToEditDom=function(){var e,t,n,i;f.editor&&f.containerRef&&(e=f.editor.getDocBody(),t=f.containerRef,(n=e.querySelector(".__edit"))&&(i=f.offsetTopToNode(n,e)-Math.floor(t.offsetHeight/2)+F,f.containerRef.scrollTop=i))},f.state={replaying:!1,reverting:!1,clientVars:null,progress:0,errorMsg:"",initClientVars:null,hasMultipleChanges:!1},f}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){var i=this;this.containerRef&&($(document.body).on("keydown",this.handleKeydownInModal),O.a.showLoading(".doc-history-revert__wrap"),this.fetchRevertHistory().catch(function(e){throw i.setState({errorMsg:m("history.server_error")}),e}).then(function(e){var t,n;i.containerRef&&(t={},e.entities&&(n=e.entities.users,Object.keys(n).forEach(function(e){t[e]=Object(g.a)(n,e),i.setReplayingColor(e)})),p.a.userNames=t,i.replay=S.b.create({clientVars:e.clientVars,root:i.containerRef,scrollToEditDom:i.scrollToEditDom}),i.setState({clientVars:e.clientVars,initClientVars:i.replay.initClientVars}))}).catch(function(e){i.state.errorMsg||i.setState({errorMsg:m("history.algorithm_error")}),console.error(e)}).finally(function(){O.a.hideLoading(".doc-history-revert__wrap")}))}},{key:"componentWillUnmount",value:function(){var e;this.replay&&this.replay.destroy(),this.hooks&&(e={container:this.containerRef},this.unsetReplayingColor(),this.hooks.callAll("historyRevertModal_willUnmount",e),$(document.body).off("keydown",this.handleKeydownInModal))}},{key:"render",value:function(){var e=this.state,t=e.replaying,n=e.reverting,i=e.progress,r=e.errorMsg,o=e.initClientVars,a=e.hasMultipleChanges,s=this.props,c=s.type,l=s.onClose,u=c===U,d=Object(E.c)(1e3*this.props.historyTime),h=u?d:m("history.local_restore.preview",d),f=y()({inactive:!this.enableLeft}),p=y()({inactive:!this.enableRight}),g=y()("doc-history-revert__wrap","syntax","flex",v()({},W,t));return b.a.createElement("div",{className:"doc-history-revert-modal"},b.a.createElement("div",{className:"doc-history-revert J-doc-history doc-history-common layout-column"},b.a.createElement("div",{className:"doc-history-revert__bar layout-row"},b.a.createElement("span",{className:"doc-history-revert__description"},h),u&&b.a.createElement("div",{className:"doc-history-revert__operation layout-row layout-cross-center"},b.a.createElement("span",{className:"doc-history-revert__total"},m("history.total_changes",this.total)),!r&&!t&&a&&b.a.createElement("span",{className:"doc-history-revert__replay-btn",onClick:this.handleReplayClick},m("history.replay")),t&&b.a.createElement("div",{className:"doc-history-revert__progress layout-row layout-cross-center"},b.a.createElement("button",{onClick:this.handlePrevClick,className:f,disabled:!this.enableLeft},b.a.createElement(R.a,null)),b.a.createElement("span",{className:"count"},i,"/",this.total),b.a.createElement("button",{onClick:this.handleNextClick,className:p,disabled:!this.enableRight},b.a.createElement(N.a,null)))),b.a.createElement("div",{className:"historyRevoked-f g-tr"},b.a.createElement("button",{className:"cp-btn close",onClick:l},b.a.createElement("span",null,m("history.cancel"))),b.a.createElement("button",{className:"cp-btn cp-btn-primary ok",onClick:this.handleRevertClick},b.a.createElement("span",{className:"historyRevoked-restore-btn"},H[c])))),this.state.errorMsg?b.a.createElement("div",{className:"doc-history-revert__error"},this.state.errorMsg):b.a.createElement("div",{className:g,ref:this.getContainerRef},o?b.a.createElement(P.a,{className:"doc-history-revert__content innerdocbody syntax flex",role:"application",spellCheck:!1,contentEditable:!1,editable:!1,copyable:Object(B.f)(B.b.FILE_COPY),idleWorkTimer:!1,autoCorrect:"false",clientVars:o,enableVirtualScroll:!1,onInit:this.onInit,scroller:document.querySelector(".doc-history-revert__wrap"),registerPlugin:function(e){return e.pure=!0,e.containerCls=".doc-history-revert",[new _.default(Object.assign({editor:e},e,{type:"doc",postAddMentionId:!1,hoverArea:".doc-history-revert__editot",showChatCards:!1,source:"hostory",container:".doc-position"}))].concat(Object(T.a)(e,{}))},bus:D.a}):null)),n&&b.a.createElement("div",{className:"doc-history-revert-loading"},b.a.createElement("div",{className:"doc-history-revert-loading__tips"},m("etherpad.restoring"))),b.a.createElement("div",{className:"doc-history-revert-mask",onClick:l}))}},{key:"total",get:function(){var e=this.replay;return e&&e.changes?e.changes.length:0}},{key:"enableLeft",get:function(){return 1<this.state.progress}},{key:"enableRight",get:function(){return this.state.progress<this.total}}]),t}(h.Component);Z.c=K}).call(this,q("2vAP"))},"p/xT":function(e,t,n){},p3Wu:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"g",function(){return l}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d});var i,r,o=n("FJEn"),a=/(?:^| )ol-id([0-9a-zA-Z]+)/,s=/^[0-9a-zA-Z]+$/,c="IGNORE_LIST",l=/(number)([0-9]+)/;(r=i=i||{})[r.UP=0]="UP",r[r.DOWN=1]="DOWN";var u="temp-li",d=(o.DisplayType.Inline,"todo_uuid")},p6Xf:function(e,w,j){"use strict";(function(t){j.d(w,"a",function(){return _});var e=j("lwsE"),i=j.n(e),n=j("W8MJ"),r=j.n(n),o=j("a1gu"),a=j.n(o),s=j("Nsbk"),c=j.n(s),l=j("7W2i"),u=j.n(l),d=j("cDf5"),h=j.n(d),f=j("q1tI"),p=j.n(f),g=j("TSYQ"),m=j.n(g),v=j("juOH"),b=j("TXAG"),y=j("4PSP"),E=j("tAHg"),O=j("OX8E"),C=j("D28M"),k=j("2ACu"),I=j("UlbS"),S=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},T={width:16,height:16},_=function(e){function n(e){var t;return i()(this,n),(t=a()(this,c()(n).call(this,e))).controller=new E.a(O.a),t.state={visible:!1,refresh:!1},t}return u()(n,e),r()(n,[{key:"componentDidMount",value:function(){this.controller&&(this.controller.onShowToolbar(this.showToolbar),this.controller.onHideToolbar(this.hideToolbar),this.controller.onRefreshToolbar(this.refreshToolbar)),this.toolbarDom&&this.toolbarDom.addEventListener("mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){this.controller&&(this.controller.offShowToolbar(this.showToolbar),this.controller.offHideToolbar(this.hideToolbar),this.controller.offRefreshToolbar(this.refreshToolbar)),this.toolbarDom&&this.toolbarDom.removeEventListener("mouseup",this.handleMouseUp),this.controller=null,this.toolbarDom=null}},{key:"refreshToolbar",value:function(e){var t;!this.toolbarDom||(t=Object(C.o)(this.toolbarDom,"ace-line"))&&e.id===t.id&&this.setState(function(e){return{refresh:!e}})}},{key:"showToolbar",value:function(e){var t;!this.toolbarDom||this.state.visible||(t=Object(C.o)(this.toolbarDom,"ace-line"))&&e.id===t.id&&this.setState({visible:!0})}},{key:"hideToolbar",value:function(e){var t;this.toolbarDom&&this.state.visible&&((t=Object(C.o)(this.toolbarDom,"ace-line"))&&e.id===t.id&&this.setState({visible:!1}))}},{key:"handleAddAtUser",value:function(e){var t,n;this.controller&&this.toolbarDom&&((t=Object(C.o)(this.toolbarDom,"ace-line"))&&(this.controller.atUser(t),n=Object(C.l)(t,"ace-table"),Object(k.default)("open_mention",{event_type:"mouseclick",zone:n?"table":"default",source:"checkbox"})))}},{key:"handleAddReminder",value:function(e){var t;this.controller&&this.toolbarDom&&((t=Object(C.o)(this.toolbarDom,"ace-line"))&&(this.controller.clickAddReminderBtn(t),Object(k.default)("client_reminder_operation",{action:"click_insert_reminder",source:"click",file_is_have_edit:!0})))}},{key:"setRef",value:function(e){this.toolbarDom=e}},{key:"handleMouseUp",value:function(e){e.stopImmediatePropagation()}},{key:"collectBeforeChangeRep",value:function(e){this.controller&&this.controller.collectBeforeChangeRep()}},{key:"renderAddUser",value:function(){return p.a.createElement(I.Tooltip,{showDelay:200,title:t("reminder.toolbar.user"),placement:"top",hideActions:["onMouseLeave","onClick"]},p.a.createElement("span",{className:"add-user toolbar-btn",onMouseDown:this.collectBeforeChangeRep,onClick:this.handleAddAtUser},p.a.createElement(v.a,Object.assign({},T))))}},{key:"renderAddReminder",value:function(){return p.a.createElement(I.Tooltip,{showDelay:200,title:t("reminder.toolbar.reminder"),placement:"top",hideActions:["onMouseLeave","onClick"]},p.a.createElement("span",{className:"add-reminder toolbar-btn",onMouseDown:this.collectBeforeChangeRep,onClick:this.handleAddReminder},p.a.createElement(b.a,Object.assign({},T))))}},{key:"render",value:function(){var e=this.state.visible,t=m()({"reminder-toolbar":!0,visible:e});return p.a.createElement("span",{ref:this.setRef,className:t},this.renderAddUser(),this.renderAddReminder())}}]),n}(f.Component);S([Object(y.Bind)()],_.prototype,"refreshToolbar",null),S([Object(y.Bind)()],_.prototype,"showToolbar",null),S([Object(y.Bind)()],_.prototype,"hideToolbar",null),S([Object(y.Bind)()],_.prototype,"handleAddAtUser",null),S([Object(y.Bind)()],_.prototype,"handleAddReminder",null),S([Object(y.Bind)()],_.prototype,"setRef",null),S([Object(y.Bind)()],_.prototype,"handleMouseUp",null),S([Object(y.Bind)()],_.prototype,"collectBeforeChangeRep",null),S([Object(y.Bind)()],_.prototype,"renderAddUser",null),S([Object(y.Bind)()],_.prototype,"renderAddReminder",null)}).call(this,j("2vAP"))},p7Cg:function(e,t,i){"use strict";i.d(t,"a",function(){return f});var n=i("o0o1"),r=i.n(n),o=i("yXPU"),a=i.n(o),s=i("lwsE"),c=i.n(s),l=i("W8MJ"),u=i.n(l),d=i("1lbP"),h=i("oJoF"),f=function(){function n(e){var t=this;c()(this,n),this.editor=e,this.className="FindReplace",this.rxOp=new d.a,this.serv=null,this.editor.on(h.b,function(){return t.loadFindReplaceServ()})}function e(){return t.apply(this,arguments)}var t;return u()(n,[{key:"loadFindReplaceServ",value:(t=a()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.serv)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,this.rxOp.toPromise(Promise.all([i.e("doc_index_css"),i.e("chunk_adit"),i.e("commons--doc_index_delay--voteEmoji--votePicker"),i.e(16),i.e("commons--doc_index_delay--jira"),i.e("doc_index_delay")]).then(i.bind(null,"qZr+")));case 4:t=e.sent,this.serv=new t.EditorFindReplaceService(this.editor),this.serv.onMount();case 7:case"end":return e.stop()}},e,this)})),e)},{key:"reset",value:function(){this.serv&&this.serv.reset()}},{key:"destroy",value:function(){this.rxOp.destroy(),this.serv&&(this.serv.reset(),this.serv=null)}},{key:"changesetApply",value:function(){this.serv&&this.serv.changesetApply()}},{key:"editorSizeChange",value:function(){this.serv&&this.serv.editorSizeChange()}},{key:"fullscreenEntering",value:function(){this.serv&&this.serv.fullscreenEntering()}},{key:"fullscreenEntered",value:function(){this.serv&&this.serv.fullscreenEntered()}},{key:"fullscreenExited",value:function(){this.serv&&this.serv.fullscreenExited()}}]),n}()},pIdd:function(e,j,M){"use strict";(function(c){var l,e=M("o0o1"),u=M.n(e),t=M("yXPU"),n=M.n(t),a=M("OZf9"),i=M("Z0Cl"),d=M("HA5h"),h=M("9g7G"),f=M("HmyT"),p=M("AiBH"),g=M("mRaX"),s=M("zLXu"),r=M("b6qs"),m=M("VI6H"),o=".mention-chat-button-opt .button-cancel,.mention-chat-button-opt .button-confirm",v={init:function(e){r.a.init(e);var t=(l=e.editor).getDocBody();e.pure||(Object(f.$)(t).on("click",".mention-chat-button",y),Object(f.$)(t).on("click",o,k)),this.source=e.source},reset:function(){r.a.reset();var e=l.getDocBody();Object(f.$)(e).off("click",".mention-chat-button",y),Object(f.$)(e).off("click",o,k),l=null},update:function(e,t){var n=T(t);Object(s.a)(e,n,this.source,_)},updateWithNodes:function(n,e){var i,r=this,t=b(e),o=[];Object(a.a)(t,function(e){var t=Object(g.K)(e,"mention-chatId");t&&""!==t&&o.push(t)}),o.length&&(i=[],Object(a.a)(o,function(e){var t=r.getCacheInfo(e);if(!t)return i.push(e);_(n,e,t)}),0<i.length&&Object(s.a)(n,i,this.source,_))},setCacheInfo:function(e){var t=Object(i.a)(e,function(e){return e.type===p.E.CHAT}),n={};Object(a.a)(t,function(e){n[e.token]=Object.assign({},e),n[e.token].hasjoin=!0}),r.a.setCacheInfo(n)},getCacheInfo:function(e){return r.a.getCacheInfo(e)}};function b(e){for(var t=Object(f.$)(e).find(".mention"),n=[],i=0,r=t.length;i<r;i++)n.push(t.eq(i).prop("className"));return n}function y(e){var t=Object(f.$)(this),n=t.parents(".mention");if(t.text()===p.f.unjoined){var i=Object(d.a)({},S(n),{hasjoin:!1,joinConfirm:!0});return w(n,Object(g.W)(i)),!1}}function E(e){var t=e.match(/(^| )author-([^\s]+)/);return t=t?t[2]:""}function O(e,t,n){return C.apply(this,arguments)}function C(){return(C=n()(u.a.mark(function e(t,n,i){var r,o,a,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=16;break}if(t===p.n)throw new Error("Error chat token");e.next=4;break;case 4:return e.next=6,Object(h.c)(t);case 6:if(o=e.sent,o.data[t].chat_share_status!==p.g.ACTIVE)return l&&l.call("alert",{message:c("mention.chat_expired")}),e.abrupt("return",!1);e.next=11;break;case 11:return e.next=13,Object(h.l)(t);case 13:r=e.sent,e.next=19;break;case 16:return e.next=18,Object(h.k)({chatId:n,invitor:i});case 18:r=e.sent;case 19:if(a=r.data.code)return s=p.s[a]||c("etherpad.join_group_failed"),l&&l.call("alert",{message:s}),e.abrupt("return",!1);e.next=24;break;case 24:e.next=30;break;case 26:return e.prev=26,e.t0=e.catch(0),l&&l.call("alert",{message:c("etherpad.join_group_failed")}),e.abrupt("return",!1);case 30:return e.abrupt("return",!0);case 31:case"end":return e.stop()}},e,null,[[0,26]])}))).apply(this,arguments)}function k(e){return I.apply(this,arguments)}function I(){return(I=n()(u.a.mark(function e(t){var n,i,r,o,a,s,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(f.$)(t.currentTarget).parents(".mention"),i=S(n),r=n.prop("className"),o=Object(g.K)(r,"mention-chatId"),a=Object(g.K)(r,"mention-chatToken"),s=E(r),Object(f.$)(t.currentTarget).hasClass("button-confirm"))return e.next=9,O(a,o,s);e.next=17;break;case 9:if(e.sent){e.next=12;break}return e.abrupt("return");case 12:c=Object(d.a)({},i,{hasjoin:!0,joinConfirm:!1}),v.setCacheInfo([c]),_(l,o,c),e.next=18;break;case 17:_(l,o,Object(d.a)({hasjoin:!1,joinConfirm:!1},i));case 18:return e.abrupt("return",!1);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(e){var t=e.find(".mention-chat-icon img").prop("src"),n=e.find(".mention-chat-desc").text(),i=e.find(".mention-chat-tit").text(),r=e.find(".mention-chat-button-opt").text(),o=Object(g.K)(e.prop("className"),"mention-chatId");return{url:t,desc:n,buttonText:r,joinConfirm:!0,content:i,chatId:o,token:o,type:p.E.CHAT}}function T(e){var t,i=[];for(t in e){var n=e[t];Object(a.a)(n,function(e){var t,n;!e||(t=e[0].split("_"))&&t[0]&&"mention-chatId"===t[0]&&(n=t[1],i.indexOf(n)<0&&i.push(n))})}return i}function _(l,u,e){var t=Object(m.g)(),n=e.content,i=e.hasjoin,r=e.url,o=e.desc,a=e.is_cross_tenant,s=e.is_external,c=(c=(a||s)&&!i)||s&&t&&!i,d=p.f.unjoined;i&&(d=Object(g.p)());var h={url:r,desc:o,content:n,buttonText:d,chatId:u,notAllowedJoin:c};l.getMatchedAttributePositionOnSelection(null,function(e){return e==="mention-chatId_".concat(u)}).map(function(e){var t=e.docPosition,n=t.selZone;return{lineNum:t.selStart[0],zoneId:n}}).forEach(function(e){var t=e.lineNum,n=e.zoneId;if(-1!==t){var i=l.getRep(n).lines.atIndex(t);if(i&&i.lineNode){var r=i.lineNode,o=Object(f.$)(r).find(".mention-chatId_".concat(u)),a=o.length;if(a)for(var s=Object(g.W)(h),c=0;c<a;c++)w(o.eq(c),s)}}})}function w(e,t){var n=e.parents("[id^=magicdomid]"),i=l.dom.zoneOfdom(n.get(0)),r=l.getReps()[i];r&&(e.html(t),l.markNodeClean(n.get(0),r.lines.atKey(n.get(0).id)))}j.a=v}).call(this,M("2vAP"))},pTmc:function(e,t,n){},paQS:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("D7h9"),s=n("toa8"),i=n("wOYm"),c=n("Tb95"),l=n("ZGZ5"),u=n("wQna"),d=n("7SOz"),h=n("sFgt"),f=n("kUgE");function r(e){var t=e.suiteType,n=e.suiteToken,i=e.enableAutoTranslate,r=e.translateLang;u.a.destroy({suiteType:t,suiteToken:n});var o=u.a.getOrCreate({suiteType:t,suiteToken:n});return new c.a({enableAutoTranslate:i||!1,broadcast:o,request:s.d,getUserId:function(){return Object(l.a)(a.default.getState()).get("id")||window.User.id},getSuiteType:function(){return t},getSuiteToken:function(){return n},getTranslateLang:function(){return r||"en"},getSrcLang:function(){return Object(f.getLanguage)()},translateFn:d.a,toAILabTypeData:d.c,toLineTexts:d.d,parseCommentContent:h.j})}var o=Object(i.a)(r,function(e){return e.subCommentToken?"".concat(e.suiteType,":").concat(e.suiteToken,":").concat(e.subCommentToken):"".concat(e.suiteType,":").concat(e.suiteToken)})},pf04:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r("o0o1"),o=r.n(n),i=r("J4zp"),a=r.n(i),s=r("yXPU"),c=r.n(s),l=r("6AXZ"),u=function(){var e=c()(o.a.mark(function e(){var t,n,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Promise.all([r.e("doc_index_css"),r.e("chunk_adit"),r.e("commons--doc_index_delay--voteEmoji--votePicker"),r.e(16),r.e("commons--doc_index_delay--jira"),r.e("doc_index_delay")]).then(r.bind(null,"HN4B")),Object(l.b)().catch()]);case 2:return t=e.sent,n=a()(t,1),i=n[0],e.abrupt("return",i);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},pylR:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("o0o1"),o=n.n(i),r=n("yXPU"),a=n.n(r),s=n("Ae4K");function c(r){return new Promise(function(){var t=a()(o.a.mark(function e(n){var i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(i=new FileReader).onload=a()(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.e)(i.result);case 2:t=e.sent,n(t);case 4:case"end":return e.stop()}},e)})),i.readAsArrayBuffer(r);case 3:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())}},pzL3:function(e,ie,re){"use strict";(function(c){re.d(ie,"a",function(){return ne});var e=re("J4zp"),l=re.n(e),t=re("lwsE"),u=re.n(t),n=re("W8MJ"),i=re.n(n),r=re("a1gu"),d=re.n(r),o=re("Nsbk"),h=re.n(o),a=re("PJYZ"),f=re.n(a),s=re("7W2i"),p=re.n(s),g=re("cDf5"),m=re.n(g),v=re("hbEN"),b=re("q1tI"),y=re.n(b),E=re("y2sV"),O=re("7EGn"),C=re("4PSP"),k=re("/spq"),I=re("j1lG"),S=re("Tqb2"),T=re("v6N1"),_=re("YNKm"),w=re("816x"),j=re("TgJx"),M=re("15MJ"),L=re("4+Yg"),R=re("FVmk"),N=re("aBgF"),D=re("i4Hx"),x=re("n2k8"),P=re("jIuk"),B=(re("Z6pE"),re("2JAk")),U=re("zy84"),z=re("aWXl"),H=re("J21X"),F=re("B8Xq"),V=re("KrGf"),W=re("Z/PY"),K=re("dDhe"),Z=re("Cy2Z"),q=re("kESg"),Y=re("+4eN"),J=re("Ja9/"),Q=re("SD+I"),X=re("Guq5"),$=re("Tgf/"),ee=re("nVH4"),te=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},ne=function(e){function a(e){var s,t=e.editor,n=e.moduleInstanceMap,i=e.imageStateInstance;u()(this,a),(s=d()(this,h()(a).call(this))).name=I.K,s.isPreventAutoFixSelection=!1,s.onEditorContentChange=function(e){var t=e.changes;s.galleryComment&&Object(L.a)(t)&&(s.galleryComment.onCsImageChanged(),s.galleryComment.changesetApply(),s.setImageInViewStatus(s.editor.plugins.viewportObserver.getVisibleRange()))},s.handleClientMessage_ACCEPT_COMMIT=function(e,t){s.galleryComment&&s.galleryComment.changeSetCommitWatcher.handleClientMessage_ACCEPT_COMMIT(e,t)},s.handleClientMessage_ERROR=function(e,t){s.galleryComment&&s.galleryComment.changeSetCommitWatcher.handleClientMessage_ERROR(e,t)},s.upload=function(e){var t=e.event,n=e.source;[X.a.A_PANEL,X.a.BLOCK_MENU].includes(n)&&s.handleAPanelImageFiles(t)},s.onResize=Object(v.default)(function(){s.imageStateInstance.setImageState({bodyWidth:document.body.clientWidth,editorWidth:s.editor.getRect().width}),s.galleryComment&&s.galleryComment.editorSizeChange()},500),s.setPreventAutoFixSelection=function(e){s.isPreventAutoFixSelection=e},s.handleSelectionChange=function(e){if(!s.isPreventAutoFixSelection){var t=e.current,n=t.start,i=t.end;if(!(n.line===i.line)){var r=Object(R.b)(t,s.editor),o=r.start,a=r.end;if(!o&&!a)return;Object(R.a)(r,t,s.editor)}t.isCollapsed()&&Object(R.f)(n,s.editor,s.imageStateInstance)}},s.handleDragMouseDown=function(e){s.draggableModule&&s.draggableModule.setDraggingUuid(e)},s.execInsertImage=function(){Object(w.c)()},s.editorWillCopy=function(e){Object(x.a)(e,function(e){var t=s.imageStateInstance.getImageState().selectedImageSet;return 0===t.size?e:e.filter(function(e){return t.has(e.uuid)})})},s.serialize=function(e){var t=e.op,n=e.type;if(!t||n!==E.u.LEAF)return e;var i=t.attributes;if(!i)return e;var r=Object(S.V)(i);if(s.copyModule&&r.length){var o=document.createElement("div");o.classList.add("image-uploaded"),r.forEach(function(e){var t=s.copyModule.generateSerializedNode(e);o.appendChild(t)});var a=Object(S.W)(i);return i[I.K]&&(o.classList.add("gallery"),o.setAttribute(M.a,JSON.stringify({items:a}))),Object.assign(e,{node:o})}return e},s.editorWillSetClipboard=function(){s.copyModule.makePublicUrlEffective()},s.onEditorDidPaste=function(e){Object(B.b)(e,s.editor,{imageExternalSaver:s.externalSaverModule,imageUploader:s.uploadModule,beforeUnloadReminder:s.pasteBeforeUnloadReminder,imageStateInstance:s.imageStateInstance})},s.deserialize=function(e){return Object(B.a)(e,s.editor)},s.handleWillDeleteFromCut=function(e){var t=e.preventEvent;Object(U.a)(s.imageStateInstance.getImageState(),s.editor)&&t()},s.pluginReadOnly=function(){s.imageStateInstance.setImageState({isReadOnly:!0})},s.pluginReadWrite=function(){s.imageStateInstance.setImageState({isReadOnly:!1})},s.handleSwitchToPresentationPagedMode=function(){s.setImageInViewStatus([0,s.editor.getContentState().getActiveZone().length()-1])},s.handleImageUploadSuccess=function(e){var t=e.uuid,n=f()(s).editor,i=s.imageStateInstance,r=i.getImageState,o=i.setImageState,a=r();n.pure||""!==a.lastUploadedImageUuid||(o({lastUploadedImageUuid:t}),n.once("paint",function(){n.call("imageFirstUpload")}))},s.collectText=function(e,t){if(t.attributes.some(function(e){return I.p.includes(e[0])}))return"[".concat(c("editorbar.image"),"]")},s.editor=t,s.imageStateInstance=i;var r=Object(O.default)(t,"isInSideHistory",!1)||Object(K.c)();s.pasteBeforeUnloadReminder=new H.a({unsavedTip:c("CreationDoc_Docs_Upload_Image_Decs")});var o=t.getRect();return i.setImageState({editorWidth:o?o.width:0,isSkipLoading:r,isReadOnly:!t.editable}),s.registerModule(n),s.registerEditorCommand(),s.bindEvents(),Object(w.a)(s.handleAPanelImageFiles),s.selectionPopupManager=Object(D.a)(t,s.galleryComment,i),s.batchSelectImage=new Q.a({imageStateInstance:i}),s}return p()(a,e),i()(a,[{key:"getImageStateInstance",value:function(){return this.imageStateInstance}},{key:"registerModule",value:function(e){var t=e.imageUploader,n=e.imageCopy,i=e.imagePaste,r=e.imageExternalSaver,o=e.imageResize,a=e.imageDraggable,s=e.imagePreviewer,c=e.galleryComment,l=e.imageFetcher;t&&(t.setOnUploadSuccessCallback(this.handleImageUploadSuccess),this.uploadModule=t),n&&(this.copyModule=n),i&&(this.pasteModule=i),o&&(this.resizeModule=o),a&&(this.draggableModule=a),s&&(this.previewModule=s),r&&(this.externalSaverModule=r),c&&(c.setIsNewImagePlugin(!0),c.onMount(),this.galleryComment=c),l&&(this.fetchModule=l)}},{key:"registerEditorCommand",value:function(){var e=this;this.editor.commands.registerAceCommand(_.K,function(){e.execInsertImage()})}},{key:"match",value:function(e){return-1<[I.K,I.M,I.c,I.d].indexOf(e)}},{key:"bindEvents",value:function(){this.bindEditorEvents(),window.addEventListener("resize",this.onResize),document.addEventListener("dragover",this.onDragOver)}},{key:"bindEditorEvents",value:function(){this.editor.on("drop",this.onEditorDrop),this.editor.on(E.k.PASTE,this.onEditorPaste),this.editor.on(E.k.DID_PASTE,this.onEditorDidPaste),this.editor.on(E.k.CONTENT_CHANGE,this.onEditorContentChange),this.editor.on(E.k.WILL_DELETE_FROM_CUT,this.handleWillDeleteFromCut),this.editor.on(E.k.SELECTION_CHANGE,this.handleSelectionChange)}},{key:"unbindEvents",value:function(){this.unbindEditorEvents(),window.removeEventListener("resize",this.onResize),document.removeEventListener("dragover",this.onDragOver)}},{key:"unbindEditorEvents",value:function(){this.editor.off("drop",this.onEditorDrop),this.editor.off(E.k.PASTE,this.onEditorPaste),this.editor.off(E.k.DID_PASTE,this.onEditorDidPaste),this.editor.off(E.k.CONTENT_CHANGE,this.onEditorContentChange),this.editor.off(E.k.WILL_DELETE_FROM_CUT,this.handleWillDeleteFromCut),this.editor.off(E.k.SELECTION_CHANGE,this.handleSelectionChange)}},{key:"handleAPanelImageFiles",value:function(e){var t=(e&&e.target&&e.target.files&&Array.from(e.target.files)||[]).filter(S.K);t&&0<t.length&&this.uploadImages(t,null,I.F.APanel)}},{key:"onEditorDrop",value:function(e){var t=e.evt,n=Object(S.m)(t);0<n.length&&(t.preventDefault(),Object(V.b)()||this.uploadImages(n,t,I.F.Drag))}},{key:"onDragOver",value:function(e){Object(S.c)(e)&&e.preventDefault()}},{key:"onEditorPaste",value:function(e){var t,n=e.evt,i=this.editor.getContentState().getActiveZone().getZoneId(),r=Object(Y.n)(this.editor,i);!Object(F.a)(n)||[q.l.CodeBlock,q.l.CalloutBlock].includes(r)||0<(t=Object(S.D)(n)).length&&(n.preventDefault(),Object(V.b)()?Object(W.a)():this.uploadImages(t,n,I.F.Paste))}},{key:"uploadImages",value:function(e,t,n){var i=this,r=1<e.length;e.forEach(function(e){return i.uploadModule.upload({resource:e,event:t,source:n,continuously:r})})}},{key:"aceKeyEvent",value:function(e,t){var n=t.evt,i=n.type,r=n.keyCode;if("keydown"!==i)return!1;if(r===N.c.Enter){var o=this.editor,a=o.selection.getSelection();if(Object(R.c)(a,o)){n.preventDefault(),n.stopPropagation();var s=o.getContentState(),c=s.getActiveZone().getZoneId(),l=a.toPosition().start,u=Object(S.z)(a,o),d=u.endsWith("\n")?l+u.length-1:l+u.length,h=new E.E({zoneId:c}).retain(d).insertEnter();return s.apply(h),Object(R.d)(a,o),!0}}return!!Object(z.a)(t,this.editor,this.imageStateInstance)||!!Object.values(ee.a).includes(r)&&Object(S.F)(this.editor,n)}},{key:"aceBlur",value:function(){this.imageStateInstance.setImageState({selectedImageSet:new Set})}},{key:"viewportChange",value:function(e,t){var n=t.visibleRangeInMainZone;this.setImageInViewStatus(n)}},{key:"setImageInViewStatus",value:function(e){var t=l()(e,2),n=t[0],i=t[1],r=Object(P.a)(n,i,this.editor).map(function(e){return Object(S.T)(e).map(function(e){return e.uuid})}),o=l()(r,2),a=o[0],s=o[1],c={inViewImages:new Set(a),demandLoadImages:new Set(s)};Object(P.b)(this.imageStateInstance,c)&&this.imageStateInstance.setImageState(c)}},{key:"editorWillPaste",value:function(e){return Object(B.c)(e,this.editor)}},{key:"fullscreenEntered",value:function(e,t){var n=t.mode;this.imageStateInstance.setImageState({fullscreenMode:n}),n===j.a.PAGED&&this.handleSwitchToPresentationPagedMode()}},{key:"fullscreenExited",value:function(e,t){this.imageStateInstance.setImageState({fullscreenMode:null}),this.previewModule&&this.previewModule.hidden()}},{key:"fullscreenModeChanged",value:function(e,t){var n=t.mode;this.imageStateInstance.setImageState({fullscreenMode:n}),this.fullscreenEntered(e,t)}},{key:"renderLine",value:function(e){var t=e.lineState,n=e.children,i=t.getOps(),r=t.getZoneId(),o=Object(S.d)(i.map(function(e){return Object(S.M)(e)?Object(S.V)(e.attributes):[]})),a=o.length;if(0===a)return n;var s=!0,c=1<a,l=t.getLineAttributes().toMap().align;1===a&&l&&(s=!1),this.calcAndCacheImageSize(o,r,this.editor);var u={justifyContent:s?c?"flex-start":"center":I.a[l],display:"flex",alignItems:"flex-start",padding:"8px 0",textIndent:"initial"};return e.lineClass+=" ".concat(I.l," "),e.lineClass+=" ".concat(Z.b.join(" ")),y.a.createElement(E.z,{className:I.J,style:u,contentEditable:"false"},n)}},{key:"calcAndCacheImageSize",value:function(e,t,n){var i=this.imageStateInstance.getImageState().imageSizeMap,r=Object(T.b)(e,t,n);r&&r.forEach(function(e,t){return i.set(t,e)})}},{key:"render",value:function(e){var t=this,n=e.lineState,i=e.attributes,r=e.style,o=Object(S.V)(i),a=Object(S.t)(i),s=a.galleryAttribsString,c=a.oldImageAttribsString,l=s||c;return e.key=o.map(function(e){return e.uuid}).join(","),e.class=" ".concat(Z.a.join(" ")),Object.assign(r,{maxWidth:"100%",minWidth:0,lineHeight:0}),y.a.createElement("div",{style:$.a.innerContainerStyle},o.map(function(e){return y.a.createElement(J.a,{key:e.uuid,attribs:e,previewModule:t.previewModule,uploadModule:t.uploadModule,fetchModule:t.fetchModule,galleryComment:t.galleryComment,lineState:n,editor:t.editor,onDragMouseDown:t.handleDragMouseDown,imageStateInstance:t.imageStateInstance,selectionPopupManager:t.selectionPopupManager,setPreventAutoFixSelection:t.setPreventAutoFixSelection,batchSelectImage:t.batchSelectImage,attributeStr:l})}))}},{key:"reset",value:function(){this.unbindEvents(),this.fetchModule&&this.fetchModule.destroy(),this.previewModule&&this.previewModule.destroy(),this.copyModule&&this.copyModule.destroy(),this.galleryComment&&this.galleryComment.destroy(),this.externalSaverModule&&this.externalSaverModule.destroy(),this.draggableModule&&this.draggableModule.destroy(),this.imageStateInstance.resetImageState(),this.selectionPopupManager.destroy(),this.uploadModule&&this.uploadModule.destroy(),this.uploadModule&&this.uploadModule.setOnUploadSuccessCallback(null),this.pasteBeforeUnloadReminder&&this.pasteBeforeUnloadReminder.destroy(),Object(w.b)()}}]),a}(E.p);te([C.Bind],ne.prototype,"handleAPanelImageFiles",null),te([C.Bind],ne.prototype,"onEditorDrop",null),te([C.Bind],ne.prototype,"onEditorPaste",null),ne=te([Object(k.a)(["bindEvents","bindEditorEvents","unbindEvents","unbindEditorEvents","serialize","deserialize","viewportChange"],"isInSideHistory")],ne)}).call(this,re("2vAP"))},q4SO:function(e,t,n){"use strict";n.d(t,"c",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return d});var i=n("9+L6"),r=n("dP4c"),o=n("VI6H"),a=n("skFV");function s(e){return/^(https?:\/\/)?localhost(:\d+)?\//.test(e)}function c(){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],t=s(t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")?i.c:t,n="".concat(e?i.s:i.t,"?query_scope=all&app_id=2&should_pass_through=1&utm_from=organic_ccm_share_web&redirect_uri=").concat(encodeURIComponent(t));return e&&(n+="&template_id=".concat(Object(a.v)()?"6882703852286509057":"6882649779491307521","&biz=feishu_docs")),n}function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";Object(r.c)(c(e),!1,!0)}function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";Object(r.c)(c(e,!0),!1,!0)}function d(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";(Object(o.x)()?u:l)(e)}},qCz6:function(e,t,n){},qK4o:function(e,t,n){},qOLP:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return a});var i="doc_has_text",r="changeNoteTitle",o="updateAddIconVisible",a="setTitleIcon"},qSBL:function(e,t,n){},qTk9:function(e,t,n){"use strict";n.d(t,"a",function(){return E});var i=n("o0o1"),r=n.n(i),o=n("yXPU"),a=n.n(o),s=n("lwsE"),c=n.n(s),l=n("W8MJ"),u=n.n(l),d=n("VI8A"),h=n("1lbP"),f=n("90Nm"),p=n("S5bw"),g=n("dzgT"),m=n("p0Sj"),v=n("VnD/"),b=n("t9fZ"),y=n("oJoF"),E=function(){function n(e,t){c()(this,n),this.editor=e,this.rxOp=new h.a,this.afterDocFirstScreenAnimationFrame=new d.a,this.isEditable$=new p.a(1),this.options=Object.assign({waitForDone:!0},t)}function e(){return t.apply(this,arguments)}var t;return u()(n,[{key:"onMount",value:(t=a()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.afterDocFirstScreenAnimationFrame.request();case 2:this.editor.call(y.a),this.afterDocFirstScreen();case 4:case"end":return e.stop()}},e,this)})),e)},{key:"afterDocFirstScreen",value:function(){var e=this,t=Object(f.a)().pipe(Object(m.a)(!this.options.waitForDone),Object(v.a)(function(e){return!0===e}));t.pipe(Object(b.a)(1),this.rxOp.takeUntil()).subscribe(function(){return e.editor.call(y.b)}),Object(g.b)(t,this.isEditable$).pipe(Object(b.a)(1),this.rxOp.takeUntil()).subscribe(function(){return e.editor.call(y.c)})}},{key:"pluginReadWrite",value:function(){this.isEditable$.next()}},{key:"destroy",value:function(){this.afterDocFirstScreenAnimationFrame.cancel(),this.rxOp.destroy()}}]),n}()},qYkn:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var i=n("jp/M"),r=function(){return{type:i.actionTypes.permission.COPY_TEXT_FAIL}},o=function(){return{type:i.actionTypes.permission.ADMIN_PERMISSION_FAIL}}},qkqw:function(e,O,C){"use strict";(function(u){C.d(O,"a",function(){return h}),C.d(O,"b",function(){return E});var d,e,h,t,n=C("o0o1"),f=C.n(n),i=C("RIqP"),p=C.n(i),r=C("yXPU"),o=C.n(r),a=C("toa8"),s=C("lQZd"),c=C("AESI"),g=C("n/R6"),l=C("6jTl"),m=C("gfe6"),v=C("uGU9");function b(e,t,n){var i=function(){return a.b.post(c.POST_COPY_IMAGE_V3,{dest:{obj_type:t||Object(s.l)(),obj_token:n||Object(s.g)()},files:e})};return Object(v.a)(i,{max:3,interval:0,factor:1})().then(function(e){return e.payload},function(e){return e.payload})}function y(e){switch(e){case d.SUCCESS:break;case d.FILE_QUOTA_EXCEEDED:l.a.show({title:u("common.storage_usage_limitation_title"),body:u("common.storage_usage_limitation_body_paste"),hasCancel:!1});break;case d.FILE_COUNT_EXCEEDED:l.a.show({body:u("CreationDoc_Limitation_UploadAttachment"),hasCancel:!1});break;case d.FILE_DELETED:g.a.error({closable:!0,content:u("common.paste_deleted_image")});break;default:g.a.error({closable:!0,content:u("common.paste_image_failed")})}}function E(a,s,c){var t,l=!1,e=function(){var e=o()(f.a.mark(function e(){var t,n,i,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((e.prev=0)===a.length)return e.abrupt("return",{code:h.SUCCESSFUL,tokenMap:{}});e.next=3;break;case 3:if(Object(m.c)()){e.next=6;break}return g.a.error({closable:!0,content:u("common.paste_image_offline")}),e.abrupt("return",{code:h.FAILED});case 6:a=p()(new Set(a)),t=50,n={},i=0;case 10:if(!(i<a.length)){e.next=38;break}if(l)return e.abrupt("return",{code:h.CANCELED});e.next=13;break;case 13:return r=a.slice(i,i+t),e.next=16,b(r,s,c);case 16:if(o=e.sent,l)return e.abrupt("return",{code:h.CANCELED});e.next=19;break;case 19:if(!o){e.next=33;break}if(o.code){e.next=29;break}if(!o.data||!o.data.token){e.next=25;break}Object.assign(n,o.data.token),e.next=27;break;case 25:return y(o.code),e.abrupt("return",{code:h.FAILED});case 27:e.next=31;break;case 29:return y(o.code),e.abrupt("return",{code:h.FAILED});case 31:e.next=35;break;case 33:return y(d.FAIL),e.abrupt("return",{code:h.FAILED});case 35:i+=t,e.next=10;break;case 38:return e.abrupt("return",{code:h.SUCCESSFUL,tokenMap:n});case 41:if(e.prev=41,e.t0=e.catch(0),l)return e.abrupt("return",{code:h.CANCELED});e.next=45;break;case 45:return y(d.FAIL),e.abrupt("return",{code:h.FAILED});case 47:case"end":return e.stop()}},e,null,[[0,41]])}));return function(){return e.apply(this,arguments)}}(),n=new Promise(function(e){t=function(){l=!0,e({code:h.CANCELED})}});return{promise:Promise.race([e(),n]),cancel:t}}(e=d=d||{})[e.SUCCESS=0]="SUCCESS",e[e.FAIL=1]="FAIL",e[e.FILE_DELETED=90003032]="FILE_DELETED",e[e.FILE_QUOTA_EXCEEDED=90003081]="FILE_QUOTA_EXCEEDED",e[e.FILE_COUNT_EXCEEDED=90015407]="FILE_COUNT_EXCEEDED",(t=h=h||{}).SUCCESSFUL="successful",t.FAILED="failed",t.CANCELED="canceled"}).call(this,C("2vAP"))},qkt2:function(e,t,n){"use strict";n.d(t,"f",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return h}),n.d(t,"i",function(){return f}),n.d(t,"c",function(){return p}),n.d(t,"e",function(){return g});var i=n("u3oV"),r=n("gfe6"),o=n("nN3d"),a=function(e){return Array.isArray(e)?e:[e]},s=0,c=function(e){if(!e)return Object(o.c)(12);var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name,n=e.size,i=Object(o.c)(6);return s++,"".concat(n,"-").concat(t.replace(/[^0-9a-zA-Z_-]/gim,""),"-").concat(i,"-").concat(s)},l=function(){return Object(o.c)(32)},u=function(e){return e<1024?e+" bytes":e<1048576?(e/1024).toFixed(0)+" KB":e<1073741824?(e/1024/1024).toFixed(1)+" MB":(e/1024/1024/1024).toFixed(1)+" GB"},d=function(e){return Object(i.a)(e,function(e){return null!=e})};function h(i){return new Promise(function(e,t){var n=new FileReader;n.onload=function(){e(n.result)},n.onerror=function(){t("upload read blob error")},n.readAsArrayBuffer(i)})}function f(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise(function(e){return window.setTimeout(e,t)})}function p(e){var t=String(e).split(".").pop();return t&&t!==e?t.toLowerCase():""}function g(){return navigator.onLine&&Object(r.c)()}},qtYV:function(e,t,n){"use strict";var i=n("CRWC"),r=n.n(i),m=n("yGdm"),v=n("HmyT"),o=n("cgIo"),l=n("wq9/"),b=(n("yxg6"),8),y={showStatus:!1,referenceCount:0,init:function(){this.referenceCount++,Object(v.$)(".link-modify-popup").length||(y.outContainer=Object(v.$)(".doc-popup-container"),Object(v.$)(Object(o.a)(r.a)()).appendTo(y.outContainer),y.modifyPopUp=Object(v.$)(".link-modify-popup"),y.triangle=y.modifyPopUp.find(".link-popup__triangle"),y.linkText=y.modifyPopUp.find("span.link-modify-text"),y.linkDelete=y.modifyPopUp.find("span.link-modify-delete"))},hidePopUp:function(){y.showStatus=!1,y.modifyPopUp.addClass("link-popup_hidden"),y.modifyPopUp.find(".link-modify-submit").off("click"),y.modifyPopUp.find(".link-modify-delete").off("click")},showPopUp:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;this.linkDom=Object(v.$)(e);var i,r,o,a,s,c,l,u,d,h,f,p=E(e,(t=t||{}).y,n),g=p.left+p.width/2;y.outContainer[0]&&Object(v.$)(".etherpad-client-container")[0]&&(i=y.outContainer[0].getBoundingClientRect(),r=m.d,a=(o=Object(v.$)(".etherpad-client-container")[0].getBoundingClientRect()).width,l=(s=o.right)-(c=r/2),u=Math.min(g,l)-c-i.left,d=p.top+p.height-i.top+b,h=a+u,y.triangle.css({"margin-left":""}),h<0?(y.triangle.css({"margin-left":"".concat((parseInt(y.triangle.css("margin-left"),10)||0)+h,"px")}),u=2-a):l<g&&(f=c-(s-g)-8,y.triangle.css({"margin-left":"".concat(f,"px")})),y.modifyPopUp.css({left:"".concat(u,"px"),top:"".concat(d,"px")}),y.showStatus=!0)},getContainer:function(){return y.outContainer},destroy:function(){this.referenceCount--,0===this.referenceCount&&(y.outContainer=null,y.modifyPopUp=null,y.triangle=null,y.linkText=null,y.linkDelete=null)}};function E(e,t,n){if(!e.getClientRects)return Object(l.b)(e.getBoundingClientRect(),n);var i=e.getClientRects(),r={};Object.values(i).map(function(e){return Object(l.b)(e,n)}).forEach(function(e){var t;r[e.y]?(t=r[e.y],r[e.y]={left:Math.min(t.left,e.left),top:e.top,width:t.width+e.width,height:e.height}):r[e.y]=e}),i=Object.values(r);for(var o=0;o<i.length;o++){var a=i[o],s=a.top,c=a.top+a.height;if(s<=t&&t<=c)return a}return Object(l.b)(e.getBoundingClientRect(),n)}t.a=y},qup3:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var i=n("jp/M"),r=function(e){return{type:i.actionTypes.commentPosition.SET_COMMENT_POSITION_DATA,payload:e}},o=function(e){return{type:i.actionTypes.commentPosition.TOGGLE_COMMENT_SHOWN,payload:e}}},r06y:function(e,S,T){"use strict";(function(e){T.d(S,"d",function(){return s}),T.d(S,"e",function(){return c}),T.d(S,"g",function(){return l}),T.d(S,"h",function(){return u}),T.d(S,"i",function(){return d}),T.d(S,"c",function(){return h}),T.d(S,"k",function(){return f}),T.d(S,"l",function(){return g}),T.d(S,"j",function(){return b}),T.d(S,"b",function(){return y}),T.d(S,"f",function(){return I}),T.d(S,"a",function(){return t});var t,n,i=T("wd/R"),a=T.n(i),r=T("kUgE"),o=T("MjSh"),s={hour:0,minute:0,second:0,millisecond:0},c={hour:23,minute:59,second:59,millisecond:0},l=function(){var e=a()().minute()<30?0:30,t=a()().add(1,"days").set({minute:e,second:0,millisecond:0}).valueOf();return{isWholeDay:!1,shouldNotify:!0,expireTime:t,notifyTime:t}},u=600,d=300,h=function(e){return a()().isAfter(e)?o.R500:a()(e).isBetween(a()(),a()().add("7","days"))?o.O500:o.B500},f=function(e){var t=Math.floor(e/36e5);return m(t,e%36e5/6e4)},p=30,g=function(n){var e=Array(24).fill(null).map(function(e,t){return t}),i=Array(2).fill(null).map(function(e,t){return t*p}),r=[];return e.forEach(function(t){i.forEach(function(e){r.push({text:m(t,e),value:v(t,e)})})}),n&&r.some(function(e,t){return e.value===n||(e.value>n&&r.splice(t,0,{text:f(n),value:n}),e.value>n)}),r},m=function(e,t){if(r.LANG_MAP.en){var n=t<10?"0"+t:t,i=12<e||12===e&&0<=t?"PM":"AM";return"".concat(12<e?e-12:0===e?e+12:e,":").concat(n," ").concat(i)}return"".concat(e<10?"0"+e:e,":").concat(t<10?"0"+t:t)},v=function(e,t){return 60*(60*e+t)*1e3},b=function(){var i,r=g(),o=a()().valueOf()-a()().set(s).valueOf();return r.some(function(e,t){var n=e.value;return o<n&&(i=r[t-1].value),o<n}),i},y=[{value:0,text:e("reminder.popover.currentTime")},{value:-3e5,text:e("reminder.popover.beforeMin",5)},{value:-9e5,text:e("reminder.popover.beforeMin",15)},{value:-18e5,text:e("reminder.popover.beforeMin",30)},{value:-36e5,text:e("reminder.popover.beforeHour",1,"")},{value:-72e5,text:e("reminder.popover.beforeHour",2,"s")},{value:-864e5,text:e("reminder.popover.beforeDay",1,"")},{value:-1728e5,text:e("reminder.popover.beforeDay",2,"s")},{value:-6048e5,text:e("reminder.popover.beforeWeek",1)}],E=function(e,t,n){var i=e.split(":").map(function(e){return Number(e)}),r=t.split(":").map(function(e){return Number(e)});return 1e3*(3600*(r[0]-i[0]+24*n)+60*(r[1]-i[1])+(r[2]-i[2]))},O="23:59:59",C="09:00:00",k=r.LANG_MAP.en?"9":"09",I=[{value:E(O,C,0),text:e("reminder.popover.currentDayTime",k)},{value:E(O,C,-1),text:e("reminder.popover.beforeDayTime",k)},{value:E(O,C,-2),text:e("reminder.popover.twoBeforeDayTime",k)},{value:E(O,C,-7),text:e("reminder.popover.beforeWeekTime",k)}];(n=t=t||{}).ZH="zh-cn",n.EN="en-us",n.JA="ja-jp"}).call(this,T("2vAP"))},r0DX:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"m",function(){return r}),n.d(t,"l",function(){return o}),n.d(t,"r",function(){return a}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"n",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"f",function(){return d}),n.d(t,"e",function(){return h}),n.d(t,"c",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return g}),n.d(t,"j",function(){return m}),n.d(t,"p",function(){return v}),n.d(t,"u",function(){return b}),n.d(t,"k",function(){return y}),n.d(t,"q",function(){return E}),n.d(t,"b",function(){return O}),n.d(t,"o",function(){return C}),n.d(t,"s",function(){return k}),n.d(t,"v",function(){return I}),n.d(t,"w",function(){return S});var i="REMINDER_LINE_SHOW_TOOLBAR",r="REMINDER_LINE_HIDE_TOOLBAR",o="REMINDER_LINE_GENERATE_BLOCK",a="REMINDER_LINE_SET_GENERATE_PROPS",s="REMINDER_LINE_AT_USER",c="REMINDER_LINE_CLICK",l="REMINDER_LINE_HOVER",u=424,d=117,h=50,f=50,p=300,g="REMINDER_LINE_CLICK_ADD_REMINDER_BTN",m="REMINDER_LINE_COLLECT_BEFORE_CHANGE_REP",v="REMINDER_LINE_PROPS_CHANGE",b="REMINDER_LINE_TOGGLE_PLACEHOLDER",y="REMIDNER_LINE_DELETE",E="REMINDER_LINE_REFRESH_TOOLBAR",O="REMINDER_LINE_KEY_DOWN_EVENT",C="REMINDER_INSERT_GUIDE",k="REMINDER_SHOW_GUIDE",I="UPDATE_REMINDER_DOM_LINE",S="UPDATE_REMINDER_PLACEHOLDER"},r5mi:function(e,t,n){"use strict";var i=n("+Gkg");n.d(t,"a",function(){return i.a})},rFy5:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var i={"&nbsp;":"","&iexcl;":"","&cent;":"","&pound;":"","&curren;":"","&yen;":"","&brvbar;":"","&sect;":"","&uml;":"","&copy;":"","&ordf;":"","&laquo;":"","&not;":"","&shy;":"","&reg;":"","&macr;":"","&deg;":"","&plusmn;":"","&sup2;":"","&sup3;":"","&acute;":"","&micro;":"","&para;":"","&middot;":"","&cedil;":"","&sup1;":"","&ordm;":"","&raquo;":"","&frac14;":"","&frac12;":"","&frac34;":"","&iquest;":"","&Agrave;":"","&Aacute;":"","&Acirc;":"","&Atilde;":"","&Auml;":"","&Aring;":"","&AElig;":"","&Ccedil;":"","&Egrave;":"","&Eacute;":"","&Ecirc;":"","&Euml;":"","&Igrave;":"","&Iacute;":"","&Icirc;":"","&Iuml;":"","&ETH;":"","&Ntilde;":"","&Ograve;":"","&Oacute;":"","&Ocirc;":"","&Otilde;":"","&Ouml;":"","&times;":"","&Oslash;":"","&Ugrave;":"","&Uacute;":"","&Ucirc;":"","&Uuml;":"","&Yacute;":"","&THORN;":"","&szlig;":"","&agrave;":"","&aacute;":"","&acirc;":"","&atilde;":"","&auml;":"","&aring;":"","&aelig;":"","&ccedil;":"","&egrave;":"","&eacute;":"","&ecirc;":"","&euml;":"","&igrave;":"","&iacute;":"","&icirc;":"","&iuml;":"","&eth;":"","&ntilde;":"","&ograve;":"","&oacute;":"","&ocirc;":"","&otilde;":"","&ouml;":"","&divide;":"","&oslash;":"","&ugrave;":"","&uacute;":"","&ucirc;":"","&uuml;":"","&yacute;":"","&thorn;":"","&yuml;":"","&quot;":'"',"&amp;":"&","&lt;":"<","&gt;":">","&apos;":"'","&OElig;":"","&oelig;":"","&Scaron;":"","&scaron;":"","&Yuml;":"","&circ;":"","&tilde;":"","&ensp;":"","&emsp;":"","&thinsp;":"","&zwnj;":"","&zwj;":"","&lrm;":"","&rlm;":"","&ndash;":"","&mdash;":"","&lsquo;":"","&rsquo;":"","&sbquo;":"","&ldquo;":"","&rdquo;":"","&bdquo;":"","&dagger;":"","&Dagger;":"","&permil;":"","&lsaquo;":"","&rsaquo;":"","&euro;":"","&fnof;":"","&Alpha;":"","&Beta;":"","&Gamma;":"","&Delta;":"","&Epsilon;":"","&Zeta;":"","&Eta;":"","&Theta;":"","&Iota;":"","&Kappa;":"","&Lambda;":"","&Mu;":"","&Nu;":"","&Xi;":"","&Omicron;":"","&Pi;":"","&Rho;":"","&Sigma;":"","&Tau;":"","&Upsilon;":"","&Phi;":"","&Chi;":"","&Psi;":"","&Omega;":"","&alpha;":"","&beta;":"","&gamma;":"","&delta;":"","&epsilon;":"","&zeta;":"","&eta;":"","&theta;":"","&iota;":"","&kappa;":"","&lambda;":"","&mu;":"","&nu;":"","&xi;":"","&omicron;":"","&pi;":"","&rho;":"","&sigmaf;":"","&sigma;":"","&tau;":"","&upsilon;":"","&phi;":"","&chi;":"","&psi;":"","&omega;":"","&thetasym;":"","&upsih;":"","&piv;":"","&bull;":"","&hellip;":"","&prime;":"","&Prime;":"","&oline;":"","&frasl;":"","&weierp;":"","&image;":"","&real;":"","&trade;":"","&alefsym;":"","&larr;":"","&uarr;":"","&rarr;":"","&darr;":"","&harr;":"","&crarr;":"","&lArr;":"","&uArr;":"","&rArr;":"","&dArr;":"","&hArr;":"","&forall;":"","&part;":"","&exist;":"","&empty;":"","&nabla;":"","&isin;":"","&notin;":"","&ni;":"","&prod;":"","&sum;":"","&minus;":"","&lowast;":"","&radic;":"","&prop;":"","&infin;":"","&ang;":"","&and;":"","&or;":"","&cap;":"","&cup;":"","&int;":"","&there4;":"","&sim;":"","&cong;":"","&asymp;":"","&ne;":"","&equiv;":"","&le;":"","&ge;":"","&sub;":"","&sup;":"","&nsub;":"","&sube;":"","&supe;":"","&oplus;":"","&otimes;":"","&perp;":"","&sdot;":"","&lceil;":"","&rceil;":"","&lfloor;":"","&rfloor;":"","&lang;":"","&rang;":"","&loz;":"","&spades;":"","&clubs;":"","&hearts;":"","&diams;":""};function r(e){if("#"!==e.charAt(1))return i[e]||e;var t=e.charAt(2),n="x"===t||"X"===t?(t=e.substring(3,e.length-1),parseInt(t,16)):(t=e.substring(2,e.length-1),parseInt(t));return isNaN(n)?e:String.fromCharCode(n)}function o(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function a(e){return e.replace(/&#?\w+;/g,r)}},rPvU:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("7Kxq");function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).every(function(e){return i.c.includes(e)})}},"rQ+X":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("eq4C"),r=n("kUgE"),o=n("iP/4");function a(){return r.LANG_MAP.zh?i.d.ChineseFont:r.LANG_MAP.ja?i.d.JapaneseFont:i.d.EnglishFont}function s(){var e=a();return o.a.isSafari?e.replace(/^LarkEmojiFont, /,""):e}},"rT/R":function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var i=n("dVj6"),r=n.n(i),o=r()().addRange(19968,40869).addRange(40870,40907).addRange(13312,19893).addRange(131072,173782).addRange(173824,177972).addRange(177984,178205).addRange(12032,12245).addRange(11904,12019).addRange(63744,64217).addRange(194560,195101).addRange(59413,59503).addRange(58368,58856).addRange(58880,59087).addRange(12736,12771).addRange(12272,12283).addRange(12549,12576).addRange(12704,12730),a=r()().addRange(0,1114111).removeRange(19968,40869).removeRange(40870,40907).removeRange(13312,19893).removeRange(131072,173782).removeRange(173824,177972).removeRange(177984,178205).removeRange(12032,12245).removeRange(11904,12019).removeRange(63744,64217).removeRange(194560,195101).removeRange(59413,59503).removeRange(58368,58856).removeRange(58880,59087).removeRange(12736,12771).removeRange(12272,12283).removeRange(12549,12576).removeRange(12704,12730).removeRange(65,90).removeRange(97,122).removeRange(48,57).remove(39);function s(t,e){var n=0,i=new RegExp("(\\S*?)(("+e+")*)(\\S*?)(([a-zA-Z0-9]+'?)?[a-zA-Z0-9]*'?)","g"),r=0;function o(){i.lastIndex=r;var e=i.exec(t);return r=i.lastIndex,e}function a(){return s&&s[0]}var s=o();function c(){s[2]?n+=Array.from(s[2]).length:n+=0,s[5]&&"'"!==s[5]?n+=1:n+=0,s=o()}function l(){return n}return{counts:l,next:c,hasNext:a}}},rUU8:function(e,l,u){"use strict";(function(e){u.d(l,"e",function(){return o}),u.d(l,"d",function(){return a}),u.d(l,"f",function(){return s}),u.d(l,"b",function(){return c}),u.d(l,"c",function(){return t}),u.d(l,"a",function(){return i});var t,n,i,r,o=[{dataKey:"h1",className:"",des:"",dataId:"h1-btn",toolTips:{tipText:e("common.first_level_heading"),keyText:{osx:"+Option+1",other:"Ctrl+Alt+1"},markdown:!0},type:"style"},{dataKey:"h2",className:"",des:"",dataId:"h2-btn",toolTips:{tipText:e("common.second_level_heading"),keyText:{osx:"+Option+2",other:"Ctrl+Alt+2"},markdown:!0},type:"style"},{dataKey:"h3",className:"",des:"",dataId:"h3-btn",toolTips:{tipText:e("common.third_level_heading"),keyText:{osx:"+Option+3",other:"Ctrl+Alt+3"},markdown:!0},type:"style"},{dataKey:"h4",className:"",des:"",dataId:"h4-btn",toolTips:{tipText:e("common.forth_level_heading"),keyText:{osx:"+Option+4",other:"Ctrl+Alt+4"},markdown:!0},type:"style"},{dataKey:"h5",className:"",des:"",dataId:"h5-btn",toolTips:{tipText:e("common.fifth_level_heading"),keyText:{osx:"+Option+5",other:"Ctrl+Alt+5"},markdown:!0},type:"style"},{dataKey:"h6",className:"",des:"",dataId:"h6-btn",toolTips:{tipText:e("common.sixth_level_heading"),keyText:{osx:"+Option+6",other:"Ctrl+Alt+6"},markdown:!0},type:"style"},{dataKey:"h7",className:"",des:"",dataId:"h7-btn",toolTips:{tipText:e("common.seventh_level_heading"),keyText:{osx:"+Option+7",other:"Ctrl+Alt+7"},markdown:!0},type:"style"},{dataKey:"h8",className:"",des:"",dataId:"h8-btn",toolTips:{tipText:e("common.eighth_level_heading"),keyText:{osx:"+Option+8",other:"Ctrl+Alt+8"},markdown:!0},type:"style"},{dataKey:"h9",className:"",des:"",dataId:"h9-btn",toolTips:{tipText:e("common.ninth_level_heading"),keyText:{osx:"+Option+9",other:"Ctrl+Alt+9"},markdown:!0},type:"style"}],a=[{dataKey:"alignleft",className:"alignleft",des:"",dataId:"align-left-btn",toolTips:{tipText:e("editorbar.align_left"),keyText:{osx:"+Shift+L",other:"Ctrl+Shift+L"}},type:"style"},{dataKey:"aligncenter",className:"aligncenter",des:"",dataId:"align-center-btn",toolTips:{tipText:e("editorbar.align_center"),keyText:{osx:"+Shift+E",other:"Ctrl+Shift+E"}},type:"style"},{dataKey:"alignright",className:"alignright",des:"",dataId:"align-right-btn",toolTips:{tipText:e("editorbar.align_right"),keyText:{osx:"+Shift+R",other:"Ctrl+Shift+R"}},type:"style"}],s=[{dataKey:"alignleft",className:"alignleft",des:"",dataId:"align-left-btn",toolTips:{tipText:e("editorbar.align_left")}},{dataKey:"aligncenter",className:"aligncenter",des:"",dataId:"align-center-btn",toolTips:{tipText:e("editorbar.align_center")}},{dataKey:"alignright",className:"alignright",des:"",dataId:"align-right-btn",toolTips:{tipText:e("editorbar.align_right")}}],c={POPUP_GAP:8,POPUP_GAP_TABLE_CELL:6,POPUP_HEIGHT:50,HEADER_BAR_HEIGHT:64,POPUP_BTN_WIDTH:32,POPUP_WIDTH:{READONLY_TEXT:58,TEXT:450,IMAGE:203},TOOLTIP_PLACEMENT:"top"};(n=t=t||{}).MOUSE_ENTER_SELECTION_POPOVER="MOUSE_ENTER_SELECTION_POPOVER",n.MOUSE_LEAVE_SELECTION_POPOVER="MOUSE_LEAVE_SELECTION_POPOVER",(r=i=i||{}).BLOCK="BLOCK",r.TEXT="TEXT",r.EMPTY="EMPTY"}).call(this,u("2vAP"))},rWdK:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var i=n("MFtX"),r=function(e){return e.doc&&e.doc.jira||i.a},o=function(e){return r(e).syncStatus},a=function(e){return r(e).authStatus},s=function(e){return r(e).initDataMap}},raF6:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("lSNA"),f=n.n(i),r=n("RIqP"),s=n.n(r),o=n("lwsE"),a=n.n(o),c=n("CpTu"),p=n("Nwwt"),l=n("HmyT"),u=n("iP/4"),g=n("nN3d"),m=n("y2sV"),d=function e(t){var h=this;a()(this,e),this.className="GDCopySupport",this.UNSAFE_editorNormalizePasteNode=function(e){var t,n,i,r,o=e.data.node,a=e.types;!Object(c.a)(a,function(e){return"text/plain"===e})||(t=o.querySelector("[id^=docs-internal-]"))&&(Object(l.$)(o).find("td").removeAttr("style"),Object(l.$)(o).find("table.ace-table").removeAttr("style"),!u.a.isEdge||(n=o.childNodes).length&&s()(n).forEach(function(e){e.id=o.id}),i=o.querySelectorAll("img"),s()(i).forEach(function(e){0===e.width&&0===e.height&&e.parentNode.removeChild(e)}),"B"===t.tagName&&(h.getBoldType(t)||((r=document.createElement("span")).setAttribute("id",o.id),r.innerHTML=o.innerHTML,t.parentNode.innerHTML=r.outerHTML)))},this.deserialize=function(e){var t,n,i,r,o,a,s,c=e.node,l=e.deltaSet,u=e.zoneId,d=l;return c instanceof HTMLElement&&(t=c.tagName,n=c.getAttribute("style")||"",h.isFromGoogle(c)&&(i=h.getHeadingType(t.toLowerCase(),n),r="A"===t,o=h.getBoldType(n),i&&(d=Object(m.I)(l,u,{heading:i})),r&&(a=Object(p.a)(c),s="url-".concat(Object(g.c)(10)),d=Object(m.H)(d,u,f()({},s,a))),o&&(d=Object(m.H)(d,u,{bold:"true"})))),d},this.isFromGoogle=function(e){return e.id&&-1<e.id.indexOf("docs-internal")},this.getBoldType=function(e){var t=e&&/\bfont-weight:\s*(\d+)/i.exec(e);return t?700<=parseInt(t[1],10)?"bold":void 0:null},this.getHeadingType=function(e,t){if(/^h[1-3]$/.test(e))return e},this.headingReg=new RegExp(/h(\d+)/)};new d},rbSl:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("J4zp"),E=n.n(i);function O(e,t){var n=e.lines.atIndex(t);return n?n.lineMarker:0}function C(e,t){var n=e.lines.atIndex(t);return n?n.text.length:0}function r(e){var t=e.editor,n=e.attrib,i=e.checkSelLineFirst,r=void 0!==i&&i,o=E()(n,1)[0];if(r){var a=t.getRep(),s=a.zoneId,c=a.selStart[0],l={selStart:[c,O(a,c)],selEnd:[c,C(a,c)]},u=t.getMatchedAttributeOnSelection(s,l,o);if(0<u.length)return u[0]}for(var d=t.getReps(),h=String(n),f=0,p=Object.keys(d);f<p.length;f++){var g=p[f],m=d[g];if(void 0!==m.apool.getAttribNum(h)){var v=m.lines.length()-1,b={selStart:[0,0],selEnd:[v,C(m,v)]},y=t.getMatchedAttributeOnSelection(g,b,o);if(0<y.length)return y[0]}}return null}},s1mk:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("ywOK"),c=function(){function t(e){r()(this,t),this.handler=e,this.isDataReady=!1,this.isRenderSuccess=!1}return a()(t,[{key:"dataReady",value:function(e,t){this.isDataReady||(this.isDataReady=!0,s.c.updateStage(e,t))}},{key:"didUpdate",value:function(e,t){!this.isRenderSuccess&&this.isDataReady&&(this.isRenderSuccess=!0,s.c.updateStageByNextRender(e,t),this.handler&&this.handler.onFirstRenderAfterDataReady&&this.handler.onFirstRenderAfterDataReady())}},{key:"switchDocToken",value:function(){this.isDataReady=!1,this.isRenderSuccess=!1}}]),t}()},s2gw:function(e,t,n){},s4BX:function(e,t,n){},soGB:function(e,l,u){"use strict";(function(e){u.d(l,"d",function(){return t}),u.d(l,"a",function(){return v}),u.d(l,"h",function(){return n}),u.d(l,"g",function(){return i}),u.d(l,"i",function(){return r}),u.d(l,"c",function(){return o}),u.d(l,"b",function(){return a}),u.d(l,"e",function(){return s}),u.d(l,"f",function(){return c});u("o0o1"),u("RIqP"),u("yXPU");var f=u("FJEn"),p=u("YWBl"),g="toggle_heading_collapse",m="toggle_heading_expand",t={expandSection:e("doc.toggle.expand"),collapseSection:e("doc.toggle.collapse")},v="set-collapse";function n(e,t){var n=e.selStart,i=e.selEnd,r=e.zoneId;return{selStart:[n[0],t],selEnd:i.slice(0,2),selZone:r||n[2]}}function i(e,t){var n=t.lines.atIndex(e),i=n.width;return{selStart:[e,n.lineMarker],selEnd:[e,i-1],selZone:t.zoneId}}function r(e,t,n,i){document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement!==document.body&&document.activeElement.blur();var r="toggle_button";o(e,t,n,e.isEditable(),!1,r)}function o(n,e,i,r,o,t){var a=e.selStart,s=e.selEnd,c=e.selZone;a.toString()===s.toString()&&1===a[1]&&(a[1]=0);var l=n.getRep();l.zoneId!==c&&(n.setWithSelection(c,s,s),n.updateBrowserSelectionFromRep(!0),l=n.getRep());var u,d,h=[];n.inCallStackIfNecessary(v,function(){var e=o||!r?f.config.LOCAL:"",t=i?"":"true",t=(o||e)&&""===t?"false":t;h.push(["collapse",t]),n.fastIncorp(),n.performDocumentApplyAttributesToRange(a,s,h,e)}),t&&(u=i?m:g,d=l.attributeManager.getAllAttributesOnLine(a[0]).find(function(e){return"heading"===e[0]}),Object(p.a)({action:u,source:t,objectType:d[1].toUpperCase()}))}function a(e,t,n,i,r){o(e,t,n,i,!0,r)}function s(e,t,n){var i=e.lineTracker.collapseLines;if(!i)return n;for(var r=n;0<=r;){var o=i.getCollapsedStatusOfSelection({selZone:t,selStart:[r,0],selEnd:[r,0]});if(0===o.length)return r;var a=o[0];if(!a)return null;if(r===n&&!a.renderCollapsed)return r;if(a.renderCollapsed&&a.startOfCollapseSection)return r;--r}return null}function c(e,t,n){var i=e.lineTracker.collapseLines;if(!i)return n;for(var r=e.getRep(t).alines.length-1,o=n;o<=r;){var a=i.getCollapsedStatusOfSelection({selZone:t,selStart:[o,0],selEnd:[o,0]});if(0===a.length)return o;var s=a[0];if(!s)return null;if(!s.renderCollapsed||s.startOfCollapseSection)return o;o+=1}return null}}).call(this,u("2vAP"))},sxjD:function(e,t,n){"use strict";n.d(t,"a",function(){return J});var i,r=n("J4zp"),u=n.n(r),o=n("cDf5"),_=n.n(o),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),l=n.n(c),w=n("NFsq"),f=n("CpTu"),p=n("7EGn"),d=n("M55E"),g=n.n(d),h=n("PyL4"),j=n("7Kxq"),M=n("YWBl"),L=n("iP/4"),m=n("yEIg"),v=n("/spq"),b=n("HmyT"),R=n("HIeq"),N=n("kESg"),D=n("+4eN"),y=n("PmjA"),E=n("zTCG"),O=n("Poi8"),C=n("Hj9z"),k=n("2ACu"),I=n("TWwi"),S=n("Zda9"),T=n("ZuTZ"),x=n("wMS7"),P=n.n(x),B=n("fMYX"),U=8,z=86,H=90,F=32,V=189,W=192,K=52,Z=L.a.isEdge,q=null,Y=!1,J=Object(v.a)(["aceKeyEvent"])(i=function(){function t(e){var h=this;s()(this,t),this.className="Markdown",this.markdownMap={heading:{regExp:/^(#{1,9}\s)(\S*|\S+[\s\S]*)$/,match:function(e){var t=this.regExp.exec(e);return t?{key:"heading",value:"h".concat(t[1].length-1),type:"line",replaceLen:t[1].length,active:"heading-h".concat(t[1].length-1)}:null},format:function(e){var t=/<h(\d) .*>(.*)<\/h\d>/.exec(e);return t?"<div class='heading-h".concat(t[1],"'>").concat(t[2],"</div>"):e}},blockQuote:{regExp:/^([>]\s)(\S*|\S+[\s\S]*)$/,match:function(e){var t=this.regExp.exec(e);return t?{key:"blockquote",value:"blockquote",type:"line",replaceLen:t[1].length,active:"reference"}:null},format:function(e){var t=/<blockquote>(.*)<\/blockquote>/.exec(e);return t?"<div class='blockquote'>".concat(t[1],"</div>"):e}},ul:{regExp:/^([*]+\s)(\S*|\S+[\s\S]*)$|^([-]+\s)(\S*|\S+[\s\S]*)$/,match:function(e){var t=this.regExp.exec(e);if(!t)return null;var n=t[1]||t[3];return{key:"list",value:"bullet".concat(n.length-1),type:"line",replaceLen:n.length,active:"list-bullet"}}},ol:{regExp:/^([1-9][0-9]*\.\s)(\S*|\S+[\s\S]*)$/,match:function(e){var t=this.regExp.exec(e);return t?{key:"list",value:"number1",type:"line",replaceLen:t[1].length,start:parseInt(t[1],10),active:"list-number"}:null},format:function(e){var t=/<ol(?:\s+\S*)*><li(?:\s+\S*)*>(.*)<\/li><\/ol>/.exec(e);return t?"<ol class='list-number1'><li>".concat(t[1],"</li></ol>"):e}},codeBlock:{regExp:/^```$/,disable:function(e){return e===N.l.CalloutBlock},match:function(e){return this.regExp.exec(e)?Object(I.a)()?(Object(S.k)(),null):{key:"list",value:"code1",type:"line",replaceLen:3,start:1,active:y.a}:null},format:function(e){return/<pre><code(\s.*){0,1}>/.exec(e)?e.replace(/<code(\s[^>]*){0,1}>/,'<code class="list-code1">').replace(/\n/,"<br/>"):e}},codeBlockV2:{regExp:/^```([a-zA-Z0-9+]*)\s$/,disable:function(e){return e===N.l.CalloutBlock},match:function(e){var t=this.regExp.exec(e);return t&&Object(I.a)()?{key:N.k.ZoneType,value:N.l.CodeBlock,replaceLen:e.length,lang:t[1],active:y.a}:null}},checkbox:{regExp:/^((\[\]\s)|(\u3010\u3011\s))(\S*|\S+[\s\S]*)$/,match:function(e){var t=this.regExp.exec(e);return t?{key:"list",value:"check1",type:"line",replaceLen:t[1].length,active:"checkbox"}:null},format:function(e){return/^<p>(\[\]\s)(\S*|\S+[\s\S]*)<\/p>$/.exec(e)?e.replace("<p>[] ","<ul class='list-check1'><li>").replace("</p>","</li></ul>"):e}},horizontal:{regExp:/^---$|^\*\*\*$/,match:function(e){var t=this.regExp.exec(e);return t?{name:"horizontal-line",value:"true",type:"inline",replaceRight:!1,execLen:3,replaceLen:t[0].length,startReplacePos:t.index,endReplacePos:t.index+t[0].length,textLen:0,active:"insertseparator"}:null},doInsert:function(e,t,n,i){e.doInserHorizontalLine(e)}},bold:{regExp:/\*\*(\S+.*\S+)\*\*\s/,match:function(e){var t=this.regExp.exec(e);if(!t)return null;var n=t[1];return n&&/[^_|^*]/.test(n)?{type:"inline",name:"bold",value:"true",replaceRight:!0,execLen:2,replaceLen:t.index+n.length+5,startReplacePos:t.index,endReplacePos:t.index+n.length,textLen:n.length,active:"bold"}:null},format:function(e){return e.replace(/<strong>/g,"<b>").replace(/<\/strong>/g,"</b>")}},inlineCode:{regExp:/`(\S*|\S+[\s\S]*)`/,match:function(e){var t=this.regExp.exec(e);if(!t)return null;var n=t[1];return n&&"`"!==n&&/[^_|^*]/.test(n)?{type:"inline",name:"inline-code",value:"true",replaceRight:!0,execLen:1,replaceLen:t.index+n.length+2,startReplacePos:t.index,endReplacePos:t.index+n.length,textLen:n.length,active:"inline-code"}:null}},italic:{regExp:/(\*+)(\S+.*\S+)(\*+)\s/,match:function(e){var t=this.regExp.exec(e);if(!t)return null;var n=t[1],i=t[2];return i&&!(1<n.length)&&/[^_|^*]/.test(i)?{type:"inline",name:"italic",value:"true",replaceRight:!0,execLen:1,replaceLen:t.index+i.length+3,startReplacePos:t.index,endReplacePos:t.index+i.length,textLen:i.length,active:"italic"}:null},format:function(e){return e.replace(/<em>/g,"<i>").replace(/<\/em>/g,"</i>")}},underline:{regExp:/(~+)(\S+.*\S+)(~+)\s/,match:function(e){var t=this.regExp.exec(e);if(!t)return null;var n=t[1],i=t[2];return i&&!(1<n.length)&&/[^~]/.test(i)?{type:"inline",name:"underline",value:"true",replaceRight:!0,execLen:1,replaceLen:t.index+i.length+3,startReplacePos:t.index,endReplacePos:t.index+i.length,textLen:i.length,active:"underline"}:null},format:function(e){var t=/(~)[^~]\S*\s*(~)/,n=t.exec(e);return n?2<n[0].length?e.replace(t,function(e){return"<u>".concat(e.substr(1,e.length-2),"</u>")}):void 0:e}},strikethrough:{regExp:/~~(\S+.*\S+)~~\s/,match:function(e){var t=this.regExp.exec(e);if(!t)return null;var n=t[1];return n&&/[^~]/.test(n)?{type:"inline",name:"strikethrough",value:"true",replaceRight:!0,execLen:2,replaceLen:t.index+n.length+5,startReplacePos:t.index,endReplacePos:t.index+n.length,textLen:n.length,active:"strikethrough"}:null},format:function(e){return e.replace(/<del>/g,"<s>").replace(/<\/del>/g,"</s>")}},equation:{regExp:/\$\$([\s\S]*)\$\$/,equation:"",match:function(e){var t=this.regExp.exec(e);if(!t)return null;var n=(this.equation=t[1]).length;return{type:"inline",name:"equation",value:"true",replaceRight:!1,execLen:n+4,replaceLen:t.index+n+4,startReplacePos:t.index,endReplacePos:t.index+n,textLen:n,active:"equation"}},doInsert:function(e){Object(k.default)("toggle_attribute",{action:"insert_tex_block",source:"markdown"}),C.equationInsert.insert({editor:e,props:{data:{equation:this.equation}}})}}},this.aceInitialized=function(e,t){h.editorInfo=t.editorInfo},this.getTabLevel=function(e,t,n,i){if(!/bullet[0-9]+/.exec(e)&&!("number1"===e))return!1;var r=n.attributeManager.findAttributeOnLine(i,"text-indent");if(!r)return!1;var o=/([a-z]+)([0-9]+)/.exec(t.getLineListType(n.zoneId,i)),a=0;return o&&(a=Number(o[2])),r&&(a+=2),a},this.performText=function(e,t){for(var n=e.editorInfo,i=e.rep,r=i.selStart[0],o=i.selEnd[1],a=1===o?[]:i.attributeManager.getAttributesOnSelection([r,o-1],[r,o-1],i,!1).attribs,s=!1,c=0;c<a.length;++c)"author"===a[c][0]&&(a[c][1]=n.getAuthor(),s=!0),m.b.includes(a[c][0])&&a.splice(c,1);s||a.push(["author",n.getAuthor()]),n.performDocumentReplaceRangeWithAttributes(i.zoneId,[r,o],[r,o],t,a)},this.createHtml=function(e){var t=L.a.windows?/\r\n/:/\n|\r/,n=["<li","<ul","<ol","<h1","<h2","<h3","<h4","<h5","<h6","<h7","<h8","<h9","<blockquote","<code","<table","<em","<strong"],i=e.split(t).map(function(e){return e.replace(/^( *)(\[([x ])?\]) /,"$1- $2 ")}).join("\n"),r="",o=!1,a=new g.a.Converter;a.setFlavor("github"),a.setOption("ghMentions",!1),a.setOption("simplifiedAutoLink",!0),a.setOption("underline",!0),r=a.makeHtml(i),n.forEach(function(e){if(-1!==r.indexOf(e))return o=!0}),r=r.split("\n");var s=!1;-1!==(r=r.map(function(e){return s&&-1===e.indexOf("</p>")?"<p>".concat(e,"</p>\n"):0===e.indexOf("<p>")&&-1===e.indexOf("</p>")?(s=!0,"".concat(e,"</p>\n")):-1===e.indexOf("<p>")&&-1!==e.indexOf("</p>")?(s=!1,"<p>".concat(e)):(s=!1,e)}).join("\n")).indexOf("<code")&&(r=r.replace(/<code>[\s\S]*<\/code>/g,function(e){return e.replace(/&amp;/g,"&")}));var c=/>([\n]+)</g;return{html:r=r.replace(c,"><"),hasMarkdown:o}},this.UNSAFE_editorNormalizePasteNode=function(e){var t=e.data.node;t.querySelector("pre")&&Object(b.$)(t).find("code").addClass("list-code")},this.maybePasteMarkdown=function(e){if(!e)return!1;var t=h.createHtml(e),n=t.html;return!!t.hasMarkdown&&n},this.acePaste=function(e,t){var n=t.e,i=t.text,r=t.pasteDataWrapper,o=h.editorInfo.getRep(),a=o.selStart[0];if(-1<h.editorInfo.getLineListType(o.zoneId,a).indexOf("code")||Object(O.i)(h.editorInfo,o.zoneId))return!1;var s=n.clipboardData||n.originalEvent.clipboardData||window.clipboardData,c=Object(p.default)(s,"types",[]);if(Object(f.a)(c,function(e){return!["text/plain","text/html"].includes(e)})||Y||!i||!c.includes("text/plain"))return Y=!1;if(r.querySelector(".ace-line")||r.querySelector(".".concat(T.b)))return!1;var l=h.maybePasteMarkdown(P.a.sanitize(i));if(!l)return!1;var u=document.createElement("div");if(u.innerHTML=l,c.includes("text/html")&&(!Object(I.a)()||!u.querySelector("pre > code")))return!1;n.stopImmediatePropagation();var d=h.handleListHtml(u,o)||l,d=h.handleCodeBlockV2HTML(u)||d;return t.pasteDataWrapper.innerHTML=d,!0},this.handleListHtml=function(e,t){if(Object(b.$)(e).find("ol").length<=0)return"";var n=e.firstChild;n&&"meta"===Object(R.f)(n)&&(n=n.nextSibling);for(var i=t.selStart[0],r=t.attributeManager.findAttributeOnLine(i-1,"ol-id"),o={},a=/ol-id([\w]{8})/,s=t.attributeManager.findAttributeOnLine(i,"ol-id")||r;n&&n.tagName;){var c,l=n.className,u=a.exec(l);c=u?(o[u[0]]||(o[u[0]]=s||Object(R.c)()),o[u[0]]):"ol"===n.tagName.toLowerCase()?s||Object(R.c)():"",h.addListId(n,c),s=c,n=n.nextSibling}return e.innerHTML},this.addListId=function(e,t){t&&(Object(b.$)(e).removeClass(function(e,t){return(t.match(/ol-id([\w]{8})/g)||[]).join(" ")}),Object(b.$)(e).addClass("ol-id".concat(t)))},this.pluginEnterMindmapDocs=function(){q=h.markdownMap.heading,delete h.markdownMap.heading},this.pluginExitMindmapDocs=function(){h.markdownMap.heading=q},this.destory=function(){h.editorInfo=null},this.shouldContinue=!0,this.lastInternationalComposition=!1,this.lastKeydownStatus=!1,this.keydownStatus=!1,e&&(this.editorInfo=e,this.aceInitialized("",Object.assign({editorInfo:e},e)))}return l()(t,[{key:"inTitleLine",value:function(){var e=this.editorInfo.getRep();return 0===e.selStart[0]&&"0"===e.zoneId}},{key:"isSpecialKey",value:function(e){var t=e.key,n=e.keyCode,i=e.originalEvent.code;if(229===n)return!0;var r=e.metaKey||e.ctrlKey;return"~"===t||"`"===t||n===W||("*"===t||"8"===t)&&!r||("-"===t||n===V||"Minus"===i)||("$"===t||n===K)}},{key:"isInKeydownStatusWithoutKeycode",value:function(e){var t="keydown"===e.type,n=229===e.keyCode;return t&&n}},{key:"aceKeyEvent",value:function(e,c){var l=this,u=c.evt,d=c.editorInfo,t=u.keyCode,n=u.key,i=u.type,r=u.which,o=u.metaKey,a=u.shiftKey,s=u.ctrlKey,h=d.getInInternationalComposition(),f=t===H;if((o||s)&&a&&t===z&&(Y=!0),!this.inTitleLine()&&d.isCaret()){var p=d.getRep(),g=Object(D.n)(d,p.zoneId);if(g!==N.l.CodeBlock){var m,v,b=!h&&this.lastInternationalComposition&&L.a.isSafari;if(" "===n&&(h||b)&&"keydown"===i)return this.shouldContinue=!1;if("keyup"===i&&!this.shouldContinue)return!(this.shouldContinue=!0);if(this.lastInternationalComposition=h,this.lastKeydownStatus=this.keydownStatus,this.keydownStatus=this.isInKeydownStatusWithoutKeycode(u),!L.a.isSafari&&this.keydownStatus)return!1;if(!Z&&h)return!1;if(h&&Z&&"keyup"!==i)return!1;if(f)return!1;if(65<=t&&t<=90)return!1;if(37<=r&&r<=40)return!1;if(!this.isSpecialKey(u)&&!(t===F||" "===n))return!1;if(t===U)return!1;var y=p.selEnd[1],E="";if((!this.keydownStatus&&this.lastKeydownStatus||L.a.isX5)&&"keyup"===i){if(null===p.selStart)return!1;if(d.fastIncorp(),p=d.getRep(),v=p.selStart[0],-1<d.getLineListType(p.zoneId,v).indexOf("code"))return;m=p.lines.atIndex(v);var O=p.selEnd[1],C=Z&&h?m.lineNode.innerText:m.text.substr(m.lineMarker,O-m.lineMarker)}else{if("keydown"!==i||null===p.selStart||L.a.isX5)return!1;if(d.fastIncorp(),!p.selEnd)return!1;if(y=p.selEnd[1],v=p.selStart[0],-1<d.getLineListType(p.zoneId,v).indexOf("code"))return;if(!d.isCaret())return;this.isInKeydownStatusWithoutKeycode(u)||(E="spacebar"===n.toLowerCase()?" ":n),m=p.lines.atIndex(v);var k=p.selEnd[1];C=m.text.substr(m.lineMarker,k-m.lineMarker)+E}var I,S=function(e){var r=l.markdownMap[e];if(r.disable&&r.disable(g))return"continue";var o=r.match(C),a=!1;if(o){Z&&h&&(d.fastIncorp(!0),p=d.getRep(),m=p.lines.atIndex(v),y=p.selEnd[1]),E&&(u.preventDefault(),l.performText(c,E),E="");var t=m.lineMarker+o.replaceLen,n=p.selEnd[1]>t&&y<t;if(t!==p.selEnd[1]&&!n)return"continue";var i,s=l.editorInfo.hook.callAll("markdownMatched",o);return Object(w.a)(s,!0)?{v:void 0}:("line"===o.type?(!(i=d.getAttributeOnLine(p.zoneId,v,o.key))||i&&i!==o.value)&&d.makeNewEvent("macro",function(){var e,t,n,i,r;d.performDocumentReplaceRange(p.zoneId,[v,m.lineMarker],[v,m.lineMarker+o.replaceLen],""),-1<o.value.indexOf("code")?(d.performDocumentReplaceRange(p.zoneId,[v,0],[v,m.lineMarker],""),d.setLineListType(p.zoneId,v,o.value)):o.start?((e=l.getTabLevel(o.value,d,p,v))&&(o.value="number".concat(e),p.attributeManager.removeAttributeOnLine(v,"text-indent")),t=!1,1===o.start&&(t=!0),n=l.editorInfo.getClosetListNumberId(p.zoneId,o.value,p,!1,{editOneAfterOlList:t})||Object(R.c)(),d.setLineListTypeWithStart(p.zoneId,v,o.value,o.start,o.start,n)):((i=l.getTabLevel(o.value,d,p,v))&&(r=i+o.replaceLen-2,o.value="bullet".concat(r),p.attributeManager.removeAttributeOnLine(v,"text-indent")),d.setAttributeOnLine(p.zoneId,v,o.key,o.value),"list"===o.key&&o.value.includes("check")&&d.setAttributeOnLine(p.zoneId,v,B.a,Object(B.d)()))}):"inline"===o.type&&d.makeNewEvent("macro",function(){var e=[v,m.lineMarker+o.startReplacePos],t=[v,m.lineMarker+o.endReplacePos],n=[v,m.lineMarker+o.startReplacePos],i=[v,m.lineMarker+o.startReplacePos+o.textLen];d.performDocumentReplaceRange(p.zoneId,e,[v,e[1]+o.execLen],""),o.replaceRight?(d.performDocumentReplaceRange(p.zoneId,t,[v,t[1]+o.execLen],""),a=d.toggleAttributeOnSelection(o.name,Object.assign({},p,{selStart:n,selEnd:i}))):r.doInsert&&r.doInsert(d,m,n,i)}),Object(M.a)({action:o.active,op:a?j.g:j.f,source:"markdown"}),{v:void 0})}};for(I in this.markdownMap){var T=S(I);if("continue"!==T&&"object"===_()(T))return T.v}}}}},{key:"deserialize",value:function(e){var t=e.text,n=e.deltaSet,i=e.types,r=this.editorInfo.getRep(),o=u()(r.selStart,1)[0],a=r.zoneId,s=this.editorInfo.getLineListType(a,o);if(!t||1<i.length||!i.includes("text/plain")||Y||-1<s.indexOf("code"))return Y=!1,n;if(this.inTitleLine())return n;if(Object(O.i)(this.editorInfo,a))return n;var c=this.maybePasteMarkdown(Object(h.escapeHTML)(t)).replace(/&amp;/g,"&");if(!c)return n;var l=document.createElement("div");return l.innerHTML=c,c=this.handleListHtml(l,r)||c,c=this.handleCodeBlockV2HTML(l)||c,this.editorInfo.clipboard.deserialize({html:c,types:["text/html"]})||n}},{key:"handleCodeBlockV2HTML",value:function(e){var t=e.querySelectorAll("pre > code");return t.length<=0||!Object(I.a)()?"":(t.forEach(function(e){var t=e.parentElement,n=document.createElement("code"),i=Object(O.d)(e),r=i.lang,o=i.specified,a=Object(O.b)(e.innerHTML),s=a.html,c=a.length;r&&Object(O.a)({lang:r,source:"paste",rows:c}),n.innerHTML=s,n.className=E.a.CODE_BLOCK,t.innerHTML=n.outerHTML,t.className=E.a.SPAN+(o?" lang-".concat(r):"")}),e.innerHTML)}}]),t}())||i;new J},"t+1L":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("D28M"),s=function(e,t,n){var i=n.getReps()[e];if(!(t>=i.alines.length)){var r=i.attributeManager.getAllAttributesOnLine(t),o=!1;return(r.some(function(e){return o=c(e)||l(e)||u(e)||d(e)}),o)?!0:""!==h(n,i,t).replace(/\u200B/g,"")}},i=function(e,t,n){var i=n.getReps()[e];if(!(t>=i.lines.length())){var r=i.lines.atIndex(t);if(r&&r.isActive){var o=r&&r.domInfo&&Object(a.i)(r.domInfo.node)&&r.domInfo.node.textContent;return o&&""!==o.replace(/\u200B/g,"")||s(e,t,n)}return s(e,t,n)}},c=function(e){return"list"===e[0]},l=function(e){return"blockquote"===e[0]},u=function(e){return"gallery"===e[0]&&"image"===JSON.parse(e[1]).items[0].type||"imageUpload"===e[0]},d=function(e){return"dataMetaBlockProps"===e[0]&&!!e[1]&&"sheet"===JSON.parse(e[1]).engineType},h=function(e,t,n){var i={selStart:[n,0],selEnd:[n,t.alinesWidth[n]-1],selZone:t.zoneId},r=e.getTextAndAttrsOnSelection(i);return r.length?r[0].text:""}},t2s0:function(e,t,n){"use strict";n.d(t,"h",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"j",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"d",function(){return d}),n.d(t,"c",function(){return h}),n.d(t,"k",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"f",function(){return g}),n.d(t,"b",function(){return m});var i=n("7EGn"),r=n("rLED"),o=Object(r.e)("wiki_enabled"),a=function(e,t){return(!t||t.every(Boolean))&&o&&Object(r.e)(e)},s=Object(r.I)("wiki_relation_enabled",Boolean(Object(i.default)(window,"ssr_wikiEnable"))),c=a("wiki_advanced_search_enabled"),l=a("wiki_search_list_entrance"),u=a("create_wiki_in_space"),d=a("wiki_intergate_space_enabled"),h=a("wiki_copy_enabled"),f=a("wiki_space_setting_enable"),p=a("wiki_new_layout_enabled"),g=a("wiki_support_sheet_enabled",[p]),m=a("new_rename_ui_enabled",[p])},t3UV:function(e,t,n){},t5Ac:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c});var i=n("D7h9"),r=n("5cZX"),o=n("ZGZ5"),a=n("vc5i");function s(){var e=i.default.getState(),t=Object(r.L)(e),n=Object(r.w)(e);return{canCross:n.get("canCross"),externalAccess:n.get("externalAccess"),inviteExternal:n.get("inviteExternal"),publicPermission:t}}function c(){var e=i.default.getState(),t=Object(o.a)(e),n=Object(a.i)(e);return t.get("id")===n.get("id")}},t73A:function(e,t,n){},tAHg:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("r0DX"),c=function(){function t(e){r()(this,t),this.emit=e}return a()(t,[{key:"destroy",value:function(){this.emit=null}},{key:"on",value:function(e,t){this.emit.on(e,t)}},{key:"off",value:function(e,t){this.emit.off(e,t)}},{key:"onInsertGuide",value:function(e){this.emit.on(s.o,e)}},{key:"offInsertGuide",value:function(e){this.emit.off(s.o,e)}},{key:"insertGuide",value:function(e){this.emit.trigger(s.o,[e])}},{key:"onShowToolbar",value:function(e){this.emit.on(s.t,e)}},{key:"offShowToolbar",value:function(e){this.emit.off(s.t,e)}},{key:"showToolbar",value:function(e,t){this.emit.trigger(s.t,[e,t])}},{key:"onHideToolbar",value:function(e){this.emit.on(s.m,e)}},{key:"offHideToolbar",value:function(e){this.emit.off(s.m,e)}},{key:"hideToolbar",value:function(e,t){this.emit.trigger(s.m,[e,t])}},{key:"onAtUser",value:function(e){this.emit.on(s.g,e)}},{key:"offAtUser",value:function(e){this.emit.off(s.g,e)}},{key:"atUser",value:function(e){this.emit.trigger(s.g,[e])}},{key:"onGenerateReminder",value:function(e){this.emit.on(s.l,e)}},{key:"offGenerateReminder",value:function(e){this.emit.off(s.l,e)}},{key:"generateReminder",value:function(e,t,n){this.emit.trigger(s.l,[e,t,n])}},{key:"onClickReminder",value:function(e){this.emit.on(s.h,e)}},{key:"offClickReminder",value:function(e){this.emit.off(s.h,e)}},{key:"clickReminder",value:function(e,t,n){this.emit.trigger(s.h,[e,t,n])}},{key:"onHoverReminder",value:function(e){this.emit.on(s.n,e)}},{key:"offHoverReminder",value:function(e){this.emit.off(s.n,e)}},{key:"hoverReminder",value:function(e,t,n,i){this.emit.trigger(s.n,[e,t,n,i])}},{key:"onSetReminderProps",value:function(e){this.emit.on(s.r,e)}},{key:"offSetReminderProps",value:function(e){this.emit.off(s.r,e)}},{key:"setReminderProps",value:function(e,t){this.emit.trigger(s.r,[e,t])}},{key:"onClickAddReminderBtn",value:function(e){this.emit.on(s.i,e)}},{key:"offClickAddReminderBtn",value:function(e){this.emit.off(s.i,e)}},{key:"clickAddReminderBtn",value:function(e){this.emit.trigger(s.i,[e])}},{key:"onCollectBeforeChangeRep",value:function(e){this.emit.on(s.j,e)}},{key:"offCollectBeforeChangeRep",value:function(e){this.emit.off(s.j,e)}},{key:"collectBeforeChangeRep",value:function(){this.emit.trigger(s.j)}},{key:"onPropsChange",value:function(e){this.emit.on(s.p,e)}},{key:"offPropsChange",value:function(e){this.emit.off(s.p,e)}},{key:"propsChange",value:function(e,t){this.emit.trigger(s.p,[e,t])}},{key:"onTogglePlaceholder",value:function(e){this.emit.on(s.u,e)}},{key:"offTogglePlaceholder",value:function(e){this.emit.off(s.u,e)}},{key:"togglePlaceholder",value:function(e,t){this.emit.trigger(s.u,[e,t])}},{key:"onReminderDelete",value:function(e){this.emit.on(s.k,e)}},{key:"offReminderDelete",value:function(e){this.emit.off(s.k,e)}},{key:"reminderDelete",value:function(e){this.emit.trigger(s.k,[e])}},{key:"onRefreshToolbar",value:function(e){this.emit.on(s.q,e)}},{key:"offRefreshToolbar",value:function(e){this.emit.off(s.q,e)}},{key:"refreshToolbar",value:function(e){this.emit.trigger(s.q,[e])}},{key:"onKeyDownEvent",value:function(e){this.emit.on(s.b,e)}},{key:"offKeyDownEvent",value:function(e){this.emit.off(s.b,e)}},{key:"keyDownEvent",value:function(e){this.emit.trigger(s.b,[e])}},{key:"showGuide",value:function(e){this.emit.trigger(s.s,[e])}},{key:"onShowGuide",value:function(e){this.emit.on(s.s,e)}},{key:"offShowGuide",value:function(e){this.emit.off(s.s,e)}},{key:"onUpdateDomLine",value:function(e){this.emit.on(s.v,e)}},{key:"updateDomLine",value:function(e,t){this.emit.trigger(s.v,[e,t])}},{key:"offUpdateDomLine",value:function(e){this.emit.off(s.v,e)}},{key:"updatePlaceholder",value:function(e){this.emit.trigger(s.w,[e])}},{key:"onUpdatePlaceholder",value:function(e){this.emit.on(s.w,e)}},{key:"offUpdatePlaceholder",value:function(e){this.emit.off(s.w,e)}}]),t}()},tp5K:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a});var i=n("RIqP"),g=n.n(i);function m(e){return void 0===e}function r(t,i,e){var r,o,a=e.maxWait,s=0,c=Date.now,l=[],n=function(){l=null,r=void 0},u=function(e){s=e,l&&t(l),n()},d=function(e){var t=e-o,n=e-s;return m(o)||i<=t||t<0||!m(a)&&a<=n},h=function(e){var t=e-s,n=i-(e-o);return m(a)?n:Math.min(n,a-t)},f=function(){var e=c();if(d(e))return u(e);var t=h(e);r=p(t)},p=function(e){return window.setTimeout(f,e)};return function(e){(l=l||[]).push.apply(l,g()(e));var t=c(),n=d(t);if(o=t,n&&(m(r)&&(s=t,r=p(i)),!m(a)))return window.clearTimeout(r),r=p(i),u(o);m(r)&&(r=p(i))}}function o(e){return Array.from(new Set(e))}function a(e){return e.split("_")[1]}},trzc:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),h=12290,f="",s=function(){function t(e){r()(this,t),this.className="InputCompatible"}return a()(t,[{key:"aceKeyEvent",value:function(e,t){var n=t.evt,i=t.editorInfo,r=n.keyCode,o=n.type;if("keydown"===o&&r===h&&-1<[48,49,50,51,52,53,54,55,56,57].indexOf(f)){i.fastIncorp();var a=i.getRep();if(!a.selEnd||!a.selStart)return;if(!i.selection.isCaret())return;var s=a.selStart,c=a.selEnd,l=a.lines.atIndex(s[0]),u=0<=s[1]-1?s[1]-1:0,d=l.text[u];return-1<["0","1","2","3","4","5","6","7","8","9"].indexOf(d)&&(n.preventDefault(),i.performDocumentReplaceRange(a.zoneId,s,c,"."),i.updateBrowserSelectionFromRep()),!0}"keyup"===o&&(f=r)}}]),t}();new s},tvAd:function(e,t,n){"use strict";n.d(t,"a",function(){return F});var i,r,o,a,s,c,l=n("lSNA"),u=n.n(l),d=n("J4zp"),h=n.n(d),f=n("cDf5"),p=n.n(f),g=n("yG8O"),m=n.n(g),v=n("lwsE"),b=n.n(v),y=n("W8MJ"),E=n.n(y),O=n("U+yc"),C=n.n(O),k=(n("1ABj"),n("ac4d"),n("YNKm")),I=n("YWBl"),S=n("7Kxq"),T=n("iP/4"),_=n("HmyT"),w=n("2ACu"),j=n("/spq"),M=n("O9F5"),L=n("MjSh"),R=n("fMYX"),N=n("y2sV"),D=n("H6oK"),x=n("Hj9z"),P=n("p3Wu"),B=n("4PSP"),U=n("lQZd"),z={h1:26,h2:20,h3:18,"":14},H="CHECKBOX_HOVER_STYLE",F=(i=Object(j.a)(["bindEvent","removeEvent"]),r=Object(B.Throttle)(200,{leading:!0}),o=Object(B.Debounce)(1e3),i((s=function(){function t(e){var g=this;b()(this,t),this.className="Checkbox",this.postAceInit=function(e){g.btnDom=Object(_.$)("[data-key=checkbox]").find("button"),g.innerBody=Object(_.$)(e.getDocBody()),g.bindEvent()},this.regist=function(e){e.registerAceCommand(k.l,function(e,t,n,i){var r=i.source,o=t.doInsertList({attribKey:"list",attribValue:"check"});Object(I.a)({action:"checkbox",op:o?S.g:S.f,source:r})},{statusKey:"list-done list-check"})},m()(this,"handleMouseMove",c,this),this.handleMouseLeave=function(e){M.a.deleteRuleById(H)},this.handleMobileClickCheckbox=function(e){var t=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];return e.clientX=t&&t.clientX,e.clientY=t&&t.clientY,g.handleClickCheckbox(e)},this.handleCheckboxMousedown=function(e){var t,n=e.target;"LI"===(n&&n.tagName)&&(t=g._editorInfo.selection.getPositionForNode(n),g.cursorInCheckBox(e,t.zone)&&e.preventDefault())},this.cursorInCheckBox=function(e,t){var n=g._editorInfo,i=e.target,r=i.firstChild;if(!r)return!1;var o=(r.getBoundingClientRect?r:r.parentNode).getBoundingClientRect(),a=Object(_.$)(i).parents("[id^=magicdom]").get(0),s=-1;a&&(s=n.domToRep(a).selStart[0]);var c=n.getAttributeOnLine(t,s,"heading"),l=z[c]||14,u=l*(T.a.mobile?.5:.15),d=o.left-.3*l,h=d-l-u,f=o.top+u,p=f+l+u;return T.a.mobile&&(d=o.left,f=o.top),!!g.clickPositionInCheckbox(h,d,f,p,e.clientX,e.clientY)},this.handleClickCheckbox=function(e){var t,n,i,r,o,a,s=e.target,c=s&&s.tagName,l=g._editorInfo,u=l.selection.getPositionForNode(s);"LI"!==c||(t=l.domToRep(s))&&g.cursorInCheckBox(e,u.zone)&&(n=Object(_.$)(s).parents("[id^=magicdom]").get(0),i=-1,n&&(i=l.domToRep(n).selStart[0]),r=l.getLineListType(u.zone,i),o=/check/.test(r)?"done":"check",a="check"===o?g.checkStrikethrough(l,t):"",l.callWithAce(function(){l.fastIncorp(!0),e.preventDefault(),a&&l.setAttributeOnSelection(u.zone,"strikethrough","",t),l.doInsertList({attribKey:"list",attribValue:o,dRep:{selStart:[i,0],selEnd:[i,0],zoneId:u.zone}}),Object(w.collectSuiteEvent)("click_checkbox",{check_status:"done"===o?"check":"uncheck"})},"doToggleCheckBox",!0))},this.checkStrikethrough=function(e,t){var n=e.getAttributesOnSelection(t.zoneId,t,!1);return Object.values(n.attribs).some(function(e){return"strikethrough"===e[0]})},this.clickPositionInCheckbox=function(e,t,n,i,r,o){return!!((T.a.mobile||T.a.isIPad)&&e<=r&&r<=t)||e<=r&&r<=t&&o<=i&&n<=o},this.aceInitialized=function(e,t){g._editorInfo=t.editorInfo,g.regist(g._editorInfo)},this.pluginReadOnly=function(){g.removeEvent()},this.pluginReadWrite=function(){g.bindEvent()},this.editorWillPaste=function(e){return e.deltaSet.reduce(function(e,t){if(t instanceof N.E){var n=t.reduce(function(e,t){var n,i,r,o;return T.a.isOpenDoc&&t.insert&&t.attributes&&t.attributes.dataMetaBlockProps&&((n=JSON.parse(t.attributes.dataMetaBlockProps)).blockType!==D.BlockType.REMINDER_BLOCK||(i=n.props.data)&&(r=i.expireTime,o=i.isWholeDay,t.insert=Object(x.getNormalDateStr)(r,!o),t.attributes={})),t.attributes&&t.attributes[P.d]&&(t.attributes[P.d]=Object(R.d)("paste")),e.insert(t.insert,t.attributes)},new N.E({zoneId:t.zoneId}));return e.concat(n)}return e.concat(t)},new N.e)},this.handleContentChange=function(e){var t=e.changes;if(!e.options.isRemote){var n,i=function(o){var e=t[o];if(1!==e.length)return{v:void 0};e.forEach(function(e){var t,n,i=e.inserts,r=e.deletes;[i,r].find(function(e){return e.find(function(e,t){return e._lineAttributes.find(function(e){var t=h()(e,2),n=t[0],i=t[1];return"list"===n&&/check|done/.test(i)})})})&&g.handleCheckboxChange(),1===i.length&&1===r.length&&i[0].getText()!==r[0].getText()&&(n=(t=i[0]).getLineAttributes().toMap(),g.isCheckboxAttr(n)&&(n[P.d]||g.editor.getContentState().setLineAttributes(o,t.index,u()({},P.d,Object(R.d)("edit")),{nonundoable:!0,preventScrolling:!0})))})};for(n in t){var r=i(n);if("object"===p()(r))return r.v}}},this.reset=function(){g.removeEvent(),g._editorInfo=null,Object(R.c)()},this.btnDom=null,this.innerBody=null,e&&(this.editor=e,this.regist(e),this.postAceInit(e),this.aceInitialized("",Object.assign({editorInfo:e},e)))}return E()(t,[{key:"bindEvent",value:function(){this.removeEvent(),this.editor.on(N.k.CONTENT_CHANGE,this.handleContentChange),T.a.isMobile||T.a.isIPad?(this.innerBody.delegate("[class^=list-done]","touchend",this.handleMobileClickCheckbox),this.innerBody.delegate("[class^=list-check]","touchend",this.handleMobileClickCheckbox)):(this.innerBody.delegate("[class^=list-check]","click",this.handleClickCheckbox),this.innerBody.delegate("[class^=list-check]","mousedown",this.handleCheckboxMousedown),this.innerBody.delegate("[class^=list-done]","click",this.handleClickCheckbox),this.innerBody.delegate("[class^=list-done]","mousedown",this.handleCheckboxMousedown),this.innerBody.delegate("[class^=list-]","mousemove",this.handleMouseMove),this.innerBody.delegate("[class^=list-]","mouseleave",this.handleMouseLeave))}},{key:"removeEvent",value:function(){this.editor.off(N.k.CONTENT_CHANGE,this.handleContentChange),T.a.isMobile||T.a.isIPad?(this.innerBody.undelegate("[class^=list-done]","touchend",this.handleMobileClickCheckbox),this.innerBody.undelegate("[class^=list-check]","touchend",this.handleMobileClickCheckbox)):(this.innerBody.undelegate("[class^=list-check]","click",this.handleClickCheckbox),this.innerBody.undelegate("[class^=list-done]","click",this.handleClickCheckbox),this.innerBody.undelegate("[class^=list-check]","mousedown",this.handleCheckboxMousedown),this.innerBody.undelegate("[class^=list-done]","mousedown",this.handleCheckboxMousedown),this.innerBody.undelegate("[class^=list-]","mousemove",this.handleMouseMove),this.innerBody.undelegate("[class^=list-]","mouseleave",this.handleMouseLeave))}},{key:"renderLine",value:function(e){var t=e.children,n=e.lineState.getLineAttributes().toMap(),i=this._editorInfo.pure&&n.list&&/(check|done)/.test(n.list)?" disable-click":"";return e.lineClass+=i,t}},{key:"isCheckboxAttr",value:function(e){var t=e&&e.list;return!!(t&&(t.includes("done")||t.includes("check")))}},{key:"handleCheckboxChange",value:function(){Object(R.e)(Object(U.g)(),Object(U.l)())}}]),t}(),c=C()(s.prototype,"handleMouseMove",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var i=this;return function(e){var t,n=e.target;M.a.hasRuleById(H)||(t=i._editorInfo.selection.getPositionForNode(n),i.cursorInCheckBox(e,t.zone)&&M.a.insertRule("\n        body:not(.showing-history) .innerdocbody ul[class^=list-check] li:hover:before,\n        body:not(.showing-history) .innerdocbody ul[class^=list-done] li:hover:before {\n          border-color: ".concat(L.B500,";\n          cursor: pointer;\n        }\n      "),H))}}}),C()(s.prototype,"handleCheckboxChange",[o],Object.getOwnPropertyDescriptor(s.prototype,"handleCheckboxChange"),s.prototype),a=s))||a);new F},tzkP:function(e,d,h){"use strict";(function(u){var e=h("lwsE"),t=h.n(e),n=h("W8MJ"),i=h.n(n),o=h("HmyT"),r=h("cgIo"),a=h("juX9"),s=h.n(a),c=15,l=function(){function l(){var c=this;t()(this,l),this.popupContainer=Object(o.$)(".doc-popup-container"),this.x=0,this.y=0,this.$tablePicker=Object(o.$)("#aceTablePicker"),this.$window=Object(o.$)(window),this.highlight=this.$tablePicker.find(".highlight"),this.tips=this.$tablePicker.find(".tips"),this.editorbarRectLeft=0,this.editorbarRectTop=0,this.display=!1,this.handleCalcHighlightRect=function(e){var t=e.clientX-c.editorbarRectLeft+10,n=l.rectificationNumber(Math.floor(t/16)),i=e.clientY-c.editorbarRectTop,r=l.rectificationNumber(Math.floor(i/16)-1),o=16*n,a=16*r;c.highlight.css({width:"".concat(o,"px"),height:"".concat(a,"px")});var s=u("etherpad.insert_table");r&&n&&(s="".concat(u("etherpad.insert")," ").concat(n,"X").concat(r," ").concat(u("common.table")),c.x=n,c.y=r),c.tips.text(s)},this.createTablePicker(),this.$tablePicker.off("mousemove",this.handleCalcHighlightRect),this.$tablePicker.on("mousemove",this.handleCalcHighlightRect)}return i()(l,[{key:"destroy",value:function(){this.$tablePicker.off("mousemove",this.handleCalcHighlightRect)}},{key:"handleClickHighLight",value:function(){return this.hide(),{x:this.x,y:this.y}}},{key:"getTableHeight",value:function(){return this.tableHeight||(this.tableHeight=this.$tablePicker.height()),this.tableHeight}},{key:"toggleDisplay",value:function(e){var t;e.handleShowPicker&&e.showPicker||!e.handleShowPicker&&this.$tablePicker.hasClass("hidden")?(t=this.calcPosition(e),this.$tablePicker.css({left:"".concat(t.left,"px"),top:"".concat(t.top,"px")}),this.show()):this.hide(),this.resetStatus()}},{key:"resetStatus",value:function(){this.x=0,this.y=0,this.tips.text(u("etherpad.insert_table")),this.highlight.css({width:0,height:0})}},{key:"calcPosition",value:function(e){var t,n,i,r;return e.pos?(this.editorbarRectLeft=e.pos.left,this.editorbarRectTop=e.pos.top):(t=Object(o.$)("[data-key=insertTable]").get(0).getBoundingClientRect(),this.editorbarRectLeft=t.left-77+16,n=t.height+10,i=this.$window.height()-t.height-t.top,r=this.getTableHeight(),this.editorbarRectTop=r+c<i?t.top+n:t.top-r-c),{left:this.editorbarRectLeft,top:this.editorbarRectTop}}},{key:"show",value:function(){this.$tablePicker.removeClass("hidden"),this.display=!0}},{key:"hide",value:function(){this.$tablePicker.addClass("hidden"),this.display=!1}},{key:"createTablePicker",value:function(){this.$tablePicker.length||(Object(o.$)(Object(r.a)(s.a)({tips:u("etherpad.insert_table")})).appendTo(this.popupContainer),this.$tablePicker=Object(o.$)("#aceTablePicker"),this.highlight=this.$tablePicker.find(".highlight"),this.tips=this.$tablePicker.find(".tips"))}}],[{key:"rectificationNumber",value:function(e){return e<0?0:9<e?9:e}}]),l}();d.a=l}).call(this,h("2vAP"))},uEBw:function(e,y,E){"use strict";(function(i){E.d(y,"a",function(){return l}),E.d(y,"f",function(){return u}),E.d(y,"g",function(){return h}),E.d(y,"e",function(){return f}),E.d(y,"c",function(){return g}),E.d(y,"b",function(){return m}),E.d(y,"d",function(){return v}),E.d(y,"h",function(){return b});E("J4zp");var t=E("n/R6"),r=E("KCMi"),n=E("2ACu"),o=E("Mvmg"),e=E("BmhO"),a="client_uploader_file_operation",s="file_card_file_info",c="request_file_block_permission",l={enter:"enter",quit:"quit",show_toolbar:"show_toolbar",click_inline_view:"click_inline_view",click_card_view:"click_card_view",click_preview_view:"click_preview_view",icon_download:"icon_download"};function u(e){var t=decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(t)}function d(e){for(var t=0,n=0;n<e.length;n++)127<e.charCodeAt(n)||94===e.charCodeAt(n)?t+=2:t+=1;return 20<t?"".concat(e.substring(0,10),"..."):e}function h(e){t.a.show({type:"error",closable:!0,content:e})}function f(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return n&&Object(r.a)(e,n)||Object(r.b)(e,t)}function p(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Object(n.default)(e,Object.assign({},t))}function g(){p(a,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}function m(){p(s,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}function v(){p(c,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}e.s.PNG,e.s.JPG,e.s.JPEG,e.s.GIF,e.s.ICO;function b(e){var t,n=d(e.name);return e.name.length>o.d&&(t="".concat(n," ").concat(i("drive.file_name_valid"))),(e.size>o.f||0===e.size)&&(t="".concat(n," ").concat(i("drive.file_size_valid_v2"))),/(?:[?*<>:"/\\|]+)/g.test(e.name)&&(t="".concat(n," ").concat(i("drive.file_name_char"))),t}}).call(this,E("2vAP"))},uOFk:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"12",height:"12",viewBox:"0 0 12 12",fill:"#424E5D"},t),c.a.createElement("path",{d:"M8.09 6L3.44 1.35a.5.5 0 11.7-.7L9.5 6l-5.35 5.35a.5.5 0 01-.71-.7L8.09 6z"}))}},uOZV:function(e,t,n){"use strict";var o=n("uEBw"),a=n("hjKP"),i=n("i8i4"),s=n.n(i),r=n("q1tI"),c=n.n(r),l=n("D7h9"),u=/\sdrive-fileId_(\S*)\s/,d=/\sdrive-fileInfo_(\S*)\s/,h={reset:function(e){for(var t=e.querySelectorAll(".drive"),n=0;n<t.length;n++){var i=t[n];s.a.unmountComponentAtNode(i)}},update:function(e,t){for(var n=e.querySelectorAll(".drive"),i=0;i<n.length;i++){var r=n[i];h.mount(r,t)}},mount:function(e,t){var n,i=e.className,r=i.match(u);r&&r[1]&&(r=i.match(d))&&r[1]&&(n=Object(o.f)(r[1]),e.textContent&&""===e.textContent.trim()&&s.a.render(c.a.createElement(a.default,Object.assign({},n,{ace:t,store:l.default,disableBtn:!0})),e))},unmount:function(e){s.a.unmountComponentAtNode(e)}};t.a=h},uPgH:function(e,t,n){"use strict";var i=n("lSNA"),r=n.n(i),o=n("t7Uy"),a=n("D7h9"),s=n("toa8"),c=n("2ACu"),l=n("kUgE"),u=n("n3ZB"),d=n("G8Hj"),h=n("SGN9");n("wKA5");function f(e){var t=Object(u.i)(a.default.getState());Object(h.n)(t,d.STEP_TYPES.smart_compose_guide)||(Object(h.b)(d.STEP_TYPES.smart_compose_guide),p(),Object(c.default)("sdk_setting_ai_composer_nux_appear",{total_chars:e}))}function p(){var e="<span class='smart-compose-tab-icon'>tab</span>";$(".".concat(o.c)).append(e)}function g(){Object(h.a)(d.STEP_TYPES.smart_compose_guide)}var m=n("rLED");n.d(t,"a",function(){return O}),n.d(t,"b",function(){return C});var v=a.default.getState().appState.userSettings.get("smart_compose_setting");function b(e){return{id:e.id,vid:e.vid,language:e.lang}}function y(){return a.default.subscribe(function(){var e=a.default.getState().appState.userSettings.get("smart_compose_setting");v!==e&&(v=e)})}function E(e){var t,n=y();return{scene:o.b.DOC,request:s.d,getUserLanguage:function(){return Object(l.getLanguage)()},getSmartComposeEnable:function(){return v},events:(t={},r()(t,o.a.APPLY,function(e){g();var t=(e.prefix+e.suggestion).split(":").slice(1).join(":");Object(c.default)("sdk_ai_composer_complete",Object.assign({},b(e),{completed_chars:t.length}))}),r()(t,o.a.HOVER,function(e){Object(c.default)("sdk_ai_composer_overwrite",b(e))}),r()(t,o.a.SHOW,function(e){f(e.completion.length),Object(c.default)("sdk_ai_composer_view",Object.assign({},b(e),{total_chars:e.completion.length}))}),r()(t,o.a.HIDE,function(e,t){t!==o.e.APPLY&&Object(c.default)("sdk_ai_composer_cancel",b(e))}),t),destory:function(){n()}}}function O(e){return Object(m.hb)()?[new o.d(e,E(e))]:[]}var C=function(e){return new o.d(e,E(e))}},uQON:function(e,_,w){"use strict";(function(e){w.d(_,"k",function(){return a}),w.d(_,"j",function(){return s}),w.d(_,"i",function(){return l}),w.d(_,"e",function(){return m}),w.d(_,"b",function(){return v}),w.d(_,"d",function(){return d}),w.d(_,"c",function(){return h}),w.d(_,"g",function(){return y}),w.d(_,"n",function(){return O}),w.d(_,"f",function(){return C}),w.d(_,"l",function(){return k}),w.d(_,"a",function(){return I}),w.d(_,"m",function(){return S}),w.d(_,"h",function(){return T});w("J4zp"),w("fp5s");var n=w("7EGn"),f=w("D7h9"),i=w("ahx2"),p=w("NltJ"),g=(w("ZGZ5"),w("QM+C")),b=w("VI6H"),t=(w("Mpt7"),w("nN3d"),w("dP4c")),r=w("L9Vw"),o=w("2ACu"),a=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).comment_list;return e&&e.length<=0},s=function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).is_whole},c=e("etherpad.commet_failed"),l=function(e){var t;return i.ERROR_CODE_MAP[e]&&(t=Object(n.default)(i.ERROR_CODE_MAP[e],"warningText")),t||c},m=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:g.LINK_REG;t.lastIndex=0,e=(e=e.replace(/<highlight isOn="([\s\S]*?)">/gi,"")).replace(/<\/highlight>/gi,"");for(var n=[],i=t.exec(e);i;){var r=i.index,o=i[0],a=r+o.length;n.push({startIndex:r,endIndex:a,url:o}),i=t.exec(e)}return n},u=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:g.HIGHLIGHT_REG;t.lastIndex=0;for(var n=[],i=t.exec(e);i;){var r=i.index,o=i[0],a=i[1],s=i[2],c=r+o.length;n.push({startIndex:r,endIndex:c,text:s,content:o,isOn:"true"===a}),i=t.exec(e)}return n},v=function(e){var t=g.AT_REG;t.lastIndex=0;for(var n=[],i=t.exec(e);i;){var r=i.index,o=i[0],a=i[4],s=i[5],c=i[1],l=i[2],u=i[3],d=r+o.length;n.push({startIndex:r,endIndex:d,content:s,type:c,icon:a,href:l?E(l):"",token:u}),i=t.exec(e)}return n},d=function(e){var t=g.SEPARATED_AT_REG;t.lastIndex=0;for(var n,i=[],r=t.exec(e),o=0;r;){var a=r.index,s=e.slice(o,a);s&&i.push({startIndex:o,endIndex:a,content:s});var c=r[0],l=r[1],u=r[2],d=r[3],h=a+c.length;i.push({startIndex:a,endIndex:h,content:u,head:l,tail:d,isAtNode:!0}),o=h,r=t.exec(e)}return o<e.length&&(n=e.slice(o),i.push({startIndex:o,endIndex:e.length,content:n})),i},h=function(a){var e=u(a);if(!e.length)return null;var t,s=[],c=0;return e.forEach(function(e){var t=e.startIndex,n=e.endIndex,i=e.text,r=e.isOn,o=a.slice(c,t);o&&s.push(y(o)),s.push({type:"highlight",content:i,className:"highlight"+(r?" selected":"")}),c=n}),c<a.length&&(t=a.slice(c),s.push(y(t))),s};function y(e){return{type:"text",content:e,children:h(e)}}function E(e){return Object(r.getSecureLink)(e,{logParams:{location:r.SECURE_LINK_LOG.DOCS_SDK_COMMENT}})||e}function O(){var e="link_clicked";Object(o.default)(e,{scene:r.SECURE_LINK_SCENE.CCM,location:r.SECURE_LINK_LOG.DOCS_SDK_COMMENT})}function C(e){return{type:"link",content:e,href:E(Object(t.a)(e)),target:"_blank",className:"link",children:h(e)}}var k=function(){return"visible"===document.visibilityState},I=function(e,t){var n=e.commentList,i=e.userId,r=e.finish,o=e.quote,a=e.finishUserId,s=e.isWhole,c=e.unSubmitComment,l=e.createTimestamp,u=e.updateTimestamp,d=e.finishTimestamp;return{comment_list:n,user_id:i,isSubmitted:t,un_submit_comment:Boolean(c),finish:r,quote:o,finish_user_id:a,is_whole:s,create_timestamp:l,update_timestamp:u,finish_timestamp:d}},S=function(e,t){var n=e.replyId,i=e.realReplyId,r=e.userId,o=e.content,a=e.createTimestamp,s=e.updateTimestamp,c=e.deleted,l=e.error,u=e.sending,d=e.type,h=e.modify,f=e.extra,p=e.translateContent,g=e.translateStatus,m=e.equalLang,v=t.get(r);return{reply_id:n,realReplyId:i,user_id:r,content:o,error:l,sending:u,create_timestamp:a,update_timestamp:s,type:d,deleted:c,modify:h,name:Object(b.o)(v.get("id")),avatar_url:v.get("avatar_url"),entities:{users:t},extra:f,time:a,translate_content:p,translate_status:g,equal_lang:m}},T=function(e){var t,n=e.replyId,i=e.content,r=void 0===i?"":i,o=e.extra,a=void 0===o?{}:o,s=v(r),c=m(r),l=!!r,u=0<s.length||0<c.length,d=!1;n&&(d=!!((t=Object(p.g)(f.default.getState()).get(n))&&0<t.length));var h={text:l,link:u,reaction:d,image:!!(a.image_list&&0<a.image_list.length)};return Object.keys(h).filter(function(e){return h[e]}).join(",")}}).call(this,w("2vAP"))},uVPH:function(e,t,n){},uavh:function(e,p,g){"use strict";(function(e){g.d(p,"a",function(){return f});var t=g("lSNA"),n=g.n(t),i=g("q1tI"),r=g.n(i),o=g("P438"),a=g("8mZy"),s=g("LaDK"),c=g("rWdK"),l=g("U6+H"),u=g.n(l),d=g("bsrO");function h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({background:"url(".concat(e,")"),backgroundSize:"cover"},t);return r.a.createElement("span",{style:n})}var f=n()({},o.b.Jira,{name:o.b.Jira,icon:h(u.a),connectingText:e("doc.jira.connecting"),connectFailText:e("doc.jira.connect_fail"),connectSuccessFlag:s.a.HAS_CONNECTED,fetchAuthStatusAction:a.g,authStatusSelector:c.a,logParams:{jira_type:Object(d.i)()}})}).call(this,g("2vAP"))},ubJt:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n("MXQz"),r=n("toa8"),o=n("kUgE"),a=n("ZGZ5"),s=n("D7h9"),c=n("wOYm"),l=n("wQna"),u=n("3DAz"),d=Object(i.a)(function(){u.a.setRequestMethod(r.d)});function h(e){d();var t=e.suiteType,n=e.suiteToken,i=e.broadcastType,r=l.a.getOrCreate({suiteType:t,suiteToken:n});return new u.a({broadcastType:i,broadcast:r,getSuiteType:function(){return t},getSuiteToken:function(){return n},getLang:o.getLanguage,getUserId:function(){return Object(a.a)(s.default.getState()).get("id")||window.User.id}})}var f=Object(c.a)(h,function(e){return"".concat(e.suiteType,":").concat(e.suiteToken,":").concat(e.broadcastType)})},uirG:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),l=n("y2sV"),u=n("+4eN"),s=function(){function t(e){r()(this,t),this.editor=e}return a()(t,[{key:"collectZoneDelta",value:function(n){var i=this,t=!1,r=[];return n.deltaSet.forEach(function(e){e instanceof l.E&&e.forEach(function(e){i.matchOp(e)&&(t=!0,r.push(e.attributes.zoneId))})}),t&&r.forEach(function(e){var t=i.editor.getContentState().getZoneState(e).getContent();n.deltaSet=n.deltaSet.concat(t)}),t}},{key:"flattenZoneDelta",value:function(i){var r=this,o=[];return i=i.reduce(function(e,t){if(!(t instanceof l.E))return e.concat(t);var n=t.reduce(function(e,t){if(!r.matchZoneDeltaOp(t))return e.push(t);var n=i.get(t.attributes.zoneId);return o.push(n.zoneId),e.concat(n)},new l.E({zoneId:t.zoneId}));return e.concat(n)},new l.e),o.forEach(function(e){return i.delete(e)}),i}},{key:"filterUnexpectedOp",value:function(e){var i=this,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return e=e.reduce(function(e,t){if(!(t instanceof l.E)||Object(u.h)(t.zoneId))return e;var n=t.reduce(function(e,t){return t.attributes?i.isBlockOp(t)?e:r&&t.attributes.lmkr?e.insertLineMarker():e.push(t):e.push(t)},new l.E({zoneId:t.zoneId}));return Object(u.o)(n),e.concat(n)},new l.e)}},{key:"replaceZoneInDeltaSet",value:function(e){var r=this,o=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=[],s=[],c=e.reduce(function(e,t){if(!(t instanceof l.E))return e.concat(t);var n=t.reduce(function(e,t){if(!r.matchOp(t))return e.push(t);var n=t.attributes.zoneId,i=Object(u.b)();return a.push(n),s.push(i),e.push(Object.assign({},t,{attributes:Object.assign({},t.attributes,{zoneId:i})}))},new l.E({zoneId:t.zoneId}));return e.concat(n)},new l.e);return a.forEach(function(e,t){var n=c.get(e),i=n.create(Object.assign({},n,{zoneId:s[t]}));o&&Object(u.o)(i),c.replace(e,i)}),c}}]),t}()},"uj+v":function(e,t,n){"use strict";var s=n("mkut"),c=n("7EGn"),l=n("kJZd"),u=n("0Gu0"),i=n("iP/4"),d=n("AYG9");function h(e){var t=0;if(e&&e.numToAttrib)for(var n in e.numToAttrib){var i=e.numToAttrib[n];i&&"sheet-id"===i[0]&&t++}return t}function f(){return i.a.ios?"IOS":i.a.android?"Android":"PC"}function r(){performance&&performance.timing?Object(l.b)(u.DOC_WHITE_SCREEN,{},performance.timing.navigationStart):Object(l.b)(u.DOC_WHITE_SCREEN,{},Date.now())}function p(){var e=parseInt(i.a.version,10);return isNaN(e)?-1:e}r();var o={init:function(){this.allSheetCellNum=0,this.loadedSheetNum=0,this._handleSheetMount=this.handleSheetMount.bind(this),addEventListener("sheetDidRender",this._handleSheetMount)},handleSheetMount:function(e){var t;e&&e.detail&&(this.loadedSheetNum++,this.allSheetCellNum+=e.detail.cellCount,t=f(),this.allSheetNum&&this.allSheetNum===this.loadedSheetNum&&Object(l.a)(u.SHEET_DID_RENDER,{doc_content_length:this.contentLen,all_sheet_cell_num:this.allSheetCellNum,platform:t,platform_version:p(),doc_attribute_num:this.attribNum}))},onMount:function(e,t){var i=t.editor.getClientVars()||{},r=h(i.apool),n=i.initialAttributedTexts,o=Object(c.default)(n,"text[0]","").length,a=Object(c.default)(i,"apool.nextNum");this.contentLen=o,this.attribNum=a,this.allSheetNum=r,setTimeout(function(){var e=Object(s.a)(i.initialAttributedTexts.text).length-1,t=f();Object(l.a)(u.DOC_RENDER,{doc_content_length:o,doc_attribute_num:a,sheet_num:r,all_table_cell_num:e,platform:t,platform_version:p()});var n=Object(c.default)(performance,"timing.loadEventEnd")||Date.now();Object(l.a)(u.DOC_WHITE_SCREEN,{doc_content_length:o,platform:t,platform_version:p()},n),Object(d.d)()})},destory:function(){this.allSheetCellNum=0,this.loadedSheetNum=0}};o.init(),t.a=o},uwMH:function(e,R,N){"use strict";(function(c){N.d(R,"a",function(){return n}),N.d(R,"c",function(){return j});var e,t,n,i,r=N("a1gu"),l=N.n(r),o=N("Nsbk"),u=N.n(o),a=N("7W2i"),d=N.n(a),s=N("lSNA"),h=N.n(s),f=N("o0o1"),p=N.n(f),g=N("yXPU"),m=N.n(g),v=N("lwsE"),b=N.n(v),y=N("W8MJ"),E=N.n(y),O=N("D7h9"),C=N("5cZX"),k=N("n3ZB"),I=N("yaX4"),S=N("AiBH"),T=N("iP/4"),_=N("uxcB"),w=function(){function e(){var t=this;b()(this,e),this.isGuideDone=function(e){return!1!==t.getCurGuides().getIn([e,"is_done"])},this.updated=!1}function t(e){return n.apply(this,arguments)}var n,i,r;function o(e){return i.apply(this,arguments)}function a(){return r.apply(this,arguments)}return E()(e,[{key:"fetchGuidesAPI",value:(r=m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.default.dispatch(Object(I.b)()));case 1:case"end":return e.stop()}},e)})),a)},{key:"getCurGuides",value:function(){return Object(k.i)(O.default.getState())}},{key:"clearUpdated",value:function(){this.updated=!1}},{key:"updateGuideAPI",value:(i=m()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.updated=!0,e.prev=1,e.next=4,O.default.dispatch(Object(I.d)(t));case 4:e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(1),this.updated=!1,e.t0;case 10:case"end":return e.stop()}},e,this,[[1,6]])})),o)},{key:"markGuideAsDoneAPI",value:(n=m()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.default.dispatch(Object(I.a)(t)));case 1:case"end":return e.stop()}},e)})),t)},{key:"canStart",value:function(){return!T.a.isMobile&&Object(C.c)(O.default.getState())}},{key:"isUpdated",get:function(){return this.updated}}]),e}();(i=n=n||{}).GROUP="atplaceholder_b_at_group",i.DOC="atplaceholder_b_at_doc",i.GROUP_CARD="atplaceholder_b_at_group_card",i.SHEET="atplaceholder_b_at_sheet",i.FILE="atplaceholder_b_at_file";var j=(e={},h()(e,S.E.GROUP,n.GROUP),h()(e,S.E.FILE,n.DOC),h()(e,S.E.SHEET,n.DOC),h()(e,S.E.CHAT,n.GROUP_CARD),e),M=function(e){function n(){return b()(this,n),l()(this,u()(n).apply(this,arguments))}function t(e){return i.apply(this,arguments)}var i,r,o;function a(){return r.apply(this,arguments)}function s(){return o.apply(this,arguments)}return d()(n,e),E()(n,[{key:"start",value:(o=m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canStart()){e.next=2;break}return e.abrupt("return");case 2:this.init();case 3:case"end":return e.stop()}},e,this)})),s)},{key:"update",value:(r=m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDone||this.isUpdated)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,this.updateGuideAPI(this.curGuide);case 4:case"end":return e.stop()}},e,this)})),a)},{key:"markAsDone",value:(i=m()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDone||!n.GUIDE_TYPES.includes(t)||this.isGuideDone(t))return e.abrupt("return");e.next=2;break;case 2:return e.next=4,this.markGuideAsDoneAPI(t);case 4:this.curGuide===t&&this.init();case 5:case"end":return e.stop()}},e,this)})),t)},{key:"init",value:function(){var t=this;Object(_.a)(),this.clearUpdated(),this.curGuide=n.GUIDE_TYPES.find(function(e){return!t.isGuideDone(e)});var e=this.curGuide?n.GUIDE_TEXT[this.curGuide]:c("doc.body_placeholder_default");Object(_.b)(e)}},{key:"isDone",get:function(){return void 0===this.curGuide}}]),n}(w);function L(){return new M}M.GUIDE_TYPES=[n.DOC,n.GROUP_CARD,n.SHEET,n.FILE],M.GUIDE_TEXT=(t={},h()(t,n.DOC,c("abtest.atplaceholder.b.at.doc")),h()(t,n.GROUP_CARD,c("abtest.atplaceholder.b.at.groupcard")),h()(t,n.SHEET,c("abtest.atplaceholder.b.at.sheet")),h()(t,n.FILE,c("abtest.atplaceholder.b.at.file")),t),R.b=L()}).call(this,N("2vAP"))},uxcB:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return v});var i=n("O9F5"),r="TITLE_PLACEHOLDER_RULE_ID",o="BODY_PLACEHOLDER_RULE_ID",a="",s="";function c(){return document.body.id?"#".concat(document.body.id):""}var l=">.ace-line:nth-child(1)::before";function u(e){return"\n  ".concat(c()," .maindocbody.innerdocbody.blank-title.docbody--write[contenteditable=true]").concat(l,'{\n    content: "').concat(e,'";\n  }')}function d(e){return"\n  ".concat(c(),' .maindocbody.innerdocbody.blank-body.docbody--write[contenteditable=true]>div:nth-child(2)::before {\n    content: "').concat(e,'";\n  }')}function h(e,t){f(e),p(e,t)}function f(e){i.a.deleteRuleById(e)}function p(e,t){i.a.insertRule(t,e)}function g(){return d(a+s)}function m(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;a=e,h(o,g()),null!==t&&h(r,u(t))}function v(){f(o),f(r)}},uyKL:function(e,S,T){"use strict";(function(n){T.d(S,"a",function(){return I});var e=T("o0o1"),a=T.n(e),t=T("yXPU"),i=T.n(t),r=T("lwsE"),s=T.n(r),o=T("W8MJ"),c=T.n(o),l=T("cDf5"),u=T.n(l),d=T("q1tI"),h=T.n(d),f=T("D7h9"),p=T("i8i4"),g=T.n(p),m=T("2ACu"),v=T("n/R6"),b=T("m/+l"),y=T("4PSP"),E=T("uavh"),O=T("P438"),C=T("Xd/R"),k=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":u()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},I=function(){function o(){s()(this,o),this.authTab=null}function e(){return t.apply(this,arguments)}var t;return c()(o,[{key:"destroy",value:function(){o.instance&&(o.instance.clear(),this.container&&(g.a.unmountComponentAtNode(this.container),document.body.removeChild(this.container),this.container=null)),o.instance=void 0}},{key:"clear",value:function(){this.clearTimer(),this.authTab&&this.authTab.close(),this.authTab=null,this.callback=void 0,this.authInfo=void 0}},{key:"clearTimer",value:function(){this.timer&&clearInterval(this.timer),this.timer=null}},{key:"fetchAuthStatus",value:function(){return this.authInfo?f.default.dispatch(this.authInfo.fetchAuthStatusAction()):null}},{key:"getAuthStatus",value:function(){return this.authInfo?this.authInfo.authStatusSelector(f.default.getState()):null}},{key:"toast",value:function(e,t){v.a.show({key:"auth-connector",type:e,content:h.a.createElement("div",null,t)})}},{key:"toastFetchFail",value:function(){this.toast("error",n("doc.common.fetch_auth_fail"))}},{key:"toastAuthSuccess",value:function(){this.toast("success",n("doc.common.auth_connect_success"))}},{key:"log",value:function(e){var t,n,i,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.authInfo&&(n=(t=this.authInfo).name,i=t.logParams,Object(m.default)(e,Object.assign({connect_obj:n},i,{},r)))}},{key:"connect",value:(t=i()(a.a.mark(function e(){var t,n,i,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getAuthStatus()){e.next=3;break}return e.abrupt("return");case 3:if(n=t.authUrl){e.next=18;break}return e.prev=5,e.next=8,this.fetchAuthStatus();case 8:i=e.sent,r=i.payload,n=r.authUrl,e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(5),this.renderConnectFail(),this.toastFetchFail(),e.abrupt("return");case 18:this.authTab=window.open(n),this.timer=setInterval(this.timerHandler,o.TIME_GAP);case 20:case"end":return e.stop()}},e,this,[[5,13]])})),e)},{key:"timerHandler",value:function(){var n=this;this.authTab&&this.authTab.closed&&(this.clearTimer(),this.authTab=null,this.fetchAuthStatus().then(function(){var e,t=n.getAuthStatus();t&&n.authInfo&&((e=t.authState===n.authInfo.connectSuccessFlag)?(n.emitCallBack(O.a.CONNECT_SUCCESS),n.toastAuthSuccess(),n.destroy()):o.instance&&n.renderConnectFail(),n.log("client_finish_connect",{connect_status:e?"success":"fail"}))}).catch(function(e){n.renderConnectFail(),n.toastFetchFail()}))}},{key:"emitCallBack",value:function(e){this.callback&&this.callback(e)}},{key:"initContainer",value:function(){this.container||(this.container=document.createElement("div"),document.body.appendChild(this.container))}},{key:"renderConnecting",value:function(){this.renderDom(O.a.CONNECTING)}},{key:"renderConnectFail",value:function(){this.renderDom(O.a.CONNECT_FAIL)}},{key:"onReconnect",value:function(){this.renderConnecting(),this.connect()}},{key:"onCancelConnect",value:function(){this.cancelConnect(),this.log("client_cancel_connect")}},{key:"renderDom",value:function(e){var t,n,i,r;this.authInfo&&(n={logoIcon:(t=this.authInfo).icon,connectFailText:t.connectFailText,connectingText:t.connectingText,connectStatus:e,onCancelConnect:this.onCancelConnect,onReconnect:this.onReconnect},i=h.a.createElement(C.a,n),r=h.a.createElement(b.Provider,{store:f.default},i),this.initContainer(),g.a.render(r,this.container))}},{key:"startConnect",value:function(e,t){this.authInfo=E.a[e],t&&(this.callback=t),this.renderConnecting(),this.connect()}},{key:"cancelConnect",value:function(){this.emitCallBack(O.a.CONNECT_FAIL),this.authInfo&&f.default.dispatch(this.authInfo.fetchAuthStatusAction()),this.destroy()}}],[{key:"getInstance",value:function(){return void 0===o.instance&&(o.instance=new o),o.instance}}]),o}();I.TIME_GAP=200,k([Object(y.Bind)()],I.prototype,"timerHandler",null),k([Object(y.Bind)()],I.prototype,"onReconnect",null),k([Object(y.Bind)()],I.prototype,"onCancelConnect",null),k([Object(y.Bind)()],I.prototype,"startConnect",null),k([Object(y.Bind)()],I.prototype,"cancelConnect",null)}).call(this,T("2vAP"))},uyOI:function(e,t,n){"use strict";var i=n("J4zp"),l=n.n(i),r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),c=n("xWuZ"),u=n("7EGn"),v=n("Muja"),m=n("KiC9"),d=n("yFNk"),h=(n("s2gw"),n("H6oK")),b=n("yEIg"),f=n("OX8E"),p=n("j1lG"),g=n("Tqb2"),y="adit-normal-line-hover",E="adit-primary-line-hover",O="adit-line-hover-fadeout",C=function(){function e(){o()(this,e),this.currentHighlightLines=new Map,this.specialHighlightLines=new Map}return s()(e,[{key:"getLineMap",value:function(e){return e?this.specialHighlightLines:this.currentHighlightLines}},{key:"getLineStatus",value:function(e){var t=e.lineNode,n=e.preventControl;return this.getLineMap(n).get(t)}},{key:"setLineStatus",value:function(e){var t=e.lineNode,n=e.status,i=e.preventControl;this.getLineMap(i).set(t,n)}},{key:"removeLineStatus",value:function(e){var t=e.lineNode,n=e.preventControl;this.getLineMap(n).delete(t)}},{key:"iterateLineStatus",value:function(e){return this.getLineMap(e).entries()}}]),e}(),k=function(){function t(e){var m=this;o()(this,t),this.editor=e,this.className="LineHover",this.currentUpdateQueue=[],this.isBatchUpdating=!1,this.editable=!1,this.isEmptyLine=function(e){return!e||!e.lineMarker&&e.lineMarker===e.text.length},this.handleDidPaint=function(){var e=!0,t=!1,n=void 0;try{for(var i,r=m.statusManager.iterateLineStatus()[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=l()(i.value,1)[0];document.contains(o)||m.statusManager.removeLineStatus({lineNode:o})}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}},this.addNormalHighlight=function(e){var t=e.lineNode,n=e.preventControl;!m.editable||!n&&m.statusManager.getLineStatus({lineNode:t,preventControl:!0})||m.setLineHover({lineNode:t,status:"normal",preventControl:n})},this.addPrimaryHighlight=function(e){var t=e.lineNode,n=e.preventControl;!m.editable||!n&&m.statusManager.getLineStatus({lineNode:t,preventControl:!0})||m.setLineHover({lineNode:t,status:"primary",preventControl:n})},this.clearHighlight=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.lineNode,n=e.preventControl;if(!t||!n&&m.statusManager.getLineStatus({lineNode:t,preventControl:!0})){var i=!0,r=!1,o=void 0;try{for(var a,s=m.statusManager.iterateLineStatus()[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=l()(a.value,1)[0];!n&&m.statusManager.getLineStatus({lineNode:c,preventControl:!0})||m.setLineHover({lineNode:c,status:"none",preventControl:n})}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}else m.setLineHover({lineNode:t,status:"none",preventControl:n})},this.batchUpdate=function(e){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).nonTransition&&m.setTransitionClass(),m.isBatchUpdating=!0,m.currentUpdateQueue=[],e(),m.isBatchUpdating=!1;var t=new Map(m.statusManager.iterateLineStatus(!1)),n=!0,i=!1,r=void 0;try{for(var o,a=m.currentUpdateQueue[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.status,l=s.lineNode;"none"===c?t.delete(l):t.set(l,c)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}if(!Object(v.default)(new Map(m.statusManager.iterateLineStatus(!1)),t)){var u=!0,d=!1,h=void 0;try{for(var f,p=m.currentUpdateQueue[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var g=f.value;m.setLineHover(g)}}catch(e){d=!0,h=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw h}}}m.setTransitionClass(!1)},this.statusManager=new C,this.bindEvents()}return s()(t,[{key:"bindEvents",value:function(){this.editor.on("lineHover:addNormalHighlight",this.addNormalHighlight),this.editor.on("lineHover:addPrimaryHighlight",this.addPrimaryHighlight),this.editor.on("lineHover:clearHighlight",this.clearHighlight),this.editor.on("paint",this.handleDidPaint)}},{key:"removeEvents",value:function(){this.editor.off("lineHover:addNormalHighlight",this.addNormalHighlight),this.editor.off("lineHover:addPrimaryHighlight",this.addPrimaryHighlight),this.editor.off("lineHover:clearHighlight",this.clearHighlight),this.editor.off("paint",this.handleDidPaint)}},{key:"setTransitionClass",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=this.editor.getDocBody();t&&(e?t.classList.add("adit-line-hover-no-transition"):t.classList.remove("adit-line-hover-no-transition"))}},{key:"getLineType",value:function(e){var t=e.lineNode,n=e.attribs,i=Object(d.a)({lineNode:t,attribs:n});return n.filter(function(e){var t=l()(e,2),n=t[0],i=t[1];return"align"===n&&["center","right"].includes(i)}).length&&["orderlist","unorderlist","checkbox","indent","text-indent"].includes(i)?"align":i}},{key:"setLineHover",value:function(e){var t,n,i,r,o,a,d,h,f=this,s=e.lineNode,p=e.status,g=e.preventControl;!this.isBatchUpdating||g?(t=this.editor.advancedDomToRep(s))&&(i=(n=t.selStart)[2],r=n[0],(o=this.editor.getRep(i))&&!this.isEmptyLine(o.lines.atIndex(r))&&(a=this.editor.getAttributesOnSelection(i,{selStart:[r,0,i],selEnd:[r,o.alinesWidth[r]-1,i]}).attribs,d=this.getLineType({lineNode:s,attribs:a}),h=[s],"codeblock"===d&&(h=Object(m.b)(s,!0).list),this.editor.getObserver().withoutRecordingMutations(function(){var e=!0,t=!1,n=void 0;try{for(var i,r=h[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;if(o){for(var a=o.classList,s=0,c=Array.from(a);s<c.length;s++){var l=c[s];l.startsWith("adit-line-hover-type")&&a.remove(l)}a.remove(y),a.remove(E),a.remove(O);var u={normal:y,primary:E}[p];u?(a.add(u),a.add("adit-line-hover-type-".concat(d)),g&&a.add(O),f.statusManager.setLineStatus({lineNode:o,status:p,preventControl:g})):f.statusManager.removeLineStatus({lineNode:o,preventControl:g})}}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}),d===b.c.TABLE&&this.toggleTableToolbar({lineNode:s,status:p}),d===b.c.SHEET&&this.toggleSheetHighlight({attribs:a,status:p,preventControl:g}),d===b.c.BITABLE&&this.toggleBitableHighlight({attribs:a,status:p,preventControl:g}),d===b.c.JIRA_FILTER&&this.toggleJiraFilterHighlight({attribs:a,status:p}),d===b.c.GALLERY&&this.toggleImageLineHighlight({attribs:a,status:p}))):this.currentUpdateQueue.push({lineNode:s,status:p})}},{key:"toggleTableToolbar",value:function(e){var t=e.lineNode,n=e.status,i=t.lineManager;i&&(i.updateHover("none"!==n),i.setTableHovering("primary"===n),i.toggleTableHeaderSelect("primary"===n))}},{key:"toggleSheetHighlight",value:function(e){var t,n,i=e.status,r=e.attribs,o=e.preventControl,a=r.filter(function(e){var t=l()(e,2),n=t[0],i=t[1];return n===h.BLOCK_DATA_META_BLOCK_PROPS&&i});a.length&&(t=Object(u.default)(this.editor.plugins,["sheetBridge","bridge"]),n=Object(u.default)(Object(h.parseJsonSafely)(a[0][1]),["blockMeta","sheet_id"]),t&&n&&(t.updateSheetSelectionState(n,"primary"===i),o&&f.a.trigger("dropSuccess",[n])))}},{key:"toggleBitableHighlight",value:function(e){var t,n=e.status,i=e.attribs,r=Object(u.default)(this.editor.plugins,["blockPlugin"]),o=Object(u.default)(this.editor.plugins,["bitableBridge","bridge"]),a=this.getBitableOrJiraFilterBlockIdByAttribs(i);r&&o&&a&&((t=r.getBlockById(a).bitableId)&&o.updateBitableSelectionState(t,"primary"===n))}},{key:"toggleJiraFilterHighlight",value:function(e){var t,n=e.status,i=e.attribs,r=this.getBitableOrJiraFilterBlockIdByAttribs(i),o=Object(u.default)(this.editor.plugins,["blockPlugin"]);o&&r&&((t=o.getBlockById(r))&&t.jiraFilterRef.viewRef.pureBitableRef.updateSelect("primary"===n))}},{key:"getBitableOrJiraFilterBlockIdByAttribs",value:function(e){var t=e.filter(function(e){var t=l()(e,2),n=t[0],i=t[1];return n===h.BLOCK_DATA_META_BLOCK_PROPS&&i});return t.length?Object(u.default)(Object(h.parseJsonSafely)(t[0][1]),["blockId"]):void 0}},{key:"toggleImageLineHighlight",value:function(e){var t=e.status,n=e.attribs.filter(function(e){var t=l()(e,2),n=t[0];t[1];return p.p.includes(n)}).map(function(e){var t=l()(e,2),n=t[0],i=t[1],r=Object(g.p)(n,i);return r?r.map(function(e){return e.uuid}):null}).filter(function(e){return null!==e});f.a.emit(p.P,{status:t,uuids:Object(c.a)(n)})}},{key:"pluginReadOnly",value:function(){this.clearHighlight(),this.editable=!1}},{key:"pluginReadWrite",value:function(){this.editable=!0}},{key:"destroy",value:function(){this.removeEvents()}}]),t}();k.separator="|",n.d(t,"a",function(){return k})},v2N6:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var i=new Map;function r(e){var t=e.lastModified,n=e.name,i=e.type,r=e.size;return"".concat(n,"_").concat(i,"_").concat(r,"_").concat(t)}function o(e,t){var n=r(e);i.set(n,t)}function a(){i.clear()}},v2yF:function(e,t,n){},v2yP:function(e,t,n){"use strict";n.d(t,"a",function(){return y});var i=n("J4zp"),r=n.n(i),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("cDf5"),u=n.n(l),k=n("D28M"),d=n("/spq"),h=n("rLED"),I=n("xYHj"),f=n("zTCG"),p=n("ciJ8"),g=n("+4eN"),m=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":u()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},v=8,b=15,y=function(){function t(e){a()(this,t),this.handleBodyClick=this.handleBodyClick.bind(this),e&&(this.editorInfo=e,this.postAceInit("",Object.assign({editorInfo:e},e)))}return c()(t,[{key:"postAceInit",value:function(e,t){var n=t.editorInfo;this.editorInfo=n,this.bindEvent()}},{key:"bindEvent",value:function(){this.innerBody=this.editorInfo.getDocBody(),this.innerBody.removeEventListener("click",this.handleBodyClick),this.innerBody.addEventListener("click",this.handleBodyClick)}},{key:"pluginReadOnly",value:function(){this.readOnly=!0}},{key:"pluginReadWrite",value:function(){this.readOnly=!1}},{key:"reset",value:function(){this.innerBody&&this.innerBody.removeEventListener("click",this.handleBodyClick)}},{key:"isElementTopOrBottomClick",value:function(e,t){var n=Object(k.o)(e.target,"ace-line");if(!n)return!1;var i=n.getBoundingClientRect(),r=n.lineManager&&n.lineManager.tableId?b:v;return"top"===t?e.y-i.top<r&&0<e.y-i.top:i.bottom-e.y<r&&0<i.bottom-e.y}},{key:"isElementTopClick",value:function(e){return this.isElementTopOrBottomClick(e,"top")}},{key:"isElementBottomClick",value:function(e){return this.isElementTopOrBottomClick(e,"bottom")}},{key:"isElementInTableCellTopClick",value:function(e){var t=Object(k.f)(e.target,"selenium-inner-zone-ace-editor")&&Object(g.h)(e.target.dataset.zoneId),n=Object(k.o)(e.target,"ace-table-cell");if(t||n){var i=n||e.target,r=Object(k.n)(".ace-line",i);if(!r)return!1;var o=r.getBoundingClientRect();return Math.abs(e.y-o.top)<v}return!1}},{key:"isElementInTableCellClick",value:function(e){return!!Object(k.f)(e.target,"ace-table-cell")&&!!e.target.getElementsByClassName("ace-line").length}},{key:"getTargetIndex",value:function(e){var t,n=this;return this.editorInfo.callStack.inCallStackIfNecessary("getTargetIndex",function(){t=n.editorInfo.domToRep(e)},{shouldIncorp:!0}),t&&t.selStart[0]}},{key:"getTargetSpan",value:function(e){var t=Object(k.n)("span:first-child",e);return t?(Object(k.f)(t,"pocket-ignore")&&(t=t.nextElementSibling),t):null}},{key:"_createEmptyLine",value:function(e,t){var n,i=[e,0],r=this.editorInfo.getRep(t),o=r.lines.length()-1;e===o+1&&"0"!==t?(n=r.lines.atIndex(o).text.length,this.editorInfo.performDocumentReplaceRange(t,[o,n],[o,n],"\n")):this.editorInfo.performDocumentReplaceRange(t,i,i,"\n"),this.editorInfo.selection.setWithSelection(t,i,i)}},{key:"isGalleryLine",value:function(e,t){return this.editorInfo.getAttributesOnLine(e,t).some(function(e){var t=r()(e,1)[0];return"gallery"===t||"image-uploaded"===t})}},{key:"isImage",value:function(e){return Object(h.Q)()?!!Object(k.o)(e,"new-gallery"):!!e.querySelector(".image-uploaded")}},{key:"isSheet",value:function(e){return Object(k.f)(e,"sheet")}},{key:"isHorizontalLine",value:function(e){return Object(k.f)(e,"horizontal-line")}},{key:"isAceTable",value:function(e){return-1<e.className.indexOf("aceTable-")}},{key:"isSingleLine",value:function(e){var t=Object(k.o)(e,"ace-line");return Object(k.f)(t,"single-line")}},{key:"isCodeBlockV2",value:function(e){return Object(k.f)(e,f.a.SPAN)}},{key:"isCalloutBlock",value:function(e){return Object(k.f)(e,p.h.SPAN)}},{key:"isValidDOM",value:function(e){return!!e&&!!(this.isImage(e)||this.isSheet(e)||this.isHorizontalLine(e)||this.isAceTable(e)||this.isSingleLine(e)||this.isCodeBlockV2(e)||this.isCalloutBlock(e))}},{key:"handleBodyClick",value:function(e){var t,n,i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C=this;this.readOnly||(t=e.target)!==e.currentTarget&&(n=t,Object(k.f)(n,"ace-line")||(n=Object(k.o)(t,"ace-line")),n&&(i=this.getTargetSpan(n),this.isValidDOM(i)&&(!(r=this.getTargetIndex(n))&&0!==r||(o=this.editorInfo.selection.getPositionForNode(n),this.isElementTopOrBottomClick(e,"top")?(a=Object(k.m)(n))&&(s=this.getTargetSpan(a),this.isValidDOM(s)&&this.editorInfo.callWithAce(function(){C._createEmptyLine(r,o.zone)},"insertLinePrev",!0)):this.isElementTopOrBottomClick(e,"bottom")?(c=Object(k.k)(n),l=this.getTargetSpan(c||n),this.isValidDOM(l)&&(r++,this.editorInfo.callWithAce(function(){C._createEmptyLine(r,o.zone)},"insertLineNext",!0))):this.isElementInTableCellTopClick(e)?(u=this.editorInfo.domToRep(t.firstChild),d=t.dataset.zoneId||u.selStart[2],h=this.editorInfo.getRep(d),f=this.isGalleryLine(d,0),p=Object(I.d)(h,0),g=Object(I.h)(h,0),m=Object(I.e)(h,0),!(""===h.lines.atIndex(0).text)&&(f||p||g||m)?this.editorInfo.callWithAce(function(){C._createEmptyLine(0,d)},"insertLinePrev",!0):(v=[0,0],this.editorInfo.selection.setWithSelection(d,v,v),this.editorInfo.updateBrowserSelectionFromRep(!0))):this.isElementInTableCellClick(e)&&(b=this.editorInfo.domToRep(t.getElementsByClassName("ace-line")[0]).selStart[2],y=this.editorInfo.getRep(b),E=y.lines.length(),""===y.lines.atIndex(E-1).text?(O=[E-1,0],this.editorInfo.selection.setWithSelection(b,O,O),this.editorInfo.updateBrowserSelectionFromRep(!0)):this.editorInfo.callWithAce(function(){C._createEmptyLine(E,b)},"insertLineNext",!0))))))}}]),t}();new(y=m([Object(d.a)(["bindEvent"])],y))},v5fw:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=function(){function e(){r()(this,e),this.timeoutId=void 0}return a()(e,[{key:"isSleeping",value:function(){return void 0!==this.timeoutId}},{key:"sleep",value:function(t){var n=this;return this.cancel(),new Promise(function(e){n.timeoutId=window.setTimeout(function(){n.timeoutId=void 0,e()},t)})}},{key:"cancel",value:function(){this.isSleeping()&&(window.clearTimeout(this.timeoutId),this.timeoutId=void 0)}}]),e}()},v6N1:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return I});var i=n("J4zp"),f=n.n(i),r=n("RIqP"),h=n.n(r),p=n("j1lG"),g=n("Tqb2"),m=n("iP/4"),v=n("Cf53");function b(e){var i={};return e.forEach(function(e){var t=e.uuid,n=e.size;i[t]=n}),i}function y(e,t){return Object(g.C)(e,t)||t.getRect().width}function c(e){return Object.values(e).reduce(function(e,t){return e+(t.aspectRatio||1)},0)}function E(e){return Object.values(e).reduce(function(e,t){return e+t.displayWidth},0)}function O(e,t){return e.filter(function(e){return e.uuid!==t.uuid})}function o(e,t,n,i){var r=[].concat(h()(O(e,t)),[t]),o=e.length,a=1<e.length,s=e.some(function(e){return e.uuid===t.uuid}),c=y(n,i),l=Object(g.i)(o,c,n),u=E(b(e));if(!a&&t)return k(r,l);if(a&&t&&!s){var d=l-u;return d>=p.I?C(e,t,d):k(r,l)}return I(r,n,i)}function C(e,t,n){var i=b(e),a=new Map;Object.entries(i).forEach(function(e){var t=f()(e,2),n=t[0],i=t[1],r=i.displayWidth,o=i.displayHeight;a.set(n,{width:r,height:o,maxWidth:r})});var r=t.uuid,o=n/t.size.aspectRatio;return a.set(r,{width:n,height:o,maxWidth:n}),a}function k(e,t){var n=b(e),o=new Map,i=c(n),a=0,r=Math.floor(t/i)||p.I,s=r<p.I?r/p.I:1,a=r/s;return Object.entries(n).forEach(function(e){var t=f()(e,2),n=t[0],i=t[1].aspectRatio,r=Math.floor(a*(i||1)*s)||1;o.set(n,{width:r,height:a,maxWidth:r})}),o}function a(e,u){var t=b(e),d=new Map,n=E(t),h=Math.max(0,u-n);return Object.entries(t).forEach(function(e){var t,n=f()(e,2),i=n[0],r=n[1],o=r.displayWidth,a=r.displayHeight,s=r.aspectRatio,c=Math.min(o+h,u);!m.a.isOpendoc||(t=Object(v.b)())&&t.maxWidth&&(c=Math.min(c,t.maxWidth));var l=Math.floor(c/s);d.set(i,{maxWidth:c,maxHeight:l,width:o,height:a})}),d}function I(e,t,n){var i=y(t,n);return a(e,Object(g.i)(e.length,i,t))}},vAXZ:function(e,t,n){"use strict";var i,r=n("lwsE"),o=n.n(r),a=n("W8MJ"),s=n.n(a),c=n("cDf5"),l=n.n(c),u=n("usyV"),d=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},h="cover-style",f=function(){function t(e){o()(this,t),this.props=e}return s()(t,[{key:"coverStyle",value:function(){var e;this.isFilter()||(e=this.getStyleSheet())&&this.getStyleSheetContainer().append(e)}},{key:"isFilter",value:function(){return!1}},{key:"getStyleSheet",value:function(){var e=this.getStyleSheetText();if(e){var t=document.createElement("style");return t.innerText=e,t.setAttribute("data-name",h),t}}},{key:"getStyleSheetContainer",value:function(){return document.querySelector("head")}}],[{key:"destory",value:function(){var e=document.querySelectorAll("[data-name=".concat(h,"]"));[].forEach.call(e,function(e){return e.remove()})}}]),t}(),p=f=d([u.default],f),g=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},m=function(){function t(e){o()(this,t),this.props=e,this.isCoveredList=[]}return s()(t,[{key:"getCreator",value:function(e){return this.props.plugins[e]}},{key:"do",value:function(e,t){var n=new(this.getCreator(e))(t),i=n.getId();this.isCoveredList.includes(i)||(n.coverStyle(),this.isCoveredList.push(i))}},{key:"reset",value:function(){p.destory(),this.isCoveredList=[]}}]),t}(),v=m=g([u.default],m),b=n("lSNA"),y=n.n(b),E=n("a1gu"),O=n.n(E),C=n("Nsbk"),k=n.n(C),I=n("7W2i"),S=n.n(I),T=n("4D8z"),_=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},w=function(e){function t(){var e;return o()(this,t),(e=O()(this,k()(t).apply(this,arguments))).filterable=!1,e}return S()(t,e),s()(t,[{key:"isFilter",value:function(){return this.filterable&&this.isTableLTWrapWidth()}},{key:"isTableLTWrapWidth",value:function(){var e=this.getWrapWidth();return this.getTableWidth()<e}},{key:"getWrap",value:function(){return document.getElementById("innerdocbody")}},{key:"getWrapWidth",value:function(){var e=this.getWrap(),t=parseInt(window.getComputedStyle(e).paddingLeft||"0",10);return e.clientWidth-t}},{key:"getSortColWidth",value:function(){return this.getColWidth().map(function(e,t){return{width:e,index:t}}).sort(function(e,t){return e.width-t.width})}}]),t}(p),j=w=_([u.default],w),M=(n("ApcK"),function(e){function t(){var e;return o()(this,t),(e=O()(this,k()(t).apply(this,arguments))).filterable=!0,e}return S()(t,e),s()(t,[{key:"getId",value:function(){return this.props.table.getTableId().split(" ")[0]}},{key:"getTableWidth",value:function(){return this.props.table.getTableScrollWidth()}},{key:"getColWidth",value:function(){return this.props.table.state.colAttribs.map(function(e){return parseInt(e.colWidth,10)||T.r})}},{key:"getStyleSheetText",value:function(){var r=this.getId(),o=this.getTableWidth(),a=this.getWrapWidth(),s=function(e){return Math.max(Math.round(e/o*a),50)};return this.getSortColWidth().map(function(e){var t=e.width,n=e.index,i=s(t);return a-=i,o-=t,"\n        .".concat(r," colgroup col:nth-child(").concat(n+1,") {\n          width: ").concat(i,"px !important;\n          min-width: ").concat(i,"px !important;\n        }\n      ")}).join(" ")}}]),t}(j)),L=n("RIqP"),R=n.n(L),N=n("EVdn"),D=n.n(N),x=(n("B+y1"),function(e){function t(){return o()(this,t),O()(this,k()(t).apply(this,arguments))}return S()(t,e),s()(t,[{key:"getId",value:function(){var e=this.props.table.className,t=/(table-id-[^\s]+)/.exec(e);return t?t[0]:""}},{key:"getTableWidth",value:function(){return D()(".tb-scrollable-children",this.props.table).width()||0}},{key:"getColWidth",value:function(){return R()(D()("col",this.props.table)).map(function(e){return parseInt(e.width||"0",10)})}},{key:"getStyleSheetContainer",value:function(){return this.props.getStyleSheetContainer()}},{key:"getStyleSheetText",value:function(){var r=this.getId();if(!r)return"";var t=this.getTableWidth(),o=function(e){return Math.max(Math.round(100*e/t),10)},e=this.getSortColWidth().map(function(e){var t=e.width,n=e.index,i=o(t);return"\n        .".concat(r," colgroup col:nth-child(").concat(n+1,") {\n          width: ").concat(i,"% !important;\n          min-width: 50px !important;\n        }\n      ")});return e.push("\n      .".concat(r," .tb-scrollable-content,\n      .").concat(r," .tb-scrollable-children,\n      .").concat(r," .ace-table,\n      .").concat(r," .ace-table-wrapper-inner {\n        width: 100% !important;\n        padding: 0 !important;\n        margin: 0 !important;\n        transform: none !important;\n      }\n    ")),e.join(" ")}}]),t}(j)),P=n("J4zp"),B=n.n(P),U=n("FJEn"),z=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},H=function(e){function t(){return o()(this,t),O()(this,k()(t).apply(this,arguments))}return S()(t,e),s()(t,[{key:"getId",value:function(){return"HideEmptyLine"}},{key:"isBlank",value:function(e){if(e&&e.isEmpty()){var n=["author","lmkr","lineguid","heading","insertorder","align"];return e.getAttributes().every(function(e){var t=B()(e,1)[0];return n.includes(t)})}return!1}},{key:"getBlankLines",value:function(){var e=this.props.editor;if(!e)return[];for(var t=e.getContentState().getZoneState(U.DEFAULT_REP_ZONE),n=[],i=t.length()-1;1<i;i--){var r=t.getLine(i);if(!r||!this.isBlank(r))break;n.push(r)}return n}},{key:"getStyleSheetContainer",value:function(){return this.props.getStyleSheetContainer()}},{key:"getStyleSheetText",value:function(){var e,t=this.getBlankLines().map(function(e){return".maindocbody > #".concat(e._node.id)});return t.length&&(e="".concat(t.join(",")," {\n        display: none;\n      }")),e}}]),t}(p),F=H=z([u.default],H),V={PDF_TABLE:"PDF_TABLE",PRINT_TABLE:"PRINT_TABLE",EMPTY_LINE:"EMPTY_LINE"},W=(i={},y()(i,V.PDF_TABLE,M),y()(i,V.PRINT_TABLE,x),y()(i,V.EMPTY_LINE,F),i);n.d(t,"b",function(){return K}),n.d(t,"a",function(){return V});var K=new v({plugins:W})},vKd0:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},t),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.7 15.55h2.67l7.94-7.94a.7.7 0 000-.99l-2.4-2.41a.7.7 0 00-1 0l-.49.49L9 12.18v2.67c0 .39.31.7.7.7zm7.5-9.47l1.16 1.17-.92.93-1.16-1.16.91-.94zM15 8.3L16.2 9.5l-4.2 4.21-1.18-1.18 4.16-4.24zm-8.46 7.86a1.6 1.6 0 00-1.1-.38c-.37 0-.69.11-.95.33-.23.2-.39.5-.44.82-.02.1.04.18.17.18h.6c.08 0 .14-.04.17-.1l.02-.04c.04-.1.11-.2.18-.24a.56.56 0 01.63.03c.09.07.13.16.13.28 0 .12-.04.2-.12.27-.1.08-.22.12-.4.12h-.04a.28.28 0 00-.28.27v.26c0 .15.13.27.28.27h.09c.16 0 .28.04.38.12.1.07.14.18.15.34 0 .14-.06.24-.15.32a.54.54 0 01-.37.12.5.5 0 01-.31-.08.76.76 0 01-.19-.24c-.04-.08-.09-.11-.19-.11h-.6c-.11 0-.16.03-.2.11-.05.13.3.72.54.89a1.68 1.68 0 002.01-.06 1.2 1.2 0 00.31-1.5 1.07 1.07 0 00-.27-.32c.1-.09.19-.19.25-.3a1.18 1.18 0 00-.3-1.36zM20 17.8a.3.3 0 00-.3-.3H9.3a.3.3 0 00-.3.3v.9c0 .17.13.3.3.3h10.4a.3.3 0 00.3-.3v-.9zM6.56 10.36a1.67 1.67 0 00-1.1-.36c-.4 0-.74.12-1.02.36-.27.24-.42.54-.44.9 0 .1.08.17.17.17h.69c.08 0 .15-.07.15-.15a.44.44 0 01.17-.3c.09-.07.2-.11.34-.11.15 0 .27.04.35.12.08.07.11.16.11.27 0 .04 0 .09-.02.14a.61.61 0 01-.1.15L4 13.48v.49c0 .14.12.25.26.25h2.48c.14 0 .26-.11.26-.25v-.37a.26.26 0 00-.26-.25h-1.3l1.24-1.3a1.15 1.15 0 00-.12-1.69zM6 4.54a.25.25 0 00-.25-.26h-.53a.25.25 0 00-.13.03l-.95.5a.25.25 0 00-.14.23v.68c0 .14.16.22.28.15L5 5.5V8.2c0 .14.11.25.25.25h.5c.14 0 .25-.11.25-.25V4.54z",fill:"#2B2F36"}))}},vY9h:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i,r,o=n("QM+C");(r=i=i||{})[r.ALL_TYPES=0]="ALL_TYPES",r[r.DOC=o.NUM_SUITE_TYPE.DOC]="DOC",r[r.SHEET=o.NUM_SUITE_TYPE.SHEET]="SHEET",r[r.MINDNOTE=o.NUM_SUITE_TYPE.MINDNOTE]="MINDNOTE"},vYX0:function(e,t,n){"use strict";n.d(t,"b",function(){return C}),n.d(t,"a",function(){return I});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("PJYZ"),h=n.n(d),f=n("7W2i"),p=n.n(f),g=n("TSYQ"),m=n.n(g),v=n("q1tI"),b=n.n(v),y=n("ucr6"),E=n("dDhe"),O=function(e){function t(){var n;return r()(this,t),(n=c()(this,u()(t).apply(this,arguments))).titleRef=null,n.setTitleRef=function(e){e&&(n.titleRef=e)},n.state={shouldHasTooltip:!1},n.checkShouldHasTooltip=function(){var e,t=h()(n).titleRef;t&&(e=t.offsetWidth<t.scrollWidth,n.setState({shouldHasTooltip:e}))},n}return p()(t,e),a()(t,[{key:"componentWillUnmount",value:function(){this.titleRef=null}},{key:"renderTitle",value:function(){var e=this.props,t=e.text,n=e.guid,i=e.olStart,r=e.olCls,o=e.onFullEntryClicked,a=Object(E.c)()?"#":y.a.createHref(Object.assign({},y.a.location,{hash:n}));return b.a.createElement("a",{className:"full-entry-title","data-guid":n,href:a,onClick:o,ref:this.setTitleRef,title:this.state.shouldHasTooltip?t:"",onMouseEnter:this.checkShouldHasTooltip},null!==i&&null!==r?b.a.createElement("ol",{start:i,className:r},b.a.createElement("li",null,t)):t)}},{key:"render",value:function(){var e=this.props,t=e.active,n=e.type,i=e.guid,r=e.setActiveEntryRef,o=e.indentationLevel,a=e.attrMap,s=e.translated&&a&&"true"===a.translate,c=m()("full-entry",n,{active:t},"indentation-level-".concat(o),{"translate-nav":s});return b.a.createElement("li",{className:c,"data-guid":i,ref:t?r:void 0},this.renderTitle())}}]),t}(v.PureComponent);O.defaultProps={};var C=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return p()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.entries!==e.entries}},{key:"render",value:function(){var e=this.props,i=e.activeGuid,t=e.entries,n=e.setActiveEntryRef,r=e.onFullEntryClicked,o=e.containerRef,a={setActiveEntryRef:n,onFullEntryClicked:r,translated:e.translated},s=t.map(function(e){var t=e.guid,n=e.text;return""===(void 0===n?"":n).trim()?null:b.a.createElement(O,Object.assign({key:t},e,{active:t===i},a))});return b.a.createElement("ul",{className:"full-entries",ref:o},s)}}]),t}(v.Component);C.defaultProps={};var k=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return p()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.active,n=e.type,i=e.guid,r=m()("abstract-entry",n,{active:t});return b.a.createElement("li",{className:r,key:i,"data-guid":i})}}]),t}(v.PureComponent),I=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return p()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.entries!==e.entries}},{key:"render",value:function(){var e=this.props,i=e.activeGuid,t=e.entries.map(function(e){var t=e.guid,n=e.type;return b.a.createElement(k,{key:t,active:t===i,type:n,guid:t})});return b.a.createElement("ul",{className:"abstract-entries"},t)}}]),t}(v.Component)},vlE4:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lwsE"),r=n.n(i),o=n("2ACu"),a=n("SebV"),s=function t(e){var n=this;r()(this,t),this.msgQueue=[],this.editor=null,this.onMount=function(e,t){n.editor.on("sendUserChangeMsg",n.pushMsg),document.addEventListener("visibilitychange",n.handleVisibilityChange),window.addEventListener("beforeunload",n.stopLoop),n.startLoop()},this.pushMsg=function(e){n.msgQueue.push(e),n.msgQueue.length>=t.MAX_LENGTH&&(n.loopTimer&&clearTimeout(n.loopTimer),setTimeout(function(){n.sendTeaLog(),n.startLoop()},0))},this.handleVisibilityChange=function(){"visible"===document.visibilityState?n.startLoop():n.stopLoop()},this.sendTeaLog=function(){if(n.msgQueue.length){var e="";try{e=JSON.stringify(n.msgQueue)}catch(e){Object(a.a)(new Error("Error! Userchange tea: ".concat(e,".")))}Object(o.collectSuiteEvent)(t.EVENT_NAME,{msg_list:e,__disable_storage__:1}),n.msgQueue=[]}},this.startLoop=function(){n.loopTimer=setTimeout(function(){n.sendTeaLog(),n.startLoop()},t.INTERVAL)},this.stopLoop=function(){n.sendTeaLog(),n.loopTimer&&(clearTimeout(n.loopTimer),n.loopTimer=null)},this.reset=function(e,t){n.stopLoop(),n.editor.off("sendUserChangeMsg",n.pushMsg),document.removeEventListener("visibilitychange",n.handleVisibilityChange),window.removeEventListener("beforeunload",n.stopLoop)},this.editor=e};s.EVENT_NAME="dev_stabilty_user_change",s.INTERVAL=12e4,s.MAX_LENGTH=100},vpf3:function(e,t,n){},w2ss:function(e,m,y){"use strict";(function(n){y.d(m,"a",function(){return g});var e=y("J4zp"),E=y.n(e),t=y("lwsE"),i=y.n(t),r=y("W8MJ"),o=y.n(r),a=y("hMnB"),l=y.n(a),v=y("KiC9"),b=y("3poY"),O=y("yEIg"),s=y("AiBH"),C=y("H6oK"),c=y("2ACu"),u=y("58X4"),d=y("FJEn"),h=y("n/R6"),k=y("iP/4"),I=y("wH0k"),f=(y("U/9v"),y("uXHE")),S=y("kESg"),p=y("y2sV"),T=y("j1lG"),g=function(){function t(e){var c=this;i()(this,t),this.editor=e,this.className="LineMenuOperate",this.operateInfo=null,this.handleAnchorLink=function(){c.collectEvent("copy_anchor_link");var e,t,n,i,r,o,a,s=c.getLineGuid();s&&(t=(e=c.editor.getRep()).zoneId,n=e.selStart,i=e.selEnd,a="",r=l.a.href,a=(o=l.a.hash)?r.replace(o,"#".concat(s)):-1<r.indexOf("#")?r.replace("#","#".concat(s)):r+"#".concat(s),k.a.isLark&&(a=a.replace(/lark=\w*&?/,"")),a=a.replace("?#","#"),c.copyLinkToClipboard(a),c.editor.selection.setWithSelection(t,n,i),c.editor.selection.updateBrowserSelectionFromRep(!0))},this.handleUpdateRep=function(e){c.operateInfo=e},this.handleLineCopy=function(){c.collectEvent("copy"),c.lineCopy(p.k.COPY),c.operateInfo&&c.operateInfo.lineType&&c.operateInfo.lineType.includes(O.c.ACE_TABLE)||h.a.success({content:n("invite.tooltiptitle"),duration:2e3})},this.handleLineCut=function(){c.collectEvent("cut"),c.lineCopy(p.k.CUT)},this.handleLineDelete=function(){c.collectEvent("delete"),c.lineDelete()},this.handlerDebugBlock=function(){var e=c.findISVBlock();e&&e.debugBlock()},this.handlerDebugCreator=function(){var e=c.findISVBlock();e&&e.debugCreator()},this.handlerReload=function(){var e=c.findISVBlock();e&&e.reload()},this.findISVBlock=function(){if(!c.operateInfo)return null;var e=c.operateInfo,t=e.zoneId,n=E()(e.position,1)[0];if(e.lineType.includes(O.c.BLOCK)){var i=Object(f.c)(c.editor,{lineNum:n,zoneId:t});if(i)return c.editor.plugins.blockPlugin.getBlockById(i.blockId)}return null},this.execCommand=function(e){var t=document.createElement("textarea");document.body.appendChild(t),t.addEventListener(e,c.handleCopyCut),t.style.opacity="0",t.value=" ",t.focus(),t.select(),!0!==document.execCommand(e)&&console.warn("execCommand ".concat(e," fail")),t.removeEventListener(e,c.handleCopyCut),document.body.removeChild(t)},this.handleCopyCut=function(e){var t=e.type;c.editor&&(t===p.k.CUT?c.editor.clipboard.onCut(e):t===p.k.COPY&&c.editor.clipboard.onCopy(e))},this.setSelectionByArea=function(e,t){var n,i,r,o=c.getSelectionArea(e,t,!0);o&&(i=(n=E()(o,2))[0],r=n[1],c.editor.selection.setWithSelection(e,i,r),c.editor.updateBrowserSelectionFromRep(!0))},this.bindEvents()}return o()(t,[{key:"bindEvents",value:function(){this.editor.commands.registerCommand(s.b.COPY_ANCHOR_LINK,this.handleAnchorLink),this.editor.commands.registerCommand(s.b.LINE_COPY,this.handleLineCopy),this.editor.commands.registerCommand(s.b.LINE_CUT,this.handleLineCut),this.editor.commands.registerCommand(s.b.LINE_DELETE,this.handleLineDelete),this.editor.commands.registerCommand(s.b.ISV_BLOCK_REFRESH,this.handlerReload),this.editor.commands.registerCommand(s.b.ISV_DEBUG_CREATOR,this.handlerDebugCreator),this.editor.commands.registerCommand(s.b.ISV_DEBUG_BLOCK,this.handlerDebugBlock),this.editor.on("lineMenuOperate:updateRep",this.handleUpdateRep)}},{key:"unBindEvents",value:function(){this.editor.off("lineMenuOperate:updateRep",this.handleUpdateRep)}},{key:"destroy",value:function(){this.unBindEvents()}},{key:"getLineGuid",value:function(){if(!this.operateInfo)return null;var e=this.operateInfo,t=e.zoneId,n=E()(e.position,1)[0];return this.editor.getRep(t).attributeManager.findAttributeOnLine(n,"lineguid")}},{key:"copyLinkToClipboard",value:function(e){var t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="1px",t.style.height="1px",t.style.padding="0",t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t),h.a.success({content:n("invite.tooltiptitle"),duration:2e3})}},{key:"getLineMarker",value:function(e,t){var n=e.lines.atIndex(t);return n?n.lineMarker:0}},{key:"getSelectionArea",value:function(e,t,n){var i=this.editor.getRep(e),r=this.editor.getRep(e).lines.atIndex(t),o=[[t,n?0:this.getLineMarker(i,t)],[t,i.alinesWidth[t]-1]],a=r&&r.lineNode;if(!a)return null;var s,c=a.lineManager;c&&(o=(s=c.getLineAndChar(a))?[s.selStart,s.selEnd]:o);var l=Object(b.b)(this.editor,e,t);if(l.length){var u=l[0],d=l[l.length-1];return[[u,n?0:this.getLineMarker(i,u)],[d,i.alinesWidth[d]-1]]}var h=Object(v.b)(a);if(h){var f=h.start,p=h.end,g=this.editor.advancedDomToRep(f),m=this.editor.advancedDomToRep(p);if(g&&m)return[[g.selStart[0],n?0:this.getLineMarker(i,g.selStart[0])],[m.selEnd[0],m.selEnd[1]]]}return o}},{key:"collectEvent",value:function(e){var t,n,i,r,o,a,s;this.operateInfo&&(n=(t=this.operateInfo).zoneId,i=E()(t.position,1)[0],r=this.editor.getRep(n),a=(o=Object(u.b)(r,i)).id,s=o.type,Object(c.default)("toggle_attribute",{action:e,source:"block_menu",zone_id:Object(u.c)(this.editor,n)||"",zone:n===d.DEFAULT_REP_ZONE?"default":"table",object_id:a||"",object_type:s}))}},{key:"lineCopy",value:function(e){var t=this;if(this.operateInfo){var n=this.editor.getRep(),i=n.zoneId,r=n.selStart,o=n.selEnd,a=this.operateInfo,s=a.zoneId,c=E()(a.position,1)[0],l=a.lineType;if(l.includes(O.c.BLOCK)){var u=this.editor.plugins.blockPlugin,d=this.editor.getAttributeOnLine(s,c,C.BLOCK_DATA_META_BLOCK_PROPS),h=d&&Object(C.parseJsonSafely)(d);if(h&&u){var f=u.getBlockInfo(h.blockId);return void(f&&u[e+"Block"]({block:f.instance},e))}}if(l.includes(O.c.ACE_TABLE)){var p=this.editor.getRep(s).lines.atIndex(c),g=p&&p.getAllInstances()[0];if(g){var m=this.editor.getPlugin(T.K);return m&&m.setPreventAutoFixSelection(!0),g.focusAndCollapseSelectionOntoCell(0,0),m&&m.setPreventAutoFixSelection(!1),g.selectAll(),void g[e+"Table"]()}}if((k.a.isSafari||k.a.isIOS)&&l.includes(O.c.IMAGE)){var v=this.editor.getRep(s).lines.atIndex(c),b=window.getSelection();if(v&&v.lineNode&&b){var y=v.lineNode.outerHTML;return I.a.setDataWithoutEvent({html:y}),void("cut"===e?this.editor.performDelete(c):"copy"===e&&this.recoverOriginSelection(i,r,o))}}this.editor.setStopUpdateSelection(!0),this.setSelectionByArea(s,c),(l.includes(O.c.CODE_BLOCK_V2)||l.includes(O.c.CALLOUT_BLOCK))&&this.triggerTransparentSelection(!0,s,c,".".concat(S.e.SPAN)),setTimeout(function(){t.execCommand(e),(l.includes(O.c.CODE_BLOCK_V2)||l.includes(O.c.CALLOUT_BLOCK))&&t.triggerTransparentSelection(!1,s,c,".".concat(S.e.SPAN)),"copy"===e&&t.recoverOriginSelection(i,r,o),t.editor.setStopUpdateSelection(!1)})}}},{key:"recoverOriginSelection",value:function(e,t,n){this.editor.selection.setWithSelection(e,t,n),this.editor.selection.updateBrowserSelectionFromRep(!0)}},{key:"triggerTransparentSelection",value:function(e,t,n,i){var r,o=this.editor.getRep(t).lines.atIndex(n);o&&o.lineNode&&(r=o.lineNode.querySelector(i),e?r&&r.classList.add("transparent-selection"):r&&r.classList.remove("transparent-selection"))}},{key:"lineDelete",value:function(){var e,t,n,i,r,o,a,s,c,l,u,d,h,f=this;this.operateInfo&&(e=this.operateInfo,t=e.zoneId,n=E()(e.position,1)[0],r=(i=this.editor.getRep()).zoneId,o=i.selStart,a=i.selEnd,this.editor.selection.setWithSelection(t,[n,0],[n,0]),(s=this.getSelectionArea(t,n,!0))&&(c=E()(s,2),l=c[0],u=c[1],this.editor.inCallStackIfNecessary("line_popover_line_delete",function(){f.editor.callStack.getCurrentCallStack().preventScrolling=!0,f.editor.performDocumentReplaceRange(t,l,u,"")}),d=this.editor.getLineNumInRootZone(r,a[0]),!(o[0]>=l[0]&&a[0]<=u[0])&&0<=d&&(o[0]>l[0]&&(h=u[0]-l[0],o[0]-=h,a[0]-=h),this.editor.selection.setWithSelection(r,o,a))))}}]),t}()}).call(this,y("2vAP"))},wAsq:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"c",function(){return h}),n.d(t,"a",function(){return f});var i=n("dYt1"),r=n("HA5h"),o=n("SyrE"),a=n("Trbk"),s="PRESENTER_FOLLOWER_LOCATION",c={presenter:{x:0,y:0,space:""},follower:{x:0,y:0,space:""}},l=Object(i.a)(c),u=function(e,t){var n=Object(r.a)(l[e],t);l[e]=n},d=function(e,t){t&&u(e,t),o.g.emit("".concat(a.c,":").concat(s),l)},h=function(e,t){u(e,{space:t})},f=function(){l=Object(i.a)(c)}},wCm6:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("gSGL"),r=n("toa8"),o=function(e){var t=Boolean(e.ignoreInterceptors),n=Math.max(e.url.indexOf("/api"),0);return e.url=e.url.substring(n),Object(r.d)(Object.assign({},e,{headers:Object.assign({"Content-Type":"application/json"},e.headers),ignoreInterceptors:t})).then(function(e){return t?e:{data:Object(i.a)(e.data)?e.data:e}}).catch(function(e){throw e.originalError||e})}},wH0k:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("iP/4"),r=a.a,i={setData:function(e,t){var n=t.text,i=t.html;(n||i)&&(r.modernIE?e.setData("text",i):(e.setData("text/html",i),e.setData("text/plain",n)))},getData:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"text/html";return r.modernIE?e.getData("text"):e.getData(t)},setDataWithoutEvent:function(o){function e(e){e.preventDefault(),e.stopImmediatePropagation&&e.stopImmediatePropagation();var t=o.html,n=void 0===t?"":t,i=o.text;document.createElement("div").innerHTML=n;var r=e.clipboardData||window.clipboardData;a.a.modernIE?r.setData("text",n||i):(r.setData("text/html",n),r.setData("text/plain",i))}var t=document.createElement("textarea");document.body.appendChild(t),document.addEventListener("copy",e),t.style.opacity="0",t.value=" ",t.focus({preventScroll:!0}),t.select(),document.execCommand("copy"),document.removeEventListener("copy",e),document.body.removeChild(t)}}},wKA5:function(e,t,n){},wMhR:function(e,S,T){"use strict";(function(u){var e=T("pVnL"),te=T.n(e),t=T("lwsE"),n=T.n(t),i=T("W8MJ"),r=T.n(i),o=T("a1gu"),a=T.n(o),s=T("Nsbk"),c=T.n(s),l=T("7W2i"),d=T.n(l),h=T("ifKl"),f=T("Muja"),p=T("q1tI"),ne=T.n(p),g=(T("17x9"),T("TSYQ")),m=T.n(g),ie=T("VI6H"),re=T("dd8S"),v=T("hqaq"),b=T("l077"),y=(T("UH97"),T("P4CN")),E=T("UlbS"),O=T("xbZX"),C=T("5gSl"),k=T("rLED"),oe=Object(k.I)("orientation_comment_enabled",!0),I=function(e){function t(e){var ee;return n()(this,t),(ee=a()(this,c()(t).call(this,e))).handleResolve=function(e){e&&Object(C.a)(e);var t=ee.props,n=t.onResolve,i=t.commentId;n&&n(i)},ee.handleRetry=function(e,t){var n=ee.props,i=n.onRetry,r=n.commentId,o=ee.findReply(t);i&&i(r,o,e)},ee.handleEdit=function(e){var t=ee.props,n=t.onEdit,i=t.commentId,r=ee.findReply(e);n&&n(i,r)},ee.handleDelete=function(e){var t=ee.props,n=t.onDelete,i=t.commentId,r=ee.findReply(e);n&&n(i,r)},ee.handleTranslate=function(e,t){var n=ee.props,i=n.onTranslate,r=n.commentId;i&&i(r,e,t)},ee.itemRefMap=new Map,ee.setContentToUpdateTextarea=function(e,t){ee.itemRefMap.has(e)&&ee.itemRefMap.get(e).handleOnEdit(t)},ee.renderItem=function(e,t,n,i){var r=ee.props,o=r.reference,a=r.showContentLimit,s=r.onResize,c=r.ellipsisAuthorClass,l=r.updateTextAreaProps,u=r.panelExpand,d=r.myUserId,h=r.getToolTipContainer,f=r.busNameSpace,p=r.addReaction,g=r.removeReaction,m=r.readonly,v=r.enableReaction,b=r.onClickReactionDetail,y=r.onShowReactionPanel,E=r.translateContentCompare,O=r.transEnabled,C=r.embedObjShareEnable,k=r.commentId,I=r.onReactionMouseEnter,S=r.enableFullCommentStyle,T=r.resolvable,_=r.source,w=r.commentImageEnabled,j=r.scrollContainer,M=r.isCalcCommentPosition,L=e.message_id,R=e.error,N=e.sending,D=e.type,x=e.avatar_url,P=e.reply_id,B=e.realReplyId,U=e.content,z=e.status,H=e.showBadge,F=e.name,V=e.user_id,W=e.modify,K=e.entities,Z=e.extra,q=e.translate_status,Y=e.translate_content,J=e.equal_lang,Q=e.reactions,X=e.isWhole,$={readonly:m,currentUserId:d,reference:o,sending:N,error:R,showContentLimit:a,userName:Object(ie.o)(V)||F,avatar:x,content:U,time:e.update_timestamp||e.create_timestamp,type:D,onRetry:ee.handleRetry,onResize:s,status:z,showBadge:H,ellipsisAuthorClass:c,replyId:P,realReplyId:B,commentId:k,modify:W,messageId:L,busNameSpace:f,token:V,panelExpand:u,updateTextAreaProps:l,isMyReply:e.user_id===d,entities:K,extra:Z,getToolTipContainer:h,translateStatus:q,translateContent:Y,reactions:Q,enableReaction:v,addReaction:p,removeReaction:g,onClickReactionDetail:b,onShowReactionPanel:y,translateContentCompare:E,transEnabled:O,embedObjShareEnable:C,onDelete:ee.handleDelete,onEdit:ee.handleEdit,onTranslate:ee.handleTranslate,onReactionMouseEnter:I,highlight:t===P,onHighlightChange:n,equalLang:J,enableFullCommentStyle:S,enableReply:S?0===i:oe,source:_,isWhole:X,commentImageEnabled:w,scrollContainer:j,isCalcCommentPosition:M};return(T||S)&&($.onResolve=ee.handleResolve),$.enableReply&&($.onReply=ee.props.onReply),ne.a.createElement(re.a,te()({key:P,ref:function(e){return ee.setItemRef(P,e)}},$))},ee.renderList=function(t){var e=ee.props,n=e.highlightId,i=e.onHighlightChange;return i?t.map(function(e,t){return ee.renderItem(e,n,i,t)}):ne.a.createElement(O.a,null,function(e){var n=e.highlightId,i=e.onHighlightChange;return t.map(function(e,t){return ee.renderItem(e,n,i,t)})})},ee.renderCollapsed=function(e){var t,n=e.length,i=[];if(0===n)return i;for(t=0;t<n;t++)if(e[t].status===y.a)break;for(0<t&&(i.push(ee.renderItem(e[0])),2<t&&i.push(ne.a.createElement(v.a,{count:t-2,key:"0"})),0<t-1&&i.push(ee.renderItem(e[t-1])));t<n;t++)i.push(ee.renderItem(e[t]));return i},ee.getListRef=function(e){ee.node=e;var t=ee.props.commentListRef;t&&t(e)},ee.state={highlightId:""},ee}return d()(t,e),r()(t,[{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,i=n.list,r=n.resolvable,o=n.expand,a=n.translateContentCompare,s=n.highlightId,c=n.canSwitchToPrevComment,l=n.canSwitchToNextComment,u=n.scrollContainer,d=n.isCalcCommentPosition;return!Object(f.default)(i,e.list)||r!==e.resolvable||o!==e.expand||a!==e.translateContentCompare||s!==e.highlightId||c!==e.canSwitchToPrevComment||l!==e.canSwitchToNextComment||u!==e.scrollContainer||d!==e.isCalcCommentPosition}},{key:"findReply",value:function(t){return this.props.list.find(function(e){return e.reply_id===t})}},{key:"setItemRef",value:function(e,t){null===t?this.itemRefMap.delete(e):this.itemRefMap.set(e,t)}},{key:"getReplyOffsets",value:function(e){if(this.itemRefMap.has(e)&&this.node){var t=this.itemRefMap.get(e).getItemRef();return{listToContainerOffsetTop:this.node.offsetTop,replyToListOffsetTop:t.offsetTop,replyOffsetHeight:t.offsetHeight}}return null}},{key:"startHighlightAnimation",value:function(e,t){this.itemRefMap.has(e)&&this.itemRefMap.get(e).startHighlightAnimation(t)}},{key:"renderResolve",value:function(){var e=this.props,t=e.resolvable,n=e.panelExpand,i=e.canSwitchToPrevComment,r=e.onSwitchToPrevComment,o=e.canSwitchToNextComment,a=e.onSwitchToNextComment,s=e.getToolTipContainer,c=e.source,l=e.enableFullCommentStyle;return"full_comment"===c||l?null:void 0!==i||void 0!==o?ne.a.createElement(b.a,{hidden:!n,canSwitchToPrevComment:i,canSwitchToNextComment:o,canResolve:t,onSwitchToPrevComment:r,onSwitchToNextComment:a,onResolveComment:this.handleResolve,getToolTipContainer:s}):t&&ne.a.createElement(E.Tooltip,{title:u("comment.solve_tip"),placement:"topRight"},ne.a.createElement("div",{className:"comment-list__resolve",onClick:this.handleResolve},u("comment.solve")))}},{key:"render",value:function(){var e=this.props,t=e.showResolveAction,n=e.list,i=e.onCopy,r=e.onCut,o=e.innerListStyle,a=m()("comment-list",t?"comment-list--show-on-".concat(t):"",this.props.className);return ne.a.createElement("div",{ref:this.getListRef,className:a,style:this.props.style,onCopy:i,onCut:r},this.renderResolve(),ne.a.createElement("div",{className:"comment-list-inner",style:o},this.renderList(n)))}}]),t}(ne.a.Component);I.defaultProps={busNameSpace:"comment",onRetry:h.default,onSwitchToPrevComment:h.default,onSwitchToNextComment:h.default,onResolve:h.default,onResize:h.default,expand:!0},S.a=I}).call(this,T("2vAP"))},wMxQ:function(e,t,n){"use strict";var i,r,o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),l=n("MXQz"),u=n("J4zp"),m=n.n(u),d=n("U+yc"),h=n.n(d),f=n("HmyT"),p=n("77Gt"),g=n("lQZd"),v=n("TRZa"),b=n("VI6H"),y=n("QM+C"),E=(n("Yj5g"),n("8Reb")),O=n("OvDQ"),C=n("8dyR"),k=n("lIbB"),I=n("cDf5"),S=n.n(I),T=n("4PSP"),_=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":S()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};(r=i=i||{})[r.KEEP_SHOWING=0]="KEEP_SHOWING",r[r.SHOW_TEMPORARILY=1]="SHOW_TEMPORARILY",r[r.HIDE=2]="HIDE";var w=i,j=1500,M=function(){function e(){a()(this,e),this.state=i.HIDE,this.curTimeoutId=void 0,this.newTimeoutParams=null,this.enterCallbackMap=new Map}return c()(e,[{key:"enterKeepShowing",value:function(){this.enter(i.KEEP_SHOWING)}},{key:"enterShowTemporarily",value:function(){this.delay(this.enterHide,j),this.enter(i.SHOW_TEMPORARILY)}},{key:"enterHide",value:function(){this.enter(i.HIDE)}},{key:"onEnter",value:function(e,t){return this.enterCallbackMap.set(e,t),this}},{key:"is",value:function(e){return this.state===e}},{key:"destroy",value:function(){this.clearTimer(),this.enterCallbackMap.clear()}},{key:"enter",value:function(e){var t=this.state;this.state=e,this.reinstallTimer(),t!==e&&this.enterCallbackMap.has(e)&&this.enterCallbackMap.get(e)(t,e)}},{key:"delay",value:function(e,t){this.newTimeoutParams=[e,t]}},{key:"reinstallTimer",value:function(){this.clearTimer(),this.installTimer()}},{key:"installTimer",value:function(){var e,t,n,i=this;this.newTimeoutParams&&(e=m()(this.newTimeoutParams,2),t=e[0],n=e[1],this.newTimeoutParams=null,this.curTimeoutId=window.setTimeout(function(){i.curTimeoutId=void 0,t()},n))}},{key:"clearTimer",value:function(){this.curTimeoutId&&(window.clearInterval(this.curTimeoutId),this.curTimeoutId=void 0)}}]),e}();_([Object(T.Bind)()],M.prototype,"enterHide",null);var L,R,N=n("vE74"),D=n("H6oK"),x=n("FJEn"),P=n("Poi8"),B=n("zTCG"),U="ep-cursor__name_active",z=Object(l.a)(function(){return Object(f.$)(Object(N.j)('\n    <div class="ep-cursor" style="display: none">\n      <div class="ep-cursor__caret"></div>\n      <div class="ep-cursor__dot"></div>\n      <div class="ep-cursor__name"></div>\n    </div>\n  '))[0]}),H=(L=Object(C.b)({leading:!1}),R=function(){function i(e){var t=this;a()(this,i),this._showName=function(){t._nameDom.addClass(U)},this._hideName=function(){t._nameDom.removeClass(U)},this.handleMouseEnter=function(){t.nameState.enterKeepShowing()},this.handleMouseLeave=function(){t.nameState.enterShowTemporarily()},this._context=e;var n=z().cloneNode(!0);this._root=Object(f.$)(n),this._caretDom=Object(f.$)(n.querySelector(".ep-cursor__caret")),this._dotDom=Object(f.$)(n.querySelector(".ep-cursor__dot")),this._nameDom=Object(f.$)(n.querySelector(".ep-cursor__name")),this._stopRendering=!1,this._delayDrawing=!1,this._delayLayout=!1,this.nameState=(new M).onEnter(w.KEEP_SHOWING,this._showName).onEnter(w.SHOW_TEMPORARILY,this._showName).onEnter(w.HIDE,this._hideName),this._parent=null,this.mountManager=new O.a(this)}return c()(i,[{key:"showName",value:function(){this.nameState.is(w.KEEP_SHOWING)||this.nameState.enterShowTemporarily()}},{key:"draw",value:function(e){var t,n,i;(e||this._drawInvalid)&&(this._stopRendering?this._delayDrawing=!0:(this._drawInvalid=!1,null!=this._position?(t=this._memberId,n=Object(b.l)(t)||{},i=Object(y.getColorById)(n.color_id),this._nameDom.text(Object(p.e)(n.user_id,Object(g.k)(),Object(g.g)())),new E.a(this._root.children()).css("background-color",i).show()):new E.a(this._root).hide()))}},{key:"layout",value:function(e){(e||this._layoutInvalid||this.mountManager.willMountStateChange())&&(this._stopRendering?this._delayLayout=!0:this._layout())}},{key:"suspendRendering",value:function(){this._stopRendering=!0}},{key:"resumeRendering",value:function(){var e;this._stopRendering&&(e=!0,this._stopRendering=!1,this._delayLayout&&(this._delayLayout=!1,this.layout(e)),this._delayDrawing&&(this._delayDrawing=!1,this.draw(e)))}},{key:"_layout",value:function(){var e,t,n,i,r,o,a,s,c,l,u,d,h,f,p,g;this.mountManager.mountIfNeeded()&&(this._layoutInvalid=!1,null==this._position||this._hide?new E.a(this._root).hide():(e=this._context.editorInfo,t=m()(this._position,2)[1],i=(n=m()(this._position,3))[0],r=n[2],i>(a=(o=e.getRep(r)).lines).length()||(i!==this._context.disableLineNum?(s=a.atIndex(i))?(t=Math.max(t,s.lineMarker),c=s.getLineRect(r),l=this._shouldUseCharLeftRect(r,i,t)?s.getCharRect(t,!1,r):s.getCharRect(t-1,!0,r),u=s.text.length===s.lineMarker,d=t===s.lineMarker,u?(h=e.getAttributeOnLine(r,i,"list"))&&this._fixCharRectForEmptyList(s.lineNode,l,h):d&&Object(k.e)()&&Object(k.c)(o,i,t)&&(f=Object(k.a)(e,s,t),c.left-=f),0===l.height&&Boolean(e.getAttributeOnLine(r,i,"heading"))&&(l.height=s.lineNode.getBoundingClientRect().height),p=l.top+c.top,Object(P.i)(e,r)&&(p-=(g=this._root.parent()[0])&&g.offsetTop-B.c||0),new E.a(this._caretDom).css("height",l.height),new E.a(this._root).css("top",p).css("left",l.left+c.left).show()):console.error("has no lineEntry"):new E.a(this._root).hide())))}},{key:"_shouldUseCharLeftRect",value:function(e,t,n){var i=this._context.editorInfo;if(i.getRep(e).lines.isStartOfLine(t,n))return!0;var r=i.getAttributesOnPosition(e,t,n).filter(function(e){return e[0]===D.BLOCK_DATA_META_BLOCK_PROPS}).map(function(e){return e[1]}),o=m()(r,1)[0];if(Boolean(o)){var a=JSON.parse(o);if(a&&a.props&&a.props.displayMode===D.BlockDisplayMode.INLINE)return!0}return!1}},{key:"_fixCharRectForEmptyList",value:function(e,t,n){var i,r,o=n.replace(/\d{1,}$/,"");if("bullet"===o||"number"===o){var a=e.querySelector("li");if(!a)return;var s=this._findFirstNonPocketChild(a);return s?void(t.left=s.getBoundingClientRect().left-a.getBoundingClientRect().left):void 0}if("check"===o||"done"===o){var c=e.querySelector("ul");if(!c)return;var l=c.querySelector("li");return l?void(t.left=l.getBoundingClientRect().left-c.getBoundingClientRect().left):void 0}"code"===o&&(!(i=e.querySelector("code"))||(r=i.firstElementChild)&&(t.left=r.getBoundingClientRect().left-i.getBoundingClientRect().left))}},{key:"_findFirstNonPocketChild",value:function(e){var t=e.firstElementChild;if(!t)return null;if(x.utils.isPocket(t)){var n=t.nextElementSibling;return n&&x.utils.isFakeNode(n)?n.nextElementSibling:n}return t}},{key:"setPosition",value:function(e){Object(v.c)(this._position,e)||(this._position=e,this._layoutInvalid=!0)}},{key:"getPosition",value:function(){return this._position}},{key:"setMemberId",value:function(e){this._memberId!==e&&(this._drawInvalid=!0,this._memberId=e)}},{key:"show",value:function(){this._hide=!1,new E.a(this._root).show()}},{key:"hide",value:function(){this._hide=!0,new E.a(this._root).hide()}},{key:"isRowMounted",value:function(){var e=m()(this._position,3),t=e[0],n=e[2];return-1!==t&&this._context.isRowMounted(n,t)}},{key:"shouldMount",value:function(){return this.isRowMounted()}},{key:"attach",value:function(e){this._parent!==e&&(this.mountManager.unmountIfNeeded(),this._parent=e,this.mountManager.mountIfNeeded())}},{key:"mountImpl",value:function(){var e=this;if(this._parent)return this._parent._root.append(this._root),this._root.on("mouseenter",this.handleMouseEnter).on("mouseleave",this.handleMouseLeave),function(){e._root.off("mouseenter",e.handleMouseEnter).off("mouseleave",e.handleMouseLeave),e._root.remove()}}},{key:"detach",value:function(){this.nameState.destroy(),this.mountManager.unmountIfNeeded(),this._parent=null}}]),i}(),h()(R.prototype,"_layout",[L],Object.getOwnPropertyDescriptor(R.prototype,"_layout"),R.prototype),R),F="ep-cursors",V=Object(l.a)(function(){return Object(f.$)('<div class="'.concat(F,'"></div>'))[0]}),W=function(){function t(e){a()(this,t),this._context=e,this._cursors={},this.context=e,this._root=null,this._outerContainer=null}return c()(t,[{key:"addCursor",value:function(e,t,n){var i=this._cursors[e];i||(i=new H(this._context),this._cursors[e]=i);var r=Array.prototype.slice.call(t);r.push(n),i.setPosition(r),i.setMemberId(e),this._attachCursor(i),i.layout(),i.draw(!0)}},{key:"_attachCursor",value:function(e){var t;null!==this._outerContainer&&(null===this._root&&(0<(t=this._outerContainer.find("> .".concat(F))).length?this._root=t:(this._root=Object(f.$)(V().cloneNode(!0)),this._context.className&&this._root.addClass(this._context.className),this._outerContainer.append(this._root))),e.attach(this))}},{key:"updateCursor",value:function(e,t,n){var i,r=this._cursors[e];r&&((i=Array.prototype.slice.call(t)).push(n),r.setPosition(i),r.layout())}},{key:"hideCursor",value:function(e){var t=this._cursors[e];t&&t.hide()}},{key:"showCursor",value:function(e){var t=this._cursors[e];t&&t.show()}},{key:"activeCursor",value:function(e){var t=this._cursors[e];t&&t.showName()}},{key:"hasCursor",value:function(e){return!!this._cursors[e]}},{key:"removeCursor",value:function(e){var t=this._cursors[e];t&&t.detach(),delete this._cursors[e],this.isEmpty()&&null!==this._root&&(this._root.remove(),this._root=null)}},{key:"isEmpty",value:function(){return 0===Object.keys(this._cursors).length}},{key:"attach",value:function(e){var t=this;this._outerContainer=e,Object.keys(this._cursors).forEach(function(e){return t._attachCursor(t._cursors[e])})}},{key:"layout",value:function(e){var t,n=this._cursors;for(t in n)n[t].layout(e)}},{key:"suspendRendering",value:function(){var e,t=this._cursors;for(e in t)t[e].suspendRendering()}},{key:"resumeRendering",value:function(){var e,t=this._cursors;for(e in t)t[e].resumeRendering()}},{key:"layoutFromLine",value:function(e){var t,n=this._cursors;for(t in n){var i=n[t],r=i.getPosition();r&&r[0]>=e&&i.layout(!0)}}},{key:"detach",value:function(){var t=this;Object.keys(this._cursors).forEach(function(e){return t.removeCursor(e)}),this._cursors={},this._outerContainer=null}}]),t}();t.a=W},wN88:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"d",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c});var i=n("Xngx");function r(e){if(!e)return"";var t=e.match(/\/file\/f\/([A-Za-z0-9]*)/);return t&&t[1]?t[1]:""}function o(e,t){return e?(t.coverOptions?Object(i.b):Object(i.c))(Object.assign({fileToken:e},t)):""}function a(e){if(!e)return"";var t=e.match(/\/box\/stream\/download(\/v2)?\/(all|cover)\/([A-Za-z0-9]*)/);return t&&t[t.length-1]?t[t.length-1]:""}function s(e){if(!e)return null;try{var t=decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(t)}catch(e){return console.error("decodeInfo "),null}}function c(e){if(!e)return"";try{var t=JSON.stringify(e);return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))}catch(e){return console.error("encodeInfo "),""}}},wOYm:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("lwsE"),o=n.n(i),r=n("W8MJ"),a=n.n(r);function s(i,r){return new(function(){function e(){o()(this,e),this.services=new Map}return a()(e,[{key:"getOrCreate",value:function(e){var t=r(e),n=this.services.get(t);return n||(n=i(e),this.services.set(t,n)),n}},{key:"destroy",value:function(e){var t=r(e),n=this.services.get(t);n&&n.destroy(),this.services.delete(t)}}]),e}())}},"wQU+":function(e,t,n){},wQna:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("Vfrr"),r=n("D7h9"),o=n("toa8"),a=n("Q9MD"),s=n("5gS9"),c=n("QM+C"),l=n("wOYm");function u(e){var t=e.suiteType,n=e.suiteToken;return new i.a({serviceType:t,serviceToken:n,engineType:c.NUM_SUITE_TYPE_TO_SUITE_ENGINE_TYPE[t],io:s.b.getInstance(),getRequest:function(){return o.d},getMemberId:function(){return function(){return Object(a.b)(r.default.getState())}}})}var d=Object(l.a)(u,function(e){return"".concat(e.suiteType,":").concat(e.suiteToken)})},wSsa:function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"b",function(){return h}),n.d(t,"a",function(){return f});var i=n("VkAN"),r=n.n(i),o=n("MjSh"),a=n("vOnD"),s=n("qxQb"),c=n.n(s);function l(){var e=r()(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 28px;\n  height: 28px;\n  margin-top: 2px;\n  border-radius: 3px;\n  transition: background-color 0.1s linear;\n\n  &:hover {\n    background-color: ",";\n  }\n  &:active {\n    background-color: ",";\n  }\n"]);return l=function(){return e},e}var u=86400,d=(Date.now(),"bytedance_storage.whats_new_storage_key"),h="suiteCanReady",f=a.default.span(l(),c()(o.N900,.1),c()(o.N900,.15))},wU5f:function(e,y,E){"use strict";(function(s){E.d(y,"a",function(){return c});var e=E("lSNA"),r=E.n(e),t=E("o0o1"),o=E.n(t),n=E("yXPU"),i=E.n(n),a=E("lwsE"),l=E.n(a),u=E("gvyE"),d=E("dXgG"),h=E("Z2VF"),f=E("n/R6"),p=E("Tqb2"),g=E("y2sV"),m=E("chfE"),v=E("j1lG"),b=E("OCl7"),c=function e(t){var c=this,n=t.editor;l()(this,e),this.taskMap=new Map,this.imageCodeToUuidMap=new Map,this.uploadingSet=new Set,this.waitingList=[],this.polling=!1,this.pollingTimer=null,this.addTask=function(n,i,r,o,a){return new Promise(function(e){var t={uuid:n,imageUrl:i,count:d.a,imageCode:null,fileToken:null,status:u.a.WAITING,width:r,height:o,comments:a,resolver:e,startTime:performance.now()};c.taskMap.set(n,t),c.tryGetImageThumbnail(t),c.uploadingSet.size<d.c?c.handleStartSave(t):c.waitingList.push(n)})},this.handleStartSave=function(){var t=i()(o.a.mark(function e(t){var n,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.uploadingSet.add(t.uuid),e.prev=1,e.next=4,Object(h.b)(t.imageUrl);case 4:n=e.sent,i=n.data.image_code,c.imageCodeToUuidMap.set(i,t.uuid),t.imageCode=i,c.flushPolling(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),c.handleSaveFailed(t),c.handleDeleteTask(t);case 15:case"end":return e.stop()}},e,null,[[1,11]])}));return function(e){return t.apply(this,arguments)}}(),this.clearExcessTask=function(){var e=!0,t=!1,n=void 0;try{for(var i,r=c.imageCodeToUuidMap.values()[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value,a=c.taskMap.get(o);!a||0<a.count?a&&a.count--:(c.handleSaveFailed(a),c.handleDeleteTask(a))}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}},this.poll=i()(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===c.uploadingSet.size)return c.polling=!1,e.abrupt("return");e.next=3;break;case 3:if(c.polling=!0,c.clearExcessTask(),0<(t=Array.from(c.imageCodeToUuidMap.keys())).length)return e.next=9,Object(h.a)(t);e.next=12;break;case 9:n=e.sent,n.data.forEach(function(e){var t=e.image_code,n=e.image_status,i=e.token,r=c.imageCodeToUuidMap.get(t),o=r&&c.taskMap.get(r);if(o)switch(o.status=n){case u.a.FAILED:case u.a.ERROR:c.handleDeleteTask(o),c.handleSaveFailed(o);break;case u.a.SUCCESS:o.fileToken=i,c.handleDeleteTask(o),c.handleSaveSuccess(o);break;case u.a.PROCESSING:}});case 12:c.pollingTimer=setTimeout(c.poll,d.b);case 13:case"end":return e.stop()}},e)})),this.flushPolling=function(){c.polling||c.poll()},this.handleDeleteTask=function(e){var t,n;c.taskMap.has(e.uuid)&&(c.taskMap.delete(e.uuid),c.uploadingSet.delete(e.uuid),e.imageCode&&c.imageCodeToUuidMap.delete(e.imageCode),c.uploadingSet.size<d.c&&0<c.waitingList.length&&(t=c.waitingList.shift(),(n=c.taskMap.get(t))&&(c.handleStartSave(n),c.uploadingSet.add(n.uuid),c.flushPolling())))},this.handleSaveFailed=function(e){e.resolver(!1);var t,n,i,r,o,a=Object(p.o)({uuid:e.uuid},c.editor);0!==a.length&&(t=a[0].start.zoneId,f.a.show({type:"error",closable:!0,content:s("etherpad.image_save_failed"),duration:5e3}),Object(b.a)(e,!1),i=(n=Object(p.E)(a[0],c.editor,!1,t)).retainLen,r=n.deleteLen,o=new g.E({zoneId:t}).retain(i).delete(r),c.editor.inCallStackIfNecessary("save-external-image",function(){c.editor.getContentState().apply(o,{nonundoable:!0})}))},this.handleSaveSuccess=function(){var t=i()(o.a.mark(function e(t){var n,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(t);case 2:if(i=e.sent){e.next=6;break}return c.handleSaveFailed(t),e.abrupt("return");case 6:c.replaceImageAttrib(t.uuid,(n={},r()(n,v.c,""),r()(n,v.K,i),n))?(t.resolver(!0),Object(b.a)(t,!0)):c.handleSaveFailed(t);case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.replaceImageAttrib=function(e,t){var n=Object(p.o)({uuid:e},c.editor);if(0===n.length)return!1;var i=n[0].start.zoneId,r=Object(p.E)(n[0],c.editor,!1,i),o=r.retainLen,a=r.deleteLen,s=new g.E({zoneId:i}).retain(o).retain(a,t);return c.editor.inCallStackIfNecessary("save-external-image",function(){c.editor.getContentState().apply(s,{nonundoable:!0})}),!0},this.tryGetImageThumbnail=function(){var t=i()(o.a.mark(function e(t){var n,i,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(p.R)(t.imageUrl);case 3:n=e.sent,i=n.naturalWidth,r=n.naturalHeight,c.taskMap.has(t.uuid)&&(t.height=t.height!==v.e&&t.height?t.height:r,t.width=t.width!==v.f&&t.width?t.width:i,c.replaceImageAttrib(t.uuid,Object(m.d)({uuid:t.uuid,height:t.height,width:t.width,loadingShowPreview:!0,comments:t.comments},{intermediateSrc:t.imageUrl}))),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,null,[[0,9]])}));return function(e){return t.apply(this,arguments)}}(),this.stopTask=function(e){var t=c.taskMap.get(e);t&&c.handleDeleteTask(t)},this.destroy=function(){c.pollingTimer&&clearTimeout(c.pollingTimer),c.taskMap.clear(),c.uploadingSet.clear(),c.waitingList.length=0,c.editor=null},this.editor=n}}).call(this,E("2vAP"))},whZn:function(e,t,n){"use strict";n.d(t,"a",function(){return g}),n.d(t,"b",function(){return m});var i=n("J4zp"),r=n.n(i),o=n("RIqP"),u=n.n(o),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),l=n.n(c),d=n("3Hq1"),h=n("y2sV"),f=n("elsr"),p=n("tp5K"),g=function(){function t(e){var l=this;s()(this,t),this.suiteEmbedObjManager=e,this.tokenListsOfNewLines=[],this.handleBufferChanged=function(o,e){var t,a;l.suiteEmbedObjManager&&(t=e.enteredLines,a=[],t.forEach(function(e){var t=e.lineEntry,n=e.childZoneLineEntries,i=e.lineNum,r=l.disposeLineEntry(o,t,i);a.push.apply(a,u()(r)),n.length&&n.forEach(function(e){var t=l.disposeLineEntry(o,e,i);a.push.apply(a,u()(t))})}),l.suiteEmbedObjManager.debounceSendEmbedObjsToManager(a))},this.processAddTokensFromNewLine=function(e){var n=e.hasAddTokens;e.alinesAttribs.forEach(function(e){var t;n&&(t=l.getMentionTokenFromAttribPairs(e),l.tokenListsOfNewLines.push(t))})},this.handleLinesWillReplace=function(e){var t,n,a,i;l.suiteEmbedObjManager&&(t=e.oldLineEntries,n=e.newLineEntries,t.forEach(function(e){var t=e.key,n=e.zone;l.getLineNodeIdSet(n).delete(t)}),l.tokenListsOfNewLines.length?(a=[],n.forEach(function(e,t){var n=e.key,i=e.zone,r=e.isActive,o=l.tokenListsOfNewLines[t];o&&(r?(a.push.apply(a,u()(o)),l.getLineNodeIdSet(i).add(n)):l.suiteEmbedObjManager.waitingIntoBufferMap.set(n,o))}),i=a.map(l.convertTokenToObj),l.suiteEmbedObjManager.debounceSendEmbedObjsToManager(i)):n.forEach(function(e){var t=e.key,n=e.zone;l.getLineNodeIdSet(n).add(t)}),l.tokenListsOfNewLines.length=0)},this.disposeLineEntry=function(e,t,n){var i=t.key,r=t.zone;if(!l.checkIfDirtyLine(r,i))return[];var o=l.getTokenListFromWaitingMap(i);return o?o.map(l.convertTokenToObj):r!==f.a?[]:l.getEmbedObjsFromLine(e,n,t)},this.checkIfDirtyLine=function(e,t){var n=l.getLineNodeIdSet(e);return!n.has(t)&&(n.add(t),!0)},this.getLineNodeIdSet=function(e){if(!l.suiteEmbedObjManager)return new Set;var t=l.suiteEmbedObjManager.zoneToLineNodeIdMap;return Object(d.default)(t[e])&&(t[e]=new Set),t[e]},this.getTokenListFromWaitingMap=function(e){if(l.suiteEmbedObjManager)return l.suiteEmbedObjManager.waitingIntoBufferMap.get(e)},this.getEmbedObjsFromLine=function(e,t,n){var i,r,o,a=n.zone,s=n.text,c=new Set;return e.version.includes(h.y)?(i={start:{line:t,offset:0,zoneId:a},end:{line:t,offset:s.length,zoneId:a}},r=function(e){return e.startsWith("mention-token")},e.getEntities(i,r).forEach(function(e){var t=Object.keys(e.attributes).find(r),n=Object(p.c)(t),i=l.convertTokenToObj(n);i&&c.add(i)})):(o={selStart:[t,0],selEnd:[t,s.length],selZone:a},e.getMatchedAttributePositionOnSelection(o,function(e){return/mention-token/.test(e)},{shouldMerge:!1}).forEach(function(e){var t=e.attrKey,n=Object(p.c)(t),i=l.convertTokenToObj(n);i&&c.add(i)})),u()(c)},this.convertTokenToObj=function(e){return l.suiteEmbedObjManager?l.suiteEmbedObjManager.embedObjMap[e]:null},this.getMentionTokenFromAttribPairs=function(e){var n=[];return e.forEach(function(e){var t=r()(e,1)[0];/mention-token/.test(t)&&n.push(Object(p.c)(t))}),n}}return l()(t,[{key:"destroy",value:function(){this.suiteEmbedObjManager=null,this.tokenListsOfNewLines.length=0}}]),t}();function m(s,e){var c=[],l="mention-token_".concat(e);return s.getMatchedAttributePositionOnSelection(null,function(e){return e===l}).forEach(function(e){var t,n,i=e.docPosition,r=i.selStart,o=i.selZone,a=s.getRep(o||f.a).lines.atIndex(r[0]);!a||(t=a.lineNode)&&(n=t.querySelectorAll("span.".concat(l)),c.push.apply(c,u()(n)))}),c}},"wq9/":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var s=n("Poi8"),i=n("FJEn"),r=n("JznU");n.d(t,"b",function(){return r.a});var c=i.RepManager.DEFAULT_REP_ZONE;function o(e,t){if(!t)return 1;var n=t.domToRep(e);if(!n)return 1;var i=n.selStart[2],r=i===c?n:Object(s.i)(t,i)?Object(s.e)(t,i):t.getZoneSelectionInMainZone(i);if(!r)return 1;var o=r.selStart[0],a=t.getRep(c).lines.atIndex(o);return a&&a.zoom||1}},"x/dr":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"e",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return c});var i=function(e){return e.appState.onboarding},r=function(e){return i(e).createDocGuideOn},o=function(e){return i(e).sharedDocGuideOn},a=function(e){return i(e).undoRedoGuideRequired},s=function(e){return i(e).createMenuVisible},c=function(e){return i(e).preferenceOptions}},x1ZR:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24"},t),c.a.createElement("path",{d:"M21.04 11.52a.3.3 0 010 .42l-.64.64a.3.3 0 01-.42 0l-1.55-1.55-3 3-.68 5.05a.75.75 0 01-1.27.43L9.77 15.8l-4.04 4.03a.3.3 0 01-.42 0l-.64-.64a.3.3 0 010-.42l4.04-4.03-3.72-3.72a.75.75 0 01.33-1.25l.1-.02 5.05-.67 3-3-1.55-1.56a.3.3 0 010-.42l.64-.64a.3.3 0 01.42 0l8.06 8.06zm-3.67-1.55l-2.83-2.83-3.19 3.18c-.09.1-.2.16-.33.2l-.1.01-3.8.5 6.34 6.34.51-3.79c.02-.16.1-.31.21-.43l3.19-3.18z",fill:"#646A73",fillRule:"evenodd"}))}},xD9Q:function(e,t,n){},xGgM:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("q1tI"),c=n.n(s),l=n("i8i4"),u=n.n(l),d=n("ozNJ"),h=n("VklI"),f=n("zfY2"),p=function(){function e(){r()(this,e)}return a()(e,null,[{key:"create",value:function(n){var i=document.createElement("div");document.body.appendChild(i);var e=u.a.render(c.a.createElement(d.c,Object.assign({},n,{onClose:t})),i);function t(e,t){u.a.unmountComponentAtNode(i),n.onClose&&n.onClose(e,t),Object(h.d)(),Object(f.unregisterOpendocApi)(h.a.hideHistoryModal)}function r(){t()}return Object(f.registerOpendocApi)(h.a.hideHistoryModal,t),Object(h.f)(h.a.hideHistoryModal),{modal:e,destory:r}}}]),e}()},xNNw:function(e,o,c){"use strict";(function(i){c.d(o,"a",function(){return n});var e=c("o0o1"),C=c.n(e),t=c("yXPU"),r=c.n(t),a=c("0bqa"),k=c("Z/PY"),I=c("lQZd"),s=c("n/R6"),S=c("15MJ"),n=function(e,t,p,o,g,m,v,b){var y=e.log,E=e.driveImageEnable,n=e.tasks,O=e.suffixPixel;y("doc_paste_upload_base64_start",{image_category:E?"drive":"doc"}),t.start().success(function(){var t=r()(C.a.mark(function e(t){var n,a,i,s,c,r,l,u,d,h,f;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,a=t.file,i=t.src,s=n.file_token,c=n.version,r=n.url,l=n.cdn_url,u=n.thumbnail_cdn_url,d=n.webp_thumbnail_cdn_url,h=n.decrypt_key,f=s?Object(k.i)(s,Object(I.g)()):r,!o&&g&&m){e.next=6;break}return e.next=6,new Promise(function(e){var t=new Image;t.onload=function(){g=t.width,m=t.height,e(void 0)},t.onerror=e,t.src=i});case 6:b.callWithAce(function(){b.fastIncorp();var e,t,n=Object(k.m)(g,m),i=O(g),r=O(m),o=[["gallery",JSON.stringify({items:[{attachmentId:"attachment-id-"+v,type:"image",src:encodeURIComponent(f),pluginName:S.s,uuid:v,natrualWidth:i,natrualHeight:r,decrypt_key:h||"",cdn_url:l||"",thumbnail_cdn_url:u||"",webp_thumbnail_cdn_url:d||"",height:r,width:i,scale:n,comments:[],isDragging:!1,image_type:a.type,size:a.size,currHeight:r,currWidth:i,file_token:s||"",file_version:c||""}]})],["author",b.getAuthor()]];!p||(e=Object(k.f)(b,function(e){return e.taskId===p}))&&((t=b.getCurrentCallStack())&&"base64toImage"===t.type&&(t.preventScrolling=!0),b.performDocumentReplaceRangeWithAttributes(e.selZone,e.selStart,e.selEnd," ",o))},"base64toImage",!0),y("doc_paste_upload_base64_end",{status:"success",image_category:E?"drive":"doc"});case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()).fail(function(e){var t;s.a.show({type:"error",closable:!0,content:i("etherpad.upload_failed")}),delete n[p],!p||(t=Object(k.f)(b,function(e){return e.taskId===p}))&&a.a.clearImagePreviewer(t),y("doc_paste_upload_base64_end",{status:"failed",image_category:E?"drive":"doc"})}).progress(function(e){a.a.updateProgressStyle(v,e)})}}).call(this,c("2vAP"))},xZLd:function(e,t){e.exports='<div class=" {{= clazz}}-container">\n  <span class="{{= clazz}}">{{=data}}</span>\n  <span>{{{wordInfo}}}</span>\n</div>\n'},xbZX:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),l=n("Nsbk"),u=n.n(l),d=n("7W2i"),h=n.n(d),f=n("q1tI"),p=n.n(f),g=function(e){function t(e){var n;return r()(this,t),(n=c()(this,u()(t).call(this,e))).handleHighlightChange=function(e,t){t&&e!==n.state.highlightId?n.setState({highlightId:e}):t||e!==n.state.highlightId||n.setState({highlightId:""})},n.state={highlightId:""},n}return h()(t,e),a()(t,[{key:"render",value:function(){var e=this.state.highlightId,t=this.props.children;return p.a.createElement(p.a.Fragment,null,t({highlightId:e,onHighlightChange:this.handleHighlightChange}))}}]),t}(f.Component)},xetH:function(e,t,n){"use strict";var i=n("lSNA"),s=n.n(i),r=n("UXvI"),o=n("0X7r"),c=n("D7h9"),a=n("jp/M"),l=function(e){return{type:a.actionTypes.etherpad.UPDATE_DOC_PERMISSION_USER_MAP,payload:e}},u=n("HjLD");function d(){return new o.b({onPermissionChange:function(e){var a={};e.forEach(function(e){var t,n,i,r=e.permission,o=e.userId;r&&(t=r.readable,n=r.editable,h.hasUser(o)&&(a[o]=(i={},s()(i,u.a.Readable,t),s()(i,u.a.Editable,n),i)))}),c.default.dispatch(l(a))},onError:function(e){}})}n.d(t,"a",function(){return h});var h={userMap:{},userPermissionManager:null,createUserPermissionManager:function(){this.userPermissionManager=d()},destroyUserPermissionManager:function(){this.userPermissionManager&&(this.userPermissionManager.destroy(),this.userPermissionManager=null)},recreateUserPermissionManager:function(){this.destroyUserPermissionManager(),this.createUserPermissionManager()},hasUser:function(e){return this.userMap[e]},addUser:function(e){this.userMap[e]?this.userMap[e]++:(this.userMap[e]=1,this.userPermissionManagerUpdateUserList())},removeUser:function(e){this.userMap[e]&&(this.userMap[e]--,0===this.userMap[e]&&this.userPermissionManagerUpdateUserList())},updateUserPerm:function(e){this.userPermissionManager.fetchUserPermissions(e)},userPermissionManagerUpdateUserList:Object(r.default)(function(){var t=this;this.userPermissionManager&&this.userPermissionManager.updateUserList(Object.keys(this.userMap).filter(function(e){return 0<t.userMap[e]}))},300)}},xi4d:function(e,t,S){"use strict";S.d(t,"a",function(){return se});var n=S("J4zp"),_=S.n(n),i=S("o0o1"),w=S.n(i),r=S("yXPU"),o=S.n(r),a=S("lwsE"),s=S.n(a),c=S("W8MJ"),l=S.n(c),u=S("a1gu"),d=S.n(u),h=S("Nsbk"),f=S.n(h),p=S("PJYZ"),T=S.n(p),g=S("7W2i"),m=S.n(g),v=S("CpTu"),b=S("3/My"),j=S("7EGn"),y=S("HI9p"),E=S("xpYl"),O=S("UXvI"),C=S("hbEN"),k=S("q1tI"),I=S.n(k),M=S("i8i4"),L=S.n(M),R=(S("17x9"),S("Mpt7")),N=S("HmyT"),D=S("fQzm"),x=S("2ACu"),P=S("1dfU"),B=S("m3gH"),U=S("kVAj"),z=S("HIeq"),H=S("sFgt"),F=S("IESS"),V=S("puQj"),W=S.n(V),K=S("2spZ"),Z=S("OX8E"),q=S("Trbk"),Y=S("SyrE"),J=S("vE74"),Q="DocComment",X=20,$=37,ee=38,te=39,ne=40,ie=78,re=80,oe=[].concat([ee,$,re],[ne,te,ie]),ae="doc-comment",se=40,ce=function(e){function n(e){var I;s()(this,n),(I=d()(this,f()(n).call(this,e))).handleTouchStart=function(e){var t=e.targetTouches[0];I.touchPosition.startY=t.pageY},I.handleTouchMove=function(e){var t=e.targetTouches[0].pageY,n=t-I.touchPosition.startY;I.touchPosition.startY=t;var i,r,o,a=I.state,s=a.visibleList,c=a.styles;0<I.currScrollTop||0===s.length||n<0||(!(r=(i=c.get(s[0].commentId))&&i.top)||0<r||(70-r<(o=I.newTransformY+n)||(I.newTransformY=Math.round(o),I.throttleHandleDocWheel(e),e.preventDefault())))},I.replayFollowActionHandler=function(){var t=o()(w.a.mark(function e(t){var n,i,r;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.actionType,i=t.data,"CommentToggle"===n?i.isOpen?I.handleToggleOpen():I.handleToggleClose():"CommentFollow"===n&&(r=i.commentTransformY,I.setState({transformY:r}));case 2:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),I.handleScrollBody=Object(C.default)(function(){I.currScrollTop=I.scrollBody.scrollTop},50),I.getDomRef=function(e){I.domRef=e},I.handleThirdPartLoaded=function(){var t=o()(w.a.mark(function e(t){var n,i,r,o,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.autoLocateComment){e.next=2;break}return e.abrupt("return");case 2:if(n=I.props.onGetCommentId(I.autoLocateComment),i=n.split(":"),r=_()(i,2),o=r[0],a=r[1],t.find(function(e){return e.serviceType===o&&e.serviceToken===a}))return e.next=7,I.scrollToReactionServ.afterAnimationFrame.request();e.next=9;break;case 7:I.handlePanelClick(n,"switchCommentByClick"),I.autoLocateComment=null;case 9:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),I.waitUntilPanelChanged=function(){return new Promise(function(e){I.handlePanelChangedQueue.push(function(){e()})})},I.handlePanelChanged=function(){I.handlePanelChangedQueue.forEach(function(e){return e()}),I.handlePanelChangedQueue=[]},I.isCalcCommentPositionDone=function(){I.state.isCalcCommentPosition||I.setState({isCalcCommentPosition:!0,visible:!0})},I.getHoverRef=function(e){I.hoverRef=e},I.getChildRef=function(e,t){null!==t?I.childRefs[e]=t:delete I.childRefs[e]},I.getNodeByRef=function(e){if(e){var t=e.cacheNodeResult;return t||(e.cacheNodeResult=L.a.findDOMNode(e),t=e.cacheNodeResult),t}},I.focus=function(){var t=o()(w.a.mark(function e(t){var n;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I.childRefs[t]){e.next=3;break}return e.abrupt("return");case 3:if(Object(H.e)(n))return e.next=7,n.setFocusIfNecessary();e.next=7;break;case 7:I.debounceUpdateStyles();case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),I.makeEventWithCommentId=function(e,t){var n=I.cachedEvents.get(t);if(n){var i=n.get(e);if(i)return i}else n=new Map,I.cachedEvents.set(t,n);for(var r=arguments.length,o=new Array(2<r?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];var s=E.a.apply(void 0,[e,t].concat(o));return n.set(e,s),s},I.clearCachedProps=function(){I.cachedEvents.clear()},I.handleClearActiveComment=function(){I.handleDocClick({target:document.body})},I.handlePanelResize=function(e){e?I.updateStyles():I.debounceUpdateStyles()},I.handlePanelClick=function(t,e,n){n&&n.target&&Object(J.c)(n.target,"comment-list-item__textarea--edit","comment-panel")&&(e="itemEditTextareaClick");var i=I.state.visibleList.find(function(e){return e.commentId===t}),r=I.props,o=r.onActiveChange,a=r.activeCommentId,s=I.state.transformY;a===t&&0===s||o&&o(i,e,I.childRefs[t])},I.handleItemEdit=function(e,t){I.handlePanelClick(e,t)},I.handleSwitchToPrevComment=function(){var t=o()(w.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.event,i=t.activeSource,r=I.props.activeCommentId){e.next=4;break}return e.abrupt("return");case 4:if(o=I.getActiveList(r,!0),a=Object(y.a)(o,function(e){return e.commentId===r}),s=Math.max(a-1,0),c=o[s],l=c.visible,u=c.commentId,d=c.serviceToken,h=c.serviceType,u===r)return e.abrupt("return");e.next=10;break;case 10:if(!1===l)return f=I.props.editor.plugins.comment,p=u.split(":")[2],e.next=15,f.locateComment(h,d,p);e.next=17;break;case 15:return e.next=17,I.scrollToReactionServ.afterAnimationFrame.request();case 17:I.handlePanelClick(u,i),n&&n.stopPropagation(),I.collectSwitchComment("last");case 20:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),I.handleSwitchToNextComment=function(){var t=o()(w.a.mark(function e(t){var n,i,r,o,a,s,c,l,u,d,h,f,p;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.event,i=t.activeSource,r=I.props.activeCommentId){e.next=4;break}return e.abrupt("return");case 4:if(o=I.getActiveList(r,!0),a=Object(y.a)(o,function(e){return e.commentId===r}),s=Math.min(a+1,o.length-1),c=o[s],l=c.visible,u=c.commentId,d=c.serviceToken,h=c.serviceType,u===r)return e.abrupt("return");e.next=10;break;case 10:if(!1===l)return f=I.props.editor.plugins.comment,p=u.split(":")[2],e.next=15,f.locateComment(h,d,p);e.next=17;break;case 15:return e.next=17,I.scrollToReactionServ.afterAnimationFrame.request();case 17:I.handlePanelClick(u,i),n&&n.stopPropagation(),I.collectSwitchComment("next");case 20:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),I.handleWindowResize=function(){I.debounceUpdateStyles()},I.bindMouseWheelEvent=function(e,t){var n;W.a.mac?e.addEventListener("mousewheel",t,!1):((n=document.querySelector(".etherpad-client-container"))&&n.addEventListener("mousewheel",t,!1),I.domRef&&I.domRef.addEventListener("mousewheel",t,!1)),e.addEventListener("DOMMouseScroll",t,!1)},I.unbindMouseWheelEvent=function(e,t){var n;W.a.mac?e.removeEventListener("mousewheel",t,!1):((n=document.querySelector(".etherpad-client-container"))&&n.removeEventListener("mousewheel",t,!1),I.domRef&&I.domRef.removeEventListener("mousewheel",t,!1)),e.removeEventListener("DOMMouseScroll",t,!1)},I.handleClearTransform=function(){I.setState({transformY:0}),I.newTransformY=0},I.handleDocWheel=function(e){var t,n,i,r,o;I.hasMouseWheeled=!0,0<I.currScrollTop||0!==(t=I.state.visibleList).length&&(n=-1,e.deltaY?n=.7*-e.deltaY:e.detail?n=5*-e.detail:e.wheelDelta&&(n=e.wheelDelta/1.2),n<0||(!(r=(i=I.state.styles.get(t[0].commentId))&&i.top)||0<r||(70-r<(o=I.newTransformY+n)||(I.newTransformY=Math.round(o),I.throttleHandleDocWheel(e)))))},I.emitCommentFollow=function(e){Z.a.emit(q.a,{module:Q,actionType:"CommentFollow",data:{commentTransformY:e}})},I.throttleHandleDocWheel=Object(O.default)(function(e){I.setState({transformY:I.newTransformY},function(){I.handlePanelResize()}),I.emitCommentFollow(I.newTransformY)},100),I.handleDocClick=function(e){var n,t,i,r,o,a,s,c,l=e.target;l.hasAttribute("data-keep")||l&&l.parentElement&&l.parentElement.classList.contains("comment-more-dropdown")||(n=!1,Object(v.a)(I.childRefs,function(e){var t=I.getNodeByRef(e);return t||(n=!0),t&&t.contains(l)})||n||Object(N.$)(l).closest(".block-editbar").length||(i=(t=I.props).onActiveChange,r=t.activeCommentId,o=t.list,a=I.state.transformY,r&&(l.className&&l.className.indexOf&&-1<l.className.indexOf(r)&&0<a&&I.handleClearTransform(),(s=document.querySelector(".etherpad-client-container"))&&s.contains(l)||(c=Object(v.a)(o,function(e){return e.commentId===r}),i&&i(c,"",I.childRefs[r],l)))))},I.handleShortCuts=function(e){var t=e.keyCode,n=[ee,$,re],i=[ne,te,ie];if(oe.includes(t)){var r=I.props.activeCommentId;if(r)if(!(I.props.editor.isFocus()||I.props.editor.dom.isNodeInEditor(e.target))){var o=I.childRefs[r];if(I.isEventFromInput(o,e)){if(t===re||t===ie)return;var a=I.isPanelTextareaFocus(o),s=I.isPanelTextareaEmpty(o);if(!a||!s)return}var c=function(){e.preventDefault(),e.stopPropagation()};n.includes(t)?(I.handleSwitchToPrevComment({activeSource:"switchCommentByShortCuts"}),c(),I._blurPanelTextarea(o)):i.includes(t)&&(I.handleSwitchToNextComment({activeSource:"switchCommentByShortCuts"}),c(),I._blurPanelTextarea(o))}}},I.calAbsoluteCoord=function(e){for(var t=document.body,n=e,i=0,r=0;n!==t;)i+=n.offsetLeft-n.scrollLeft,r+=n.offsetTop-n.scrollTop,n=n.parentNode;return{left:i,top:r,width:e.offsetWidth,height:e.offsetHeight}},I.getFakeMoreBtnCoord=function(){return{height:24,left:window.innerWidth-44,top:20,width:24}},I.handleResolveAnimation=function(){var i=o()(w.a.mark(function e(t,n,i){var r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(j.default)(T()(I),["childRefs",t]),o=r&&I.getNodeByRef(r),a=document.querySelector(".more-btn"),o)return s=I.calAbsoluteCoord(o),c=a&&a.offsetHeight?I.calAbsoluteCoord(a):I.getFakeMoreBtnCoord(),l=o.cloneNode(!0),(u=document.createElement("div")).classList.add("doc-comment"),u.appendChild(l),i(t),Object.assign(u.style,{left:"0",marginLeft:"0",zIndex:"100"}),Object.assign(l.style,{left:s.left+"px",top:s.top+"px",backgroundColor:"#fff"}),document.body.appendChild(u),e.next=16,Promise.all([S.e("doc_index_css"),S.e("chunk_adit"),S.e("commons--doc_index_delay--voteEmoji--votePicker"),S.e(16),S.e("commons--doc_index_delay--jira"),S.e("doc_index_delay")]).then(S.bind(null,"Neuu"));e.next=26;break;case 16:return d=e.sent,h=d.parallel,f=d.easing,p=d.chain,g=d.delay,m=d.tween,v=d.spring,b={left:c.left+c.width/2-s.left-s.width/2,top:c.top+c.height/2-s.top-s.height/2},y=function(e){l.style.transform="translate(".concat(b.left*e,"px, ").concat(b.top*e,"px) scale(").concat(1-e,")")},E=function(e){n||(a.style.transform="scale(".concat(e,")"))},O=function(){n||(a.style.transform="")},C=f.cubicBezier(0,.1,.25,1),k=f.cubicBezier(.25,.1,.25,1),e.next=26,new Promise(function(e){h(m({from:0,to:1,duration:350,ease:C}),p(g(300),m({from:1,to:1.2,ease:k,duration:50}),v({from:1.2,to:1,stiffness:500,damping:20.37,duration:50}))).start({update:function(e){var t=_()(e,2),n=t[0],i=t[1];n&&y(n),i&&a&&E(i)},complete:function(){a&&O(),u&&u.parentNode&&u.parentNode.removeChild(u),e()}})});case 26:case"end":return e.stop()}},e)}));return function(e,t,n){return i.apply(this,arguments)}}(),I.getDynamicStyles=function(){var e=I.state.visibleList;if(!(e.length<=0)){var o=I.getNewTops(),a=I.state.styles,s=!1,c={};return e.forEach(function(e){var t=e.commentId,n=a.get(t),i=o[t],r=I.getCommentHeight(t);n&&n.top===i&&n.commentHeight===r?c[t]=n:(s=!0,c[t]={top:i,commentHeight:r})}),s?c:null}},I.getCommentHeight=function(e){return I.getNodeByRef(I.childRefs[e]).offsetHeight},I.handleBeforePrint=function(){var t=o()(w.a.mark(function e(t){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.updateStyles(!0),e.next=3,I.waitUntilPanelChanged();case 3:t&&t();case 4:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),I.debounceUpdateStyles=Object(C.default)(function(){I.updateStyles()},50),I.setStyles=function(){var r=new Map;I.positionList.forEach(function(e){var t=e.commentId,n=e.top,i=e.height;r.set(t,{top:n,height:i})}),0<r.size?I.setState({styles:r,visible:!0},function(){I.handlePanelChanged(),I.isCalcCommentPositionDone()}):(I.handlePanelChanged(),I.isCalcCommentPositionDone())},I.getStyles=function(){return I.state.styles},I.collectCommentPosition=function(o){var e,t=I.props,n=t.shown,a=t.commentToggleEnabled,s=[],i=Object(z.b)(),c=B.a.isInFullscreen();Object.keys(o).forEach(function(e){var t=o[e],n=t.top,i=t.commentHeight,r={commentId:e,top:n-(a&&!c?se:0),height:i,transformY:I.state.transformY};s.push(r)}),I.positionList=s,I.dirty=i,a?(e=n?[{commentId:"xxxxx",top:0,height:Number.MAX_SAFE_INTEGER,transformY:0}]:[],U.a.halfFullStartToChange(i,e)):U.a.halfFullStartToChange(i,s)},I.handleHalfFullIsAllChanged=Object(C.default)(function(e){var t=I.ableToChange;I.ableToChange=e,I.dirty&&I.ableToChange&&t!==I.ableToChange&&I.dirty===I.ableToChange&&I.setStyles()},20),I.getNewTops=function(){for(var t=I.state.referCommentId,e={},n={},i=I.getActiveList(t),r=Object(y.a)(i,function(e){return e.commentId===t}),o=i[r],a=o.top,s=e[o.commentId]=a,c=r-1;0<=c;c--){var l=i[c],u=l.commentId,d=l.top,h=I.getCommentHeight(u),f=I.getSafeUp(h,s,d);e[u]=f,n[u]=h,s=f}var p=a,g=I.getCommentHeight(t);n[t]=g;for(var m=r+1;m<i.length;m++){var v=i[m],u=v.commentId,d=v.top,b=I.getSafeDown(g,p,d),p=e[u]=b,g=I.getCommentHeight(u);n[u]=g}return I.checkTops(i,e,n,t),e},I.checkTops=function(e,a,s,c){var l,u,t,n=!1,n=e.find(function(e,t){var n=e.commentId,i=e.top;n===c&&(l=i);var r=a[n],o=0===t;if(isNaN(r)||!o&&r-u<=0)return!0;u=r+s[n]});c&&50<=Math.abs(a[c]-l)&&(n=!0),n&&(t=e.map(function(e){var t=e.commentId,n=e.top,i=e.selStart,r=e.selEnd,o=e.selZone;return{commentId:Object(P.a)(t),top:n,height:s[t],displayTop:a[t],selStart:i,selEnd:r,selZone:o}}),D.b.error({key:"dev_comment_tops_error",logInfo:t,activeCommentId:c&&Object(P.a)(c)}))},I.getSafeUp=function(e,t,n){var i=t-X-e;return i<n?i:n},I.getSafeDown=function(e,t,n){var i=t+e+X;return n<i?i:n},I.emitFollowCommentToggle=function(e){Z.a.emit(q.a,{module:Q,actionType:"CommentToggle",data:{isOpen:e}})},I.handleToggleClose=o()(w.a.mark(function e(){var t,n,i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=I.props,n=t.toggleCommentShown,i=t.toggleCommentStateShown,n(!1),I.emitFollowCommentToggle(!1),e.next=5,Object(K.c)(0);case 5:I.hackTriggerEditorResize(),i(!1),I.debounceUpdateStyles();case 8:case"end":return e.stop()}},e)})),I.hackTriggerEditorResize=function(){var e=I.props.editor,t={prev:{height:100,width:200},next:{height:300,width:400}};(e.enableUnmountNode?e.preRenderer.viewportStabilizer:e.blockRender).handleResize(t)},I.handleToggleOpen=o()(w.a.mark(function e(){var t,n,i,r,o;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=I.props,n=t.toggleCommentShown,i=t.shown,r=t.list,o=t.toggleCommentStateShown,i)return e.abrupt("return",Promise.resolve());e.next=3;break;case 3:if(I.emitFollowCommentToggle(!0),0===r.length&&!1===i)return n(!0),o(!0),e.next=9,Object(K.c)(0);e.next=11;break;case 9:return I.collectCommentPosition({}),e.abrupt("return");case 11:return n(!0),setTimeout(function(){Z.a.trigger("CommentImageScroll",[{target:I.scrollBody}])},300),e.next=15,Object(K.c)(0);case 15:I.hackTriggerEditorResize(),o(!0),I.debounceUpdateStyles();case 18:case"end":return e.stop()}},e)}));var t=I.getVisibleList(e.list);return I.state={styles:new Map,visible:1===e.list.length,isCalcCommentPosition:!1,transformY:0,visibleList:t,referCommentId:I.getReferCommentId(null,e.activeCommentId,t)},I.scrollBody=I.props.editor.getScrollContainer(),I.childRefs={},I.cachedEvents=new Map,I.handlePanelChangedQueue=[],I.scrollToReactionServ=new F.a(T()(I)),I.dirty="",I.ableToChange="",I.positionList=[],I.currScrollTop=0,I.newTransformY=0,I.hasMouseWheeled=!1,I.autoLocateComment=null,I.touchPosition={},I}function t(e,t){return i.apply(this,arguments)}var i;return m()(n,e),l()(n,[{key:"componentDidMount",value:function(){this.debounceUpdateStyles(),this.updateLoadingStatus(),Y.g.on("".concat(q.g,":").concat(Q),this.replayFollowActionHandler),Y.g.on("AnimateContainer.beforePrint",this.handleBeforePrint),document.addEventListener("click",this.handleDocClick),document.addEventListener("keydown",this.handleShortCuts),window.addEventListener("resize",this.handleWindowResize),this.scrollBody&&this.scrollBody.addEventListener("scroll",this.handleScrollBody),this.bindMouseWheelEvent(document.body,this.handleDocWheel),document.body.addEventListener("touchstart",this.handleTouchStart,!1),document.body.addEventListener("touchmove",this.handleTouchMove,{passive:!1}),this.props.editor.on("clearActiveComment",this.handleClearActiveComment),U.a.onhalfFullIsAllChanged(this.handleHalfFullIsAllChanged);var e=this.props,t=e.list,n=e.shown,i=e.commentToggleEnabled,r=e.onCommentVisible;n&&i&&0<t.length&&this.debounceUpdateStyles(),this.state.visible&&r&&r(),this.props.editor.on("thirdPartyLoaded",this.handleThirdPartLoaded)}},{key:"componentDidUpdate",value:function(e,t){this.updateLoadingStatus();var n=this.props,i=n.activeCommentId,r=n.activeTop,o=n.onCommentVisible,a=this.state,s=a.visible,c=a.visibleList,l=i!==e.activeCommentId||r!==e.activeTop,u=!Object(R.List)(c).equals(Object(R.List)(t.visibleList)),d=t.visible!==s;(l||u)&&this.debounceUpdateStyles(),d&&o&&o()}},{key:"componentWillUnmount",value:function(){var e=Object(z.b)();this.childRefs={},this.scrollToReactionServ.destroy(),Y.g.off("".concat(q.g,":").concat(Q),this.replayFollowActionHandler),Y.g.off("AnimateContainer.beforePrint",this.handleBeforePrint),document.removeEventListener("click",this.handleDocClick),document.removeEventListener("keydown",this.handleShortCuts),window.removeEventListener("resize",this.handleWindowResize),this.scrollBody&&this.scrollBody.removeEventListener("scroll",this.handleScrollBody),this.unbindMouseWheelEvent(document.body,this.handleDocWheel),document.body.removeEventListener("touchstart",this.handleTouchStart),document.body.removeEventListener("touchmove",this.handleTouchMove),U.a.offhalfFullIsAllChanged(this.handleHalfFullIsAllChanged),this.props.editor.off("clearActiveComment",this.handleClearActiveComment),U.a.halfFullStartToChange(e,[]),this.debounceUpdateStyles.cancel(),this.debounceUpdateStyles=null,this.handleScrollBody.cancel(),this.handleScrollBody=null,this.clearCachedProps(),this.scrollBody=null,this.throttleHandleDocWheel.cancel(),this.throttleHandleDocWheel=null,this.props.editor.off("thirdPartyLoaded",this.handleThirdPartLoaded)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.activeCommentId,n=e.list,i=this.getVisibleList(n);this.setState({visibleList:i,referCommentId:this.getReferCommentId(this.state.referCommentId,t,i)})}},{key:"getCommentMessageMap",value:function(){return this.props.commentMessageMap}},{key:"updateLoadingStatus",value:function(){this.scrollToReactionServ.isAllNecessaryDataLoaded$.next(this.props.isCommentsDataLoaded)}},{key:"scrollToCommentMessageReply",value:(i=o()(w.a.mark(function e(t,n){var i,r,o,a,s,c,l,u,d,h,f,p,g,m,v,b,y,E,O,C,k,I,S,T;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.commentId,r=t.replyId,o=this.props.commentData[i]){e.next=4;break}return e.abrupt("return");case 4:if(a=this.props.onGetCommentId(o),s=a.split(":"),c=_()(s,2),l=c[0],u=c[1],"BITABLE_BLOCK"!==l||this.props.list.find(function(e){return e.commentId===a})){e.next=13;break}if(d=this.props.editor.getMatchedAttributePositionOnSelection(null,function(e,t){return"dataMetaBlockProps"===e&&JSON.parse(t).token===u}),h=_()(d,1),f=h[0]){e.next=10;break}return e.abrupt("return");case 10:return this.props.editor.scrollToSelection(f.docPosition),this.autoLocateComment=o,e.abrupt("return");case 13:return e.next=15,this.scrollToReactionServ.afterAnimationFrame.request();case 15:return e.next=17,this.props.editor.plugins.comment.locateComment(l,u,i);case 17:if(e.sent){e.next=20;break}return e.abrupt("return");case 20:return e.next=22,this.scrollToReactionServ.afterAnimationFrame.request();case 22:if(p=Object(j.default)(this,["childRefs",a])){e.next=25;break}return e.abrupt("return");case 25:return this.handlePanelClick(a,"reaction_click"),e.next=28,this.scrollToReactionServ.afterAnimationFrame.request();case 28:if(g=p.getReplyOffsets(r)){e.next=31;break}return e.abrupt("return");case 31:if(m=p&&this.getNodeByRef(p)){e.next=34;break}return e.abrupt("return");case 34:if(v=this.scrollBody,b=v.offsetHeight,y=(b-g.replyOffsetHeight)/2,E=m.offsetTop,v.scrollTop=E,O=p.getReplyOffsets(r)){e.next=42;break}return e.abrupt("return");case 42:return C=E-v.scrollTop,k=O.replyToListOffsetTop+O.listToContainerOffsetTop,I=C+k,S=Math.max(0,y),T=I-S,v.scrollTop+=T,e.next=50,this.scrollToReactionServ.afterAnimationFrame.request();case 50:p.startHighlightAnimation(r,"lark-feed-comment-item-highlight-animation");case 51:case"end":return e.stop()}},e,this)})),t)},{key:"collectSwitchComment",value:function(e){Object(x.collectSuiteEvent)("bubble_comment_page_slide",{bubble_comment_page_slide_source:B.a.isInFullscreen()?"play_mode_comment":"",bubble_comment_page_slide_type:e,comment_type:"part_comment"})}},{key:"isEventFromInput",value:function(e,t){if(e){var n=this.getNodeByRef(e);return n&&n.contains(t.target)&&t.target.isContentEditable}return!1}},{key:"isPanelTextareaEmpty",value:function(e){var t=e&&e.getCurTextareaRef();return!!t&&t.isEmpty()}},{key:"isPanelTextareaFocus",value:function(e){var t=e&&e.getCurTextareaRef();return!!t&&t.isFocus()}},{key:"_blurPanelTextarea",value:function(e){var t=e&&e.getCurTextareaRef();if(t)return t.blur()}},{key:"updateStyles",value:function(e){var t=this.props,n=t.shown,i=t.commentToggleEnabled,r={};!e&&i&&!n||(r=this.getDynamicStyles()),r?this.collectCommentPosition(r):i&&this.collectCommentPosition({})}},{key:"insertIntoSorted",value:function(e,t){var n=Object(b.a)(e,t,"top");return e.splice(n,0,t),e}},{key:"getVisibleList",value:function(e){return e.filter(function(e){return e.visible})}},{key:"getReferCommentId",value:function(e,t,n){var i=t||e;return n.find(function(e){return e.commentId===i})&&(this.hasMouseWheeled||t)?(this.hasMouseWheeled=!0,i):n[0]&&n[0].commentId||null}},{key:"getActiveList",value:function(t,e){var n=this.props,i=n.activeTop,r=n.list,o=this.state.visibleList,a=e?r:o;if(null===i)return a;var s=a.find(function(e){return e.commentId===t});if(!s||s.top===i)return a;var c=Object.assign({},s,{top:i}),l=a.filter(function(e){return e.commentId!==t});return this.insertIntoSorted(l,c)}},{key:"render",value:function(){var d=this,e=this.props,t=e.commentToggleEnabled,h=e.children,n=e.className,f=e.list,i=e.opendocSidebarStyle;if(0===f.length&&t)return null;var p=this.handlePanelClick,g=this.handleItemEdit,m=this.handleSwitchToPrevComment,v=this.handleSwitchToNextComment,b=this.handlePanelResize,y=this.getChildRef,r=this.state,E=r.styles,o=r.transformY,a=f[f.length-1].commentId,s=E.get(a),c=0;s&&s.top&&s.height&&(c=s.top+s.height+o+100);var l=f.reduce(function(e,t,n){var i,r,o,a=t.commentId,s=t.top,c=t.isSubmitted,l=t.visible,u=t.serviceType;return l&&(i=h[n],o=(r=E.get(a))?{top:r.top,opacity:r&&void 0!==r.top?1:0}:{top:s,left:0,opacity:c||void 0!==s?1:0},e.push(Object(k.cloneElement)(i,{style:o,ref:d.makeEventWithCommentId(y,a),onPanelResize:b,onPanelClick:d.makeEventWithCommentId(p,a,"clickOnPanel"),onItemEdit:d.makeEventWithCommentId(g,a,"itemEdit"),canSwitchToPrevComment:0!==n,canSwitchToNextComment:n!==f.length-1,onSwitchToPrevComment:m,onSwitchToNextComment:v,commentImageEnabled:"BITABLE_BLOCK"!==u,isCalcCommentPosition:d.state.isCalcCommentPosition}))),e},[]),u={opacity:this.state.visible?1:0,transform:"translate3d(0, ".concat(o,"px, 0)")};return t?I.a.createElement("div",{className:"".concat(ae,"_background"),style:Object.assign({minHeight:"".concat(c,"px")},i)},I.a.createElement("div",{className:n,style:u,ref:this.getDomRef},l)):I.a.createElement("div",{className:n,style:u,ref:this.getDomRef},l)}}]),n}(k.Component);ce.defaultProps={activeCommentId:""},t.b=ce},y7Jg:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),p=n("3Hq1"),d=n("YWBl"),g=n("aBgF"),h=n("7Kxq"),s=n("D7h9"),c=n("Kn+I"),l=n("Poi8"),u=function(){function f(e){var t=this;r()(this,f),this.className="AutoCapitalization",this.autoUppercase=!0,this.isDoReturnKey=!1,this.enabled=!0,this.editor=e,this.unsubscribe=s.default.subscribe(function(){var e=Object(c.c)(s.default.getState()).get("enable_auto_capitalize");t.enabled=1===e})}return a()(f,[{key:"destroy",value:function(){this.unsubscribe()}},{key:"doReturnKey",value:function(){this.isDoReturnKey=!0}},{key:"editorKeyDown",value:function(e,t){this.handleEditorKeyDown(t),this.isDoReturnKey=!1}},{key:"handleEditorKeyDown",value:function(e){var t,n,i,r,o,a,s,c,l,u,d,h=this;this.enabled&&(t=e.evt,Object(p.default)(t.keyCode)||(n=t.keyCode===g.c.Enter&&this.isDoReturnKey,(i=t.keyCode===g.c.Space||n)&&this.editor.callStack.inCallStackIfNecessary("fastIncorp",function(){h.editor.fastIncorp()}),(o=(r=e.rep).selStart)&&(n||this.editor.isCaret())&&(a=o[0],n&&a--,(s=r.lines.atIndex(a))&&(n&&(o=[a,s.text.length]),this.isUppercaseLine(r,o)&&(c=s.text.substring(s.lineMarker,s.text.length),l=t.metaKey||t.ctrlKey,c?this.autoUppercase&&i?(u=o[1]-s.lineMarker,this.isUppercasePosition(c,u)&&(d=this.findSentencePosition(c,u),this.shouldUppercase(d,r,a,o[1])&&(this.editor.getInInternationalComposition()||(t.preventDefault(),this.performUppercase(t.keyCode,r,o,a,c,d.sentenceIndex))))):t.keyCode===g.c.Ime||t.keyCode===g.c.Z&&l||t.keyCode===g.c.V&&l||(-1<f.CURSOR_KEY_CODE.indexOf(t.keyCode)||l?this.autoUppercase=!1:this.autoUppercase=!0):l||(this.autoUppercase=!0))))))}},{key:"aceClickEvent",value:function(){this.autoUppercase=!1}},{key:"aceAfterCompositionEnd",value:function(){this.autoUppercase=!0}},{key:"UNSAFE_editorNormalizePasteNode",value:function(){this.autoUppercase=!1}},{key:"acePaste",value:function(){this.autoUppercase=!1}},{key:"performUndoRedo",value:function(){this.autoUppercase=!1}},{key:"isUppercaseLine",value:function(e,t){var n=e.attributeManager.getAttributesOnSelection(t,t,e),i=n.attribs.some(function(e){return"lang"===e[0]||"list"===e[0]&&"code1"===e[1]}),r=n.attribs.some(function(e){return"inline-code"===e[0]&&"true"===e[1]});return!(Object(l.i)(this.editor,e.zoneId)||i||r)}},{key:"findSentencePosition",value:function(e,t){for(var n,i=f.SENTENCE_END_REG,r=e.length,o=[],a=0,s=-1,c=-1,l=i.exec(e);l;)o.push({sentence:e.substring(a,l.index),index:l.index+l[0].length}),a=l.index+l[0].length,s++,-1===c&&t<=a&&(c=s),l=i.exec(e);a<r&&(-1===c&&(c=s+1),n="",n=-1<f.END_PUNCTUATION.indexOf(e.substr(r-1,1))?e.substring(a,r-1):e.substring(a,r),o.push({sentence:n,index:r}));var u=0===c?0:o[c-1].index;return{sentence:o[c].sentence,position:t-u,sentenceIndex:u}}},{key:"isUppercasePosition",value:function(e,t){if(0<t&&t<e.length){var n=e[t-1]+e[t],i=f.SENTENCE_END_REG;if(!f.SENTENCE_SPECIAL_REG.test(n)&&("  "===n||i.test(n)))return!1}var r=this.findSentencePosition(e,t),o=r.sentence,a=r.position;return!(-1<o.substring(0,a).indexOf(" "))}},{key:"shouldUppercase",value:function(e,n,i,r){var t=e.sentence,o=e.position,a=function(){var e=[i,r-o],t=[i,r];return n.attributeManager.getAttributesOnSelection(e,t,n,!1).attribs},s=function(){return a().some(function(e){return"inline-code"===e[0]&&"true"===e[1]||e[0].startsWith("mention-token_")&&"true"===e[1]||e[0].startsWith("url-")&&void 0!==e[1]})},c=/^[a-z][a-z'-]*$/,l=new RegExp("^[a-z][a-z'-]*[".concat(f.SPECIAL_PUNCTUATION.map(function(e){return"\\"+e}).join(""),"]$"),"g"),u=t.substring(0,o);return c.test(u)?!(o>t.length&&o!==t.length+1)&&!s():!!l.test(u)&&!s()}},{key:"performUppercase",value:function(e,t,n,i,r,o){var a,s,c,l=this,u=t.lines.atIndex(i);u&&(a=o+u.lineMarker,s=[i,a],c=[i,a+1],e===g.c.Enter&&this.isDoReturnKey||this.editor.makeNewEvent("performSpace",function(){l.editor.fastIncorp();var e=t.attributeManager.getAttributesOnSelection(n,n,t,!1);l.editor.performDocumentReplaceRangeWithAttributes(t.zoneId,n,n," ",e.attribs)}),this.editor.makeNewEvent("autoUppercase",function(){l.editor.fastIncorp();var e=t.attributeManager.getAttributesOnSelection(s,c,t,!1);l.editor.performDocumentReplaceRangeWithAttributes(t.zoneId,s,c,r.substr(o,1).toUpperCase(),e.attribs)}),Object(d.a)({action:"autoCapitalization",op:h.f,source:"autoCapitalization"}))}}]),f}();u.END_PUNCTUATION=["",".","","?","","!"],u.SPECIAL_PUNCTUATION=[",",".","?",":",";","'","!"],u.SENTENCE_END_REG=new RegExp("[".concat(u.END_PUNCTUATION.map(function(e){return"\\"+e}).join(""),"]\\s+"),"g"),u.SENTENCE_SPECIAL_REG=new RegExp("[".concat(u.SPECIAL_PUNCTUATION.map(function(e){return"\\"+e}).join(""),"]\\s+"),"g"),u.CURSOR_KEY_CODE=[g.c.Up,g.c.Down,g.c.Left,g.c.Right,g.c.PageUp,g.c.PageDown,g.c.Home,g.c.End]},"y9S/":function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),l=n("fujP"),u=n("q1tI"),d=n.n(u),h=n("i8i4"),f=n.n(h),p=n("H6oK"),g=n("CnBM"),m=n.n(g),v=n("Pagd"),b=n("ZLFf"),y=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(a=(o<3?r(a):3<o?r(t,n,a):r(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},E=m()({loader:function(){return n.e(55).then(n.bind(null,"uwVk"))},render:function(e,t){var n=e.default;return d.a.createElement(n,Object.assign({},t,{ref:t.getViewRef}))},loading:function(){return null}}),O=function(){function n(){r()(this,n),this.bitableViewPropsMap=Object.create(null),this.jiraFilterRefMap=Object.create(null),this.fullScreenBlockToken="",this.fullScreenWrapper=null}return a()(n,[{key:"destroy",value:function(e){var t;n.instance&&((t=this.jiraFilterRefMap[e])&&f.a.unmountComponentAtNode(t),delete this.bitableViewPropsMap[e],delete this.jiraFilterRefMap[e],this.fullScreenBlockToken===e&&this.exitFullScreen(e)),Object(l.default)(this.bitableViewPropsMap)&&Object(l.default)(this.jiraFilterRefMap)&&(n.instance=void 0)}},{key:"createView",value:function(e,t){var n=t.blockToken;n&&(this.jiraFilterRefMap[n]=e,this.bitableViewPropsMap[n]=t,this.renderNormal(n))}},{key:"updateView",value:function(e,t){var n=t.blockToken;n&&(this.jiraFilterRefMap[n]&&this.jiraFilterRefMap[n]===e||(this.jiraFilterRefMap[n]=e),this.bitableViewPropsMap[n]=t,this.renderNormal(n),n===this.fullScreenBlockToken&&this.renderFullScreen(n))}},{key:"enterFullScreen",value:function(e){var t=b.a.createForFullScreen(!1);t.classList.add("jira-filter-block-fullscreen-wrapper","bitable-doc-fullscreen-wrapper"),this.fullScreenWrapper=t,this.fullScreenBlockToken=e,this.renderFullScreen(e),this.sendEnterFullScreenEvent(e)}},{key:"exitFullScreen",value:function(e){var t=this.fullScreenWrapper;t&&(this.sendExitFullScreenEvent(e),f.a.unmountComponentAtNode(t),b.a.remove(),this.fullScreenWrapper=null,this.fullScreenBlockToken="")}},{key:"sendEnterFullScreenEvent",value:function(e){var t=this.bitableViewPropsMap[e].ExternalServices.EventEmitter;t&&t.emit(v.a,e)}},{key:"sendExitFullScreenEvent",value:function(e){var t=this.bitableViewPropsMap[e].ExternalServices.EventEmitter;t&&t.emit(v.b,e)}},{key:"renderNormal",value:function(e){var t=this.jiraFilterRefMap[e];t&&f.a.render(this.renderView(e,!1),t)}},{key:"renderFullScreen",value:function(e){f.a.render(this.renderView(e,!0),this.fullScreenWrapper)}},{key:"renderView",value:function(e,t){var n=this;return d.a.createElement(E,Object.assign({},this.bitableViewPropsMap[e],{isFullScreenMode:t,shell:{onFullScreenMode:function(){return n.enterFullScreen(e)},exitFullScreen:function(){return n.exitFullScreen(e)}}}))}}],[{key:"getInstance",value:function(){return void 0===n.instance&&(n.instance=new n),n.instance}}]),n}();y([Object(p.Bind)()],O.prototype,"destroy",null),y([Object(p.Bind)()],O.prototype,"createView",null),y([Object(p.Bind)()],O.prototype,"updateView",null),y([Object(p.Bind)()],O.prototype,"enterFullScreen",null),y([Object(p.Bind)()],O.prototype,"exitFullScreen",null);t.a=O},y9eh:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("2ACu"),c=n("GVmr"),l=n("cGQV"),u=function(){function t(e){var i=this;r()(this,t),this.editor=e,this.hasSent=!1,this.onFiberRecord=function(e){var t=e.duration,n=e.fiberCost;i.hasSent||(i.hasSent=!0,Object(s.collectSuiteEvent)("dev_performance_render_cost",Object.assign({auto_render_duration:Object(l.a)(t)?t:-1,fiber_cost:Object(l.a)(n)?n:-1},Object(c.a)(i.editor))))},this.initEvents()}return a()(t,[{key:"initEvents",value:function(){this.editor.on("onFiberRecord",this.onFiberRecord)}},{key:"unbindEvents",value:function(){this.editor.off("onFiberRecord",this.onFiberRecord)}},{key:"destroy",value:function(){this.unbindEvents()}}]),t}()},yEIg:function(e,t,n){"use strict";var i,r;n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a}),(r=i=i||{}).IMAGE="image",r.FULL_IMAGE="full_image",r.SHEET="sheet",r.TABLE="table",r.CODE="code",r.CODE_BLOCK_V2="code-block-v2",r.CALLOUT_BLOCK="callout-block",r.INLINE_CODE="inline-code",r.HEADLINE="headline",r.BLOCK="block",r.INLINE_BLOCK="inline_block",r.UNSUPPORT_FEATURE="unsupport_feature",r.LINEMANAGER_WITH_SPECIAL_SELECTION="lineManagerWithSpecialSelection",r.HEADING="heading",r.FILE_CARD="file_card",r.MENTION_CHAT="mention_chat",r.ACE_TABLE="ace_table",r.LIST="list",r.ORDER_LIST="order_list",r.TEXT_INDENT="text_indent",r.BITABLE="bitable",r.JIRA_FILTER="jiraFilter",r.HORIZONTAL_LINE="horizontal-line",r.BLOCK_QUOTE="blockquote",r.ALIGN_LEFT="align_left",r.ALIGN_CENTER="align_center",r.ALIGN_RIGHT="align_right",r.BLOCKQUOTE="blockquote",r.CHECK_LIST="check_list",r.GALLERY="gallery";var o=[i.IMAGE,i.SHEET,i.BLOCK,i.FILE_CARD,i.MENTION_CHAT,i.ACE_TABLE,i.BITABLE,i.HORIZONTAL_LINE],a=["align","heading","aceTable","list","blockquote","lmkr","origin-start","insertorder","text-indent","start","origin-start","lang"]},yFNk:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return u});var i=n("J4zp"),p=n.n(i),r=n("lSNA"),o=n.n(r),g=n("H6oK"),m=n("FJEn"),v=n("yEIg"),b=n("xWuZ"),y=n("SebV"),E=n("+4eN"),O=n("kESg"),C=n("bTJL"),k=n("aim4"),I=n("xYHj"),a=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e;return o()({},e,function(e){return e.attribMap[t]})};function s(e){return["gallery","horizontal-line","table","block","sheet","codeblockV2"].includes(e)}var c=Object.assign({codeblock:function(e){var t=e.attribMap.list;return t&&t.startsWith("code")},codeblockV2:function(e){return e.attribMap[O.k.ZoneType]===O.l.CodeBlock},calloutBlock:function(e){return e.attribMap[O.k.ZoneType]===O.l.CalloutBlock}},a("horizontal-line"),{},a("blockquote"),{},a("heading"),{},a("gallery"),{},a("table","aceTable"),{orderlist:function(e){var t=e.attribMap.list;return t&&t.startsWith("number")},unorderlist:function(e){var t=e.attribMap.list;return t&&t.startsWith("bullet")},checkbox:function(e){var t=e.attribMap.list;return t&&(t.startsWith("check")||t.startsWith("done"))},indent:function(e){var t=e.attribMap.list;return t&&t.startsWith("indent")}},a("text-indent"),{sheet:function(e){var t=e.lineNode;return Object(g.isBlockTypeNode)(g.BlockType.SHEET_BLOCK,t)},bitable:function(e){var t=e.lineNode;return Object(g.isBlockTypeNode)(g.BlockType.BITABLE_BLOCK,t)},jiraFilter:function(e){var t=e.lineNode;return Object(g.isBlockTypeNode)(g.BlockType.JIRA_FILTER_BLOCK,t)},block:function(e){var t=e.attribMap[g.BLOCK_DATA_META_BLOCK_PROPS];if(!t)return!1;var n=Object(g.parseJsonSafely)(t);return!!n&&!Object(g.isInlineBlock)(n)}});function l(e){var t=e.lineNode,n=e.attribs,i=n.reduce(function(e,t){var n=p()(t,2),i=n[0],r=n[1];return e[i]=r,e},{}),r=Object.getOwnPropertyNames(c).find(function(e){return c[e]({lineNode:t,attribs:n,attribMap:i})});return r||"normal"}function u(e,t,n){var i,r=[],o=e.repManager.getRep(t),a=o.attributeManager.getAllAttributesOnLine(n),s=Object(b.a)(a)||[],c=e.managers.getLineManagerWithSpecialSelection();t!==m.DEFAULT_REP_ZONE&&((i=Object(E.n)(e,t))===O.l.CodeBlock?r.push(v.c.CODE_BLOCK_V2):i===O.l.CalloutBlock?r.push(v.c.CALLOUT_BLOCK):r.push(v.c.TABLE)),Object(C.a)(o,n)?r.push(v.c.CODE_BLOCK_V2):Object(I.e)(o,n)&&r.push(v.c.CALLOUT_BLOCK),c&&r.push(v.c.LINEMANAGER_WITH_SPECIAL_SELECTION),(s.includes("image-uploaded")||s.includes("gallery"))&&r.push(v.c.IMAGE);var l,u=a.filter(function(e){return"align"===p()(e,1)[0]});if(u.length?(l=u[0][1],r.push({left:v.c.ALIGN_LEFT,right:v.c.ALIGN_RIGHT,center:v.c.ALIGN_CENTER,full:v.c.FULL_IMAGE}[l])):r.push(v.c.ALIGN_LEFT),s.includes("sheet-id")&&r.push(v.c.SHEET),s.includes("blockquote")&&r.push(v.c.BLOCK_QUOTE),s.includes("code1")&&r.push(v.c.CODE),0===n&&t===m.DEFAULT_REP_ZONE&&r.push(v.c.HEADLINE),s.includes("drive-fileId")&&r.push(v.c.FILE_CARD),s.includes("list")&&(r.push(v.c.LIST),s.some(function(e){return e.includes("number")})&&r.push(v.c.ORDER_LIST)),s.includes("text-indent")&&r.push(v.c.TEXT_INDENT),s.includes("aceTable")&&r.push(v.c.ACE_TABLE),s.includes(v.c.HORIZONTAL_LINE)&&r.push(v.c.HORIZONTAL_LINE),s.some(function(e){return e.includes('"engineType":"bitable"')})&&r.push(v.c.BITABLE),s.some(function(e){return e.includes('"blockType":"JIRA_FILTER_BLOCK"')})&&r.push(v.c.JIRA_FILTER),s.includes(v.c.BLOCKQUOTE)&&r.push(v.c.BLOCKQUOTE),s.includes(v.c.INLINE_CODE)&&r.push(v.c.INLINE_CODE),a.some(function(e){var t=p()(e,2),n=t[0],i=t[1];return"list"===n&&"string"==typeof i&&(i.startsWith("check")||i.startsWith("done"))})&&r.push(v.c.CHECK_LIST),-1<s.indexOf(g.BLOCK_DATA_META_BLOCK_PROPS)){var d=s.indexOf(g.BLOCK_DATA_META_BLOCK_PROPS),h=s[d+1],f=null;try{f=JSON.parse(h)}catch(e){console.error("[BLOCK]: JSON parse dataset error",e),Object(y.a)("[BLOCK]: JSON parse dataset error")}f&&(f.props.displayMode===g.BlockDisplayMode.INLINE?r.push(v.c.INLINE_BLOCK):r.push(v.c.BLOCK))}return k.a.some(function(e){var t=e.split("-"),n=p()(t,2),r=n[0],o=n[1];return!!a.find(function(e){var t=p()(e,2),n=t[0],i=t[1];return n===r&&i===o})})&&r.push(v.c.UNSUPPORT_FEATURE),-1<s.indexOf("heading")&&r.push(v.c.HEADING),r}},yGdm:function(e,p,g){"use strict";(function(e){g.d(p,"d",function(){return n}),g.d(p,"h",function(){return i}),g.d(p,"c",function(){return r}),g.d(p,"l",function(){return o}),g.d(p,"a",function(){return a}),g.d(p,"j",function(){return s}),g.d(p,"i",function(){return c}),g.d(p,"b",function(){return l}),g.d(p,"g",function(){return u}),g.d(p,"e",function(){return d}),g.d(p,"k",function(){return h}),g.d(p,"m",function(){return f});var t=g("H6oK"),n=338,i={gmap:"ee.docs.doc.block_iframe_make_address_specific_error",xigua:"ee.docs.doc.block_get_xigua_iframe__error",tiktok:"ee.docs.doc.block_get_tiktok_iframe__error"},r="outer-u-container",o=new RegExp("mention-type|".concat(t.IGNORE_HYPERLINK_CLASS)),a={bilibili:"https://www.bilibili.com/video/BV1Hi4y1w7V7",youku:"https://v.youku.com/v_show/id_XMTY1MjYwODYzNg==.html?spm=a2h0j.11185381.listitem_page1.5!15~A&&s=9a35f8960f3c11e5a080",youtube:"https://youtu.be/Ajo5v1zxrHE",airtable:"https://airtable.com/shrs4PhummCCIHXXT",baidumap:"https://j.map.baidu.com/6jqkO",autonavi:"https://www.amap.com/place/B000A83C1S",gmaps:"https://www.google.com/maps/place/Central+Park/@40.7828647,-73.9675438,17z",xigua:"https://www.ixigua.com/6763174234282787341",tiktok:"https://t.tiktok.com/i18n/share/video/6584979523391982853",figma:"https://www.figma.com/file/LKQ4FJ4bTnCSjedbRpk931/Sample-File",modao:"https://modao.cc/app/45ed43a9277e1cdb844b10e8e8890cf177e6ea25?simulator_type=device&sticky",canva:"https://www.canva.cn/design/DAERsJN19ZM/view",codepen:"https://codepen.io/jackrugile/pen/IHbvh",jinshuju:"https://jinshuju.net/f/tRreUu",feishu_survey:"https://wenjuan.feishu.cn/m?t=sVOKVVz7rwpi-ay5n",lark_survey:"https://survey.larksuite.com/m/cfm?t=sVF8j1fIlrpi-ff3n"},s={bilibili:e("CreationDocs_Embeds_PasteLinkBilibili_Options"),youku:e("CreationDocs_Embeds_PasteLinkYouku_Options"),youtube:e("CreationDocs_Embeds_PasteLinkYoutube_Options"),airtable:e("CreationDocs_Embeds_PasteLinkAirtable_Options"),baidumap:e("CreationDocs_Embeds_PasteLinkBaiduMap_Options"),autonavi:e("CreationDocs_Embeds_PasteLinkGaodeMap_Options"),gmaps:e("CreationDocs_Embeds_PasteLinkGoogleMap_Options"),xigua:e("CreationDocs_Embeds_PasteLinkXigua_Options"),tiktok:e("CreationDocs_Embeds_PasteLinkTiktok_Options"),figma:e("CreationDocs_Embeds_PasteLinkFigma_Options"),modao:e("CreationDocs_Embeds_PasteLinkModao_Options"),canva:e("CreationDocs_Embeds_PasteLinkCanva_Options"),codepen:e("CreationDocs_Embeds_PasteLinkCodePen_Options"),jinshuju:e("CreationDocs_Embeds_PasteLinkJinshuju_Options"),feishu_survey:e("CreationDocs_Embeds_PasteLinkFeishuSurvey_Options"),lark_survey:e("CreationDocs_Embeds_PasteLinkLarkSurvey_Options")},c={bilibili:e("CreationDocs_Embeds_bilibiliLink_Placeholder"),youku:e("CreationDocs_Embeds_YoukuLink_Placeholder"),youtube:e("CreationDocs_Embeds_YoutubeLink_Placeholder"),airtable:e("CreationDocs_Embeds_AirtableLink_Placeholder"),baidumap:e("CreationDocs_Embeds_BaiduMapLink_Placeholder"),autonavi:e("CreationDocs_Embeds_GaodeMapLink_Placeholder"),gmaps:e("CreationDocs_Embeds_GoogleMapsLink_Placeholder"),xigua:e("CreationDocs_Embeds_XiguaLink_Placeholder"),tiktok:e("CreationDocs_Embeds_TikTokLink_Placeholder"),figma:e("CreationDocs_Embeds_FigamaLink_Placeholder"),modao:e("CreationDocs_Embeds_ModaoLink_Placeholder"),canva:e("CreationDocs_Embeds_CanvaLink_Placeholder"),codepen:e("CreationDocs_Embeds_CodePenLink_Placeholder"),jinshuju:e("CreationDocs_Embeds_JinshujuLink_Placeholder"),feishu_survey:e("CreationDocs_Embeds_FeishuSurveyLink_Placeholder"),lark_survey:e("CreationDocs_Embeds_LarkSurveyLink_Placeholder")},l={bilibili:e("CreationDocs_Embeds_BilibiliLink_FeishuHelpCenter"),youku:e("CreationDocs_Embeds_YoukuLink_FeishuHelpCenter"),airtable:e("CreationDocs_Embeds_AirtableLink_FeishuHelpCenter"),baidumap:e("CreationDocs_Embeds_BaiduMapLink_FeishuHelpCenter"),autonavi:e("CreationDocs_Embeds_GaodeMapsLink_FeishuHelpCenter"),xigua:e("CreationDocs_Embeds_XiguaLink_FeishuHelpCenter"),figma:e("CreationDocs_Embeds_FigmaLink_FeishuHelpCenter"),modao:e("CreationDocs_Embeds_ModaoLink_FeishuHelpCenter"),canva:e("CreationDocs_Embeds_CanvaLink_FeishuHelpCenter"),codepen:e("CreationDocs_Embeds_CodePenLink_FeishuHelpCenter"),jinshuju:e("CreationDocs_Embeds_JinshujuLink_FeishuHelpCenter"),feishu_survey:e("CreationDocs_Embeds_FeishuSurveyLink_FeishuHelpCenter")},u={youtube:e("CreationDocs_Embeds_YoutubeLink_LakrHelpCenter"),airtable:e("CreationDocs_Embeds_AirtableLink_LarkHelpCenter"),gmaps:e("CreationDocs_Embeds_GoogleMapsLink_LarkHelpCenter"),tiktok:e("CreationDocs_Embeds_TikTokLink_LarkHelpCenter"),figma:e("CreationDocs_Embeds_FigmaLink_LarkHelpCenter"),codepen:e("CreationDocs_Embeds_CodePenLink_LarkHelpCenter"),lark_survey:e("CreationDocs_Embeds_LarkSurveyLink_LarkHelpCenter")},d="iframe-holder",h=["people.bytedance.net"],f=["vt.tiktok.com","imgur.com","slideshare.net","chartblocks.com","speakerdeck.com"]}).call(this,g("2vAP"))},"yH1+":function(e,t,n){"use strict";n("D7h9"),n("Ysvc"),n("dfOl"),n("gfe6");function i(){var e=window.NETWORK_STATE;return e?e.connected:navigator.onLine}n.d(t,"c",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var r="online",o="offline"},"yJ+g":function(e,t,n){"use strict";var i=n("lwsE"),r=n.n(i),o=n("W8MJ"),a=n.n(o),s=n("K9Ia"),c=n("26FU"),l=n("0/uQ"),u=n("0mNj"),d=n("15JJ"),h=n("ad02"),f=n("ny24"),p=n("fOmz"),g=n("o0o1"),m=n.n(g),v=n("lSNA"),b=n.n(v),y=n("yXPU"),E=n.n(y),O=n("a1gu"),C=n.n(O),k=n("Nsbk"),I=n.n(k),S=n("7W2i"),T=n.n(S),_=n("jp/M"),w=n("7HY0"),j=n("D7h9"),M=function(e){return{type:_.actionTypes.messageData.UPDATE_MESSAGES,payload:{messages:e}}},L=n("cyON"),R=function(e){function n(e){var t;return r()(this,n),(t=C()(this,I()(n).call(this,e))).commentService.setupMessageRecord(),t}return T()(n,e),a()(n,[{key:"fetchMessages",value:function(){var t,i=this;return(0,j.default.dispatch)({type:"COMMENT_SERVICE",COMMENT:(t=E()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=b()({type:_.actionTypes.messageData.FETCH_MESSAGES},L.a,{resetWhenSuiteTokenChange:!0}),e.abrupt("return",i.wrapperDispatchAction(t,n,E()(m.a.mark(function e(){var t;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.commentService.fetchMessages(!0);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)})),e)});function e(e){return t.apply(this,arguments)}}},{key:"setMessages",value:function(e){return(0,j.default.dispatch)({type:_.actionTypes.messageData.SET_MESSAGES,payload:{messages:e}})}},{key:"setNotifications",value:function(e){return(0,j.default.dispatch)({type:_.actionTypes.messageData.SET_NOTIFICATIONS,payload:{messages:e}})}},{key:"resetMessages",value:function(){return(0,j.default.dispatch)({type:_.actionTypes.messageData.RESET_MESSAGES})}},{key:"updateMessages",value:function(e){return(0,j.default.dispatch)(M(e))}},{key:"markRead",value:function(e){var t=e.messageIds;return this.commentService.markRead({messageIds:t})}},{key:"setMessageStatus",value:function(e){var t=e.type,n=e.id;return(0,j.default.dispatch)({type:_.actionTypes.messageData.SET_MESSAGE_STATUS,payload:{type:t,id:n}})}},{key:"removeMessageNewStatus",value:function(e){var t=e.commentId,n=e.mentionId;return(0,j.default.dispatch)({type:_.actionTypes.messageData.REMOVE_MESSAGES_NEW_STATUS,payload:{commentId:t,mentionId:n}})}},{key:"resetMessageNewStatus",value:function(){return(0,j.default.dispatch)({type:_.actionTypes.messageData.RESET_MESSAGES_NEW_STATUS})}},{key:"destroyMessages",value:function(){var e=j.default.dispatch;this.destroy(),this.resetMessages(),this.resetMessageNewStatus(),e({type:_.actionTypes.messagePosition.RESET_MESSAGE_POSITION_DATA})}}]),n}(w.a);function N(e,t){return e.enableAutoTranslate===t.enableAutoTranslate&&e.translateLang===t.translateLang}n.d(t,"a",function(){return D});var D=function(){function n(e){var t=this;r()(this,n),this.props=e,this.destroy$=new s.a,this.onDestroyComments=void 0,this.onDestroyMessages=void 0,this.commentDataActions$=new c.a(null),this.messageDataActions$=new c.a(null),this.translateOptions$=new s.a,this.commentDataActions$.pipe(Object(u.a)(1),Object(d.a)(function(){return t.translateOptions$.pipe(Object(h.distinctUntilChanged)(N))})).pipe(Object(f.a)(this.destroy$)).subscribe(function(e){return t.setTranslateOptions(e)})}return a()(n,[{key:"getCommentDataActions",value:function(){return this.commentDataActions$.getValue()}},{key:"getMessageDataActions",value:function(){return this.messageDataActions$.getValue()}},{key:"destroyComments",value:function(){var e=this.getCommentDataActions();e&&(this.onDestroyComments&&(this.onDestroyComments(),this.onDestroyComments=void 0),e.destroyComments(),this.commentDataActions$.next(null))}},{key:"destroyMessages",value:function(){var e=this.getMessageDataActions();e&&(this.onDestroyMessages&&(this.onDestroyMessages(),this.onDestroyMessages=void 0),e.destroyMessages(),this.messageDataActions$.next(null))}},{key:"initComments",value:function(e,t){var n,i,r=this;if(t){if(!this.props.shouldRecreateCommentDataActions(e.rootType,e.rootToken))return;var o=new p.a(e);return this.commentDataActions$.next(o),this.props.onNewCommentDataActions&&(this.onDestroyComments=this.props.onNewCommentDataActions(o)),void(this.props.onFetchCommentsSuccess&&this.props.onFetchCommentsSuccess(o))}this.destroyComments(),this.props.shouldRecreateCommentDataActions(e.rootType,e.rootToken)&&(n=new p.a(e),this.commentDataActions$.next(n),this.props.onNewCommentDataActions&&(this.onDestroyComments=this.props.onNewCommentDataActions(n)),i=!!e.subCommentToken,Object(l.a)(n.fetchComments(i)).pipe(Object(f.a)(this.commentDataActions$.pipe(Object(u.a)(1))),Object(f.a)(this.destroy$)).subscribe(function(e){r.props.onFetchCommentsSuccess&&r.props.onFetchCommentsSuccess(n,e)}))}},{key:"initMessages",value:function(e,t){var n,i=this;if(t){if(!this.props.shouldRecreateMessageDataActions(e.rootType,e.rootToken))return;var r=new R(e);return this.messageDataActions$.next(r),void(this.props.onNewMessageDataActions&&(this.onDestroyMessages=this.props.onNewMessageDataActions(r)))}this.destroyMessages(),this.props.shouldRecreateMessageDataActions(e.rootType,e.rootToken)&&(n=new R(e),this.messageDataActions$.next(n),this.props.onNewMessageDataActions&&(this.onDestroyMessages=this.props.onNewMessageDataActions(n)),Object(l.a)(n.fetchMessages()).pipe(Object(f.a)(this.messageDataActions$.pipe(Object(u.a)(1))),Object(f.a)(this.destroy$)).subscribe(function(e){i.props.onFetchMessagesSuccess&&i.props.onFetchMessagesSuccess(e)},function(){i.props.onFetchMessagesError&&i.props.onFetchMessagesError()}))}},{key:"setTranslateOptions",value:function(e){var t=e.enableAutoTranslate,n=e.translateLang,i=this.getCommentDataActions();i&&i.setCommentTranslateEnableLang(t,n)}},{key:"destroyNotifications",value:function(){this.destroy$.next(),this.destroy$.complete(),this.commentDataActions$.complete(),this.messageDataActions$.complete(),this.destroyComments(),this.onDestroyMessages&&(this.onDestroyMessages(),this.onDestroyMessages=void 0)}},{key:"destroy",value:function(){this.destroy$.next(),this.destroy$.complete(),this.commentDataActions$.complete(),this.messageDataActions$.complete(),this.destroyComments(),this.destroyMessages()}}]),n}()},"yKd+":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"16",height:"16",viewBox:"0 0 16 16"},t),c.a.createElement("path",{d:"M3.04 13.83H1.87V5.67h1.17v8.16zm7-8.16h2.21C14 5.67 14.4 7.2 14 8.35l-1.74 4.59c-.15.53-.64.9-1.2.9H3.92V5.67h1.2l2.6-3.7c.16-.26.6-.46 1.07-.24.7.32 1.85 1.02 1.85 2.19 0 .44-.2 1.02-.59 1.75z",fillRule:"evenodd"}))}},yN2k:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24"},t),c.a.createElement("path",{fill:"#F54A45",d:"M15.9 8.11l.49.5a.4.4 0 010 .56l-3.2 3.2 2.95 2.96a.4.4 0 010 .56l-.5.5a.4.4 0 01-.56 0l-2.95-2.96-2.96 2.96a.4.4 0 01-.56 0l-.5-.5a.4.4 0 010-.56l2.95-2.96-3.2-3.2a.4.4 0 010-.56l.5-.5a.4.4 0 01.56 0l3.2 3.2 3.2-3.2a.4.4 0 01.57 0zM2.7 11.5a.3.3 0 01.3.3v.9a.3.3 0 01-.3.3H1.3a.3.3 0 01-.3-.3v-.9a.3.3 0 01.3-.3h1.4zm4 0a.3.3 0 01.3.3v.9a.3.3 0 01-.3.3H5.3a.3.3 0 01-.3-.3v-.9a.3.3 0 01.3-.3h1.4zm16 0a.3.3 0 01.3.3v.9a.3.3 0 01-.3.3h-1.4a.3.3 0 01-.3-.3v-.9a.3.3 0 01.3-.3h1.4zm-4 0a.3.3 0 01.3.3v.9a.3.3 0 01-.3.3h-1.4a.3.3 0 01-.3-.3v-.9a.3.3 0 01.3-.3h1.4z",fillRule:"evenodd"}))}},ylw9:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("J4zp"),g=n.n(i),m=n("nVH4"),v=n("H6oK"),b=n("kESg");function r(e){var t=e.rep,n=e.selStart;if((n=n||t.selStart)&&t.lines){var i=n[0],r=t.lines.atIndex(i);if(r&&r.isActive){var o=t.attributeManager.getAllAttributesOnLine(i),a=o.filter(function(e){return"gallery"===e[0]});if(1<a.length)return m.d.CARD;if(1===a.length){var s=a[0];return 1===JSON.parse(s[1]).items.length?m.d.IMAGE:m.d.CARD}for(var c=0,l=0;l<o.length;l++){var u=g()(o[l],2),d=u[0],h=u[1];if(d===v.BLOCK_DATA_META_BLOCK_PROPS&&h){var f=JSON.parse(h);return Object(v.isInlineBlock)(f)?m.d.TEXT:m.d.BLOCK}if("gallery"===d&&h){var p=JSON.parse(h).items;if(1===p.length){c++;continue}if(1<p.length)return m.d.CARD}if("image-uploaded"===d&&h)return m.d.IMAGE;if("image-previewer"===d&&h)return m.d.CARD;if("aceTable"===d&&h)return m.d.TABLE;if(d.includes("mention-chat")&&h)return m.d.CARD;if(d===b.k.ZoneType&&h===b.l.CodeBlock)return m.d.CODE_BLOCK_V2;if(d===b.k.ZoneType&&h===b.l.CalloutBlock)return m.d.CALLOUT_BLOCK}if(1<c)return m.d.CARD;if(1===c)return m.d.IMAGE}}return m.d.TEXT}},yxg6:function(e,t,n){},z4jg:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i="editorcontainerbox"},zLXu:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var s=n("OZf9"),c=n("Bw5p"),l=n("mkut"),u=n("b6qs"),d=n("HIeq"),i=n("toa8"),h=n("QM+C");function f(e){return i.d.post("/api/mention/chat.info.v2/",e,{headers:{"Content-Type":"application/json;"}}).then(function(e){return Object(s.a)(e.data,function(e){e.hasjoin=e.has_join}),e})}function r(n,e,t){var i,r,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},a=4<arguments.length?arguments[4]:void 0;e.length&&(h.isAnonymousAccess||(i=u.a.getAllCacheInfo(),r=Object(c.a)(i,e),Object(l.a)(r).length!==e.length?f({chat_ids:e,source:t,token:Object(d.e)()}).then(function(e){u.a.setCacheInfo(e.data),Object(s.a)(e.data,function(e,t){o(n,t,e,a)})}):Object(s.a)(r,function(e,t){o(n,t,e,a)})))}},zTCG:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a});var i=n("kESg"),r={CODE_BLOCK:"code-block",ACE_LINE:"code-block-ace-line",LINE:"code-block-line",CONTAINER:"code-block-container",HEADER:"code-block-header",HEADER_BTN:"code-block-header-btn",HEADER_BTN_CON:"code-block-header-btn-con",LANG_PICKER:"code-block__lang-picker",LANG_PICKER_HEADER_CON:"code-block__lang-picker-header-con",SPAN:"".concat(i.k.ZoneType,"-").concat(i.l.CodeBlock),COPY_CODE:"copy-code",CODE_LINE_NUM:"code-block-line-num",CODE_BLOCK_UPGRADE:"code-block-upgrade",WORD_WRAP_PREFIX:"word-wrap"},o="SourceCodePro",a=12},zrMW:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24"},t),c.a.createElement("path",{fill:"#2B2F36",fillRule:"evenodd",d:"M16.48 13.45c.11 0 .22.03.3.1l3.24 2.64a.48.48 0 010 .74l-3.23 2.64a.48.48 0 01-.79-.37V17H8.34a.34.34 0 01-.34-.35v-.64c0-.19.15-.34.34-.34H16v-1.74c0-.27.21-.48.48-.48zM7.9 5.18c.07.08.11.19.11.3v2.2h7.66c.19 0 .34.16.34.35v.63c0 .2-.15.35-.34.35H8v1.74a.48.48 0 01-.78.37L3.98 8.5a.48.48 0 010-.75l3.24-2.63a.48.48 0 01.67.07z"}))}},zy84:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("J4zp"),d=n.n(i),r=n("lSNA"),h=n.n(r),f=n("y2sV"),p=n("Z/PY"),g=n("j1lG"),m=function(e){return e.getEntities([]).reduce(function(e,t){return t.attributes&&t.attributes[g.K]?[e[0]+1,t]:e},[0,null])},v=function(e,t,n){var i=(Object(p.C)(e.attributes[g.K])||{}).items;if(!i||1===i.length||0===t.size)return!1;var r=i.filter(function(e){return!t.has(e.uuid)}),o=e.start,a=e.end,s=o.zoneId,c=new f.q({editor:n,start:o,end:a}).toPosition(),l=c.start,u=c.len,d=new f.E({zoneId:s}).retain(l).delete(u);return r.forEach(function(e){d.insert(g.B,h()({},g.K,JSON.stringify({items:[e]})))}),n.getContentState().apply(d),!0},o=function(e,t){var n=t.selection.getSelection(),i=n.start,r=n.end,o=i.zoneId;if(i.line!==r.line)return!1;var a=t.getContentState().getZoneState(o).getLine(i.line);if(!a)return!1;var s=m(a),c=d()(s,2),l=c[0],u=c[1];return!(0===l||1<l)&&v(u,e.selectedImageSet,t)}}}]);
//# sourceMappingURL=doc_index.677764780e8860f5d588.js.map