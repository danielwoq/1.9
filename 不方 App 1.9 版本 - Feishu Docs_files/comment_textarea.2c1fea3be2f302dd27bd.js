(this.webpackJsonp=this.webpackJsonp||[]).push([["comment_textarea",16,"i18n",59,68],{"+/Fj":function(e,t,n){"use strict";var r=n("pVnL"),i=n.n(r),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",i()({width:"18",height:"18",viewBox:"0 0 18 18"},t),c.a.createElement("path",{d:"M0 9a9 9 0 1018 0A9 9 0 000 9zm8.94 2.81h.69c.27 0 .5.23.5.5V13a.5.5 0 01-.5.5h-.7a.5.5 0 01-.5-.5v-.69c0-.27.23-.5.5-.5zm0-7.31h.69c.27 0 .5.22.5.5v4.63a.5.5 0 01-.5.5h-.7a.5.5 0 01-.5-.5V5c0-.28.23-.5.5-.5z",fill:"#FFC60A",fillRule:"evenodd"}))}},"+0ye":function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s});var r=n("HmyT"),i=n("182n"),o=function(e){for(var t=["heading-h1","heading-h2","heading-h3","heading-h4","heading-h5","heading-h6","heading-h7","heading-h8","heading-h9"],n=0;n<t.length;n++)if(Object(r.$)(e).hasClass(t[n]))return t[n];return null},a=function(e){return Number(e.match(/\d+/)[0])},s=function(e){var t=/heading-(\S+)/.exec(e);return!!t&&i.a.includes(t[1])}},"+Gkg":function(e,b,y){"use strict";(function(n){y.d(b,"a",function(){return v});var e=y("lwsE"),r=y.n(e),t=y("W8MJ"),i=y.n(t),o=y("a1gu"),a=y.n(o),s=y("Nsbk"),c=y.n(s),u=y("7W2i"),l=y.n(u),d=y("q1tI"),f=y.n(d),h=y("ahx2"),p=y("JyuV"),g=y("6jHd"),m=y("3VXv"),v=function(e){function t(){return r()(this,t),a()(this,c()(t).apply(this,arguments))}return l()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.className,t=this.coverInfo,n=t.cover,r=t.text;return f.a.createElement(m.a,{className:e},n&&f.a.createElement(n,null),Boolean(r)&&f.a.createElement(m.b,null,r))}},{key:"coverInfo",get:function(){var e={cover:null,text:""};switch(this.props.code){case h.SpecitalSuiteCodeMap[9009]:e.cover=p.a,e.text=n("common.cover.empty_doc");break;case h.SpecitalSuiteCodeMap[9010]:e.cover=g.a}return e}}]),t}(f.a.Component)}).call(this,y("2vAP"))},"/fVd":function(e,t,n){"use strict";n.d(t,"a",function(){return b});var r=n("J4zp"),d=n.n(r),i=n("UXvI"),o=n("kohC"),f=n("AiBH"),s=n("OX8E"),c=n("2ACu"),h=n("tp5K"),a=[f.E.FILE,f.E.SHEET,f.E.MINDNOTE,f.E.BITABLE,f.E.SLIDE,f.E.BOX,f.E.WIKI];function p(){console.error("Instance EmbedObjPermissionManager is not existed")}function u(e){Object(c.default)("page_visit_embed_info_collect",{initially_request_embed_num:e.length})}function l(){var t=!0;return new o.a({onPermissionChange:function(e){t&&(u(e),t=!1);var o=0,a=0;e.forEach(function(e){var t,n,r=e.token,i=e.permission;i&&(t=i.cantRead,n=i.canInvite,t&&++o,n&&++a,b.hasEmbedObj(r)&&(b.cantReadFiles[r]=t,s.a.trigger(f.D,[r,t])))}),(o||a)&&Object(c.default)("page_visit_embed_info_collect",{self_can_not_access_doc_num:o,collaborator_can_not_access_doc_num:a})},onError:function(e){return console.error(e)}})}var g=1e3,m=500,v=500,b={embedObjCountMap:{},cantReadFiles:{},embedObjPermissionManager:null,embedObjMap:{},zoneToLineNodeIdMap:{},waitingIntoBufferMap:new Map,getInstance:function(){return this.embedObjPermissionManager},initEmbedObjMap:function(u){var l=this;this.recreateEmbedObjPermissionManager();var t=new RegExp("^mention-type_(".concat(a.join("|"),")$")),d=u.getMatchedAttributePositionOnSelection(null,function(e){return t.test(e)},{shouldMerge:!1});u.getMatchedAttributePositionOnSelection(null,function(e){return/mention-token/.test(e)},{shouldMerge:!1}).forEach(function(e){var i,t,n,r=e.attrKey,o=e.docPosition,a=o.selEnd,s=o.selStart,c=o.selZone;d.some(function(e){var t=e.attrKey,n=e.docPosition;if(n.selEnd[0]!==a[0]||n.selEnd[1]!==a[1]||n.selStart[0]!==s[0]||n.selStart[1]!==s[1]||n.selZone!==c)return!1;var r=t.split("_")[1];return i=f.v[r],!0}),i&&(t=Object(h.c)(r),l.embedObjCountMap[t]?++l.embedObjCountMap[t]:l.embedObjCountMap[t]=1,n=l.getTitle(s,a,c,u),l.embedObjMap[t]={token:t,type:i,title:n})})},getTitle:function(e,t,n,r){var i=r.selection.flatten([e[0],e[1],n]),o=r.selection.flatten([t[0],t[1],n]);return r.getRep(n).alltext.slice(i,o)},createEmbedObjPermissionManager:function(){this.embedObjPermissionManager||(this.embedObjPermissionManager=l())},destroyEmbedObjPermissionManager:function(){this.embedObjPermissionManager&&(this.embedObjPermissionManager.destroy(),this.embedObjPermissionManager=null,this.embedObjMap={},this.embedObjCountMap={},this.cantReadFiles={},this.addStash={},this.zoneToLineNodeIdMap={},this.waitingIntoBufferMap.clear())},embedObjPermissionManagerUpdateEmbedObjList:Object(i.default)(function(){this.embedObjPermissionManager&&this.embedObjPermissionManager.updateEmbedObjList(Object.values(this.embedObjMap))},v),recreateEmbedObjPermissionManager:function(){this.destroyEmbedObjPermissionManager(),this.createEmbedObjPermissionManager()},hasEmbedObj:function(e){return this.embedObjCountMap[e]&&this.embedObjMap[e]},addEmbedObj:function(e){if(!this.embedObjPermissionManager)return p();var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=a.num,c=a.obj,u=c.token,l=c.title;this.hasEmbedObj(u)?(this.embedObjCountMap[u]+=s,this.embedObjMap[u].title!==l&&(this.embedObjMap[u].title=l)):(this.embedObjCountMap[u]=s,this.embedObjMap[u]=c)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},sendEmbedObjsToManager:function(e){var t;this.embedObjPermissionManager&&0<e.length&&(t=Object(h.b)(e).filter(function(e){return!!e}),this.embedObjPermissionManager.addEmbedObjs(t),Object(c.default)("page_visit_embed_info_collect",{total_request_embed_doc_num:t.length}))},debounceSendEmbedObjsToManager:Object(h.a)(function(e){return b.sendEmbedObjsToManager(e)},m,{maxWait:g}),removeEmbedObj:function(e){if(!this.embedObjPermissionManager)return p();var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.num,u=s.obj.token;this.embedObjCountMap[u]&&(this.embedObjCountMap[u]-=c,0===this.embedObjCountMap[u]&&(t.push(this.embedObjMap[u]),delete this.embedObjCountMap[u],delete this.embedObjMap[u]))}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this.embedObjPermissionManager.removeEmbedObjs(t)},addStash:{},addTokenInStash:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a,s=i.value,c=d()(Object.entries(s)[0],2),u=c[0],l=c[1];this.addStash[u]?this.addStash[u].num+=l:(a={token:u,type:void 0,title:void 0},this.addStash[u]={num:l,obj:a})}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},completeInStash:function(e){var t,n=e.token,r=e.type,i=e.title;!1===this.isCompleteInStash(n)&&((t=this.addStash[n].obj).type=r,t.title=i,this.execStashList())},removeFromStash:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=d()(Object.entries(s)[0],2),u=c[0],l=c[1];this.addStash[u]?this.addStash[u].num&&(this.addStash[u].num-=l,0===this.addStash[u].num&&delete this.addStash[u]):this.hasEmbedObj(u)&&t.push({num:l,obj:this.embedObjMap[u]})}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this.removeEmbedObj(t)},isEmptyStash:function(){return!Object.keys(this.addStash).length},isCompleteInStash:function(e){return this.addStash[e]?Object.values(this.addStash[e].obj).every(function(e){return void 0!==e}):null},execStashList:function(){var t=this;if(!this.embedObjPermissionManager)return p();var n=[],e=Object.keys(this.addStash);0<e.length&&(e.forEach(function(e){t.isCompleteInStash(e)&&(n.push(t.addStash[e]),delete t.addStash[e])}),this.addEmbedObj(n))},fetchEmbedObjsPerm:function(){this.embedObjPermissionManager&&this.embedObjPermissionManager.fetchEmbedObjsAllPerm()}}},"/xWd":function(e,t,n){"use strict";var r=n("uT1x"),i=n("fshX");function o(e,t){return(null==e?0:e.length)?(t=void 0===t?1:Object(i.a)(t),Object(r.a)(e,t)):[]}t.a=o},"093l":function(e,t,n){"use strict";function r(e){var t=!0;return function(){t?t=!1:e()}}n.d(t,"a",function(){return r})},"182n":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("YNKm"),i=[r.s,r.t,r.u,r.v,r.w,r.x,r.y,r.z,r.A]},"1ABj":function(e,t){function n(e,t){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and set to use loose mode. To use proposal-class-properties in spec mode with decorators, wait for the next major version of decorators in stage 2.")}e.exports=n},"1I8I":function(e,t,n){"use strict";n.d(t,"c",function(){return O}),n.d(t,"b",function(){return F}),n.d(t,"a",function(){return B});var r=n("o0o1"),d=n.n(r),i=n("yXPU"),o=n.n(i),a=n("fujP"),l=n("xA8S"),f=n("HmyT"),h=n("Jn5N"),s=n("v2N6"),c=n("pylR"),u=n("Xngx"),p=n("PI5S"),g=n("m9Pg"),m=n("rLED"),v=n("Mvmg"),b=n("EAIz"),y={},k=["beforeFileQueued","fileQueued","filesQueued","fileDequeued","reset","startUpload","stopUpload","uploadFinished","uploadStart","uploadBeforeSend","uploadAccept","uploadProgress","uploadError","uploadSuccess","uploadComplete","error"];function O(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"default";if(y[e]){var t=y[e].instance;try{t.destroy(),y[e].triggerBtn&&y[e].triggerBtn.remove(),s.a(),"default"===e&&P(!1,e),delete y[e],delete z[e]}catch(e){console.warn("destroy uploader失败")}}}function E(e){var t,n=y[e].triggerBtn;n&&((t=Object(f.$)(n).find("input[name=file]")).attr("accept","image/gif, image/jpg, image/jpeg, image/bmp, image/png"),t.click(function(e){e.stopPropagation()}),Object(f.$)(n).find("label").click(function(e){e.stopPropagation()}).trigger("click"),t.attr("accept","*"))}function C(e,t){var n=document.querySelector(t);return n&&n.contains(e)}function I(e,t){var n,r,i;C(e.target,".bitable-editor-container")||e.target.className&&e.target.className.includes("spreadsheet-canvas")||y[t].instance.enableDropImage&&(e.preventDefault(),e.stopImmediatePropagation(),e.dataTransfer&&(r=(n=e.dataTransfer).items,i=n.files,r?S(r,t):i&&T(i,t)))}function S(e,t){return j.apply(this,arguments)}function j(){return(j=o()(d.a.mark(function e(t,n){var r,i,o,a,s,c,u,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return");case 2:for(r=Array.from(t),i=[],o=0,a=r;o<a.length;o++)(s=(s=a[o]).webkitGetAsEntry())&&s.isFile&&(c=x(s),i.push(c));u=0;case 6:if(u<i.length)return e.next=9,i[u];e.next=16;break;case 9:return l=e.sent,e.next=12,N(l);case 12:i[u]=l;case 13:u++,e.next=6;break;case 16:w(i,n);case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(e,t){w(Array.from(e),t)}function w(e,t){if(e&&0<e.length){for(var n=0;n<e.length;n++)e[n].logSource="drag";_({imgFiles:e.filter(function(e){return M(e)}),otherFiles:e.filter(function(e){return!M(e)})},t)}}function _(e,t){var n=e.imgFiles,r=void 0===n?[]:n,i=e.otherFiles,o=void 0===i?[]:i;Object(a.default)(r)||(Object(m.Q)()?r.forEach(function(e){g.a&&g.a.upload(e)}):y[t].instance.addFile(r)),Object(a.default)(o)||o.forEach(function(e){e.source=v.i.DRAG,Object(p.c)(e)})}function M(e){return!!e.type&&!!e.type.match(/image\/(gif|jpg|jpeg|bmp|png)$/)}function x(t){return new Promise(function(e){t.file(e)})}var L=["gif","jpg","jpeg","bmp","png"];function N(e){return R.apply(this,arguments)}function R(){return(R=o()(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(u.d)(t.name),L.includes(n))return e.abrupt("return");e.next=3;break;case 3:return e.next=5,Object(c.a)(t);case 5:r=e.sent,s.b(t,r);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function P(e,t){var n,r=document.getElementById("innerdocbody");r&&(n=y[t].dropHandler,e?r.addEventListener("drop",n,{capture:!0}):r.removeEventListener("drop",n,{capture:!0}))}var D=function(e){return function(){return e.resolve()}},U=function(e){return function(){return e.reject()}},F=function(e){delete z[e]},z={};function B(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default",n=e.editorInfo,r={"F-Version":window&&window.rv_rev||""};b.e&&Object.assign(r,Object(b.d)());var i,o,a,s,c,u=Object(l.a)();return u&&(r.Env=u),y[t]||(y[t]={},i=Object(f.$)('<div style="width:0;overflow:hidden;"></div>'),y[t].triggerBtn=i,Object(f.$)("body").append(i),"default"===t&&(o=[".spreadsheet",".bitable-editor-container"]),(a=h.default.create({server:"",auto:!0,paste:n.getInnerContainer(),pick:i,method:"POST",multiple:!0,threads:10,fileNumLimit:100,headers:r,withCredentials:!0,duplicate:!0,dnd:n.getInnerContainer(),ignoreDragElement:[".spreadsheet",".bitable-editor-container",".attach-cover"],ignorePasteElement:o,compress:{quality:100,allowMagnify:!1,crop:!1,scale:1,preserveHeaders:!1}})).open=function(){return E(t)},a.enableDropImage=!0,s=a.on,c={},a.on=function(e,t,n){e.split(",").map(function(e){return e.trim()}).filter(function(e){return!!e}).forEach(function(e){c[e]||(c[e]={}),c[e][t]=n})},y[t].instance=a,y[t].dropHandler=function(e){return I(e,t)},k.forEach(function(i){s.call(a,i,function(){var e,t="*";0<arguments.length&&((e=(e=arguments[0]).file||e)instanceof h.default.File&&(t=(t=e.name.split(".").pop())&&t.toLowerCase()));var n=c[t]||c["*"];if(n){var r=n[i];if(r)return r.apply(void 0,arguments)}})}),"default"===t&&P(!0,t)),y[t].instance}h.default.Uploader.register({"before-send-file":"beforeSendFile"},{beforeSendFile:function(e){var t=h.default.Deferred(),n=e.comment;if(n&&!n.replyId&&n.commentService)if(z[n.uniqueId]){var r=z[n.uniqueId],i=r.resolveCb,o=r.rejectCb,a=r.succeed;if(void 0!==a)return setTimeout(function(){a?t.resolve():t.reject()}),t.promise();i.push(D(t)),o.push(U(t))}else{var s=n.commentService.genReplyId({commentId:n.commentId});z[n.uniqueId]={resolveCb:[],rejectCb:[]},s.then(function(e){n.replyId=e.replyId,t.resolve(),z[n.uniqueId].resolveCb.forEach(function(e){return e()}),z[n.uniqueId].resolveCb.length=0,z[n.uniqueId].rejectCb.length=0,z[n.uniqueId].succeed=!0}).catch(function(e){console.error(e),t.reject(),z[n.uniqueId].rejectCb.forEach(function(e){return e()}),z[n.uniqueId].resolveCb.length=0,z[n.uniqueId].rejectCb.length=0,z[n.uniqueId].succeed=!1})}else n&&n.replyId&&z[n.uniqueId]&&delete z[n.uniqueId],setTimeout(function(){t.resolve()});return t.promise()}})},"1xqC":function(e,f,h){"use strict";(function(n){h.d(f,"a",function(){return d});var e=h("lwsE"),r=h.n(e),t=h("W8MJ"),i=h.n(t),o=h("HIeq"),a=h("2ACu"),s=h("Mvmg"),c=h("XDjv"),u=h("uEBw"),l=h("OX8E"),d=function(){function t(e){r()(this,t),this.progress=0,this.started=!1,this.canceled=!1,this.isDone=!1,this.editorInfo=e.editorInfo,this.file=e.file,this.id=this.file.uuid,this.handleUploadEnd=e.handleUploadEnd,this.driveUploader=e.docUploaderCreator({parentToken:Object(o.e)(),mountPoint:s.a},{onTasksAdded:this.onTasksAdded.bind(this),onTaskSuccess:this.onTaskSuccess.bind(this),onTaskError:this.onTaskError.bind(this),onComplete:this.onComplete.bind(this),onFileProgress:this.onFileProgress.bind(this)}),this.createFileController()}return i()(t,[{key:"startUpload",value:function(){var e=this.file.event;this.handleTeaLog({status:"start_upload"}),this.driveUploader.addFile(this.file,e)}},{key:"onTasksAdded",value:function(){this.driveUploader.upload()}},{key:"onTaskSuccess",value:function(e){this.isDone=!0;var t=e.fileToken;this.updateFileController(t),this.handleUploadEnd(this.id),this.handleTeaLog({status:"success"})}},{key:"onTaskError",value:function(e){this.isDone=!0,this.canceled||Object(u.g)("".concat(this.file.name.substring(0,10)," ").concat(n("mention.uploader_failure"))),this.deleteFileController(),this.handleTeaLog({status:"fail"}),this.handleUploadEnd(this.id)}},{key:"onComplete",value:function(){}},{key:"onFileProgress",value:function(){var e=this.driveUploader.progress,e=Math.round(100*e);this.progress!==e&&(this.progress=e,l.a.emit(s.b,e,this.id))}},{key:"cancelUpload",value:function(){this.canceled=!0,this.driveUploader.cancelAll(),this.isDone=!0,this.handleUploadEnd(this.id),this.handleTeaLog({status:"cancel"})}},{key:"createFileController",value:function(){var e=this.file,t=Object(o.d)();this.fileController=new c.a(this.id,{editorInfo:this.editorInfo}),this.fileController.insertPlaceholder(e,{uploadOwner:t,atUuid:e.atUuid})}},{key:"updateFileController",value:function(e){e&&this.fileController.updateDriveKey(e)}},{key:"deleteFileController",value:function(){this.fileController.deleteFileCard()}},{key:"handleTeaLog",value:function(e){var t=this.file,n=e.status,r=t.source,i=r===s.i.DRAG?"mention_drag_upload":"client_uploader_file",o=t.name.split(".").pop()||"unknown";Object(a.default)(i,{upload_status:n||"fail",mention_file_length:t.size,mention_file_type:o,create_source:r})}},{key:"isUploading",get:function(){return this.driveUploader.isUploading}}]),t}()}).call(this,h("2vAP"))},"2IHA":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s});var r,i,o,u=n("gSGL"),l=n("D1oa"),d=Boolean(window.crypto&&window.crypto.subtle);function a(o,a,s,c){return new Promise(function(e,t){var n,r,i;d?(n=window.crypto.subtle,r=Object(u.a)(a)?Object(l.c)(a):a,i=Object(u.a)(s)?Object(l.c)(s):s,n.importKey("raw",r,c,!1,["decrypt"]).then(function(e){return n.decrypt({name:c,iv:i,tagLength:128},e,o)}).then(e).catch(t)):t(new Error("web crypto not support for decrypt"))})}function s(i,o){return new Promise(function(e,t){var n,r;d?(n=window.crypto.subtle,r=Object(u.a)(i)?Object(l.c)(i):i,n.digest(o,r).then(e)):t(new Error("web crypto not support for digest"))})}(i=r=r||{})["AES-GCM"]="AES-GCM",i["AES-CBC"]="AES-CBC",(o=o||{})["SHA-256"]="SHA-256"},"3EEQ":function(e,t,n){"use strict";n.r(t);var r=n("pVnL"),o=n.n(r),i=n("lwsE"),a=n.n(i),s=n("q1tI"),c=n.n(s),u=n("i8i4"),l=n.n(u),d=n("W8MJ"),f=n.n(d),h=n("a1gu"),p=n.n(h),g=n("Nsbk"),m=n.n(g),v=n("7W2i"),b=n.n(v),y=(n("xD9Q"),n("Si88")),k=n.n(y),O=(n("17x9"),function(e){function n(e){var t;return a()(this,n),(t=p()(this,m()(n).call(this,e))).handleVisibilityChange=function(){"visible"===document.visibilityState&&t.exit()},t.close=function(){t.setState({show:!1})},t.exit=function(){t.props.onExited()},t.state=Object.assign({},e,{show:!0}),document.addEventListener("visibilitychange",t.handleVisibilityChange),t}return b()(n,e),f()(n,[{key:"componentWillUnmount",value:function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)}},{key:"render",value:function(){var e=this.state,t=e.style,n=e.component,r=e.show,i=e.className,o=this.props,a=o.handlePopOverEnter,s=o.handlePopOverLeave;return c.a.createElement(k.a,{in:r,timeout:250,className:"mention-popover comment-ignore-blur ".concat(i),classNames:"popover-fade",onExited:this.props.onExited},c.a.createElement("section",{style:t,onMouseEnter:a,onMouseLeave:s},n))}}]),n}(s.Component)),E=n("VI6H");n.d(t,"default",function(){return C});var C=function e(t){a()(this,e);var n=t.container,r=document.createElement("div");function i(){l.a.unmountComponentAtNode(r),n.removeChild(r)}return Object(E.x)()&&n===document.body&&(r.style.position="absolute",r.style.top=0,r.style.left=0),n.appendChild(r),l.a.render(c.a.createElement(O,o()({},t,{onExited:i})),r)}},"3VXv":function(e,t,n){"use strict";n.d(t,"a",function(){return Container}),n.d(t,"b",function(){return Text});var r=n("VkAN"),i=n.n(r),o=n("vOnD"),a=n("MjSh");function s(){var e=i()(["\n  margin-top: 7px;\n  color: ",";\n  font-size: 12px;\n  line-height: 1;\n"]);return s=function(){return e},e}function c(){var e=i()(["\n  background-color: ",";\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]);return c=function(){return e},e}var Container=o.default.div(c(),a.N00),Text=o.default.div(s(),a.N600)},"3ftV":function(e,t,n){"use strict";var o=n("G3A0"),a=n("fywt"),s=n("fshX"),c=Math.max,u=Math.min;function r(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=Object(s.a)(n),i=n<0?c(r+i,0):u(i,r-1)),Object(o.a)(e,Object(a.a)(t,3),i,!0)}t.a=r},"3xnr":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="outer-placeholder-container"},"46iY":function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return k});var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),u=n("q1tI"),l=n.n(u),d=n("YNKm"),f=n("YWBl"),h=n("7Kxq"),p=n("F9bh"),g=n("y2sV"),m=n("OWch"),v=n("Nl7c"),b=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},y="IGNORE_ITALIC",k=function(){function t(e){var n=this;i()(this,t),this.editor=e,this.className="Italic",this.aceInitialized=function(e,t){n.init(t.editorInfo)},this.aceAttribsToClasses=function(e,t){if("italic"===t.key)return["tag:i"]},this.editor=e,this.init(e)}return a()(t,[{key:"init",value:function(e){var a=this;e.commands.registerAceCommand(d.M,function(e,t,n,r){var i=r.source,o=a.toggleAttribute({attribKey:"italic",attribValue:!0});Object(f.a)({action:"italic",op:o?h.g:h.f,source:i})},{statusKey:"italic-true"})}},{key:"toggleAttribute",value:function(e){var t=e.attribKey,n=e.attribValue,r=e.range,i=e.isSpecialSelection,o=e.isAllHasAttrib,a=r.selStart,s=r.selEnd,c=r.attributeManager;return i?(c.setAttributesOnRange(a,s,[[t,o?"":n]]),o):this.editor.toggleAttributeOnSelection(t,r,n)}},{key:"serialize",value:function(e){return Object(g.P)(e,{tagAttribute:d.M,wrapTag:g.a[d.M]})}},{key:"match",value:function(e){return"italic"===e}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,r=e.zoneId;if(t instanceof HTMLElement){var i=t.tagName,o=t.getAttribute("style")||"";if("I"===i||"EM"===i||/\bfont-style:\s*italic\b/i.test(o))return Object(g.H)(n,r,{italic:"true"})}return n}},{key:"render",value:function(e){var t=e.children;return l.a.createElement(g.w,{style:{fontStyle:"italic"}},t)}}]),t}();b([Object(p.a)()],k.prototype,"toggleAttribute",null),b([m.a,Object(v.b)()],k.prototype,"render",null)},"4TP3":function(e,t,n){"use strict";var r=n("LV2V"),i=n("qMRW"),o=Object(r.a)(i.a);t.a=o},"4d5w":function(e,i,o){"use strict";(function(h){o.d(i,"a",function(){return r});var e=o("lwsE"),p=o.n(e),t=o("W8MJ"),n=o.n(t),g=o("TJya"),m=o("VIFs"),v=o("1I8I"),b=o("OX8E"),y=o("VN5G"),k=o("lQZd"),O=o("96li"),E=o("TfC2"),C=o("n/R6"),I=o("nN3d"),S=o("8wh8"),j=o("2ACu"),T=o("1dfU"),w=20971520,r=function(){function f(e){var t,a=this,n=e.editor,r=e.commentId,i=e.replyId,o=e.uniqueId,s=e.currentImageCount,c=void 0===s?0:s;p()(this,f),this.handleSelectImage=function(e){e===a.uniqueId&&a.uploader.open()},this.handleImageChange=function(e){var t=e.uniqueId,n=e.imageList;t===a.uniqueId&&(a.currentImageCount=n.length)},this.handleImageReset=function(e){e.uniqueId===a.uniqueId&&(a.currentImageCount=0,a.replyId=void 0,Object(v.b)(a.uniqueId))},this.beforeFileQueued=function(e){return a.currentImageCount>=E.f?(C.a.error({duration:3e3,content:h("comment.image.limited_count",E.f)}),!1):!(e.size>w)||(C.a.error({duration:3e3,content:h("etherpad.upload_failed_than_size")}),!1)},this.fileQueued=function(e){a.replyId?e.comment={replyId:a.replyId,uniqueId:a.uniqueId}:e.comment={commentId:a.commentId,commentService:a.commentService,uniqueId:a.uniqueId};var t=e.uuid=Object(I.a)();a.currentImageCount++,b.a.trigger("CommentTextareaImageAdd",[{uniqueId:a.uniqueId,imageItem:{src:URL.createObjectURL(e.source.source),percentage:1,status:O.a.UPLOADING,uid:t}}]),Object(j.default)("client_comment",{action:"upload_image",upload_image_type:"paste"===e.source.logSource?"upload_from_paste":"upload_from_file"})},this.uploadStart=function(e){var t="/api/box/stream/upload/all/";a.uploader.option("server",Object(m.prependAPI)(t)),a.uploader.option("formDataAsQuery",!0)},this.uploadBeforeSend=function(e,t,n,r){var i=e.file;if(!(i.comment&&i.comment.replyId||a.replyId))throw new Error("CommentImage: No replyId.");a.replyId=a.replyId||i.comment.replyId,Object.assign(n,Object(g.a)()),Object.assign(t,{mount_node_token:a.replyId,mount_point:"comment_image","ext[route_key]":Object(k.g)()}),i.uploadStartTime=(new Date).getTime()},this.uploadProgress=function(e,t){100===(t=Math.round(100*t))&&(t=99),b.a.trigger("CommentTextareaImageProgress",[{uniqueId:a.uniqueId,percentage:t,uid:e.uuid}])},this.uploadSuccess=function(e,t){var n;t&&0===t.code?(n=t.data.file_token,b.a.trigger("CommentTextareaImageProgress",[{uniqueId:a.uniqueId,percentage:100,uid:e.uuid,token:n,replyId:e.comment.replyId}]),Object(S.a)()[n]=URL.createObjectURL(e.source.source),Object(j.default)("dev_comment_image",{comment_id:a.commentId?Object(T.a)(a.commentId):"",status:"uploadSuccess",image_token:Object(T.a)(n),duration:(new Date).getTime()-e.uploadStartTime})):(b.a.trigger("CommentTextareaImageProgress",[{uniqueId:a.uniqueId,percentage:-1,uid:e.uuid,replyId:e.comment.replyId}]),Object(j.default)("dev_comment_image",{comment_id:a.commentId?Object(T.a)(a.commentId):"",status:"uploadFailed",reason:JSON.stringify(t||"")}),console.error("CommentImage: ",t))},this.uploadError=function(e,t){b.a.trigger("CommentTextareaImageProgress",[{uniqueId:a.uniqueId,percentage:-1,uid:e.uuid,replyId:e.comment.replyId}]),Object(j.default)("dev_comment_image",{comment_id:a.commentId?Object(T.a)(a.commentId):"",status:"uploadFailed",reason:t}),console.error("CommentImage: "+t)},this.acePaste=function(e,t){var n,r,i,o=t.purifiedHtml;o&&((n=document.createElement("div")).innerHTML=o,i=null,(r=n.querySelector(".gallery"))?i=a.getGalleryImageData(r):1===n.children.length&&n.children[0]instanceof HTMLTableElement&&"byte-sheet"===n.children[0].getAttribute("data-type")&&(i=a.getSheetImageData(n.children[0])),i&&a.getFileByUrl(i.src,i.mime,function(e){e&&a.uploader.addFiles(e)}))},r&&-1<r.indexOf(":")?-1===(t=r.split(":")[2]).indexOf("-")&&(this.commentId=t):r&&-1===r.indexOf("-")&&(this.commentId=r),this.replyId=i,this.uniqueId=o,this.currentImageCount=c,this.uploader=Object(v.a)({editorInfo:n},o),f.UPLOADER_EVENTS.forEach(function(e){a.uploader.on(f.UPLOADER_EXTENSIONS,e,a[e])}),b.a.on("CommentTextareaSelectImage",this.handleSelectImage),b.a.on("CommentTextareaImageChange",this.handleImageChange),b.a.on("CommentTextareaImageReset",this.handleImageReset);var u=Object(k.g)(),l=Object(k.l)(),d=Object(y.a)(l,u);this.commentService=d}return n()(f,[{key:"getGalleryImageData",value:function(e){var t=e.getAttribute("data-ace-gallery-json"),n=t?JSON.parse(t):null;if(!n.items||!n.items[0])return null;var r=e.querySelector("img");return r?{src:r.src,mime:n.items[0].image_type}:null}},{key:"getSheetImageData",value:function(e){var t=e.querySelectorAll("td[data-sheet-value]");if(0===t.length)return null;var n=Array.from(t).find(function(e){var t=e.getAttribute("data-sheet-value"),n=t?JSON.parse(t):null;return!!(n&&n.some&&n.some(function(e){return"embed-image"===e.type}))});if(!n)return null;var r=n.querySelector("img");return r?{src:r.src}:null}},{key:"getFileByUrl",value:function(e,c,u){var l=document.createElement("canvas"),d=l.getContext("2d"),f=new Image;f.src=e,f.onload=function(){var e;l.width=f.width,l.height=f.height,d&&d.drawImage(f,0,0);try{e=l.toDataURL(c)}catch(e){return"SecurityError"===e.name&&C.a.error({duration:3e3,content:h("common.paste_image_failed")}),console.error("CommentImage: "+e),void(u&&u(null))}var t=e.split(","),n=t[0].match(/:(.*?);/);if(n){for(var r=n[1],i=atob(t[1]),o=i.length,a=new Uint8Array(o);o--;)a[o]=i.charCodeAt(o);var s=new Blob([a],{type:r});s&&u&&u(s)}else u&&u(null)},f.onerror=function(e){console.error("CommentImage: "+e),u&&u(null)}}},{key:"destroy",value:function(){var t=this;f.UPLOADER_EVENTS.forEach(function(e){t.uploader.off(f.UPLOADER_EXTENSIONS,e,t[e])}),Object(v.c)(this.uniqueId),b.a.off("CommentTextareaSelectImage",this.handleSelectImage),b.a.off("CommentTextareaImageChange",this.handleImageChange),b.a.off("CommentTextareaImageReset",this.handleImageReset)}}]),f}();r.UPLOADER_EVENTS=["beforeFileQueued","fileQueued","uploadStart","uploadProgress","uploadSuccess","uploadError","uploadBeforeSend"],r.UPLOADER_EXTENSIONS="gif,jpg,jpeg,bmp,png"}).call(this,o("2vAP"))},"4fRq":function(e,t){var n,r,i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);i?(n=new Uint8Array(16),e.exports=function(){return i(n),n}):(r=new Array(16),e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r})},"4qD0":function(e,t,n){"use strict";var s=n("vzE1"),r=n("a0eB"),c=/^\d+$/;function i(n){return n.sort().filter(function(e,t){return JSON.stringify(e)!==JSON.stringify(n[t-1])})}t.parse=function(e){return i(e.split(",").map(function(e){var a={};return e.trim().split(/\s+/).forEach(function(e,t){if(0===t)return a.url=e;var n=e.substring(0,e.length-1),r=e[e.length-1],i=parseInt(n,10),o=parseFloat(n);if("w"===r&&c.test(n))a.width=i;else if("h"===r&&c.test(n))a.height=i;else{if("x"!==r||s(o))throw new Error("Invalid srcset descriptor: "+e+".");a.density=o}}),a}))},t.stringify=function(e){return r(e.map(function(e){if(!e.url)throw new Error("URL is required.");var t=[e.url];return e.width&&t.push(e.width+"w"),e.height&&t.push(e.height+"h"),e.density&&t.push(e.density+"x"),t.join(" ")})).join(", ")}},"6AXZ":function(e,t,r){"use strict";r.d(t,"b",function(){return o});var i={},n=null;function o(){return n=n||new Promise(function(n,t){r.e("iframe_images").then(r.bind(null,"t4nh")).then(function(e){var t=e.default;Object.keys(t).forEach(function(e){return i[e]=t[e]}),n()},function(e){console.error("load iframe image error",e),t()})})}t.a=i},"6Do3":function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n("o0o1"),a=n.n(r),i=n("pVnL"),s=n.n(i),o=n("yXPU"),c=n.n(o),u=n("q1tI"),l=n.n(u),d=n("i8i4"),f=n.n(d),h=n("D7h9"),p=n("pf04"),g=null;function m(e){return v.apply(this,arguments)}function v(){return(v=c()(a.a.mark(function e(t){var n,r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=function(e){f.a.unmountComponentAtNode(r),t.onClose&&t.onClose(e)},g){e.next=5;break}return e.next=4,Object(p.a)();case 4:g=e.sent.default;case 5:return n=t.boxContainer,r=document.createElement("div"),n.appendChild(r),i=Object.assign({},t,{store:h.default,onClose:o}),e.abrupt("return",new Promise(function(t){var n;f.a.render(l.a.createElement(g,s()({ref:function(e){e&&e.getWrappedInstance&&(n=e.getWrappedInstance()),t(n)}},i)),r)}));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}},"6dGb":function(e,t,n){"use strict";var r=n("pVnL"),i=n.n(r),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",i()({width:"20",height:"20",viewBox:"0 0 20 20"},t),c.a.createElement("path",{d:"M10 8.59l1.41-1.42a1 1 0 111.42 1.42L11.4 10l1.42 1.41a1 1 0 11-1.42 1.42L10 11.4l-1.41 1.42a1 1 0 01-1.42-1.42L8.6 10 7.17 8.59A1 1 0 118.6 7.17L10 8.6zM10 20a10 10 0 110-20 10 10 0 010 20zm0-2a8 8 0 100-16 8 8 0 000 16z",fillRule:"nonzero",fill:"#424E5D"}))}},"6jHd":function(e,t,n){"use strict";var r=n("pVnL"),i=n.n(r),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",i()({width:"62",height:"62",xmlnsXlink:"http://www.w3.org/1999/xlink"},t),c.a.createElement("defs",null,c.a.createElement("path",{id:"404ac0689f14bedd562f636044c5a684-a",d:"M.86 48.9h51.12V.53H.86z"})),c.a.createElement("g",{transform:"translate(8 8)",fill:"none",fillRule:"evenodd"},c.a.createElement("path",{fill:"#D6DAE1",d:"M.86 41.37h43.18V6.07H.86z"}),c.a.createElement("path",{fill:"#F4F5F9",d:"M37.9 15.04l-3.77 24.24-29.66-4.6 3.77-24.25z"}),c.a.createElement("path",{stroke:"#FFF",strokeWidth:".79",strokeLinecap:"round",strokeLinejoin:"round",d:"M10.85 32.14l2.26-17.51m.69 18.17l2.25-17.52"}),c.a.createElement("path",{d:"M51.64 35.94a15.18 15.18 0 11-30.08-4.1 15.18 15.18 0 0130.08 4.1",fill:"#FFDDDB"}),c.a.createElement("path",{d:"M30.67 27.96l11.57 11.57m0-11.57L30.67 39.53",stroke:"#EE5050",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:".71"}),c.a.createElement("mask",{id:"404ac0689f14bedd562f636044c5a684-b",fill:"#fff"},c.a.createElement("use",{xlinkHref:"#404ac0689f14bedd562f636044c5a684-a"})),c.a.createElement("path",{fill:"#B5BEC8",mask:"url(#404ac0689f14bedd562f636044c5a684-b)",d:"M.86 6.32h12.9V.54H.86z"})))}},"7Kxq":function(e,t,n){"use strict";n.d(t,"f",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"e",function(){return u});var r=n("jSUa");n.d(t,"b",function(){return r.a});var i="effective",o="cancel",a="at-uuid_",s="horizontal-line",c=["author","lmkr","lineguid","insertorder"],u={ACE_TABLE:"ACE_TABLE",CODE_BLOCK:"CODE_BLOCK",CALLOUT:"CALLOUT"}},"7P1s":function(e,t,n){"use strict";n.d(t,"a",function(){return u});var o,r=n("lwsE"),i=n.n(r),a=n("W8MJ"),s=n.n(a),c=function(){function e(){i()(this,e),this.delegateHandlersMap={},this.eventHandlerMap={},this.eventOptionMap={},this.id=0}return s()(e,[{key:"genUuid",value:function(){return++this.id}},{key:"delegate",value:function(e,t,n,r){var i={parentSelector:e,childSelector:t,event:n,handler:r,options:4<arguments.length&&void 0!==arguments[4]?arguments[4]:{}},o=this.getEventPath(i),a=this.eventHandlerMap[o],s=this.addHandler(i);return a||this.initEventListener(i),this.removeHandler.bind(this,i,s)}},{key:"initEventListener",value:function(e){var t,n,r=e.parentSelector,i=e.event,o=e.options,a=void 0===o?{}:o,s=document.querySelector(r);s&&(t=this.getEventPath(e),n=this.getEventHandler(e),Object.assign(a,{capture:!0}),this.eventOptionMap[t]=a,s.addEventListener(i,n,a),this.eventHandlerMap[t]=n)}},{key:"getEventHandler",value:function(e){var a=this,s=this.getEventPath(e);return function(t){var e,n=t&&t.target;for(e in a.delegateHandlersMap){var r=e.startsWith(s),i=e.slice(s.length),o=i&&n.matches&&n.matches(i);if(r&&o)return void a.delegateHandlersMap[e].map(function(e){return e&&e.handler}).forEach(function(e){return e&&e(t)})}}}},{key:"addHandler",value:function(e){var t=e.handler,n=this.getDelegatePath(e),r=this.delegateHandlersMap[n]||[],i=this.genUuid();return r.push({id:i,handler:t}),this.delegateHandlersMap[n]=r,i}},{key:"removeHandler",value:function(e,t){var n=this.getDelegatePath(e),r=this.getEventPath(e),i=this.delegateHandlersMap[n];this.delegateHandlersMap[n]=i.filter(function(e){return e.id!==t}),this.isHandlersEmpty(r)&&this.removeEventHandler(e)}},{key:"isHandlersEmpty",value:function(e){if(!e)return!1;var t,n=!0;for(t in this.delegateHandlersMap){var r=this.delegateHandlersMap[t]||[];if(t.startsWith(e)&&0<r.length){n=!1;break}}return n}},{key:"removeEventHandler",value:function(e){var t,n=e.parentSelector,r=e.event,i=this.getEventPath(e),o=this.eventHandlerMap[i],a=document.querySelector(n);a&&o&&(t=this.eventOptionMap[i],a.removeEventListener(r,o,t),this.eventHandlerMap[i]=null,this.eventOptionMap[i]={})}},{key:"getDelegatePath",value:function(e){var t=e.parentSelector,n=e.childSelector;return[t,e.event,n].join("")}},{key:"getEventPath",value:function(e){return[e.parentSelector,e.event].join("")}}]),e}(),u=function(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{};return(o=o||new c).delegate(e,t,n,r,i)}},"7lqQ":function(e,t,n){},"8mZy":function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"i",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"d",function(){return h}),n.d(t,"e",function(){return p}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return m});var s,r,i=n("lSNA"),c=n.n(i),u=n("jp/M"),l=n("QM+C");(r=s=s||{}).Issue="issue",r.Filter="filter";var o=function(e){var t=e.type,n=e.blockToken,r=e.visibleFieldIds,i=e.teaSource,o=e.authState,a=e.baseUrl;return c()({type:u.actionTypes.jira.FETCH_SYNC_JIRA,payload:{type:t,blockToken:n,visibleFieldIds:r,teaSource:i,authState:o,baseUrl:a}},l.REQUEST,{url:t===s.Issue?u.apiUrls.JIRA_ISSUE_SYNC:u.apiUrls.JIRA_FILTER_SYNC,method:u.apiUrls.METHOD.POST,data:{issueID:"",blockToken:n,visibleFieldIds:r}})},a=function(e){return c()({type:u.actionTypes.jira.FETCH_JIRA_ISSUE_INIT_DATA},l.REQUEST,{url:u.apiUrls.JIRA_ISSUE_GET_BY_URL,method:u.apiUrls.METHOD.GET,params:{url:e}})},d=function(){return c()({type:u.actionTypes.jira.FETCH_JIRA_AUTH_STATUS},l.REQUEST,{url:u.apiUrls.FETCH_JIRA_AUTH_STATUS,method:u.apiUrls.METHOD.POST})},f=function(){return{type:u.actionTypes.jira.FETCH_JIRA_AUTH_STATUS_FAIL,payload:{}}},h=function(e){return{type:u.actionTypes.jira.FAKE_SYNC_JIRA_START,payload:{blockToken:e}}},p=function(e){return{type:u.actionTypes.jira.FAKE_SYNC_JIRA_SUCCESS,payload:{blockToken:e}}},g=function(e){return{type:u.actionTypes.jira.FAKE_SYNC_JIRA_FAIL,payload:{blockToken:e}}},m=function(e){return{type:u.actionTypes.jira.FAKE_SYNC_JIRA_END,payload:{blockToken:e}}}},"8wYP":function(e,t,n){"use strict";n.d(t,"c",function(){return x}),n.d(t,"d",function(){return L}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return a});var r=n("qAkX"),M="lmkr";function x(e,t){var n=t.numToAttrib;return e.map(function(e){var t=parseInt(e,36);return n[t]||[]})}function L(e,t){var i=t.numToAttrib;return e.reduce(function(e,t){var n=parseInt(t,36),r=i[n];return r&&(e[r[0]]=r[1]),e},{})}function i(e){return e.reduce(function(e,t){return e[t[0]]=t[1],e},{})}function o(e){for(var t=e.changesetHelper,n=e.rep,r=e.selStart,i=e.selEnd,o=e.retainLineMarker,a=void 0!==o&&o,s=n.alines,c=n.lines,u=n.apool,r=r||[0,0],i=i||[s.length-1,c.atIndex(s.length-1).text.length],l=r[0],d=i[0],f=[],h=l;h<=d;h++){for(var p=t.opIterator(s[h]),g=c.atIndex(h),m=h===r[0],v=h===i[0],b=m?r[1]:0,y=v?i[1]:g.text.length,k=0;p.hasNext();){var O=p.next(),E=O.chars,C=O.attribs;if(!((k+=E)<=b)){var I=[h,b],S=void 0,S=y<k?[h,y]:[h,k],j=g.text.slice(b,S[1]),b=k,T=C.split("*").slice(1),w=x(T,u),_=L(T,u);if(!a&&_[M]||f.push({selStart:I,selEnd:S,text:j,attributes:w,attribsNum:T}),y<=b)break}}h!==d&&y===g.text.length&&f.push({selStart:[h,y],selEnd:[h,y],text:"\n",attributes:[],attribsNum:[]})}return f}function a(e,t){var n;return e.hooks&&(n=e.hooks.callAll("collectText",{attributes:t.attributes})),n&&n.length?Object(r.a)(n):t.text}},"9g7G":function(e,ie,oe){"use strict";(function(r){oe.d(ie,"j",function(){return R}),oe.d(ie,"i",function(){return P}),oe.d(ie,"k",function(){return D}),oe.d(ie,"l",function(){return U}),oe.d(ie,"f",function(){return K}),oe.d(ie,"b",function(){return q}),oe.d(ie,"e",function(){return X}),oe.d(ie,"a",function(){return Y}),oe.d(ie,"g",function(){return $}),oe.d(ie,"c",function(){return te}),oe.d(ie,"d",function(){return ne}),oe.d(ie,"h",function(){return re});var i,n,e=oe("o0o1"),u=oe.n(e),t=oe("yXPU"),o=oe.n(t),a=oe("hMnB"),s=oe.n(a),c=oe("HmyT"),l=oe("toa8"),d=oe("1dfU"),f=(oe("iP/4"),oe("AiBH")),h=oe("jp/M"),p=oe("QM+C"),g=oe("mRaX"),m=oe("duSr"),v=oe("hbEN"),b=oe("OZf9"),y=oe("7EGn"),k=oe("vEhQ"),O=oe("m8R6"),E=oe("HA5h"),C=oe("kUgE"),I=oe("HIeq"),S=oe("FnDM"),j=oe("gfe6"),T=oe("lQZd"),w=oe("U6jp"),_=oe("s+vT"),M={},x={},L=30,N={0:"users",1:"notes",3:"notes",5:"chats",6:"groups",8:"notes",11:"notes",12:"notes",15:"notes"},R=function(){var e=Object(w.k)(s.a.href);return e===w.b.ANNOUNCE||e===w.b.FEED};function P(e){var t=c.$.Deferred(),n=Object(m.b)()?"v3":"v2";return i&&i.abort(),(i=l.d.post("/api/mention/recommend.".concat(n,"/"),e,{timeout:1e4,headers:{"Cache-Control":"no-cache,no-store"}})).then(function(d){Object(b.a)(d.data.result_list,function(e){var t,n=e.type,r=e.token,i=parseInt(n),o=N[i];o||(t=f.y[1],d={data:{result_list:[]},message:t});var a=d.data.entities[o][r],s=a.title,c=a.name,u=a.avatar_url;[f.E.SHEET,f.E.FILE,f.E.BITABLE,f.E.BOX,f.E.MINDNOTE,f.E.SLIDE].includes(i)&&(e.content=s||Object(C.getUnnamedTitle)(i)),i===f.E.USER&&(e.content=Object(g.J)(r,d.data.entities.users),e.url=u),i!==f.E.CHAT&&i!==f.E.GROUP||(e.content=c,e.url=u);var l=Object(O.default)(a,["id","title","name","cn_name","en_name","avatar_url"]);Object(E.a)(e,l)}),t.resolve(d)}).catch(function(e){return h.error.STATUS_CODE.CONNECT_ABORT===e.code?t.reject(e):(e={data:{result_list:[]},message:h.error.STATUS_CODE.TIMEOUT!==e.code&&Object(j.c)()?f.y[e.code]:r("etherpad.network_abnormal")},void t.resolve(e))}),t.abort=i.abort.bind(i),t}function D(e){var t=e.chatId,n=e.invitor,r=Object(T.g)();return l.d.post("/api/mention/join.chat/",{token:r,chat_id:t,invitor:n})}function U(e){return l.d.post("/api/mention/join.chat.v2/",{share_token:e})}var F,z=function(e){var t=+new Date;return L<(t-e)/1e3},B=function(e){var t=e.content,n=e.type,r=+new Date+3e4,i=void 0===t||""===t?"All":t,o=e.index_info||"",a=Object(y.default)(M,"".concat(n,".").concat(i,".").concat(o,".result")),s=Object(T.g)(),c=Object(y.default)(M,"".concat(n,".").concat(i,".").concat(o,".fileToken")),u=Object(y.default)(M,"".concat(n,".").concat(i,".").concat(o,".time"),r);return a&&!z(u)&&s===c?a:null},H=!1,W=Object(v.default)(K,400),V=Object(v.default)(X,400);function K(r,i){var o=Object(T.g)();H=!1;var e=P(r);return e.then(function(e){var t,n;Object(y.default)(e,"data.result_list")&&(t=void 0===r.content||""===r.content?"All":r.content,n=r.index_info||"",Object(k.a)(M,"".concat(r.type,".").concat(t,".").concat(n),{time:+new Date,result:e,fileToken:o})),H||i(e)}),Object.assign({},e,{},W)}var q=function(e,t){var n=B(e);return n?(F&&(F.abort(),F.cancel()),H=!0,t(n),{abort:function(){}}):F=W(e,t)};function Z(e){var t=c.$.Deferred();return n&&n.abort(),(n=l.d.post(h.apiUrls.JIRA_ISSUE_SEARCH,e,{timeout:1e4})).then(function(e){t.resolve(e)}).catch(function(e){return h.error.STATUS_CODE.CONNECT_ABORT===e.code?t.reject(e):(e={data:{result_list:[]},message:h.error.STATUS_CODE.TIMEOUT!==e.code&&Object(j.c)()?f.y[e.code]||e.msg:r("etherpad.network_abnormal"),code:e.code},void t.resolve(e))}),t.abort=n.abort.bind(n),t}var Q,J=function(e){var t=e.keyword,n=+new Date+3e4,r=void 0===t||""===t?"RECENT":t,i=Object(y.default)(x,"".concat(r,".result")),o=Object(y.default)(x,"".concat(r,".time"),n);return i&&!z(o)?i:null};function X(n,r){H=!1;var e=Z(n);return e.then(function(e){var t;Object(y.default)(e,"data.issues.length")&&(t=void 0===n.keyword||""===n.keyword?"RECENT":n.keyword,Object(k.a)(x,"".concat(t),{time:+new Date,result:e})),H||r(e)}),Object.assign({},e,{},V)}var Y=function(e,t){var n=J(e);return n?(Q&&(Q.abort(),Q.cancel()),H=!0,t(n),{abort:function(){}}):Q=V(e,t)};function $(e,t,n){return ee.apply(this,arguments)}function ee(){return(ee=o()(u.a.mark(function e(t,n,r){var i,o,a,s,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||Object(I.e)(),i=Object(d.a)(t),o=Object(d.a)(r),a=Object(_.a)(),s={interactor:"lark & docs",caller:Object(S.i)().module,interface_name:"/im/gateway 5017 & /api/mention/user.detail.v2",request_id:a,interface_data:JSON.stringify({cryptToken:o,cryptUserId:i})},e.next=7,Promise.all([oe.e("doc_index_css"),oe.e("chunk_adit"),oe.e("commons--doc_index_delay--voteEmoji--votePicker"),oe.e(16),oe.e("commons--doc_index_delay--jira"),oe.e("doc_index_delay")]).then(oe.bind(null,"ZwLK"));case 7:return c=e.sent,e.abrupt("return",c.fetchUserInfo(t,n,r,s));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function te(e){var t={share_tokens:e,source:f.z.DOC,obj_type:h.common.NUM_SUITE_TYPE.DOC,obj_token:Object(T.g)()};return l.d.post("/api/mention/chat.info.v3/",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function ne(e){var t=e.type,n=e.token;return l.d.get(h.apiUrls.GET_META,{params:{type:p.mapFileType2TypeNum[t],token:n}})}function re(e){var t={chat_id:e,obj_token:Object(T.g)(),obj_type:h.common.NUM_SUITE_TYPE.DOC};return l.d.post("/api/mention/sharetoken/create/",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}).call(this,oe("2vAP"))},"9h4r":function(e,p,g){"use strict";(function(Q){var e=g("pVnL"),J=g.n(e),t=g("lwsE"),i=g.n(t),n=g("W8MJ"),o=g.n(n),X=g("3Hq1"),r=g("q1tI"),Y=g.n(r),$=g("3EEQ"),ee=g("D0c4"),te=g("GGpJ"),ne=g("HmyT"),re=g("mRaX"),ie=g("AiBH"),a=g("OZf9"),s=g("wq9/"),c=g("7P1s"),u=g("D7h9"),oe=g("iP/4"),ae=g("/fVd"),se=g("VI6H"),ce=g("lQZd"),ue=g("EQyw"),le=g("rLED"),l=100,d=500,de=384,fe=600,he=110,pe=48,f=function(){function r(e){i()(this,r);var t=e.e,n=e.editor;this.clientY=t.clientY,this.dom=t.target,this.$dom=Object(ne.$)(t.target),this.editor=n,this.mentionInfoReader=this._createMentionInfoReader(e,this.$dom)}return o()(r,[{key:"_createMentionInfoReader",value:function(e,t){if(e.createMentionInfoReader)return e.createMentionInfoReader(t);var n=t.prop("className");return{getType:function(){return parseInt(Object(re.K)(n,"mention-type"))},getToken:function(){return Object(re.K)(n,"mention-token")||t.attr("token")||t.data("token")},getLink:function(){return decodeURIComponent(Object(re.K)(n,"mention-link"))},getTitle:function(){return t.get(0).textContent}}}},{key:"getDom",value:function(){return this.dom}},{key:"getRect",value:function(){var e=Object(s.a)(this.dom,this.editor);return Object(re.y)(this.dom,this.clientY,e)}},{key:"getLineHeight",value:function(){return Number.parseInt(getComputedStyle(this.$dom.get(0))["line-height"])}},{key:"canShowPopover",value:function(){return this.$dom.parents("body").length&&!this.$dom.hasClass("popover-disabled")}},{key:"hasNoPermission",value:function(){return!!this.$dom.children("a").hasClass("content-with-lock")}},{key:"isGrantViewAccessDisabled",value:function(){return this.$dom.hasClass("grant-view-access-disabled")}},{key:"getType",value:function(){return this.mentionInfoReader.getType()}},{key:"getToken",value:function(){return this.mentionInfoReader.getToken()}},{key:"getTitle",value:function(){return this.mentionInfoReader.getTitle()}},{key:"getLink",value:function(){return this.mentionInfoReader.getLink()}},{key:"getUserName",value:function(){return this.$dom.data("user-name")}},{key:"isInComment",value:function(){return this.$dom.parent().hasClass("comment-list-item__content")}},{key:"getSourceData",value:function(){return Object(re.B)(this.$dom)}},{key:"getFallbackBoxContainer",value:function(){return this.$dom.closest(".innerdocbody").parent()}},{key:"isSameAs",value:function(e){return e instanceof r&&this.getDom()===e.getDom()}}]),r}(),h=function(){function t(e){var Z=this;i()(this,t),this.getSelectors=function(){if(Z.selectors)return Z.selectors;var e=[".mention-type_0",".mention"],n=".popover,.mention-popover,.larkw-lark-user-card__action-modal__wrapper,.guide-onboarding-spot",t=Z.props.hoverArea,r=void 0===t?".innerdocbody":t,i=[],o=[];return Object(a.a)(r.split(","),function(t){Object(a.a)(e,function(e){i.push("".concat(t," ").concat(e))}),Object(a.a)(n.split(","),function(e){o.push("".concat(t," ").concat(e))})}),i=i.join(","),o=o.join(","),Z.selectors={mentionClsWithHoverArea:i,popoverCls:n},Z.selectors},this.setMouseMoved=function(){Z.isMouseMoved=!0,Z.setMouseMoveTimeout&&clearTimeout(Z.setMouseMoveTimeout),Z.setMouseMoveTimeout=setTimeout(function(){Z.isMouseMoved=!1},40),Z.checkIfHidePopover()},this.clearHideTimeout=function(e){Z.hoverTimeout&&clearTimeout(Z.hoverTimeout)},this.delayShowPopOver=function(e){e.stopImmediatePropagation(),Z.delayShowPopOverTarget(function(){return new f({e:e,editor:Z.props.editor,createMentionInfoReader:Z.props.createMentionInfoReader})})},this.delayShowPopOverTarget=function(e,t){(Z.isMouseMoved||t)&&Z.canShowPopover&&(Z.isDisablePopover()||(Z.delayShowPopOverTimeout=setTimeout(function(){Z.showPopover(e())},d)))},this.setCanShowPopover=function(e){(Z.canShowPopover=e)||Z.closePopOver()},this.showPopover=function(e){if(!Z.popOver&&e.canShowPopover()){var t=e.hasNoPermission(),n=e.isGrantViewAccessDisabled(),r=Z.props,i=r.displayLargePopover,o=r.from,a=Z.props.container,s="notification"===o,c=e.getType(),u=e.getToken(),l=e.getTitle();ae.a.embedObjPermissionManager||ae.a.createEmbedObjPermissionManager();var d,f,h,p,g=ae.a.embedObjPermissionManager,m=ie.E.USER,v=ie.E.FILE,b=ie.E.SHEET,y=ie.E.BITABLE,k=ie.E.MINDNOTE,O=ie.E.BOX,E=ie.E.SLIDE,C=ie.E.WIKI;Z.popOverTarget&&!Z.popOverTarget.isSameAs(e)&&Z.closePopOver(),Z.hoverTimeout&&clearTimeout(Z.hoverTimeout),Z.popOverTarget=e,Object(se.x)()&&c===m&&(f="sheet"===(d=Object(ce.k)()),h="file"===d,p=e.isInComment(),(f||h)&&p&&(a=".doc-position"));var I,S,j,T,w,_=320,M=500,x=M,L="doc",N={},R=c===v;if(!R&&c!==b&&c!==y&&c!==k&&c!==O&&c!==E&&c!==C||(L+=" shortcut",L+=R?" docs":" sheet",M=x=378,_=R?344:348),t&&(I=g.getOwnerByToken(u),S=fe,Object(le.s)()?I&&(T="",T=I.get("can_apply_perm")?(j=Object(se.p)(I,I.get("name")),[Q("permission.embed.contact_author"),j,Q("common.owner"),Q("permission.embed.share_tips_5"),Q("permission.embed.apply_btn")].join("")):Q("permission.embed.share_tips_external_cannot_apply_permission"),_=S<(w=Object(re.k)([T],he))?S:w,x=3*(M=pe)):_=de),c===m){if(oe.a.isOpendoc)return;L+=" mention-profile "+(Z.props.className||""),Object(se.x)()&&(L+=" mention-profile--docs"),N={horizontalAlign:"left",flatDom:!0,gap:10,coverNavBar:!0,closeContainerBottom:!0,$boxContainer:Object(ne.$)("body")}}var P=Object(ne.$)(a);P.length||(P=Object(ne.$)(e.getFallbackContainer()));var D=e.getRect(),U=Object(se.x)()&&c===m?Object(re.j)(D,{gap:10,$boxContainer:s?Object(ne.$)("body"):void 0,coverNavBar:!s}):Object(re.w)(D,Object.assign({horizontalAlign:"center",boxWidth:_,boxMaxHeight:x,boxMinHeight:M,gap:8,$boxContainer:P,coverNavBar:!1,lineHeight:e.getLineHeight(),getFallbackBoxContainer:function(){return e.getFallbackBoxContainer()}},N)),F=e.getSourceData(),z=Object(re.F)(U),B=Object(re.D)(F),H=F.source,W={className:L,style:z,container:P.get(0),handlePopOverEnter:function(){Z.cancelHide()},handlePopOverLeave:function(){Z.hidePopover()}};switch(c){case m:var V,K=e.getUserName()||"";Object(se.x)()?(V=Object(X.default)(U.bottom)?"top":"bottom",W.component=Y.a.createElement(ee.default,J()({closePopover:Z.closePopOver,grantViewAccessDisabled:n},{token:u,displayLargePopover:i,sourceString:B,source:H,name:K},{editor:Z.props.editor,triangle:V}))):(W.component=Y.a.createElement(ee.default,J()({closePopover:Z.closePopOver},{token:u,sourceString:B,source:H,name:K},{editor:Z.props.editor})),W.container=document.body);break;case v:case b:case y:case k:case O:case E:case C:if(Object(ue.b)(c))return;var q=e.getLink();W.component=Y.a.createElement(te.default,J()({token:u,type:c,sourceString:B,title:l,link:q,embedObjShareEnable:Object(le.s)(),disableAddEmbedObj:Z.props.disableAddEmbedObj},{closePopover:Z.closePopOver}));break;default:return}Z.popOver=new $.default(W)}},this.closePopOver=function(){Z.popOver&&(Z.popOver.close(),Z.popOver=null),Z.popOverTarget&&(Z.popOverTarget=null)},this.destory=function(){Z.delayShowPopOverTimeout&&clearTimeout(Z.delayShowPopOverTimeout),Z.hoverTimeout&&clearTimeout(Z.hoverTimeout),Z.justCancelHideTimeout&&clearTimeout(Z.justCancelHideTimeout),Z.closePopOver(),document.body.removeEventListener("mousemove",Z.setMouseMoved,{passive:!0}),Z.undelegateMouseList.forEach(function(e){return e&&e()}),Z.undelegateMouseList=null},this.hidePopover=function(e){Z.hidePopoverImpl({checkJustCancelHide:!1})},this.hidePopoverFromAsyncCall=function(){Z.hidePopoverImpl({checkJustCancelHide:!0})},this.hidePopoverImpl=function(e){Z.delayShowPopOverTimeout&&clearTimeout(Z.delayShowPopOverTimeout),e.checkJustCancelHide&&Z.hasJustCanceledHide()||Z.popOver&&Z.popOverTarget&&(Z.hoverTimeout&&clearTimeout(Z.hoverTimeout),Z.hoverTimeout=setTimeout(Z.closePopOver,l))},this.props=e,this.undelegateMouseList=[],this.bindEvents(),this.isMouseMoved=!1,this.canShowPopover=!0}return o()(t,[{key:"bindEvents",value:function(){var e=this.getSelectors(),t=e.mentionClsWithHoverArea,n=e.popoverCls,r={passive:!0};document.body.addEventListener("mousemove",this.setMouseMoved,r);var i=[{parent:"body",child:t,event:"mouseenter",handle:this.delayShowPopOver.bind(this),eventOptions:r},{parent:"body",child:t,event:"mouseleave",handle:this.hidePopover.bind(this),eventOptions:r},{parent:"body",child:n,event:"mouseenter",handle:this.clearHideTimeout.bind(this),eventOptions:r},{parent:"body",child:n,event:"mouseleave",handle:this.hidePopover.bind(this),eventOptions:r}],s=[];i.map(function(e){var t=e.parent,n=e.child,r=e.event,i=e.handle,o=e.eventOptions,a=Object(c.a)(t,n,r,i,o);a&&s.push(a)}),this.undelegateMouseList=s}},{key:"checkIfHidePopover",value:function(){var e,t,n,r;this.popOver&&this.popOverTarget&&(this.popOverTarget instanceof f?this.props.editor&&(e=this.props.editor.getDocBody(),t=Object(ne.$)(this.popOverTarget.getDom()),n=Object(ne.$)(e).find(t).length,r=t.parents(".comment-list").length,(0===n&&0===r||1===r&&t&&!t.hasClass("mention"))&&this.hidePopover()):this.popOverTarget.canShowPopover()||this.hidePopover())}},{key:"isDisablePopover",value:function(){var e=u.default.getState().appState.translate;return e.status.translated&&2===e.config.display_type}},{key:"cancelHide",value:function(){var e=this;this.hoverTimeout&&clearTimeout(this.hoverTimeout),this.justCancelHideTimeout&&clearTimeout(this.justCancelHideTimeout),this.justCancelHideTimeout=setTimeout(function(){e.justCancelHideTimeout=void 0},l)}},{key:"hasJustCanceledHide",value:function(){return!!this.justCancelHideTimeout}}]),t}();p.a=h}).call(this,g("2vAP"))},"9oD+":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="doc_image"},"A+1H":function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n("n3ZB"),i=n("SGN9"),o=n("G8Hj"),a=n("D7h9"),s=n("OJOY"),c=n("wSsa"),u=function(){var e=Object(r.i)(a.default.getState()),t=(s.a.getItem(c.c)||{}).hasShow;return!!(Object(i.n)(e,o.STEP_TYPES.whats_new_notice_guide)||Object(i.n)(e,o.STEP_TYPES.whats_new_notice_guide_v2)||t)}},APdQ:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzAiIGhlaWdodD0iMzAiPgogICAgPGRlZnM+CiAgICAgICAgPHBhdGggaWQ9ImEiIGQ9Ik0xNS4xMDYuMTM5TDguNTYgNy4xOTNhLjI0Mi4yNDIgMCAwIDAtLjA2LjIxM2MuMDk3LjQ2Ny0uMDM2Ljk3MS0uNCAxLjMzNGExLjQ3MiAxLjQ3MiAwIDAgMS0yLjA5OC0uMDIyTC4yOSAxNC40MTRhLjg0OC44NDggMCAwIDAtLjI0Ny42NjRsLjU2MiA3LjQ5OCA2LjExMyA2LjA5NmEuNTEyLjUxMiAwIDAgMCAuODUzLS4yMThMMTUuNzA2LjQ2OWEuMzUzLjM1MyAwIDAgMC0uMzQ1LS40NDVjLS4wOSAwLS4xOC4wMzUtLjI1NS4xMTV6Ii8+CiAgICAgICAgPHBhdGggaWQ9ImMiIGQ9Ik0xNS4xMDYuMTM5TDguNTYgNy4xOTNhLjI0Mi4yNDIgMCAwIDAtLjA2LjIxM2MuMDk3LjQ2Ny0uMDM2Ljk3MS0uNCAxLjMzNGExLjQ3MiAxLjQ3MiAwIDAgMS0yLjA5OC0uMDIyTC4yOSAxNC40MTRhLjg0OC44NDggMCAwIDAtLjI0Ny42NjRsLjU2MiA3LjQ5OCA2LjExMyA2LjA5NmEuNTEyLjUxMiAwIDAgMCAuODUzLS4yMThMMTUuNzA2LjQ2OWEuMzUzLjM1MyAwIDAgMC0uMzQ1LS40NDVjLS4wOSAwLS4xOC4wMzUtLjI1NS4xMTV6Ii8+CiAgICAgICAgPHBhdGggaWQ9ImUiIGQ9Ik0yOC41MDcuMDYxTC40NDMgOC4xNzNhLjUxLjUxIDAgMCAwLS4yMi44NWw2LjExNCA2LjA5NiA3LjUyLjU2MWEuODU0Ljg1NCAwIDAgMCAuNjY2LS4yNDdsNS43MTItNS42OTZhMS40NjIgMS40NjIgMCAwIDEtLjAyMi0yLjA5MiAxLjQ3IDEuNDcgMCAwIDEgMS4zMzctLjQuMjQ0LjI0NCAwIDAgMCAuMjE0LS4wNTlMMjguODM4LjY2Yy4yNDUtLjIyNi4wNjctLjYxMS0uMjMzLS42MTFhLjM3NS4zNzUgMCAwIDAtLjA5OC4wMTN6Ii8+CiAgICAgICAgPHBhdGggaWQ9ImciIGQ9Ik0yOC41MDcuMDYxTC40NDMgOC4xNzNhLjUxLjUxIDAgMCAwLS4yMi44NWw2LjExNCA2LjA5NiA3LjUyLjU2MWEuODU0Ljg1NCAwIDAgMCAuNjY2LS4yNDdsNS43MTItNS42OTZhMS40NjIgMS40NjIgMCAwIDEtLjAyMi0yLjA5MiAxLjQ3IDEuNDcgMCAwIDEgMS4zMzctLjQuMjQ0LjI0NCAwIDAgMCAuMjE0LS4wNTlMMjguODM4LjY2Yy4yNDUtLjIyNi4wNjctLjYxMS0uMjMzLS42MTFhLjM3NS4zNzUgMCAwIDAtLjA5OC4wMTN6Ii8+CiAgICA8L2RlZnM+CiAgICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGZpbGw9IiMzOEYiIGQ9Ik0yOS4zMzkgMS4yMTdMMjIuNzkzIDguMjdhLjI0Mi4yNDIgMCAwIDAtLjA2LjIxNGMuMDk3LjQ2Ni0uMDM2Ljk3LS40IDEuMzMzLS41OC41OC0xLjUyNi41NzEtMi4wOTgtLjAyMmwtNS43MTIgNS42OTZhLjg0OS44NDkgMCAwIDAtLjI0Ny42NjRsLjU2MiA3LjQ5OSA2LjExMyA2LjA5NWEuNTEyLjUxMiAwIDAgMCAuODUzLS4yMThMMjkuOTQgMS41NDdjLjA5NS0uMzU1LS4zNS0uNi0uNi0uMzMiLz4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNC4yMzMgMS4wNzgpIj4KICAgICAgICAgICAgPG1hc2sgaWQ9ImIiIGZpbGw9IiNmZmYiPgogICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjYSIvPgogICAgICAgICAgICA8L21hc2s+CiAgICAgICAgICAgIDxwYXRoIGZpbGw9IiMzMjg4RkYiIGQ9Ik0xNi4xNjYtMS4xMTFMOC41NyA3LjA3NWEuMjQyLjI0MiAwIDAgMC0uMDYuMjEzYy4wOTguNDczLS4wMzcuOTg0LS40MDUgMS4zNWExLjQ4OCAxLjQ4OCAwIDAgMS0yLjEyMS0uMDIxTC0uMDcgMTQuNjUzbC41OTggNy45NzMgNi43OTkgNi43OCA4Ljg0LTMwLjUxN3oiIG1hc2s9InVybCgjYikiLz4KICAgICAgICA8L2c+CiAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQuMjMzIDEuMDc4KSI+CiAgICAgICAgICAgIDxtYXNrIGlkPSJkIiBmaWxsPSIjZmZmIj4KICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI2MiLz4KICAgICAgICAgICAgPC9tYXNrPgogICAgICAgICAgICA8cGF0aCBmaWxsPSIjMDA1REUwIiBkPSJNMTYuMDc1LS45MDZMOC41NjEgNy4xOTNhLjI0Mi4yNDIgMCAwIDAtLjA2LjIxM2MuMDk2LjQ2Ny0uMDM3Ljk3MS0uNCAxLjMzNGExLjQ3MiAxLjQ3MiAwIDAgMS0yLjA5OS0uMDIyTC4wNTIgMTQuNjVhLjExOS4xMTkgMCAwIDAtLjAzNC4wOTNsLjU4NyA3LjgzMkwxNS43NTgtLjIxOWwuMzE3LS42ODd6IiBtYXNrPSJ1cmwoI2QpIi8+CiAgICAgICAgPC9nPgogICAgICAgIDxwYXRoIGZpbGw9IiNGRkYiIGQ9Ik0yOC44MzguNzE4bC03LjA3NCA2LjUyNmEuMjQzLjI0MyAwIDAgMS0uMjE0LjA2IDEuNDcxIDEuNDcxIDAgMCAwLTEuMzM3LjM5OWMtLjU4MS41OC0uNTczIDEuNTIyLjAyMiAyLjA5M2wtNS43MTIgNS42OTZhLjg1NC44NTQgMCAwIDEtLjY2Ni4yNDZsLTcuNTItLjU2TC4yMjQgOS4wOGEuNTEuNTEgMCAwIDEgLjIxOS0uODVMMjguNTA3LjExOWMuMzU2LS4wOTUuNjAxLjM1LjMzMS41OTkiLz4KICAgICAgICA8Zz4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAuMDU4KSI+CiAgICAgICAgICAgICAgICA8bWFzayBpZD0iZiIgZmlsbD0iI2ZmZiI+CiAgICAgICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjZSIvPgogICAgICAgICAgICAgICAgPC9tYXNrPgogICAgICAgICAgICAgICAgPHBhdGggZmlsbD0iIzQ2RUJENSIgZD0iTTMwLjA5Mi0uMzk4bC04LjIxIDcuNTc0YS4yNDMuMjQzIDAgMCAxLS4yMTQuMDYxIDEuNDg3IDEuNDg3IDAgMCAwLTEuMzU0LjQwMyAxLjQ3OCAxLjQ3OCAwIDAgMCAuMDIyIDIuMTE2bC02LjA1NCA2LjAzNi03Ljk5NS0uNTk3LTYuNzk4LTYuNzc4TDMwLjA5Mi0uMzk4eiIgbWFzaz0idXJsKCNmKSIvPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLjA1OCkiPgogICAgICAgICAgICAgICAgPG1hc2sgaWQ9ImgiIGZpbGw9IiNmZmYiPgogICAgICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI2ciLz4KICAgICAgICAgICAgICAgIDwvbWFzaz4KICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9IiMwMEQwQjYiIGQ9Ik0yOS44ODYtLjMwN2wtOC4xMjIgNy40OTNhLjI0My4yNDMgMCAwIDEtLjIxNC4wNiAxLjQ3MSAxLjQ3MSAwIDAgMC0xLjMzNy4zOTljLS41ODEuNTc5LS41NzMgMS41MjIuMDIyIDIuMDkybC01Ljk1IDUuOTMzYS4xMi4xMiAwIDAgMS0uMDkzLjAzNWwtNy44NTUtLjU4NkwyOS4xOTcuMDA5bC42ODktLjMxNnoiIG1hc2s9InVybCgjaCkiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg=="},AYG9:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"d",function(){return d}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return h});var r,i,o=n("LrQZ"),a=n("2ACu"),s=n("FnDM"),c=n("SebV");function u(e){try{Object(a.default)("quickjs_sdk_error",{quick_sdk_error_name:e.name,quick_sdk_error_msg:e.message,quick_sdk_error_stack:e.stack})}catch(e){Object(c.a)(e)}}(i=r=r||{}).DOC_PAGE_OPEN="docs_page_open",i.AFTER_SCROLL="after_scroll",i.AFTER_EDIT="doc_scene_after_edit",i.ADD_COMMENT="doc_scene_add_comment",i.BACK_HOME="doc_scene_back_home",i.AFTER_ONE_MINUTE="doc_scene_open_after_one_minute";var l=function(e){var t=e.eventName,n=e.data;Object(a.default)(t,n)};try{"undefined"!=typeof XMLHttpRequest&&Object(o.d)({eventRecordHandler:l,errorHandler:u})}catch(e){u(e)}function d(e){try{Object(o.c)(r.DOC_PAGE_OPEN,{file_type:e||Object(s.f)()})}catch(e){u(e)}}function f(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};try{Object(o.a)(e,Object.assign({},t))}catch(e){u(e)}}function h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};try{Object(o.b)(e,t)}catch(e){u(e)}}},Ae4K:function(e,t,r){"use strict";var d={};r.r(d),r.d(d,"CancelTokenSource",function(){return T.CancelTokenSource}),r.d(d,"setEnvConfigs",function(){return P}),r.d(d,"CancelToken",function(){return F}),r.d(d,"getShouldUseNearbyDriveAPI",function(){return B}),r.d(d,"request",function(){return ne}),r.d(d,"post",function(){return ie}),r.d(d,"postUrlEncoded",function(){return oe}),r.d(d,"postFormData",function(){return ae}),r.d(d,"importPostFormData",function(){return ce}),r.d(d,"importGet",function(){return ue});var c,u,i,b=r("BAjd"),n=r("RIqP"),h=r.n(n),o=r("J4zp"),C=r.n(o),a=r("o0o1"),I=r.n(a),s=r("yXPU"),p=r.n(s),l=r("lwsE"),f=r.n(l),g=r("W8MJ"),m=r.n(g),v=r("a1gu"),y=r.n(v),k=r("Nsbk"),O=r.n(k),E=r("7W2i"),S=r.n(E),j=r("7EGn"),T=r("vYB2"),w=r.n(T),_=r("Qyje"),M=r.n(_),x=r("95pV"),L=r("TJya"),N=r("qkt2"),R=r("EAIz");function P(e){var t=e.defaultNearbyDriveAPI,n=e.driveStreamAPIHost,r=e.isNearbyDriveAPIEnabled;c=t,u=n,i=r}var D=w.a.create({withCredentials:!0});Object(x.a)(D);var U=function(e){return"".concat(D.defaults.baseURL).concat(e).replace(/(?:^.*\/\/[^\/]+\/)|(?:\/*(?:\?.*)?$)/g,"").replace(/\//g,".")},F=w.a.CancelToken,z=!1;function B(){return!z&&i&&c}var H,W,V=20,K=16e3,q=2e3;(W=H=H||{}).INCREASE="increase",W.REDUCE="reduce";var Z=new Map,Q=new Map;function J(e,t){var n=Z.get(e),r=n||0;t===H.INCREASE?r=n?Math.min(K,2*n):q:t===H.REDUCE&&(r=n&&q<n?n/2:0),Z.set(e,r)}function X(e){Q.delete(e)}function Y(e){var t=Q.get(e),n=t?t+1:1;Q.set(e,n)}function $(e){Y(e),J(e,H.INCREASE)}function ee(e){X(e),J(e,H.REDUCE)}function te(e){var t=e.match(/^https?\:\/\/[^\/?#]*([^?#]*).*$/);return t&&t[1]?t[1]:e}var ne=function(){var t=p()(I.a.mark(function e(t){var n,r,i,o,a,s;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=te(t.url),e.prev=1,r=Z.get(n))return e.next=6,Object(N.i)(r);e.next=6;break;case 6:return e.next=8,D(t);case 8:if(i=e.sent,0!==(o=i.data).code)throw{response:i};e.next=12;break;case 12:return ee(n),e.abrupt("return",o.data);case 16:if(e.prev=16,e.t0=e.catch(1),!e.t0.response||429!==e.t0.response.status){e.next=24;break}if((a=Q.get(n))&&V<=a)throw e.t0.response.data;e.next=22;break;case 22:return $(n),e.abrupt("return",ne(t));case 24:if(s=401===Object(j.default)(e.t0,"response.status")||Object(j.default)(e.t0,"response.data.code")===b.i,u&&s&&B()&&t.url.includes(c))return z=!0,t.url=t.url.replace("https://".concat(c),u),e.abrupt("return",ne(t));e.next=29;break;case 29:if(ee(n),e.t0.response){e.next=32;break}throw new Error("Network Error");case 32:throw e.t0.response.data;case 33:case"end":return e.stop()}},e,null,[[1,16]])}));return function(e){return t.apply(this,arguments)}}(),re=function(){var r=p()(I.a.mark(function e(t,n,r){var i;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Object.assign({},Object(L.a)(),{"x-command":U(t)},r?r.headers:null),e.t0=R.e,e.t0)return e.t1=Object,e.t2=i,e.next=7,Object(R.c)();e.next=9;break;case 7:e.t3=e.sent,e.t1.assign.call(e.t1,e.t2,e.t3);case 9:return e.abrupt("return",ne(Object.assign({},r,{url:t,method:"post",headers:i,data:n})));case 10:case"end":return e.stop()}},e)}));return function(e,t,n){return r.apply(this,arguments)}}(),ie=function(e,t,n){return re(e,t,n)},oe=function(e,t,n){return re(e,M.a.stringify(t),Object.assign({},n,{headers:Object.assign({"Content-Type":"application/x-www-form-urlencoded"},n?n.headers:null)}))},ae=function(e,t,n){return re(e,t,Object.assign({},n,{headers:Object.assign({"Content-Type":"multipart/form-data"},n?n.headers:null)}))},se=function(){var t=p()(I.a.mark(function e(t){var n,r;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D(t);case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 8:if(e.prev=8,e.t0=e.catch(0),e.t0.response){e.next=12;break}throw new Error("Network Error");case 12:throw e.t0.response.data;case 13:case"end":return e.stop()}},e,null,[[0,8]])}));return function(e){return t.apply(this,arguments)}}(),ce=function(e,t,n){return se(Object.assign({},n,{url:e,method:"post",headers:Object.assign({"x-command":U(e),"Content-Type":"multipart/form-data"},n?n.headers:null),data:t}))},ue=function(e,t,n){return se(Object.assign({},n,{url:e,method:"get",headers:Object.assign({"x-command":U(e)},n?n.headers:null),params:t}))},le=r("gfe6"),de=r("QM+C"),fe=r("D7h9"),he=r("5cZX"),pe=function(){function n(e){var c=this;f()(this,n),this.tasks=[],this.events=[],this._retry=!1,this.defaults={simultaneousUploads:3,dragOverClass:"dragover",throttleProgressCallbacks:1,prepareTarget:b.b.PREPARE,testTarget:b.b.CHUNK_CHECK,uploadTarget:b.b.CHUNK_UPLOAD,finishTarget:b.b.FINISH,xhrTimeout:0,clearInput:!0,setChunkTypeFromFile:!1,fastModeEnabled:!1,getMountPoint:function(){return""},shouldAddToRecents:!0,getParentToken:function(){return""},createDirectory:function(){return Promise.resolve("")},uploadChunk:function(){return Promise.resolve("")},uploadMergedChunk:function(){return Promise.resolve("")},minFileSize:1,minFileSizeErrorCallback:function(e,t){alert(e.name+" is too small, please upload files larger than "+Object(N.a)(c.getOpt(b.l.minFileSize))+".")},maxFileSize:void 0,maxFileSizeErrorCallback:function(e,t,n){alert(e.name+" is too large, please upload files less than "+Object(N.a)(c.getOpt(b.l.maxFileSize))+".")},fileType:[],fileTypeErrorCallback:function(e,t){alert(e.name+" has type not allowed, please upload files of type "+c.getOpt(b.l.fileType)+".")},emptyDirectoryCallback:function(e){alert(e.name+"contains no file")},importableType:[],directoryNotImportableCallback:function(e){alert(e.name+"cannot be imported")},preferMergedChunks:!0,isImportUploadMixedEnabled:!1},this.onDrop=function(e){var t,n,r,i,o,a,s;c.triggerDragSideEffects(e,!1),e.preventDefault(),Object(he.h)(fe.default.getState())!==de.FOLDER_PERMISSION.READABLE?e.dataTransfer&&(n=(t=e.dataTransfer).items,r=t.files,n&&n[0]&&"string"===n[0].kind||(n||r)&&(i=n||r,a=(o=c.opts).importUploadMixedModePredicator,s=o.onImportUploadMixedTask,"function"==typeof a&&a(i,e)&&"function"==typeof s?s(i,e):c.loadFiles(i,e))):console.info("Current folder is read-only.")},this.onDragLeave=function(e){e.currentTarget&&c.triggerDragSideEffects(e,!1)},this.onDragOverEnter=function(e){e.preventDefault();var t=e.dataTransfer;t&&(t.types.indexOf&&0<=t.types.indexOf("Files")?(e.stopPropagation(),t.dropEffect="copy",t.effectAllowed="copy",c.triggerDragSideEffects(e,!0)):(t.dropEffect="none",t.effectAllowed="none"))},this.triggerDragSideEffects=function(e,t){c.toggleDragOverClass(e,t),c.triggerDragHandler(t)},this.toggleDragOverClass=function(e,t){var n=c.getOpt(b.l.dragOverClass);t?e.currentTarget.classList.add(n):e.currentTarget.classList.remove(n)},this.triggerDragHandler=function(e){var t=e?c.getOpt(b.l.onDragStart):c.getOpt(b.l.onDragEnd);t&&t()},this.processItem=function(e,t,n){if(!e)return null;if(e instanceof File||e.isFile)return at(e,c,t,n);var r=n&&n.isImport;return it(e,c,t,{isImport:r})},this.onOnline=function(){c.fire(b.k.online),(c.pausedByOffline||c.filesAddedWhenOffline)&&(c.upload(!0),c.pausedByOffline=!1,c.filesAddedWhenOffline=!1)},this.onOffline=function(){c.fire(b.k.offline),c.isUploading&&(c.pausedByOffline=!0,c.pauseAll())},this.handleDropEvent=function(e){c.onDrop(e)},this.handleChangeEvent=function(e){var t=e.target;c.loadFiles(t.files,e),t.value=""},this.supported=Boolean(FileList&&File&&Blob&&Blob.prototype.slice),this.opts=e||{};var t=this.opts;P({defaultNearbyDriveAPI:t.defaultNearbyDriveAPI,driveStreamAPIHost:t.driveStreamAPIHost,isNearbyDriveAPIEnabled:t.isNearbyDriveAPIEnabled})}function e(){return t.apply(this,arguments)}var t,r;function i(e,t,n){return r.apply(this,arguments)}return m()(n,[{key:"getOpt",value:function(e){var t=this;if(Array.isArray(e)){var n={};return e.forEach(function(e){n[e]=t.getOpt(e)}),n}return(void 0!==this.opts[e]?this.opts:this.defaults)[e]}},{key:"on",value:function(e,t){this.events.push(e.toLowerCase(),t)}},{key:"fire",value:function(e){for(var t=e.toLowerCase(),n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0;o<=this.events.length;o+=2)this.events[o]===t&&this.events[o+1].apply(this,r),"catchall"===this.events[o]&&this.events[o+1].apply(null,[e].concat(r));"fileerror"===e?this.fire(b.k.error,r[1],r[0]):"fileprogress"===e&&this.fire(b.k.progress)}},{key:"processDirectory",value:function(e,t,n){return it(e,this,t,n)}},{key:"loadFiles",value:(r=p()(I.a.mark(function e(t,n,r){var i,o,a,s,c,u,l,d,f,h,p,g,m;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r&&r.isDirectory,!t||0===t.length&&!i)return e.abrupt("return");e.next=3;break;case 3:if(this.fire(b.k.beforeAdd),o=Array.from(t).map(function(e){return e instanceof DataTransferItem?e.webkitGetAsEntry():e}),i&&1===o.length&&""===o[0].webkitRelativePath&&(i=!1),a=[],s=r&&r.versionInfo,c=r&&r.parentToken,i)return u=r&&r.isImport,e.t0=a,e.next=14,this.processDirectory(o,n,{isImport:u,parentToken:c});e.next=18;break;case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=49;break;case 18:d=!(l=!0),f=void 0,e.prev=21,h=o[Symbol.iterator]();case 23:if(l=(p=h.next()).done){e.next=35;break}return g=p.value,m=void 0,m=r&&"function"==typeof r.jobTypePredicator?r.jobTypePredicator(g)===b.j.Import:r&&r.isImport,e.t2=a,e.next=30,this.processItem(g,n,{isImport:m,versionInfo:s,parentToken:c,jobTypePredicator:r?r.jobTypePredicator:void 0});case 30:e.t3=e.sent,e.t2.push.call(e.t2,e.t3);case 32:l=!0,e.next=23;break;case 35:e.next=41;break;case 37:e.prev=37,e.t4=e.catch(21),d=!0,f=e.t4;case 41:e.prev=41,e.prev=42,l||null==h.return||h.return();case 44:if(e.prev=44,d)throw f;e.next=47;break;case 47:return e.finish(44);case 48:return e.finish(41);case 49:this.appendTaskQueue(a,n);case 50:case"end":return e.stop()}},e,this,[[21,37,41,49],[42,,44,48]])})),i)},{key:"appendTaskQueue",value:function(e,t){var n,r=e.filter(function(e){return e});(n=this.tasks).push.apply(n,h()(r)),this.fire(b.k.tasksAdded,r,t),Object(le.c)()||(this.filesAddedWhenOffline=!0)}},{key:"uploadNextChunk",value:(t=p()(I.a.mark(function e(){var t,n,r,i,o,a;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!(t=!0),r=void 0,e.prev=3,i=this.tasks[Symbol.iterator]();case 5:if(t=(o=i.next()).done){e.next=15;break}return a=o.value,e.next=9,a.upload();case 9:if(e.sent)return e.abrupt("return",!0);e.next=12;break;case 12:t=!0,e.next=5;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),n=!0,r=e.t0;case 21:e.prev=21,e.prev=22,t||null==i.return||i.return();case 24:if(e.prev=24,n)throw r;e.next=27;break;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return this.tasks.every(function(e){return e.completed})&&this.fire(b.k.complete),e.abrupt("return",!1);case 32:case"end":return e.stop()}},e,this,[[3,17,21,29],[22,,24,28]])})),e)},{key:"assignBrowse",value:function(e,t){var r=this,i=t.isDirectory,o=t.allowMultiple,a=t.isImport;(e=Object(N.f)(e)).forEach(function(e){var t;"INPUT"===e.tagName&&"file"===e.type?t=e:((t=document.createElement("input")).setAttribute("type","file"),t.style.display="none",e.addEventListener("click",function(){t.style.opacity=0,t.style.display="block",t.focus(),t.click(),t.style.display="none"},!1),e.appendChild(t)),o?t.setAttribute("multiple","multiple"):t.removeAttribute("multiple"),i?t.setAttribute("webkitdirectory","webkitdirectory"):t.removeAttribute("webkitdirectory");var n=r.getOpt(b.l.fileType);void 0!==n&&1<=n.length?t.setAttribute("accept",n.map(function(e){return(e=e.replace(/\s/g,"").toLowerCase()).match(/^[^.][^/]+$/)&&(e="."+e),e}).join(",")):t.removeAttribute("accept"),t.addEventListener("change",function(e){r.loadFiles(e.target.files,e,{isImport:a,isDirectory:i}),r.getOpt(b.l.clearInput)&&(e.target.value="")},!1)})}},{key:"assignDrop",value:function(e){var t=this;(e=Object(N.f)(e)).forEach(function(e){e.addEventListener("dragover",t.onDragOverEnter,!1),e.addEventListener("dragenter",t.onDragOverEnter,!1),e.addEventListener("dragleave",t.onDragLeave,!1),e.addEventListener("drop",t.onDrop,!1)})}},{key:"unAssignDrop",value:function(e){var t=this;(e=Object(N.f)(e)).forEach(function(e){e.removeEventListener("dragover",t.onDragOverEnter),e.removeEventListener("dragenter",t.onDragOverEnter),e.removeEventListener("dragleave",t.onDragLeave),e.removeEventListener("drop",t.onDrop)})}},{key:"setNetworkCheck",value:function(e){e?(window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)):(window.removeEventListener("online",this.onOnline),window.removeEventListener("offline",this.onOffline))}},{key:"upload",value:function(e){if(Object(le.c)()&&(!this.isUploading||this._retry)){this._retry=!1,e&&this.tasks.forEach(function(e){return e.resume()}),this.fire(b.k.uploadStart);for(var t=this.getOpt(b.l.simultaneousUploads),n=0;n<t;n++)this.uploadNextChunk()}}},{key:"pauseAll",value:function(){this.tasks.forEach(function(e){e.abort(),e.pause(!0)}),this.fire(b.k.pauseAll)}},{key:"pause",value:function(t){var e=this.tasks.find(function(e){return e.uuid===t});e?(e.abort(),e.pause(!0),this.fire(b.k.pause,e)):console.error("Cannot find file with uuid:",t)}},{key:"retry",value:function(t){var e;Object(le.c)()&&(this._retry=!0,(e=this.tasks.find(function(e){return e.uuid===t}))?e.retry():console.error("Cannot find file with uuid:",t))}},{key:"retryAll",value:function(e){var t=this;e&&0!==e.length&&e.forEach(function(e){t.retry(e)})}},{key:"rePending",value:function(t){var e;Object(le.c)()&&((e=this.tasks.find(function(e){return e.uuid===t}))?(e.resume(),this.fire(b.k.pending,e)):console.error("Cannot find file with uuid:",t))}},{key:"rePendingAll",value:function(e){var t=this;e&&0!==e.length&&(e.forEach(function(e){t.rePending(e)}),this.isUploading||this.upload())}},{key:"cancel",value:function(t){var e=this.tasks.find(function(e){return e.uuid===t});e?(e.cancel(),this.fire(b.k.cancel,e)):console.error("Cannot find file with uuid:",t)}},{key:"cancelAll",value:function(){for(var e=this.tasks.length-1;0<=e;e--)this.tasks[e].cancel();this.fire(b.k.cancelAll)}},{key:"progress",value:function(){var n=0,r=0;return this.tasks.forEach(function(e){var t=e.size;n+=e instanceof lt?e.sizeProgress*t:e.progress*t,r+=t}),0<r?n/r:0}},{key:"uploadedSize",value:function(){return this.tasks.reduce(function(e,t){return t instanceof lt?e+t.sizeProgress*t.size:e+t.progress*t.size},0)}},{key:"addFile",value:function(e,t,n){this.loadFiles([e],t,n)}},{key:"addFiles",value:function(e,t,n){this.loadFiles(e,t,n)}},{key:"removeTask",value:function(e){for(var t=this.tasks.length-1;0<=t;t--)this.tasks[t]===e&&this.tasks.splice(t,1)}},{key:"getFromUniqueIdentifier",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.tasks[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a instanceof lt){var s=a.getFromUniqueIdentifier(e);if(s)return s}else if(a.uuid===e)return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return null}},{key:"getSize",value:function(){return this.tasks.reduce(function(e,t){return e+t.size},0)}},{key:"isUploading",get:function(){return this.tasks.some(function(e){return e.isUploading})}}]),n}(),ge=function(){function o(e){var t,n=e.uploaderObj,r=e.rootTask,i=e.parentToken;f()(this,o),this.uploaderObj=n,r?this.rootTask=r:(t=n.getOpt(b.l.getParentToken),this.parentToken=i||t())}return m()(o,[{key:"getOpt",value:function(e){return this.uploaderObj.getOpt(e)}},{key:"fire",value:function(e){for(var n=this,t=arguments.length,r=new Array(1<t?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return Array.isArray(e)||(e=[e]),e.forEach(function(e){var t;return(t=n.uploaderObj).fire.apply(t,[e].concat(r))})}},{key:"parentToken",set:function(e){this._parentToken=e},get:function(){return this._parentToken}},{key:"rootTask",set:function(e){this._rootTask=e},get:function(){return this._rootTask||this}},{key:"isTask",get:function(){return this.rootTask===this}}]),o}(),me=function(e){function c(e){var t,n=e.uploaderObj,r=e.file,i=e.uuid,o=e.rootTask,a=e.parentToken,s=e.isJobTypeDeterminedByPredicator;return f()(this,c),(t=y()(this,O()(c).call(this,{uploaderObj:n,rootTask:o,parentToken:a}))).error=!1,t.paused=!1,t.resumed=!1,t.file=r,t.uuid=i,t.isJobTypeDeterminedByPredicator=!!s,t}return S()(c,e),m()(c,[{key:"checkRootTaskProgress",value:function(){this.rootTask instanceof dt&&this.rootTask.checkTaskProgress()}},{key:"pause",value:function(e){this.paused=void 0===e?!this.paused:e}},{key:"resume",value:function(){this.pause(!1),this.resumed=!0}},{key:"isPaused",get:function(){return this.paused}},{key:"name",get:function(){return this.file?this.file.name:""}},{key:"type",get:function(){return this.file?this.file.type:""}},{key:"size",get:function(){return this.file?this.file.size:0}}]),c}(ge),ve=me,be=r("cDf5"),ye=r.n(be),ke=r("PJYZ"),Oe=r.n(ke),Ee=[b.e.PENDING,b.e.ERROR],Ce=function(e){function i(e){var n;f()(this,i),(n=y()(this,O()(i).call(this,e))).chunks=[],n.cachedChunks=[],n.startTime=0,n.timeCost=0,n.chunkEvent=function(e,t){switch(e){case b.c.PROGRESS:if(n.paused)break;n.fire([b.k.fileProgress,b.k.collectReport],n.rootTask,t);break;case b.c.ERROR:n.abort(),n.markError(),n.cachedChunks=n.chunks,n.chunks=[],n.fire([b.k.taskError,b.k.collectReport],Oe()(n),Object.assign({},"object"===ye()(t)?t:null,{type:b.o.ChunkError})),n.isTask||n.checkRootTaskProgress();break;case b.c.SUCCESS:if(n.error||!n.chunks||0===n.chunks.length)return;n.fire([b.k.fileProgress,b.k.collectReport],n.rootTask,Object.assign({},"object"===ye()(t)?t:null,{type:b.o.ChunkSuccess})),n.readyToFinish&&n.finish(t);break;case b.c.RETRY:n.isTask&&n.fire(b.k.taskRetry,Oe()(n));break;case b.c.REPORT_ERROR:n.fire(b.k.collectReport,n.rootTask,Object.assign({},"object"===ye()(t)?t:null,{type:b.o.ChunkError}))}},n._prevProgress=0;var t=e.versionInfo;t&&(n.fileToken=t.fileToken,n.memberId=t.memberId,n.versionUpload=!0);var r=n.getOpt(b.l.getMountPoint);return n.mountPoint=r(),n}function t(e){return n.apply(this,arguments)}var n,r,o;function a(e){return r.apply(this,arguments)}function s(){return o.apply(this,arguments)}return S()(i,e),m()(i,[{key:"upload",value:(o=p()(I.a.mark(function e(){var t,n,r,i,o,a;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(le.c)()){e.next=2;break}return e.abrupt("return",!1);case 2:return this._bootstrapKickedOff||(this._bootstrapKickedOff=!0,this._bootstrapTask=this.bootstrap()),e.next=5,this._bootstrapTask;case 5:if(this.paused)return e.abrupt("return",!1);e.next=7;break;case 7:this.resumed&&(this.markStartTime(),this.resumed=!1),n=!(t=!0),r=void 0,e.prev=11,i=this.chunks[Symbol.iterator]();case 13:if(t=(o=i.next()).done){e.next=23;break}if(a=o.value,Ee.includes(a.status()))return e.next=19,a.send();e.next=20;break;case 19:return e.abrupt("return",!0);case 20:t=!0,e.next=13;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(11),n=!0,r=e.t0;case 29:e.prev=29,e.prev=30,t||null==i.return||i.return();case 32:if(e.prev=32,n)throw r;e.next=35;break;case 35:return e.finish(32);case 36:return e.finish(29);case 37:return e.abrupt("return",!1);case 38:case"end":return e.stop()}},e,this,[[11,25,29,37],[30,,32,36]])})),s)},{key:"retry",value:function(){Object(le.c)()&&(this.paused&&(this.cachedChunks=this.chunks),this._bootstrapTask=this.bootstrap(!0),this.isTask&&this.uploaderObj.upload(),this.pause(!1))}},{key:"abort",value:function(){var t=0;this.chunks.forEach(function(e){e.status()===b.e.UPLOADING&&(e.abort(),t++)}),this.isTask&&0<t&&this.fire(b.k.fileProgress,this),this.addTimeCost()}},{key:"cancel",value:function(){var t=this,e=this.chunks;this.chunks=[],e.forEach(function(e){e.status()===b.e.UPLOADING&&(e.abort(),t.uploaderObj.uploadNextChunk())}),this.isTask&&(this.uploaderObj.removeTask(this),this.fire(b.k.fileProgress,this))}},{key:"bootstrap",value:(r=p()(I.a.mark(function e(t){var n,r,i,o,a,s,c,u,l,d,f;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.abort(),this.error=!1,this.markStartTime(),this.resumed=!1,t&&this.cachedChunks&&0<this.cachedChunks.length)return this.chunks=this.cachedChunks,this.cachedChunks=[],this.readyToFinish&&this.finish(""),e.abrupt("return");e.next=9;break;case 9:if(r="",e.prev=10,void 0===this.parentToken)throw new Error("Mount node token unspecified");e.next=13;break;case 13:return r=Object(N.d)(),e.next=16,ie(this.getOpt(b.l.prepareTarget),Object(N.g)({name:this.name,mount_node_token:this.parentToken,mount_point:this.mountPoint,size:this.size,file_token:this.fileToken}),{headers:Object.assign({"x-request-id":r,"x-tt-trace-id":r},R.e?Object(R.d)():{})});case 16:n=e.sent,e.next=26;break;case 19:return e.prev=19,e.t0=e.catch(10),this.markError(),this.fire(b.k.collectReport,this,{type:b.o.FilePrepareError,reqId:r,msg:e.t0.message}),this.isTask?this.fire(b.k.taskError,this,{type:b.o.FilePrepareError,isIllegal:e.t0&&e.t0.code===b.h}):this.checkRootTaskProgress(),e.t0&&e.t0.code===b.g&&(this.fire(b.k.usageLimitReached,b.m.upload),this.uploaderObj.pauseAll()),e.abrupt("return");case 26:if(i=n.block_size,o=n.num_blocks,a=n.upload_id,s=n.option_block_size,this.chunkSize=i,this.totalChunks=o,this.uploadId=a,this.suggestedChunkSize=s,0===this.totalChunks)return this.finish(""),e.abrupt("return");e.next=34;break;case 34:if(this.chunks=[],this._prevProgress=0,c={uploaderObj:this.uploaderObj,fileObj:this,callback:this.chunkEvent},this.shouldUseMergedChunks)for(u=this.suggestedChunkSize/this.chunkSize,l=Math.ceil(this.totalChunks/u),d=0;d<l;d++)this.chunks.push(new $e(Object.assign({},c,{chunkSize:this.chunkSize,offset:d,numOfChunks:u})));else for(f=0;f<this.totalChunks;f++)this.chunks.push(new Je(Object.assign({},c,{chunkSize:this.chunkSize,offset:f})));case 38:case"end":return e.stop()}},e,this,[[10,19]])})),a)},{key:"markStartTime",value:function(){this.startTime=Date.now()}},{key:"markError",value:function(){this.error=!0,this.addTimeCost()}},{key:"addTimeCost",value:function(){this.startTime&&(this.timeCost+=Date.now()-this.startTime,this.startTime=0)}},{key:"finish",value:(n=p()(I.a.mark(function e(t){var n,r,i;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="",e.prev=1,n=Object(N.d)(),r=this.getOpt(b.l.shouldAddToRecents),e.next=6,ie(this.getOpt(b.l.finishTarget),Object(N.g)({upload_id:this.uploadId,num_blocks:this.totalChunks,member_id:this.memberId,push_open_history_record:this.isTask&&r?null:0}),{headers:{"x-request-id":n,"x-tt-trace-id":n}});case 6:(i=e.sent).file_token&&(this.fileToken=i.file_token,this.fileVersion=i.version,this.fileDataVersion=i.data_version,this.addTimeCost(),this.reportFileSuccess(),this.isTask?this.fire(b.k.taskSuccess,this,t):this.checkRootTaskProgress()),e.next=17;break;case 10:e.prev=10,e.t0=e.catch(1),this.cachedChunks=this.chunks,this.markError(),this.fire(b.k.collectReport,this,{type:b.o.FileFinishError,reqId:n,msg:e.t0.message}),this.isTask?this.fire(b.k.taskError,this,{type:b.o.FileFinishError}):this.checkRootTaskProgress(),e.t0&&e.t0.code&&this.fire(b.k.fileError,e.t0.code);case 17:case"end":return e.stop()}},e,this,[[1,10]])})),t)},{key:"reportFileSuccess",value:function(){var e=this.size,t=this.timeCost,n=e&&t?Math.round(e/t*1e3):void 0;this.fire(b.k.collectReport,this,{type:b.o.FileSuccess,fileSize:e,timeCost:t,uploadSpeed:n})}},{key:"setRootTaskUploadingChunk",value:function(e){this.isTask||(this.rootTask.uploadingChunk=e)}},{key:"pushRootTaskUploadedChunk",value:function(e){this.isTask||this.rootTask.uploadedChunks.push(e)}},{key:"progress",get:function(){if(this.error)return 1;var t=0,n=!1;return this.chunks.forEach(function(e){e.status()===b.e.ERROR&&(n=!0),t+=e.progress(!0)}),t=n||.99999<t?1:t,t=Math.max(this._prevProgress,t),n||(this._prevProgress=t),t}},{key:"isUploading",get:function(){var e=this.progress,t=this.chunks.some(function(e){return e.status()===b.e.UPLOADING}),n=Boolean(0<e&&e<1&&!this.error&&!this.paused);return t||n}},{key:"completed",get:function(){return!!this.fileVersion&&this.readyToFinish}},{key:"shouldUseMergedChunks",get:function(){if(!this.uploaderObj.getOpt(b.l.preferMergedChunks)||!this.suggestedChunkSize)return!1;var e=this.suggestedChunkSize/this.chunkSize;return e===Math.round(e)}},{key:"readyToFinish",get:function(){return!!this.uploadId&&!this.chunks.some(function(e){return e.status()!==b.e.SUCCESS})}}]),i}(me),Ie=function(){function s(e){var n=this,t=e.uploaderObj,r=e.fileObj,i=e.offset,o=e.chunkSize,a=e.callback;f()(this,s),this.size=0,this.uploading=!1,this.reqId="",this.timeCost=0,this.aborted=!1,this.cancel=null,this.onUploadProgress=function(e){var t=Date.now()-n.lastProgressCallback;t>1e3*n.uploaderObj.getOpt(b.l.throttleProgressCallbacks)&&(n.reportProgressMetric(e.loaded-n.lastReportedLoaded,t),n.lastProgressCallback=Date.now(),n.lastReportedLoaded=e.loaded),n.loaded=e.loaded||0},this.setCancelToken=function(e){return n.cancel=e},this.uploaderObj=t,this.fileObj=r,this.fileObjSize=r.size,this.offset=i,this.callback=a,this.chunkSize=o,this.chunkType=this.uploaderObj.getOpt(b.l.setChunkTypeFromFile)?this.fileObj.file.type:"",this.loaded=0,this.lastReportedLoaded=0}return m()(s,[{key:"triggerNext",value:function(e,t){this.uploading=!1,this.callback(e,this.getMessage(t)),this.uploaderObj.uploadNextChunk()}},{key:"reportProgressMetric",value:function(e,t){0<e&&this.callback(b.c.PROGRESS,{metric:!0,diffSize:e,diffTime:t})}},{key:"reportError",value:function(e){this.callback(b.c.REPORT_ERROR,this.getMessage(e))}},{key:"abort",value:function(){this.cancel&&(this.cancel(),this.cancel=null,this.aborted=!0)}},{key:"status",value:function(){return this.uploading?b.e.UPLOADING:this.loaded?b.e.SUCCESS:this.aborted?b.e.ABORT:this.cancel?b.e.ERROR:b.e.PENDING}},{key:"getMessage",value:function(e){var t=this.size,n=this.timeCost,r=t&&n?Math.round(t/n*1e3):void 0,i={offset:this.offset,status:this.status(),responseData:this.responseData||"",reqId:this.reqId,chunkSize:t,timeCost:n,uploadSpeed:r};return e&&(i.msg=e),i}},{key:"progress",value:function(e){var t=e?this.size/this.fileObjSize:1;switch(this.status()){case b.e.SUCCESS:case b.e.ERROR:return+t;case b.e.PENDING:return 0;default:return this.loaded/this.size*t}}},{key:"loadedSize",get:function(){return this.loaded}}]),s}(),Se=r("2spZ"),je=r("iP/4");function Te(e){return crypto.subtle.digest("SHA-256",e).then(we)}function Ae(e){return Me(new Uint8Array(e)).toString()}function we(e){for(var t=new Uint8Array(e),n="",r=0,i=t.byteLength;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function _e(e){for(var t=new Uint8Array(e.length),n=0,r=e.length;n<r;++n)t[n]=255&e.charCodeAt(n);return t}function Me(e){e="string"==typeof e?_e(e):e;for(var t=new Uint32Array([1,0,e.length,0,0,65521,5552,0]),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6];0<i;){for(a=c<i?c:i,i-=a;r+=n+=e[o++],--a;);n%=s,r%=s}return(r<<16|n)>>>0}var xe,Le,Ne={calcSHA256Async:Te,calcADLER32:Ae},Re={HASH_ADLER32:"adler32",HASH_AND_CHECKSUM:"hash_and_checksum",HASH_SHA256:"sha256"},Pe=new Map;function De(){return Ue.apply(this,arguments)}function Ue(){return(Ue=p()(I.a.mark(function e(){var t,n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.e("boxWorker").then(r.t.bind(null,"TD40",7));case 3:t=e.sent,n=t.default,(xe=new n).onmessage=Fe,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Failed to load box.worker.js",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}function Fe(e){var t,n=e.data,r=n.callerId,i=n.content,o=n.errorMsg;Pe.has(r)&&(t=Pe.get(r),Pe.delete(r),o?t.reject(new Error(o)):t.resolve(i))}function ze(){return+new Date+Math.random()}function Be(e,t,n,r){return He.apply(this,arguments)}function He(){return(He=p()(I.a.mark(function e(t,n,r,i){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(xe){e.next=5;break}return Le=Le||De(),e.next=4,Le;case 4:Le=null;case 5:xe.postMessage({callerId:t,type:n,content:r}),Pe.set(t,i);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var We=function(i){return function(n){var r=ze();return new Promise(function(e,t){Be(r,i,n,{resolve:e,reject:t})})}},Ve=We(Re.HASH_SHA256);function Ke(e){return je.a.isEdge?Ne.calcSHA256Async(e):Ve(e)}var qe,Ge,Ze=We(Re.HASH_ADLER32),Qe=We(Re.HASH_AND_CHECKSUM),Je=function(e){function n(e){var t;return f()(this,n),(t=y()(this,O()(n).call(this,e))).startByte=t.offset*t.chunkSize,t.endByte=Math.min(t.fileObjSize,(t.offset+1)*t.chunkSize),t.size=t.endByte-t.startByte,t.doUploadChunk=t.uploaderObj.getOpt(b.l.uploadChunk),t}function t(e,t){return r.apply(this,arguments)}var r,i,o,a;function s(e){return i.apply(this,arguments)}function c(e){return o.apply(this,arguments)}function u(){return a.apply(this,arguments)}return S()(n,e),m()(n,[{key:"send",value:(a=p()(I.a.mark(function e(){var t,n,r,i,o;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.uploading=!0,t=this.fileObj.file.slice(this.startByte,this.endByte,this.chunkType),e.next=4,this.calcHashAndChecksum(t);case 4:return n=e.sent,r=n.hash,i=n.checksum,o=this.size,e.next=10,this.checkChunkExistence({hash:r,checksum:i,size:o});case 10:if(!e.sent){e.next=16;break}this.loaded=this.size,this.triggerNext(b.c.SUCCESS),e.next=18;break;case 16:return e.next=18,this.uploadChunk({sliceData:t,checksum:i,size:o},b.d);case 18:case"end":return e.stop()}},e,this)})),u)},{key:"checkChunkExistence",value:(o=p()(I.a.mark(function e(t){var n,r,i,o,a,s;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.hash,r=t.checksum,i=t.size,this.uploaderObj.getOpt(b.l.fastModeEnabled)){e.next=4;break}return e.abrupt("return",!1);case 4:return e.prev=4,o=Date.now(),e.next=8,ie(this.uploaderObj.getOpt(b.l.testTarget),{upload_id:this.fileObj.uploadId,seq:this.offset,hash:n,checksum:r,size:i});case 8:return a=e.sent,this.timeCost=Date.now()-o,s=Boolean(a.exist),e.abrupt("return",s);case 14:return e.prev=14,e.t0=e.catch(4),e.abrupt("return",!1);case 17:case"end":return e.stop()}},e,this,[[4,14]])})),c)},{key:"calcHashAndChecksum",value:(i=p()(I.a.mark(function e(t){var n,r,i,o;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(N.h)(t);case 2:if(n=e.sent,je.a.isEdge)return e.next=6,Ke(n);e.next=12;break;case 6:return r=e.sent,e.next=9,Ze(n);case 9:i=e.sent,e.next=17;break;case 12:return e.next=14,Qe(n);case 14:o=e.sent,r=o.hash,i=o.checksum;case 17:return e.abrupt("return",{hash:r,checksum:i});case 18:case"end":return e.stop()}},e)})),s)},{key:"uploadChunk",value:(r=p()(I.a.mark(function e(t,n){var r,i,o,a,s,c;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.sliceData,i=t.checksum,o=t.size,e.prev=1,this.callback(b.c.PROGRESS),this.fileObj.setRootTaskUploadingChunk(this),this.reqId=Object(N.d)(),a=Date.now(),this.lastProgressCallback=a,e.next=9,this.doUploadChunk({request:d,uploadId:this.fileObj.uploadId,offset:this.offset,checksum:i,sliceData:r,reqId:this.reqId,onUploadProgress:this.onUploadProgress,setCancelToken:this.setCancelToken});case 9:s=e.sent,this.cancel=null,c=Date.now(),this.timeCost=c-a,this.responseData=s,0===this.loaded&&this.reportError("Incorrect loaded value"),this.loaded=o,this.reportProgressMetric(o-this.lastReportedLoaded,c-this.lastProgressCallback),this.fileObj.pushRootTaskUploadedChunk(this),this.triggerNext(b.c.SUCCESS),e.next=40;break;case 21:if(e.prev=21,e.t0=e.catch(1),this.loaded=0,this.lastReportedLoaded=0,!Object(N.e)()||this.aborted){e.next=37;break}if(0<n)return this.reportError(e.t0.message),e.next=30,Object(Se.c)(1e3);e.next=34;break;case 30:return e.next=32,this.uploadChunk({sliceData:r,checksum:i,size:o},n-1);case 32:e.next=35;break;case 34:this.triggerNext(b.c.ERROR,e.t0.message);case 35:e.next=40;break;case 37:this.aborted=!1,this.uploading=!1,this.cancel=null;case 40:return e.prev=40,this.fileObj.setRootTaskUploadingChunk(null),e.finish(40);case 43:case"end":return e.stop()}},e,this,[[1,21,40,43]])})),t)}]),n}(Ie),Xe=r("QILm"),Ye=r.n(Xe),$e=function(e){function a(e){var t,n=e.numOfChunks,r=Ye()(e,["numOfChunks"]);f()(this,a);var i=(t=y()(this,O()(a).call(this,r))).chunkSize*n;t.startByte=t.offset*i,t.endByte=Math.min(t.fileObjSize,(t.offset+1)*i),t.size=t.endByte-t.startByte,t.actualNumOfSubChunks=Math.ceil(t.size/t.chunkSize),t.startSubChunkIndex=t.offset*n,t.uploadedSubChunkIndices=[];var o=Boolean(navigator.serviceWorker&&navigator.serviceWorker.controller);return t.strategy=o?"simple":"optimized",t.doUploadMergedChunk=t.uploaderObj.getOpt(b.l.uploadMergedChunk),t}function t(e){return n.apply(this,arguments)}var n,r,i;function o(e){return r.apply(this,arguments)}function s(){return i.apply(this,arguments)}return S()(a,e),m()(a,[{key:"send",value:(i=p()(I.a.mark(function e(){var t,n,r,i=arguments;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<i.length&&void 0!==i[0]?i[0]:b.d,e.prev=1,this.uploading=!0,n=this.seqList,e.next=6,this.getPendingSliceData(n);case 6:return r=e.sent,e.next=9,this.uploadChunk(Object.assign({},r,{seqList:n}));case 9:e.next=30;break;case 11:if(e.prev=11,e.t0=e.catch(1),this.loaded=0,this.lastReportedLoaded=0,!Object(N.e)()||this.aborted){e.next=27;break}if(0<t)return this.reportError(e.t0.message),e.next=20,Object(Se.c)(1e3);e.next=24;break;case 20:return e.next=22,this.send(t-1);case 22:e.next=25;break;case 24:this.triggerNext(b.c.ERROR,e.t0.message);case 25:e.next=30;break;case 27:this.aborted=!1,this.uploading=!1,this.cancel=null;case 30:return e.prev=30,this.fileObj.setRootTaskUploadingChunk(null),e.finish(30);case 33:case"end":return e.stop()}},e,this,[[1,11,30,33]])})),s)},{key:"uploadChunk",value:(r=p()(I.a.mark(function e(t){var n,r,i,o,a,s,c,u,l=this;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.blob,r=t.checksums,i=t.size,o=t.seqList,this.callback(b.c.PROGRESS),this.fileObj.setRootTaskUploadingChunk(this),this.reqId=Object(N.d)(),a=Date.now(),this.lastProgressCallback=a,e.next=8,this.doUploadMergedChunk({request:d,uploadId:this.fileObj.uploadId,offset:this.offset,size:i,checksums:r,seqList:o,chunkSize:this.chunkSize,sliceData:n,reqId:this.reqId,onUploadProgress:this.onUploadProgress,setCancelToken:this.setCancelToken});case 8:if(s=e.sent,this.cancel=null,c=Date.now(),this.timeCost=c-a,this.responseData=s,0===this.loaded&&this.reportError("Incorrect loaded value"),this.loaded=i,this.reportProgressMetric(i-this.lastReportedLoaded,c-this.lastProgressCallback),(u=s&&s.success_seq_list)&&u.forEach(function(e){l.uploadedSubChunkIndices.includes(e)||l.uploadedSubChunkIndices.push(e)}),this.uploadedSubChunkIndices.length!==this.actualNumOfSubChunks)throw s;e.next=20;break;case 20:this.fileObj.pushRootTaskUploadedChunk(this),this.triggerNext(b.c.SUCCESS);case 22:case"end":return e.stop()}},e,this)})),o)},{key:"getPendingSliceData",value:(n=p()(I.a.mark(function e(t){var n,r,i,o,a,s,c,u,l,d,f,h=this;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getByteRanges(t),r=n.map(function(e){var t=C()(e,2),n=t[0],r=t[1];return h.fileObj.file.slice(n,r,h.chunkType)}),e.next=4,Promise.all(r.map(N.h));case 4:return i=e.sent,o=i.reduce(function(e,t){return e+t.byteLength},0),e.next=8,Promise.all(i.map(Ze));case 8:if(a=e.sent,1===r.length)return e.abrupt("return",{blob:r[0],size:o,checksums:a});e.next=11;break;case 11:if("simple"===this.strategy)return s=n[0][0],c=n[n.length-1][1],u=this.fileObj.file.slice(s,c,this.chunkType),e.abrupt("return",{blob:u,size:o,checksums:a});e.next=16;break;case 16:return l=new Uint8Array(o),d=0,i.forEach(function(e){var t=new Uint8Array(e);l.set(t,d),d+=e.byteLength}),f=new Blob([l]),e.abrupt("return",{blob:f,size:o,checksums:a});case 21:case"end":return e.stop()}},e,this)})),t)},{key:"getByteRanges",value:function(e){var t=this;return e.map(function(e){return[e*t.chunkSize,Math.min(t.endByte,(e+1)*t.chunkSize)]})}},{key:"totalSubChunkIndices",get:function(){var n=this;return new Array(this.actualNumOfSubChunks).fill(null).map(function(e,t){return n.startSubChunkIndex+t})}},{key:"seqList",get:function(){var t=this;return"simple"===this.strategy?this.totalSubChunkIndices:this.totalSubChunkIndices.filter(function(e){return!t.uploadedSubChunkIndices.includes(e)})}}]),a}(Ie),et=100,tt=function(e){function t(){return f()(this,t),y()(this,O()(t).apply(this,arguments))}function n(e){return r.apply(this,arguments)}var r,i,o;function a(e){return i.apply(this,arguments)}function s(){return o.apply(this,arguments)}return S()(t,e),m()(t,[{key:"upload",value:(o=p()(I.a.mark(function e(){var t,n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(le.c)()||this.error||this.paused||this.uploading||this.converting||this.finished)return e.abrupt("return",!1);e.next=2;break;case 2:if(e.prev=2,t=Object(N.d)(),this.ticket){e.next=8;break}return e.next=7,this.uploadFileToParser(t);case 7:this.ticket=e.sent;case 8:return e.next=10,this.getParserResult(this.ticket);case 10:return this.finished=!0,this.isTask?this.fire(b.k.taskSuccess,this):this.checkRootTaskProgress(),e.abrupt("return",!0);case 15:return e.prev=15,e.t0=e.catch(2),(n=this.uploading?b.o.ImportUploadError:this.converting?b.o.ImportParseError:null)&&this.fire(b.k.collectReport,this,{type:n,reqId:t,msg:e.t0.message}),Object(le.c)()&&(this.error=!0,this.isTask?n&&this.fire(b.k.taskError,this,{type:n}):this.checkRootTaskProgress()),this.uploading=!1,this.converting=!1,e.abrupt("return",!1);case 23:return e.prev=23,this.uploaderObj.uploadNextChunk(),e.finish(23);case 26:case"end":return e.stop()}},e,this,[[2,15,23,26]])})),s)},{key:"uploadFileToParser",value:(i=p()(I.a.mark(function e(t){var n,r,i,o,a,s=this;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.cancelSource=F.source(),this.uploading=!0,(n=new FormData).append("name",this.name),n.append("type",this.type),n.append("size",String(this.size)),n.append("parent_token",this.parentToken),n.append("file",this.file),r=b.n.includes(this.type)?b.a:"",i=r?{"x-command":r}:{},e.next=12,ce(b.b.IMPORT_UPLOAD,n,{cancelToken:this.cancelSource.token,onUploadProgress:function(e){var t=e.loaded,n=e.total;s._progress=0===n?1:t/n,s.fire(b.k.fileProgress,s)},headers:Object.assign({"x-request-id":t,"x-tt-trace-id":t},i)});case 12:if(o=e.sent,a=o.ticket){e.next=17;break}throw this.fire(b.k.fileError,o.code),new Error(o);case 17:return this.uploading=!1,e.abrupt("return",a);case 19:case"end":return e.stop()}},e,this)})),a)},{key:"getParserResult",value:(r=p()(I.a.mark(function e(t){var n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Import task ticket not returned");case 2:this.checkTimes=0,this.converting=!0;case 4:if(this.checkTimes<et)return e.next=7,Object(N.i)(0===this.checkTimes?1e3:3e3);e.next=16;break;case 7:return e.next=9,ue(b.b.IMPORT_STATUS,{ticket:t});case 9:if((n=e.sent)&&void 0!==n.code)return 0===n.code?(this.fileToken=Object(j.default)(n,"tokens.0",""),n.warningCode&&this.fire(b.k.fileWarning,n.warningCode)):n.code===b.g?this.fire(b.k.usageLimitReached,b.m.import):this.fire(b.k.fileError,{type:this.type||Object(N.c)(this.name)||"",code:n.code}),e.abrupt("break",16);e.next=13;break;case 13:this.checkTimes+=1,e.next=4;break;case 16:if(this.fileToken){e.next=18;break}throw new Error("Check import task result failed");case 18:this.converting=!1;case 19:case"end":return e.stop()}},e,this)})),n)},{key:"retry",value:function(){Object(le.c)()&&(this.abort(),this.error=!1,this.uploaderObj.upload(this.paused))}},{key:"abort",value:function(){this.isUploading&&(this.cancelSource&&this.cancelSource.cancel(),this.uploading=!1,this.converting=!1,this.checkTimes=et,this.isTask&&this.fire(b.k.fileProgress,this))}},{key:"cancel",value:function(){this.abort(),this.isTask&&(this.uploaderObj.uploadNextChunk(),this.uploaderObj.removeTask(this))}},{key:"progress",get:function(){return this.error?1:this._progress}},{key:"isUploading",get:function(){return this.uploading||this.converting}},{key:"completed",get:function(){return this.finished}}]),t}(me),nt=tt;function rt(t){return new Promise(function(e){t.file(e)})}function it(e,t,n,r){return ot.apply(this,arguments)}function ot(){return(ot=p()(I.a.mark(function e(t,n,r,i){var o,a,s,c,u,l;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=i&&i.rootTask,a=i&&i.parentPath,s=i&&i.parentToken,c=i&&i.isImport,u=Object(N.b)(Array.isArray(t)?t[0]:t),l=new dt({input:t,uploaderObj:n,uuid:u,rootTask:o,parentPath:a,parentToken:s,isImport:c}),e.next=8,l.init(r);case 8:if(o){e.next=18;break}if(!c||l.totalFiles===l.totalRawFiles){e.next=14;break}if(n.getOpt(b.l.directoryNotImportableCallback)(l),0===l.totalFiles)return e.abrupt("return",null);e.next=14;break;case 14:if(0===l.totalFiles)return n.getOpt(b.l.emptyDirectoryCallback)(l),e.abrupt("return",null);e.next=18;break;case 18:return l.isTask&&n.fire(b.k.taskAdded,l,r),e.abrupt("return",l);case 20:case"end":return e.stop()}},e)}))).apply(this,arguments)}function at(e,t,n,r){return st.apply(this,arguments)}function st(){return(st=p()(I.a.mark(function e(t,n,r,i){var o,a,s,c,u,l,d,f,h,p,g,m,v;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof File)){e.next=4;break}e.t0=t,e.next=7;break;case 4:return e.next=6,rt(t);case 6:e.t0=e.sent;case 7:if(o=e.t0,a=n.getOpt([b.l.minFileSize,b.l.maxFileSize,b.l.maxImportFileSize,b.l.minFileSizeErrorCallback,b.l.maxFileSizeErrorCallback,b.l.fileType,b.l.fileTypeErrorCallback,b.l.importableType]),s=o.name,c=o.type,i&&i.rootTask&&/^(\~\$|\.)/g.test(s))return e.abrupt("return",null);e.next=13;break;case 13:if(!(0<a.fileType.length)){e.next=28;break}u=!1,e.t1=I.a.keys(a.fileType);case 16:if((e.t2=e.t1()).done){e.next=25;break}if(l=e.t2.value,a.fileType[l]=a.fileType[l].replace(/\s/g,"").toLowerCase(),d=(a.fileType[l].match(/^[^.][^/]+$/)?".":"")+a.fileType[l],s.substr(-1*d.length).toLowerCase()===d||-1!==d.indexOf("/")&&(-1!==d.indexOf("*")&&c.substr(0,d.indexOf("*"))===d.substr(0,d.indexOf("*"))||c===d))return u=!0,e.abrupt("break",25);e.next=23;break;case 23:e.next=16;break;case 25:if(u){e.next=28;break}return a.fileTypeErrorCallback(o),e.abrupt("return",null);case 28:if(!((f=i&&i.isImport)&&0<a.importableType.length)){e.next=33;break}if(a.importableType.includes(c)||a.importableType.includes(Object(N.c)(s))){e.next=33;break}return e.abrupt("return",null);case 33:if(void 0!==a.minFileSize&&o.size<a.minFileSize)return a.minFileSizeErrorCallback(o),e.abrupt("return",null);e.next=36;break;case 36:if(h=a.maxFileSize,p=qe.upload,f&&(h=a.maxImportFileSize,p=qe.import),void 0!==h&&o.size>h)return a.maxFileSizeErrorCallback(o,p,h),e.abrupt("return",null);e.next=42;break;case 42:return g=Object(N.b)(o),m={file:o,uploaderObj:n,uuid:g||"",rootTask:i&&i.rootTask,parentToken:i&&i.parentToken,isJobTypeDeterminedByPredicator:i&&"function"==typeof i.jobTypePredicator},(v=f?new tt(m):new Ce(Object.assign({},m,{versionInfo:i&&i.versionInfo}))).isTask&&n.fire(b.k.taskAdded,v,r),e.abrupt("return",v);case 47:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ct(e){return e.webkitRelativePath}(Ge=qe=qe||{})[Ge.import=1]="import",Ge[Ge.upload=2]="upload";var ut=-1,lt=function(e){function u(e){var a,t=e.input,n=e.parentPath,r=e.parentToken,i=e.uploaderObj,o=e.uuid,s=e.rootTask,c=e.isImport;return f()(this,u),(a=y()(this,O()(u).call(this,{uploaderObj:i,parentToken:r,rootTask:s}))).uploadedChunks=[],a.uploadingChunk=null,a.paused=!1,a.bootstrapError=!1,a.bootstrapping=!1,a.subDirectories=[],a.files=[],a.rawFileCount=0,a._size=ut,a.parseFile=function(e){var t=ct(e),n=a.parentPath||"".concat(a.dirName,"/"),r=e.name.replace(/\\/g,"/"),i=t.replace(n,"").replace(r,"").split("/"),o=1<i.length;return{isDirectory:o,parentPath:o?"".concat(n).concat(i[0],"/"):"",file:e}},Array.isArray(t)?a.directoryFiles=t:a.directoryEntry=t,a.uuid=o,a.parentPath=n||"",a.isImport=c||!1,a.createDirectory=i.getOpt(b.l.createDirectory),a}function t(){return n.apply(this,arguments)}var n,r,i;function o(e){return r.apply(this,arguments)}function a(){return i.apply(this,arguments)}return S()(u,e),m()(u,[{key:"init",value:function(e){return this.directoryEntry?this.initByDirectoryEntry(e):this.initByDirectoryFiles(e)}},{key:"upload",value:(i=p()(I.a.mark(function e(){var t,n,r,i,o,a,s,c,u,l,d,f;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(N.e)()){e.next=2;break}return e.abrupt("return",!1);case 2:if(this.bootstrapped){e.next=5;break}return e.next=5,this.bootstrap();case 5:if(this.paused)return e.abrupt("return",!1);e.next=7;break;case 7:if(this.bootstrapped){e.next=9;break}return e.abrupt("return",!1);case 9:n=!(t=!0),r=void 0,e.prev=12,i=this.subDirectories[Symbol.iterator]();case 14:if(t=(o=i.next()).done){e.next=24;break}return a=o.value,e.next=18,a.upload();case 18:if(e.sent)return e.abrupt("return",!0);e.next=21;break;case 21:t=!0,e.next=14;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(12),n=!0,r=e.t0;case 30:e.prev=30,e.prev=31,t||null==i.return||i.return();case 33:if(e.prev=33,n)throw r;e.next=36;break;case 36:return e.finish(33);case 37:return e.finish(30);case 38:c=!(s=!0),u=void 0,e.prev=41,l=this.files[Symbol.iterator]();case 43:if(s=(d=l.next()).done){e.next=55;break}if(f=d.value,this.paused)return e.abrupt("return",!1);e.next=47;break;case 47:return e.next=49,f.upload();case 49:if(e.sent)return e.abrupt("return",!0);e.next=52;break;case 52:s=!0,e.next=43;break;case 55:e.next=61;break;case 57:e.prev=57,e.t1=e.catch(41),c=!0,u=e.t1;case 61:e.prev=61,e.prev=62,s||null==l.return||l.return();case 64:if(e.prev=64,c)throw u;e.next=67;break;case 67:return e.finish(64);case 68:return e.finish(61);case 69:return e.abrupt("return",!1);case 70:case"end":return e.stop()}},e,this,[[12,26,30,38],[31,,33,37],[41,57,61,69],[62,,64,68]])})),a)},{key:"pause",value:function(n){this.subDirectories.forEach(function(e){e.pause(n)}),this.files.forEach(function(e,t){e.pause(n)}),this.paused=void 0===n?!this.paused:n}},{key:"resume",value:function(){this.pause(!1)}},{key:"abort",value:function(){var t=0;this.subDirectories.forEach(function(e){e.isUploading&&(e.abort(),t++)}),this.files.forEach(function(e){e.isUploading&&(e.abort(),t++)}),0<t&&this.fire(b.k.taskProgress,this.rootTask)}},{key:"cancel",value:function(){this.files.forEach(function(e){e.isUploading&&e.abort()}),this.files=[],this.subDirectories.forEach(function(e){e.isUploading&&e.abort()}),this.subDirectories=[],this.uploaderObj.removeTask(this),this.fire(b.k.taskProgress,this.rootTask)}},{key:"retry",value:function(){Object(N.e)()&&(this.paused=!1,this.bootstrapError?this.upload():(this.subDirectories.forEach(function(e){e.paused&&e.pause(!1),e.error&&e.retry()}),this.files.forEach(function(e){e.isPaused&&e.pause(!1),e.error&&e.retry()}),this.isTask&&this.uploaderObj.upload()))}},{key:"checkTaskProgress",value:function(){var e,t,n;this.isTask?this.paused||(n=(e=this.finishedFiles)+this.failedFiles<(t=this.totalFiles)?b.k.taskProgress:e===t?b.k.taskSuccess:b.k.taskError,this.fire(n,this.rootTask)):console.error("ERR - unexpected code execution.")}},{key:"getFromUniqueIdentifier",value:function(t){var e=this.files.find(function(e){return e.uuid===t});if(e)return e;var n=!0,r=!1,i=void 0;try{for(var o,a=this.subDirectories[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.getFromUniqueIdentifier(t);if(s)return s}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return null}},{key:"readEntries",value:function(d,e){var f=this;return new Promise(function(l){e.readEntries(function(){var t=p()(I.a.mark(function e(t){var n,r,i,o,a,s,c,u;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=!(n=!0),i=void 0,e.prev=3,o=t[Symbol.iterator]();case 5:if(n=(a=o.next()).done){e.next=26;break}if((s=a.value).isDirectory)return e.next=10,it(s,f.uploaderObj,d,{rootTask:f.rootTask,isImport:f.isImport});e.next=14;break;case 10:(c=e.sent)&&f.subDirectories.push(c),e.next=23;break;case 14:if(s.isFile)return e.next=17,at(s,f.uploaderObj,d,{rootTask:f.rootTask,isImport:f.isImport});e.next=22;break;case 17:(u=e.sent)&&f.files.push(u),f.rawFileCount++,e.next=23;break;case 22:console.warn("Invalid FileSystemEntry encountered:",s);case 23:n=!0,e.next=5;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(3),r=!0,i=e.t0;case 32:e.prev=32,e.prev=33,n||null==o.return||o.return();case 35:if(e.prev=35,r)throw i;e.next=38;break;case 38:return e.finish(35);case 39:return e.finish(32);case 40:l(0<t.length);case 41:case"end":return e.stop()}},e,null,[[3,28,32,40],[33,,35,39]])}));return function(e){return t.apply(this,arguments)}}())})}},{key:"initByDirectoryEntry",value:function(i){var o=this;return new Promise(function(){var t=p()(I.a.mark(function e(t){var n,r;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.directoryEntry.createReader(),e.next=3,o.readEntries(i,n);case 3:r=e.sent;case 4:if(r)return e.next=7,o.readEntries(i,n);e.next=10;break;case 7:r=e.sent,e.next=4;break;case 10:t(void 0);case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())}},{key:"initByDirectoryFiles",value:(r=p()(I.a.mark(function e(t){var n,r,i,o,a,s,c,u,l,d,f,h,p,g,m,v,b,y,k,O,E;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.directoryFiles){e.next=2;break}return e.abrupt("return");case 2:this.setDirName(),n=new Map,r=this.directoryFiles.map(this.parseFile),o=!(i=!0),a=void 0,e.prev=8,s=r[Symbol.iterator]();case 10:if(i=(c=s.next()).done){e.next=26;break}if(u=c.value,l=u.isDirectory,d=u.parentPath,f=u.file,!l){e.next=18;break}(h=n.get(d)||[]).push(f),n.set(d,h),e.next=23;break;case 18:return e.next=20,at(f,this.uploaderObj,t,{rootTask:this.rootTask,isImport:this.isImport});case 20:(p=e.sent)&&this.files.push(p),this.rawFileCount++;case 23:i=!0,e.next=10;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(8),o=!0,a=e.t0;case 32:e.prev=32,e.prev=33,i||null==s.return||s.return();case 35:if(e.prev=35,o)throw a;e.next=38;break;case 38:return e.finish(35);case 39:return e.finish(32);case 40:m=!(g=!0),v=void 0,e.prev=43,b=n[Symbol.iterator]();case 45:if(g=(y=b.next()).done){e.next=54;break}return k=C()(y.value,2),d=k[0],O=k[1],e.next=49,it(O,this.uploaderObj,t,{rootTask:this.rootTask,isImport:this.isImport,parentPath:d});case 49:(E=e.sent)&&this.subDirectories.push(E);case 51:g=!0,e.next=45;break;case 54:e.next=60;break;case 56:e.prev=56,e.t1=e.catch(43),m=!0,v=e.t1;case 60:e.prev=60,e.prev=61,g||null==b.return||b.return();case 63:if(e.prev=63,m)throw v;e.next=66;break;case 66:return e.finish(63);case 67:return e.finish(60);case 68:case"end":return e.stop()}},e,this,[[8,28,32,40],[33,,35,39],[43,56,60,68],[61,,63,67]])})),o)},{key:"bootstrap",value:(n=p()(I.a.mark(function e(){var t,n,r;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.parentToken)throw new Error("Mount node token unspecified");e.next=2;break;case 2:if(this.bootstrapping)return e.abrupt("return");e.next=4;break;case 4:t=4,this.bootstrapping=!0;case 6:if(0,n="",this.bootstrapped)return e.abrupt("break",39);e.next=10;break;case 10:return e.prev=10,n=Object(N.d)(),e.next=14,this.createDirectory({request:d,parentToken:this.parentToken,rootToken:this.rootTask.parentToken,name:this.name,reqId:n});case 14:if(r=e.sent,this.bootstrapped)return this.fire(b.k.collectReport,this.rootTask,{type:b.o.FolderCreateError,msg:"createDirectory when bootstrapped"}),e.abrupt("break",39);e.next=18;break;case 18:if(r)return this.bootstrapped=!0,this.bootstrapError=!1,this.setChildrenParentToken(r),e.abrupt("break",39);e.next=23;break;case 23:throw new Error("no new directory token");case 26:if(e.prev=26,e.t0=e.catch(10),this.fire(b.k.collectReport,this.rootTask,{type:b.o.FolderCreateError,reqId:n,msg:e.t0.message}),0==t--)return this.bootstrapError=!0,this.fire(b.k.taskError,this.rootTask,{type:b.o.FolderCreateError}),e.abrupt("break",39);e.next=33;break;case 33:return e.next=35,Object(N.i)(1e3);case 35:if(this.paused)return e.abrupt("break",39);e.next=37;break;case 37:e.next=6;break;case 39:this.bootstrapping=!1;case 40:case"end":return e.stop()}},e,this,[[10,26]])})),t)},{key:"setDirName",value:function(){var e,t=this.directoryFiles;t&&0!==t.length&&(this.parentPath?this.dirName=this.parentPath.replace(/\/$/,"").split("/").pop():(e=ct(t[0]),this.dirName=e.split("/")[0]))}},{key:"setChildrenParentToken",value:function(t){this.selfToken=t,this.files.forEach(function(e){return e.parentToken=t}),this.subDirectories.forEach(function(e){return e.parentToken=t})}},{key:"recursiveGetCount",value:function(n,r){return this.files.reduce(function(e,t){return t[n]?e+1:e},0)+this.subDirectories.reduce(function(e,t){return e+t[r]},0)}},{key:"totalFiles",get:function(){return this.subDirectories.reduce(function(e,t){return e+t.totalFiles},this.files.length)}},{key:"totalRawFiles",get:function(){return this.subDirectories.reduce(function(e,t){return e+t.totalRawFiles},this.rawFileCount)}},{key:"finishedFiles",get:function(){return this.recursiveGetCount("completed","finishedFiles")}},{key:"failedFiles",get:function(){return this.recursiveGetCount("error","failedFiles")}},{key:"failedFileNames",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.subDirectories[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.error&&e.push.apply(e,h()(a.failedFileNames))}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}var s=!0,c=!1,u=void 0;try{for(var l,d=this.files[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){var f=l.value;f.error&&e.push(f.name)}}catch(e){c=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw u}}return e}},{key:"progress",get:function(){var e=this.files.find(function(e){return e.isUploading});if(e)return e.progress;var t=this.subDirectories.find(function(e){return e.isUploading});return t?t.progress:1}},{key:"sizeProgress",get:function(){var e=this.uploadedChunks.reduce(function(e,t){return e+t.size},0),t=0;return this.uploadingChunk&&(t=this.uploadingChunk.loadedSize),(e+t)/this.size}},{key:"isUploading",get:function(){return this.files.some(function(e){return e.isUploading})||this.subDirectories.some(function(e){return e.isUploading})}},{key:"completed",get:function(){return this.files.every(function(e){return e.completed})&&this.subDirectories.every(function(e){return e.completed})}},{key:"error",get:function(){return this.bootstrapError||this.files.some(function(e){return e.error})||this.subDirectories.some(function(e){return e.error})}},{key:"name",get:function(){return this.directoryEntry?this.directoryEntry.name:this.dirName||""}},{key:"type",get:function(){return b.f}},{key:"size",get:function(){if(this._size>ut)return this._size;var e=this.files.reduce(function(e,t){return e+t.size},0);return this._size=this.subDirectories.reduce(function(e,t){return e+t.size},e),this._size}}]),u}(ge),dt=lt;r.d(t,"a",function(){return ve}),r.d(t,"b",function(){return nt}),r.d(t,"d",function(){return pe}),r.d(t,"e",function(){return Ze})},Ahmm:function(e,t,n){"use strict";var r=n("RIqP"),i=n.n(r),o=n("hMnB"),a=n.n(o),s={trackPV:function(e,t){return!!s.checkAble()&&(window.ga("set",{page:e||a.a.pathname,title:t||document.title}),window.ga("send",{hitType:"pageview"}),!0)},trackEvent:function(e){if(!s.checkAble())return!1;var t,n=e.category,r=e.action,i=e.label,o=e.value,a=e.hitCallback;return n&&r&&"event"!==n&&(t={hitType:"event",eventCategory:n,eventAction:r,eventLabel:i||"",eventValue:o||1,hitCallback:function(e){if(e){var t=!1,n=function(){t||(t=!0,e())};return setTimeout(n,1e3),n}}(a)},window.ga("send",t)),!0},trackData:function(e){return!!s.checkAble()&&(e.forEach(function(e){window.ga("set",e)}),!0)},create:function(e){if(!s.checkAble())return!1;var t=[{trackingId:e.trackingId||"UA-103569331-1",cookieDomain:e.cookieDomain||"auto",name:e.name}].concat(i()(e.value)),n=Object.assign.apply(Object,[{}].concat(i()(t)));return window.ga("create",n),!0},getAll:function(){return!!s.checkAble()&&(window.ga(function(){e=window.ga.getAll()}),e);var e},checkAble:function(){return!!window.ga}};t.a=s},AvAw:function(e,t,n){"use strict";n.r(t);var r=n("RIqP"),s=n.n(r),i=n("o0o1"),c=n.n(i),o=n("yXPU"),u=n.n(o),a=n("lwsE"),l=n.n(a),d=n("W8MJ"),f=n.n(d),h=n("lSNA"),p=n.n(h),g=n("BeL+"),w=n("AiBH"),_=n("PyL4"),m=n("Ns/6"),M=n("mRaX"),v=n("U5G9"),b=n("XVMX"),y=n("5cZX"),k=n("IyQe"),O=n("vc5i"),E=n("ZGZ5"),C=n("D7h9");n("n3ZB"),n("m1/u"),n("jp/M"),n("G8Hj");function I(){var e=C.default.getState(),t=Object(O.n)(e),n=Object(O.f)(e),r=n&&n.get("type"),i=Object(E.a)(e),o=i&&i.get("id"),a=Object(y.j)(e);return{fileType:r,fileToken:t,userId:o,isShareable:Object(k.getUserPermissions)(a.toJS()).shareable}}var S,x=n("8wYP"),L=n("H6oK");n.d(t,"NotifyType",function(){return j}),n.d(t,"MentionNotificationQueue",function(){return D});var j,T,N=Object(v.b)({module:v.a.MENTION}),R=(S={},p()(S,w.E.USER,m.a),p()(S,w.E.GROUP,m.c),S);function P(t){return new Promise(function(e){return window.setTimeout(e,t)})}(T=j=j||{})[T.BOT=1]="BOT";var D=function(){function e(){l()(this,e),this.queue=[],this.users=[],this.groups=[],this.decisionSet=new Set}function t(e){return n.apply(this,arguments)}var n,r,i;function o(){return r.apply(this,arguments)}function a(e,t,n){return i.apply(this,arguments)}return f()(e,[{key:"getShareInfo",value:function(){return I()}},{key:"calTextAndCollectMentionFromRep",value:function(E,e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=t.source||w.z.DOC_COMMENT,C=e.apool,r=t.mentionOptions,i=(r&&r.notifyOptions?r.notifyOptions:{}).useMention,o=void 0!==i&&i,a=Object(x.b)({changesetHelper:N,rep:e}),I=[],S="",j="",T=[];a.forEach(function(e){var t,n,r,i,o,a,s,c,u,l,d,f,h=Object(M.q)(e.attribsNum,C),p=Object(x.a)(e.attributes),g=Object(L.isBlockAttributes)(p),m=h["mention-token"],v=h["mention-link"],b=h["mention-notify"],y=h["mention-sharePermHeldBack"],k=h["mention-icon"],O=Object(x.e)(E,e);j+=O,m?(t=Number.parseInt(h["mention-type"]),n=decodeURIComponent(v),t!==w.E.USER&&t!==w.E.GROUP||(n="",r=O.startsWith("@")?O.slice(1):O,T.push({targetName:r,name:r,token:m,type:t,shouldNotifyLark:b,sharePermHeldBack:y})),t===w.E.USER&&I.push(m),S+='<at type="'.concat(t,'" href="').concat(n,'" token="').concat(m,'"').concat(k?" icon='"+k+"'":"",">").concat(Object(_.escapeHTML)(O),"</at>")):(i="",!g||(o=Object(L.getBlockPropsFromAttributesMap)(p))&&o.blockType===L.BlockType.AT_USER_BLOCK&&(a=O.startsWith("@")?O.slice(1):O,o.props&&o.props.data&&o.props.data.user&&(c=(s=o.props.data).user,l=void 0!==(u=s.mentionNotify)&&u,f=void 0!==(d=s.sharePermHeldBack)&&d,T.push({targetName:a,name:a,token:c.id,type:w.E.USER,shouldNotifyLark:l.toString(),sharePermHeldBack:f.toString()}),i='<at type="'.concat(w.E.USER,'" href="" token="').concat(c.id,'">').concat(Object(_.escapeHTML)(O),"</at>"),I.push(c.id))),S+=i||Object(_.escapeHTML)(O||""))});var s,c=this.getTokens(T),u=c.toUsers,l=c.toGroup;return n!==w.z.DOC_COMMENT&&n!==w.z.SHEET&&n!==w.z.SHEET_COMMENT&&n!==w.z.MINDNOTE&&n!==w.z.MINDNOTE_COMMENT&&n!==w.z.BOX_COMMENT&&(o?(s=r&&r.notifyParams||{},this.addUserMentionV2(u,s)):this.addUserMention(u,n)),this.addGroupMention(l,n,j),{html:S,mentionTokenList:I}}},{key:"register",value:function(e,t,n){var r=this,i=this.createDecision(e,t,n);this.decisionSet.add(i),i.finally(function(){return r.decisionSet.delete(i)})}},{key:"createDecision",value:(i=u()(c.a.mark(function e(t,n,r){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.race([n,P(r)]);case 2:e.sent===b.b.CANCELED&&this.removeTargetToNotify(t);case 4:case"end":return e.stop()}},e,this)})),a)},{key:"addUserMention",value:function(e,t){var n;0!==e.length&&(n=this.getShareInfo(),this.queue.push({type:w.E.USER,config:{to_user:Object(g.a)(e),note_token:n.fileToken,source:t,target:w.C.LARK,from_user:n.userId}}))}},{key:"addGroupMention",value:function(e,t,n){var r;0!==e.length&&(r=this.getShareInfo(),this.queue.push({type:w.E.GROUP,config:{entities:{group_chats:Object(g.a)(e).map(function(e){return{id:e,text:n}})},source:t,target:w.C.LARK,token:r.fileToken}}))}},{key:"addUserMentionV2",value:function(e,n,r,i){var o=this;e.forEach(function(e){var t={id:e,query:n};r&&(t.append_hash=r),i&&(t.notify_type=i),o.users.push(t)})}},{key:"addGroupMentionV2",value:function(e,t){var n=this;e.forEach(function(e){n.groups.push({id:e,query:t})})}},{key:"sendMentionNotifications",value:(r=u()(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s()(this.decisionSet),this.decisionSet.clear(),e.next=4,Promise.all(t);case 4:return this.removeTargetToNotify(this.getShareInfo().userId),n=s()(this.queue),this.queue=[],e.abrupt("return",Promise.all(n.map(function(e){var t=e.type,n=e.config;return R[t](n)})));case 8:case"end":return e.stop()}},e,this)})),o)},{key:"sendMentionNotifications2",value:(n=u()(c.a.mark(function e(t){var n,r,i,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s()(this.decisionSet),this.decisionSet.clear(),e.next=4,Promise.all(n);case 4:if(r=this.getShareInfo(),this.removeTargetToNotify(r.userId),i=s()(this.groups),o=s()(this.users),this.groups=[],this.users=[],0===i.length&&0===o.length)return e.abrupt("return");e.next=12;break;case 12:return e.abrupt("return",R[w.E.GROUP]({source:t,token:r.fileToken,target:w.C.LARK,entities:{group_chats:i,users:o}}));case 13:case"end":return e.stop()}},e,this)})),t)},{key:"removeTargetToNotify",value:function(s){this.queue=this.queue.reduce(function(e,t){var n,r,i,o=t.type,a=t.config;return o===w.E.USER?((n=Object.assign({},a)).to_user=n.to_user.filter(function(e){return e!==s}),0<n.to_user.length&&e.push({type:o,config:n})):o===w.E.GROUP?0<(i=(r=Object.assign({},a)).entities.group_chats.filter(function(e){var t=e.id;return s!==t})).length&&(r.entities=Object.assign({},r.entities,{group_chats:i}),e.push({type:o,config:r})):e.push({type:o,config:a}),e},[]),this.users=this.users.filter(function(e){return e.id!==s}),this.groups=this.groups.filter(function(e){return e.id!==s})}},{key:"getTokens",value:function(e){var t=[],n=[];return e.forEach(function(e){"true"===e.shouldNotifyLark&&"true"!==e.sharePermHeldBack&&(e.type===w.E.USER?t:n).push(e.token)}),{toUsers:t,toGroup:n}}}]),e}();t.default=new D},AvKE:function(m,e,t){(function(e){var n=1/0,t="[object Symbol]",r=/[\\^$.*+?()[\]{}|]/g,i=RegExp(r.source),o="object"==typeof e&&e&&e.Object===Object&&e,a="object"==typeof self&&self&&self.Object===Object&&self,s=o||a||Function("return this")(),c=Object.prototype.toString,Symbol=s.Symbol,u=Symbol?Symbol.prototype:void 0,l=u?u.toString:void 0;function d(e){if("string"==typeof e)return e;if(h(e))return l?l.call(e):"";var t=e+"";return"0"==t&&1/e==-n?"-0":t}function f(e){return!!e&&"object"==typeof e}function h(e){return"symbol"==typeof e||f(e)&&c.call(e)==t}function p(e){return null==e?"":d(e)}function g(e){return(e=p(e))&&i.test(e)?e.replace(r,"\\$&"):e}m.exports=g}).call(this,t("yLpj"))},BAjd:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"k",function(){return r}),n.d(t,"m",function(){return o}),n.d(t,"l",function(){return h}),n.d(t,"c",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"d",function(){return b}),n.d(t,"o",function(){return p}),n.d(t,"j",function(){return m}),n.d(t,"f",function(){return y}),n.d(t,"g",function(){return k}),n.d(t,"h",function(){return O}),n.d(t,"i",function(){return E}),n.d(t,"a",function(){return C}),n.d(t,"n",function(){return I});var r,i,o,a,s=n("VIFs"),c={CHUNK_CHECK:Object(s.prependAPI)("/api/box/upload/block/check/"),CHUNK_UPLOAD:Object(s.prependDriveStreamAPI)("/api/box/stream/upload/block/"),FINISH:Object(s.prependAPI)("/api/box/upload/finish/"),PREPARE:Object(s.prependAPI)("/api/box/upload/prepare/"),IMPORT_UPLOAD:Object(s.prependAPI)("/api/parser/uploadfile/"),IMPORT_STATUS:Object(s.prependAPI)("/api/parser/getresult/")};(i=r=r||{}).beforeAdd="beforeAdd",i.cancel="cancel",i.cancelAll="cancelAll",i.complete="complete",i.error="error",i.taskProgress="taskProgress",i.fileProgress="fileProgress",i.fileError="fileError",i.fileWarning="fileWarning",i.taskAdded="taskAdded",i.taskError="taskError",i.taskRetry="taskRetry",i.tasksAdded="tasksAdded",i.taskSuccess="taskSuccess",i.pause="pause",i.pauseAll="pauseAll",i.progress="progress",i.uploadStart="uploadStart",i.offline="offline",i.online="online",i.usageLimitReached="usageLimitReached",i.collectReport="collectReport",i.pending="pending",(a=o=o||{}).upload="upload",a.import="import";var u,l,d,f,h={clearInput:"clearInput",dragOverClass:"dragOverClass",fileType:"fileType",importableType:"importableType",fileTypeErrorCallback:"fileTypeErrorCallback",finishTarget:"finishTarget",getParentToken:"getParentToken",createDirectory:"createDirectory",uploadChunk:"uploadChunk",uploadMergedChunk:"uploadMergedChunk",getMountPoint:"getMountPoint",maxFileSize:"maxFileSize",maxImportFileSize:"maxImportFileSize",maxFileSizeErrorCallback:"maxFileSizeErrorCallback",minFileSize:"minFileSize",minFileSizeErrorCallback:"minFileSizeErrorCallback",fastModeEnabled:"fastModeEnabled",emptyDirectoryCallback:"emptyDirectoryCallback",directoryNotImportableCallback:"directoryNotImportableCallback",prepareTarget:"prepareTarget",setChunkTypeFromFile:"setChunkTypeFromFile",simultaneousUploads:"simultaneousUploads",testTarget:"testTarget",throttleProgressCallbacks:"throttleProgressCallbacks",uploadTarget:"uploadTarget",xhrTimeout:"xhrTimeout",onDragStart:"onDragStart",onDragEnd:"onDragEnd",shouldAddToRecents:"shouldAddToRecents",preferMergedChunks:"preferMergedChunks"};(l=u=u||{}).ERROR="error",l.PROGRESS="progress",l.RETRY="retry",l.SUCCESS="success",l.REPORT_ERROR="report_error",(f=d=d||{}).ERROR="error",f.PENDING="pending",f.SUCCESS="success",f.UPLOADING="uploading",f.ABORT="abort";var p,g,m,v,b=3;(g=p=p||{}).ChunkError="ChunkError",g.ChunkSuccess="ChunkSuccess",g.FileFinishError="FileFinishError",g.FilePrepareError="FilePrepareError",g.FileSuccess="FileSuccess",g.FolderCreateError="FolderCreateError",g.ImportUploadError="ImportUploadError",g.ImportParseError="ImportParseError",(v=m=m||{}).Upload="upload",v.Import="import",v.Exit="Exit";var y="directory-a47de874",k=11001,O=10009,E=90002007,C="api.sheet.parser.uploadfile",I=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"]},"Bq+3":function(e,q,Z){"use strict";(function(p){var e,t=Z("RIqP"),ne=Z.n(t),n=Z("lSNA"),O=Z.n(n),r=Z("o0o1"),re=Z.n(r),i=Z("yXPU"),w=Z.n(i),o=Z("lwsE"),a=Z.n(o),s=Z("W8MJ"),c=Z.n(s),u=Z("hbEN"),ie=Z("7EGn"),C=Z("dtwz"),oe=Z("HmyT"),_=Z("6Do3"),ae=Z("2ACu"),se=Z("lG83"),g=Z("OZf9"),M=Z("Bw5p"),ce=Z("fujP"),l=Z("Z0Cl"),d=Z("vJtL"),ue=Z("jVwk"),le=Z("1dfU"),x=Z("iP/4"),f=Z("TSYQ"),I=Z.n(f),h=Z("/spq"),L=Z("wq9/"),de=Z("uwMH"),fe=Z("aXiW"),S=Z("Cy2Z"),he=Z("OX8E"),j=Z("QM+C"),N=Z("lQZd"),T=Z("PyL4"),pe=Z("XNb2"),m=Z("9g7G"),v=Z("KiYW"),R=Z("ouE1"),b=Z("whZn"),ge=Z("jp/M"),y=Z("q1tI"),P=Z.n(y),me=Z("mRaX"),k=Z("duSr"),ve=Z("PX10"),be=Z("AiBH"),ye=Z("7Kxq"),D=Z("/fVd"),U=Z("HIeq"),F=Z("Wc+A"),z=Z("n/R6"),ke=Z("y2sV"),B=Z("H6oK"),Oe=Z("SGN9"),Ee=Z("A+1H"),E=Z("bsrO"),H=Z("LaDK"),Ce=Z("Yspk"),W=Z("kmoK"),Ie=Object(k.b)(),V=["mention-type","mention-link","mention-token","mention-id","mention-tempId","mention-chatId","mention-chatToken","mention-icon"],K=Object(h.a)(["showMentionBox","handleConfirm"])(e=function(){function r(e){var E=this;a()(this,r),this.setCustomIconEnableFG=function(e){E.customIconEnable=e},this.setMentionFileManager=function(e){(E.mentionFileManager=e)&&E.editor.on(ke.k.PAINT,E.notifyMentionListChange)},this.notifyMentionListChange=function(){var e=E.mentionFileManager;e&&e.isNeedResortLine&&E.debounceNotifyMentionListChange()},this.debounceNotifyMentionListChange=Object(u.default)(function(){var e,t=E.mentionFileManager,n=E.props.controller;n&&t&&(e=E.mentionFileManager.getAllMentionObjects(E.editor),n.mentionFileListChange(e))},200),this.UNSAFE_editorNormalizePasteNode=function(e){var t,n=e.data.node,r=Object(oe.$)(n),i=r.find(".mention");i.length&&(Object(g.a)(i,function(e){var t=Object(me.h)();e.className=e.className.replace(/mention-tempId_\S*/,"").replace(/mention-uuid_\w+/,"mention-uuid_".concat(t))}),t=E.editor.selection.getSelection().start.line,E.lastPasteLineNum=t);var o=r.find(".".concat(be.i));o.length&&Object(g.a)(o,function(e){var t=Object(oe.$)(e).attr(be.j);try{var n,r=E.editor.clipboard.getPasteInfo(),i=r.pasteFrom,o=r.pasteTimes;"cut"===i&&1===o?(Object(oe.$)(e).removeAttr(be.j),Object(oe.$)(e).attr(B.DATA_META_BLOCK_PROPS,t),Object(oe.$)(e).removeClass("".concat(be.i," ignore-collect"))):(n=Object(B.generateBlockDataSet)(JSON.parse(t)),Object(oe.$)(e).attr(be.j,JSON.stringify(n)))}catch(e){throw new Error("[Chatcard]: clientside-props parse error.")}})},this.updateClientSideChatCardProps=function(e){return e.reduce(function(e,t){if(t instanceof ke.E){var n=t.reduce(function(e,t){var n,r,i,o=Object.assign({},t.attributes);return t.insert&&t.attributes&&t.attributes.dataMetaBlockProps&&(r=(n=JSON.parse(t.attributes.dataMetaBlockProps)).blockType,i=n.props,j.isAnonymousAccess||r!==B.BlockType.CHAT_CARD_BLOCK||(o[be.h]=JSON.stringify(Object(B.generateBlockDataSet)({blockType:r,props:i})),delete o.dataMetaBlockProps)),e.insert(t.insert,o)},new ke.E({zoneId:t.zoneId}));return e.concat(n)}return e.concat(t)},new ke.e)},this.editorWillPaste=function(e){var t=e.isInternalPaste,n=e.deltaSet;return t?(n=E.updateClientSideChatCardProps(n)).reduce(function(e,t){if(t instanceof ke.E){var n=Object(ke.N)(t,function(e){return e.key.startsWith("mention-uuid_")},function(){return{key:"mention-uuid_".concat(Object(me.h)()),value:"true"}});return e.concat(n)}return e.concat(t)},new ke.e):n},this.changesetApply=function(e,t){var n=t.editor,r=function(){if(E.mentionBox&&!Object(oe.$)(".".concat(ye.a).concat(E.uuid)).length)return E.mentionBox.close(),void(E.mentionBox=null);!n.getSelectedRep()||E.keywords&&E.keywords.length||R.c.show(n,E.placeholderText)};t.editor.version.includes(ke.y)?t.editor.once("paint",r):r()},this.aceAttribsToClasses=function(e,t){var n=t.key,r=t.value;if(n!==R.a||R.c.getEnable())return-1<V.indexOf(n)?"".concat(n,"_").concat(r):/mention/.test(n)||/at-(.+)/.test(n)?n:void 0},this.match=function(e){return!(e===R.a&&!R.c.getEnable())&&!!(-1<V.indexOf(e)||/mention/.test(e)||/at-(.+)/.test(e))},this.render=function(e){var t,n=e.attributes,r=e.insert,i="";for(t in n){var o=n[t];t===R.a&&!R.c.getEnable()||(-1<V.indexOf(t)&&(i+="".concat(i?" ":"").concat(t,"_").concat(o)),(/mention/.test(t)||/at-(.+)/.test(t))&&(i+=(i?" ":"")+t))}var a=E.customIconEnable;if(/(^| )mention-token|mention-chatId/.test(i)){var s,c=Object(me.e)(i),u=c.type,l=c.link,d=c.token,f=c.icon,h=l&&decodeURIComponent(l)||"";switch(h&&W.a.isWiki()&&W.a.addTask(h),parseInt(u)){case be.E.GROUP:case be.E.USER:return parseInt(u)===be.E.USER&&d===E.ownerId&&(v="at-self-highlight"),e.class=I()(i,"mention",v),P.a.createElement("a",{href:"javascript:void(0)",contentEditable:"false"},e.children);case be.E.CHAT:s="".concat(j.isAnonymousAccess?Object(me.V)():Object(me.W)({url:h})),v="ignore-dom ".concat(S.a.join(" ")),e.class=I()(i,"mention",v);var p="single-line mention-chat-card ignore-attr-heading";return e.lineClass+=" ".concat(p," ").concat(S.b.join(" ")),P.a.createElement("span",{dangerouslySetInnerHTML:{_html:s}});default:var g=E.props.embedObjShareEnable,m=!(!g||!D.a.getInstance())&&!!D.a.cantReadFiles[d],v="".concat(j.isAnonymousAccess?"popover-disabled":""),b={token:d,type:be.v[u],title:r};g&&!D.a.isEmptyStash()&&D.a.completeInStash(b);var y=E.mentionFileManager;y&&y.completeInStash(Object.assign({},b,{link:l}));var k=m?"content-with-lock":"",O=e.children;return a&&f&&(k+=" content-with-icon",O=P.a.createElement(P.a.Fragment,null,P.a.createElement("i",{style:{backgroundImage:"url(".concat(E.getIconUrl(f),")")},className:"mention-doc-icon ".concat(v)}),e.children)),e.class=I()(i,"mention",v),P.a.createElement(ke.l,{"data-fake-text":r},P.a.createElement("a",{href:h,"data-href":h,rel:"noopener noreferrer",target:"_blank",contentEditable:"false",className:k,onDragStart:E.onDragStart},O))}}else i&&!e.mark&&(e.mark=!0,e.class=i);return e.children},this.onDragStart=function(e){e.preventDefault()},this.handleDidPaste=function(e){var t=e.deltaSet.reduce(function(e,t){if(!(t instanceof ke.E))return e;var n=[];return t.forEach(function(e){e.insert&&e.attributes&&e.attributes[be.h]&&n.push(e.attributes[be.h])}),e.concat(n)},[]);Object(g.a)(t,function(e){E.replaceClientsideChatCard(JSON.parse(e))})},this.handleTableResize=function(){R.c.show(E.editor,E.placeholderText)},this.replaceClientsideChatCard=function(){var t=w()(re.a.mark(function e(t){var n,r,i,o,a,s,c,u,l,d,f,h;return re.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(ie.default)(t,["props","data","chatId"]),r=Object(ie.default)(t,["blockId"]),e.prev=2,e.next=5,Object(m.h)(n);case 5:o=e.sent,i=o.data.Token,e.next=16;break;case 9:return e.prev=9,e.t0=e.catch(2),a=e.t0.code,s=Object(ie.default)(e.t0,["data","RespCode"])||a,c=be.r[s]||p("etherpad.insert_chatcard_failed"),z.a.show({type:"error",closable:!0,content:c}),e.abrupt("return");case 16:if(t.props.data.chatToken=i,u=[["dataMetaBlockProps",JSON.stringify(t)]],l=E.getClientsideChatCardRange(E.editor,r)){e.next=21;break}return e.abrupt("return");case 21:d=l.selStart,f=l.selEnd,h=l.selZone,E.editor.inCallStackIfNecessary("replaceChatCard",function(){E.editor.fastIncorp(),E.editor.performDocumentReplaceRangeWithAttributes(h,d,f," ",u),E.editor.updateBrowserSelectionFromRep()});case 23:case"end":return e.stop()}},e,null,[[2,9]])}));return function(e){return t.apply(this,arguments)}}(),this.getClientsideChatCardRange=function(e,n){var r=be.h,t=function(e,t){return Boolean(e===r&&JSON.parse(t).blockId===n)},i=e.getMatchedAttributePositionOnSelection(null,t)[0];return i?i.docPosition:null},this.aceAfterCompositionEnd=function(e){for(;E.taskQueue.length;){var t=E.taskQueue.pop();Object(d.default)(t)&&t()}},this.processBeforeInsertNode=function(e,t){var n,r=t.entry,i=t.cls;/(^| )mention-token|mention-chatId/.test(i)&&(n=Object(me.e)(i).type,parseInt(n)===be.E.CHAT&&(r.domInfo.lineManagerType="mention_chat"))},this.bufferChanged=function(e,t){E.props.embedObjShareEnable&&E.embedMentionManager.handleBufferChanged(E.editor,t)},this.editorAlinesDidSplice=function(e,t){var n,r,i,o,a,s,c,u,l,d,f,h,p,g,m,v,b,y=E.mentionFileManager,k=E.props.embedObjShareEnable;(k||y)&&(n=t.currentState,i=(r=t.prevState).numToAttrib,o=r.alinesSplice,a=n.numToAttrib,s=n.alinesSplice,c=n.alinesAttribs,l=(u=function(e){return Object(C.a)(me.I,Object(me.m)(e))})(o)(i),d=u(s)(a),f=Object(me.H)(l),h=Object(me.H)(d),p=Object(me.Z)(f,h),m=!!(g=Object(me.Z)(h,f)).length,v=!!p.length,k&&(m&&D.a.addTokenInStash(g),v&&D.a.removeFromStash(p),E.embedMentionManager.processAddTokensFromNewLine({hasAddTokens:m,alinesAttribs:c})),y&&(m&&y.addTokenInStash(g),v&&y.removeFromStash(p),b=m||v,y.spliceLineInZone({preTokenLists:l,curTokenLists:d,context:t,isMentionListChange:b})))},this.linesWillReplace=function(e,t){E.embedMentionManager.handleLinesWillReplace(t)},this.aceCreateDomLine=function(e,t){var n=t.spanClass,r=t.attrObj,i=E.customIconEnable;if(/(^| )mention-token|mention-chatId/.test(n)){var o,a,s,c,u=Object(me.e)(n),l=u.type,d=u.link,f=u.token,h=u.icon,p=d&&decodeURIComponent(d)||"",g=Object(me.X)(E._preventXss(p));switch(parseInt(l)){case be.E.GROUP:case be.E.USER:b='<a href="javascript:void(0)" contenteditable="false">',o="</a>",parseInt(l)===be.E.USER&&f===E.ownerId&&(s="at-self-highlight");break;case be.E.CHAT:a="".concat(j.isAnonymousAccess?Object(me.V)():Object(me.W)({url:p})),s="ignore-dom ".concat(S.a.join(" ")),c="single-line mention-chat-card ignore-attr-heading ".concat(S.b.join(" ")),t.editable=!1;break;default:var m=E.props.embedObjShareEnable,v=!(!m||!D.a.getInstance())&&!!D.a.cantReadFiles[f],b='<a href="'.concat(g,'"data-href="').concat(g,'"\n            rel="noopener noreferrer" target="_blank" contenteditable="false"\n            class="').concat(v?"content-with-lock":""," ").concat(i&&h?"content-with-icon":"",'">');i&&h&&(b+='<i style="background-image:url('.concat(E.getIconUrl(h),')" class="mention-doc-icon" ></i>')),o="</a>",s="".concat(j.isAnonymousAccess?"popover-disabled":"");var y={token:f,type:be.v[l],title:E.decodeText(t.text)};m&&!D.a.isEmptyStash()&&D.a.completeInStash(y);var k=E.mentionFileManager;k&&k.completeInStash(Object.assign({},y,{link:d}))}a?t.rawHtml=a:(t.extraOpenTags="".concat(t.extraOpenTags).concat(ke.B).concat(b),t.extraCloseTags="".concat(o).concat(t.extraCloseTags),E.editor.version.includes(ke.y)||(t.extraOpenHtml=ge.common.OLD_FAKETEXT_PREFIX,t.extraCloseHtml=ge.common.OLD_FAKETEXT_SUFFIX)),t.spanClass=I()(n,"mention",s),t.attributes=Object.assign({},t.attributes,O()({},ke.m,t.text)),E.editor.version.includes(ke.y)||(t.attributes=Object.assign({},t.attributes,{"data-faketext":t.text})),c&&(t.lineClass="".concat(t.lineClass," ").concat(c))}r.chatCardProps&&(t.extraOpenTags="<span class=".concat(be.i,"\n      ").concat(be.j,'="').concat(Object(T.escapeHTML)(r.chatCardProps),'">'),t.extraCloseTags="</span>")},this.getIconUrl=function(e){var t=JSON.parse(e),n=t.type,r=t.key,i=t.fs_unit;return n===j.NUM_CUSTOM_ICON_TYPE.IMAGE?Object(v.e)({key:r,fs_unit:i}):""},this.decodeText=function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x2F;":"/"},n=/&amp;|&lt;|&gt;|&quot;|&#x27;|&#x2F;/gm;return e&&e.replace(n,function(e){return t[e]||e})},this.aceBeforeCopy=function(e){var t,n=window.getSelection();if(n.getRangeAt?t=n.getRangeAt(0):((t=document.createRange()).setStart(n.anchorNode,n.anchorOffset),t.setEnd(n.focusNode,n.focusOffset)),3===t.endContainer.nodeType){var r=Object(ve.c)(t.endContainer,"mention-type_".concat(be.E.USER));if(r){var i=Object(ve.c)(r,"j-block-container");return i?"".concat(i.outerHTML,"<span> </span>"):"".concat(r.outerHTML,"<span> </span>")}}},this.collectContentPre=function(e,t){var n,i,r,o,a,s,c=t.tname,u=t.node,l=t.cc,d=t.state,f=t.cls;if("a"===c){for(;u&&"span"!==c&&"body"!==c;)u=u.parentNode,c=(Object(ie.default)(u,"tagName")||"").toLocaleLowerCase();var h=u&&u.className;h&&-1<h.indexOf("mention")&&Object(g.a)(h.split(" "),function(e){var t;/mention/.test(e)&&"mention"!==e&&(0===e.indexOf("mention-icon")?(t=e.substring("mention-icon_".length),l.doAttrib(d,"mention-icon",t)):l.doAttrib(d,e))})}"span"===c&&f&&-1<f.indexOf("at-holder")&&Object(g.a)(f.split(" "),function(e){/at-(.+)/.test(e)&&l.doAttrib(d,e)}),f&&-1<f.indexOf(be.i)&&(n=Object(oe.$)(u).attr(be.j),l.doAttrib(d,be.h,n),i=d.attribs,r=d.attribString,o=t.cc.apool,a=["author","lineguid",be.h],s=Object.keys(i).reduce(function(e,t){if(a.includes(t)||t.includes("comment"))return e;var n=[t,i[t]].join(","),r=o.attribToNum[n].toString(36);return e.replace(/\*[\da-z]+/g,function(e){return e==="*".concat(r)?"":e})},r),l.lines.appendText(" ",s))},this.afterPasteInsert=function(e,t){var n=t.pasteDataWrapper,r=Object(oe.$)(n).find(".".concat(be.i));r.length&&Object(g.a)(r,function(e){var t=Object(oe.$)(e).attr(be.j);E.replaceClientsideChatCard(JSON.parse(t))})},this.acePaste=function(e,t){var n,r=t.e,i=t.pasteDataWrapper,o=Object(oe.$)(i),a=o.find(".mention");a.length&&(Object(g.a)(a,function(e){var t=Object(me.h)();e.className=e.className.replace(/mention-tempId_\S*/,"").replace(/mention-uuid_\w+/,"mention-uuid_".concat(t))}),n=E.editor.getRep().lines.indexOfKey(r.target.closest(".ace-line").id),E.lastPasteLineNum=n,r.stopImmediatePropagation(),r.preventDefault());var s=o.find(".".concat(be.i));s.length&&Object(g.a)(s,function(e){var t=Object(oe.$)(e).attr(be.j);try{var n=Object(B.generateBlockDataSet)(JSON.parse(t));Object(oe.$)(e).attr(be.j,JSON.stringify(n))}catch(e){throw new Error("[Chatcard]: clientside-props parse error.")}})},this.deleteMentionIfNecessary=ve.a,this.moveCursorIfNecessary=ve.b,this.pushTaskQueue=function(e){E.taskQueue.push(e)},this._getExtendedAttribs=function(){var e=E.editor,t=e.getRep().zoneId,n=Object(ie.default)(e.getAttributesOnSelection(t),"attribs")||[];return n=Object(l.a)(n,function(e){var t=e[0];return-1<["backcolor","bold","italic","underline","inline-code","strikethrough",R.b].indexOf(t)||Object(me.M)(t)})},this._preventXss=function(e){var t=e.trim();return E.isValidScheme(t,j.allowProtocolSchemes)?Object(T.escapeHTML)(t):""},this.isValidScheme=function(e,t){return!(!e||!t)&&new RegExp("^(".concat(t.join("|"),"):")).test(e)},this.isMentionBoxVisible=function(){return E.mentionBox&&E.mentionBox.isVisiable()},this.destory=function(){E.mentionShare&&E.mentionShare.destroy(),E.mentionShare=null,E.embedMentionManager.destroy(),E.taskQueue=[],E.debounceNotifyMentionListChange.cancel(),E.editor&&(E.editor.off("asyncNotifyCallback",E.pushTaskQueue),E.editor.off("colHorzResize",E.handleTableResize),E.editor.off(ke.k.DID_PASTE,E.handleDidPaste),E.editor.off(ke.k.PAINT,E.notifyMentionListChange))};var t=e.editor;this.props=e,this.editor=t,this.ownerId=Object(U.d)(),this.taskQueue=[],this.lastPasteLineNum=null,this.isHoverPopup=!1,this.hidePopupTimeoutId=0,t&&(t.on("asyncNotifyCallback",this.pushTaskQueue),t.on("colHorzResize",this.handleTableResize),t.on(ke.k.DID_PASTE,this.handleDidPaste)),this.mentionShare=new F.a;var n=this.props.embedObjShareEnable?D.a:null;this.embedMentionManager=new b.a(n)}function e(e,t,n){return i.apply(this,arguments)}var i,o;function t(e,t,n){return o.apply(this,arguments)}return c()(r,[{key:"updateKeywords",value:function(e,t){e||"compositionend"!==t.type||R.c.show(this.editor,this.placeholderText),this.keywords=e,this.mentionBox&&this.mentionBox.mounted&&this.mentionBox.setState({keywords:e,type:"search"})}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,r=e.zoneId,i=n;if(t instanceof HTMLElement){var o,a,s=t.className,c=t.tagName,u=c;if("A"===c){for(;t&&"SPAN"!==u&&"BODY"!==u;)t=t.parentNode,u=Object(ie.default)(t,"tagName")||"";var l=t.className||"";-1<l.indexOf("mention")&&Object(g.a)(l.split(" "),function(e){var t;/mention/.test(e)&&"mention"!==e&&(i=0===e.indexOf("mention-icon")?(t=e.substring("mention-icon_".length),Object(ke.H)(i,r,{"mention-icon":t})):Object(ke.H)(i,r,O()({},e,"true")))})}"SPAN"===u&&-1<s.indexOf("at-holder")&&Object(g.a)(s.split(" "),function(e){/at-(.+)/.test(e)&&(i=Object(ke.H)(i,r,O()({},e,"true")))}),-1<s.indexOf(be.i)&&(o=Object(oe.$)(t).attr(be.j),a=new ke.e,i.forEach(function(e,t){var n;a=t===r&&e instanceof ke.E?(n=new ke.E({zoneId:r}).insert(" ",O()({},be.h,o)),a.concat(n)):a.concat(e)}),i=a)}return i}},{key:"serialize",value:function(e){var t=e.type,n=e.node,r=e.op;if(!r)return e;var i,o,a,s=Object(me.r)(r.attributes);return t===ke.u.LEAF&&s["mention-link"]&&(i=decodeURIComponent(s["mention-link"]),(o=document.createElement("span")).classList.add("mention"),Object.keys(r.attributes).forEach(function(e){return e.includes("mention")&&o.classList.add(e)}),(a=document.createElement("a")).setAttribute("rel","noopener noreferrer"),a.setAttribute("href",i),a.dataset.href=i,a.href=i,a.appendChild(n),o.appendChild(a),e.node=o),e}},{key:"showMentionBox",value:(o=w()(re.a.mark(function e(a,s,c){var t,u,l,d,n,f,h,p,g,r,m,i,v,o,b,y,k,O,E,C,I,S,j=this,T=arguments;return re.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=3<T.length&&void 0!==T[3]?T[3]:"@",u=a.rep,l=a.editor,d=s.uuid,this.uuid=d,n=this.props,f=n.type,h=n.boxWidth,p=n.container,g=n.source,r=n.notify,m=void 0===r||r,i=n.mentionBoxParams,v=void 0===i?{}:i,o=n.openDocParams,b=void 0===o?{}:o,y="reminder"===a,k=c.command===be.q.JIRA_ISSUE_BLOCK,R.c.setEnable((Ie||k)&&"doc"===f),c.command?(O=c.command===be.F[be.b.USER]?"@":me.c,this.createBlankDom(a,d,O,u.selStart,!0),s.command=c.command):(this.keywords=t.substr(1),E="".concat(ye.a).concat(d),C=this._getExtendedAttribs(l),I=[["at-holder",!0],[E,!0],[R.b,!0]].concat(ne()(C)),Object(ve.e)(l,[u.selStart[0],u.selStart[1]-t.length],u.selEnd,t,I)),S=function(){var e=w()(re.a.mark(function e(){var t,n,r,i,o;return re.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(oe.$)(p),n=Object(oe.$)(".".concat(ye.a).concat(d)),r=Object(L.a)(n.get(0),l),i=Object(me.v)(n,Object.assign({boxWidth:h,$boxContainer:t,zoom:r,bottomGap:16},Object(M.a)(v))),o=Object(me.F)(i),x.a.modernIE&&(o.height=me.d.boxMinHeight+"px"),j.mentionBox&&j.mentionBox.close(),e.next=9,Object(_.a)(Object.assign({style:o,boxType:f,notify:m,openDocParams:b,token:window.bestPracticeToken||Object(me.u)(),objType:Object(N.l)(),boxContainer:t.get(0),source:g},s,{rep:u,container:p,boxWidth:h,onConfirm:function(e){return j.handleConfirm(e,a,s)},editor:l,onAsideClick:function(){l.updateBrowserSelectionFromRep(!0),l.inCallStackIfNecessary("editorRefocus",function(){l.fastIncorp()})},onClose:function(e){s.command&&j.deleteBlankChar(l,d,e),j.mentionBox=null}}));case 9:j.mentionBox=e.sent,j.placeholderState=R.c.show(l,j.placeholderText),Object(ae.default)("open_mention",{action:Object(ie.default)(c,"data.type"),source:y?"checkbox":f,eventType:Object(ie.default)(c,"e.type")||"keydown",targetId:"",targetClass:"",zone:Object(se.l)(u)});case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),a.editor.version.includes(ke.y)?a.editor.once("paint",S):S();case 11:case"end":return e.stop()}},e,this)})),t)},{key:"deleteBlankChar",value:function(e,t,n){var r,i,o,a,s,c,u,l,d;n||(r="".concat(ye.a).concat(t),i=this._getExtendedAttribs(e),e.inCallStackIfNecessary("collectMentionText",function(){e.fastIncorp()}),o="".concat(ye.a).concat(t),(a=Object(pe.a)(e,o))&&(s=this.getTextOnSelection(e,a),c=a.selStart,u=a.selEnd,l=a.selZone,d=[{start:c,end:u,newText:Object(me.f)(s),attributes:[["at-holder",!0],[r,!0]].concat(i)}],e.callWithAce(function(e){e.fastIncorp(),e.dom?e.performDocumentReplaceMultiRangeWithAttributes(l,d):e.performDocumentReplaceMultiRangeWithAttributes(d),e.version.includes(ke.y)||e.updateBrowserSelectionFromRep(!0)},"filterChar",!0)))}},{key:"getTextOnSelection",value:function(e,t){if(!e)return"";var n=t.selStart,r=t.selEnd,i=t.selZone,o=e.getRep(i).lines.atIndex(n[0]).lineMarker,a=e.getRep(i).lines.atIndex(r[0]).lineMarker,s=Object.assign({},t,{selStart:[n[0],n[1]-o],selEnd:[r[0],r[1]-a]}),c=e.getTextAndAttrsOnSelection(s),u=c.length-1,l="";return c.forEach(function(e,t){var n=e.text,r=t===u&&/\n/.test(n);n&&!r&&(l+=n)}),l}},{key:"createBlankDom",value:function(e,t,n,r,i){var o=e.rep,a=e.editor,s="".concat(ye.a).concat(t),c=this._getExtendedAttribs(a);a.inCallStackIfNecessary("createBlankDom",function(){a.fastIncorp(),Object(ve.e)(a,r,o.selEnd,n,[["at-holder",!0],[s,!0],[R.b,!0]].concat(c),i)},!0)}},{key:"handleConfirm",value:(i=w()(re.a.mark(function e(t,n,r){var i,o,a,s,c,u,l,d,f,h,p,g,m,v,b,y,k,O,E,C,I,S,j,T,w,_,M,x,L,N,R,P,D,U,F,z,B,H,W,V,K,q,Z,Q,J,X,Y,$,ee,te=this;return re.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.editor,o=n.rep,a=r.uuid,s=r.isAPanelPoll,c=t.data,u=t.fromNotification,l=t.isClick,d=t.mentionUuid,f=t.logParams,h=c.type,p=c.token,g=c.url,m=c.shouldNotifyLark,v=c.content,b=c.icon_key,y=c.icon_type,k=c.icon_fsunit,O=this.props.type,E="reminder"===n,C="".concat(ye.a).concat(a),I=Object(pe.b)(i,C),i.version.includes(ke.y)||i.updateBrowserSelectionFromRep(!0),Object(ce.default)(c))return e.abrupt("return");e.next=13;break;case 13:if(!I){e.next=98;break}S=Object(ie.default)(t,"data.type"),j="",e.t0=S,e.next=e.t0===be.E.FILE?19:e.t0===be.E.SHEET?21:e.t0===be.E.BITABLE?23:e.t0===be.E.MINDNOTE?25:e.t0===be.E.BOX?27:e.t0===be.E.SLIDE?29:e.t0===be.E.BLOCK?31:e.t0===be.E.JIRA_FILTER?33:35;break;case 19:return j="doc",e.abrupt("break",35);case 21:return j="sheet",e.abrupt("break",35);case 23:return j="bitable",e.abrupt("break",35);case 25:return j="mindnote",e.abrupt("break",35);case 27:return j="file",e.abrupt("break",35);case 29:return j="slide",e.abrupt("break",35);case 31:return j=Object(ie.default)(t,"data.pollType"),e.abrupt("break",35);case 33:return j="jira_filter",e.abrupt("break",35);case 35:T=Object(ie.default)(t,"data.source"),w=Ie&&this.placeholderState?this.placeholderState:{},Object(fe.a)("confirm_mention").report(Object.assign({source:E?"checkbox":O,event_type:l||S===be.E.BLOCK?"mouseclick":"keydown",mention_type:Object(se.j)(S),mention_sub_type:j,panel_source:r.command||r.isAPanelPoll?"a_panel":"mention_panel",mention_obj_id:Object(le.a)(p),mention_notification_status:m&&m.toString(),zone:Object(se.l)(o),uuid:d,recommend_source:Object(me.s)(T),line_is_empty:Object(me.P)(i)},f,{},w)),de.c[h]&&de.b.markAsDone(de.c[h]),u&&Object(ae.default)("click_confirm_mention_btn",{source:O,confirm_mention_btn_type:u,mention_type:Object(se.k)(S),mention_obj_id:Object(le.a)(p),mention_notification_status:m&&m.toString()}),i.inCallStackIfNecessary("mentionFastIncrop",function(){i.fastIncorp(!0)}),h===be.E.USER&&Object(ae.default)("debug_mention_at_user",{stage:"after:fastIncorp"}),_=Object(oe.$)(".".concat(ye.a).concat(a)),M=I?i.domToRep(_.get(0)):{},x=v,L=" ",N=[["at-holder",0],[C,0],["mention-type_".concat(h),!0],["mention-link_".concat(encodeURIComponent(g)),!0]],R=this._getExtendedAttribs(i),P=i.plugins.blockPlugin,e.t1=h,e.next=e.t1===be.E.USER?52:e.t1===be.E.CHAT?56:e.t1===be.E.GROUP?61:e.t1===be.E.JIRA_FILTER?67:e.t1===be.E.BLOCK?72:e.t1===be.E.INLINE_BLOCK?75:78;break;case 52:return L=" ",N=P.getAttrsFromBlockDataSet(t.data.dataSet),N=[].concat(ne()(R),ne()(N)),e.abrupt("break",84);case 56:return D=M.selStart,(U=M.selEnd)&&P.insertBlock(t.data.dataSet,{selStart:D,selEnd:U,zoneId:D[2]}),this.mentionBox&&this.mentionBox.close(!0),this.mentionBox=null,e.abrupt("return");case 61:return N.push(["mention-tempId_".concat(a),!0]),N.push(["mention-token_".concat(p),!0]),"doc"!==O&&N.push(["mention-notify_".concat(m),!0]),L="@".concat(x),N=N.concat(R),e.abrupt("break",84);case 67:return F=o.selStart[0],z=o.lines.atIndex(F),B=z.width,H=z.lineMarker,L=2<B-H?Object(ue.a)(o,null,M):" ",N=P.getAttrsFromBlockDataSet(t.data.dataSet),e.abrupt("break",84);case 72:return L=Object(ue.a)(o,null,M),N=P.getAttrsFromBlockDataSet(t.data.dataSet),e.abrupt("break",84);case 75:return L=" ",N=P.getAttrsFromBlockDataSet(t.data.dataSet),e.abrupt("break",84);case 78:return N.push(["mention-uuid_".concat(a),!0]),N.push(["mention-token_".concat(p),!0]),b&&N.push(["mention-icon",JSON.stringify({type:y,key:b,fs_unit:k})]),L=x,N=N.concat(R),e.abrupt("break",84);case 84:if(W=Object(pe.a)(i,C)){e.next=87;break}return e.abrupt("return");case 87:V=W.selStart,K=W.selEnd,q=i.getRep().lines.atIndex(K[0]).text.length,K[1]>q&&(K[1]=i.getRep().lines.atIndex(K[0]).text.length),N.some(function(e){return"lineguid"===e[0]})||(Z=o.attributeManager.findAttributeOnLine(V[0],"lineguid"),N.push(["lineguid",Z||Object(Ce.b)()])),he.a.emit("invokeCollapse",{zoneId:o.zoneId,range:{selStart:V,selEnd:K}}),Object(ve.d)(i,V,K,L,N,s),h!==be.E.FILE&&h!==be.E.SHEET&&h!==be.E.BITABLE&&h!==be.E.MINDNOTE&&h!==be.E.SLIDE||(Q=be.v[h],J={uuid:a,container:this.props.container,editor:i,token:p,suiteType:Q,title:L},X=this.props.embedObjShareEnable,Y=function(){X&&te.mentionShare&&te.mentionShare.showPopover(J)},i.version.includes(ke.y)?i.once("paint",Y):Y()),h===be.E.CHAT||h===be.E.BLOCK?($=o.selStart[0]+1,"\n"!==L.slice(-1)&&$<o.lines.length()&&i.inCallStackIfNecessary("insertChatPerformRepChange",function(){i.dom?i.performSelectionChange(o.zoneId,[$,0],[$,0]):i.performSelectionChange([$,0],[$,0])})):h!==be.E.INLINE_BLOCK&&h!==be.E.USER||(i.inCallStackIfNecessary("insertInlineBlockPerformRepChange",function(){i.performSelectionChange(o.zoneId,o.selStart,o.selEnd)}),h===be.E.USER&&(ee=[V[0],V[1]+L.length],Object(ve.f)(i,ee,ee,R),h===be.E.USER&&Object(ae.default)("debug_mention_at_user",{stage:"after:performSpace"}))),h!==be.E.FILE&&h!==be.E.SHEET&&h!==be.E.BITABLE&&h!==be.E.MINDNOTE&&h!==be.E.SLIDE&&h!==be.E.BOX||"full_comment"===O||"part_comment"===O||!Object(Ee.a)()||Object(Oe.b)(ge.onboarding.STEP_TYPES.doc_relation_graph_guide);case 98:r.isAPanelPoll||(this.mentionBox&&this.mentionBox.close(!0),this.mentionBox=null);case 99:case"end":return e.stop()}},e,this)})),e)},{key:"placeholderText",get:function(){return this.mentionBox&&this.mentionBox.state.activeMentionType===be.q.JIRA_ISSUE_BLOCK?Object(E.h)()===H.a.HAS_CONNECTED?p("explorer.search"):"":p("doc.mention.placeholder")}}]),r}())||e;q.a=K}).call(this,Z("2vAP"))},CVSs:function(e,t,n){"use strict";n.r(t),n.d(t,"setFailedServices",function(){return i}),n.d(t,"clearFailedServices",function(){return o});var r=n("jp/M"),i=function(e){return{type:r.actionTypes.service.SET_FAILED_SERVICES,payload:e}},o=function(e){return{type:r.actionTypes.service.CLEAR_FAILED_SERVICES,payload:e}}},Cy2Z:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return h});var r=n("p3Wu"),i=n("H6oK"),o=n("IcLG"),a=n("46iY"),s=n("SLR9"),c=n("WtIE"),u=n("TBry"),l=n("hJmJ"),d=n("DNsP"),f=[i.IGNORE_HYPERLINK_CLASS,i.IGNORE_LINE_BACKGROUND_CLASS,o.b,a.a,s.a,c.a,u.a,d.l],h=[r.a,l.b]},D1oa:function(e,t,n){"use strict";function r(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n.buffer}function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))}n.d(t,"c",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var o="image/png";function a(e){var t=s(e),n=new DataView(e),r=new Blob([n],{type:t||o});return{blobUrl:URL.createObjectURL(r),mime:t}}function s(e){for(var t=e.slice(0,4),t=new Uint8Array(t),n=[],r=0;r<t.byteLength;r++)n.push(t[r].toString(16));return c(n.join("").toUpperCase())}function c(e){switch(e){case"89504E47":return"image/png";case"47494638":return"image/gif";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":case"FFD8FFE2":case"FFD8FFE3":case"FFD8FFE8":return"image/jpeg";case"52494646":return"image/webp";default:return""}}},D28M:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"p",function(){return o}),n.d(t,"n",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"q",function(){return d}),n.d(t,"l",function(){return f}),n.d(t,"b",function(){return h}),n.d(t,"o",function(){return p}),n.d(t,"j",function(){return g}),n.d(t,"m",function(){return m}),n.d(t,"k",function(){return v}),n.d(t,"d",function(){return b}),n.d(t,"r",function(){return k}),n.d(t,"i",function(){return O}),n.d(t,"e",function(){return E});var r=n("nVH4");function i(t){for(var e,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.classList?r.forEach(function(e){return t.classList.add(e)}):t.getAttribute&&(e=(t.getAttribute("class")||"").split(" ").filter(function(e){return!r.includes(e)}).concat(r).join(" "),t.setAttribute("class",e))}function o(t){for(var e,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.classList?r.forEach(function(e){return t.classList.remove(e)}):t.getAttribute&&(e=(t.getAttribute("class")||"").split(" ").filter(function(e){return!r.includes(e)}).join(" "),t.setAttribute("class",e))}function a(e){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:document).querySelector(e)}function s(e,t){return e.classList?e.classList.contains(t):!!e.getAttribute&&(e.getAttribute("class")||"").split(" ").some(function(e){return e===t})}function c(e,t){return e.classList?Array.from(e.classList).find(function(e){return 0===e.indexOf(t)}):!!e.getAttribute&&(e.getAttribute("class")||"").split(" ").find(function(e){return 0===e.indexOf(t)})}function u(e,t){for(var n=!1,r=0;r<t.length;r++)c(e,t[r])&&(n=!0);return n}function l(e){var t=document.createElement("style");return t.appendChild(document.createTextNode(e)),t}function d(e){var t;!e||(t=e.parentNode)&&t.removeChild(e)}function f(e,t){for(;e;){if(s(e,t))return!0;e=e.parentNode}return!1}function h(e,t){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function p(e,t){for(;e;){if(s(e,t))return e;e=e.parentNode}return null}function g(e){var t=e.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function m(e){return e.previousElementSibling||e.previousSibling}function v(e){return e.nextElementSibling||e.nextSibling}function b(e,t){if(!e)return null;for(var n=e,r=0;n!==t&&null!==n;){r+=n.offsetTop;var i=n.offsetParent||y(n);if(!(i instanceof HTMLElement))return console.error(i,"is not HTMLElement"),null;n=i}return r}function y(e){return e&&e.classList.contains("ace-line-collapsed")?e.parentNode:null}function k(e,t){var n=b(e,t);null!==n&&(t.scrollTop=n)}function O(e){return!!e.setAttribute}function E(e){return e instanceof HTMLElement&&-1!==e.className.indexOf(r.b)&&e.dataset.magicdomid&&document.getElementById(e.dataset.magicdomid)||e}},DGTj:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n("J4zp"),d=n.n(r),i=n("RIqP"),f=n.n(i),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),u=n("H6oK"),h=n("y2sV"),p=!1,l=!1,g=!1,m=function(){function n(e){var t=this;a()(this,n),this.editor=e,this.wordBreakRegex=/^[`!@#$%^&*()+{}|:"<>[\];',.\\=\s\-/]$/,this.wordPrevBreakRegex=/^[\s\-\\"'[({#$`]$/,this.wordNextBreakRegex=/^[\s\-\\"'()[\]{}?,.!;:_@#%&*]$/,this.shouldAddPrevSpaceRegex=/^[a-zA-Z0-9~!%^&*)+|\]}”～\\’,.:·;?<>=]$/,this.shouldAddNextSpaceRegex=/^[a-zA-Z0-9~$^<>`+“|～‘=]$/,this.handleCopy=function(){var e=t.editor.getRep();t.checkAutoSpaceEnable(e)},this.handleCut=function(){var e=t.editor.getRep();t.checkAutoSpaceEnable(e),t.removeExtraSpace(e)},this.aceCopy=function(){var e=t.editor.getRep();t.checkAutoSpaceEnable(e)},this.aceCut=function(){var e=t.editor.getRep();t.checkAutoSpaceEnable(e),t.removeExtraSpace(e)},this.editor.on(h.k.COPY,this.handleCopy),this.editor.on(h.k.CUT,this.handleCut)}return c()(n,[{key:"isLineBlockOrImage",value:function(e,t){try{var n=this.editor.getAllAttributesOnLine(e,t),r=n.find(function(e){return"gallery"===e[0]}),i=n.find(function(e){return"dataMetaBlockProps"===e[0]&&e[1]}),o=i&&JSON.parse(i[1]).props.displayMode===u.BlockDisplayMode.INLINE;return r||i&&!o}catch(e){return!1}}},{key:"getExtendAttributes",value:function(e){return f()(e.filter(function(e){return["underline","backcolor","strikethrough"].includes(e[0])}))}},{key:"isSelStartLineStart",value:function(e){return e.lines.isStartOfLine(e.selStart[0],e.selStart[1])}},{key:"isSelEndLineEnd",value:function(e){return e.lines.isEndOfLine(e.selEnd[0],e.selEnd[1])}},{key:"isPrevCharLineMarker",value:function(e){var t=e.lines.atIndex(e.selStart[0]);return 0!==t.lineMarker&&t.lineMarker===e.selStart[1]}},{key:"shouldAddPrevSpace",value:function(e){var t=e.selStart,n=e.lines.atIndex(t[0]).text[t[1]-1];return!l&&!this.isPrevCharLineMarker(e)&&this.shouldAddPrevSpaceRegex.test(n)}},{key:"shouldAddNextSpace",value:function(e){var t=e.selEnd,n=e.lines.atIndex(t[0]).text[t[1]];return!g&&this.shouldAddNextSpaceRegex.test(n)}},{key:"removeExtraSpace",value:function(e){var t,n,r,i,o,a,s,c,u=e.selStart,l=e.selEnd,d=e.zoneId;u&&l&&(u[0]!==l[0]||u[1]!==l[1])&&(u[0]===l[0]&&this.editor.isImageLine(e.zoneId,u[0])||(t=e.lines.atIndex(u[0]),n=e.lines.atIndex(l[0]),r=t.text[u[1]-1],i=n.text[l[1]],o=this.isSelStartLineStart(e)||this.wordPrevBreakRegex.test(r),a=this.isSelEndLineEnd(e)||this.wordNextBreakRegex.test(i),s=f()(u),c=f()(l)," "===i&&o&&!this.isLineBlockOrImage(d,l[0])?c[1]+=1:" "===r&&a&&!this.isLineBlockOrImage(d,u[0])&&--s[1],this.editor.version.includes(h.y)?this.editor.selection.setSelection({start:{line:u[0],offset:u[1],zoneId:d},end:{line:l[0],offset:l[1],zoneId:d}},!0):(this.editor.selection.setWithSelection(e.zoneId,s,c),this.editor.updateBrowserSelectionFromRep(!0))))}},{key:"checkAutoSpaceEnable",value:function(e){var t,n,r,i,o=e.selStart,a=e.selEnd,s=e.zoneId;o&&a&&(t=e.lines.atIndex(o[0]),n=e.lines.atIndex(a[0]),l=" "===t.text[o[1]],g=" "===n.text[a[1]-1],r=(this.isSelStartLineStart(e)||this.wordBreakRegex.test(t.text[o[1]-1])||l)&&!this.isLineBlockOrImage(s,o[0]),i=(this.isSelEndLineEnd(e)||this.wordBreakRegex.test(n.text[a[1]])||g)&&!this.isLineBlockOrImage(s,a[0]),p=r&&i)}},{key:"editorWillPaste",value:function(e){var t=e.deltaSet,n=e.zoneId,r=e.isInternalPaste;if(!p||!r)return t;var i,o,a,s,c=t,u=this.editor.getRep(),l=function(e){return e.reduce(function(e,t){var n=d()(t,2),r=n[0],i=n[1];return e[r]=i,e},{})};return this.shouldAddPrevSpace(u)&&(i=u.attributeManager.getAttributesOnPosition(u.selStart[0],u.selStart[1]),o=new h.E({zoneId:n}).insert(" ",l(this.getExtendAttributes(i))).concat(c.get(n)),c=c.replace(n,o)),this.shouldAddNextSpace(u)&&(a=u.attributeManager.getAttributesOnPosition(u.selEnd[0],this.isSelEndLineEnd(u)?u.selEnd[1]:u.selEnd[1]+1),s=new h.E({zoneId:n}).concat(c.get(n)).insert(" ",l(this.getExtendAttributes(a))),c=c.replace(n,s)),c}},{key:"beforePaste",value:function(e,t){var n,r,i,o,a;p&&0!==t.pasteTimes&&(r=(n=this.editor.getRep()).selStart,i=n.selEnd,o=n.zoneId,r&&i&&this.shouldAddPrevSpace(n)&&(a=n.attributeManager.getAttributesOnPosition(r[0],r[1]),this.editor.performDocumentReplaceRangeWithAttributes(o,r,r," ",this.getExtendAttributes(a)),this.editor.selection.setWithSelection(o,[r[0],r[1]+1],[i[0],r[0]===i[0]?i[1]+1:i[1]]),this.editor.updateBrowserSelectionFromRep(!0)))}},{key:"afterPaste",value:function(e,t){var n,r,i,o,a;p&&0!==t.pasteTimes&&(r=(n=this.editor.getRep()).selStart,i=n.selEnd,o=n.zoneId,r&&i&&this.shouldAddNextSpace(n)&&(a=n.attributeManager.getAttributesOnPosition(i[0],this.isSelEndLineEnd(n)?i[1]:i[1]+1),this.editor.performDocumentReplaceRangeWithAttributes(o,i,i," ",this.getExtendAttributes(a))))}},{key:"aceKeyEvent",value:function(e,t){var n,r=t.evt;r.ctrlKey||r.shiftKey||r.altKey||r.metaKey||"Backspace"!==r.key&&"Delete"!==r.key||(n=this.editor.getRep(),this.removeExtraSpace(n))}},{key:"destroy",value:function(){this.editor.off(h.k.COPY,this.handleCopy),this.editor.off(h.k.CUT,this.handleCut)}}]),n}()},E3B5:function(e,t,n){"use strict";var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),u=n("Nsbk"),l=n.n(u),d=n("7W2i"),f=n.n(d),h=n("q1tI"),p=n.n(h),g=(n("17x9"),n("i7Dq")),m=n("y2hG"),v=n.n(m),b=(n("7lqQ"),function(e){function t(){return i()(this,t),c()(this,l()(t).apply(this,arguments))}return f()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.url,r=e.userId,i=e.className,o=e.tip,a=e.token,s=e.popover,c=e.popoverPlacement,u=e.onVisibleChange;return p.a.createElement(g.a,{className:"note-avatar ".concat(i||""," note-user__default"),dataSrc:n,token:a,src:v.a,title:t||"","data-set-id":r,useBackground:!0,tip:o,popover:s,popoverPlacement:c,onVisibleChange:u})}}]),t}(h.PureComponent));t.a=b},F9bh:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("RIqP"),E=n.n(r),C=n("FJEn");function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},y=e.checkAttributeApplied,k=e.ignoreAttrs,t=e.includeTitle,O=void 0!==t&&t;return function(e,t,n){var b=n.value;n.value=function(r){var i=this,o=this.editor,e=r.attribKey,t=r.attribValue,n=r.dRep,a=[],s=y||o.isRangesHaveAttributeApplied,c=o.managers.getLineManagerWithSpecialSelection();if(n)a.push(Object.assign({},o.getRep(n.zoneId),{},n));else if(c&&c.getSelectedZonesWithVisible)c.getSelectedZonesWithVisible().forEach(function(e){var t=o.getRep(e),n=t.lines.length()-1,r=t.lines.atIndex(n).width-1;a.push(Object.assign({},t,{alines:t.alines,alltext:t.alltext,apool:t.apool,zoneId:e,selStart:[0,0],selEnd:[n,r]}))});else{var u=o.getRep(),l=u.selStart,d=u.selEnd,f=u.zoneId;if(!O&&u.zoneId===C.DEFAULT_REP_ZONE&&0===l[0]){if(0===d[0])return;var h=[1,0],p=E()(l),g=0===d[0]&&E()(d);o.selection.setWithSelection(f,h,g?h:d),o.updateBrowserSelectionFromRep(!0)}a.push(u)}var m,v=s(a,e,t,k);return a.forEach(function(e){var t=!(!c||!c.getSelectedZonesWithVisible),n=Object.assign({},r,{range:e,isAllHasAttrib:v,isSpecialSelection:t});b.call(i,n)}),p&&(m=o.getRep(),o.selection.setWithSelection(m.zoneId,p,g||m.selEnd),o.updateBrowserSelectionFromRep(!0)),v}}}},FGOA:function(e,t,n){"use strict";var i,a=n("HmyT"),o=n("1dfU"),s=n("skFV"),c=n("2ACu"),u=n("U6jp"),r=0,l=800,d={init:function(){r||d.bindEvent(),r++},destory:function(){--r||d.unbindEvent()},bindEvent:function(){d.handleEventBinding("on")},unbindEvent:function(){d.handleEventBinding("off")},handleEventBinding:function(e){Object(a.$)(document)[e]("openLark",".js-open-lark",d.handleOpenLark),Object(a.$)(document)[e]("click",".js-open-lark",d.handleOpenLark),Object(a.$)(window)[e]("blur beforeunload",d.handleBlur)},handleOpenLark:function(e){var t=Object(a.$)(e.currentTarget),n=t.data("id"),r=t.data("source"),i=t.data("type"),o=t.data("is-cross-tenant");d.openLark(n,r,i,o)},handleBlur:function(e){i&&clearTimeout(i),i=null},isOpenCurrentChat:function(e){return u.r&&Object(u.o)()&&String(e)===Object(u.i)()},openLark:function(e,t,n,r){this.isOpenCurrentChat(e)||(d.handleBlur(),i=setTimeout(function(){var e=Object(s.s)();window.open(e.downloadLark)},l),Object(u.x)(e)),Object(c.default)("click_chat_btn",{source:t||"doc",chat_type:"6"===n?"group":"0"===n?"P2P":"chat",mention_obj_id:Object(o.a)(e),is_external:r})}};t.a=d},FI0B:function(e,t,n){"use strict";var r=n("pVnL"),i=n.n(r),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",i()({width:"10",height:"11",viewBox:"0 0 10 11"},t),c.a.createElement("path",{d:"M3.84 10.9l4.98-4.53a.5.5 0 000-.74L3.84 1.1a.5.5 0 00-.84.37v9.06a.5.5 0 00.84.37z",fillRule:"evenodd"}))}},GACP:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),i=n.n(r),o=function(e){var r=e.children&&i.a.Children.toArray(e.children),t=e.name,n=r?t.split(/(\$\{[0-9]+})/g).map(function(e){var t=/\$\{([0-9]+)}/.exec(e);if(t){var n=parseInt(t[1],10)-1;return r[n]}return e}):t;return e.noWrapper?i.a.createElement(i.a.Fragment,null,n):i.a.createElement("span",null,n)};n.d(t,"I18n",function(){return o})},GGpJ:function(e,Y,$){"use strict";$.r(Y),function(m){var e=$("lwsE"),i=$.n(e),t=$("W8MJ"),n=$.n(t),r=$("a1gu"),o=$.n(r),a=$("Nsbk"),c=$.n(a),s=$("7W2i"),u=$.n(s),l=($("TaAU"),$("q1tI")),v=$.n(l),b=$("UAY2"),d=($("17x9"),$("TSYQ")),y=$.n(d),k=$("9g7G"),f=$("mRaX"),h=$("6dGb"),p=$("n6KG"),g=$.n(p),O=$("AiBH"),E=$("nHtH"),C=$("QM+C"),I=$("GBY4"),S=$.n(I),j=$("UlbS"),T=$("+/Fj"),w=$("XMIC"),_=$("MUo5"),M=$("m/+l"),x=$("D7h9"),L=$("YO6O"),N=$("jp/M"),R=$("2ACu"),P=$("NtTV"),D=$("r5mi"),U=$("/fVd"),F=$("VI6H"),z=$("IyQe"),B=$("5cZX"),H=$("1dfU"),W={permission:{Icon:T.a,msg:m("shortcut.no_access_tips"),msgExternal:m("permission.embed.external_cannot_apply_permission")},error:{Icon:h.a,msg:m("shortcut.loading_fail_tips")},notPreviewable:{Img:g.a}},V=320,K=320,q=function(e){return{embedObjPermissions:Object(B.y)(e)}},Z={openModal:w.c,sendSuitePermissionRequest:_.sendSuitePermissionRequest},Q=function(e){function r(e){var s;i()(this,r),(s=o()(this,c()(r).call(this,e))).loadDocInfo=function(){var e=s.props,i=e.token,o=e.sourceString;Object(k.d)({type:s.objTypeString,token:i}).then(function(e){var t,n,r;s.mounted&&(n=(t=e.data).edit_time,r=t.title,Object(f.Y)(o,!1,"file",i),s.setState({editTime:n,title:r}))})},s.loadShortcutImage=function(){var e=s.props,t=e.token,n=e.link,r=Date.now();s.getImageSrc(s.objTypeString,t,n).then(function(e){var t=e&&e.src,n=e&&e.isIcon;s.setShortState({status:!0,startRequestTime:r,src:t,isIcon:n})},function(e){if(e&&e.specialSuite)s.setShortState({status:!1,startRequestTime:r,specialSuiteInfo:e.info,reason:JSON.stringify(e.info)});else{if(Boolean(e&&e.noPermitted))return s.setShortState({status:!1,startRequestTime:r,errType:"permission",reason:"no permission"}),void s.setState({hasNoPermissionByShortCutImage:!0});s.objTypeString!==C.FILE_TYPE.FILE?s.setShortState({status:!1,startRequestTime:r,errType:"error",reason:"error"}):s.setShortState({status:!1,startRequestTime:r,errType:"notPreviewable",reason:"not previewable"})}})},s.handleApplyEmbedObjPermission=function(){var e=s.props,t=e.sendSuitePermissionRequest,n=e.token,r=e.type,i=e.closePopover,o=O.v[r]||r,a="";s.owner&&(a=Object(F.p)(s.owner,s.owner.get("name"))),t(n,o,C.PERMISSION.READABLE,"",a),Object(R.default)("click_embed_quick_apply",{from:"hover"}),i&&i()},s.handleOpenEmbedShareModal=function(){var e=s.props,t=e.openModal,n=e.token,r=e.title,i=e.closePopover,o=e.type,a={token:n,type:O.v[o]||o,title:r,permission:s.embedObjPermission};Object(f.L)(O.u.CLICK_EMBED_QUICK_SHARE,{from:"hover"}),t(N.ui.MODAL_TYPES.EMBED_SHARE,{embedObj:a}),i&&i()},s.getImageSrc=function(e,t,n){var r,i={sourceForLog:C.FILE_PREVIEW_SOURCE_FOR_LOG.docPopover,fileToken:t,fileType:C.mapFileType2TypeNum[e],clientHeight:V,clientWidth:K};return!n||e!==C.FILE_TYPE.MINDNOTE||(r=new S.a(n).hash)&&1<r.length&&(i.hash=encodeURIComponent(r.slice(1))),Object(P.d)(i)};var t=s.hasNoPermission;s.state=Object.assign({loaded:t,errType:t?"permission":"",specialSuiteInfo:null,hasNoPermissionByShortCutImage:!1},e),s.isNeedFetchEmbedPerm=!1;var n=e.type;return s.objTypeString=s.getObjTypeString(n),s}return u()(r,e),n()(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.embedObjShareEnable,n=e.disableAddEmbedObj;t&&!n&&(U.a.addEmbedObj([{num:1,obj:this.embedObject}]),U.a.sendEmbedObjsToManager([this.embedObject])),this.mounted=!0,this.hasNoPermission||(this.loadDocInfo(),this.loadShortcutImage())}},{key:"componentWillUnmount",value:function(){this.props.disableAddEmbedObj||U.a.removeEmbedObj([{num:1,obj:this.embedObject}]),this.mounted=!1,this.isNeedFetchEmbedPerm&&(U.a.fetchEmbedObjsPerm(),this.isNeedFetchEmbedPerm=!1)}},{key:"getObjTypeString",value:function(e){var t=O.v[e]||e;return C.mapTypeNumToFileType[t]}},{key:"setShortState",value:function(e){var t=e.errType,n=e.specialSuiteInfo,r=e.src,i=e.isIcon,o=e.status,a=e.reason,s=e.startRequestTime,c=this.props,u=c.token,l=c.sourceString;this.setState({loaded:!0,errType:t,src:r,isIcon:i,specialSuiteInfo:n}),Object(f.S)({status:o,source:l,type:this.objTypeString,token:u,reason:a,cost_time:Date.now()-s})}},{key:"arrayBufferToBase64",value:function(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,i=0;i<r;i++)t+=String.fromCharCode(n[i]);return window.btoa(t)}},{key:"renderError",value:function(){var e=this.state,t=e.errType,n=e.hasNoPermissionByShortCutImage,r=this.props.embedObjShareEnable,i=this.owner,o=this.embedObjPermission,a=W[t];if("notPreviewable"===t){var s=a.Img;return v.a.createElement("section",{className:"mention-pop"},v.a.createElement("div",{className:"short-cut__notPreviewable layout-row"},v.a.createElement("img",{src:s,className:"short-cut__img"})),this.renderBottomBar())}var c=a.msgExternal,u=a.Icon,l=a.msg;if("permission"===t&&r)if(o&&i){if(i&&i.get("can_apply_perm")){var d=Object(F.p)(i,i.name);return v.a.createElement("section",{className:"mention-pop"},v.a.createElement("div",{className:"short-cut__error"},v.a.createElement("div",{className:"short-cut__error__permission"},v.a.createElement("i",null,v.a.createElement(u,null)),v.a.createElement("span",{className:"permission-text"},m("permission.embed.contact_author"),v.a.createElement(L.default,{className:"cooperater-user-popover",source:"permission_request",token:i.get("id"),name:d,trigger:"hover",placement:"lb",usePopover:!0},v.a.createElement("a",{className:"permission-request-owner"},d+m("permission.embed.owner"))),m("permission.embed.share_tips_5"))),v.a.createElement(j.Button,{onClick:this.handleApplyEmbedObjPermission,type:"primary"}," ",m("permission.embed.apply_btn")," ")))}i&&!i.get("can_apply_perm")&&(l=c)}else{this.isNeedFetchEmbedPerm=!0;var f=W.error,u=f.Icon,l=f.msg;n&&(u=W.permission.Icon,l=W.permission.msg)}return v.a.createElement("div",{className:"short-cut__error layout-cross-center layout-row"},v.a.createElement("i",{className:"short-cut__icon"},v.a.createElement(u,null)),v.a.createElement("p",{className:"short-cut__msg"},l))}},{key:"renderBottomBar",value:function(){var e=this.state.editTime;return e?v.a.createElement("div",{className:"mention-pop__time"},m("shortcut.last_update_time"),Object(E.a)(e)):null}},{key:"handleImageLoaded",value:function(e){URL.revokeObjectURL(e)}},{key:"handleImageError",value:function(e,t,n,r){Object(R.default)("mention_snapshot_src_error",{src:Object(H.a)(e),source:t,mention_type:r,mention_obj_id:Object(H.a)(n)}),URL.revokeObjectURL(e)}},{key:"render",value:function(){var e=this,t=this.state,n=t.loaded,r=t.src,i=t.isIcon,o=t.errType,a=t.specialSuiteInfo,s=this.props,c=s.embedObjShareEnable,u=s.sourceString,l=s.token,d=s.type,f=this.embedObjPermission,h=f&&f.canInvite,p=!Object(k.j)();if(!n)return v.a.createElement("div",{className:"layout-main-center layout-cross-center layout-row popover-loading"},v.a.createElement(b.a,null));if(o)return this.renderError();var g=y()("mention-pop__shortcut",{"mention-pop__shortcut-default-icon":i});return v.a.createElement("section",{className:"mention-pop"},v.a.createElement("div",{className:g},r&&v.a.createElement("img",{onLoad:function(){return e.handleImageLoaded(r)},onError:function(){return e.handleImageError(r,u,l,d)},src:r}),a&&v.a.createElement(D.a,{className:"mention-snapshot-special_suite",code:a.code})),p&&h&&c&&v.a.createElement("div",{className:"mention-pop__quick-share"},v.a.createElement("div",{className:"share-notify"},v.a.createElement(T.a,{className:"permission-warning-icon"}),v.a.createElement("span",{className:"warning-text"},m("permission.embed.share_tips_2"))),v.a.createElement(j.Button,{type:"primary",onClick:this.handleOpenEmbedShareModal},m("permission.embed.share_btn"))),this.renderBottomBar())}},{key:"embedObject",get:function(){var e=this.props,t=e.token,n=e.type,r=e.title;return{token:t,type:O.v[n]||n,title:r}}},{key:"embedObjPermission",get:function(){var e=this.props,t=e.embedObjPermissions,n=e.token,r=t&&t.get(n);return r?Object(z.embedObjPermission2Booleans)(r.get("permission")):null}},{key:"hasNoPermission",get:function(){var e=this.embedObjPermission;return!!e&&e.cantRead}},{key:"owner",get:function(){var e=this.props,t=e.embedObjPermissions,n=e.token,r=t&&t.get(n);return r?r.get("owner"):null}}]),r}(l.Component);Q.defaultProps={embedObjShareEnable:!1};var J=Object(M.connect)(q,Z)(Q),X=function(e){function t(){return i()(this,t),o()(this,c()(t).apply(this,arguments))}return u()(t,e),n()(t,[{key:"render",value:function(){return v.a.createElement(M.Provider,{store:x.default},v.a.createElement(J,this.props))}}]),t}(l.Component);Y.default=X}.call(this,$("2vAP"))},GixS:function(e,t,n){"use strict";n.d(t,"i",function(){return r}),n.d(t,"j",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"h",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"e",function(){return l}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return f});var r="table-toolbar-perf-adaptor",i="table-will-delete-cell",o=3,a=19,s=14,c=30,u=30,l=-5,d=1,f=0},Guq5:function(e,t,n){"use strict";var r,i;n.d(t,"a",function(){return r}),(i=r=r||{}).A_PANEL="a_panel",i.BLOCK_MENU="block_menu"},Gz0X:function(e,t,n){"use strict";n.r(t);var r=n("fywt"),i=n("RQWm");function o(e,t){return e&&e.length?Object(i.a)(e,Object(r.a)(t,3)):[]}t.default=o},HjLD:function(e,t,n){"use strict";var r,i;n.d(t,"a",function(){return r}),(i=r=r||{}).Readable="readable",i.Editable="editable"},I2ZF:function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);function i(e,t){var n=t||0;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}e.exports=i},Ibn6:function(e,t,n){"use strict";function r(){var e=!1,t={get passive(){e=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch(e){}return e}t.a=r()},IcLG:function(e,t,n){"use strict";n.d(t,"b",function(){return y}),n.d(t,"a",function(){return k});var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),u=n("q1tI"),l=n.n(u),d=n("YWBl"),f=n("7Kxq"),h=n("YNKm"),p=n("F9bh"),g=n("y2sV"),m=n("Nl7c"),v=n("OWch"),b=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},y="IGNORE_BOLD",k=function(){function t(e){var a=this;i()(this,t),this.editor=e,this.className="Bold",this.aceInitialized=function(e,t){a.init(t.editorInfo)},this.init=function(e){e.commands.registerAceCommand(h.i,function(e,t,n,r){var i=r.source,o=a.toggleAttribute({attribKey:"bold",attribValue:!0});Object(d.a)({action:"bold",op:o?f.g:f.f,source:i})},{statusKey:"bold-true"})},this.aceAttribsToClasses=function(e,t){return"bold"===t.key?["tag:b"]:[]},this.editor=e,this.init(e)}return a()(t,[{key:"toggleAttribute",value:function(e){var t=e.attribKey,n=e.attribValue,r=e.range,i=e.isSpecialSelection,o=e.isAllHasAttrib,a=r.selStart,s=r.selEnd,c=r.attributeManager;return i?(c.setAttributesOnRange(a,s,[[t,o?"":n]]),o):this.editor.toggleAttributeOnSelection(t,r,n)}},{key:"match",value:function(e){return"bold"===e}},{key:"isBoldElement",value:function(e){var t=e.tagName,n=e.getAttribute("style")||"";return"B"===t||"STRONG"===t||/\bfont-weight:\s*bold\b/i.test(n)}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,r=e.zoneId;return t&&t instanceof HTMLElement&&this.isBoldElement(t)?Object(g.H)(n,r,{bold:"true"}):n}},{key:"serialize",value:function(e){return Object(g.P)(e,{tagAttribute:"bold",wrapTag:g.a.bold})}},{key:"render",value:function(e){var t=e.children;return l.a.createElement(g.w,{style:{fontWeight:"bold"}},t)}}]),t}();b([Object(p.a)()],k.prototype,"toggleAttribute",null),b([v.a,Object(m.b)()],k.prototype,"render",null)},J21X:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),u=n("ucr6"),l=n("4PSP"),d=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},f="",h=function(){function t(e){i()(this,t),this.needReminderCount=0,this.unsavedTip=e.unsavedTip||f,window.addEventListener("beforeunload",this.handleBeforeUnload)}return a()(t,[{key:"addReminder",value:function(){var t=this;this.needReminderCount++,1<this.needReminderCount||(this.unblock=u.a.block(function(e){if(e.pathname!==window.location.pathname)return t.unsavedTip}))}},{key:"removeReminder",value:function(){this.needReminderCount=Math.max(0,this.needReminderCount-1),0===this.needReminderCount&&this.unblock&&this.unblock()}},{key:"handleBeforeUnload",value:function(e){0<this.needReminderCount&&(e.preventDefault(),e.returnValue=this.unsavedTip)}},{key:"destroy",value:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload),this.needReminderCount=0,this.unblock&&this.unblock()}}]),t}();d([l.Bind],h.prototype,"handleBeforeUnload",null)},JyuV:function(e,t,n){"use strict";var r=n("pVnL"),i=n.n(r),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",i()({width:"34",height:"44",xmlnsXlink:"http://www.w3.org/1999/xlink"},t),c.a.createElement("defs",null,c.a.createElement("path",{d:"M2.32 0h21.74c.4 0 .8.16 1.09.45l8.36 8.36c.29.29.45.68.45 1.1v31a2.32 2.32 0 01-2.32 2.31H2.32A2.32 2.32 0 010 40.9V2.32A2.32 2.32 0 012.32 0z",id:"22472075bc7cd30e21af05b843e9b64f-a"})),c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("mask",{id:"22472075bc7cd30e21af05b843e9b64f-b",fill:"#fff"},c.a.createElement("use",{xlinkHref:"#22472075bc7cd30e21af05b843e9b64f-a"})),c.a.createElement("use",{fill:"#DEE0E3",xlinkHref:"#22472075bc7cd30e21af05b843e9b64f-a"}),c.a.createElement("path",{d:"M24.7-1.54l10.8 10.8h-8.49a2.32 2.32 0 01-2.31-2.31v-8.5z",fill:"#BBBFC4",mask:"url(#22472075bc7cd30e21af05b843e9b64f-b)"}),c.a.createElement("path",{d:"M4.63 13.9h24.7v24.69H4.63z"}),c.a.createElement("path",{d:"M18.21 32.42c.17 0 .31.13.31.3v1.7a.3.3 0 01-.3.31H8.01a.3.3 0 01-.3-.3v-1.7c0-.18.14-.31.3-.31h10.2zm7.72-6.95c.17 0 .31.14.31.3v1.7a.3.3 0 01-.3.31H8.02a.3.3 0 01-.31-.3v-1.7c0-.17.14-.31.3-.31h17.91zm0-6.95c.17 0 .31.14.31.31v1.7a.3.3 0 01-.3.3H8.02a.3.3 0 01-.31-.3v-1.7c0-.17.14-.3.3-.3h17.91z",fill:"#FFF"})))}},JznU:function(e,t,n){"use strict";function r(e,t){return{top:(e.top||0)*t,bottom:(e.bottom||0)*t,left:(e.left||0)*t,right:(e.right||0)*t,height:(e.height||0)*t,width:(e.width||0)*t,x:(e.x||0)*t,y:(e.y||0)*t}}n.d(t,"a",function(){return r})},KCMi:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return d});var r=n("RIqP"),i=n.n(r),o=n("BmhO"),a=n("3doy"),s=n("VI6H"),c=10485760;function u(e,t){return{controls:!0,autoplay:!0,sources:[{src:e,type:/^mp3/i.test(t)?"audio/".concat(t):/^mov/i.test(t)?"video/mp4":"video/".concat(t)}]}}function l(e,t){return p(e)||t&&h(e)}function d(e,t){return Object(s.f)()&&f(e)&&t<=c}function f(e){return/(^| )docx|doc|xlsx|xls|pptx|ppt|pdf/i.test(e)}function h(e){return[].concat(i()(a.PDFPreviewTypes),i()(o.L)).includes(e.toLowerCase())}function p(e){return o.d.includes(e.toLowerCase())}},Kboj:function(e,K,q){"use strict";(function(j){q.d(K,"a",function(){return V});var e=q("J4zp"),a=q.n(e),t=q("lwsE"),n=q.n(t),r=q("W8MJ"),i=q.n(r),o=q("Z0Cl"),s=q("lE2N"),C=q("CpTu"),c=q("7EGn"),u=q("hMnB"),T=q.n(u),L=q("HmyT"),w=q("AiBH"),N=q("mRaX"),l=q("9g7G"),R=q("eySY"),I=q("M8cP"),_=q("PX10"),d=q("zhgJ"),M=q("2ACu"),P=q("1dfU"),f=q("n/R6"),h=q("Wc+A"),p=q("QM+C"),D=q("y2sV"),U=q("rLED"),S=q("EVj1"),F=q("Yspk"),g=w.t.UP,m=w.t.DOWN,v=w.t.RIGHT,b=w.t.LEFT,y=w.t.BACKSPACE,k=w.t.RETURN,O=w.t.ESC,E=w.t.TAB,x=w.t.SPACE,z=1e3,B="A",H=Object(d.b)(),W="0",V=function(){function x(e){var E=this;n()(this,x),this.editor=e,this.ignore=!1,this.space=!0,this.UNSAFE_editorNormalizePasteNode=function(e){var t,n,r,i,o,a,s,c,u,l,d,f,h,p,g,m,v,b=e.types,y=e.data,k=y.node,O=y.text;H||(n=(t=getSelection())&&(t.extentNode||t.focusNode),r=Object(L.$)(n).closest(".comment-textarea").length,i=E.editor.getRep(),!Object(C.a)(b,function(e){return"text/plain"===e})||0===r&&"0"===i.zoneId&&0===i.selStart[0]||(o=O,(a=Object(R.b)(o,!1))&&(s=a.preText,c=a.restText,u=Object(S.f)(o),(l=o.substring(s.length,u.length-c.length)).startsWith("http")&&(d=E.editor.getAuthor(),f=Object(N.h)(),h=x.HOLDER_PREFIX+f,v=!1,v=0<r?(p=Object(R.a)(l,h,d,E.space,[s,c]),k.innerHTML=p,!0):Object(R.c)({wrapper:k,pureUrl:l,holderCls:h,author:d,useSpace:E.space,filteredTextGroup:[s,c]}),E.space=!0,v&&(E.doReplace(E.editor,l,a,f,"acePaste"),Object(M.default)("client_paste_url",{url_host:Object(I.b)(l),url_parse_type:"first_party"}),g=a.token,m=a.type,Object(M.default)("client_insert_url",{create_source:"link_to_mention",has_text:!!o,insert_token:Object(P.a)(g),insert_type:m}))))))},this.mentionShare=new h.a}return i()(x,[{key:"clearReplaceTimer",value:function(){this.replaceTimer&&clearTimeout(this.replaceTimer)}},{key:"aceKeyEvent",value:function(e,t){var n,r,i,o,a,s,c,u,l,d,f,h,p,g,m,v,b,y,k,O,E,C=this,I=t.evt,S=t.editor,j=I.type,T=I.keyCode,w=I.altKey,_=I.ctrlKey,M=I.metaKey;"keydown"===j&&(this.ignore=w||_||M),"keyup"!==j||-1<x.BLACK_LIST.indexOf(T)||S.getInInternationalComposition()||(null===(n=getSelection())||(r=n.extentNode||n.focusNode)&&(i=r.nodeValue,o=r.parentNode,a=r.previousSibling,this.ignore||Object(L.$)(r).closest('[class*="comment-id-"]').length?this.ignore=!1:(this.clearReplaceTimer(),(o.tagName.toUpperCase()===B&&Object(R.b)(i)||-1<o.className.toLowerCase().indexOf("url")&&a&&Object(R.b)(a.textContent+i))&&(s=S.getAuthor(),c=i,u=!1,o.tagName.toUpperCase()!==B&&(c=a.textContent+i,u=!0),l=Array.from(o.classList).find(function(e){return-1<e.indexOf(x.HOLDER_PREFIX)})||"",(d=this.getMentionSelectionRange(S,l))&&(f=d.selStart,h=d.selEnd,g=void 0===(p=d.selZone)?W:p,m=this.getExtendedAttribs(S),v=Object(N.h)(),b=x.HOLDER_PREFIX+v,(y=Object(R.b)(c))&&(this.space=!1,k=y.protocol,O=y.type,E=y.token,u&&(h[1]+=i.length),this.performMentionHolder(S,f,h,g,c,[["author",s],[x.HOLDER_CLASS,!0],[b,!0]].concat(m)),this.replaceTimer=setTimeout(function(){C.doReplace(S,c,{type:O,token:E,protocol:k},v,"aceKeyEvent")},z)))))))}},{key:"acePaste",value:function(e,t){var n,r,i,o,a,s,c,u,l,d,f,h,p,g,m,v,b,y,k,O,E;H||(n=t.e,r=t.pasteDataWrapper,i=t.editorInfo,o=t.text,a=n.originalEvent.clipboardData||window.clipboardData,c=(s=getSelection())&&(s.extentNode||s.focusNode),u=Object(L.$)(c).closest(".comment-textarea").length,l=i.getRep(),a&&Object(C.a)(a.types,function(e){return"text/plain"===e})&&(0!==u||"0"!==l.zoneId||0!==l.selStart[0])&&(d=o||a.getData("text/plain"),(f=Object(R.b)(d,!1))&&(h=f.preText,p=f.restText,(m=(g=Object(S.f)(d)).substring(h.length,g.length-p.length)).startsWith("http")&&(v=i.getAuthor(),b=Object(N.h)(),y=x.HOLDER_PREFIX+b,0<u?(k=Object(R.a)(m,y,v,this.space,[h,p]),t.pasteDataWrapper.innerHTML=k):Object(R.c)({wrapper:r,pureUrl:m,holderCls:y,author:v,useSpace:this.space,filteredTextGroup:[h,p]}),this.space=!0,this.doReplace(i,m,f,b,"acePaste"),Object(M.default)("client_paste_url",{url_host:Object(I.b)(m),url_parse_type:"first_party"}),O=f.token,E=f.type,Object(M.default)("client_insert_url",{create_source:"link_to_mention",has_text:!!d,insert_token:Object(P.a)(O),insert_type:E})))))}},{key:"linkToMention",value:function(e,t){var n=t.editor,r=t.url,i=t.node,o=Object(N.h)();Object(L.$)(i).addClass("".concat(x.HOLDER_PREFIX+o));var a=Object(R.b)(r);a&&this.doReplace(n,r,a,o,"linkToMention")}},{key:"actionLink2Mention",value:function(e,t){var n=e.getRep(),r=e.getAuthor(),i=n.selStart,o=n.selEnd,a=n.zoneId,s=Object(N.h)(),c=x.HOLDER_PREFIX+s,u=this.getExtendedAttribs(e),l=Object(R.b)(t);l&&(this.space=!1,this.performMentionHolder(e,i,o,a,t,[["author",r],[x.HOLDER_CLASS,!0],[c,!0],["url",!0]].concat(u)),this.doReplace(e,t,l,s,"actionLink2Mention"))}},{key:"performMentionHolder",value:function(e,t,n,r,i,o){var a=this;e.inCallStackIfNecessary("performMentionHolder",function(){e.fastIncorp(),e.performDocumentReplaceRangeWithAttributes(r,t,n,i,a._uniqAttrs(o))})}},{key:"_uniqAttrs",value:function(e){return Object(s.a)(e,function(e){return e[0]})}},{key:"getExtendedAttribs",value:function(e){var t=Object(c.default)(e.getAttributesOnSelection(),"attribs")||[];return t=Object(o.a)(t,function(e){var t=e[0];return-1<["backcolor","bold","italic","underline","strikethrough"].indexOf(t)})}},{key:"doReplace",value:function(b,y,e,k,t){var O=this,E=e.type,C=e.token,I=e.protocol,S=p.NUM_SUITE_TYPE[E.toUpperCase()];p.suiteType.includes(S)&&(Object(M.default)("doc_replace_suite_url",{create_source:"link_to_mention",insert_token:Object(P.a)(C),insert_type:E,replace_source:t}),Object(l.d)({type:E,token:C}).then(function(e){var t=e.data;if(!b.getInInternationalComposition()){b.inCallStackIfNecessary("performMentionHolder",function(){b.fastIncorp()});var n="".concat(x.HOLDER_PREFIX).concat(k),r=O.getMentionSelectionRange(b,n);if(r){var i=r.selStart,o=r.selEnd,a=r.selZone,s=void 0===a?W:a,c=b.getAuthor(),u=t.title,l=w.E.BOX;switch(E){case"doc":l=w.E.FILE,u=u||j("common.unnamed_document");break;case"sheet":l=w.E.SHEET,u=u||j("common.unnamed_sheet");break;case"bitable":l=w.E.BITABLE,u=u||j("common.unnamed_bitable");break;case"mindnote":l=w.E.MINDNOTE,u=u||j("common.unnamed_mindnote");break;case"slide":l=w.E.SLIDE,u=u||j("common.unnamed_slide");break;case"wiki":l=w.E.WIKI,u=u||j("common.unnamed_document")}I||(I=window?T.a.protocol:"https",y="".concat(I,"//").concat(y));var d,f=t.icon_type,h=t.icon_key,p=t.icon_fsunit,g=[["author",c],["at-holder",0],["at-uuid_"+k,0],["mention-type_".concat(l),!0],["mention-link_".concat(encodeURIComponent(y)),!0],["mention-token_".concat(C),!0],["mention-uuid_".concat(k),!0]];f&&h&&g.push(["mention-icon",JSON.stringify({type:f,key:h,fs_unit:p||""})]),g.some(function(e){return"lineguid"===e[0]})||(d=b.getRep(s).attributeManager.findAttributeOnLine(i[0],"lineguid"),g.push(["lineguid",d||Object(F.b)()]));var m=O.getExtendedAttribs(b);i[1]=O.space&&0<i[1]?i[1]-1:i[1],Object(_.d)(b,i,o,u,g.concat(m),!1,s);var v=function(){var e={container:".doc-position",uuid:k,editor:b,token:C,suiteType:S,title:u};Object(U.s)()&&O.mentionShare&&O.mentionShare.showPopover(e),Object(N.L)(w.u.SHOW_EMBED_QUICK_SHARE_TIP,{token:Object(P.a)(C),suiteType:S,title:u});var t=[i[0],i[1]+u.length],n=[["author",c]].concat(m);Object(_.f)(b,t,t,n,s)};b.version.includes(D.y)?b.once("paint",v):v()}}}).catch(function(e){Object(M.default)("dev_parse_link_failed",{code:e.code||-99,msg:e.message}),f.a.error({content:j("mention.parse_link_failed")})}))}},{key:"getMentionSelectionRange",value:function(e,t){if(t){var n=null,r=function(e){return-1<e.indexOf(t)},i=e.getMatchedAttributePositionOnSelection(n,r),o=a()(i,1)[0];if(o)return o.docPosition}return null}},{key:"reset",value:function(){this.ignore=!1,this.mentionShare&&this.mentionShare.destroy(),this.mentionShare=null,this.clearReplaceTimer()}}]),x}();V.BLACK_LIST=[g,m,v,b,y,k,O,E,x],V.HOLDER_PREFIX="link-mention-uuid_",V.HOLDER_CLASS="link-mention-holder",K.b=new V}).call(this,q("2vAP"))},"Kn+I":function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var r=n("peh1"),i=n("A2D6"),o=function(e){return e.appState.userSettings},a=Object(r.createSelector)(o,function(e){return{src_lang:Object(i.b)("lang")||"zh",permission_type:e.get("permission_type"),allow_share_outside:e.get("allow_share_outside"),lang_correction_perm:e.get("lang_correction_perm"),enable_auto_capitalize:e.get("enable_auto_capitalize"),smart_compose_setting:e.get("smart_compose_setting"),smart_compose_personalization_setting:e.get("smart_compose_personalization_setting")}}),s=Object(r.createSelector)(o,function(e){return{target_lang:e.get("target_lang"),enable_auto_translate:e.get("enable_auto_translate"),shield_auto_translate_langs:e.get("shield_auto_translate_langs").toJS(),global_display_type:e.get("global_display_type"),languages_display_type:e.get("languages_display_type").toJS(),enable_auto_translate_doc_body:e.get("enable_auto_translate_doc_body"),enable_auto_translate_doc_comment:e.get("enable_auto_translate_doc_comment"),is_user_translate_vip:e.get("is_user_translate_vip")}})},L1JX:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("4D8z"),c=function(){function t(){i()(this,t)}return a()(t,[{key:"IS_FS_MODE",get:function(){return t.isFSMode}},{key:"TABLE_FULL_WIDTH_RIGHT",get:function(){return t.isFSMode?0:s.y}},{key:"TABLE_RIGHT_SHADOW_OFFSET",get:function(){return t.isFSMode?0:s.C}},{key:"TABLE_FULL_WIDTH_WITH_COMMENT_RIGHT",get:function(){return t.isFSMode?20:s.z}}],[{key:"setIsFSMode",value:function(e){t.isFSMode=e}}]),t}();c.isFSMode=!1;var u=new c},LFUy:function(e,t,n){"use strict";var r=n("7Kxq"),i=function(e){var t=$(e);return t.hasClass(r.d)||t.children().hasClass(r.d)};t.a=i},LrQZ:function(e,t,n){"use strict";n.d(t,"a",function(){return I}),n.d(t,"b",function(){return S}),n.d(t,"c",function(){return j}),n.d(t,"d",function(){return T});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e,t,n){return void 0===n&&(n=""),t.split(".").reduce(function(e,t){return e&&e[t]||n},e)}var a={jsHeapSizeLimit:0,totalJSHeapSize:0,usedJSHeapSize:0};function d(){var e=o(window,"performance.memory");return e?{jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}:a}var s,c,u=100,f=50,h=(v.prototype.getAnrTime=function(){var e=performance.now()-this.lastTime-u;return f<e&&!this.isPaused?this.anrTime+e:this.anrTime},v.prototype.init=function(){this.hasInit||(this.hasInit=!0,this.start(),document.addEventListener("visibilitychange",this.handleVisibilityChange))},v.prototype.destroy=function(){this.hasInit&&(this.pause(),document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.hasInit=!1)},v.prototype.start=function(){this.isPaused&&(this.isPaused=!1,this.lastTime=performance.now(),this.timeoutId=setTimeout(this.anrCalculator,u))},v.prototype.pause=function(){!this.isPaused&&this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null,this.isPaused=!0)},v),p=(c=null,function(){return null==c&&(c=new h),c}),g=(i(m,s=Error),m);function m(e){void 0===e&&(e="");var t=s.call(this,e)||this;return t.name="QuickJSSDKError",t}function v(){var n=this;this.hasInit=!1,this.isPaused=!0,this.anrTime=0,this.lastTime=0,this.anrCalculator=function(){var e=performance.now(),t=e-n.lastTime-u;f<t&&(n.anrTime+=t),n.lastTime=e,n.timeoutId=setTimeout(n.anrCalculator,u)},this.handleVisibilityChange=function(){var e=document.visibilityState;"hidden"===e?n.pause():"visible"===e&&n.start()}}function b(e){return parseFloat((e/1024).toFixed())}var y=(C.prototype.updateConfig=function(e){this.config=l(l({},this.config),e)},C.prototype.eventBegin=function(e,t){void 0===t&&(t={});var n,r=performance.now(),i=d(),o=this.anrRecorder.getAnrTime();this.eventMap.has(e)?(n=this.eventMap.get(e),this.eventMap.set(e,l(l(l(l({},n),{begin:r,anrBegin:o}),i),{eventParams:t}))):this.eventMap.set(e,l(l({begin:r,anrBegin:o},i),{eventParams:t}))},C.prototype.eventEnd=function(e,t){var n,r=Math.round;if(void 0===t&&(t={}),!this.eventMap.has(e))return this.recordError("event "+e+" doesn't exsit"),this.eventMap.delete(e);var i=d(),o=this.eventMap.get(e),a=this.anrRecorder.getAnrTime()-o.anrBegin,s=performance.now()-o.begin,c=b(i.totalJSHeapSize-o.totalJSHeapSize),u=b(i.usedJSHeapSize-o.usedJSHeapSize);this.recordEvent(e,l(l(((n={duration:r(s)}).ANR_time=r(a),n.totalJSHeapSizeDelta=c,n.usedJSHeapSizeDelta=u,n),o.eventParams),t)),this.eventMap.delete(e)},C.prototype.pageVisible=function(e,t){var n=Math.floor;void 0===t&&(t={});var r=performance.now();this.anrRecorder.init(),this.recordEvent(e,l({ttv:n(r)},t)),3e5<r?this.recordError("ttv: long time error ("+r+")"):2e4<r&&this.recordError("ttv: long long time error ("+r+")")},C.prototype.recordEvent=function(e,t){var n=this.config.eventRecordHandler,r=t.duration,i=t.ttv;return r&&0<r||i&&0<i?void("function"==typeof n&&n({eventName:e,data:t})):this.recordError("Invalid event end: "+e)},C.prototype.recordError=function(e){var t=this.config.errorHandler;"function"==typeof t&&t(new g(e))},C),k=null,O=!1,E=window.performance&&window.performance.memory;function C(e){this.eventMap=new Map,this.config={},this.anrRecorder=p(),this.config=e}function I(e,t){!E||k&&k.eventBegin(e,t)}function S(e,t){!E||k&&k.eventEnd(e,t)}function j(e,t){!E||O||(O=!0,k&&k.pageVisible(e,t))}function T(e){null===k?k=new y(e):k.updateConfig(e)}},MHQM:function(e,t,n){"use strict";n.r(t);var r=n("m/+l"),i=n("urrH"),o=function(e){return{}},a={},s=Object(r.connect)(o,a,null,{forwardRef:!0})(i.a);t.default=s},MRgF:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAblJREFUWAntlutqwzAMhZXYubejY+//eBtsMNZdmjZtks7H1NCO2LGcFfIjgpISS8efJUd29Py6PdOMLJ4Ri0ZZgMYqsmRoLENyzME1XuYplUVCUgjt1nYd1fsT1YejK8w5FgQUxxE9PpSUpbfhaSwpTSQVeUIfXzX1Pb+jBO2hIZjrZQMUPiHGBkKZ/mZmaGL4wJdrfCC1Z3wN+4trbCCzgX0m4vgaPTaQCbzXkw2ET9vXOL5Gkw2EPuNrHF+jyQdSTa85tibe+oRPSINkA4EATc8FhTH4hNhtq/VUQAd+3+50n5nF0WG4UZKQspj4oWdQyYaE/uvd7ICC9tB1NnDyx1GkX/Xnc9AJf63HBkqkoDyT+oCV6r+BMaKAattOf4WHpqWT+s8xLyChslCVGRVZQkK4qwxA3InwW1dEXdfTvjnRrm6o87gfjQKtq5xWZUrRpSyc1cIXC1ipxVRFSj/1kb53B6eEE+hpU3ndfZwzXAaxoHWVqcwJ3cNsMdb8IzM+FzGbsO09NKFtMysQ7sX3Mpe2FUiObN4psC5tK9CUCafEWjf1y9vnFN3g2NllaAEaq+WSobEM/QLXwnoWJHnraQAAAABJRU5ErkJggg=="},MvBO:function(e,t,n){"use strict";var d=n("D1oa"),f=n("2IHA"),h=n("NtTV"),l=n("ahx2"),p=n("toa8"),g=n("rLED"),m={"use-new-default-thumbnail":"true"};function r(i){var o=i.url,a=i.key,s=i.iv,c=i.cancelToken,u=i.logger,l=!1;return new Promise(function(n,r){u&&(u.logValue("request_cdn_necessary",!0),u.logStartTime("request_cdn_time_cost"));var t=Object(p.d)({url:o,responseType:"arraybuffer",withCredentials:!1,ignoreInterceptors:!0,timeout:i.timeout});function e(t){return function(e){if(l)throw new Error;return t(e)}}c&&c.promise.then(function(e){r(e),t.abort(),l=!0}),t.then(function(e){var t=e.data;return u&&(u.logEndTime("request_cdn_time_cost"),u.logValue("size",t.byteLength),u.logValue("decrypt_necessary",!0),u.logStartTime("decrypt_time_cost")),Object(f.c)(t,window.atob(a),window.atob(s),f.a["AES-GCM"])}).then(e(function(e){u&&u.logEndTime("decrypt_time_cost");var t=Object(d.a)(e);n(t)})).catch(function(e){var t,n;l||(t=Object(h.e)(e),u&&(n=Object(h.f)(t),u.getLogValue("decrypt_necessary")?(u.logValue("decrypt_fail",!0),u.logValue("decrypt_fail_reason",n)):(u.logValue("request_cdn_fail",!0),u.logValue("request_cdn_fail_reason",n))),r(t))})})}function i(e){var r=e.url,i=e.cancelToken,a=e.logger,s=!1;return new Promise(function(o,t){a&&(a.logValue("request_origin_necessary",!0),a.logStartTime("request_origin_time_cost"));var n=Object(p.d)({url:r,responseType:"arraybuffer",ignoreInterceptors:!0});i&&i.promise.then(function(e){t(e),n.abort(),s=!0}),n.then(function(e){var t=e.headers,n=e.data;if(a&&a.logEndTime("request_origin_time_cost"),t["content-type"].includes("json")){var r=JSON.parse(Object(d.b)(n));throw{info:"[".concat(r.code,"]").concat(r.message)}}a&&a.logValue("size",n.byteLength);var i=Object(d.a)(n);o(i)}).catch(function(e){s||(a&&a.logValue("request_origin_failed",!0),t(Object(h.e)(e)))})})}function o(e){var o=e.url,a=e.key,s=e.cancelToken,c=e.logger,u=!1;return new Promise(function(n,r){c&&(c.logValue("request_suite_necessary",!0),c.logStartTime("request_suite_time_cost"));var t=Object(p.d)({url:o,params:{adapter:"front"},headers:Object.assign({},Object(g.P)()&&m),responseType:"arraybuffer",withCredentials:!0,ignoreInterceptors:!0});function e(t){return function(e){if(u)throw new Error;return t(e)}}s&&s.promise.then(function(e){r(e),t.abort(),u=!0});var i=!1;t.then(function(e){var t=e.headers,n=e.data;if(c&&c.logEndTime("request_suite_time_cost"),i=!!t["access-new-default-thumbnail"],t["content-type"].includes("json")){var r=JSON.parse(Object(d.b)(n));if(l.SpecitalSuiteCodeList.includes(r.code))throw{specialSuite:!0,info:r};if(r.code===l.STATUS_CODE.FORBIDDEN)throw{noPermitted:!0,info:"no permission"};throw{info:"[".concat(r.code,"]").concat(r.msg)}}return c&&(c.logValue("size",n.byteLength),c.logValue("decrypt_necessary",!0),c.logStartTime("decrypt_time_cost")),Object(f.d)(a,f.b["SHA-256"]).then(function(e){return Object(f.c)(n.slice(16),e.slice(0,32),n.slice(0,16),f.a["AES-CBC"])})}).then(e(function(e){c&&c.logEndTime("decrypt_time_cost");var t=Object(d.a)(e);n(Object.assign({},t,{isIcon:i}))})).catch(function(e){var t,n;u||(t=Object(h.e)(e),c&&(n=Object(h.f)(t),c.getLogValue("decrypt_necessary")?(c.logValue("decrypt_fail",!0),c.logValue("decrypt_fail_reason",n)):(c.logValue("request_suite_failed",!0),c.logValue("request_suite_fail_reason",n))),r(t))})})}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o})},NbI8:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return r});var r,i,o="new_image_upload_event",a="new_image_upload_start",s="new_image_upload_end",c="play_big_gif",u="display_new_gallery",l="external_save_status";(i=r=r||{}).EXEC_URL_TO_FILE_FAIL="EXEC_URL_TO_FILE_FAIL",i.OVER_FILE_SIZE_LIMIMT="OVER_FILE_SIZE_LIMIMT"},NdYY:function(e,t,n){},Nl7c:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n("FJEn");function c(e,t){return e===r.DEFAULT_REP_ZONE&&0===t}function i(){var s=this;return function(e,t,n){var a=n.value;return a instanceof Function&&(n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],i=r.zoneId,o=r.children;return c(i,r.index)?o:a.apply(s,t)}),n}}function o(){var o=this;return function(e,t,n){var i=n.value;return i instanceof Function&&(n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0].lineState;return c(r.getZoneId(),r.index)?null:i.apply(o,t)}),n}}},NtTV:function(e,t,n){"use strict";var i,r;function u(e){return e?null!=e.info?e:null!=e.code?{info:"code: ".concat(e.code)}:e.toString?{info:e.toString()}:{}:{}}function l(e){if(!e)return"unknown";if(e.specialSuite){var t=e.info;return"SpecialSuite-".concat(t.code)}return e.info}(r=i=i||{}).init="init",r.opened="opened",r.loaded="loaded",r.cancelled="cancelled";var o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),d=n("sLU5"),f=n("OX8E"),h=n("093l"),p=n("Ibn6"),g=n("bdgK"),m=n("ifKl"),v=n("4TP3"),b=n("TGBA"),y=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5;a()(this,t),this.runningPool={},this.currentRunningSize=0,this.waitingQueue=[],this.maxRunningSize=e}return c()(t,[{key:"addTask",value:function(e){this.currentRunningSize<this.maxRunningSize?this.runTask(e):this.waitTask(e)}},{key:"runTask",value:function(e){var t=this,n=function(){t.onFinishRunningTask(e.id)};e.onLoad=n,e.onCancel=n,this.currentRunningSize++,(this.runningPool[e.id]=e).send()}},{key:"waitTask",value:function(e){var t=this;e.onCancel=function(){t.onFinishWaitingTask(e)},this.waitingQueue.push(e)}},{key:"onFinishRunningTask",value:function(e){delete this.runningPool[e],this.currentRunningSize--;var t=this.waitingQueue.shift();t&&this.runTask(t)}},{key:"onFinishWaitingTask",value:function(e){Object(v.a)(this.waitingQueue,e)}},{key:"removeAllTasks",value:function(){var t=this;0<this.waitingQueue.length&&(this.waitingQueue.forEach(function(e){e.onCancel=m.default,e.cancel()}),this.waitingQueue.length=0),0<this.currentRunningSize&&Object(b.a)(this.runningPool).forEach(function(e){e.onCancel=m.default,e.onLoad=m.default,e.cancel(),delete t.runningPool[e.id],t.currentRunningSize--})}}]),t}(),k=n("o0o1"),O=n.n(k),E=n("lSNA"),C=n.n(E),I=n("yXPU"),S=n.n(I),j=n("Olm7"),T=n("jp/M"),w=n("toa8"),_=n("3doy"),M=function(){function e(){var t=this;a()(this,e),this.sendDatas={},this.responses={},this.getResponsePromiseCallbacks={},this.fetchs=[],this.timer=null,this.sendRequests=function(){t.timer=null;var e=Object.values(t.sendDatas).map(function(e){return t.convertSendDataToRequestSendData(e)});t.sendDatas={},t.doSendRequests(e)}}function t(e){return n.apply(this,arguments)}var n;return c()(e,[{key:"addRequest",value:function(e){var t=e.token;this.responses[t]||this.isCurrentTokenInRequest(t)||(this.sendDatas[t]=e,this.timer&&window.clearTimeout(this.timer),this.timer=window.setTimeout(this.sendRequests,100))}},{key:"getResponse",value:function(r){var i=this,e=new Promise(function(e,t){var n=i.responses[r.token];n?n.isSuccess?e(n.data):t():i.isCurrentTokenInRequest(r.token)?i.getResponsePromiseCallbacks[r.token]={resolve:e,reject:t}:(i.getResponsePromiseCallbacks[r.token]={resolve:e,reject:t},i.doSendRequests([i.convertSendDataToRequestSendData(r)]))});return e.abort=function(){var e=i.getResponsePromiseCallbacks[r.token];e&&(e.reject(),delete i.getResponsePromiseCallbacks[r.token])},e}},{key:"doSendRequests",value:(n=S()(O.a.mark(function e(t){var n,r,i,o=this;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(w.d)({url:T.apiUrls.POST_FILE_CDN_URL,method:T.apiUrls.METHOD.POST,headers:{"Content-Type":"application/json"},data:t}),this.fetchs.push({fetch:n,tokens:t.reduce(function(e,t){return Object.assign({},e,C()({},t.file_token,!0))},{})}),e.prev=2,e.next=5,n;case 5:r=e.sent,i={},r&&r.data&&r.data.forEach(function(e){i[e.file_token]=e}),t.forEach(function(e){var t=e.file_token,n=i[t];o.responses[t]={data:n,isSuccess:Boolean(n)};var r=o.getResponsePromiseCallbacks[t];r&&(n?r.resolve(n):r.reject(),delete o.getResponsePromiseCallbacks[t])}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:return e.prev=13,Object(j.a)(this.fetchs,function(e){return e.fetch===n}),e.finish(13);case 16:case"end":return e.stop()}},e,this,[[2,11,13,16]])})),t)},{key:"convertSendDataToRequestSendData",value:function(e){return{file_token:e.token,width:e.width,height:e.height,policy:_.PostFileCdnUrlPolicy.allow_up}}},{key:"isCurrentTokenInRequest",value:function(t){return Boolean(this.sendDatas[t]||this.fetchs.find(function(e){return e.tokens[t]}))}},{key:"reset",value:function(){this.fetchs.forEach(function(e){e.fetch.abort()}),this.fetchs=[],this.sendDatas={},this.responses={},this.timer&&window.clearTimeout(this.timer)}}]),e}(),x=n("AYG9");function L(e,t){var n="function"==typeof e?e():e;return void 0!==n?n:t}var N="client_grid_view_scroll",R=function(){function i(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a()(this,i),this.isStoppedFetchImgSrc=!1,this.viewportParam={},this.scrollEvent=d.a.PC.DRIVE.GridView.gridScroll,this.resizeEvent=d.a.PC.DRIVE.GridView.gridResize,this.onResizeEnd=function(){n.isStoppedFetchImgSrc=!1,f.a.emit(n.resizeEvent)},this.onScrollEnd=function(){n.isStoppedFetchImgSrc=!1,f.a.emit(n.scrollEvent),Object(x.c)(N)},this.onScrollStart=function(){n.isStoppedFetchImgSrc=!0,n.fetchImgSrcTaskQueue.removeAllTasks(),Object(x.b)(N)},this.onResizeStart=function(){n.isStoppedFetchImgSrc=!0,n.fetchImgSrcTaskQueue.removeAllTasks(),n.parallelRequestKeyManager.reset()},this.toggleBindEvent=function(e,t){t?n.bindEvent(e):n.unbindEvent()};var t=e.scrollEvent,r=e.resizeEvent;this.fetchImgSrcTaskQueue=new y,this.parallelRequestKeyManager=new M,t&&(this.scrollEvent=t),r&&(this.resizeEvent=r)}return c()(i,[{key:"bindEvent",value:function(e){this.resizeEventRemover=this.detectResizeEvent(e,this.onResizeStart,this.onResizeEnd),this.scrollEventRemover=this.detectScrollEvent(e,this.onScrollStart,this.onScrollEnd)}},{key:"unbindEvent",value:function(){this.resizeEventRemover&&this.resizeEventRemover.removeEvent(),this.scrollEventRemover&&this.scrollEventRemover.removeEvent()}},{key:"isInViewport",value:function(e){var t={top:0,bottom:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},n=L(this.viewportParam.top,t.top),r=L(this.viewportParam.bottom,t.bottom),i=e.getBoundingClientRect(),o=i.top;return n<=i.bottom&&o<=r}},{key:"setViewportParam",value:function(e){this.viewportParam=e}},{key:"removeAllTasks",value:function(){this.fetchImgSrcTaskQueue.removeAllTasks(),this.parallelRequestKeyManager.reset()}},{key:"detectScrollEvent",value:function(e,t,n){var r=new P(t,n);return e.addEventListener("scroll",r.handleEvent,!!p.a&&{passive:!0}),{removeEvent:function(){r.destroyEvent(),e.removeEventListener("scroll",r.handleEvent)}}}},{key:"detectResizeEvent",value:function(e,t,n){var r=new P(t,n),i=new g.default(Object(h.a)(r.handleEvent));return i.observe(e),{removeEvent:function(){r.destroyEvent(),i.disconnect()}}}}]),i}(),P=function(){function r(e,t){var n=this;a()(this,r),this.handleEvent=function(){window.clearTimeout(n.isEventProcessing),n.isEventProcessing||n.onStart(),n.isEventProcessing=window.setTimeout(function(){n.isEventProcessing=void 0,n.onEnd()},200)},this.onStart=e,this.onEnd=t}return c()(r,[{key:"destroyEvent",value:function(){this.isEventProcessing&&window.clearTimeout(this.isEventProcessing)}}]),r}(),D=n("fp5s"),U=n("mbpr"),F=n("lAOT"),z=function(){function e(){var n=this;a()(this,e),this.state=i.init,this.onCancel=m.default,this.onLoad=m.default,this.cancelSource=F.b.source(),this.logger=new U.a,this.wrapWithCancel=function(t){return function(e){if(n.isCancelled())throw new Error;return t(e)}},this.id=Object(D.a)("_FetchImgSrcTask_")}return c()(e,[{key:"setState",value:function(e){this.state=e}},{key:"getLog",value:function(){return this.logger.getLog()}},{key:"isCancelled",value:function(){return this.state===i.cancelled}},{key:"open",value:function(e){var n=this,r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return this.sendData=e,this.setState(i.opened),this.logger.logStartTime("display_time_cost"),this.logger.logStartTime("queue_time_cost"),new Promise(function(e,t){n.resolve=e,n.reject=t,r&&n.send()})}},{key:"send",value:function(){var t=this;if(this.state!==i.opened)throw new Error("cannot start fetch when state is not ".concat(i.opened));this.logger.logEndTime("queue_time_cost"),this.logger.logStartTime("request_time_cost"),this.doSend().then(function(e){t.load(e)}).catch(function(e){t.fail(e)})}},{key:"load",value:function(e){this.logger.logEndTime("request_time_cost"),this.logger.logEndTime("display_time_cost"),this.logger.sendLog("client_grid_cover_load"),this.resolve&&this.resolve(e),this.setState(i.loaded),this.onLoad()}},{key:"fail",value:function(e){this.reject&&this.reject(e),e&&Object(F.c)(e)||(this.setState(i.loaded),this.onLoad(),this.logger.logValue("request_img_fail",!0),this.logger.logValue("request_img_fail_reason",l(e)),this.logger.sendLog("client_grid_cover_load"))}},{key:"cancel",value:function(){this.fail(new F.a),this.setState(i.cancelled),this.onCancel(),this.cancelSource.cancel()}}]),e}(),B=n("a1gu"),H=n.n(B),W=n("Nsbk"),V=n.n(W),K=n("7W2i"),q=n.n(K),Z=n("MvBO"),Q=n("VIFs"),J=n("1dfU"),X=function(e){function t(){var i;return a()(this,t),(i=H()(this,V()(t).apply(this,arguments))).requestCDN=function(e){var t=e.url,n=e.secret,r=e.nonce;return Object(Z.a)({url:t.replace("http://","https://"),key:n,iv:r,timeout:3e3,cancelToken:i.cancelSource.token,logger:i.logger}).then(function(e){return{src:e.blobUrl,isIcon:!1}})},i.requestOrigin=function(){var e=Object(Q.prependAPI)("/api/box/stream/download/v2/cover/".concat(i.sendData.token,"?")+"width=".concat(i.sendData.width,"&height=").concat(i.sendData.height,"&policy=").concat(_.PostFileCdnUrlPolicy.allow_up));return Object(Z.b)({url:e,cancelToken:i.cancelSource.token,logger:i.logger}).then(function(e){return{src:e.blobUrl,isIcon:!1}})},i}return q()(t,e),c()(t,[{key:"setParallelRequestKeyManager",value:function(e){this.parallelRequestKeyManager=e}},{key:"doSend",value:function(){var t=this;return this.logger.logValue("source",this.sendData.sourceForLog),this.logger.logValue("file_id",Object(J.a)(this.sendData.token)),this.logger.logValue("file_type",this.sendData.type),this.requestKey().then(this.wrapWithCancel(this.requestCDN)).catch(function(e){if(e&&e.noPermitted)throw e;return t.wrapWithCancel(t.requestOrigin)(e)})}},{key:"requestKey",value:function(){var r=this;this.logger.logValue("request_key_necessary",!0),this.logger.logStartTime("request_key_time_cost");var e=(this.parallelRequestKeyManager||new M).getResponse(this.sendData);return this.cancelSource.token.promise.then(function(){e.abort()}),e.then(function(e){if(r.logger.logEndTime("request_key_time_cost"),e){if(!e.permitted)throw{noPermitted:!0,info:"no permission"};if("0"===e.cipher_type)throw{info:"resp cipher type is 0"};return e}throw{info:"no response"}}).catch(function(e){if(r.isCancelled())throw e;var t=u(e),n=l(t);throw r.logger.logValue("request_key_fail",!0),r.logger.logValue("request_key_fail_reason",n),t})}}]),t}(z),Y=n("7EGn"),$=n("AESI"),ee=n("ahx2"),te=n("7/sA"),ne=n("skFV"),re=function(e){function t(){return a()(this,t),H()(this,V()(t).apply(this,arguments))}function n(e,t,n){return r.apply(this,arguments)}var r,i;function o(){return i.apply(this,arguments)}return q()(t,e),c()(t,[{key:"transformDevUrl",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return e&&te.a&&/^https?:\/\//.test(e)?e.replace(/^https?:\/\/[^/]+/,ne.a):e}},{key:"doSend",value:(i=S()(O.a.mark(function e(){var t,n,r,i,o,a,s,c;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.sendData,n=t.token,r=t.type,i=t.hash,this.logger.logValue("source",this.sendData.sourceForLog),this.logger.logValue("file_id",Object(J.a)(this.sendData.token)),this.logger.logValue("file_type",this.sendData.type),e.next=6,this.getThumbnail(n,r,i);case 6:return o=e.sent,e.next=9,Object(Z.c)({url:o.url,key:o.secret,cancelToken:this.cancelSource.token,logger:this.logger});case 9:return a=e.sent,s=a.blobUrl,c=a.isIcon,e.abrupt("return",{src:s,isIcon:c});case 13:case"end":return e.stop()}},e,this)})),o)},{key:"getThumbnail",value:(r=S()(O.a.mark(function e(t,n,r){var i,o,a,s,c;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.sendData.thumbnail,this.isCorrectThumbnail(i))return e.abrupt("return",Object.assign({},i,{url:this.transformDevUrl(i.url)}));e.next=3;break;case 3:return this.logger.logValue("request_key_necessary",!0),this.logger.logStartTime("request_key_time_cost"),e.prev=5,e.next=8,Object(w.d)({url:$.GET_THUMBNAIL_URL,method:"GET",params:Object.assign({obj_type:n,obj_token:t},r?{hash:r}:null)});case 8:if(o=e.sent,this.logger.logEndTime("request_key_time_cost"),a={url:this.transformDevUrl(Object(Y.default)(o,"data.url")),secret:Object(Y.default)(o,"data.decrypt_key")},this.isCorrectThumbnail(a)){e.next=13;break}throw new Error("thumbnail info error");case 13:return e.abrupt("return",a);case 16:throw e.prev=16,e.t0=e.catch(5),e.t0&&e.t0.code===ee.STATUS_CODE.FORBIDDEN&&(e.t0={noPermitted:!0,info:"no permission"}),s=u(e.t0),c=l(s),this.logger.logValue("request_key_fail",!0),this.logger.logValue("request_key_fail_reason",c),s;case 24:case"end":return e.stop()}},e,this,[[5,16]])})),n)},{key:"isCorrectThumbnail",value:function(e){return Boolean(e&&e.url&&e.secret)}}]),t}(z),ie=n("QM+C"),oe=function(e){var t,n,r,i=e.sourceForLog,o=e.fileToken,a=e.fileType,s=e.clientHeight,c=e.clientWidth,u=e.thumbnail,l=e.fetchImgSrcManager,d=e.hash,f=a===ie.NUM_SUITE_TYPE.FILE?(t={sourceForLog:i,token:o,type:a,width:c,height:s},r=new X,l&&((n=l.parallelRequestKeyManager).addRequest(t),r.setParallelRequestKeyManager(n)),r.open(t,!1)):(r=new re).open(Object.assign({sourceForLog:i,token:o,type:a,thumbnail:u},d?{hash:d}:null),!1);l?l.fetchImgSrcTaskQueue.addTask(r):r.send();var h=f;return h.task=r,h};n.d(t,"e",function(){return u}),n.d(t,"f",function(){return l}),n.d(t,"b",function(){return R}),n.d(t,"c",function(){return y}),n.d(t,"a",function(){return z}),n.d(t,"d",function(){return oe})},O9F5:function(e,t,n){"use strict";var r=document.createElement("style");r.type="text/css";var s=document.body.appendChild(r).sheet,c={},i=function(r){var i=-1,o=r instanceof RegExp;return[].find.call(s.cssRules,function(e,t){var n=e.selectorText;return o?!!r.test(n)&&(i=t,!0):n===r&&(i=t,!0)}),i},o=function(e){return-1!==i(e)},a=function(e){return!!e&&!!c[e]},u=function(e,t){var n,r=s.cssRules,i=r.length||0,o=s.insertRule(e,i);!t||(n=r[o])instanceof CSSStyleRule&&(c[t]=n.selectorText)},l=function(){var e=i(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"");-1!==e&&s.deleteRule(e)},d=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=c[e];t&&(l(t),delete c[e])},f=function(e,t){if(e){for(var n=s.cssRules,r=[],i=n.length-1;0<=i;i--){var o,a=n[i];a instanceof CSSStyleRule&&((o=a.selectorText).match(e)&&(r.push(o),s.deleteRule(i)))}t&&r.find(function(e){for(var t in c)if(c[t]===e)return delete c[t],!0;return!1})}};t.a={hasRule:o,hasRuleById:a,insertRule:u,deleteRuleById:d,deleteRulesByRegExp:f,deleteRuleBySelectorText:l}},OIAp:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var r=n("lwsE"),i=n.n(r),o=n("YWBl"),a=n("YNKm"),s=function e(t){var r=this;i()(this,e),this.aceKeyEvent=function(e,t){var n=t.evt;return!(!t.isTypeForSpecialKey||n.shiftKey||!Object(a.hb)(n,a.eb))&&(r.editor.triggerCommand(a.eb),n.preventDefault(),!0)},this.editor=t.editor,this.editor.registerCommand(a.eb,function(e,t){t.doUndoRedo(e),Object(o.a)({action:e})})}},OWch:function(e,t,n){"use strict";function r(e,t,n){var o=n.value;n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],i=r.children;return r.attributes.lmkr?i:o.apply(this,t)}}n.d(t,"a",function(){return r})},Olm7:function(e,t,n){"use strict";var s=n("fywt"),c=n("ntxC");function r(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=Object(s.a)(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return Object(c.a)(e,i),n}t.a=r},PCTH:function(e,w,_){"use strict";(function(e){_.d(w,"a",function(){return I}),_.d(w,"f",function(){return s}),_.d(w,"e",function(){return S}),_.d(w,"b",function(){return c}),_.d(w,"h",function(){return u}),_.d(w,"d",function(){return l}),_.d(w,"c",function(){return j}),_.d(w,"g",function(){return d});var t=_("o0o1"),b=_.n(t),n=_("RIqP"),y=_.n(n),r=_("yXPU"),i=_.n(r),o=_("q1tI"),f=_.n(o),a=_("TSYQ"),h=_.n(a),p=_("ZvLv"),g=_("elsr"),m=_("UeI0"),v=_("YWBl"),k="0",O="toggle_heading_collapse",E="toggle_heading_expand",C={expandSection:e("doc.toggle.expand"),collapseSection:e("doc.toggle.collapse")},I="set-collapse";function s(e,t){var n=e.selStart,r=e.selEnd,i=e.zoneId;return{selStart:[n[0],t],selEnd:r.slice(0,2),selZone:i||n[2]}}function S(e,t){var n=t.lines.atIndex(e),r=n.width;return{selStart:[e,n.lineMarker],selEnd:[e,r-1],selZone:t.zoneId}}var c=function(e){var t=e.line,n=e.container,r=e.onClick,i=e.editor,o=t.zone,a=i.getRep().lines.indexOfEntry(t),s=i.getContentState().getZoneState(o).getLine(a);if(s){var c=s.getAttributes(0,s.length()-1).toMap(),u=Object(m.b)(c),l=u?C.expandSection:C.collapseSection,d=h()("collapsable-section-handle",{"collapsable-section-handle-collapsed":u});return f.a.createElement(p.a,{className:d,tooltip:l,container:n,onClick:r,"track-title":"collapse-section"})}};function u(e,t,n,r){var i=r.currentTarget;r&&i&&i!==document.activeElement&&i.focus();var o="toggle_button";l(e,t,n,e.isEditable(),!1,o)}function l(n,e,r,i,o,t){var a=e.selStart,s=e.selEnd,c=e.selZone;a.toString()===s.toString()&&1===a[1]&&(a[1]=0);var u=n.getRep();u.zoneId!==c&&(n.setWithSelection(c,s,s),n.updateBrowserSelectionFromRep(!0));var l,d,f=[];n.inCallStackIfNecessary(I,function(){var e=o||!i?g.b.LOCAL:"",t=r?"":"true",t=(o||e)&&""===t?"false":t;f.push(["collapse",t]),n.fastIncorp(),n.performDocumentApplyAttributesToRange(a,s,f,e)}),t&&(l=r?E:O,d=u.attributeManager.getAllAttributesOnLine(a[0]).find(function(e){return"heading"===e[0]}),Object(v.a)({action:l,source:t,objectType:d[1].toUpperCase()}))}function j(e,t,n,r,i){l(e,t,n,r,!0,i)}function d(e,t){return T.apply(this,arguments)}function T(){return(T=i()(b.a.mark(function e(r,t){var n,i,o,a,s,c,u,l,d,f,h,p,g,m,v;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.selStart,i=t.selEnd,o=t.zoneId,a=[],s=[],c=n[0],u=i[0],r){e.next=7;break}return e.abrupt("return");case 7:for(o!==k&&(l=r.getLineNumInRootZone(o,n),c=u=l),s.push(c,u),s=y()(new Set(s)),d=r.getReps()[k],f=r.lineTracker.collapseLines,h=f.trackers[k],p=h.entries,g=[],s.forEach(function(e){g.push(p[e].output.renderCollapsed)});g.includes(!0);){for(m=c;m<=u;m++)if(p[m].output.renderCollapsed){for(v=m;!p[v].output.startOfCollapseSection;)v--;a.push(v)}a.forEach(function(e){var t=S(e,d),n="comment";j(r,t,!0,r.isEditable(),n)}),s.forEach(function(e,t){g.splice(t,1,p[e].output.renderCollapsed)})}return e.abrupt("return",Promise.resolve());case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}}).call(this,_("2vAP"))},PDX0:function(t,e){(function(e){t.exports=e}).call(this,{})},PI5S:function(e,t,n){"use strict";var r=n("RIqP"),i=n.n(r),o=n("o0o1"),a=n.n(o),s=n("yXPU"),c=n.n(s),u=n("lwsE"),l=n.n(u),d=n("W8MJ"),f=n.n(d),h=n("cDf5"),p=n.n(h),g=n("mRaX"),m=n("1xqC"),v=n("uEBw"),b=n("QM+C"),y=n("c/bE"),k=n("pylR"),O=n("v2N6"),E=n("Tqb2");function C(e){return Object(E.l)(e).filter(function(e){return!Object(E.K)(e)})}function I(e){if(e.dataTransfer){var t=e.dataTransfer,n=t.items,r=t.files;return n?0<n.length:!!r&&0<r.length}return!1}var S=n("Mvmg"),j=n("4PSP"),T=n("rLED"),w=n("oJoF"),_=n("QtEt");n.d(t,"b",function(){return R}),n.d(t,"a",function(){return P}),n.d(t,"c",function(){return D});var M,x=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},L=3,N=function(){function n(e){var t=this;l()(this,n),this.uploadingQueue=[],this.waitingQueue=[],this.uploaderMap={},this.aceInitialized=function(){t.editorInfo.on(w.b,c()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.a)();case 2:t.docUploaderCreator=e.sent;case 3:case"end":return e.stop()}},e)})))},this.editorInfo=e.editorInfo,this.aceInitialized(),this.maxUploaderLimit=e.maxUploaderLimit||L,this.addBeforeUnloadHandle(),this.bindEvents()}function e(e){return t.apply(this,arguments)}var t;return f()(n,[{key:"bindEvents",value:function(){Object(T.Q)()&&(this.editorInfo.on("drop",this.onEditorDrop),document.addEventListener("dragover",this.onDragOver))}},{key:"unBindEvents",value:function(){Object(T.Q)()&&(this.editorInfo.off("drop",this.onEditorDrop),document.removeEventListener("dragover",this.onDragOver))}},{key:"onDragOver",value:function(e){I(e)&&e.preventDefault()}},{key:"onEditorDrop",value:function(e){var t=this,n=e.evt,r=C(n);0<r.length&&(n.preventDefault(),r.forEach(function(e){t.calcChecksumForNonImageFiles(e),e.source=S.i.DRAG,D(e)}))}},{key:"upload",value:function(e){var t=Object(g.h)();(this.enableUpload?this.uploadingQueue:this.waitingQueue).push(t);var n=Object.assign(e,{uuid:t});this.uploaderMap[t]=this.createUploader(n,this.docUploaderCreator),this.startUpload()}},{key:"calcChecksumForNonImageFiles",value:(t=c()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(t);case 2:n=e.sent,O.b(t,n);case 4:case"end":return e.stop()}},e)})),e)},{key:"createUploader",value:function(e,t){var n={docUploaderCreator:t,editorInfo:this.editorInfo,file:e,handleUploadEnd:this.handleUploadEnd.bind(this)};return new m.a(n)}},{key:"handleUploadEnd",value:function(e){this.deleteUploaded(e),this.uploadingEnQueue(),this.startUpload()}},{key:"uploadingEnQueue",value:function(){var e=this.waitingQueue.splice(0,1);this.uploadingQueue=[].concat(i()(this.uploadingQueue),i()(e))}},{key:"startUpload",value:function(){var n=this;this.uploadingQueue.forEach(function(e){var t=n.uploaderMap[e];t.started||(t.startUpload(),t.started=!0)})}},{key:"deleteUploaded",value:function(e){delete this.uploaderMap[e],this.uploadingQueue.includes(e)&&this.uploadingQueue.splice(this.uploadingQueue.indexOf(e),1),this.waitingQueue.includes(e)&&this.waitingQueue.splice(this.waitingQueue.indexOf(e),1)}},{key:"cancelUploading",value:function(e){var t=this.uploaderMap[e];t&&!t.isDone&&t.cancelUpload()}},{key:"canLeavePage",value:function(){return!(0<this.uploadingQueue.length)}},{key:"addBeforeUnloadHandle",value:function(){y.a.addCanLeavePageHandler(this.canLeavePage),window.addEventListener("beforeunload",this.handleBeforeUnload)}},{key:"handleBeforeUnload",value:function(e){0<this.uploadingQueue.length&&(e.preventDefault(),e.returnValue="")}},{key:"destory",value:function(){y.a.removeCanLeavePageHandler(this.canLeavePage),window.removeEventListener("beforeunload",this.handleBeforeUnload),this.unBindEvents(),this.clearChecksumStore()}},{key:"clearChecksumStore",value:function(){Object(T.Q)()&&O.a()}},{key:"enableUpload",get:function(){return this.uploadingQueue.length<this.maxUploaderLimit}}]),n}();function R(e){if(!e)throw new Error("editorInfo not provided for uploader creation");return M=new N({editorInfo:e})}function P(){M&&(M.destory(),M=null)}function D(e){var t;b.isAnonymousAccess||((t=Object(v.h)(e))?Object(v.g)(t):M&&M.upload(e))}x([j.Bind],N.prototype,"onEditorDrop",null),x([j.Bind],N.prototype,"canLeavePage",null),x([j.Bind],N.prototype,"handleBeforeUnload",null)},PcuH:function(e,t,n){"use strict";var r=n("J4zp"),O=n.n(r),i=n("RIqP"),N=n.n(i),o=n("lSNA"),R=n.n(o),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),l=n.n(c),d=n("m8R6"),f=n("XIp8"),P=n("XhtD"),D=n("y2sV"),h=n("FJEn"),U=n("+4eN"),F=n("kESg"),p=n("V2TW"),u=function(){function u(){s()(this,u)}return l()(u,[{key:"checkIsAllowInsertZone",value:function(e,t){var n=Object(U.n)(e,t),r=F.d[n];return!r||!r.attribs.includes(F.k.ZoneType)}},{key:"insertZoneDelta",value:function(e,t){return e.insert("*",Object.assign(R()({lineguid:Object(h.genGuid)(),author:Object(p.b)()},F.k.ZoneType,this.zoneType),t))}},{key:"getZoneAllOps",value:function(e,t){var n=e.getContentState().getZoneState(t);return N()(n).map(function(e){return e.getOps()}).flat()}},{key:"updateSelection",value:function(e,t,n,r){e.selection.setWithSelection(t,n,r),e.selection.updateBrowserSelectionFromRep()}},{key:"performOpsWithAttributes",value:function(t,n,r,e){(e?e.map(function(e){return t.getLine(e)}):N()(t)).forEach(function(e){e.getOps().forEach(function(e,t){0===t?"*"===e.insert&&e.attributes&&e.attributes.lmkr?n.insert("*",Object.assign({},e.attributes,{},r)):n.insertLineMarker(r).push(e):n.push(e)})})}},{key:"convertFragment",value:function(e,t,n,r,i){if(!n.length||Object(U.n)(e,t)!==this.zoneType)return[];var o=e.managers.zoneToLineEntry[t];if(!o)return[];var a=o.zone,s=e.getContentState(),c=s.getZoneState(a),u=s.getZoneState(t),l=e.getRep(a),d=e.getRep(t),f=l.lines.indexOfEntry(o);if(n.length===u.length())return this.convertEntire(e,a,f,r);n.sort(function(e,t){return e-t});var h=n[0],p=u.length()-1,g=0===h,m=[g?0:h-1,g?0:u.getLine(h-1).getModelText().length-1],v=[g?n.length:p,g?0:u.getLine(p).getModelText().length-1],b=[f+(g?0:1),0],y=b[0]-1+n.length,k=b[0]+n.length,O=new D.e;e.performDocumentReplaceRange(t,m,v,"");var E,C,I,S,j,T=new D.E({zoneId:a});if(c.getLine(b[0])?T.retain(c.pointToOffset({line:b[0],offset:b[1]})):(E=c.getLine(f).length()-1,T.retain(c.pointToOffset({line:f,offset:E})),T.insertEnter()),this.performOpsWithAttributes(u,T,r,n),O=O.concat(T),n[n.length-1]<p&&!g){for(var w=Object(U.b)(),O=O.concat(this.insertZoneDelta(new D.E({zoneId:a}),Object.assign(R()({},F.k.ZoneId,w),this.getZoneAttrsByZoneId(e,t)))),_=new D.E({zoneId:w}),M=h+n.length;M<=p;M++){var x,L=u.getLine(M).getOps();(x=_.ops).push.apply(x,N()(L))}Object(U.o)(_),O=O.concat(_)}return s.apply(O),i&&(C=d.selStart,I=d.selEnd,S=[b[0],C[1]],j=[y,I[1]],this.updateSelection(e,a,S,j)),Object(P.a)(b[0],k)}},{key:"convertEntire",value:function(e,t,n,r,i){var o=this.getZoneId(e,t,n);if(!o)return[];var a=e.getContentState(),s=a.getZoneState(t),c=a.getZoneState(o),u=s.getLine(n),l=u?u.getLineMarker():0,d=[n,0],f=c.length(),h=new D.E({zoneId:t}).retain(s.pointToOffset({line:d[0],offset:d[1]})).delete(1+l);return this.performOpsWithAttributes(c,h,r),Object(U.o)(h),a.apply(h),i&&this.updateSelection(e,t,d,d),Object(P.a)(n,n+f)}},{key:"convertRangeToZone",value:function(o,e,t,n){var a,s,r,i,c,u=this;e&&t&&t.length&&(Object(U.n)(o,e.zoneId)!==this.zoneType?(a=o.getContentState().getZoneState(e.zoneId),s=[],t.forEach(function(e){var t,n,r=a.getLine(e),i=Object(U.k)(r);Object(U.g)(i)?(t=u.getZoneAllOps(o,i),s.push.apply(s,N()(t))):(n=r.getOps().filter(function(e){return!Object(U.e)(u.zoneType,e)}),s.push.apply(s,N()(n)))}),r=t[t.length-1],i=a.getLine(r),c=[[t[0],0],[r,i.length()-1]],this.insertZone({editor:o,zoneId:e.zoneId,sel:c,attributes:n,beforeApply:function(e,t){var n=new D.E({zoneId:t}),r=F.d[u.zoneType].attribs;return s.forEach(function(e){var t=Object(f.default)(e);t.attributes=Object(d.default)(t.attributes,r),n.push(t)}),Object(U.o)(n),e.concat(n)},afterInsert:this.afterInsertZone})):this.convertFragment(o,e.zoneId,t,void 0,!0))}},{key:"convertToZone",value:function(t,e,n){var r=this;if(n&&n.selStart&&n.selEnd){var i=n.selStart,o=n.selEnd,a=[],s=!0;if("block_menu"===e){var c=i[0],s=!!Object(U.l)(t,n.zoneId,c,this.zoneType);a.push([c])}else{for(var u=[],l=i[0];l<=o[0];l++)this.isUnsupportLine(n,l)?(u.length&&a.push(u),u=[]):u.push(l),s=s&&!!Object(U.l)(t,n.zoneId,l,this.zoneType);u.length&&a.push(u)}if(a.length)return t.inCallStackIfNecessary("insertZoneByCommand",function(){t.makeNewEvent("insertZoneByCommand",function(){a.reverse().forEach(function(e){s?e.reverse().forEach(function(e){r.convertEntire(t,n.zoneId,e,void 0,!0)}):r.convertRangeToZone(t,n,e)})})}),s}}},{key:"updateSelectionAfterPaint",value:function(e,t,n){return Object(U.p)(e,t,n)}},{key:"insertZone",value:function(e){var t=e.editor,n=e.zoneId,r=e.lineNum,i=e.sel,o=e.attributes,a=e.beforeInsert,s=e.afterInsert,c=e.beforeApply;if(!this.checkIsAllowInsertZone(t,n))return null;var u=Object(U.b)(),l=i||[[r,0],[r,0]],d=O()(l,2),f=d[0],h=d[1],p=t.getContentState(),g=p.getZoneState(n),m=g.pointToOffset({line:f[0],offset:f[1]}),v=g.pointToOffset({line:h[0],offset:h[1]}),b=new D.e,y=new D.E({zoneId:n}).retain(m).delete(v-m);a&&a(y);var k=Object.assign(R()({},F.k.ZoneId,u),this.getDefaultZoneAttrs(o));return this.insertZoneDelta(y,k),b=b.concat(y),c&&(b=c(b,u)),p.apply(b),s&&s(u,k),this.updateSelectionAfterPaint(t,u),u}},{key:"tryConvertZone",value:function(n,e){var r=this,t=e.range,i=e.zoneType,o=e.attribKey,a=e.attribMap,s=t.zoneId,c=t.selStart,u=t.selEnd,l={zoneId:s,selStart:c,selEnd:u},d=!1;if(!n||!c||!u)return{range:l,isConverted:d};l.selStart=N()(c),l.selEnd=N()(u);var f=Object(P.a)(c[0],u[0]+1);if(Object(U.n)(n,s)===this.zoneType){var h=F.d[i];if(!h||!h.attribs.includes(o))return{range:l,isConverted:d};var p=n.managers.zoneToLineEntry[s];if(!p)return{range:l,isConverted:d};var g,m=p&&p.zone,v=this.convertFragment(n,s,f,a);return v.length&&(g=v[v.length-1],l.selStart[0]=v[0],l.selStart[1]=c[1],l.selEnd[0]=g,l.selEnd[1]=u[1],d=!0,l.zoneId=m),d&&this.updateSelection(n,m,l.selStart,l.selEnd),{range:l,isConverted:d}}var b=f.filter(function(e){var t=Object(U.l)(n,s,e);return t&&t.zoneType===r.zoneType}),y=b.length===f.length&&1===f.length;return b.reverse().forEach(function(e){var t=r.convertEntire(n,s,e,a,y);t.length&&(l.selEnd[0]+=t.length-1,d=d||!!t.length)}),d&&!y&&this.updateSelection(n,s,l.selStart,l.selEnd),{range:l,isConverted:d}}},{key:"tryToggleAttributeInZone",value:function(d,e,f,h){var t,p,g=this,m=e.zoneId,n=e.selStart,r=e.selEnd;n&&r&&(t=Object(P.a)(n[0],r[0]+1),p=d.getContentState(),t.forEach(function(e){var t=Object(U.l)(d,m,e);if(t&&t.zoneType===g.zoneType){for(var n=t.zoneId,r=p.getZoneState(n),i=r.length(),o=!0,a=0;a<i;a++){var s=r.getLine(a),c=s&&s.getLineAttributes().toMap();if(!c||c[f]!==h){o=!1;break}}var u=Object(P.a)(0,i),l=d.getRep(n).attributeManager;o?l.removeAttributeOnMultiLines(u,f):l.setAttributeOnMultiLines(u,f,h)}}))}}],[{key:"registerTransformer",value:function(e,t){u.transformers[e]=t}},{key:"tryConvertZone",value:function(t,e,n,r){var i=e.zoneId,o=e.selStart,a=e.selEnd,s={range:{zoneId:i,selStart:o,selEnd:a},isConverted:!1},c={range:{zoneId:i,selStart:o,selEnd:a},zoneType:Object(U.n)(t,e.zoneId),attribKey:n};return r&&(c.attribMap=R()({},n,r)),Object.values(u.transformers).forEach(function(e){e&&(s=e.tryConvertZone(t,c),c.range=s.range)}),s}}]),u}();u.transformers={},t.a=u},Pozx:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s});var r=n("j1lG"),i=n("mWyS");function o(e){return e===r.D.Doc}function a(e){return e===r.D.Drive}function s(e){return Object(i.a)(e)?r.D.Doc:Object(i.b)(e)?r.D.Drive:r.D.External}},QKZB:function(e,t,n){"use strict";function r(e,t){return e(t={exports:{}},t.exports),t.exports}n.d(t,"a",function(){return d});for(var p=r(function(e){var t,n,r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);r?(t=new Uint8Array(16),e.exports=function(){return r(t),t}):(n=new Array(16),e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n})}),i=[],o=0;o<256;++o)i[o]=(o+256).toString(16).substr(1);function a(e,t){var n=t||0;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}var g,m,v=a,b=0,y=0;function s(e,t,n){var r,i=t&&n||0,o=t||[],a=(e=e||{}).node||g,s=void 0!==e.clockseq?e.clockseq:m;null!=a&&null!=s||(r=p(),null==a&&(a=g=[1|r[0],r[1],r[2],r[3],r[4],r[5]]),null==s&&(s=m=16383&(r[6]<<8|r[7])));var c=void 0!==e.msecs?e.msecs:(new Date).getTime(),u=void 0!==e.nsecs?e.nsecs:y+1,l=c-b+(u-y)/1e4;if(l<0&&void 0===e.clockseq&&(s=s+1&16383),(l<0||b<c)&&void 0===e.nsecs&&(u=0),1e4<=u)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");b=c,m=s;var d=(1e4*(268435455&(c+=122192928e5))+(y=u))%4294967296;o[i++]=d>>>24&255,o[i++]=d>>>16&255,o[i++]=d>>>8&255,o[i++]=255&d;var f=c/4294967296*1e4&268435455;o[i++]=f>>>8&255,o[i++]=255&f,o[i++]=f>>>24&15|16,o[i++]=f>>>16&255,o[i++]=s>>>8|128,o[i++]=255&s;for(var h=0;h<6;++h)o[i+h]=a[h];return t||v(o)}function c(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||p)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||v(i)}var u=c,l=u;l.v1=s,l.v4=u;var d=l},QtEt:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var n=r("o0o1"),i=r.n(n),o=r("yXPU"),a=r.n(o);function s(){return c.apply(this,arguments)}function c(){return(c=a()(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e("commons--FilePicker--attachment_preview_modal--box-utils-upload-v2--box_index--doc_uploader_delay----afa6617f"),r.e("commons--box-utils-upload-v2--box_right_bar--doc_uploader_delay--lark-upload-progress-viewer--nativ--93a0e733"),r.e("doc_uploader_delay")]).then(r.bind(null,"DugT"));case 2:return t=e.sent,n=t.createDocUploader,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}},RQWm:function(e,t,n){"use strict";var a=n("5iG2");function r(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Object(a.a)(e,r?0:o,r?o+1:i):Object(a.a)(e,r?o+1:0,r?i:o)}t.a=r},SFb0:function(e,t,n){},SLR9:function(e,t,n){"use strict";n.d(t,"a",function(){return S}),n.d(t,"d",function(){return j}),n.d(t,"b",function(){return w});var r,i,o,a,s,c=n("lwsE"),u=n.n(c),l=n("W8MJ"),d=n.n(l),f=n("U+yc"),h=n.n(f),p=(n("faYQ"),n("nVH4")),g=n("YWBl"),m=n("7Kxq"),v=n("YNKm"),b=n("/spq"),y=n("F9bh"),k=n("aBgF"),O=n("y2sV"),E=n("q1tI"),C=n.n(E),I=n("Nl7c"),S="IGNORE_INLINE_CODE";function j(e){if(e instanceof HTMLElement){var t=e.className,n=e.getAttribute("style");if(-1<t.indexOf("list-code"))return!0;if(/\bdisplay:\s*block\b/i.test(n))return!0}return!1}var T=C.a.createElement(O.w,{spellCheck:!1,className:"inline-code "}),w=(r=Object(b.a)(["aceKeyEvent"]),i=Object(I.a)(),o=Object(y.a)(),r((s=function(){function t(e){var o=this;u()(this,t),this.attributeKey="inline-code",this.aceInitialized=function(e,t){o.editorInfo=t.editorInfo,o.editorInfo.doInsertInlineCode=o.doInsertInlineCode,o.regist(o.editorInfo)},this.regist=function(e){var a="inline-code";e.registerAceCommand(v.D,function(e,t,n,r){var i=r.source,o=t.doInsertInlineCode({attribKey:"inline-code",attribValue:!0});Object(g.a)({action:a,op:o?m.g:m.f,source:i})},{statusKey:a})},this.getStyleType=function(e){var t=[];e&&(t=e.split(";"));for(var n=0;n<t.length;++n)if(-1<t[n].indexOf("background-color")){var r=/(^| )background-color:\s*(.*)/.exec(t[n]);if(r)return r[2]}},this.getNextPositionPoint=function(e,t,n){var r=[t[0],t[1]-1],i=[t[0],t[1]+1];return n!==p.c.LEFT||o.isInlineCodeAtPosition(e,i)?n!==p.c.RIGHT||0!==t[1]&&o.isInlineCodeAtPosition(e,r)?[]:i:r},this.isInlineCodeAtPosition=function(e,t,n){var r,i,o=e.selection.getZone();return!(!(i=n?(r=e.getReps()[o]).attributeManager.getAttributesOnSelection(t,[t[0],t[1]+1],r).attribs:e.getAttributesOnPosition(o,t[0],t[1]))||!i.some(function(e){return"inline-code"===e[0]}))},this.aceAttribsToClasses=function(e,t){if("inline-code"===t.key)return"inline-code"},e&&this.aceInitialized("",Object.assign({editorInfo:e},e))}return d()(t,[{key:"match",value:function(e){return e===this.attributeKey}},{key:"renderInlineWrapper",value:function(){return T}},{key:"reset",value:function(){this.editorInfo=null}},{key:"doInsertInlineCode",value:function(e){var t=e.attribKey,n=e.attribValue,r=e.isAllHasAttrib,i=e.isSpecialSelection,o=e.range,a=o.selStart,s=o.selEnd,c=o.attributeManager;return i?(c.setAttributesOnRange(a,s,[[t,r?"":n]]),r):this.editor.toggleAttributeOnSelection(t,o,n)}},{key:"aceKeyEvent",value:function(e,t){var n=t.evt,r=t.editorInfo,i=n.type,o=n.keyCode,a=n.shiftKey;if("keydown"!==i||Object(k.d)(n))return!1;if(o!==p.c.LEFT&&o!==p.c.RIGHT)return!1;if(!r.selection.isCaret())return!1;var s=r.getRep(),c=s.selStart,u=[c[0],c[1]+1],l=[c[0],c[1]-1],d=o===p.c.LEFT||o===p.c.BACKSPACE?this.isInlineCodeAtPosition(r,l,!0):this.isInlineCodeAtPosition(r,u);if(!d||o!==p.c.LEFT&&o!==p.c.RIGHT)return!1;var f=this.getNextPositionPoint(r,c,o);return!!f.length&&(n.preventDefault(),t.preventOtherHooksHandle=!0,r.setWithSelection(s.zoneId,a?c:f,f),r.updateBrowserSelectionFromRep(),!0)}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,r=e.zoneId;if(t instanceof HTMLElement){var i=t.tagName,o=t.className;if("CODE"===i&&!j(t)||"SPAN"===i&&-1<o.indexOf("inline-code"))return Object(O.H)(n,r,{"inline-code":"true"})}return n}}]),t}(),h()(s.prototype,"renderInlineWrapper",[i],Object.getOwnPropertyDescriptor(s.prototype,"renderInlineWrapper"),s.prototype),h()(s.prototype,"doInsertInlineCode",[o],Object.getOwnPropertyDescriptor(s.prototype,"doInsertInlineCode"),s.prototype),a=s))||a);t.c=new w},SQ87:function(e,t,n){"use strict";n.d(t,"g",function(){return g}),n.d(t,"f",function(){return b}),n.d(t,"b",function(){return y}),n.d(t,"a",function(){return k}),n.d(t,"h",function(){return O}),n.d(t,"j",function(){return E}),n.d(t,"c",function(){return C}),n.d(t,"i",function(){return I}),n.d(t,"d",function(){return S}),n.d(t,"e",function(){return j});var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("J4zp"),T=n.n(s),c=(n("lSNA"),n("Muja")),u=n("U5G9"),v=n("4D8z"),l=n("Wwog"),d=n("FJEn"),f=(n("H6oK"),n("iP/4")),h=n("L1JX"),p=n("GixS"),g=(Object(u.b)({module:u.a.TABLE}),function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:v.l;return e-v.w+t}),b=function(e,t,n,r){var i,o=h.a.IS_FS_MODE?0:t.paddingRight,a=h.a.IS_FS_MODE?0:t.paddingLeft,s=h.a.TABLE_FULL_WIDTH_RIGHT,c=h.a.TABLE_FULL_WIDTH_WITH_COMMENT_RIGHT,u=0,l=0,d=r.width,u=e?1600<=d?c+v.h+v.g:900<=d?c+v.i+v.g:0:s,l=v.w,f=g(t.left-r.left,a);return n===v.q&&(i=r.right-t.right-u+o+2*p.b),{tableFullLeftMargin:f,tableFullRightMargin:i,tableVisibleWidth:d-l-u}},m=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!Object(c.default)(e[n],t[n]))return!1;return!0},y=Object(l.a)(function(e,t,n,r,i,o,a,s){return k({platform:o,fullWidth:n,scrollLeft:r,docbodyRect:e,tableTotalWidth:i,isCommentCross:a,showRightScrollShadow:s,containerRect:t})},m),k=function(e){var t=e.platform,n=e.fullWidth,r=e.docbodyRect,i=e.tableTotalWidth,o=e.isCommentCross,a=e.scrollLeft,s=e.containerRect,c=r.innerWidth,u={marginLeft:0,marginRight:0,paddingRight:0,docScrollWidth:null,tableScrollWidth:null,leftShadowOffset:0};if(!t)return u.docScrollWidth=c,u.tableScrollWidth=r.width,u;if(!n||i<=c||s.width<=900)return u;var l=b(o,r,t,s),d=l.tableFullLeftMargin,f=l.tableFullRightMargin,h=l.tableVisibleWidth,p=Math.min(a,d);if(c+f<i&&900<s.width){var g=h<=i?h:i+v.x,m=h<=i?d:g-c-f;return o||(u.paddingRight=v.x),u.marginLeft=-m,u.marginRight=-f,u.docScrollWidth=g,u.leftShadowOffset=-p,u.tableScrollWidth=c+f,u}return u.marginRight=-(i-c),u.docScrollWidth=i,u.tableScrollWidth=i,u};function O(){return{aceTable:function(e,t){var n=d.tableIds.getRowAndColIdFromTableValue(e),r=t.getVectorReps();return{pluginCounts:[["aceTable",1]],childReps:d.tableIds.getSortedTableCellIdsByTableIdFromVectorReps(r,n).map(function(e){return t.getRep(e)})}}}}function E(e){return 0<$(e).parents(".inner-zone-ace-editor-wrapper").length}function C(e,t,n){for(var r=-1,i=-1,o=e;0<=o&&-1===r;o--){for(var a=t;0<=a&&-1===i;a--){var s=n[o][a];(void 0===s.colspan||s.colspan&&0<s.colspan)&&(i=a)}var c=n[o][i];(void 0===c.rowspan||c.rowspan&&0<c.rowspan)&&(r=o)}return{rowIndex:-1===r?e:r,colIndex:-1===i?t:i}}function I(e,t){var n=t.getVectorReps(),r=e.split("x"),i=T()(r,3),o=i[1],a=i[2];if(!o||!a)return 0;var s=Object.keys(n).find(function(e){return n[e].vectorIds.includes(o)}),c=Object.keys(n).find(function(e){return n[e].vectorIds.includes(a)});if(!s||!c)return 0;var u=t.getVectorsRep(s,!0),l=t.getVectorsRep(c,!1),d=u.vectorIds.indexOf(o),f=l.vectorIds.indexOf(a);if(-1===d||-1===f)return 0;var h=t.changesetHelper.getAttributesPerCharacter(l.alines[0],t.getApool()),p=t.changesetHelper.getAttributesPerCharacter(u.alines[0],t.getApool())[d]||{},g=h[f]||{};if(p.mergeCellID&&g.mergeCellID){var m=p.mergeCellID.split(","),v="",b=!0,y=!1,k=void 0;try{for(var O,E=m[Symbol.iterator]();!(b=(O=E.next()).done);b=!0){var C=O.value;if(g.mergeCellID&&g.mergeCellID.includes(C)){v=C;break}}}catch(e){y=!0,k=e}finally{try{b||null==E.return||E.return()}finally{if(y)throw k}}if(0<v.length){for(var I=0,S=f-1;0<=S&&(h[S].mergeCellID&&h[S].mergeCellID.includes(v));S--)I+=w(h[S]);for(var j=f;j<h.length&&(h[j].mergeCellID&&h[j].mergeCellID.includes(v));j++)I+=w(h[j]);return I}}return w(g)}function w(e){return Number(e.colWidth)||v.r}var S=new(function(){function e(){i()(this,e),this.isRealMousedown=!1,this.invalidMousedown=!1,this.bindEvent()}return a()(e,[{key:"bindEvent",value:function(){var e=this;f.a.isSafari&&(document.addEventListener("mousedown",function(){e.isRealMousedown=!0}),document.addEventListener("mouseup",function(){e.isRealMousedown||(e.invalidMousedown=!0),e.isRealMousedown=!1}))}}]),e}());function j(e,t){for(var n=0,r=0;r<t;r++)n+=e[r];return n}},TBry:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return k});var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),u=n("q1tI"),l=n.n(u),d=n("YNKm"),f=n("YWBl"),h=n("7Kxq"),p=n("F9bh"),g=n("y2sV"),m=n("OWch"),v=n("Nl7c"),b=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},y="IGNORE_STRIKE_THROUGH",k=function(){function t(e){var a=this;i()(this,t),this.editor=e,this.className="Strikethrough",this.aceInitialized=function(e,t){a.register(t.editorInfo)},this.register=function(e){e.commands.registerAceCommand(d.X.toLowerCase(),function(e,t,n,r){var i=r.source,o=a.toggleAttribute({attribKey:"strikethrough",attribValue:!0});Object(f.a)({action:"strikethrough",op:o?h.g:h.f,source:i})},{statusKey:"strikethrough-true"})},this.aceAttribsToClasses=function(e,t){return"strikethrough"===t.key?["tag:s"]:null},this.editor=e,this.register(e)}return a()(t,[{key:"toggleAttribute",value:function(e){var t=e.attribKey,n=e.attribValue,r=e.range,i=e.isSpecialSelection,o=e.isAllHasAttrib,a=r.selStart,s=r.selEnd,c=r.attributeManager;return i?(c.setAttributesOnRange(a,s,[[t,o?"":n]]),o):this.editor.toggleAttributeOnSelection(t,r,n)}},{key:"serialize",value:function(e){return Object(g.P)(e,{tagAttribute:d.X,wrapTag:g.a[d.X]})}},{key:"match",value:function(e){return"strikethrough"===e}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,r=e.zoneId;if(t instanceof HTMLElement){var i=t.tagName,o=t.getAttribute("style")||"";if("S"===i||"DEL"===i||"STRIKE"===i||/\btext-decoration(-line)?:[^;]*line-through\b/i.test(o))return Object(g.H)(n,r,{strikethrough:"true"})}return n}},{key:"render",value:function(e){var t=e.children;return l.a.createElement(g.w,{style:{textDecoration:"line-through"}},t)}}]),t}();b([Object(p.a)()],k.prototype,"toggleAttribute",null),b([m.a,Object(v.b)()],k.prototype,"render",null)},TaAU:function(e,t,n){},Tqb2:function(e,t,n){"use strict";n.d(t,"d",function(){return _}),n.d(t,"b",function(){return M}),n.d(t,"e",function(){return N}),n.d(t,"U",function(){return R}),n.d(t,"v",function(){return D}),n.d(t,"u",function(){return F}),n.d(t,"q",function(){return z}),n.d(t,"r",function(){return B}),n.d(t,"s",function(){return H}),n.d(t,"M",function(){return W}),n.d(t,"G",function(){return V}),n.d(t,"L",function(){return K}),n.d(t,"F",function(){return Z}),n.d(t,"n",function(){return Q}),n.d(t,"o",function(){return J}),n.d(t,"f",function(){return X}),n.d(t,"l",function(){return ee}),n.d(t,"m",function(){return te}),n.d(t,"c",function(){return ne}),n.d(t,"D",function(){return re}),n.d(t,"K",function(){return ae}),n.d(t,"w",function(){return se}),n.d(t,"t",function(){return ue}),n.d(t,"W",function(){return le}),n.d(t,"V",function(){return de}),n.d(t,"R",function(){return fe}),n.d(t,"p",function(){return he}),n.d(t,"E",function(){return pe}),n.d(t,"H",function(){return ge}),n.d(t,"k",function(){return me}),n.d(t,"h",function(){return ve}),n.d(t,"B",function(){return be}),n.d(t,"T",function(){return ye}),n.d(t,"y",function(){return ke}),n.d(t,"J",function(){return Oe}),n.d(t,"g",function(){return Ee}),n.d(t,"a",function(){return Ie}),n.d(t,"I",function(){return Se}),n.d(t,"j",function(){return je}),n.d(t,"P",function(){return Te}),n.d(t,"Q",function(){return Ae}),n.d(t,"z",function(){return _e}),n.d(t,"x",function(){return Me}),n.d(t,"i",function(){return xe}),n.d(t,"C",function(){return Le}),n.d(t,"S",function(){return Ne}),n.d(t,"O",function(){return Pe}),n.d(t,"N",function(){return De}),n.d(t,"A",function(){return Ue});var r=n("o0o1"),i=n.n(r),o=n("yXPU"),a=n.n(o),s=n("J4zp"),c=n.n(s),u=n("RIqP"),l=n.n(u),d=n("/xWd"),f=n("BpSZ"),O=n("j1lG"),E=n("Z/PY"),h=n("y2sV"),p=n("oTSI"),g=n("m8R6"),m=n("cGQV"),v=n("wN88"),b=n("3doy"),y=n("lQZd"),k=n("rLED"),C=n("elsr"),I=n("15MJ"),S=n("mWyS"),j=n("Pozx"),T=n("SQ87"),w=n("XB4d"),_=Array.prototype.flat?function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return e.flat(t)}:d.a;function M(e){if(!Object(f.b)(e))return null;var t=f.a.exec(e);if(!t||!t[1])return null;var n=t[1],r=t[2];return fetch(e).then(function(e){return e.blob()}).then(function(e){var t="data-url-convert-to-file-".concat(Date.now(),".").concat(r);return new File([e],t,{type:n})}).catch(function(e){return console.error("data url convert to file fail.",e),null})}function x(e){var t=e.naturalWidth,n=e.naturalHeight,r=e.displayHeight,i=e.displayWidth,o=1,a=1,s=0,c=0;return t&&n&&(s=Object(E.m)(t,n)),r&&i&&(c=Object(E.m)(i,r)),0<s&&s!==o?a=s:0<c&&c!==o&&(a=c),a}var L=function(e){var t=e.natrualHeight,n=e.natrualWidth,r=e.width,i=e.height;("100%"===r||"auto"===i)&&n&&t&&(r=n,i=t);var o=parseInt(t,10),a=parseInt(n,10),s=parseInt(i,10),c=parseInt(r,10);return{naturalHeight:o,naturalWidth:a,displayHeight:s,displayWidth:c,aspectRatio:x({naturalWidth:a,naturalHeight:o,displayWidth:c,displayHeight:s})}};function N(e){var t,n,r,i,o,a,s,c,u=e.uuid,l=e.image_type,d=e.src,f=void 0===d?"":d,h=e.size,p=e.comments,g=decodeURIComponent(f),m=Object(E.w)(e)||g,v=Object(j.a)(m),b=Object(S.c)(m),y=L(e),k={};return"isLocalAttribs"in e&&(t=e.uploading,n=e.uploadProgress,r=e.intermediateSrc,i=e.loadingShowPreview,o=e.sourceFileToken,a=e.needTransformToGallery,s=e.needSaveDriveImage,c=e.needSaveExternal,Object.assign(k,{uploading:t,uploadProgress:n,intermediateSrc:r,imageCategory:O.D.Drive,loadingShowPreview:i,sourceFileToken:o,needTransformToGallery:a,needSaveDriveImage:s,needSaveExternal:c})),Object.assign({uuid:u,token:b,serverSrc:g,originSrc:m,imageCategory:v,mimeType:l||"",fileSize:h,comments:p,size:y},k)}function R(e){var t=null;try{t=JSON.parse(e)}catch(e){console.error("[image plugin] gallery attribsString is not json string:",e)}return t}function P(e){return!!e&&"IMG"===e.tagName}function D(e){if(P(e))return e.dataset.uuid;var t=$(e).find("img")[0];return t&&t.dataset&&t.dataset.uuid||null}function U(e){var t=[[O.M],[O.K]];return e.getEntities(t)}function F(e){return B(U(e))}function z(e){var t={},n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.attributes,u=void 0===c?{}:c;if(u.author){var l=H(s),d=!0,f=!1,h=void 0;try{for(var p,g=l[Symbol.iterator]();!(d=(p=g.next()).done);d=!0)t[p.value.uuid]=u.author}catch(e){f=!0,h=e}finally{try{d||null==g.return||g.return()}finally{if(f)throw h}}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}function B(e){var n=[];return e.forEach(function(e){var t=H(e);if(t)return n.push.apply(n,l()(t))}),n}function H(e){var t,n,r=e.attributes;return r[O.K]?t=he(O.K,r[O.K]):r[O.M]&&(n=t=he(O.M,r[O.M]),c()(n,1)[0].comments=je(r)),t||[]}function W(t){return t.attributes&&O.p.some(function(e){return!!t.attributes[e]})}function V(e){return e.attributes&&e.attributes.align&&"full"===e.attributes.align}function K(e){return e._getOps().some(function(e){return W(e)})}function q(e,t){var n,r,i;Object(k.Q)()||t&&K(t)&&(r=(n=t._entry.getAllInstancesByName("gallery"))[n.length-1].id,i="image-upload-image-".concat(r),e.call("galleryImageChoosed",i))}function Z(e,t){return Object(w.a)({editor:e,evt:t,isSpecialContent:function(e,t){return K(t)},selectContentCallback:function(e,t){return q(e,t)}})}function Q(e,t){return e?t.selection._toModelRange({startContainer:e,startOffset:0,endContainer:e,endOffset:e.childNodes.length}):null}function J(n,e){return e.getEntities(function(e,t){return!!O.p.includes(e)&&t.includes(n.uuid)})}function X(e){var t={items:[Y(e)]};return JSON.stringify(t)}function Y(e){var t=e.uuid,n=e.token,r=e.size,i=e.mimeType,o=e.fileSize,a=e.comments,s=void 0===a?[]:a,c=e.serverSrc,u=e.imageCategory,l=r.naturalHeight,d=r.naturalWidth,f=r.displayHeight,h=r.displayWidth,p=r.aspectRatio,g={uuid:t,src:encodeURIComponent(c),height:f.toString(),width:h.toString(),currHeight:f.toString(),currWidth:h.toString(),natrualHeight:l.toString(),natrualWidth:d.toString(),image_type:i,size:o,comments:s,pluginName:I.s,scale:p};return Object(j.b)(u)?g:Object.assign({},g,{file_token:n})}function ee(e){if(e.dataTransfer){var t=e.dataTransfer,n=t.items,r=t.files;if(n)return ie(n);if(r)return oe(r)}return[]}function te(e){return ee(e).filter(function(e){return ae(e)})}function ne(e){if(e.dataTransfer){var t=e.dataTransfer,n=t.items,r=t.files;return n?Array.from(n).some(function(e){return e.type.startsWith("image")}):!!r&&!!Array.from(r).some(function(e){return e.type.startsWith("image")})}return!1}function re(e){var t=(e.clipboardData||{}).files;return t?Array.from(t).filter(function(e){return ae(e)}):[]}function ie(e){if(!e.length)return[];for(var t=[],n=0,r=Array.from(e);n<r.length;n++){var i=r[n].getAsFile();i&&t.push(i)}return t}function oe(e){return Array.from(e)}function ae(e){return!!e.type&&!!e.type.match(/image\/(gif|jpg|jpeg|bmp|png)$/)}function se(e){var t=null;return e.getEntities([]).forEach(function(e){W(e)&&(t=e)}),t}function ce(t){return new Promise(function(n,e){t||e(new Error("get image rect failed for without src."));var r=new Image;r.onload=function(){var e=r.width,t=r.height;n({naturalHeight:t,naturalWidth:e})},r.onerror=function(){e(new Error("get image rect failed for load image error."))},r.src=t})}function ue(e){return{galleryAttribsString:e[O.K]||e[O.c],oldImageAttribsString:e[O.M]||e[O.d]}}function le(e){var t=ue(e),n=t.galleryAttribsString,r=t.oldImageAttribsString;if(n){var i=R(n);return i?i.items:[]}return r?[Object(m.c)(r)]:[]}function de(e){return le(e).map(function(e){return N(e)})}var fe=Object(p.a)(ce);function he(e,t){return O.p.includes(e)&&t?(O.K.includes(e)?(n=R(t))&&(r=n.items.map(function(e){return N(e)})):r=[N(Object(m.c)(t))],r||null):null;var n,r}var pe=function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],r=3<arguments.length?arguments[3]:void 0,i=e.start,o=e.end,a=t.getContentState(),s=r?a.getZoneState(r):a.getActiveZone();if(n){var c=s.getLine(i.line),u=c.getOps(),l=u.length;if(u[0]&&u[0].insert===h.o&&l--,u[u.length-1]&&"\n"===u[u.length-1].insert&&l--,1===l)return{retainLen:s.pointToOffset({line:i.line,offset:0}),deleteLen:c.length(),isExclusive:!0}}var d=s.pointToOffset({line:i.line,offset:i.offset});return{retainLen:d,deleteLen:s.pointToOffset({line:o.line,offset:o.offset})-d,isExclusive:!1}};function ge(e,t,n){var r=e.line,i=e.zoneId,o=t.getContentState().getZoneState(i);if(!(r+1===o.length()))return!1;var a=o.getLine(r);return!!a&&n>=a.length()}function me(e,t){var n=Object(y.g)(),r={mountPoint:{type:b.MountPointType.DOC_IMAGE,token:n},coverOptions:t};return Object(v.e)(e,r)}function ve(e){return e.getEntities(Oe)}function be(e,t,n){return e.getEntities({start:t,end:n},Oe)}function ye(e){var t=e.map(function(e){return de(e.attributes)});return _(t)}function ke(e,t){var n=t.line,r=t.zoneId;return r!==C.a?e.getLineNumInRootZone(r,n):n}function Oe(e){return-1<O.p.indexOf(e)}function Ee(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=a()(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(i,e){t||e("[image plugin] generateGifCover failed, no image src");var o=new Image;o.onload=function(){var e=document.createElement("canvas"),t=o.width,n=o.height;e.width=t,e.height=n;var r=e.getContext("2d");r&&(r.drawImage(o,0,0,t,n),i(e.toDataURL()))},o.onerror=e,o.src=t}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ie(e){var t=e.imageCategory,n=e.uploading,r=e.needTransformToGallery,i=e.needSaveExternal,o=e.needSaveDriveImage,a=!n||!(o||i||r);return[O.D.Drive,O.D.Doc].includes(t)&&a}function Se(e){return"image/gif"===e}var je=function(e){return Array.from(Object.keys(e)).filter(function(e){return e.includes("comment-")})};function Te(e,t){return t.getEntities(e).find(function(e){return 0<e.text.length&&!e.attributes.lmkr})}function Ae(e){var t=e.start,n=t.zoneId,r=t.line;return n===C.a&&0===r}function we(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],i=n.getContentState().getZoneState(t).getLine(e);return i&&(r?i.getModelText():i.getText())}function _e(e,t){var n=e.start,r=n.line,i=n.zoneId,o=n.offset;return(we(r,i,t,!0)||"").slice(o)}function Me(e,t,n){var r=n.getContentState().getZoneState(e).getLine(t);return r?B(r.getEntities([])):null}function xe(e,t,n){var r=n!==C.a,i=2*O.A*e;return t-(r?2*O.b:O.h+O.i)-i}function Le(e,t){return e===C.a?null:Object(T.i)(e,t)}function Ne(e){return Object(j.a)(decodeURIComponent(e.src))===O.D.Doc?Object(g.default)(e,["file_token"]):e}var Re=function(e,t,n){if(!e.isCollapsed())return!1;var r=e.start,i=r.line,o=r.zoneId,a=t.getContentState().getZoneState(o).getLine(i);return!!a&&n(a)},Pe=function(t,e){return Re(t,e,function(e){return 0===t.start.offset})},De=function(t,e){return Re(t,e,function(e){return t.start.offset===e.length()-1})};function Ue(n,e){var t=e.getEntities(function(e,t){return e===O.c&&-1<t.indexOf(n)});return c()(t,1)[0]}},"U+yc":function(e,t){function n(n,r,e,t,i){var o={};return Object.keys(t).forEach(function(e){o[e]=t[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(n,r,o),o=null),o}e.exports=n},U6jy:function(e,t){e.exports=n;var i=Object.prototype.hasOwnProperty;function n(){for(var e={},t=0;t<arguments.length;t++){var n,r=arguments[t];for(n in r)i.call(r,n)&&(e[n]=r[n])}return e}},UeI0:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o});var h=n("PCTH"),r=function(n,e,t,r){var i=t[0],o=t[t.length-1],a=[],s=n.getReps()[e],c=n.lineTracker.collapseLines;if(c){var u=c.trackers[e].entries,l=[];for(t.forEach(function(e){l.push(u[e].output.renderCollapsed)});l.includes(!0);){for(var d=i;d<=o;d++)if(u[d].output.renderCollapsed){for(var f=d;!u[f].output.startOfCollapseSection;)f--;a.push(f)}a.forEach(function(e){var t=Object(h.e)(e,s);Object(h.c)(n,t,!0,n.isEditable(),r)}),t.forEach(function(e,t){l.splice(t,1,u[e].output.renderCollapsed)})}}};function i(e){var t=new RegExp("([a-z]+)([123456789])").exec(e);return t?{type:t[1],indent:Number(t[2])}:null}function o(e){return e["clientside-collapse"]?"true"===e["clientside-collapse"]:"true"===e.collapse}},Uy54:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o});var a=n("FJEn"),s=n("kESg"),r=function(e,t,n){return e.getAttributeOnLine(t,n,s.k.ZoneType)===s.l.CodeBlock?e.getAttributeOnLine(t,n,s.k.ZoneId):""};function i(e){return!(!e.insert||!e.attributes||e.attributes[s.k.ZoneType]!==s.l.CodeBlock)}function o(e,t){if(e===a.DEFAULT_REP_ZONE)return!1;var n=t.managers.zoneToLineEntry[e];if(!n)return!1;var r=t.getRep(n.zone).lines.indexOfEntry(n);if(r<0)return console.warn("can not find codeblock entry in container zone"),!1;var i=t.getContentState().getZoneState(n.zone).getLine(r);if(!i)return!1;var o=i.getAttributes().toMap();return o[s.k.ZoneType]&&o[s.k.ZoneType]===s.l.CodeBlock}},V2TW:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n("VI6H"),i=function(){return Object(r.c)().get("id")||window.User.id},o=function(e){var t=/author-([0-9]+|-|z.+?z)/.exec(e);return t&&t[1]?t[1].replace(/[0-9]+|-|z.+?z/g,function(e){return"-"===e?".":"z"===e.charAt(0)?String.fromCharCode(Number(e.slice(1,-1))):e}):null}},VN5G:function(e,t,n){"use strict";var r=n("f+gR"),i=n("x/Yo"),o=n("toa8"),a=n("Q9MD"),s=n("D7h9"),c=n("ZGZ5"),u=n("5cZX"),l=n("lwsE"),d=n.n(l),f=n("W8MJ"),h=n.n(f),p=n("cDf5"),g=n.n(p),b=n("7EGn"),m=n("xKvl"),y=n("1dfU"),v=n("fQzm"),k=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":g()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},O=parseInt(Object(b.default)(window,"DATA.clientVars.data.user_info.member_id"),10),E=function(){function e(){d()(this,e)}return h()(e,[{key:"logInitVersion",value:function(e){}},{key:"logVersionBreak",value:function(e){var t=e.localVersion;e.remoteVersion<t&&this.logLocateRemoteDiffVersion(e)}},{key:"logBroadcastVersion",value:function(e){var t=e.localVersion,n=e.remoteVersion,r=e.module,i=e.token,o=e.message;console.log("received! BROADCAST_".concat(r,"\n      localVersion: ").concat(t,"\n      remoteVersion: ").concat(n),o),v.b.info("IO: memberId(".concat(O,"):\n      BROADCAST_").concat(r,"\n      token: ").concat(Object(y.a)(i),"\n      localVersion: ").concat(t,"\n      remoteVersion: ").concat(n)),n<t&&this.logLocateRemoteDiffVersion(e)}},{key:"logLocateRemoteDiffVersion",value:function(e){}}]),e}();k([Object(m.a)("doc_comment_log_init_data_version",function(e){var t=e.args[0],n=t.aheadVersion,r=t.behindVersion,i=t.token,o=t.source,a=t.module;return{aheadVersion:n,behindVersion:r,source:o,token:Object(y.a)(i),module:a}})],E.prototype,"logInitVersion",null),k([Object(m.a)("doc_comment_log_broadcast_locate_remote_version",function(e){var t,n,r,i,o,a,s,c,u=e.args[0],l=u.localVersion,d=u.remoteVersion,f=u.source,h=u.token,p=u.module,g=u.message,m={},v=Object(b.default)(g,"data.message.context",null);return"COMMENT"===p&&v?(t=v.ACTION,n=v.REQUEST_ID,r=v.USER_ID,i=v.comment_id,o=v.reply_id,m={actionType:t,requestId:n,commentId:Object(y.a)(i),replyId:Object(y.a)(o),sendUserId:Object(y.a)(r)}):"COMMENT_REACTION"===p&&v&&(a=v.ACTION,s=v.REQUEST_ID,c=v.USER_ID,m={actionType:a,requestId:s,reactionKey:v.reaction_key,sendUserId:Object(y.a)(c)}),Object.assign({localVersion:l,remoteVersion:d,source:f,module:p,token:Object(y.a)(h),memberId:O},m)})],E.prototype,"logBroadcastVersion",null),k([Object(m.a)("doc_comment_log_locate_remote_diff_version",function(e){var t=e.args[0],n=t.localVersion,r=t.remoteVersion,i=t.source,o=t.token;return{localVersion:n,remoteVersion:r,source:i,module:t.module,token:Object(y.a)(o)}})],E.prototype,"logLocateRemoteDiffVersion",null);var C=new E,I=n("paQS"),S=n("kUgE"),j=n("WzBf"),T=n("rLED"),w=n("SebV");n.d(t,"a",function(){return x}),n.d(t,"b",function(){return L});var _=new r.a,M=new i.CommentRecordManager;function x(e,t){e&&"default"!==t||Object(w.a)("createCommentService token objType no collect");var n=_.getOrCreateCommentService({rootType:e,rootToken:t,commentRecordManager:M,getUserId:function(){return Object(c.a)(s.default.getState()).get("id")||window.User.id},getMemberId:function(){return Object(a.b)(s.default.getState())},getIsOwner:function(){return Object(u.F)(s.default.getState())},getLanguage:S.getLanguage,msgBox:Object(T.d)("message_msgBox_enable")?j.a:null,messageVersion:3,isNewMentionUi:Object(T.G)(),isCommentMergeMessage:!1});return n.setupRequest(o.d),n.setupLogger(C),n}function L(e,t,n){n||(_.destroyCommentService(t),M.destroyCommentRecord(e,t),I.a.destroy({suiteType:e,suiteToken:t}))}},Vfrr:function(e,t,n){"use strict";n.d(t,"a",function(){return O});var h,r,p,i,c=n("xpYl");(r=h=h||{}).POST="post",r.GET="get",(i=p=p||{}).InitData="InitData",i.Broadcast="Broadcast",i.VersionBreak="VersionBreak";var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function g(e,a,n,s){function c(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n=n||Promise)(function(t,n){function r(e){try{o(s.next(e))}catch(e){n(e)}}function i(e){try{o(s.throw(e))}catch(e){n(e)}}function o(e){e.done?t(e.value):c(e.value).then(r,i)}o((s=s.apply(e,a||[])).next())})}function m(e,n){var r,i,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function s(t){return function(e){return c([t,e])}}function c(t){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){a.label=t[1];break}if(6===t[0]&&a.label<o[1]){a.label=o[1],o=t;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(t);break}o[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(e,a)}catch(e){t=[6,e],i=0}finally{r=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}var b="BROADCAST",s="/api/broadcast",f=s+"/get_range_message/",y=s+"/get_init_data/",u=2,l=(k.prototype.sendMessage=function(e,t){var n=this.entity,r=n.type,i=n.token,o={type:r,data:a({type:e,token:i},t),version:u};return this.io.request(o)},k.prototype.addHeartbeat=function(e,t){var n;this.registeredId?this.io.updateEntityObserver(this.entity,this.registeredId,{heartbeats:((n={})[""+e]=t,n)}):this.registHbQueue.push({name:e,options:t})},k.prototype.removeHeartbeat=function(e){this.io.removeHeartbeat(this.entity,e)},k.prototype.setHeartbeatVersion=function(e,t){this.io.setHeartbeatVersion(this.entity,e,t)},k.prototype.destroy=function(){this.registeredId&&this.io.unregisterEntityObserver(this.entity,this.registeredId),this.registeredId="",this.registHbQueue=[]},k);function k(e,t,n){var r=this;this.handleMessageQueue=[],this.registeredId="",this.registHbQueue=[],this.handleMessageFromServer=function(t){r.handleMessageQueue.forEach(function(e){return e(t)})},this.onHandlerMessageFromServer=function(e){r.handleMessageQueue.push(e)},this.offHandlerMessageFromServer=function(t){r.handleMessageQueue=r.handleMessageQueue.filter(function(e){return!(e===t)})},this.io=n,this.entity={type:e,token:t};var i=this.io.registerEntityObserver(this.entity,{heartbeats:{},messageHandler:this.handleMessageFromServer});i.then?i.then(function(e){r.registeredId=e,r.registHbQueue.forEach(function(e){var t=e.name,n=e.options;r.addHeartbeat(t,n)})}):this.registeredId=i}var O=(E.prototype.getHeartbeatEntity=function(e){return"broadcast_"+e.toLowerCase()},E.prototype.getBroadcastEntity=function(e){return e.toUpperCase()},E.prototype.unregister=function(e,t){var n=e.toUpperCase();t||this.versionManager.delete(n);var r=this.messageModuleHandlerManager.get(n);r&&this.syncClient.offHandlerMessageFromServer(r),this.messageModuleHandlerManager.delete(n),this.messageHandleManager.delete(n);var i=this.getHeartbeatEntity(n);this.syncClient.removeHeartbeat(i)},E.prototype.fetchClientVars=function(f){return g(this,void 0,void 0,function(){var t,n,r,i,o,a,s,c,u,l,d=this;return m(this,function(e){switch(e.label){case 0:return f=this.getBroadcastEntity(f),this.pendingFetchStatus.set(f,!0),[4,this.request({url:y,method:h.GET,params:{obj_type:this.serviceType,obj_token:this.serviceToken,data_type:f}}).finally(function(){d.pendingFetchStatus.set(f,!1)})];case 1:return t=e.sent(),n=t.ahead_version,r=t.behind_version,i=t.data,o=this.pendingFetchNewVersion.get(f)||0,this.logger&&this.logger.logInitVersion({aheadVersion:n,behindVersion:r,token:this.serviceToken,source:p.InitData,module:f}),a=Math.max(r,o),this.pendingFetchNewVersion.delete(f),s=[i],n===a?[3,3]:[4,this.fetchMissMessage(f,n,a)];case 2:c=e.sent().messages,u=this.handleRemoteMessage(c),c.push.apply(c,v(u)),e.label=3;case 3:return this.updateVersion(f,n),(l=this.messageHandleManager.get(f))&&l(s),[2,t]}})})},E.prototype.setupRequest=function(e){this.requestMethod=e},E.prototype.setupLogger=function(e){this.logger=e},E.prototype.updateVersion=function(e,t){var n,r=this.versionManager.get(e);void 0!==r&&r<t&&(this.versionManager.set(e,t),n=this.getHeartbeatEntity(e),this.syncClient.setHeartbeatVersion(n,t))},E.prototype.fetchMissMessage=function(s,c,u,l){return void 0===l&&(l=0),g(this,void 0,void 0,function(){var t,n,r,i,o,a;return m(this,function(e){switch(e.label){case 0:return 100<l?[2,{messages:[]}]:[4,this.request({url:f,method:h.GET,params:{obj_type:this.serviceType,obj_token:this.serviceToken,data_type:s,min_version:c,max_version:u}})];case 1:return(t=e.sent(),n=t.max_version,r=t.messages,t.has_more)?(i=l+1,[4,this.fetchMissMessage(s,n,u,i)]):[3,3];case 2:o=e.sent(),a=o.messages,t.messages=[].concat(r,a),e.label=3;case 3:return[2,t]}})})},E.prototype.request=function(n){return g(this,void 0,void 0,function(){var t;return m(this,function(e){switch(e.label){case 0:if(!this.requestMethod)throw new Error("no request method found");return this.getMemberId&&(t={memberId:this.getMemberId()},n.headers&&(t=a(a({},n.headers),t)),n.headers=t),[4,this.requestMethod(n)];case 1:return[2,e.sent().data]}})})},E.prototype.handleRemoteMessage=function(e){return e.map(function(e){return e.data})},E.prototype.destroy=function(){var t,e,n,r;this.pendingFetchNewVersion.clear(),this.pendingFetchStatus.clear(),this.messageHandleManager.clear(),this.versionManager.clear(),this.messageModuleHandlerManager.clear(),this.syncClient.destroy();try{for(var i=d(this.versionManager.keys()),o=i.next();!o.done;o=i.next()){var a=o.value,s=this.getHeartbeatEntity(a);this.syncClient.removeHeartbeat(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}try{for(var c=d(this.messageModuleHandlerManager.values()),u=c.next();!u.done;u=c.next()){var l=u.value;this.syncClient.offHandlerMessageFromServer(l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}},E);function E(e){var a=this;this.requestMethod=null,this.logger=null,this.messageHandleManager=new Map,this.messageModuleHandlerManager=new Map,this.versionManager=new Map,this.pendingFetchStatus=new Map,this.pendingFetchNewVersion=new Map,this.register=function(e,t,n){var r=e.toUpperCase(),i=a.getHeartbeatEntity(r);n||a.versionManager.set(r,0);var o=Object(c.a)(a.handleMessageFromServer,r);a.messageModuleHandlerManager.set(r,o),a.messageHandleManager.set(r,t),a.syncClient.onHandlerMessageFromServer(o),a.syncClient.addHeartbeat(i,{interval:1,callback:Object(c.a)(a.handleMessageVersionBreak,r)})},this.handleMessageFromServer=function(d,f){return g(a,void 0,void 0,function(){var t,n,r,i,o,a,s,c,u,l;return m(this,function(e){switch(e.label){case 0:return(e.trys.push([0,4,,5]),f.data)?f.type!==b?[2]:(t=f.data,(n=t.type)!==d?[2]:t.token!==this.serviceToken||void 0===(r=this.pendingFetchStatus.get(d))?(this.fetchClientVars(d),[2]):void 0!==(i=this.versionManager.get(d))&&(o=this.messageHandleManager.get(d))?(a=t.message,s=a.version,!0===r?(this.pendingFetchNewVersion.set(d,s),[2]):(this.logger&&this.logger.logBroadcastVersion({localVersion:i,remoteVersion:s,source:p.Broadcast,module:d,token:this.serviceToken,message:f}),s<i?(this.fetchClientVars(d),[2]):i+1!==s||t.oversize?[3,1]:(u=this.handleRemoteMessage([a]),o(u),[3,3]))):[2]):[2];case 1:return[4,this.fetchMissMessage(n,i,s)];case 2:c=e.sent(),u=this.handleRemoteMessage(c.messages),o(u),e.label=3;case 3:return this.updateVersion(d,s),[3,5];case 4:return l=e.sent(),console.error(l),[3,5];case 5:return[2]}})})},this.handleMessageVersionBreak=function(s,c){return g(a,void 0,void 0,function(){var t,n,r,i,o,a;return m(this,function(e){switch(e.label){case 0:return void 0===(t=this.versionManager.get(s))?[2]:c<=t||void 0===(n=this.pendingFetchStatus.get(s))?[2]:!0===n?(this.pendingFetchNewVersion.set(s,c),[2]):(this.logger&&this.logger.logVersionBreak({localVersion:t,remoteVersion:c,source:p.VersionBreak,module:s,token:this.serviceToken}),c<t?(this.fetchClientVars(s),[2]):(r=this.messageHandleManager.get(s))?(i=this.getBroadcastEntity(s),[4,this.fetchMissMessage(i,t,c)]):[2]);case 1:return o=e.sent(),a=this.handleRemoteMessage(o.messages),r(a),this.versionManager.set(s,c),[2]}})})};var t=e.serviceType,n=e.serviceToken,r=e.engineType,i=e.io,o=e.getRequest,s=e.getMemberId;this.syncClient=new l(r,n,i),this.serviceType=t,this.serviceToken=n,this.getMemberId=s(),this.requestMethod=o()}C.prototype.getOrCreateBroadcast=function(e){var t=this.broadcastMap.get(e.serviceToken);return t||(t=new O(e),this.broadcastMap.set(e.serviceToken,t)),t},C.prototype.destroyBroadcast=function(e){var t=this.broadcastMap.get(e);t&&t.destroy(),this.broadcastMap.delete(e)};function C(){this.broadcastMap=new Map}},Vr4U:function(e,Z,Q){"use strict";Q.r(Z),function(r){Q.d(Z,"default",function(){return U}),Q.d(Z,"docMention",function(){return q});var e=Q("J4zp"),a=Q.n(e),t=Q("o0o1"),i=Q.n(t),n=Q("yXPU"),o=Q.n(n),s=Q("lwsE"),c=Q.n(s),u=Q("W8MJ"),l=Q.n(u),F=(Q("kooH"),Q("HmyT")),z=Q("mRaX"),B=Q("AiBH"),H=Q("7Kxq"),d=Q("7EGn"),f=Q("OZf9"),h=Q("UXvI"),p=Q("Bq+3"),g=Q("9h4r"),m=Q("pIdd"),v=Q("FGOA"),W=Q("iP/4"),b=Q("aXiW"),y=Q("H6oK"),k=Q("2ACu"),O=Q("lG83"),E=Q("dDhe"),C=Q("Hydg"),I=Q("OX8E"),S=Q("nQY9"),j=Q("lQZd"),T=Q("VI6H"),w=Q("/fVd"),V=Q("QM+C"),_=Q("rLED"),K=Q("D28M"),M=Q("y2sV"),x=Q("whZn"),L=Q("oJoF"),N=Q("Mvmg"),R=Q("PI5S"),P=Q("Guq5"),D=32,U=function(){function n(e){var s=this;c()(this,n),this.className="Mention",this.customIconEnable=Object(_.n)(),this.callbackQueueInNextTick=[],this.hasPressedAt=!1,this.init=function(){Object(E.c)()||s.initContainer(),s.cache={},s.handleResize=Object(h.default)(s.onResize,500),s.hover=new g.a(s.props),v.a.init();var e=s.props,t=e.showChatCards,n=e.source,r=e.type;t&&m.a.init({editor:s.editor,source:n}),s.mentionNotification=new S.a({editor:s.props.editor,boxType:r,fileType:Object(j.l)(),fileToken:Object(j.g)()}),s.editor.on(B.l,s.hidePopover),s.editor.on(C.a.ADD_MENTION_NOTIFY,s.onAddUserMentionNotify),s.editor.on(B.B,s.handleAfterTableRegister),s.props.controller&&s.props.controller.onReferenceListMount(s.pullAllMentionObjects)},this.hidePopover=function(e){var t=e.isDragging;s.hover&&s.hover.setCanShowPopover(!t)},this.handleAfterTableRegister=function(){s.initEmbedObjMap()},this.hasTriedPullingMention=!1,this.onMount=function(){s.updateMentionInfo({0:s.editor.getClientVars().apool.numToAttrib}),window.addEventListener("click",s.onWindowClick),I.a.on(B.D,s.toggleEmbedObjClassName),s.props.controller&&s.editor.on(L.b,o()(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Q.e("doc_index_css"),Q.e("chunk_adit"),Q.e("commons--doc_index_delay--voteEmoji--votePicker"),Q.e(16),Q.e("commons--doc_index_delay--jira"),Q.e("doc_index_delay")]).then(Q.bind(null,"GYvY"));case 2:if(t=e.sent,n=t.default,s.editor){e.next=6;break}return e.abrupt("return");case 6:s.mentionFileManager=new n,s.docMention.setMentionFileManager(s.mentionFileManager),s.hasTriedPullingMention&&s.pullAllMentionObjects();case 9:case"end":return e.stop()}},e)})))},this.pullAllMentionObjects=function(){var e,t=s.mentionFileManager,n=s.props.controller;t&&n?(e=t.pullAllMentionObjects(s.editor),n.mentionFileListChange(e)):s.hasTriedPullingMention=!0},this.toggleEmbedObjClassName=function(e,r){var t,i;s.editor&&(t=Object(x.b)(s.editor,e),i="content-with-lock",s.editor.getObserver().withoutRecordingMutations(function(){t.forEach(function(e){var t,n=e.querySelector("a");n&&(t=n.classList.contains(i),r?t||n.classList.add(i):t&&n.classList.remove(i))})}))},this.initEmbedObjMap=function(){var e;s.embedObjShareEnable&&(e=function(e){return 0===Object.keys(e).length},w.a&&e(w.a.embedObjMap)&&w.a.initEmbedObjMap(s.editor))},this.lineNodesRendered=function(e,t){var n=t.data,r=n.lineEntries,i=void 0===r?[]:r,o=n.isFirstBlock,a=i.map(function(e){return e&&e.lineNode});setTimeout(function(){o||m.a.updateWithNodes(s.editor,a)})},this.lineNodesMounted=function(e,t){var n;s.embedObjShareEnable&&(n=w.a&&w.a.cantReadFiles||{},Object.keys(n).forEach(function(e){var t=n[e];s.toggleEmbedObjClassName(e,t)}))},this.searchStringRange=function(e,t){t.attributeList.find(function(e){return-1<e.indexOf("mention-chatId_")||-1<e.indexOf("drive-fileId")})&&(t.isSearchable=!1)},this.aceInitialized=function(e,t){s.editor=t.editorInfo,s.docMention.editor=s.editor,s.init()},this.initContainer=function(){var e=s.editor.getDocBody(),t=Object(F.$)(e).parents(".etherpad-container");t.length||(t=Object(F.$)(e).parent()),s.$positionHolder=Object(F.$)(".doc-position"),s.$positionHolder.length||(s.$positionHolder=Object(F.$)('<div class="doc-position"></div>'),t.prepend(s.$positionHolder))},this.updateMentionInfo=function(e){m.a.update(s.editor,e)},this.collectText=function(e,t){var n=t.attributes;if(-1<(n?n.map(function(e){return e[0]||""}).join(" "):"").indexOf("mention-chatId"))return"[".concat(r("etherpad.lark.group.card"),"]")},this.collectCommentTargetType=function(e,t){var n=t.node;if(-1<Object(d.default)(n,"children[0].className","").indexOf("mention-chatId"))return"groupCard"},this.onWindowClick=function(){I.a.trigger(C.a.HIDE_SHARE_POPUP)},this.onAddUserMentionNotify=function(e){var t=e.user,n=e.blockId;s.mentionNotification.addMentionNotify({userId:t.id,userName:Object(T.q)(t),isExternal:t.is_external,blockId:n,notNotify:t.not_notify,blockNotify:t.block_notify})},this.nextTick=function(e){s.callbackQueueInNextTick.push(e)},this.changesetApply=function(e,t){var n,r=t.changeset,i=t.editor;r&&(n=i.getAttributesFromChangeset(t.changeset),Object.keys(n).length&&(m.a.update(i,n),s.callbackQueueInNextTick.forEach(function(e){return e()}),s.callbackQueueInNextTick=[],s.docMention.changesetApply(e,t)))},this.reset=function(){window.removeEventListener("click",s.onWindowClick),I.a.off(B.D,s.toggleEmbedObjClassName),s.editor.off(C.a.ADD_MENTION_NOTIFY,s.onAddUserMentionNotify),s.editor.off(B.l,s.hidePopover),s.editor.off(B.B,s.handleAfterTableRegister),s.cache={};var e=s.mentionFileManager;s.props.showChatCards&&m.a.reset(),s.docMention.destory(),s.hover.destory(),v.a.destory(),s.editor=null,s.docMention.editor=null,s.closeMention(),s.docMention=null,s.handleResize.cancel(),s.handleResize=null,s.$positionHolder=null,s.component=null,e&&e.reset();var t=s.props.controller;t&&t.offReferenceListMount(s.pullAllMentionObjects)},this.bufferChanged=function(e,t){return s.docMention.bufferChanged(e,t)},this.editorAlinesDidSplice=function(e,t){return s.docMention.editorAlinesDidSplice(e,t)},this.processBeforeInsertNode=function(e,t){return s.docMention.processBeforeInsertNode(e,t)},this.aceAttribsToClasses=function(e,t){return s.docMention.aceAttribsToClasses(e,t)},this.aceCreateDomLine=function(e,t){return s.docMention.aceCreateDomLine(e,t)},this.match=function(e,t){return s.docMention.match(e,t)},this.render=function(e){return s.docMention.render(e)},this.deserialize=function(e){return s.docMention.deserialize(e)},this.serialize=function(e){return s.docMention.serialize(e)},this.aceBeforeCopy=function(e){return s.docMention.aceBeforeCopy(e)},this.aceAfterCompositionEnd=function(e){return s.docMention.aceAfterCompositionEnd(e)},this.UNSAFE_editorNormalizePasteNode=function(e){return s.docMention.UNSAFE_editorNormalizePasteNode(e)},this.editorWillPaste=function(e){return s.docMention.editorWillPaste(e)},this.collectContentPre=function(e,t){return s.docMention.collectContentPre(e,t)},this.afterPasteInsert=function(e,t){return s.docMention.afterPasteInsert(e,t)},this.acePaste=function(e,t){return s.docMention.acePaste(e,t)},this.beforeAceSelectionChange=function(e,t){Object(z.b)(s.editor,t)},this.commentListUpdate=function(){s.handleResize()},this.onResize=function(){var e,t,n,r,i,o;s.component&&s.component.isMentionBoxVisible()&&(e=s.uuid,(t=Object(F.$)(".".concat(H.a).concat(e)).get(0))&&(r=(n=s.props).boxWidth,o=(i=n.container)?Object(F.$)(i):Object(F.$)(".doc-position"),s.component.mentionBox.setState({style:Object(z.F)(Object(z.v)(t,{boxWidth:r,$boxContainer:o,bottomGap:16}))})))},this.editorSizeChange=function(){s.handleResize()},this.aceCompositionEvent=function(e,t){return s.handleKeyEvent(t,p.a,"doc")},this.isStandardAt=function(e){var t=e.key,n=e.shiftKey,r=e.type,i=e.originalEvent||e;return"keydown"===r&&(("@"===t||"Digit2"===Object(d.default)(i,"code"))&&n)},this.upload=function(e){var t=e.event,n=e.source;[P.a.A_PANEL,P.a.BLOCK_MENU].includes(n)&&s.uploadVideoFile(t)},this.linesWillReplace=function(e,t){s.docMention.linesWillReplace(e,t);var o,n=t.oldLineEntries,a=t.newLineEntries;n[0]&&a[0]&&(o=".".concat(B.o),Object(f.a)(n,function(e,t){var n,r,i=e.lineNode;a[t]&&(n=a[t].lineNode,Object(F.$)(n).find(".drive").length||Object(F.$)(i).find(".drive").length||(r=Object(F.$)(i).find(o)).length&&(Object(F.$)(n).find(o).replaceWith(r),s.editor.markNodeClean(n,a[t])))}))},this.prevTextIsWordsOrNumber=function(){if(s.editor.inCallStackIfNecessary("openMention",function(){s.editor.fastIncorp()}),W.a.isIE)return Object(z.T)();var e=s.editor.getRep(),t=a()(e.selStart,2),n=t[0],r=t[1],i=e.lines.atIndex(n),o=r?i.text.slice(r-2,r-1):"";return/^[a-zA-Z0-9]$/.test(o)},this.openMention=function(e,t,n){var r=s.uuid=Object(z.h)();s.component=s.docMention,s.closeMention();var i={uuid:r,list:[],message:s.cache.message};return t.preventDefault(),s.component.showMentionBox(e,i,t,n),Object(b.a)("confirm_mention").push({recommend_group:"default_recomment"}),!0},this.closeMention=function(e){s.component&&s.component.isMentionBoxVisible()&&(s.hasPressedAt=!1,s.component.mentionBox&&s.component.mentionBox.close(e))},this.handleChange=function(e,t){var n=s.getKeyWords(e);void 0!==n&&(Object(b.a)("confirm_mention").push({recommend_group:n?"search_recommend":"default_recomment"}),s.docMention&&s.docMention.updateKeywords(n,t))},this.handleIframeBtnClick=function(e,t,n){s.editor.call("insertIframeLink",{e:e,iframeKey:t,createSource:n})};var t=e.editor;this.props=e,t&&(this.editor=t,this.addMentionCls(),this.embedObjShareEnable=Object(_.s)(),this.init()),this.docMention=new p.a(Object.assign({},e,{embedObjShareEnable:this.embedObjShareEnable})),this.docMention.setCustomIconEnableFG(this.customIconEnable)}return l()(n,[{key:"addMentionCls",value:function(){var e;Object(_.G)()&&(e=this.editor.getDocBody(),Object(z.a)(e))}},{key:"aceKeyEvent",value:function(e,t){var n=this.props.type,r=this.editor.getRep();if(!r||0!==r.selStart[0]||"0"!==r.zoneId||"doc"!==n)return this.handleKeyEvent(t)}},{key:"insertReturn",value:function(){var e=this,t=this.editor.getRep(),n=this.editor.getLine(),r=t.lines.atIndex(n);if(this.editor.version.includes(M.y)){var i=this.editor.getContentState().getZoneState(t.zoneId).getLine(n);if(!i)return;if(i.getLineAttributes().every(function(e){return H.c.includes(e[0])})&&i.isEmpty())return}else if(r&&"string"==typeof r.text&&Object(z.N)(r.text))return;var o=t.selStart[0],a=t.lines.atIndex(o),s=[o,a.text.length],c=[o,a.text.length],u=t.selStart[0]+1;this.editor.callWithAce(function(){e.editor.performDocumentReplaceRange(e.editor.getRep().zoneId,s,c,"\n"),e.editor.dom?e.editor.performSelectionChange(t.zoneId,[u,0],[u,0]):e.editor.performSelectionChange([u,0],[u,0]),e.editor.version.includes(M.y)||e.editor.updateBrowserSelectionFromRep(!0)},"doReturn",!0)}},{key:"handleBarBtnClick",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};r.command=t;var i={editor:this.editor,rep:this.editor.getRep()};return Object.values(B.p).includes(r.command)?(Object(k.default)("confirm_mention",{mention_type:"iframe",mention_sub_type:e,panel_source:"a_panel",zone:Object(O.l)(),line_is_empty:Object(z.P)(this.editor)}),this.handleIframeBtnClick(r,e,"toolbar")):r.command===y.BlockType.POLL_BLOCK?this.handlePollConfirm(i,n):r.command===B.q.DRIVE?this.handleFileUpload(i):(r.command===B.q.CHAT&&this.insertReturn(),this.handleOpenMention(i,r)),!0}},{key:"handleOpenMention",value:function(e,t){var n=this.uuid=Object(z.h)();this.component=this.docMention,this.closeMention();var r={uuid:n,list:[],message:this.cache.message};this.component.showMentionBox(e,r,t)}},{key:"handleFileUpload",value:function(e){this.insertReturn(),document.getElementById("uploader-file-btn").click()}},{key:"isVideoFile",value:function(e){return!!e.type&&/video\/(.*)$/.test(e.type)}},{key:"uploadVideoFile",value:function(n){var r=this;this.insertReturn(),Array.from(Object(d.default)(n,"target.files")||[]).forEach(function(e){var t;r.isVideoFile(e)&&(t=Object.assign(e,{source:N.i.TOOL_BAR,event:n}),Object(R.c)(t))})}},{key:"handlePollConfirm",value:function(e,t){var n=this.docMention,r=y.BlockType.POLL_BLOCK,i=this.uuid=Object(z.h)(),o={uuid:i,list:[],message:this.cache.message,isAPanelPoll:!0},a=Object(y.generateBlockDataSet)(Object.assign({blockType:r,creator:Object(y.getBlockCreator)(r,this.editor)},t));Object(k.default)("click_create_poll",{block_id:a.blockId,create_source:"toolbar",poll_type:t.initData.type}),n.createBlankDom(e,i,z.c,e.rep.selStart,!0);var s=function(){n.handleConfirm({data:{dataSet:a,type:B.E.BLOCK,pollType:t.initData.type}},e,o)};e.editor.version.includes(M.y)?e.editor.once("paint",s):s()}},{key:"editorKeyDown",value:function(e,t){I.a.trigger(C.a.HIDE_SHARE_POPUP),this.hover&&this.hover.hidePopover()}},{key:"handleKeyEvent",value:function(t,e){var n=this,r=t.evt,i=t.isTypeForCmdKey,o=t.padShortcutEnabled,a=r.keyCode,s=r.type,c=r.which,u=r.altKey,l=r.ctrlKey,d=r.metaKey,f=B.t.LEFT,h=B.t.RIGHT,p=B.t.UP,g=B.t.DOWN,m=B.t.RETURN,v=B.t.BACKSPACE,b=B.t.ESC,y=B.t.TAB,k=B.t.DELETE,O=this.docMention,E=O.deleteMentionIfNecessary,C=O.isMentionBoxVisible,I=O.mentionBox,S=C(),j=String.fromCharCode(c).toLowerCase();if(i&&"z"===j&&(d||l)&&!u&&o.cmdZ)S&&this.nextTick(function(){return n.handleChange(t,r)});else if(!(i&&"y"===j&&(d||l)&&o.cmdY||"c"===j&&(d||l))){var T,w=Object(z.A)(),_=Object(F.$)(w.focusNode).parent(),M=-1<[f,p,h,g,v].indexOf(a),x=!1,L=!1;if(Object(z.O)(w)&&(T=w.focusOffset,x=!this.editor.dom.isRootOfZone(_[0])&&T===_.text().length,L=0===T),"compositionstart"===s?this.composition=!0:"compositionend"===s&&(this.composition=!1),Object(z.R)(_.get(0))&&!M&&!x&&!L)if("compositionstart"===s)this.startText=_.text();else if("compositionend"===s)_.text(this.startText);else if("keydown"===s)return r.preventDefault(),!0;var N=this.props.showable,R=!S&&!V.isAnonymousAccess&&N;if("keypress"===s&&"@"===j&&R&&(this.hasPressedAt=!0),"keyup"===s&&-1===[p,g,h,f,v,m,b,y].indexOf(a)&&R){var P=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"@";if(n.hasPressedAt=!1,!n.prevTextIsWordsOrNumber())return W.a.isEdge?(n.composition=!1,n.editor.fastIncorp(!0),n.openMention(t,r,e)):n.composition?void 0:n.openMention(t,r,e)};if(Object(z.U)(this.editor))P();else if(this.hasPressedAt){var D=Object(z.E)();if(null===D)return;P(D)}}if((a===v||a===k)&&"keydown"===s&&!S)return this.needOpenMentionBox=!1,E(t);if("keydown"===s&&S&&-1<[f,h].indexOf(a)&&(t.preventOtherHooksHandle=!0,r.preventDefault()),a===v&&"keyup"===s&&S){var U=Object(z.A)().focusNode;if(Object(F.$)(U.parentNode).prev().hasClass("".concat(H.a).concat(this.uuid)))return!0;Object(K.l)(U,"".concat(H.a).concat(this.uuid))||(this.needOpenMentionBox=!1,I&&I.close())}if(S&&("keydown"===s||"compositionend"===s)){if(-1<[m,p,g,h,f].indexOf(a))return t.preventOtherHooksHandle=!0,r.preventDefault(),!0;this.nextTick(function(){return n.handleChange(t,r)})}}}},{key:"getKeyWords",value:function(e){var t=e.editor,n=t.getRep(),r=n.alinesWidth,i=n.selStart,o=n.zoneId,a=i[0],s=H.a+this.uuid,c=t.getTextAndAttrsOnSelection({selStart:[a,0],selEnd:[a,r[a]],selZone:o}).filter(function(e){return e.attributes[s]});if(c.length){var u=c[0].text,l="";if(0!==u.length){if(u[0]===z.c)l=Object(z.f)(u);else{if("@"!==u.slice(0,1))return void this.closeMention();l=u.slice(1)}return(l=(l||"").split(String.fromCharCode(160)).join(" ")).slice(0,D)}this.closeMention(!0)}}}]),n}(),q=new U({type:"doc",postAddMentionId:!0,hoverArea:"#innerdocbody",showable:!0,showChatCards:!0,boxWidth:540,source:B.z.DOC,container:".doc-position",notify:!0})}.call(this,Q("2vAP"))},"Wc+A":function(e,s,h){"use strict";(function(m){var e=h("pVnL"),c=h.n(e),t=h("lwsE"),n=h.n(t),v=h("wq9/"),b=h("HmyT"),y=h("mRaX"),u=h("bCSi"),r=h("q1tI"),l=h.n(r),i=h("i8i4"),d=h.n(i),o=h("Si88"),f=h.n(o),a=function e(){var g=this;n()(this,e),this.showPopover=function(e){var t=e.uuid,n=e.editor,r=e.container,i=e.token,o=e.suiteType,a=e.title;g.visible&&(g.clearPopupHideTimeout(),g.closePopOver());var s,c,u,l,d,f,h,p=Object(b.$)(".mention-uuid_".concat(t));p&&(s=Object(v.a)(p.get(0),n),c=Object(b.$)(r),u=84,l=48,d=Object(y.k)([m("permission.embed.share_tips_2")+m("permission.embed.share_btn")],57),f=Object(y.v)(p,{horizontalAlign:"center",boxWidth:d,boxMaxHeight:u,boxMinHeight:l,upFirst:!0,gap:10,zoom:s,$container:c,coverNavBar:!0}),h={style:Object(y.F)(f),container:c.get(0),handlePopOverEnter:g.onMouseEnter,handlePopOverLeave:g.onMouseLeave},g.renderPopOver(h,i,o,a),g.hidePopupTimeoutId=setTimeout(function(){g.onHideSharePopup()},4e3))},this.renderPopOver=function(e,t,n,r){var i=e.container,o=e.style,a=document.createElement("div");i.appendChild(a),g.container=i,g.wrapper=a;var s=!0;d.a.render(l.a.createElement(f.a,{in:s,timeout:250,classNames:"popover-fade",onExited:g.remove},l.a.createElement("section",{onMouseEnter:g.onMouseEnter,onMouseLeave:g.onMouseLeave},l.a.createElement(u.a,c()({token:t,type:n,title:r,style:o},{closePopover:g.closePopOver,onHideSharePopup:g.onHideSharePopup})))),a,function(){g.visible=!0})},this.close=function(){d.a.unmountComponentAtNode(g.wrapper),g.container.removeChild(g.wrapper),g.wrapper=null,g.container=null},this.closePopOver=function(){g.visible&&(g.close(),g.visible=!1)},this.onMouseEnter=function(){g.isHoverPopup=!0,g.clearPopupHideTimeout()},this.onMouseLeave=function(){g.isHoverPopup=!1,g.clearPopupHideTimeout(),g.hidePopupTimeoutId=setTimeout(function(){g.onHideSharePopup()},2e3)},this.onHideSharePopup=function(){g.isHoverPopup||g.closePopOver()},this.clearPopupHideTimeout=function(){clearTimeout(g.hidePopupTimeoutId),g.hidePopupTimeoutId=0},this.destroy=function(){g.clearPopupHideTimeout(),g.closePopOver()},this.isHoverPopup=!1,this.hidePopupTimeoutId=0,this.visible=!1,this.wrapper=null,this.container=null};s.a=a}).call(this,h("2vAP"))},WsN4:function(e,t,n){"use strict";var r,i;n.d(t,"a",function(){return r}),(i=r=r||{}).Src="src",i.DataNoRequestSrc="data-no-request-src",i.DataSrc="data-src",i.DataSuite="data-suite",i.DataHeight="data-height",i.DataWidth="data-width"},WtIE:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return k});var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("cDf5"),c=n.n(s),u=n("q1tI"),l=n.n(u),d=n("YNKm"),f=n("YWBl"),h=n("7Kxq"),p=n("F9bh"),g=n("y2sV"),m=n("OWch"),v=n("Nl7c"),b=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a},y="IGNORE_UNDERLINE",k=function(){function t(e){var a=this;i()(this,t),this.editor=e,this.className="Underline",this.aceInitialized=function(e,t){a.register(t.editorInfo)},this.register=function(e){e.commands.registerAceCommand(d.db,function(e,t,n,r){var i=r.source,o=a.toggleAttribute({attribKey:"underline",attribValue:!0});Object(f.a)({action:"underline",op:o?h.g:h.f,source:i})},{statusKey:"underline-true"})},this.aceAttribsToClasses=function(e,t){return"underline"===t.key?["tag:u"]:null},this.editor=e,this.register(e)}return a()(t,[{key:"toggleAttribute",value:function(e){var t=e.attribKey,n=e.attribValue,r=e.range,i=e.isSpecialSelection,o=e.isAllHasAttrib,a=r.selStart,s=r.selEnd,c=r.attributeManager;return i?(c.setAttributesOnRange(a,s,[[t,o?"":n]]),o):this.editor.toggleAttributeOnSelection(t,r,n)}},{key:"serialize",value:function(e){return Object(g.P)(e,{tagAttribute:d.db,wrapTag:g.a[d.db]})}},{key:"match",value:function(e){return"underline"===e}},{key:"deserialize",value:function(e){var t=e.node,n=e.deltaSet,r=e.zoneId;if(t instanceof HTMLElement){var i=t.tagName,o=t.getAttribute("style")||"";if("U"===i||"INS"===i||/\btext-decoration(-line)?:[^;]*underline\b/i.test(o))return Object(g.H)(n,r,{underline:"true"})}return n}},{key:"render",value:function(e){var t=e.children;return l.a.createElement(g.w,{style:{textDecoration:"underline"}},t)}}]),t}();b([Object(p.a)()],k.prototype,"toggleAttribute",null),b([m.a,Object(v.b)()],k.prototype,"render",null)},XB4d:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var w=n("nVH4"),_=n("iP/4");function r(e){var n=e.editor,r=e.evt,t=e.isSpecialContent,i=e.selectContentCallback,o=5,a=r.keyCode,s=r.ctrlKey,c=r.metaKey,u=r.shiftKey,l=n.selection.getSelection().start,d=l.line,f=l.offset,h=n.getContentState().getActiveZone(),p=h.getLine(d),g=Math.max(0,d-1),m=h.getLine(g),v=d+1,b=h.getLine(v),y=!!p&&t(n,p,d),k=!!m&&t(n,m,g),O=!!b&&t(n,b,v),E=n.getContentState().getActiveZone().getZoneId();if(!y&&!k&&!O||c||s||u)return!1;if((k||O)&&!y&&a===w.a.UP&&0<p._entry.getCharRect(f).top)return!1;var C=p.length()-p.getLineMarker();function I(){if(0===C)return!0;if(y)return!0;var e=p._entry.getCharRect(f),t=p._entry.getCharRect(0);return Math.abs(t.top-e.top)<=o}function S(){if(0===C)return!0;if(y)return!0;var e=p._entry.getCharRect(f),t=p._entry.getCharRect(p.length()-1);return Math.abs(t.top-e.top)<=o}function j(){var e=!k&&m?m.length():0;n.performSelectionChange(E,[g,e],[g,e]);var t=_.a.isEdge||_.a.isIE;n.updateBrowserSelectionFromRep(t),r.preventDefault(),m&&i&&i(n,m,g)}function T(){var e=0;n.performSelectionChange(E,[v,e],[v,e]);var t=_.a.isEdge||_.a.isIE;n.updateBrowserSelectionFromRep(t),r.preventDefault(),b&&i&&i(n,b,v)}switch(a){case w.a.UP:if(k&&I()||y)return j(),!0;break;case w.a.DOWN:if(O&&S()||y)return T(),!0;break;case w.a.LEFT:if(k&&f===p.getLineMarker()||y)return j(),!0;break;case w.a.RIGHT:if(O&&f+1>=p.length()||y)return T(),!0;break;default:return!1}return!1}},XDjv:function(e,t,n){"use strict";var r=n("RIqP"),p=n.n(r),i=n("lwsE"),o=n.n(i),a=n("W8MJ"),s=n.n(a),c=n("ibWA"),g=n("H6oK"),m=n("Xngx"),v=n("uEBw"),b=n("Mvmg"),u=n("jVwk"),l=n("2ACu");function d(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Object(l.default)("block_update_props",Object.assign({block_id:e.blockId,block_type:e.blockType},t))}var O=n("mRaX");n.d(t,"a",function(){return f});var f=function(){function n(e,t){var k=this;o()(this,n),this.insertInSingleLine=function(){var e=k.ace.editorInfo,t=e.getRep();e.inCallStackIfNecessary("insertDriveInSingleLine",function(){e.fastIncorp(),e.performDocumentReplaceRangeWithAttributes(t.zoneId,t.selStart,t.selEnd,"\n")})},this.insertPlaceholder=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.driveKey,r=void 0===n?"none":n,i=t.uploadOwner,o=void 0===i?"":i,a=t.atUuid,s=void 0===a?"":a,c=k.ace,u=k.uuid,l=c.editorInfo,d=l.getRep();if(l.updateBrowserSelectionFromRep(!0),e instanceof File){l.inCallStackIfNecessary("mentionFastIncrop",function(){l.fastIncorp()});var f=d.selStart||[1,0],h=d.selEnd||[1,0],p=d.zoneId||"0",g={};if(s){if(!(g=Object(O.z)(l,s)))return;f=g.selStart,h=g.selEnd,p=g.selZone}var m,v,b=" ",y=!0;f&&h&&(m=k.generateCardAttributes({file:e,uuid:u,driveKey:r,uploadOwner:o,useDriveStorage:y}),l.callWithAce(function(){l.fastIncorp();var e=k.adaptEnterText(m,f,h,p,g);b=e.text;var t=e.ops;l.performDocumentReplaceMultiRangeWithAttributes(p,t)},"insertDriveUploadPlaceholder",!0),v=d.selStart[0]+1,"\n"!==b.slice(-1)&&v<d.lines.length()&&l.inCallStackIfNecessary("insertDrivePerformRepChange",function(){l.performSelectionChange(p,[v,0],[v,0])}))}},this.adaptEnterText=function(n,r,i,e){var t=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},o=k.ace.editorInfo.getReps()[e],a=Object(u.a)(o,null,t);return{text:a,ops:Object(c.b)(a).map(function(e,t){return{start:0===t?r:i,end:i,newText:e,attributes:"\n"===e?[]:n}})}},this.updateFileCard=function(e){var t=e.driveKey,n=void 0===t?"":t,r=e.owner,i=void 0===r?"":r,o=k.ace.editorInfo;o.callWithAce(function(){o.fastIncorp(),k._replaceCard(o,{driveKey:n,owner:i})},"insertFileCardSuccess",!0)},this.updateDriveKey=function(e){k.updateFileCard({driveKey:e})},this.updateFileOwner=function(e){k.updateFileCard({owner:e})},this.generateCardAttributes=function(e){var t=e.file,n=e.uuid,r=e.driveKey,i=e.uploadOwner,o=e.useDriveStorage,a=t.name,s=t.size,c=t.type,u={name:a,type:a.split(".").pop(),actualType:c,size:s,driveKey:r,uploadOwner:i,useDriveStorage:o},l=["m4a"],d=g.ViewTypes.CARD;!Object(v.e)(u.type,s)||Object(m.m)(u.type)||Object(m.k)(u.type)||l.includes(u.type.toLowerCase())||(d=g.ViewTypes.PREVIEW);var f=Object(g.generateBlockDataSet)({blockType:g.BlockType.FILE_CARD_BLOCK,props:{data:{fileId:n,fileInfo:u},viewType:d,version:b.g}}),h=k.ace.editorInfo.plugins.blockPlugin.getAttrsFromBlockDataSet(f);return k.blockId=f.blockId,[["at-holder",0]].concat(p()(h))},this._replaceCard=function(e,t){var n,r,i=t.driveKey,o=void 0===i?"":i,a=t.owner,s=void 0===a?"":a,c=e.plugins.blockPlugin.blockInfos.get(k.blockId);c&&c.instance?(n=c.instance.props.data)&&n.fileInfo?(r=n.fileInfo,o&&(r.driveKey=o),s&&(r.owners||(r.owners={}),r.owners[s]=!0),n.fileInfo=r,c.instance.setProps({data:n}),d(c.instance,{status:"success"})):d(c.instance,{status:"error-fileInfo"}):d(c.instance,{status:"error-instance"})},this.ace=t,this.uuid=e}return s()(n,[{key:"destroy",value:function(){delete this.ace}},{key:"deleteFileCard",value:function(){var n=this,r=this.ace.editorInfo;r.callWithAce(function(){r.fastIncorp();var e=r.plugins.blockPlugin,t=e.getBlockById(n.blockId);t&&e.deleteBlock({block:t})},"deleteDriveFileCard",!0)}}]),n}()},XJJA:function(e,I,S){"use strict";(function(e){S.d(I,"e",function(){return c}),S.d(I,"d",function(){return u}),S.d(I,"c",function(){return l}),S.d(I,"g",function(){return f}),S.d(I,"f",function(){return h}),S.d(I,"b",function(){return k}),S.d(I,"a",function(){return E});var t=S("o0o1"),p=S.n(t),n=S("yXPU"),r=S.n(n),g=S("j1lG"),m=S("Tqb2"),i=S("BpSZ"),o=S("gSGL"),a=S("n/R6"),v=S("Z/PY"),b=S("15MJ"),y=S("lQZd"),s=S("kESg");function c(e){return e!==s.l.CodeBlock&&e!==s.l.CalloutBlock}function u(e){return e.size<=g.z}function l(e){return d.apply(this,arguments)}function d(){return(d=r()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof File)return e.abrupt("return",t);e.next=2;break;case 2:if(Object(o.a)(t)&&Object(i.b)(t))return e.next=5,Object(m.b)(t);e.next=6;break;case 5:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(){a.a.show({type:"error",closable:!0,content:e("etherpad.upload_failed_than_size")})}function h(){a.a.show({type:"error",closable:!0,content:e("etherpad.upload_failed")})}function k(e,t){return O.apply(this,arguments)}function O(){return(O=r()(p.a.mark(function e(t,n){var r,i,o,a,s,c,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=URL.createObjectURL(n),e.next=3,Object(m.R)(r);case 3:return i=e.sent,o=i.naturalWidth,a=i.naturalHeight,s={uploading:!0,uploadProgress:g.C,intermediateSrc:r},c=Object.assign({uuid:t,height:a.toString(),width:o.toString(),natrualHeight:a.toString(),natrualWidth:o.toString(),image_type:n.type,size:n.size,isLocalAttribs:!0},s),u={items:[c]},e.abrupt("return",JSON.stringify(u));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function E(e,t,n){return C.apply(this,arguments)}function C(){return(C=r()(p.a.mark(function e(t,n,r){var i,o,a,s,c,u,l,d,f,h;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.uuid&&t.fileToken){e.next=3;break}return console.error("[image plugin] generate uploaded attribs fail."),e.abrupt("return",null);case 3:return i=t.uuid,o=t.file,a=t.fileToken,s=URL.createObjectURL(o),e.next=7,Object(m.R)(s);case 7:return c=e.sent,u=c.naturalWidth,l=c.naturalHeight,d=Object(v.i)(a,Object(y.g)()),r&&n.height===g.e.toString()&&n.height===g.f.toString()&&(delete n.width,delete n.height,delete n.currHeight,delete n.currWidth),f=Object.assign({uuid:i,height:l.toString(),width:u.toString(),currHeight:l.toString(),currWidth:u.toString(),natrualHeight:l.toString(),natrualWidth:u.toString(),file_token:a,src:encodeURIComponent(d),image_type:o.type,size:o.size,comments:[],pluginName:b.s,scale:Object(v.m)(u,l)},n),h={items:[f]},e.abrupt("return",JSON.stringify(h));case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}}).call(this,S("2vAP"))},XNb2:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});var r=n("J4zp"),o=n.n(r),i=function(e,t){return t?a(e,function(e){return e===t}):null},a=function(e,t){if(t){var n=null,r=e.getMatchedAttributePositionOnSelection(n,t),i=o()(r,1)[0];if(i)return i.docPosition}return null},s=function(e,t){if(t){var n=null,r=function(e){return e===t};return 0<e.getMatchedAttributePositionOnSelection(n,r).length}return!1}},XVMX:function(e,b,y){"use strict";(function(i){y.d(b,"b",function(){return o}),y.d(b,"a",function(){return f}),y.d(b,"d",function(){return p}),y.d(b,"c",function(){return m});var o,e,t=y("o0o1"),a=y.n(t),n=y("yXPU"),r=y.n(n),s=y("q1tI"),c=y.n(s),u=y("n/R6"),l=0;function d(){return l+=1,"toast_".concat(Date.now(),"_").concat(l)}(e=o=o||{})[e.CONFIRMED=0]="CONFIRMED",e[e.CANCELED=1]="CANCELED";var f=8e3,h="";function p(e){return g.apply(this,arguments)}function g(){return(g=r()(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(t){h&&u.a.remove(h),h=d();var e=i("CreationDoc_FeishuDocs_Mention_Notification_Toast",n.join("".concat(i("common.separator"))));u.a.show({key:h,content:c.a.createElement("div",{className:"toast-confirm"},c.a.createElement("p",{className:"toast-text"},e),c.a.createElement("button",{className:"toast-button",onClick:function(e){u.a.remove(h),h="",t(o.CANCELED)}},i("common.undo"))),duration:f,className:"permissionToast",cancelText:i("common.undo"),onClose:function(){return t(o.CONFIRMED)}})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=r()(a.a.mark(function e(r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(t){var n=d(),e=i("permission.invite_confirm",r.join("".concat(i("common.separator"))));u.a.show({key:n,content:c.a.createElement("div",{className:"toast-confirm"},c.a.createElement("p",{className:"toast-text"},e),c.a.createElement("button",{className:"toast-button",onClick:function(e){u.a.remove(n),t(o.CONFIRMED)}},i("common.confirm"))),duration:f,className:"permissionToast",onClose:function(){return t(o.CANCELED)}})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}}).call(this,y("2vAP"))},XiKa:function(e,t,n){var r=n("hS6j"),i=n("U6jy"),o=n("AvKE"),I=n("4qD0");function S(t,n){t&&Object.keys(t).forEach(function(e){n(t[e],e)})}function j(e,t){return{}.hasOwnProperty.call(e,t)}function T(e,t){var n=[];return S(e,function(e){t(e)&&n.push(e)}),n}function w(e,a,t){var s="";function c(e,t){var n=this;this.tag=e,this.attribs=t||{},this.tagPosition=s.length,this.text="",this.updateParentNodeText=function(){m.length&&(m[m.length-1].text+=n.text)}}a?(a=i(w.defaults,a)).parser?a.parser=i(_,a.parser):a.parser=_:(a=w.defaults).parser=_;var u,l,d=a.nonTextTags||["script","style","textarea"];a.allowedAttributes&&(u={},l={},S(a.allowedAttributes,function(e,t){u[t]=[];var n=[];e.forEach(function(e){0<=e.indexOf("*")?n.push(o(e).replace(/\\\*/g,".*")):u[t].push(e)}),l[t]=new RegExp("^("+n.join("|")+")$")}));var f={};S(a.allowedClasses,function(e,t){u&&(j(u,t)||(u[t]=[]),u[t].push("class")),f[t]=e});var h,p={};S(a.transformTags,function(e,t){var n;"function"==typeof e?n=e:"string"==typeof e&&(n=w.simpleTransform(e)),"*"===t?h=n:p[t]=n});var g=0,m=[],v={},b={},y=!1,k=0,n=new r.Parser({onopentag:function(r,e){var i,t,n,o;y?k++:(i=new c(r,e),m.push(i),t=!1,n=!!i.text,j(p,r)&&(o=p[r](r,e),i.attribs=e=o.attribs,void 0!==o.text&&(i.innerText=o.text),r!==o.tagName&&(i.name=r=o.tagName,b[g]=o.tagName)),h&&(o=h(r,e),i.attribs=e=o.attribs,r!==o.tagName&&(i.name=r=o.tagName,b[g]=o.tagName)),a.allowedTags&&-1===a.allowedTags.indexOf(r)&&(t=!0,-1!==d.indexOf(r)&&(y=!0,k=1),v[g]=!0),g++,t||(s+="<"+r,u&&!j(u,r)&&!u["*"]||S(e,function(e,t){var n;if(!u||j(u,r)&&-1!==u[r].indexOf(t)||u["*"]&&-1!==u["*"].indexOf(t)||j(l,r)&&l[r].test(t)||l["*"]&&l["*"].test(t))if("href"!==t&&"src"!==t||!E(r,e)){if("srcset"===t)try{if(S(n=I.parse(e),function(e){E("srcset",e.url)&&(e.evil=!0)}),!(n=T(n,function(e){return!e.evil})).length)return void delete i.attribs[t];e=I.stringify(T(n,function(e){return!e.evil})),i.attribs[t]=e}catch(e){return void delete i.attribs[t]}"class"!==t||(e=C(e,f[r])).length?(s+=" "+t,e.length&&(s+='="'+O(e)+'"')):delete i.attribs[t]}else delete i.attribs[t];else delete i.attribs[t]}),-1!==a.selfClosing.indexOf(r)?s+=" />":(s+=">",!i.innerText||n||a.textFilter||(s+=i.innerText))))},ontext:function(e){var t,n,r;y||((t=m[m.length-1])&&(n=t.tag,e=void 0!==t.innerText?t.innerText:e),"script"===n||"style"===n?s+=e:(r=O(e),a.textFilter?s+=a.textFilter(r):s+=r),m.length&&(m[m.length-1].text+=e))},onclosetag:function(e){if(y){if(--k)return;y=!1}var t=m.pop();if(t){if(y=!1,v[--g])return delete v[g],void t.updateParentNodeText();b[g]&&(e=b[g],delete b[g]),a.exclusiveFilter&&a.exclusiveFilter(t)?s=s.substr(0,t.tagPosition):(t.updateParentNodeText(),-1===a.selfClosing.indexOf(e)&&(s+="</"+e+">"))}}},a.parser);return n.write(e),n.end(),s;function O(e){return"string"!=typeof e&&(e+=""),e.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/\>/g,"&gt;").replace(/\"/g,"&quot;")}function E(e,t){var n=(t=(t=t.replace(/[\x00-\x20]+/g,"")).replace(/<\!\-\-.*?\-\-\>/g,"")).match(/^([a-zA-Z]+)\:/);if(!n)return!!t.match(/^[\/\\]{2}/)&&!a.allowProtocolRelative;var r=n[1].toLowerCase();return j(a.allowedSchemesByTag,e)?-1===a.allowedSchemesByTag[e].indexOf(r):!a.allowedSchemes||-1===a.allowedSchemes.indexOf(r)}function C(e,t){return t?(e=e.split(/\s+/)).filter(function(e){return-1!==t.indexOf(e)}).join(" "):e}}e.exports=w;var _={decodeEntities:!0};w.defaults={allowedTags:["h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre"],allowedAttributes:{a:["href","name","target"],img:["src"]},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto"],allowedSchemesByTag:{},allowProtocolRelative:!0},w.simpleTransform=function(r,i,o){return o=void 0===o||o,i=i||{},function(e,t){if(o)for(var n in i)t[n]=i[n];else t=i;return{tagName:r,attribs:t}}}},YWjA:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u});var a=n("+Xq6"),s=n("lQZd"),c=n("HmyT"),o=n("WsN4");function r(e){e.each(function(e,t){var n,r,i=Object(c.$)(t),o=i.attr("data-src");o&&(n=Object(a.g)(o),(r=Object(a.f)({originSrc:o,fileToken:n}))&&(i.attr("src",r),i.attr("data-src",o),i.attr("data-suite",Object(a.e)({fileToken:n||"",objType:Object(s.k)(),objToken:Object(s.g)(),originSrc:o}))))})}function i(e){if(!e)return null;var t=e.src,n=Object(c.$)(document.createElement("img"));if(t){var r=Object(a.g)(t),i=Object(a.f)({originSrc:t,fileToken:r});if(i)return n.attr(o.a.DataNoRequestSrc,i),n.attr(o.a.DataSrc,t),n.attr(o.a.DataSuite,Object(a.e)({fileToken:r||"",objType:Object(s.k)(),objToken:Object(s.g)(),originSrc:t})),n[0]}}function u(){Object(a.i)()}},Yspk:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n("nN3d");function i(e,t){var n=e.getRep(t).lines.totalWidth();return e.changesetHelper.builder(n)}function o(e){return Object(r.c)(e||6)}},ZDp4:function(e,t){function n(e){if(null==e)throw new TypeError("Cannot destructure undefined")}e.exports=n},ZvLv:function(e,t,n){"use strict";var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),u=n("Nsbk"),l=n.n(u),d=n("7W2i"),f=n.n(d),h=n("q1tI"),p=n.n(h),g=n("TSYQ"),m=n.n(g),v=n("UlbS"),b=n("FI0B"),y=n("HmyT"),k=function(e){function t(){var n;return i()(this,t),(n=c()(this,l()(t).apply(this,arguments))).handleToggleRef=function(e,t){n.hideTooltip=t},n}return f()(t,e),a()(t,[{key:"render",value:function(){var t=this,e=this.props,n=e.className,r=e.tooltip,i=e.container,o=e.etherpadContainer,a=m()(n,{"hpx-button":!0}),s=["bottom"],c=[!0,"check-viewport"],u={padding:"4px 6px",pointer_events:"none"};return p.a.createElement(v.Tooltip,{title:r,placement:"bottom",tooltipClassName:"ignore-dom editor_toggle_button",adjustPlacements:s,adjustOverflow:c,getContainer:function(){return Object(y.$)(document.body).hasClass("fs-mode-non-paged")?i:o||null},style:u,onTooltipMouseEnter:function(e){setTimeout(function(){t.hideTooltip()},0)},toggleRef:this.handleToggleRef,gap:3,showDelay:500},p.a.createElement("button",{className:a,disabled:e.disabled,onClick:e.onClick,dir:"auto","data-track-title":e["track-title"]},p.a.createElement("span",{className:"dmc-button-content"},p.a.createElement("span",{className:"icon-wraper"},p.a.createElement(b.a,null)))))}}]),t}(h.PureComponent);t.a=k},a0eB:function(o,e,t){"use strict";(function(e){function t(e){for(var t=[],n=0;n<e.length;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}function n(e){var t=new Set;return e.filter(function(e){return!t.has(e)&&(t.add(e),!0)})}function r(e){var t=[];return new Set(e).forEach(function(e){t.push(e)}),t}function i(){var t=!1;return new Set([!0]).forEach(function(e){t=e}),!0===t}"Set"in e?"function"==typeof Set.prototype.forEach&&i()?o.exports=r:o.exports=n:o.exports=t}).call(this,t("yLpj"))},ad02:function(e,t,n){"use strict";n.r(t),n.d(t,"distinctUntilChanged",function(){return s});var r=n("mrSG"),i=n("FFOo"),o=n("Ehmk"),a=n("eihs");function s(t,n){return function(e){return e.lift(new c(t,n))}}var c=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.compare,this.keySelector))},e}(),u=function(i){function e(e,t,n){var r=i.call(this,e)||this;return r.keySelector=n,r.hasKey=!1,"function"==typeof t&&(r.compare=t),r}return r.__extends(e,i),e.prototype.compare=function(e,t){return e===t},e.prototype._next=function(e){var t=this.keySelector,n=e;if(t&&(n=Object(o.a)(this.keySelector)(e))===a.a)return this.destination.error(a.a.e);var r=!1;if(this.hasKey){if((r=Object(o.a)(this.compare)(this.key,n))===a.a)return this.destination.error(a.a.e)}else this.hasKey=!0;!1===Boolean(r)&&(this.key=n,this.destination.next(e))},e}(i.a)},b6qs:function(e,t,n){"use strict";var r=n("HA5h"),i={},o={init:function(e){},reset:function(){i={}},setCacheInfo:function(e){Object(r.a)(i,e)},getCacheInfo:function(e){return i[e]},getAllCacheInfo:function(){return i}};t.a=o},bCSi:function(e,t,n){"use strict";var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("a1gu"),c=n.n(s),u=n("Nsbk"),l=n.n(u),d=n("7W2i"),f=n.n(d),h=n("q1tI"),p=n.n(h),g=n("m/+l"),m=n("D7h9"),v=n("5cZX"),b=n("XMIC"),y=n("jBvr"),k=function(e){return{embedObjPermissions:Object(v.y)(e)}},O={openModal:b.c},E=Object(g.connect)(k,O)(y.a),C=function(e){function t(){return i()(this,t),c()(this,l()(t).apply(this,arguments))}return f()(t,e),a()(t,[{key:"render",value:function(){return p.a.createElement(g.Provider,{store:m.default},p.a.createElement(E,this.props))}}]),t}(h.Component);t.a=C},bVwM:function(e,t,n){"use strict";var o,r,i=n("lwsE"),a=n.n(i),s=n("W8MJ"),c=n.n(s);(r=o=o||{})["&"]="&amp;",r["<"]="&lt;",r[">"]="&gt;",r['"']="&quot;",r["'"]="&#x27;",r["`"]="&#x60;";var u=function(){function e(){a()(this,e)}return c()(e,[{key:"UNSAFE_editorNormalizePasteNode",value:function(e){var t=e.data.text.split("\n").join("<br/>");e.data.node.innerHTML=t}},{key:"acePaste",value:function(e,t){var n=t.text,r=/(?:&|<|>|\"|\'|`)/g,i=(n=r.test(n)?n.replace(r,function(e){return o[e]}):n).split("\n").join("<br/>");t.pasteDataWrapper.innerHTML=i}},{key:"aceCreateDomLine",value:function(e,t){t.attrObj.lineAttribMarker&&"*"===t.text&&(t.text=" ")}}]),e}();t.a=new u},c8Bs:function(e,t,n){"use strict";var i=n("THPu"),o=n("26kz");function r(e,r){var i=!0;return Object(o.a)(e,function(e,t,n){return i=!!r(e,t,n)}),i}var a=r,s=n("fywt"),c=n("/1FC"),u=n("XFn8");function l(e,t,n){var r=Object(c.a)(e)?i.a:a;return n&&Object(u.a)(e,t,n)&&(t=void 0),r(e,Object(s.a)(t,3))}t.a=l},chgP:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var r=n("lwsE"),i=n.n(r),o=n("YWBl"),a=n("YNKm"),s=function e(t){var r=this;i()(this,e),this.aceKeyEvent=function(e,t){var n=t.evt;return!!Object(a.hb)(n,a.T)&&(n.preventDefault(),r.editor.triggerCommand(a.T),!0)},this.editor=t.editor,this.editor.registerCommand(a.T,function(e,t){t.doUndoRedo(e),Object(o.a)({action:e})})}},dn8U:function(e,t,n){"use strict";function r(e){if("string"!=typeof e)return"";var t=e.split(" "),n="",r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value,u=/author-(\d+)/.exec(c);u&&(n=u[0])}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}n.d(t,"a",function(){return r})},efCe:function(e,g,m){"use strict";(function(i){m.d(g,"a",function(){return p});var e=m("o0o1"),o=m.n(e),t=m("yXPU"),a=m.n(t),n=m("lwsE"),s=m.n(n),r=m("W8MJ"),c=m.n(r),u=m("HIeq"),l=m("9oD+"),d=m("J21X"),f=m("oJoF"),h=m("QtEt"),p=function(){function r(e,t){var n=this;s()(this,r),this.aceInitialized=function(e){e.on(f.b,a()(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)();case 2:t=e.sent,n.uploader=n.createBoxUploader(t);case 4:case"end":return e.stop()}},e)})))},e&&this.aceInitialized(e),this.handlers=t.handlers,this.preventBeforeUnload=t.preventBeforeUnload,this.preventBeforeUnload&&(this.BeforeUnloadReminder=new d.a({unsavedTip:i("CreationDoc_Docs_Upload_Image_Decs")}))}return c()(r,[{key:"createBoxUploader",value:function(e){return e({parentToken:Object(u.e)(),mountPoint:l.a},{onTasksAdded:this.onTasksAdded.bind(this),onTaskAdded:this.onTaskAdded.bind(this),onTaskSuccess:this.onTaskSuccess.bind(this),onTaskError:this.onTaskError.bind(this),onFileProgress:this.onFileProgress.bind(this),onCancel:this.onCancel.bind(this),onCancelAll:this.onCancelAll.bind(this)})}},{key:"upload",value:function(e,t){e&&this.uploader.addFile(e,t)}},{key:"onTaskAdded",value:function(e){this.handlers.onTaskAdded(e),this.BeforeUnloadReminder.addReminder()}},{key:"onTasksAdded",value:function(e){this.uploader.upload()}},{key:"onTaskSuccess",value:function(e,t){this.handlers.onSuccess(e),this.onComplete()}},{key:"onTaskError",value:function(e,t){this.handlers.onFailure(e,t),this.onComplete()}},{key:"onFileProgress",value:function(e){this.handlers.onProgress(e)}},{key:"onCancel",value:function(e){this.onComplete()}},{key:"onCancelAll",value:function(){console.log("[image plugin] onCancelAll")}},{key:"onComplete",value:function(){this.BeforeUnloadReminder&&this.BeforeUnloadReminder.removeReminder()}},{key:"cancel",value:function(e){var t=e.uuid;t&&this.uploader.cancel(t)}},{key:"destroy",value:function(){this.uploader.cancelAll(),this.BeforeUnloadReminder&&this.BeforeUnloadReminder.destroy()}}]),r}()}).call(this,m("2vAP"))},elsr:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var r="0",i="clientside",o={LOCAL:i,PREFIX_LOCAL:"".concat(i,"-"),DEFAULT_REP_ZONE:r}},eySY:function(e,t,n){"use strict";n.d(t,"a",function(){return g}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var r=n("J4zp"),d=n.n(r),i=n("EVdn"),f=n.n(i),o=n("dKDz"),h=n.n(o),l=n("EVj1"),p=n("VIFs");function g(e,t,n){var r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],i=4<arguments.length?arguments[4]:void 0,o='class="author-'.concat(n," link-mention-holder ").concat(t,' url" style="white-space: pre;"'),a=i?m(i):[[""],[""]],s=d()(a,2),c=s[0],u=s[1],l="<span ".concat(o,">").concat(r?" ":"",'<a href="').concat(e,'">').concat(e,"</a></span>");return c.join("")+l+u.join("")}function m(e){return e.map(function(e){return e.split(/[\r\n]/).map(function(e,t){return(0<t?"<br><span>":"<span>").concat(h()(e),"</span>")})})}function a(e){var t=e.wrapper,o=e.pureUrl,a=e.holderCls,s=e.author,n=e.useSpace,r=e.filteredTextGroup,c=!1;if(!t.innerHTML)return t.innerHTML=g(o,a,s,n,r),!0;var u=h()(v(o)),l=0;return t.querySelectorAll("a").forEach(function(e){var t,n,r=h()(e.href),i=h()(e.textContent);u===r&&u===i&&(c=!0,t=0<l?"".concat(a,"-").concat(l):a,n=g(o,t,s),f()(e).replaceWith(n),l++)}),c}function v(e){return e.replace(/[^\x00-\x7F]$/g,"")}function s(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=Object(l.f)(e);if(t||(n=n.split(/https?:\/\//).pop()||""),!Object(p.isSuiteUrl)(n))return null;var r=Object(l.k)(e,!0,t),i=r.token,o=r.type,a=r.protocol,s=r.preText,c=void 0===s?"":s,u=r.restText;return i&&o?{preText:c,token:i,type:o,restText:void 0===u?"":u,protocol:a}:null}},fJND:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return r});var l=n("EVj1"),d=n("VIFs");function f(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=Object(l.f)(e);if(t||(n=n.split(/https?:\/\//).pop()||""),!Object(d.isDocUrl)(n))return null;var r=Object(l.k)(e,!0,t),i=r.token,o=r.type,a=r.protocol,s=r.preText,c=void 0===s?"":s,u=r.restText;return i&&o?{preText:c,token:i,type:o,protocol:a,restText:void 0===u?"":u}:null}function r(e,t,n){if(!e||!t)return!1;var r=f(e)||{},i=r.token,o=r.type,a=f(t)||{},s=a.token,c=a.type,u=Boolean(i&&s&&i===s);return u&&n?n===o&&n===c:u}},faYQ:function(e,t,n){},fqG5:function(e,t,n){},hJmJ:function(e,t,n){"use strict";n.d(t,"b",function(){return ee}),n.d(t,"c",function(){return te}),n.d(t,"a",function(){return re});var r,i,o=n("lSNA"),d=n.n(o),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),u=n.n(c),l=n("U+yc"),f=n.n(l),h=n("RIqP"),p=n.n(h),g=n("ukIz"),m=n("hbEN"),v=n("XhtD"),b=(n("lTlB"),n("YWBl")),y=n("7Kxq"),k=n("F9bh"),O=n("LFUy"),E=n("q1tI"),C=n.n(E),I=n("i8i4"),S=n.n(I),j=n("PCTH"),T=n("HmyT"),w=n("OX8E"),_=n("elsr"),M=n("puQj"),x=n.n(M),L=n("SGN9"),N=n("G8Hj"),R=n("UeI0"),P=n("+0ye"),D=n("SyrE"),U=n("Trbk"),F=n("2ACu"),z=n("y2sV"),B=n("Poi8"),H=n("PcuH"),W=n("182n"),V=n("YNKm"),K="DocHeading",q=_.b.PREFIX_LOCAL,Z="0",Q=[].concat(p()(W.a),["code"]),J={24:"h1",20:"h2",18:"h3"},X="heading",Y="collapse",$="heading",ee="IGNORE_HEADING",te="MAX_HEADING_LEVEL_CHANGE";function ne(e,t){return-1<e.indexOf(t)}var re=(r=Object(k.a)({ignoreAttrs:[["aceTable"]]}),i=function(){function n(e,t){var f=this;s()(this,n),this.className="Heading",this.needUpdateCollapse=!1,this.headingCount={},this.headingMaxLevel=1,this.lineNumberForPaste=-1,this.lineForPasteIsCollapse=null,this.bindEvent=function(){f.removeEvent(),Object(T.$)(f.editor.getInnerContainer()).on("mouseenter",'[class*="collapsable-section-handle"]',f.onBoarding),D.g.on("".concat(U.g,":").concat(K),f.onVCFollowHandler),f.editor&&f.editor.eventEmitter.on("lineTrackerUpdate",f.lineTrackerUpdateHandler),Object(F.default)("bind_vc_event",{module:K,operation:"on"})},this.lineTrackerUpdateHandler=function(e){var t,n;e.dirtyLines.length&&(t=e.dirtyLines[0].lineNum,n=e.dirtyLines[0].output.startOfCollapseSection,w.a.emit(U.a,{module:K,actionType:"DocHeadingToggle",data:{lineNum:t,isCollapse:n}}))},this.onBoarding=function(e){var t=Object(T.$)(e.target),n=t.hasClass("collapsable-section-handle")?t:t.closest(".collapsable-section-handle"),r="toggle-heading-btn"===n.attr("data-selector");n.length&&0===f.guideCount&&!r&&(n.attr("data-selector","toggle-heading-btn"),Object(L.b)(N.STEP_TYPES.toggle_heading_intro),f.guideCount++)},this.removeEvent=function(){Object(T.$)(f.editor.getInnerContainer()).off("mouseenter",'[class*="collapsable-section-handle"]',f.onBoarding),D.g.off("".concat(U.g,":").concat(K),f.onVCFollowHandler),f.editor&&f.editor.eventEmitter.off("lineTrackerUpdate",f.lineTrackerUpdateHandler),Object(F.default)("bind_vc_event",{module:K,operation:"off"})},this.onHeadingMaxLevel=function(e){f.headingMaxLevel=e},this.getHeadingMaxLevel=function(){return f.headingMaxLevel},this.checkCollapse=function(e){var t,n,r=e.dom,i=e.multiRange,o=e.range,a=e.zoneId,s=e.source;f.editor&&(t=o,n=a||"",r&&(t=f.editor.domToRep(r),n=t.selStart[2]),n&&t&&f.notifyCollapse({sel:[t.selStart,t.selEnd],selZone:n,source:s}),n&&i&&i.forEach(function(e){f.notifyCollapse({sel:[e.start,e.end],selZone:n,source:s})}))},this.getTargetLineHTML=function(e,t,n,r){var i=f.editor.getRep(e).lines.atIndex(t);if(!i||!i.lineNode)return"";var o=document.createRange(),a=f.editor.selection.getPointForChatAtLeafNode(i,n,!0);return r&&i.lineNode.previousSibling?(o.setStart(i.lineNode.previousSibling,0),o.setEnd(a.node,a.index),o.cloneContents().lastChild.outerHTML):!r&&i.lineNode.nextSibling?(o.setStart(a.node,a.index),o.setEnd(i.lineNode.nextSibling,0),o.cloneContents().firstChild.outerHTML):""},this.isSelectionContainsCollapsedLine=function(t,e,n){return t===_.a&&(f.editor.lineTracker.collapseLines&&Object(v.a)(e[0],n[0]+1).some(function(e){return f.checkIsLineCollapsed(t,e)}))},this.aceCutRangeReplaceSeletion=function(e,t){var n=t.range,r=t.rep;r.attributeManager.getAttributeOnLine(r.selEnd[0],"heading")&&2===n.length&&f.cutCollapseRange(n)},this.cutCollapseRange=function(e){var t=f.editor.performDocumentReplaceRangeWithAttributes,n=[e[0],0],r=e[1],i=f.editor.getRep(),o=[r,i.lines.atIndex(r).text.length];t(i.zoneId,n,o,"",[])},this.notifyCollapse=function(e){var t,n,r,i,o,a=e.sel,s=e.selZone,c=e.source,u=f.editor;u&&(t=a[0],n=a[1],r=[],o=t[0],i=n[0],s!==Z&&(o=i=u.getLineNumInRootZone(s,t)),r.push(o,i),r=p()(new Set(r)),Object(R.a)(u,Z,r,c))},this.aceDoDeleteKey=function(e,t){var n,r,i=t.editor,o=t.rep,a=t.caretLine;i.isCaret()&&(n=a(),r=o.lines.atIndex(n),o.selStart[1]===r.lineMarker||f.handleDeleteCollapse(i,o,n))},this.editorAfterDoDeleteKey=function(e,t){var n=t.editor,r=n.getRep(),i=r.selStart[0];f.handleDeleteCollapse(n,r,i)},this.handleDeleteCollapse=function(e,t,n){var r,i,o,a=e.getContentState().getActiveZone().getLine(n),s=a.getLineAttributes().toMap();s.list&&s.list.includes("code")||(r=Boolean(s.heading),a.isEmpty()||(i=Object(R.b)(s),(r||i)&&(o=Object(j.e)(n,t),f.editor.getAttributeOnLine(_.a,n,Y)&&Object(j.d)(e,o,!0,e.isEditable(),!1))))},this.aceRegisterBlockElements=function(){return Q},this.init=function(t){[V.r].concat(W.a).forEach(function(e,a){t.registerAceCommand(e,function(e,t,n,r){var i=r.source,o=f.doInsertHeading({attribKey:X,attribValue:"h".concat(a)});Object(b.a)({action:"heading-h".concat(a),op:o?y.g:y.f,source:i})},{statusKey:"heading-h".concat(a)})})},this.onVCFollowHandler=function(e){var t,n,r,i=e.actionType,o=e.data;"DocHeadingToggle"===i&&f.editor&&(t=o.lineNum,n=o.isCollapse,(r=f.editor.getRep().lines.atIndex(t))&&r.domInfo.isCollapsedHeading()!==n&&r.lineNode.querySelector(".collapsable-section-handle").click())},this.handleClick=function(t){t.data.context.ace.callWithAce(function(e){f.doInsertHeading({attribKey:X,attribValue:"h".concat(t.data.headingType+1)})},"insertheading",!0)},this.aceAttribsToClasses=function(e,t){return t.key===X?["heading:".concat(t.value)]:t.key===Y&&"true"===t.value?["".concat(Y,"-all:true")]:t.key==="".concat(q).concat(Y)&&"false"===t.value?["collapse-onlymenot:true"]:t.key==="".concat(q).concat(Y)&&"true"===t.value?["collapse-onlyme:true"]:void 0},this.willChangesetApply=function(e,t){var n=t.editor,r=t.changeset,i=[],o=n.getApool();n.changesetHelper.eachAttribNumber(r,function(e){i.push(o.getAttribKey(e))}),f.needUpdateCollapse=i.find(function(e){return e===$})},this.editorAlinesDidSplice=function(e,t){var n,r,i=t.start,o=t.deleteCount,a=t.prevState,s=t.currentState,c=t.editor,u=t.zoneId;f.needUpdateCollapse||(r=(n=c.callStack.getCurrentCallStack())&&n.type===j.a,f.needUpdateCollapse=r||f.hasKey(a.numToAttrib,Y)||f.hasKey(s.numToAttrib,Y)||f.hasKey(a.numToAttrib,$)&&!f.hasKey(s.numToAttrib,$)),c.lineTracker.splice(u,i,o,s.alinesSplice);var l,d=f.getHeadingCountChange(a,s);for(l in d)f.headingCount[l]=(f.headingCount[l]||0)+d[l];f.notifyHeadingCountChange()},this.notifyHeadingCountChange=Object(m.default)(function(){for(var e=1,t=9;1<=t;t--){var n="h".concat(t);if(f.headingCount[n]){e=t;break}}f.headingMaxLevel!==e&&f.editor&&f.editor.call(te,e),f.headingMaxLevel=e},200),this.hasKey=function(e,t){if(e)for(var n in e)if(e[n][0]===t)return!0;return!1},this.aceCreateDomLine=function(e,t){var n=t.lineClass,r=t.text,i=t.index,o=t.zoneId;f.checkIsLineCollapsed(o,i)&&!n.includes("ace-line-collapsed")&&(t.lineClass+=" ace-line-collapsed");var a=Object(P.a)(n),s=f.editor.getRep().zoneId!==Z,c=ne(n,"list-code");if(a&&!s&&f.hasCollapse&&!c){var u=t.spanClass,l=[];if(ne(n,y.b)&&(t.lineClass=t.lineClass.replace(/heading-h\d/,"")),u.replace(/(^| )collapse((-)*[a-z]{0,9}):true/g,function(e,t,n){l.push("collapse".concat(n)),u=u.replace(e,"")}),l.length)return t.spanClass="".concat(u),void(t.lineClass="".concat(t.lineClass," ").concat(l.join(" ")));u||l.length||""!==r||!1===t.collapseStatus.collapseOnlyMe&&(t.lineClass="".concat(t.lineClass," collapse-onlymenot"))}},this.acePreWriteDomLineHTML=function(e,t){var n,r,i,o,a,s,c;t.info&&(r=(n=t.info).lineClass,i=n.lineMarker,a=(o=n.zone)&&o!==Z,s=r&&Object(P.a)(r)&&!ne(r,"list-code"),c=r&&ne(r,"single-line"),!s||!(i&&1===i)||f.disCollapse||a||c||(t.isPocket=!0))},this.aceShouldPocketReuse=function(e,t){var n=t.oldLineNode,r=t.newLineEntry,i=t.type,o=n.pocket.lineEntry,a=r.domInfo.lineClass;if(!ne(a,"list-code")&&(Object(P.a)(a)&&Object(P.a)(o.domInfo.lineClass)&&f.hasCollapse))return!(o.domInfo.isCollapsedHeading()!==r.domInfo.isCollapsedHeading())&&"collapseble-header-handle"===i||void 0},this.addPocketToLine=function(e,t){var n,r,i,l=t.editor,o=t.lineEntry,a=t.linePocket,s=o.domInfo.lineClass;ne(s,"list-code")||Object(P.a)(s)&&f.hasCollapse&&o&&o.lineNode&&o.zone===Z&&(n=Object(T.$)(o.lineNode).find(".ace-line-pocket")[0],r=Object(T.$)("#editorcontainerbox")[0],i=function(e){var t,n,r,i,o,a,s,c,u=Object(T.$)(e.target).closest(".ace-line");!u.length||(t=l.domToRep(u.get(0)))&&(n=t.selStart[0],r=t.selStart[2],i=l.getContentState().getZoneState(r).getLine(n),o=Number(i.hasLineMarker()),a=i.getAttributes(0,i.length()-1).toMap(),s=Object(R.b)(a),c=Object(j.f)(t,o),Object(j.h)(l,c,s,e))},o.collapsibleSectionHandleRef||(o.collapsibleSectionHandleRef=a.put([{uniqueClass:"collapseble-header-handle",mount:function(e){S.a.render(C.a.createElement(j.b,{editor:l,line:o,container:n,etherpadContainer:r,onClick:i}),e)},unmount:function(e){S.a.unmountComponentAtNode(e)}}])))},this.findCollapsedSecetion=function(){for(var e=f.editor.getRep().lines,t=e.numNodes,n=[],r=0;r<t;r++){var i=e.atIndex(r).domInfo,o=i.collapseStatus,a=i.lineClass;Object(P.a)(a)&&!ne(a,"list-code")&&(o.collapseOnlyMe||o.collapseAll&&!1!==o.collapseOnlyMe)&&n.push(r)}return n},this.beforeFullscreenEnter=function(e,t){var n,r;1===t.mode&&(n=f.findCollapsedSecetion(),r=f.editor.getRep(),n.forEach(function(e){var t=Object(j.e)(e,r);Object(j.c)(f.editor,t,!0,f.editor.isEditable())}))},this.beforeFullscreenModeChange=this.beforeFullscreenEnter,this.changesetApply=function(e,t){var n=t.editor,r=!f.needUpdateCollapse;n.lineTracker.doUpdate(r),f.needUpdateCollapse=!1},this.doReturnKey=function(e){var t,n,r,i,o,a=f.editor,s=a.getRep();s.zoneId===Z&&(t=s.selStart[0],n=s.lines.atIndex(t),s.selStart[1]===n.lineMarker?0!==(r=t<1?0:t-1)&&Object(R.a)(a,Z,[r]):(i=0<Object(T.$)(n.lineNode).find(".collapsable-section-handle-collapsed").length,o=Object(j.e)(t,s),i&&Object(j.d)(a,o,!0,a.isEditable(),!1)))},this.updateCollapse=function(e,t,n){var c,u,l,r;e&&t&&0<t.length&&n&&(l=!(c=[]),t.length&&(t.length&&t.forEach(function(e,t){var n,r,i=f.editor.getRep(_.a).lines,o=e.lineNum,a=i.atIndex(o),s=f.editor.getContentState().getZoneState(_.a).getLine(o).getLineAttributes().toMap();a&&((n=a.lineNode)&&(u=0===t?o:u,r=e.output.renderCollapsed&&!e.output.startOfCollapseSection,c.push(o),x.a.msie?(r&&Object(T.$)(n).addClass("ace-line-collapsed"),r||Object(T.$)(n).removeClass("ace-line-collapsed")):n.classList.toggle("ace-line-collapsed",r)),e.output.startOfCollapseSection&&0===t&&(l=Object(R.b)(s)))}),(r=f.editor.plugins.sheetBridge.getBridge())&&r.syncVirtualScroll(),w.a.trigger("collapseLineChange",[{startOfCollapseSection:u,collapseRange:c,collapsed:l}])))},this.performUndoRedo=function(e,t){var n=f.editor,r=!f.needUpdateCollapse;n.lineTracker.doUpdate(r),f.needUpdateCollapse=!1},this.lineTrackerUpdate=function(e,t){var n=t.isDirtyZone,r=t.dirtyLines,i=t.root;f.updateCollapse(n,r,i)},this.aceDomLineProcessLineAttributes=function(e,t){var n,r=t.spanClass,i=/(?:^| )heading:([Hh0-9]*)/.exec(r);i&&(n=Object(g.a)(Q,i[1])),void 0!==n&&0<=n&&(t.lineClass+=" heading-".concat(i[1]),t.processedMarker=!0)},this.removeCollapse=function(e){var t,n,r,i,o,a=f.editor.getRep();a.zoneId===Z&&(n=(t=a.lines.atIndex(e)).text,r=[e,t.lineMarker],i=[e,n.length],o=[[Y,""]],a.attributeManager.setAttributesOnRange(r,i,o))},this.getHeadingType=function(e,t,n){var r=/(?:^| |Mso)[hH]eading-?(\S+)/.exec(t);if(r){var i="h".concat(r[1].replace(/[^\d]/g,""));if(W.a.includes(i))return i}if(/^h[1-9]$/.test(e))return e;var o=/font-size: (\d+)px/.exec(n);return n&&(-1<n.indexOf("font-weight: bold;")||-1<n.indexOf("font-weight: 700;"))&&o&&J[o[1]]?J[o[1]]:null},this.getCollapseType=function(e){var t=e.cls,n=/collapse-([a-z]{3,})/.exec(t);if(n)return n[0]},this.deserialize=function(e){var t=e.node,r=e.deltaSet,i=e.zoneId;if(t instanceof HTMLElement){var n=t.tagName,o=t.className,a=t.getAttribute("style")||"",s=f.getHeadingType(n.toLowerCase(),o,a),c=r,u=f.getCollapseType(o);s&&(c=Object(z.I)(r,i,d()({},X,s)));var l=function(e,t){var n=c||r;return Object(z.H)(n,i,d()({},e,t))};if(u){if("collapse-all"===u)return l(Y,"true");if("collapse-onlymenot"===u)return l("".concat(q,"collapse"),"false");if("collapse-onlyme"===u)return l("".concat(q,"collapse"),"true")}return c}return r},this.pluginReadOnly=function(){},e&&(this.hasCollapse=t&&t.hasCollapse,this.editor=e,this.nodes=new Set,this.guideCount=0,this.init(e),this.bindEvent()),this.hasCollapse&&w.a.on("invokeCollapse",this.checkCollapse)}return u()(n,[{key:"acePaste",value:function(e,t){var n=t.rep,r=n.selStart;this.lineNumberForPaste=r[0],this.lineForPasteIsCollapse="true"===n.attributeManager.getAttributeOnLine(this.lineNumberForPaste,"collapse")}},{key:"afterPaste",value:function(e,t){var n=t.rep,r=n.selStart,i=n.zoneId,o="true"===n.attributeManager.getAttributeOnLine(this.lineNumberForPaste,"collapse");(0<=this.lineNumberForPaste&&r[0]!==this.lineNumberForPaste&&o||!1===this.lineForPasteIsCollapse&&o)&&w.a.emit("invokeCollapse",{zoneId:i,range:{selStart:[this.lineNumberForPaste,0],selEnd:[this.lineNumberForPaste,0]},source:"paste"}),this.lineNumberForPaste=-1,this.lineForPasteIsCollapse=null}},{key:"reset",value:function(){this.removeEvent(),this.editor=null,w.a.off("invokeCollapse",this.checkCollapse)}},{key:"clientVars",value:function(){var e=this.editor.getMatchedAttributePositionOnSelection(null,function(e){return"heading"===e}),t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value.attrValue;this.headingCount[a]=1+(this.headingCount[a]||0)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.notifyHeadingCountChange()}},{key:"editorWillCopy",value:function(e){var t,r,n=this.editor,i=e.range,o=i.end,a=o.line,s=o.offset,c=o.zoneId,u=n.getContentState().getLineAttributes(c,a).toMap().heading,l=this.checkIsCollapsedHeading(c,a),d=n.getContentState().getZoneState(c),f={};u&&l&&s>=d.getLine(a).length()-2&&(t=d.getContent(),r=a,t.eachLine(function(e,t,n){if(a<n){if(t.heading&&t.heading>=u)return!1;r++}}),f.zoneId=c,f.line=r,f.offset=d.getLine(a).length()-1,i.end=f,e.range=i,e.deltaSet=this.editor.clipboard.slice(i))}},{key:"doInsertHeading",value:function(e){var r=this,i=e.attribKey,o=e.attribValue,a=e.range,s=e.isAllHasAttrib,t=o?o.slice(1):-1;if(!(0<=t&&void 0===Q[t])){var n=a.selStart,c=a.selEnd,u=a.attributeManager,l=a.zoneId,d=Object(v.a)(n[0],c[0]+1),f=[],h=this.editor&&Object(B.i)(this.editor,l),p=!0,g=!0;return d.forEach(function(e){var t,n=a.lines.atIndex(e);!n||!n.lineNode||-1<n.lineNode.className.indexOf(ee)||-1<n.lineNode.className.indexOf(y.b)||Object(O.a)(n.lineNode)||(h||r.editor&&Object(B.f)(r.editor,l,e)?s=p=!1:f.push(e),p&&r.editor&&(t=r.editor.getAttributeOnLine(l,e,i),p=t===o,t&&(g=!1)))}),s||p||o===V.r?o===V.r&&g||(u.removeAttributeOnMultiLines(d,i),this.hasCollapse&&d.forEach(function(e){r.removeCollapse(e)})):u.setAttributeOnMultiLinesExcludeAttrs(f,[[i,o]],[["aceTable",""]]),this.editor&&H.a.tryConvertZone(this.editor,a,i,o),s}}},{key:"serialize",value:function(e){var t,n=e.type,r=e.node,i=e.lineAttributes,o=i&&i[$];return n===z.u.LINE&&o&&((t=document.createElement(o)).appendChild(r),e.node=t),e}},{key:"pluginReadWrite",value:function(){}},{key:"alineToLineInput",value:function(e,t){if(t&&"string"==typeof t.value){var n=Object(R.c)(t.value)||{},r=n.type,i=n.indent;if("h"===r&&"number"==typeof i&&0<i&&i<=9)return i}}},{key:"checkIsLineCollapsed",value:function(e,t){if(void 0!==t){var n=this.editor.lineTracker;if(e&&e!==Z||!n||!n.collapseLines||!n.collapseLines.trackers[Z])return!1;var r=n.collapseLines.trackers[Z].entries[t].output,i=r.renderCollapsed,o=r.startOfCollapseSection;return i&&!o}}},{key:"checkIsCollapsedHeading",value:function(e,t){if(void 0!==t){var n=this.editor.lineTracker;return(!e||e===Z)&&n&&n.collapseLines&&n.collapseLines.trackers[Z]?!!n.collapseLines.trackers[Z].entries[t].output.startOfCollapseSection:!1}}},{key:"getHeadingCountChange",value:function(e,t){var n,r,i=this.getHeadingCountByState(e),o=this.getHeadingCountByState(t),a={};for(n in Object.assign({},i,o))(i[n]||o[n])&&(r=(o[n]||0)-(i[n]||0),a[n]=r);return a}},{key:"getHeadingCountByState",value:function(e){var t={},n=!0,r=!1,i=void 0;try{for(var o,a=e.alinesAttribs[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=!0,u=!1,l=void 0;try{for(var d,f=s[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value;if("heading"===h[0]){var p=h[1];t[p]=1+(t[p]||0);break}}}catch(e){u=!0,l=e}finally{try{c||null==f.return||f.return()}finally{if(u)throw l}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}},{key:"editorWillDoReturnKey",value:function(e){var t,n,r=e.delta,i=e.editor,o=i.selection.getSelection(),a=i.getContentState().getActiveZone(),s=a.getZoneId(),c=a.getLine(o.start.line),u=c.getLineAttributes().toMap(),l=o.toPosition(),d=l.start,f=l.len,h=c.isEndOfLine(o.end.offset);u.heading&&!f&&(t=c.isEmpty(),n=new z.E({zoneId:s}),r.ops.length?t||n.retain(d+1).retain(1,{heading:h?"":u.heading}):(h&&(u.heading=""),n.retain(d).insertEnter().insertLineMarker(u)),e.delta=r.compose(n))}},{key:"editorWillDoDeleteKey",value:function(e){var t,n,r,i,o,a,s=e.deltaSet,c=e.editor,u=c.selection.getSelection(),l=c.getContentState().getActiveZone(),d=l.getZoneId(),f=l.getLine(u.start.line),h=f.previousSibling(),p=f.getLineAttributes().toMap(),g=u.toPosition(),m=g.start,v=g.len,b=1===u.start.offset;h&&!v&&p.heading&&b&&(t=Number(h.hasLineMarker()),n=h.isEmpty(),r=h.getLineAttributes().toMap(),i=Object.keys(r).find(function(e){return!["author","lmkr","insertorder","lineguid","align"].includes(e)}),o=s.get(d).ops.length,i||!n||o||(a=new z.E({zoneId:d}),(t?a.retain(m-3).retain(1,Object.assign({},r,{heading:p.heading})):a.retain(m-2).insertLineMarker(Object.assign({},r,{heading:p.heading}))).delete(2),e.deltaSet=s.compose(a)))}}]),n}(),f()(i.prototype,"doInsertHeading",[r],Object.getOwnPropertyDescriptor(i.prototype,"doInsertHeading"),i.prototype),i);new re},hjf3:function(e,t,n){"use strict";var r=n("uT1x"),i=1/0;function o(e){return(null==e?0:e.length)?Object(r.a)(e,i):[]}t.a=o},i7Dq:function(e,t,n){"use strict";n.d(t,"a",function(){return k});var r=n("pVnL"),g=n.n(r),i=n("lwsE"),o=n.n(i),a=n("W8MJ"),s=n.n(a),c=n("a1gu"),u=n.n(c),l=n("Nsbk"),d=n.n(l),f=n("7W2i"),h=n.n(f),m=n("m8R6"),p=n("q1tI"),v=n.n(p),b=(n("17x9"),n("UlbS")),y=n("YO6O"),k=function(e){function r(e){var i;o()(this,r),(i=u()(this,d()(r).call(this,e))).replaceImgSrc=function(){var e,t=i.props,n=t.dataSrc,r=t.src;n&&n!==r&&((e=new Image).src=n,e.onload=function(){i.mounted&&i.setState({src:n})})};var t=e.dataSrc,n=e.src;return i.state={src:O(n)||O(t)},i}return h()(r,e),s()(r,[{key:"componentDidMount",value:function(){this.mounted=!0,this.replaceImgSrc()}},{key:"componentDidUpdate",value:function(e){this.props.dataSrc&&e.dataSrc!==this.props.dataSrc&&this.replaceImgSrc()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this.state.src,t=this.props,n=t.title,r=t.tip,i=t.tipZIndex,o=t.useBackground,a=t.className,s=t.token,c=t.popover,u=t.popoverPlacement,l=t.onVisibleChange,d=Object(m.default)(this.props,["dataSrc","src","title","tip","tipZIndex","token","popover","popoverPlacement","useBackground","onVisibleChange","popoverPlacement"]),f=n;r||(d.title=n,n="");var h={backgroundImage:'url("'.concat(e||"",'")'),backgroundSize:"cover",backgroundPosition:"center"},p=o?v.a.createElement("div",g()({className:a,role:"button",style:h},d)):v.a.createElement("img",g()({},d,{src:e}));return c&&r?v.a.createElement(y.default,{token:s,name:f,trigger:"click",hideAction:["mouseLeave"],placement:u||"b",prefixCls:"cooperater-user-popover",source:"collaborate",onVisibleChange:l},v.a.createElement("div",null,v.a.createElement(b.Tooltip,{title:n,placement:"bottom",zIndex:i},p))):c&&!r?v.a.createElement(y.default,{token:s,name:f,trigger:"click",hideAction:["mouseLeave"],placement:u||"b",prefixCls:"cooperater-user-popover",onVisibleChange:l},p):!c&&r?v.a.createElement(b.Tooltip,{title:n,placement:"bottom",zIndex:i},p):p}}]),r}(p.Component);function O(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").replace(/^http?s:/,"")}k.defaultProps={useBackground:!1},k.defaultProps={dataSrc:"",src:"",tip:!0}},j1lG:function(e,t,n){"use strict";n.d(t,"J",function(){return o}),n.d(t,"l",function(){return a}),n.d(t,"M",function(){return s}),n.d(t,"K",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"r",function(){return d}),n.d(t,"s",function(){return f}),n.d(t,"x",function(){return h}),n.d(t,"t",function(){return p}),n.d(t,"u",function(){return g}),n.d(t,"v",function(){return m}),n.d(t,"y",function(){return v}),n.d(t,"B",function(){return b}),n.d(t,"n",function(){return y}),n.d(t,"o",function(){return k}),n.d(t,"m",function(){return O}),n.d(t,"w",function(){return E}),n.d(t,"D",function(){return r}),n.d(t,"j",function(){return T}),n.d(t,"g",function(){return w}),n.d(t,"I",function(){return _}),n.d(t,"A",function(){return M}),n.d(t,"C",function(){return x}),n.d(t,"L",function(){return L}),n.d(t,"z",function(){return N}),n.d(t,"P",function(){return R}),n.d(t,"p",function(){return P}),n.d(t,"e",function(){return D}),n.d(t,"f",function(){return U}),n.d(t,"H",function(){return F}),n.d(t,"N",function(){return z}),n.d(t,"O",function(){return B}),n.d(t,"k",function(){return H}),n.d(t,"q",function(){return C}),n.d(t,"E",function(){return S}),n.d(t,"h",function(){return Z}),n.d(t,"i",function(){return Q}),n.d(t,"b",function(){return J}),n.d(t,"a",function(){return X}),n.d(t,"F",function(){return W}),n.d(t,"G",function(){return K});var r,i,o="new-gallery",a="gallery-line",s="image-uploaded",c="gallery",u="clientside-gallery",l="clientside-image-uploaded",d="image-container-wrap",f="image-draggable",h="image-loading",p="data-image-guide",g="true",m="[".concat(p,'="').concat(g,'"]'),v="image-loading-view",b=" ",y=("".concat(b,"\n"),"drop-animate-left"),k="drop-animate-right",O=220,E=6;(i=r=r||{}).Drive="Drive",i.Doc="Doc",i.External="External";var C,I,S,j,T=/\/api\/box\/stream\/download\/(?:v\d+\/)?(all|cover)\/(\w*)/,w=/\/api\/file\/f\/(\w*)/,_=20,M=2,x=0,L="",N=20971520,R="TOGGLE_IMAGE_BORDER",P=[s,c,u,l],D=120,U=120,F=16/9,z=200,B=200,H="text/gallery";(I=C=C||{}).IMAGE_SET_HIGHLIGHT="IMAGE_SET_HIGHLIGHT",I.IMAGE_UPDATE_MARK="IMAGE_UPDATE_MARK",(j=S=S||{}).Initial="Initial",j.Loading="Loading",j.Finished="Finished",j.GifPreLoading="GifPreLoading",j.GifLoading="GifLoading",j.LoadingWithPreview="LoadingWithPreview";var W,V,K,q,Z=20,Q=40,J=8,X={left:"flex-start",center:"center",right:"flex-end"};(V=W=W||{}).APanel="APanel",V.Drag="Drag",V.Paste="Paste",(q=K=K||{}).Success="Success",q.Fail="Fail"},jBvr:function(e,E,C){"use strict";(function(r){C.d(E,"a",function(){return O});var e=C("lwsE"),n=C.n(e),t=C("W8MJ"),i=C.n(t),o=C("a1gu"),a=C.n(o),s=C("Nsbk"),u=C.n(s),c=C("7W2i"),l=C.n(c),d=C("7EGn"),f=C("q1tI"),h=C.n(f),p=C("UlbS"),g=C("+/Fj"),m=(C("SFb0"),C("jp/M")),v=C("IyQe"),b=C("mRaX"),y=C("AiBH"),k=C("9g7G"),O=function(e){function t(e){var c;return n()(this,t),(c=a()(this,u()(t).call(this,e))).checkThisInEmbedPermissions=function(e){var t,n=e.embedObjPermissions,r=e.token,i=n?n.get(r):null;i&&(t=i.toJS(),c.checkShowPermissionPopup(t))},c.checkShowPermissionPopup=function(e){var t=e.ownersWithoutPerm,n=void 0===t?[]:t,r=e.ownersWithPerm,i=void 0===r?[]:r,o=e.permission,a=Object(v.embedObjPermission2Booleans)(o);c.embedObjPermission={permission:a,ownersWithoutPerm:n,ownersWithPerm:i}},c.handleOpenEmbedShareModal=function(){var e=c.props,t=e.openModal,n=e.token,r=e.title,i=e.closePopover,o=e.type,a=c.embedObjPermission,s=Object.assign({token:n,type:o,title:r},a);t(m.ui.MODAL_TYPES.EMBED_SHARE,{embedObj:s}),Object(b.L)(y.u.CLICK_EMBED_QUICK_SHARE,{from:"insert"}),i&&i()},c.isOpenInLark=Object(k.j)(),c.embedObjPermission={permission:{canInvite:!1,canPublicize:!1,canPublicizeWidely:!1},ownersWithoutPerm:[],ownersWithPerm:[]},c}return l()(t,e),i()(t,[{key:"UNSAFE_componentWillMount",value:function(){this.checkThisInEmbedPermissions(this.props)}},{key:"componentDidMount",value:function(){this.checkThisInEmbedPermissions(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.checkThisInEmbedPermissions(e)}},{key:"render",value:function(){var e=Object(d.default)(this.embedObjPermission,["permission","canInvite"],!1);if(this.isOpenInLark||!e)return null;var t=this.props.style,n="permission-prompt";return h.a.createElement("div",{style:t,className:"mention-popover comment-ignore-blur ".concat(n)},h.a.createElement("section",{className:"mention-pop-share"},h.a.createElement("div",{className:"mention-pop-share__quick-share"},h.a.createElement("div",{className:"share-notify"},h.a.createElement(g.a,{className:"permission-warning-icon"}),h.a.createElement("span",{className:"warning-text"},r("permission.embed.share_tips_2"))),h.a.createElement(p.Button,{type:"primary",onClick:this.handleOpenEmbedShareModal},r("permission.embed.share_btn")))))}}]),t}(h.a.PureComponent)}).call(this,C("2vAP"))},jSUa:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r});var r,i,o="j-block-container";(i=r=r||{}).IFRAME_BLOCK="IFRAME_BLOCK",i.REACTION_BLOCK="REACTION_BLOCK",i.SHEET_BLOCK="SHEET_BLOCK",i.BITABLE_BLOCK="BITABLE_BLOCK",i.POLL_BLOCK="POLL_BLOCK",i.REMINDER_BLOCK="REMINDER_BLOCK",i.PLACEHOLDER_BLOCK="PLACEHOLDER_BLOCK",i.JIRA_ISSUE_BLOCK="JIRA_ISSUE_BLOCK",i.JIRA_FILTER_BLOCK="JIRA_FILTER_BLOCK",i.MINDNOTE_BLOCK="MINDNOTE_BLOCK",i.MENTION_BLOCK="mentionBlock",i.JEST_BLOCK="JEST_BLOCK",i.AT_USER_BLOCK="AT_USER_BLOCK",i.FILE_CARD_BLOCK="FILE_CARD_BLOCK",i.HTML_BLOCK="HTML_BLOCK",i.CHAT_CARD_BLOCK="CHAT_CARD_BLOCK",i.READ_PROCESS_BLOCK="READ_PROCESS_BLOCK",i.APPLICATION_CONTROL_BLOCK="APPLICATION_CONTROL_BLOCK",i.ISV_BLOCK="ISV_BLOCK"},jVwk:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var b=n("7Kxq"),y=n("y2sV"),r=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=t||e,i=r.selStart,o=r.selEnd,a=n.selStart,s=n.selEnd,c=e.lines.atIndex(e.selEnd[0])||{},u=c.text,l=c.lineMarker,d=(u||"").length,f=o[1]<d,h=" ";if(!i||!o)return"\n \n";0===i[0]&&"0"===e.zoneId&&(h="\n".concat(h));var p=0;a&&s&&a[0]===s[0]&&a[0]===i[0]&&s[1]===i[1]&&(p=s[1]-a[1]);var g,m=e.repManager.editor,v=i[1]>l+p;return m.version.includes(y.y)?(g=m.getContentState().getZoneState(e.zoneId).getLine(i[0]))&&(g.getLineAttributes().every(function(e){return b.c.includes(e[0])})||(v=!0)):v=Boolean(l)||v,v&&(h="\n "),f&&(h+="\n"),"sp"===e.attributeManager.findAttributeOnLine(e.selEnd[0],"template-placeholder")&&(h="\n \n"),h}},k8MZ:function(e,t,n){"use strict";var r=n("yG8O"),i=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),u=n("U+yc"),l=n.n(u),g=(n("1ABj"),n("7EGn")),h=n("OZf9"),w=n("HmyT"),d=n("YWjA"),f=n("iP/4"),p=n("FJEn"),m=n("D7h9"),v=n("qYkn"),_=n("H6oK"),M=n("+0ye"),b=n("J4zp"),y=n.n(b);function x(e){if(!(void 0!==e.editorInfo.ace_getAttributesOnSelection().attribs.find(function(e){return"list"===y()(e,1)[0]})))return!1;var t=e.rep,n=t.selStart[0];if(n!==t.selEnd[0])return!1;var r=t.selStart[1];return t.selEnd[1]-r==t.lines.atIndex(n).text.length-1}var k,O,E,C=n("HIeq"),I=n("Ngi8"),S=n("D28M"),j=n("y2sV"),L=n("dn8U"),N=n("zTCG"),R=n("p3Wu");n.d(t,"a",function(){return V});var P=p.config.EDITOR_EVENTS,D=/doc-token-(\S+)/,T="solid ".concat("#e3e5ea"," 1px"),U={borderLeft:T,borderRight:T,borderBottom:T,borderTop:T,verticalAlign:"top"},F={border:"none",borderCollapse:"collapse"},z=["number","bullet","check","done"],B="",H=!1;function W(e,t){return e.isBlockElement(t)&&"\n"!==t.innerText}var V=(k=Object(j.J)(1e4),O=function(){function t(e){var T=this;a()(this,t),this.postAceInit=function(e,t){T.ace=t.editorInfo},this.getStyleForNode=function(m,v,b){Object(h.a)(m,function(e,t){var n,r,i,o,a,s,c,u,l,d,f,h,p,g=Object(w.$)(e);T.docToken=T.getDocToken(e),T.maybeCopyZone(g,"ace-table",!0)||T.maybeCopyZone(g,N.a.CODE_BLOCK)||((n=g.find(".pocket-ignore")).length&&n.remove(),r=t===m.length-1,T.getCommonStyle(e,r,v,b),e=T.convertIndent(e),o=Object(w.$)(e).hasClass("blockquote"),a=Object(M.b)(e),s=Object(w.$)(e).find('[class^="list-check"],[class^="list-done"]'),c=Object(w.$)(e).find('[class^="list-number"],[class^="list-bullet"]'),u=0<s.length,l=0<c.length,d=T.list(c,l),f=T.checkBox(s,u),h=d||f,o&&(p="margin: 0 0 0 22px;\n                      border-left: solid 2px ".concat(I.N600," !important;\n                      color: ").concat(I.N600,";\n                      padding-left: 12px!important;"),d?d.firstChild.innerHTML='<blockquote style="'.concat(p,'">').concat(d.firstChild.innerHTML,"</blockquote>"):(i=Object(w.$)("<blockquote></blockquote>").attr("style",T.styles+p).addClass(T.docToken),T.quoteKeepOtherClass(g,i))),h?(a&&Object(w.$)(h).addClass(a),i?(i.html(h),Object(w.$)(e).replaceWith(i)):Object(w.$)(e).replaceWith(h)):i&&(i.html(Object(w.$)(e).html()),Object(w.$)(e).replaceWith(i)))})},this.getDocToken=function(e){var t=e.classList,n=D.exec(t);if(n)return n[0]},this.aceCopy=function(e,t){if(""===t.html&&!t.text)return t;var n=Object(w.$)("<span></span>"),r=!Object(C.h)(t.html);n.html(t.html),T.wrapTextsInSingleLine(n,t);var i=n.children();0===i.length&&(H=!0),T.getStyleForNode(i,t.e.target,r),T.mergeListDom(n);var o=n.find("img");return 0<o.length&&Object(d.c)(o),Object(d.b)(),H?(H=!1,f.a.isEdge?{html:t.html,text:n.text()}:void 0):(t.html=n.html(),t.text=B.replace(/\u00A0|\u200B|\u0008/g,T.convertTextChar),B="",t)},this.wrapTextsInSingleLine=function(e,t){var n=e.children().length&&["span","b","i","u","s","a"].includes(e.children()[0].nodeName.toLowerCase()),r=0===e.children().length,i=t.e,o=t.editorInfo,a=t.rep,s=i.target,c=Object(w.$)(s).closest(".ace-line")[0];if(c&&(r||n)){for(var u,l=null,d=T.correctAtUserEventTarget(s),f=o.getLine(),h=a.lines.atIndex(f),p=a.selStart[1]===h.lineMarker&&a.selEnd[1]===h.text.length,g=x(t),l=r?(u=document.createElement(s.tagName||"span"),d&&(u.className=Object(L.a)(d.className)),u.innerHTML=t.html,Object(w.$)(u)):1===e.children().length?e.children()[0]:e.clone();d&&d!==c;){var m,v=Object(w.$)(d).parent().clone(),b=v.is("li, ol, ul"),y=v.is(".blockquote")&&p,k=b&&g,O=d.parentElement===c,E=-1<c.className.indexOf("heading-"),C=O&&(y||g||E),I=v.length&&!v.attr(_.DATA_META_BLOCK_PROPS)&&(!b||k);v.length&&!p&&O&&(m=/list-div|(list-start-number\s+)|ol-[0-9a-z]+|blockquote/gi,v[0].className=v[0].className.replace(m," ")),(C||I&&(r||n||k))&&(l=v.html(l)),d=d.parentElement}var S,j=Object(M.b)(l.get(0));!j||(S=Object(M.c)(j))<7&&(l=Object(w.$)("<h".concat(S,">")).html(l)),e.html(l)}},this.editorWillCopy=function(e){var t,n,r,i=T.editor,o=e.deltaSet,a=e.range,s=a.start,c=s.zoneId,u=s.line,l=s.offset,d=i.getContentState(),f=d.hasLineMarker(a.start)?1===l:0===l,h=d.getZoneState(a.end.zoneId).getLine(a.end.line).isEndOfLine(a.end.offset),p=a.start.line===a.end.line;p&&a.start.offset===a.end.offset||(t=p&&(f&&!h||!f),n=d.getLineAttributes(c,u).toMap(),t&&n.list&&z.some(function(e){return n.list.includes(e)})&&(n.list="",n.start="",n["ol-id"]="",n["origin-start"]="",n[R.d]=""),t&&n.blockquote&&delete n.blockquote,t&&n["text-indent"]&&delete n["text-indent"],n&&n.lmkr&&!Object(g.default)(o.get(c),"ops[0].attributes.lmkr")&&(n.lineguid="",r=new j.E({zoneId:c}).insertLineMarker(n),e.deltaSet=o.compose(r)))},i()(this,"editorWillSetClipboard",E,this),this.getListText=function(e){var t=e.querySelectorAll("[data-list]")||[];return t.length?Array.from(t).reduce(function(e,t){var n=/(number|bullet|check|done)(\d+)/.exec(t.dataset.list),r=T.getLiTextWithoutInnerIndent(t);if(n){var i="",o=n[1],a=Math.max(parseInt(n[2]),1),s="  ".repeat(a-1);switch(o){case"number":i=s+t.dataset.start+". "+r;break;case"done":i=s+"[x] "+r;break;case"check":i=s+"[ ] "+r;break;case"bullet":i=s+"- "+r}e+=i}return e},"")||e.textContent:""},this.getLiTextWithoutInnerIndent=function(e){var t=Array.from(e.childNodes);return!t[t.length-1]||"OL"!==t[t.length-1].tagName&&"UL"!==t[t.length-1].tagName||t.pop(),t.map(function(e){return e.textContent}).join("")||""},this.convertTextChar=function(e){return"​"===e||"\b"===e?"":" "===e?" ":void 0},this.getBase64Imgage=function(e){var t=e[0],n=document.createElement("canvas"),r=e.attr("src");n.width=t.naturalWidth,n.height=t.naturalHeight,n.getContext("2d").drawImage(t,0,0,n.width,n.height,0,0,n.width,n.height);var i=n.toDataURL();e.attr("src",i),e.attr("data-src",r)},this.list=function(e,t){if(t){var n=/list-(number|bullet)(\d+)/,r=/ol-id([\w]{8})/,i=e[0].className,o=e[0].parentElement.className,a=e[0].dataset.originStart,s=e[0].start,c=n.exec(i),u=r.exec(o),l=c?c[2]:null,d=c?c[1]:null,f=u?u[0]:null,h=e.children();return T.creatList(l,d,s,a,h,f)}},this.checkBox=function(e,t){if(t){var n=/list-(check|done)(\d+)/,r=e[0].className,i=n.exec(r),o=i?i[2]:null,a=i?i[1]:null,s=e[0].innerHTML;return T.creatCheckBox(o,a,s)}},this.creatCheckBox=function(e,t,n){if(!e||!t)return!1;e<1&&(e=1);for(var r,i,o=e,a=T.styles+"list-style-type: none; margin: 0;",s='<input type="checkbox"  style="margin-right: 2px;">',c='<input type="checkbox" checked  style="margin-right: 2px;">';0<e;){e--;var u=Object(w.$)("<ul></ul>").addClass("list-"+t+o).addClass(T.docToken).css("padding-left",0);if(i||(i=u).attr("style",a).css("padding-left","".concat(e,"em")),r&&Object(w.$)(r).html(u),0===e){u.append(n);var l=u.find("li");return l.css("list-style-type","none"),"check"===t?l.prepend(s):l.prepend(c),i}r=u}},this.creatList=function(e,t,n,r,i,o){if(!e||!t)return!1;e=Number(e);for(var a,s,c=T.styles+"margin: 0",u="number"===t?"ol":"ul",l=0;l<e;){l++;var d=document.createElement(u);if(d.classList.add(t+l,"ace-line"),o&&d.classList.add(o),T.docToken&&Object(w.$)(d).addClass(T.docToken),s||(s=d,Object(w.$)(s).attr("style",c)),a&&Object(w.$)(a).html(d),e===l)return Object(w.$)(d).append(i),n&&Object(w.$)(d).attr("start",n),r&&(d.dataset.originStart=r),s;a=d}},this.getLineText=function(e){var t=Object(w.$)(e).find("ol,ul"),n=0<t.length,r=e.innerText;if(n){for(var i=/list-(number|bullet|check|done)(\d+)/,o=t[0].className,a=t[0].start,s=i.exec(o),c=s?s[2]:null,u=s?s[1]:null,l="",d=0;d<c-1;d++)l+="  ";switch(u){case"number":r=l+a+". "+r;break;case"done":r=l+"[x] "+r;break;case"check":r=l+"[ ] "+r;break;case"bullet":r=l+"- "+r}}return r},this.getCommonStyle=function(e,t,n,r){var i=T.getLineText(e);B+=i,!t&&W(T.ace,e)&&(B+="\n");var o,a,s,c,u,l,d,f=e.id||e.children[0]&&e.children[0].id,h=T.getRealDomByMagicDomId(e,f);h&&(o=r?window.getComputedStyle(n,null):window.getComputedStyle(h,null)),o?(a=o.backgroundColor||"",s=o.fontSize||"",c=o.textAlign||"",u=o.fontWeight||"",l=o.color||"",d=o.lineHeight||"",T.styles="background-color: ".concat(a,";\n                      font-size: ").concat(s,";\n                      text-align: ").concat(c,";\n                      font-weight: ").concat(u,";\n                      line-height: ").concat(d,";\n                      color: ").concat(l,";"),Object(w.$)(e).attr("style",T.styles),Object(w.$)("#".concat(f),e).attr("style",T.styles)):T.styles="",Object(w.$)(e).removeClass(function(e,t){return(t.match(/(^|\s)lineguid-\S+/g)||[]).join(" ")})},this.getRealDomByMagicDomId=function(e,t){var n,r=(Object(w.$)(e).closest(".ace-editor, #innerdocbody")[0]||document).querySelector("#".concat(t));return r||(n=T.ace.getRep().lines.indexOfKey(t),r=T.ace.preRenderer.getLineNodeInPreRenderer(n)),r},this.aceCut=function(e,t){return T.aceCopy(e,t)},this.handleCopyTextFail=function(e){e.on(P.COPY_WITHOUT_PERMISSION,function(){m.default.dispatch(Object(v.a)())})},e&&(this.editor=e,this.postAceInit("",Object.assign({editorInfo:e},e)),this.handleCopyTextFail(e))}return c()(t,[{key:"quoteKeepOtherClass",value:function(e,t){var n=e.attr("class"),r=n.match(/align-\S+/),i=n.match(/heading-\S+/);r&&r[0]&&t.addClass(r[0]),i&&i[0]&&t.addClass(i[0])}},{key:"maybeCopyZone",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=e.find(".".concat(t));if(r.length||e.hasClass(t)&&(r=e),!r.length)return!1;n&&(r.css(F),r.find("td").css(U),this.docToken&&r.addClass(this.docToken));for(var i,o,a=e.find(".ace-editor"),s=0;s<a.length;++s)this.getStyleForNode(Object(w.$)(a[s].children));return n&&(!(i=e.find("span").get(0))||(o=Object(L.a)(i.className))&&r.addClass(o),e.replaceWith(r[0].outerHTML)),!0}},{key:"getListInfoFromDom",value:function(e){if(!e)return null;var t=e.className,n=/(number|bullet)(\d+)/.exec(t),r=/ol-id([\w]{8})/.exec(t);return{listType:n?n[1]:null,listNum:n?Number(n[2]):null,olId:r?r[1]:null}}},{key:"getInheritClassNameList",value:function(e){var t=[];return e.classList.forEach(function(e){0===e.indexOf("heading")&&t.push(e)}),t}},{key:"mergeListDom",value:function(e){var d=this,t=e.children(),f=null;Object(h.a)(t,function(e,t){var n=Object(w.$)(e).find("[class^=number],[class^=bullet]").last()[0]||e;if(!("TABLE"===e.tagName||0<Object(w.$)("table",e).length)&&/(number|bullet)(\d+)/.test(n.className)&&n){var r=e.getAttribute("style"),i=d.getInheritClassNameList(e);0<i.length&&Object(w.$)(n).removeClass(i),n.removeAttribute("style");var o=d.getListInfoFromDom(n),a=d.getListInfoFromDom(f);if(!a||a.olId!==o.olId){var s=Object(w.$)(n).children();return s.addClass(i),r&&s.attr("style",r),void(f=n)}for(;a.listNum>o.listNum;)if(f=f.parentElement,!(a=d.getListInfoFromDom(f)))return void(f=n);var c=a.listNum<o.listNum,u=Object(w.$)(n).children();u.addClass(i),r&&u.attr("style",r);for(var l=a.listNum;l<o.listNum;l++)u=u.parent();Object(w.$)(e).replaceWith(""),Object(w.$)(f).append(u),c&&(f=n)}else f=null})}},{key:"convertIndent",value:function(e){if(!e.classList.contains("ace-line"))return e;var t,n=0,r=0;return e.classList.contains("text-indent")&&(n=1),!e.children.length||(t=/list-indent(\d+)/.exec(e.children[0].className))&&(r=parseInt(t[1])),r&&1===e.children.length&&e.children[0]instanceof HTMLUListElement&&1===e.children[0].children.length&&e.children[0].children[0]instanceof HTMLLIElement&&(Object(w.$)(e.children[0]).css("list-style-type","none"),Object(w.$)(e.children[0].children[0]).css("list-style-type","none"),Object(w.$)(e.children[0]).css("padding-left","0"),Object(w.$)(e.children[0].children[0]).css("padding-left","0"),Object(w.$)(e.children[0]).css("vertical-align","bottom"),Object(w.$)(e.children[0].children[0]).css("vertical-align","bottom"),Object(w.$)(e.children[0]).css("margin-top","0").css("margin-bottom","0")),(n||r)&&Object(w.$)(e).css("margin-left","".concat(r+2*n,"em")),e}},{key:"correctAtUserEventTarget",value:function(e){var t=Object(S.o)(e,"mention-type_0");return t?Object(S.o)(t,"block-type-AT_USER_BLOCK"):e}}]),t}(),E=l()(O.prototype,"editorWillSetClipboard",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var n=this;return function(e){var t;e.node&&e.node.childNodes&&(t="",Array.from(e.node.childNodes).forEach(function(e){["ol","ul"].includes(e.tagName.toLowerCase())?t+=n.getListText(e):t+=e.textContent}),e.text=t)}}}),O);new V},kESg:function(e,t,n){"use strict";n.d(t,"h",function(){return h}),n.d(t,"j",function(){return p}),n.d(t,"k",function(){return a}),n.d(t,"a",function(){return v}),n.d(t,"l",function(){return g}),n.d(t,"e",function(){return b}),n.d(t,"b",function(){return y}),n.d(t,"m",function(){return k}),n.d(t,"f",function(){return O}),n.d(t,"c",function(){return E}),n.d(t,"d",function(){return C}),n.d(t,"g",function(){return I}),n.d(t,"i",function(){return S});var r,i,o,a,s,c=n("lSNA"),u=n.n(c),l=n("H6oK"),d=n("AiBH"),f=n("YNKm"),h=10,p=8;(s=a=a||{}).ZoneId="zoneId",s.ZoneType="zoneType";var g,m,v="aceTable";(m=g=g||{}).Table="table",m.CodeBlock="codeBlock",m.CalloutBlock="calloutBlock",m.Default="default";var b={SPAN:"zone-plugin-region",ACE_LINE:"zone-plugin-ace-line",SELECTED:"zone-selected",SCROLL_CONTAINER:"zone-scroll-container"},y=[g.CodeBlock,g.CalloutBlock],k='<div class="ace-zone-loading-container"><div class="ace-zone-loading"><div class="ace-zone-loader"><svg class="circular" viewBox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4" stroke-miterlimit="10"></circle></svg></div></div></div>',O={ALL_ZONE_DID_RENDER:"ALL_ZONE_DID_RENDER"},E=(r={},u()(r,g.CodeBlock,[l.BlockType.AT_USER_BLOCK,l.BlockType.REMINDER_BLOCK,l.BlockType.EQUATION_BLOCK]),u()(r,g.CalloutBlock,[l.BlockType.AT_USER_BLOCK,l.BlockType.REMINDER_BLOCK,l.BlockType.EQUATION_BLOCK]),r),C=(i={},u()(i,g.CodeBlock,{blocks:Object.values(l.BlockType).filter(function(e){return!E[g.CodeBlock].includes(e)}),attribs:["list","heading","blockquote","image-uploaded","gallery","clientside-gallery","image-previewer","horizontal-line",d.h,a.ZoneType]}),u()(i,g.CalloutBlock,{blocks:Object.values(l.BlockType).filter(function(e){return!E[g.CalloutBlock].includes(e)}),attribs:["image-uploaded","gallery","clientside-gallery","image-previewer","horizontal-line",d.h,a.ZoneType]}),i),I=(o={},u()(o,g.CodeBlock,[f.Q,f.c,f.a,f.d,f.b,f.F,f.h,f.I,f.K,f.L,f.V,f.g,f.f,f.e,f.C,f.o,f.N]),u()(o,g.CalloutBlock,[f.Q,f.F,f.K,f.L,f.V,f.g,f.f,f.e,f.C,f.o,f.N]),o),S={ZONE_DID_MOUNT:"zone_did_mount"}},kHJC:function(e,t,n){},kaax:function(e,t,n){"use strict";var r=n("7EGn"),i=n("VIFs");function o(e,t){if(t instanceof RegExp){if(!t.global)throw new TypeError("matchAll called with a non-global RegExp argument: ".concat(t))}else t=new RegExp(e,"g");t.lastIndex=0;for(var n=null,r=t.exec(e);null!==r;)n?n.push(r):n=[r],r=t.exec(e);return n}var a=n("toa8"),s="pano/api/BatchGetMentionEntitiesByUrl",c=function(){var e=Object(i.isStagingEnv)()?"oa.feishu-staging.cn":"oa.feishu.cn",t=Object(r.default)(window,"globalConfig.common.domain.pano",e);return"https://".concat(t,"/").concat(s)};function u(e){return a.d.post(c(),e,{headers:{"Content-Type":"application/json"},withCredentials:!0})}var l,d,f,h,p=/https?:\/\/(?=\S*\/client\/pano\/tag\-view\/open)\S+/gi,g=function(e){var t=o(e,p);return t?t.map(function(e){return e[0]}):null},m=function(e){return u({userId:window.User.id,tenantId:window.User.tenantId,urls:e})};(d=l=l||{})[d.Click=1]="Click",(h=f=f||{})[h.None=0]="None",h[h.Redirect=1]="Redirect",n.d(t,"b",function(){return g}),n.d(t,"c",function(){return m})},kooH:function(e,t,n){},lAOT:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s});var r=n("vYB2"),i=n.n(r),o=i.a.CancelToken,a=i.a.isCancel,s=i.a.Cancel},lTlB:function(e,t,n){},m9Pg:function(e,t,n){"use strict";var r=n("o0o1"),y=n.n(r),i=n("yXPU"),o=n.n(i),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),u=n.n(c),k=n("j1lG"),l=n("efCe"),d=n("2ACu"),f=n("1dfU"),h=n("NbI8"),p=function(e){return Object(d.default)(h.e,e)},g=function(e){var t=Object.assign({},e,{uuid:Object(f.a)(e.uuid)});Object(d.default)(h.f,t)},m=function(e){var t=Object.assign({},e,{uuid:Object(f.a)(e.uuid),file_token:e.file_token?Object(f.a)(e.file_token):null,upload_error_msg:JSON.stringify(e.upload_error_msg)});Object(d.default)(h.d,t)},v=function(e){var t,n;return"string"==typeof e?t=e.length:(t=e.size,n=e.type),{file_size:t,mime_type:n}},O=n("XJJA"),b=n("J4zp"),E=n.n(b),C=n("lSNA"),I=n.n(C),S=n("y2sV"),j=n("Tqb2"),T=n("vEhQ");function w(e,t){var n=Object(j.U)(e).items;return n.forEach(function(e){_(t,e)}),JSON.stringify({items:n})}function _(e,t){var n,r,i,o,a=+t.natrualHeight/+t.natrualWidth;return a>k.H&&((r=(n=e.getDocBody())&&n.dataset&&n.dataset.lastWidth)&&(i=Math.floor(+r/3).toString(),o=(Math.floor(+r/3)*a).toString(),Object.assign(t,{height:o,width:i}))),t}function M(e,t){return x.apply(this,arguments)}function x(){return(x=o()(y.a.mark(function e(t,n){var r,i,o,a,s,c,u,l;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.b)(t.uuid,t.file);case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return");case 5:i=w(r,n),o=n.selection.getSelection(),a=o.toPosition(),s=a.start,c=a.zoneId,u=a.len,(l=new S.E({zoneId:c})).retain(s),o.isCollapsed()||l.delete(u),(Object(j.P)(o,n)||Object(j.Q)(o))&&l.insertEnter(),l.insert(k.B,I()({},k.c,i)).insertEnter(),n.getContentState().apply(l);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(e,t){return N.apply(this,arguments)}function N(){return(N=o()(y.a.mark(function e(t,n){var r,i,o,a,s,c,u,l;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.progress,i=t.uuid,o=Object(j.A)(i,n)){e.next=4;break}return e.abrupt("return");case 4:if(a=o.start,s=o.end,c=o.attributes,u=P(c,r)){e.next=8;break}return e.abrupt("return");case 8:c[k.c]=u,l=n.getContentState(),n.inCallStackIfNecessary("upload-image-update-progress",function(){l.setAttributes({start:a,end:s},c,{nonundoable:!0,preventScrolling:!0})});case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function R(e,t,n){var r,i,o,a,s,c,u=Object(j.A)(e,n);u&&(r=u.start,i=u.end,a=(o=u.attributes)[k.c],(s=Object(j.U)(a))&&(Object(T.a)(s,"items[0].uuid",t),o[k.c]=JSON.stringify(s),c=n.getContentState(),n.inCallStackIfNecessary("upload-insert-image-uuid",function(){c.setAttributes({start:r,end:i},o,{nonundoable:!0,preventScrolling:!0})})))}function P(e,t){var n=e[k.c],r=Object(j.U)(n);if(r)return Object(T.a)(r,"items[0].uploadProgress",t),JSON.stringify(r)}function D(e,t,n,r){return U.apply(this,arguments)}function U(){return(U=o()(y.a.mark(function e(t,n,r,i){var o,a,s,c,u,l,d,f,h,p,g,m,v,b;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.mergeUndoStack,a=t.uuid,s=Object(j.A)(a,n)){e.next=5;break}return e.abrupt("return");case 5:return c=s.attributes,u=Object(j.W)(c),l=E()(u,1),d=l[0],f={width:d.width,height:d.height,currWidth:d.width,currHeight:d.height},e.next=10,Object(O.a)(t,f,i);case 10:if(h=e.sent){e.next=13;break}return e.abrupt("return");case 13:if(s=Object(j.A)(a,n)){e.next=16;break}return e.abrupt("return");case 16:p=s.start,g=s.end,m=w(h,n),v=n.getContentState(),c[k.K]=m,delete c[k.c],b=o?{mergeEvent:"uploadImage-success"}:{},n.inCallStackIfNecessary("upload-image-success",function(){v.setAttributes({start:p,end:g},c,{preventScrolling:!0})},b);case 23:case"end":return e.stop()}},e)}))).apply(this,arguments)}function F(e,t){var n,r,i,o=e.uuid,a=Object(j.A)(o,t);a&&(n=a.start,r=a.end,i=t.getContentState(),t.inCallStackIfNecessary("upload-image-fail",function(){i.replaceText({start:n,end:r},k.L,{},{nonundoable:!0,preventScrolling:!0})}))}var z=function(){function t(e){s()(this,t),this.editor=e,this.insertViewTasks=[]}function e(){return n.apply(this,arguments)}var n;return u()(t,[{key:"executeNextTask",value:(n=o()(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0<this.insertViewTasks.length)return e.prev=1,e.next=4,M(this.insertViewTasks[0],this.editor);e.next=8;break;case 4:return e.prev=4,this.insertViewTasks.shift(),this.executeNextTask(),e.finish(4);case 8:case"end":return e.stop()}},e,this,[[1,,4,8]])})),e)},{key:"addTask",value:function(e){this.insertViewTasks.push(e),1===this.insertViewTasks.length&&this.executeNextTask()}},{key:"clear",value:function(){this.insertViewTasks=[]}}]),t}(),B=n("+4eN"),H=function(){function r(e){var t=this,n=e.editor;s()(this,r),this.taskInfoMap=new Map,this.onUploadSuccessCallback=null,this.setOnUploadSuccessCallback=function(e){t.onUploadSuccessCallback=e},this.editor=n,this.uploader=new l.a(n,{preventBeforeUnload:!0,handlers:{onFailure:this.onUploadFailure.bind(this),onSuccess:this.onUploadSuccess.bind(this),onProgress:this.onUpdateUploadProgress.bind(this),onTaskAdded:this.onTaskAdded.bind(this)}}),this.insertViewTaskQueue=new z(n)}function e(e){return t.apply(this,arguments)}var t,n;function i(e){return n.apply(this,arguments)}return u()(r,[{key:"upload",value:(n=o()(y.a.mark(function e(t){var n,r,i,o,a,s,c,u,l,d;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.resource,r=t.event,i=t.source,o=t.continuously,a=t.insertedUuid,Object(O.e)(Object(B.m)(this.editor.getRep()))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Object(O.c)(n);case 5:if(s=e.sent,c=v(n),u=c.file_size,l=c.mime_type,d={file_size:u,mime_type:l,source:i},s){e.next=13;break}return console.warn("[doc image uploader] upload wrong type;"),d.error_case=h.b.EXEC_URL_TO_FILE_FAIL,p(d),e.abrupt("return");case 13:if(Object(O.d)(s)){e.next=18;break}return Object(O.g)(),d.error_case=h.b.OVER_FILE_SIZE_LIMIMT,p(d),e.abrupt("return");case 18:p(d),this.setTaskInfo(s,{source:i,mergeUndoStack:!!o,insertedUuid:a,noNeedInsert:!!a,startTime:performance.now()}),this.uploader.upload(s,r);case 21:case"end":return e.stop()}},e,this)})),i)},{key:"onTaskAdded",value:function(e){var t=e.uuid,n=e.size,r=e.type,i=e.file,o=this.getTaskInfo(i),a=o.source,s=o.noNeedInsert,c=o.insertedUuid;g({uuid:t,file_size:n,mime_type:r,source:a}),this.setTaskInfo(i,{task:e}),s?R(c,t,this.editor):this.insertViewTaskQueue.addTask(e)}},{key:"onUploadSuccess",value:function(e){var t=e.uuid,n=e.fileToken,r=e.size,i=e.type,o=e.file,a=this.getTaskInfo(o),s=a.source,c=a.mergeUndoStack,u=a.startTime,l=a.noNeedInsert;m({uuid:t,file_token:n,file_size:r,mime_type:i,source:s,upload_status:k.G.Success,cost_time:performance.now()-u}),D(e,this.editor,{mergeUndoStack:c},l),this.onUploadSuccessCallback&&this.onUploadSuccessCallback({uuid:t})}},{key:"onUploadFailure",value:function(e,t){var n=e.uuid,r=e.fileToken,i=e.size,o=e.type,a=e.file,s=this.getTaskInfo(a),c=s.source,u=s.startTime;m({uuid:n,file_token:r,file_size:i,mime_type:o,source:c,upload_status:k.G.Fail,upload_error_msg:t,cost_time:performance.now()-u}),Object(O.f)(),F(e,this.editor)}},{key:"onUpdateUploadProgress",value:(t=o()(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:L(t,this.editor);case 1:case"end":return e.stop()}},e,this)})),e)},{key:"cancel",value:function(t){var e=Array.from(this.taskInfoMap.values()).find(function(e){return e.task.uuid===t});e&&e.task&&e.task.isUploading&&this.uploader.cancel(e.task)}},{key:"setTaskInfo",value:function(e,t){var n=this.taskInfoMap.get(e);this.taskInfoMap.set(e,Object.assign({},n,t))}},{key:"getTaskInfo",value:function(e){return this.taskInfoMap.get(e)}},{key:"destroy",value:function(){this.taskInfoMap.clear(),this.uploader.destroy(),this.insertViewTaskQueue.clear()}}]),r}();t.a=H},mRaX:function(e,Ke,qe){"use strict";(function(b){qe.d(Ke,"k",function(){return R}),qe.d(Ke,"X",function(){return P}),qe.d(Ke,"H",function(){return D}),qe.d(Ke,"Z",function(){return U}),qe.d(Ke,"m",function(){return F}),qe.d(Ke,"d",function(){return Y}),qe.d(Ke,"I",function(){return z}),qe.d(Ke,"v",function(){return B}),qe.d(Ke,"w",function(){return H}),qe.d(Ke,"j",function(){return W}),qe.d(Ke,"y",function(){return V}),qe.d(Ke,"Q",function(){return K}),qe.d(Ke,"l",function(){return q}),qe.d(Ke,"x",function(){return ee}),qe.d(Ke,"t",function(){return te}),qe.d(Ke,"R",function(){return ne}),qe.d(Ke,"h",function(){return ie}),qe.d(Ke,"K",function(){return oe}),qe.d(Ke,"b",function(){return se}),qe.d(Ke,"A",function(){return ce}),qe.d(Ke,"F",function(){return ue}),qe.d(Ke,"p",function(){return le}),qe.d(Ke,"V",function(){return de}),qe.d(Ke,"W",function(){return fe}),qe.d(Ke,"i",function(){return pe}),qe.d(Ke,"G",function(){return ge}),qe.d(Ke,"n",function(){return ve}),qe.d(Ke,"M",function(){return be}),qe.d(Ke,"g",function(){return ke}),qe.d(Ke,"q",function(){return Oe}),qe.d(Ke,"r",function(){return Ee}),qe.d(Ke,"u",function(){return Ce}),qe.d(Ke,"J",function(){return Ie}),qe.d(Ke,"U",function(){return Te}),qe.d(Ke,"E",function(){return Ae}),qe.d(Ke,"T",function(){return we}),qe.d(Ke,"O",function(){return Me}),qe.d(Ke,"B",function(){return xe}),qe.d(Ke,"Y",function(){return Le}),qe.d(Ke,"S",function(){return Ne}),qe.d(Ke,"s",function(){return Re}),qe.d(Ke,"c",function(){return Pe}),qe.d(Ke,"f",function(){return De}),qe.d(Ke,"N",function(){return Ue}),qe.d(Ke,"e",function(){return Fe}),qe.d(Ke,"o",function(){return ze}),qe.d(Ke,"P",function(){return Be}),qe.d(Ke,"L",function(){return He}),qe.d(Ke,"a",function(){return We}),qe.d(Ke,"z",function(){return Ve});var e=qe("lSNA"),i=qe.n(e),t=qe("RIqP"),u=qe.n(t),n=qe("J4zp"),l=qe.n(n),r=qe("hjf3"),Z=qe("HmyT"),o=(qe("D7h9"),qe("7EGn")),a=(qe("jp/M"),qe("G8Hj"),qe("nN3d")),Q=qe("HA5h"),f=(qe("Z0Cl"),qe("AiBH")),y=qe("PyL4"),s=qe("TSYQ"),k=qe.n(s),c=qe("nHtH"),J=qe("iP/4"),d=qe("kUgE"),h=(qe("n3ZB"),qe("m1/u"),qe("yaX4"),qe("1dfU")),p=qe("2ACu"),g=qe("FnDM"),m=qe("JznU"),v=qe("Xngx"),O=qe("QM+C"),E=qe("lQZd"),C=qe("3xnr"),I=qe("APdQ"),S=qe.n(I),j=qe("D28M"),T=qe("7Kxq"),w=qe("rbSl"),_=qe("duSr"),M=qe("y2sV"),X=qe("vE74"),x=qe("I4N/");qe.d(Ke,"C",function(){return x.a}),qe.d(Ke,"D",function(){return x.b});var L="data-contentcollector-ignore-space-at",N="inline-block-placeholder",R=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:16,r=document.createElement("span"),i="";e.forEach(function(e){return i+=e}),r.innerHTML=i,r.style.cssText+="visibility: hidden; position: absolute; top: -9999em; font-size: ".concat(n,"px"),document.body.appendChild(r);var o=r.offsetWidth+t;return document.body.removeChild(r),o},P=function(e){var t=new RegExp("&amp;","g");return e.replace(t,"&")},D=function(e){var t={};return Object(r.a)(e).filter(Boolean).forEach(function(e){t[e]?++t[e]:t[e]=1}),t},U=function(n,r){var i=[];return Object.keys(n).forEach(function(e){var t={};r[e]||(t[e]=n[e]),r[e]&&r[e]<n[e]&&(t[e]=n[e]-r[e]),t[e]&&i.push(t)}),i};function F(n){return function(e){var o=new Array(n.length),t=e.numSet,a=e.tokensMap;if(0===t.length)return o;var s=new RegExp("[*](".concat(t.join("|"),")[*+]"),"g");return n.forEach(function(e,t){for(var n;null!==(n=s.exec(e));){var r=a[n[1]],i=o[t];i?i.push(r):o[t]=[r]}}),o}}var Y={horizontalAlign:"left",boxWidth:Object(_.b)()?360:540,boxMaxHeight:417,boxMinHeight:Object(_.a)()?152:350};function z(e){var t=/mention-token_(?=.*[a-z])[a-z0-9]+$/gi;if(!e)return[];var n,r={},i=[];for(n in e){var o,a=l()(e[n],2),s=a[0],c=a[1];s&&c&&t.test(s)&&(r[(o=parseInt(n,10)).toString(36)]=s.split("_")[1],i=[].concat(u()(i),[o.toString(36)]))}return{tokensMap:r,numSet:i}}function B(e,t){if(e){var n=Object(Z.$)(e),r=Object.assign({},Y,{},t,{lineHeight:Number.parseInt(getComputedStyle(n.get(0))["line-height"]),getFallbackBoxContainer:function(){return n.closest(".innerdocbody").parent().get(0)}}),i=r.mouseY,o=r.zoom,a=void 0===o?1:o,s=V(n.get(0),i,a);if(s)return H(s,r)}}function H(e,t){var n=(t=Object(Q.a)({},Y,t)).horizontalAlign,r=t.boxWidth,i=void 0===r?Y.boxWidth:r,o=t.boxMaxHeight,a=t.boxMinHeight,s=t.upFirst,c=void 0!==s&&s,u=t.coverNavBar,l=void 0!==u&&u,d=t.flatDom,f=void 0!==d&&d,h=t.closeContainerBottom,p=void 0!==h&&h,g=t.gap,m=void 0===g?0:g,v=t.bottomGap,b=void 0===v?0:v,y=t.getFallbackBoxContainer,k=t.$boxContainer,O=void 0===k?Object(Z.$)(".doc-position"):k;O.length||(O=Object(Z.$)(y()));var E,C,I,S,j="left"===n,T="center"===n,w=O.offset(),_=O.outerHeight(),M=Object(Z.$)(".navigation-bar-wrapper").height()||0;S=window.bestPracticeToken?(E=document.querySelector(".create-by-template__editor.etherpad-container-wrapper"),C=getComputedStyle(E),I=parseInt(C.width,10),parseInt(C.height,10)):(I=window.innerWidth,window.innerHeight);var x,L=e.top,N=e.left,R=e.height,P=e.width,D=w.top,U=w.left,F=S-L-R-b,z=l?L:L-M,B=I-Object(X.e)()-N-(T?P/2:P)-m;j?(x=N+P-U+m,B<i&&(x-=i+P+2*m),x=Math.max(x,-U)):T&&(x=N+P/2-i/2-U,B<i/2&&(x-=i/2-B)),x=Math.max(x,-U);var H,W,V=t.lineHeight||18,K=f?L-D:L+V-D,q=J.a.isIPad?window.scrollY:0;return c?(H=-L+D+_-q,K=void 0,z<o&&o<F&&(H=void 0,K=L+V-D)):(o<z&&F<o&&(H=-L+D+_-q,K=void 0),F<o&&p&&(H=10,K=void 0)),F<o&&z<o&&(a<z&&F<z?(H=-L+D+_-q,W=z,K=void 0):W=Math.max(F-10,a)),o===a&&(W=o),{left:x,bottom:!isNaN(H)&&T?H+m:H,top:!isNaN(K)&&T?K+m:K,height:W}}function W(e,t){var n,r,i=t.gap,o=void 0===i?0:i,a=t.$boxContainer,s=void 0===a?Object(Z.$)(".doc-position"):a,c=t.coverNavBar,u=s.offset(),l=s.outerHeight(),d=window.innerHeight,f=Object(Z.$)(".navigation-bar-wrapper").height(),h=e.top,p=e.left,g=e.height,m=e.width,v=u.top;return d-h-g<h-(c?f:0)?r=-h+v+l+o:n=h-v+g+o,{top:n,left:p-u.left+m/2,bottom:r}}function V(e,t,n){if(!e.getClientRects)return Object(m.a)(e.getBoundingClientRect(),n);var r=e.getClientRects();if(1===r.length)return Object(m.a)(r[0],n);if(!t)return Object(m.a)(r[r.length-1],n);for(var i=0;i<r.length;i++){var o=Object(m.a)(r[i],n),a=o.top,s=o.top+o.height;if(a-3<=t&&t<=s+3)return o}}function K(e){return e.getAttribute(L)}function q(){var e=ce().focusNode;if(!e)return null;var t=e.parentNode,n=e;return 3===e.nodeType&&t&&(n=t),K(n)||n.hasAttribute(M.g)||n.hasAttribute(M.C)?n:null}function $(e,t,n){var r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],i=[],o=ce();if(e)for(e.get(0)instanceof HTMLElement||(e=e.parent());e.length&&!/magicdomid/.test(e.attr("id"));){var a=e.text(),s=0===t&&"next"===n;if(e.hasClass("mention")&&(s||0!==t))return e;if("prev"===n){var c=0===t&&Me(o);if((e.prev().hasClass("mention")||e.prev().hasClass(C.a)||e.prev().hasClass(N)||e.prev().find("."+N).length)&&(c||!r)){i=e.prev();break}}else{var u=t===a.length||1===t&&" "===a.slice(-1);if((e.next().hasClass("mention")||e.next().hasClass(C.a)||e.next().hasClass(N)||e.next().find("."+N).length)&&(u||!r)){i=e.next();break}}e=e.parent()}return i}function ee(e){var t=ce(),n=[],r=t.baseNode,i=t.baseOffset,o=t.focusNode,a=t.focusOffset,s=q(),c=o,u=a;s&&(c=s,u=0);var l,d=$(Object(Z.$)(c),u,"prev",e);return!_e(t)||(l=$(Object(Z.$)(r),i,"prev",e)).length&&n.push(l.get(0)),d.length&&n.push(d.get(0)),n.length&&n.sort(function(e,t){return e.compareDocumentPosition(t)===f.k.PREV?-1:1}),Object(Z.$)(n)}function te(e){var t=ce(),n=t.focusNode,r=t.focusOffset,i=q(),o=n,a=r;return i&&(o=i,a=1),$(Object(Z.$)(o),a,"next",e)}function ne(e){var t=Object(Z.$)(e).parents("span");return!(!t.length||t.text()!==Object(Z.$)(e).text()||!/mention-type/.test(t.attr("class")))}var re=0;function ie(){return re++,Object(a.c)(12)+"-"+re}function oe(e,t){var n=new RegExp(t+"_([^\\s]+)");return Object(o.default)(e.match(n),"[1]")||""}var ae=[f.E.USER,f.E.FILE,f.E.FOLDER,f.E.SHEET,f.E.SHEET_DOC,f.E.BITABLE].map(function(e){return{attr:"mention-type_".concat(e),value:"true"}});function se(e,t){var n,r,i,o,a,s,c,u,l,d,f,h,p=t.documentAttributeManager,g=t.newRep;e.selection.isCaret(g)||(n=g.selStart,r=g.selEnd,i=g.selFocusAtStart,a=r,s=!1,c=ae,u=(o=n)[0]===r[0],l=n[0],p.getAttributesPoints(c,l,l+1).forEach(function(e){var t=e.selStart,n=e.selEnd;t[1]<o[1]&&n[1]>o[1]&&(o=t,s=!0);var r=n[1]>a[1]&&t[1]<a[1];u&&r&&(a=n,s=!0)}),u||(d=r[0],p.getAttributesPoints(c,d,d+1).forEach(function(e){var t=e.selStart,n=e.selEnd;n[1]>a[1]&&t[1]<a[1]&&(a=n,s=!0)})),s&&(g.selStart=o,g.selEnd=a,h=(f=o!==n)&&a!==r?i:!!f,g.selFocusAtStart=h))}function ce(){return window.getSelection?window.getSelection():{}}function ue(e){var t=e.left,n=e.top,r=e.bottom,i={left:t,height:e.height};return void 0!==r?i.bottom=r:i.top=n,i}function le(){return f.f.joined}function de(){var e='<div class="mention-chat-ct layout-column layout-main-center flex">\n    <div class="'.concat("mention-chat-tit",'" >').concat(Object(y.escapeHTML)(b("anonymous.lark_group_card_default_name")),"</div>\n  </div>");return'<div class="layout-row layout-cross-center mention-chat ignore-collect hold-when-replace" contenteditable="false"\n    '.concat(J.a.isEdge?'tabindex="-1"':"",'>\n        <span class="mention-chat-icon">\n          <img src="').concat(S.a,'" />\n        </span>\n        ').concat(e,"\n    </div>").replace(/>[\n\s]+</g,"><")}function fe(){var e,t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=n.url,i=void 0===r?"":r,o=n.buttonText,a=void 0===o?"":o,s=n.content,c=void 0===s?b("anonymous.lark_group_card_default_name"):s,u=n.desc,l=void 0===u?"":u,d=n.joinConfirm,f=n.chatId,h=n.notAllowedJoin,p="",g="mention-chat-tit",m="",v="";return p=d?'<div class="layout-row mention-chat-button-opt layout-cross-center" ><button\n      class="button-cancel">'.concat(b("common.cancel"),'</button><button\n      class="button-confirm">').concat(b("common.confirm"),"</button></div>"):(e=a===le(),t=k()("mention-chat-button no-ace-listen",{"js-open-lark":e,"open-lark":e}),'<div data-id="'.concat(Object(y.escapeHTMLAttribute)(f),'" class="').concat(t,'" onclick="(function handleOpenLark(e){\n      if (').concat(!e,") return;\n      if (").concat(J.a.isIE,") return;\n      e.stopPropagation();\n      var openLarkEvent = document.createEvent('Event');\n      openLarkEvent.initEvent('openLark',true,true);\n      dispatchEvent(openLarkEvent);\n    }).apply(this, arguments)\">").concat(a,"</div>")),l&&(g+=" mt12",m='<div class="mention-chat-desc">'.concat(Object(y.escapeHTML)(l),"</div>")),v=h?'<div class="mention-chat-ct layout-column layout-main-center flex">\n    <div class="'.concat(g,'" >').concat(b("mention.chat_notallowed_join"),"</div></div>"):'<div class="mention-chat-ct layout-column layout-main-center flex">\n    <div class="'.concat(g,'" >').concat(Object(y.escapeHTML)(c),"</div>\n    ").concat(m,"\n    </div>\n    ").concat(p),'<div class="layout-row layout-cross-center mention-chat ignore-collect hold-when-replace" contenteditable="false"\n    '.concat(J.a.isEdge?'tabindex="-1"':"",'>\n        <span class="mention-chat-icon">\n          <img src="').concat(Object(y.escapeHTMLAttribute)(ye(i)),'" />\n        </span>\n        ').concat(v,"\n    </div>").replace(/>[\n\s]+</g,"><")}var he="";function pe(e){he=he||getComputedStyle(document.body)["font-family"];var t=Object(Z.$)("<p>".concat(Object(y.escapeHTML)(e),"</p>"));t.css({fontSize:14,fontFamily:he,lineHeight:"20px",width:204,position:"absolute",left:-1e4,"word-break":"break-all"}),Object(Z.$)("body").append(t);var n=t.height();return t.remove(),n}function ge(e){if(!e)return"";var t=e.type,n=e.desc,r=e.edit_time,i=me(e),o=f.E.CHAT;return[f.E.SHEET,f.E.FILE,f.E.BITABLE,f.E.BOX,f.E.MINDNOTE,f.E.SLIDE].includes(t)&&(i=b("mention.last_update2",Object(c.a)(r))),t===o&&(i=n||b("mention.no_desc_tips")),i}function me(e){var t=e.department,n=e.i18n_department,r=e.i18n_tenant,i=e.is_external,o=Object(d.formatLanguageToLowerCase)(Object(d.getLocale)()),a=i?r:n;return a&&a[o]||t||""}function ve(){for(var e=arguments.length,t=0,n="";t<e;)n+=t<0||arguments.length<=t?void 0:arguments[t],t!==e-1&&(n+=","),t++;return n}var be=function(){return/comment-(local-)?id-[\S]+/.test(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")};function ye(e){return e&&e.replace(/^https?:/,"")}function ke(e){if(!e)return"";var t=e.replace(/image_size=\d+x\d+/,"image_size=640x540");return t===e?t.replace(/~([^\\.]+)/,"~cs_640x540"):t}function Oe(e,t){for(var n=t.numToAttrib,r={},i=0,o=e.length;i<o;i++){var a=n[parseInt(e[i],36)]||[],s=/mention-token|mention-type|mention-link|mention-notify|mention-sharePermHeldBack|mention-icon/.exec(a[0]);s&&(r[s[0]]=a[0].split("_")[1]||a[1])}return r}function Ee(r){return r?Object.keys(r).reduce(function(e,t){var n=/mention-token|mention-type|mention-link|mention-notify|mention-sharePermHeldBack|mention-icon/.exec(t);return n&&(e[n[0]]=t.split("_")[1]||r[t]),e},{}):{}}function Ce(){return Object(E.g)()}function Ie(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r="en-US"===Object(d.getLocale)()?"en_name":"cn_name";return n&&(r=r.replace("_n","N")),t[e]&&(t[e][r]||t[e].name||t[e].cn_name||t[e].en_name||"")}function Se(){var e,t,n=ce(),r=n.focusOffset,i=n.focusNode,o=n.extentNode,a=n.extentOffset;return i||o?(t=o?(e=a,o.nodeValue||""):(e=r,i.nodeValue||""),{sel:n,offset:e,nodeValue:t}):{sel:n,offset:null,nodeValue:null}}function je(e){var t=Se(),n=t.sel,r=t.offset,i=t.nodeValue;return(null!==r||null!==i)&&((J.a.isIE||"Caret"===n.type)&&e(i,r))}function Te(e){return je(function(e,t){return"@"===e[t-1]})}function Ae(){var e=Se(),t=e.offset,n=e.nodeValue;if(null===t&&null===n)return null;for(var r=null,i=t-1;0<=i;i--)if("@"===n[i]){r=i;break}return null===r?null:n.substring(r,t)}function we(){return je(function(e,t){var n=0<=t-2?e[t-2]:"";return/^[a-zA-Z0-9]$/.test(n)})}function _e(e){return J.a.isIE?e&&0<e.toString().length:e&&"Range"===e.type}function Me(e){return J.a.isIE?e&&0===e.toString().length:e&&"Caret"===e.type}function xe(e){var t=Object(g.f)(),n=e.parents(".comment-list-item"),r=e.parents(".comment-textarea__input"),i=n.length||r.length,o={};return i&&(o.isWhole=0<e.parents(".global-comment").length),o.source="doc"===t?i?f.z.DOC_COMMENT:f.z.DOC:i?f.z.SHEET_COMMENT:f.z.SHEET,o}function Le(e,t,n,r){Object(p.default)("show_hover_card",{source:e||"sheet",chat_btn_status:t?"true":"false",mention_type:n,mention_obj_id:Object(h.a)(r)})}function Ne(e){var t=e.status,n=e.source,r=e.type,i=e.token,o=e.reason,a=e.cost_time;Object(p.default)("doc_hover_shortcut",{source:n||"unkown",status:String(t),mention_type:r,mention_obj_id:Object(h.a)(i),reason:o||"",cost_time:a})}function Re(e){return{1:"recent_view_user",2:"recent_mention_user",3:"lark_search_user"}[e]}var Pe=String.fromCharCode(8203);function De(e){var t=new RegExp(Pe,"g");return e.replace(t,"")}function Ue(e){return 0===De(e).length}function Fe(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split(" "),r={};return e.forEach(function(e){var t,n=e.match(/mention-([a-zA-Z]+)_(.+)/);n&&(t=n[1],r[t]=n[2])}),r}function ze(e,t){var n,r=e===O.NUM_SUITE_TYPE.FILE?Object(v.e)(t):"";return k()((n={"m-mention-box__item_icon":!0},i()(n,"m-mention-box__item_icon_".concat(e),!0),i()(n,"m-mention-box__item_icon_box_".concat(r),e===O.NUM_SUITE_TYPE.FILE),n))}function Be(e){var t=e.selection.currentSelection,n=t.start,r=t.end;if(n.line!==r.line||n.col!==r.col)return!1;var i=e.getCurrentLineEntry();return 0===e.getTextAndAttrsOnSelection({selStart:[n.line,0],selEnd:[n.line,i.text.length],selZone:i.zone}).reduce(function(e,t){return e+t.text},"").trim().length}function He(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Object(p.default)(e,t)}function We(e){var t="new-mention-ui";Object(j.f)(e,t)||Object(j.a)(e,t)}function Ve(e,t){return Object(w.a)({editor:e,attrib:["".concat(T.a).concat(t),!0],checkSelLineFirst:!0})}}).call(this,qe("2vAP"))},mWyS:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return u});var r=n("j1lG"),i=n("Pozx");function o(e){return r.j.test(e)}function a(e){return r.g.test(e)}function s(e){var t=r.j.exec(e);return t&&t[2]}function c(e){var t=r.g.exec(e);return t&&t[1]}function u(e){switch(Object(i.a)(e)){case r.D.Doc:return c(e);case r.D.Drive:return s(e);case r.D.External:default:return null}}},mbpr:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=n("2ACu"),c=function(){function e(){i()(this,e),this.timeRecoder={},this.log={},this.notSendLog=!1}return a()(e,[{key:"setNotSendLog",value:function(e){this.notSendLog=e}},{key:"logStartTime",value:function(e){this.timeRecoder[e]=performance.now()}},{key:"logEndTime",value:function(e){this.log[e]=Math.round(performance.now()-this.timeRecoder[e])}},{key:"logValue",value:function(e,t){this.log[e]=t}},{key:"getLogValue",value:function(e){return this.log[e]}},{key:"getLog",value:function(){return this.log}},{key:"mergeLog",value:function(e){this.log=Object.assign({},this.log,{},e)}},{key:"sendLog",value:function(e,t){this.notSendLog||Object(s.default)(e,Object.assign({},t,{},this.log))}},{key:"clear",value:function(){this.timeRecoder={},this.log={}}}]),e}()},n6KG:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAn8AAAFECAIAAADZec9fAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAxVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgSW1hZ2VSZWFkeSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBNjg3MTczNEE4QjgxMUU5OTdFM0Q4NTIxRkZEQUY4QiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBNjg3MTczNUE4QjgxMUU5OTdFM0Q4NTIxRkZEQUY4QiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE2ODcxNzMyQThCODExRTk5N0UzRDg1MjFGRkRBRjhCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE2ODcxNzMzQThCODExRTk5N0UzRDg1MjFGRkRBRjhCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+F9jXuwAACoFJREFUeNrs3Qlz02YCgGFkybdDgC5toSkQ6DXb3c529///hp3Zme22hRa6LPeV044lWdqPMsNAkmIF7Ph6HjqeRnEy9udRXn+SLEVlWZ4BAE5RzRAAgPoCgPoCAOoLAOoLAKgvAKgvAKC+AKC+AKC+AID6AoD6AgDqCwDqCwCoLwCoLwCoLwCgvgCgvgCA+gKA+gIA6gsA6gsA6gsAqC8AqC8AoL4AoL4AgPoCgPoCAOoLAOoLAOoLAKgvAKgvAKC+AKC+AID6AoD6AoD6AgDqCwDqCwCoLwCoLwCgvgCgvgCgvgCA+gKA+gIA6gsA6gsAqC8AqC8AoL4AoL4AoL4AgPoCgPoCAOoLAOoLAKgvAKgvAKgvAKC+AKC+AID6AoD6AgDqCwDqCwDqCwCoLwCoLwCgvgCgvgCA+gKA+gKA+gIA6gsA6gsAqC8AqC8AoL4AoL4AgPoCgPoCgPoCAOoLAOoLAKgvAKgvAKC+AKC+AKC+AID6AoD6AgDqCwDqCwCoLwCoLwCoLwCgvgCgvgDAhCSGAN5Pno+yPCtGRVGWxcubcn4eW/S7Wi0K/5J6+JeEL71kMEcr6Vz9yYD5F1aZg+EwTbMFWndCeuM4brea4dYrCOoLCyZ0N5R3cdeaer0eGlyr2eUE6gsLMuXd7w/yPF/4dT6Kup12ktjrBOoL860oir39frhdktU+ilqtZrPR8MrCrNgABeNnvcuU3lfPaDA4OBgOvbigvjCn9vuDZUrvayG/AgzqC3OZqOFwCfb1CjCoLyyMsiyHw3TJ314IMKgvzNvEdxUOSxRgUF+YI2marcr7DAEG9YV5kOejlfo8ngDDafKJezhellea+NZqtXarlSTxzE+kvLW98+EBDretZtOrD+oLs1GMxn/KKKR3rddbpusXCDCcDlue4Q/qW2Gzc5j1Lt+lg2yCBvWF2dW3whk2kmQ5LxkkwKC+MBtVDrla4ovmCjCoLyDAoL7AYmq3WgIM6gucqmazIcCgvoAAg/oCAizAoL6AAIP6AgIMqC8gwKC+gAAD6gsIMKgvIMCgvgACDOoLnNiHX/JBgEF9gROuzLXxq/NoNBJgUF9gcitzhblvmmZmwKC+wMREFea+aZbl46a/AgzqC1RVT+Kx9ynLst8fTC/AwzT1QoD6wgpJknqVA6+Kotjf7w8GB1PaB5znudcCxq+whgCWQyhvEsdZhfiFGXCYpE5jnhp+cyj7Wq9b5RAwMPcFlkGj2Zj5YwgBHhzYAQzqCyujnrw084eRZdmowq5lUF9gSbRbzXl4GKa/oL6wQuI4bjZnH+Aw9y3L0ssB6gsrNP2t12e8/TmkN3PwM6gvrJROpxMmwbN9DHmmvqC+sEqiM2d6ve5sZ8BFWXghQH1h5QLc7XRmuA+4KOz3BfWFldRuNdd63Zl8DMlRV/AOznUFC+DF1vbW9u7u7t4wTX8/lWNUryeNRmP9bO/8ufWza713/Gwcx71uJ8vzdJjmp3gosvrCO0TWEDjW1vbO2PuE8E07YPcePHrw8PFw+K6zQna7nSsblz+6cK7CLzyT5y+vc1QWRVG+upniX4Bpjw+oL6jvhO3t92/eur3fH1S8/8cXP/ri+tVTO8HyPLw7gcVlyzPMo+2d3R9+vHWi8zU+fvJscDD865+/rtUiAwhzzlFXMHfCrPeHH2++x6mSd3f3bv5y2wCC+gInUxTlzzdvj0bv+WHZJ0+fP3u+ZRhhztnyDPPl/oNH/cEx+3p73c7lS590u51Ws1GWZwYHB3t7+3fvPUjT7NA9/3v3XpUjsAD1BV4qy/L+w0eHFkZR9OWNax9f/OjNhWu9bvgvLLz5y52nz168+a39/mBnd+/dH0MCZsuWZ5gjL7a2j85lj6b3tTiOw3cbjfrR32MwQX2BSrZ3dg8t6XU7f5Te1wH+/LNLR37PnsEE9QUq2dndP7Tk8qVPxv5Ut9s5tCRNU4MJ6gtUEr99rowois6fWx/7U51269CSzNX9QH2BijavbrxOaZIk1699XuUqgUfPb+UcdjDnHPMMc6Tb7fz9b3856U9leT62x4C5LzBJW1uHT7ncajYMC6gvMC2jorh3/9HRObSRAfUFpqIoiv/8dOvoubHe/SElYObs94VF1R8c/PjTL0fT22631s+uGR9QX2DCnjx9fuvX3469DtKVjcvGB9QXmKSyLH+9c/fBw8fHfvezy59e/NMFowTqC0zSTzd/PXRZhdcunD+3eXXDEIH6ApP0863bf5TeTz+5eGPziiEC9QUmKXT38ZNnR5fHcRy66zhnUF9gwoqivH3n7tHl3W7nmy+vt4+c6hlQX+BDbW3vDI9cuejC+fVvvrrhvJKgvsBUPH+xdXjW22l/89UXtVpkcGDheMsMi2F37/Clfzc+uyS9oL7AFCVx/OaXURSdO3fWsID6AlO0ee3z9puX/t28Uk/sOYKFfT9tCGAh9Lqdf5z80r+AuS8AoL4AoL4AsArs94XFkKbZ7d/+t72zG/5//eza5tWNRqNuWEB9gSmm95//+neW5a++fPL02db29vfffSvAsKBseYYFEGa9r9P7SvgyLDQyoL7AtLza4FxlIaC+AID6wmJaP7tWcSGgvsBkbF7dqNffOkYyfBkWGhlYUI55hgXQaNS//+5bnzgC9QVOO8Bff7lpHGA52PIMAOoLAOoLAKgvAKgvAKC+AKC+AID6AoD6AoD6AgDqCwDqCwCoLwCoLwCgvgCgvjC/oigae5+yLFdzcKo88SoDCOoLvL1u1MavHXk+Ws3BqfLEqwwgqC/w9rpRYeo2ODhYwdlveMrhiU9kAEF9gbfXjXj82lEUxe7eXpblK7IJOjzN8GTDUw5PfCIDCCsrMQRwrHpSHw7TKgHe7/cN17EDaBDA3BdO+M40iR039N7C0IUBNA6gvnBijYbZm6ED9YXT1Wo2TX/fb+Ibhs44gPrCe1ak2WwYh5MKg+ZdC6gvfND0N0kcnHgCYbhMfEF94UN1O20njqj6B6VWC8NlHEB94UNFUdTrdgS4SnrDQNnmDJX+sKzsiWrhRMKast8f5HluKI6VJEmY9UovqC9M3sEwSK01h7YNNJsN+3pBfWG6k+DQ4DTNrDuhu41G3eeyQH3h9OT5KMuzYlQUZVm8vFn+VSlUthaE27hWT+rOZgXqCwALw2GcAKC+AKC+AID6AoD6AgDqCwDqCwCoLwCoLwCoLwCgvgCgvgCA+gKA+gIA6gsA6gsA6gsAqC8AqC8AoL4AoL4AgPoCgPoCgPoCAOoLAOoLAKgvAKgvAKC+AKC+AID6AoD6AoD6AgDqCwDqCwCoLwCoLwCgvgCgvgCgvgCA+gKA+gIA6gsA6gsAqC8AqC8AqC8AoL4AoL4AgPoCgPoCAOoLAOoLAKgvAKgvAKgvAKC+AKC+AID6AoD6AgDqCwDqCwDqCwCoLwCoLwCgvgCgvgCA+gKA+gKA+gIA6gsA6gsAqC8AqC8AoL4AoL4AoL4AgPoCgPoCAOoLAOoLAKgvAKgvAKC+AKC+AKC+AID6AoD6AgDqCwDqCwCoLwCoLwCoLwCgvgCgvgCA+gKA+gIA6gsA6gsA6gsAqC8AqC8AMCn/F2AAGJdT04NaH+8AAAAASUVORK5CYII="},nMtL:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return p});var r,i,o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),u=n("U+yc"),l=n.n(u),h=n("y2sV"),d=9,f="0",p=(r=Object(h.J)(200),i=function(){function t(e){var l=this;a()(this,t),this.aceKeyEvent=function(e,t){var n=t.evt,r=l.editor,i=r.performSelectionChange,o=r.doIndentOutdent,a=r.doTabKey,s=n.keyCode;if("keydown"!==n.type||s!==d||n.metaKey||n.ctrlKey)return!1;l.editor.fastIncorp();var c,u=l.editor.getRep();return u&&u.zoneId===f&&u.selStart&&0<u.selStart.length&&0===u.selStart[0]&&1<u.lines.length()?(c=[1,u.lines.atIndex(1).lineMarker],u.selEnd&&0<u.selEnd.length&&0!==u.selEnd[0]?o(u.zoneId,n,c,u.selEnd):i(u.zoneId,c,c)):a(n),n.preventDefault(),!0},this.doIndent=function(e){l.editor.inCallStackIfNecessary("fastIncorp",function(){l.editor.fastIncorp()}),l.editor.doTabKey({shiftKey:e,stopImmediatePropagation:function(){}})};var n=this;this.editor=e.editor,this.editor.registerCommand("indentleft",function(e,t){n.doIndent(!0)}),this.editor.registerCommand("indentright",function(e,t){n.doIndent()})}return c()(t,[{key:"editorWillDoReturnKey",value:function(e){var t,n,r=e.delta,i=e.editor,o=i.getContentState().getActiveZone(),a=o.getZoneId(),s=i.selection.getSelection(),c=o.getLine(s.start.line),u=c.getLineAttributes().toMap(),l=s.toPosition(),d=l.start,f=l.len;u["text-indent"]&&!f&&(t=c.isEmpty(),n=new h.E({zoneId:a}),u["text-indent"]="",t?r.ops.length||n.retain(d-1).retain(1,u):r.ops.length?n.retain(d+1).retain(1,u):n.retain(d).insertEnter().insertLineMarker(u),e.delta=r.compose(n))}},{key:"editorWillDoDeleteKey",value:function(e){var t,n=e.deltaSet,r=e.editor,i=r.getContentState().getActiveZone(),o=i.getZoneId(),a=r.selection.getSelection(),s=i.getLine(a.start.line).getLineAttributes().toMap(),c=1===a.start.offset,u=a.toPosition(),l=u.start,d=u.len;!n.get(o).ops.length&&s["text-indent"]&&c&&!d&&(s["text-indent"]="",t=new h.E({zoneId:o}).retain(l-1).retain(1,s),e.deltaSet=n.compose(t))}}]),t}(),l()(i.prototype,"editorWillDoDeleteKey",[r],Object.getOwnPropertyDescriptor(i.prototype,"editorWillDoDeleteKey"),i.prototype),i)},nQY9:function(e,t,n){"use strict";var r=n("o0o1"),m=n.n(r),i=n("yXPU"),a=n.n(i),o=n("lwsE"),s=n.n(o),c=n("W8MJ"),u=n.n(c),l=n("2ACu");function v(t){return new Promise(function(e){return window.setTimeout(e,t)})}var b=n("XVMX"),y=n("AvAw"),k=n("t5Ac"),d=n("HIeq"),f=n("5u9u"),O=n("lZ5r");n.d(t,"a",function(){return g});var h,p,E=100;(p=h=h||{}).permise="permise",p.external="external";var g=function(){function o(e){var t=e.editor,n=e.boxType,r=e.fileType,i=e.fileToken;s()(this,o),this.editor=t,this.boxType=n,this.isDocBody="doc"===n,this.currentUserId=Object(d.d)(),this.fileType=r,this.fileToken=i}function e(e,t){return n.apply(this,arguments)}var n,t;function r(e){return t.apply(this,arguments)}return u()(o,[{key:"addMentionNotify",value:(t=a()(m.a.mark(function e(t){var n,r,i,o,a,s,c,u,l,d,f,h,p,g;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.userId,r=t.userName,i=t.isExternal,o=t.blockId,a=t.notNotify,s=t.blockNotify,this.isDocBody){e.next=3;break}return e.abrupt("return");case 3:if(n===this.currentUserId)return e.abrupt("return");e.next=5;break;case 5:if(a)return e.abrupt("return",Object(O.b)({notNotifyUsers:[{name:r,id:n}]}));e.next=9;break;case 9:if(s)return e.abrupt("return",Object(O.b)({blockedUsers:[{name:r,id:n}]}));e.next=11;break;case 11:if(c="user",u=this.editor,l=Object(k.a)(),d=l.externalAccess,f=Object(k.b)(),h=this.getToastType(i,d,f),p=this.getConfirmToast(h,r)){e.next=19;break}return e.abrupt("return");case 19:return y.default.register(n,p,b.a),e.next=22,v(E);case 22:return e.next=24,Promise.race([p,v(b.a)]);case 24:if(g=e.sent,b.b.CANCELED===g)return this.handleHoldBack({editor:u,collaborateType:c,blockId:o}),e.abrupt("return");e.next=28;break;case 28:return e.next=30,v(500);case 30:this.addDocBodyNotify(n,o);case 31:case"end":return e.stop()}},e,this)})),r)},{key:"getToastType",value:function(e,t,n){return e&&!t&&n?h.external:h.permise}},{key:"getConfirmToast",value:function(e,t){var n=(e===h.external?Object(b.c):Object(b.d))([t]);return n}},{key:"addMentionIdToBlock",value:function(r,i,o){var a=".block-id-".concat(r),e=function(){var e,t,n;o&&$(a).length&&(e=i.code,t=i.data.mention_id,e||void 0===t||(n=o.plugins.blockPlugin.blockInfos.get(r))&&n.instance&&n.instance.setProps({data:{mentionId:t}}))};o&&o.getInInternationalComposition()?o.call("asyncNotifyCallback",e):e()}},{key:"addDocBodyNotify",value:(n=a()(m.a.mark(function e(t,n){var r,i,o,a,s,c;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.fileType,i=this.fileToken,o=this.currentUserId,a=this.boxType,s=".block-id-".concat(n),$(s).length)return e.next=6,Object(f.a)(o,{fileType:r,fileToken:i,userId:t,source:a});e.next=9;break;case 6:(c=e.sent).data&&Object(O.b)({notNotifyUsers:c.data.not_notify_users,blockedUsers:c.data.blocked_users}),this.addMentionIdToBlock(n,c,this.editor);case 9:case"end":return e.stop()}},e,this)})),e)},{key:"handleHoldBack",value:function(e){var t=e.editor,n=e.collaborateType,r=e.blockId,i=t.plugins.blockPlugin.blockInfos.get(r),o=t.getRep(),a=o.selEnd,s=o.zoneId;i&&i.instance&&(i.instance.setProps({data:{sharePermHeldBack:!0}}),a&&(t.selection.setWithSelection(s,a,a,!0),t.selection.internalUpdateSelectionFromRep(!0)));var c=this.boxType;Object(l.default)("click_undo_permission",{collaborate_type:n,reminder_type:"toast",source:c})}}]),o}()},nVH4:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return a});var r={RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,ESC:27,BACKSPACE:8,AT:50,A:65,DELETE:46,H:72},i={UP:r.UP,DOWN:r.DOWN,LEFT:r.LEFT,RIGHT:r.RIGHT},o={IMAGE:"POPUP_IMAGE",CARD:"POPUP_CARD",TEXT:"POPUP_TEXT",SHEET:"POPUP_SHEET",BLOCK:"POPUP_BLOCK",TABLE:"POPUP_TABLE",TABLE_CELL:"POPUP_TABLE_CELL",CODE_BLOCK_V2:"CODE_BLOCK_V2",CALLOUT_BLOCK:"CALLOUT_BLOCK"},a="fake-list-number-trigger"},ntxC:function(e,t,n){"use strict";var a=n("FUmc"),s=n("cSlR"),c=Array.prototype.splice;function r(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i,o=t[n];n!=r&&o===i||(i=o,Object(s.a)(o)?c.call(e,o,1):Object(a.a)(e,o))}return e}t.a=r},oJoF:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o});var r="DOC_TIMING_AFTER_FIRST_SCREEN",i="DOC_TIMING_ON_DOC_STAGE_DONE",o="DOC_TIMING_ON_DOC_STAGE_DONE_AND_EDITABLE"},ouE1:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return k});var r=n("RIqP"),g=n.n(r),i=n("lwsE"),o=n.n(i),a=n("W8MJ"),s=n.n(a),m=n("HmyT"),c=n("FJEn"),v=n("mRaX"),b=n("PX10"),y=(n("NdYY"),"mention-placeholder"),k="".concat(c.config.LOCAL,"-").concat(y),O="data-placeholder",u=function(){function e(){o()(this,e),this.enable=!1,this.textWidthMap=Object.create(null)}return s()(e,[{key:"setEnable",value:function(e){this.enable=e}},{key:"getEnable",value:function(){return this.enable}},{key:"show",value:function(e,t){var n={cursor_position:"middle",show_placeholder:0};if(!this.enable)return n;var r=e.getSelectedRep();if(!r||!r.selEnd)return n;var i=r.zoneId,o=r.lines,a=r.selEnd,s=a[0],c=0<a[1]?a[1]:1,u=o.atIndex(s);if(!u)return n;var l=u.width-1===c;if(n.cursor_position=l?"end":0===c?"beginning":"middle",n.show_placeholder=1,!this.checkHasEnoughWidth(e,t)||!l)return n.show_placeholder=0,this.hide(!1),n;var d,f,h,p=Object(m.$)(".".concat(y));return p.length?e.getObserver().withoutRecordingMutations(function(){return p.attr(O,t)}):(f=(d=e.getAttributesOnSelection(i,r).attribs)&&d.find(function(e){return e[0]===k}),h=u&&"@"===u.text[1<=c?c-1:0],f||Object(b.e)(e,[s,c-1],[s,c],h?u.text[c-1]:v.c,[].concat(g()(this.filterAttr(d)),[[k,!0]]))),n}},{key:"hide",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=Object(m.$)(".".concat(y));t.removeAttr(O),e&&t.removeClass(y)}},{key:"checkHasEnoughWidth",value:function(e,t){var n=e.getSelectedRep();if(!n)return!1;var r=n.zoneId,i=n.selEnd,o=n.lines;if(!i)return!1;var a,s,c,u=i[0],l=0<i[1]?i[1]:1,d=o.atIndex(u),f=e.getAllAttributesOnLine(r,u),h=f.find(function(e){return"align"===e[0]}),p=h&&1<h.length?h[1]:"left";return!(!d||!d.lineNode||"right"===p)&&(c=!!f.find(function(e){return"list"===e[0]})?(a=Object(m.$)(".".concat(y))[0],s=Object(m.$)(d.lineNode).find("li")[0]||Object(m.$)(d.lineNode).find("code")[0],a&&s?s.getBoundingClientRect().right-a.getBoundingClientRect().right:d.lineNode.offsetWidth-d.getCharRect(l).left):d.lineNode.offsetWidth-d.getCharRect(l).left,"center"===p&&(c/=2),c>this.getTextWidth(t,d))}},{key:"getTextWidth",value:function(e,t){var n=parseFloat(Object(m.$)(t.lineNode).css("font-size"));return this.textWidthMap[e]||(this.textWidthMap[e]=Object.create(null)),this.textWidthMap[e][n]||(this.textWidthMap[e][n]=Object(v.k)([e],1,n)),this.textWidthMap[e][n]}},{key:"filterAttr",value:function(e){return e.filter(function(e){return["backcolor","bold","inline-code","italic","underline","strikethrough","author","at-holder","lineguid"].includes(e[0])||Object(v.M)(e[0])||e[0].includes("at-uuid_")})}}]),e}();t.c=new u},p3Wu:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return d});var r,i,o=n("FJEn"),a=/(?:^| )ol-id([0-9a-zA-Z]+)/,s=/^[0-9a-zA-Z]+$/,c="IGNORE_LIST",u=/(number)([0-9]+)/;(i=r=r||{})[i.UP=0]="UP",i[i.DOWN=1]="DOWN";var l="temp-li",d=(o.DisplayType.Inline,"todo_uuid")},pIdd:function(e,_,M){"use strict";(function(c){var u,e=M("o0o1"),l=M.n(e),t=M("yXPU"),n=M.n(t),a=M("OZf9"),r=M("Z0Cl"),d=M("HA5h"),f=M("9g7G"),h=M("HmyT"),p=M("AiBH"),g=M("mRaX"),s=M("zLXu"),i=M("b6qs"),m=M("VI6H"),o=".mention-chat-button-opt .button-cancel,.mention-chat-button-opt .button-confirm",v={init:function(e){i.a.init(e);var t=(u=e.editor).getDocBody();e.pure||(Object(h.$)(t).on("click",".mention-chat-button",y),Object(h.$)(t).on("click",o,C)),this.source=e.source},reset:function(){i.a.reset();var e=u.getDocBody();Object(h.$)(e).off("click",".mention-chat-button",y),Object(h.$)(e).off("click",o,C),u=null},update:function(e,t){var n=j(t);Object(s.a)(e,n,this.source,T)},updateWithNodes:function(n,e){var r,i=this,t=b(e),o=[];Object(a.a)(t,function(e){var t=Object(g.K)(e,"mention-chatId");t&&""!==t&&o.push(t)}),o.length&&(r=[],Object(a.a)(o,function(e){var t=i.getCacheInfo(e);if(!t)return r.push(e);T(n,e,t)}),0<r.length&&Object(s.a)(n,r,this.source,T))},setCacheInfo:function(e){var t=Object(r.a)(e,function(e){return e.type===p.E.CHAT}),n={};Object(a.a)(t,function(e){n[e.token]=Object.assign({},e),n[e.token].hasjoin=!0}),i.a.setCacheInfo(n)},getCacheInfo:function(e){return i.a.getCacheInfo(e)}};function b(e){for(var t=Object(h.$)(e).find(".mention"),n=[],r=0,i=t.length;r<i;r++)n.push(t.eq(r).prop("className"));return n}function y(e){var t=Object(h.$)(this),n=t.parents(".mention");if(t.text()===p.f.unjoined){var r=Object(d.a)({},S(n),{hasjoin:!1,joinConfirm:!0});return w(n,Object(g.W)(r)),!1}}function k(e){var t=e.match(/(^| )author-([^\s]+)/);return t=t?t[2]:""}function O(e,t,n){return E.apply(this,arguments)}function E(){return(E=n()(l.a.mark(function e(t,n,r){var i,o,a,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=16;break}if(t===p.n)throw new Error("Error chat token");e.next=4;break;case 4:return e.next=6,Object(f.c)(t);case 6:if(o=e.sent,o.data[t].chat_share_status!==p.g.ACTIVE)return u&&u.call("alert",{message:c("mention.chat_expired")}),e.abrupt("return",!1);e.next=11;break;case 11:return e.next=13,Object(f.l)(t);case 13:i=e.sent,e.next=19;break;case 16:return e.next=18,Object(f.k)({chatId:n,invitor:r});case 18:i=e.sent;case 19:if(a=i.data.code)return s=p.s[a]||c("etherpad.join_group_failed"),u&&u.call("alert",{message:s}),e.abrupt("return",!1);e.next=24;break;case 24:e.next=30;break;case 26:return e.prev=26,e.t0=e.catch(0),u&&u.call("alert",{message:c("etherpad.join_group_failed")}),e.abrupt("return",!1);case 30:return e.abrupt("return",!0);case 31:case"end":return e.stop()}},e,null,[[0,26]])}))).apply(this,arguments)}function C(e){return I.apply(this,arguments)}function I(){return(I=n()(l.a.mark(function e(t){var n,r,i,o,a,s,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(h.$)(t.currentTarget).parents(".mention"),r=S(n),i=n.prop("className"),o=Object(g.K)(i,"mention-chatId"),a=Object(g.K)(i,"mention-chatToken"),s=k(i),Object(h.$)(t.currentTarget).hasClass("button-confirm"))return e.next=9,O(a,o,s);e.next=17;break;case 9:if(e.sent){e.next=12;break}return e.abrupt("return");case 12:c=Object(d.a)({},r,{hasjoin:!0,joinConfirm:!1}),v.setCacheInfo([c]),T(u,o,c),e.next=18;break;case 17:T(u,o,Object(d.a)({hasjoin:!1,joinConfirm:!1},r));case 18:return e.abrupt("return",!1);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(e){var t=e.find(".mention-chat-icon img").prop("src"),n=e.find(".mention-chat-desc").text(),r=e.find(".mention-chat-tit").text(),i=e.find(".mention-chat-button-opt").text(),o=Object(g.K)(e.prop("className"),"mention-chatId");return{url:t,desc:n,buttonText:i,joinConfirm:!0,content:r,chatId:o,token:o,type:p.E.CHAT}}function j(e){var t,r=[];for(t in e){var n=e[t];Object(a.a)(n,function(e){var t,n;!e||(t=e[0].split("_"))&&t[0]&&"mention-chatId"===t[0]&&(n=t[1],r.indexOf(n)<0&&r.push(n))})}return r}function T(u,l,e){var t=Object(m.g)(),n=e.content,r=e.hasjoin,i=e.url,o=e.desc,a=e.is_cross_tenant,s=e.is_external,c=(c=(a||s)&&!r)||s&&t&&!r,d=p.f.unjoined;r&&(d=Object(g.p)());var f={url:i,desc:o,content:n,buttonText:d,chatId:l,notAllowedJoin:c};u.getMatchedAttributePositionOnSelection(null,function(e){return e==="mention-chatId_".concat(l)}).map(function(e){var t=e.docPosition,n=t.selZone;return{lineNum:t.selStart[0],zoneId:n}}).forEach(function(e){var t=e.lineNum,n=e.zoneId;if(-1!==t){var r=u.getRep(n).lines.atIndex(t);if(r&&r.lineNode){var i=r.lineNode,o=Object(h.$)(i).find(".mention-chatId_".concat(l)),a=o.length;if(a)for(var s=Object(g.W)(f),c=0;c<a;c++)w(o.eq(c),s)}}})}function w(e,t){var n=e.parents("[id^=magicdomid]"),r=u.dom.zoneOfdom(n.get(0)),i=u.getReps()[r];i&&(e.html(t),u.markNodeClean(n.get(0),i.lines.atKey(n.get(0).id)))}_.a=v}).call(this,M("2vAP"))},paQS:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("D7h9"),s=n("toa8"),r=n("wOYm"),c=n("Tb95"),u=n("ZGZ5"),l=n("wQna"),d=n("7SOz"),f=n("sFgt"),h=n("kUgE");function i(e){var t=e.suiteType,n=e.suiteToken,r=e.enableAutoTranslate,i=e.translateLang;l.a.destroy({suiteType:t,suiteToken:n});var o=l.a.getOrCreate({suiteType:t,suiteToken:n});return new c.a({enableAutoTranslate:r||!1,broadcast:o,request:s.d,getUserId:function(){return Object(u.a)(a.default.getState()).get("id")||window.User.id},getSuiteType:function(){return t},getSuiteToken:function(){return n},getTranslateLang:function(){return i||"en"},getSrcLang:function(){return Object(h.getLanguage)()},translateFn:d.a,toAILabTypeData:d.c,toLineTexts:d.d,parseCommentContent:f.j})}var o=Object(r.a)(i,function(e){return e.subCommentToken?"".concat(e.suiteType,":").concat(e.suiteToken,":").concat(e.subCommentToken):"".concat(e.suiteType,":").concat(e.suiteToken)})},pf04:function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i("o0o1"),o=i.n(n),r=i("J4zp"),a=i.n(r),s=i("yXPU"),c=i.n(s),u=i("6AXZ"),l=function(){var e=c()(o.a.mark(function e(){var t,n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Promise.all([i.e("doc_index_css"),i.e("chunk_adit"),i.e("commons--doc_index_delay--voteEmoji--votePicker"),i.e(16),i.e("commons--doc_index_delay--jira"),i.e("doc_index_delay")]).then(i.bind(null,"HN4B")),Object(u.b)().catch()]);case 2:return t=e.sent,n=a()(t,1),r=n[0],e.abrupt("return",r);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},pylR:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n("o0o1"),o=n.n(r),i=n("yXPU"),a=n.n(i),s=n("Ae4K");function c(i){return new Promise(function(){var t=a()(o.a.mark(function e(n){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(r=new FileReader).onload=a()(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.e)(r.result);case 2:t=e.sent,n(t);case 4:case"end":return e.stop()}},e)})),r.readAsArrayBuffer(i);case 3:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())}},qMRW:function(e,t,n){"use strict";var r=n("xUlX");function i(e,t){return e&&e.length&&t&&t.length?Object(r.a)(e,t):e}t.a=i},qYkn:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n("jp/M"),i=function(){return{type:r.actionTypes.permission.COPY_TEXT_FAIL}},o=function(){return{type:r.actionTypes.permission.ADMIN_PERMISSION_FAIL}}},qkt2:function(e,t,n){"use strict";n.d(t,"f",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return h}),n.d(t,"c",function(){return p}),n.d(t,"e",function(){return g});var r=n("u3oV"),i=n("gfe6"),o=n("nN3d"),a=function(e){return Array.isArray(e)?e:[e]},s=0,c=function(e){if(!e)return Object(o.c)(12);var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name,n=e.size,r=Object(o.c)(6);return s++,"".concat(n,"-").concat(t.replace(/[^0-9a-zA-Z_-]/gim,""),"-").concat(r,"-").concat(s)},u=function(){return Object(o.c)(32)},l=function(e){return e<1024?e+" bytes":e<1048576?(e/1024).toFixed(0)+" KB":e<1073741824?(e/1024/1024).toFixed(1)+" MB":(e/1024/1024/1024).toFixed(1)+" GB"},d=function(e){return Object(r.a)(e,function(e){return null!=e})};function f(r){return new Promise(function(e,t){var n=new FileReader;n.onload=function(){e(n.result)},n.onerror=function(){t("upload read blob error")},n.readAsArrayBuffer(r)})}function h(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise(function(e){return window.setTimeout(e,t)})}function p(e){var t=String(e).split(".").pop();return t&&t!==e?t.toLowerCase():""}function g(){return navigator.onLine&&Object(i.c)()}},qqiU:function(e,t,n){"use strict";var r=n("pVnL"),i=n.n(r),o=n("QILm"),a=n.n(o),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",i()({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},t),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 13.2c0 .44.36.8.8.8h12.4a.8.8 0 00.8-.8V.8a.8.8 0 00-.8-.8H.8a.8.8 0 00-.8.8v12.4zm1.5-.7h11v-11h-11v11zM11 6.23a.32.32 0 00-.54-.24L7.17 9.01l-.96-.83a.32.32 0 00-.42 0l-2.78 2.38a.25.25 0 00.17.44h7.57c.14 0 .25-.11.25-.25V6.23zM3.2 3a.2.2 0 00-.2.2v1.6c0 .11.09.2.2.2h1.6a.2.2 0 00.2-.2V3.2a.2.2 0 00-.2-.2H3.2z",fill:"#8F959E"}))}},r5mi:function(e,t,n){"use strict";var r=n("+Gkg");n.d(t,"a",function(){return r.a})},rbSl:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("J4zp"),k=n.n(r);function O(e,t){var n=e.lines.atIndex(t);return n?n.lineMarker:0}function E(e,t){var n=e.lines.atIndex(t);return n?n.text.length:0}function i(e){var t=e.editor,n=e.attrib,r=e.checkSelLineFirst,i=void 0!==r&&r,o=k()(n,1)[0];if(i){var a=t.getRep(),s=a.zoneId,c=a.selStart[0],u={selStart:[c,O(a,c)],selEnd:[c,E(a,c)]},l=t.getMatchedAttributeOnSelection(s,u,o);if(0<l.length)return l[0]}for(var d=t.getReps(),f=String(n),h=0,p=Object.keys(d);h<p.length;h++){var g=p[h],m=d[g];if(void 0!==m.apool.getAttribNum(f)){var v=m.lines.length()-1,b={selStart:[0,0],selEnd:[v,E(m,v)]},y=t.getMatchedAttributeOnSelection(g,b,o);if(0<y.length)return y[0]}}return null}},t5Ac:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c});var r=n("D7h9"),i=n("5cZX"),o=n("ZGZ5"),a=n("vc5i");function s(){var e=r.default.getState(),t=Object(i.L)(e),n=Object(i.w)(e);return{canCross:n.get("canCross"),externalAccess:n.get("externalAccess"),inviteExternal:n.get("inviteExternal"),publicPermission:t}}function c(){var e=r.default.getState(),t=Object(o.a)(e),n=Object(a.i)(e);return t.get("id")===n.get("id")}},tRMT:function(e,t,n){"use strict";n.r(t),n.d(t,"registerVCFunc",function(){return E}),n.d(t,"registerVCModule",function(){return r}),n.d(t,"unregisterVCModule",function(){return i});var f=n("Trbk");n.d(t,"FOLLOW_ACTION",function(){return f.a}),n.d(t,"FOLLOW_ACTION_LIFECYCLE_CHANGE",function(){return f.b}),n.d(t,"FOLLOW_EVENT",function(){return f.c}),n.d(t,"FOLLOW_GET_CURRENT_STATE",function(){return f.d}),n.d(t,"FOLLOW_LOG",function(){return f.e}),n.d(t,"FOLLOW_REFRESH",function(){return f.f}),n.d(t,"FOLLOW_REPLAY",function(){return f.g}),n.d(t,"FOLLOW_RUN_FUNCTION",function(){return f.h}),n.d(t,"FOLLOW_STATE_CHANGE",function(){return f.i}),n.d(t,"NEW_ACTIONS",function(){return f.j}),n.d(t,"PRESENTER_STATE",function(){return f.k}),n.d(t,"START_FOLLOW",function(){return f.l}),n.d(t,"START_RECORD",function(){return f.m}),n.d(t,"STOP_FOLLOW",function(){return f.n}),n.d(t,"STOP_RECORD",function(){return f.o}),n.d(t,"SUITE_VERSION_CHANGE",function(){return f.p});var h=n("i+co");n.d(t,"ACTION_IGNORE_REASON",function(){return h.a}),n.d(t,"ACTION_LIFECYCLE",function(){return h.b}),n.d(t,"LOG_EVENT",function(){return h.c}),n.d(t,"LOG_LEVEL",function(){return h.d}),n.d(t,"LOG_PLATFORM",function(){return h.e}),n.d(t,"LOG_TYPE",function(){return h.f}),n.d(t,"STATUS",function(){return h.g});var p=n("SyrE");n.d(t,"eventEmitter",function(){return p.g});var o=n("QKZB");function r(e){var t=e.moduleName,n=e.id;p.a.has(t,n)&&console.error("[VCFollowSDK]: '"+t+"' module has been registered"),p.a.set(e,n);var r=Date.now();p.b.collect({type:h.f.BUSINESS,level:h.d.INFO,event:h.c.REGISTER_MODULE,timestamp:r,message:Object(p.c)(r)+", register module["+t+"]."},n||"")}function i(e,t){p.a.remove(e,t);var n=Date.now();p.b.collect({type:h.f.BUSINESS,level:h.d.INFO,event:h.c.UNREGISTER_MODULE,timestamp:n,message:Object(p.c)(n)+", unregister module["+e+"]."},t||"")}var a="1.0.0",s={recordInterval:80},c="EVENT_FOLLOW_SUCCESS",u="EVENT_FOLLOW_FAIL",l="EVENT_FOLLOW_MAKE_UP",d=5e3,g=(m.prototype.start=function(){this.started?console.warn("start multi time"):(this.started=!0,this.tid=setTimeout(this.die,d))},m.prototype.stop=function(){this.started=!1,clearTimeout(this.tid)},m.prototype.heartbeat=function(){this.started&&(clearTimeout(this.tid),this.dead?(this.dead=!1,this.log({event:l,message:"follow make up"})):this.log({event:c,message:"follow success"}),this.tid=setTimeout(this.die,d))},m);function m(e){var t=this;this.started=!1,this.dead=!1,this.tid=0,this.die=function(){t.dead=!0,t.log({event:u,message:"follow fail"})},this.log=e.log}function v(e){return e.toString().toLowerCase().replace(/[^a-z0-9]/g,".").replace(/([a-z])([0-9])/g,"$1.$2").replace(/([0-9])([a-z])/g,"$1.$2").replace(/alpha/g,"-3").replace(/beta/g,"-2").replace(/rc/g,"-1").replace(/[^0-9.\-]+/g,"-4")}function b(e,t){if(!e||!t)return!1;for(var n=v(e).split("."),r=v(t).split("."),i=Math.max(n.length,t.length),o=0;o<i;o++){var a=+n[o]||0,s=+r[o]||0;if(a<s)return!1;if(s<a)return!0}return!0}function y(e){return JSON.parse(JSON.stringify(e,function(e,t){if("__proto__"!==e&&"constructor"!==e&&"prototype"!==e)return t}))}var k=(Object.defineProperty(O.prototype,"isRecord",{get:function(){return this.status===h.g.Record},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isFollow",{get:function(){return this.status===h.g.Follow},enumerable:!0,configurable:!0}),O.prototype.log=function(e){var t=Date.now();p.b.collect(Object(p.d)(Object(p.d)({type:h.f.SDK,level:h.d.INFO,timestamp:t},e),{message:Object(p.c)(t)+", "+e.message+"."}),this.id)},O.prototype.getFollowState=function(){return{header:{protocolVersion:this.protocolVersion,memberId:this.memberId,reqId:Date.now()},body:y(this.moduleStateMap)}},O.prototype.checkFollowState=function(e){try{var t=JSON.stringify(e),n={size:{checker:function(){return t.length<8e3},message:"check follow state is too large to send"}},r=Object.values(n).find(function(e){return!(0,e.checker)()});return r&&this.log({event:h.c.DATA_ILLEGAL,level:h.d.WARNING,timestamp:e.header.reqId,followState:t,message:r.message}),!r}catch(e){return!1}},O.prototype.setModuleState=function(t,n){var r=this;Object.keys(n).forEach(function(e){return r.setActionState(t,e,n[e])})},O.prototype.setActionState=function(e,t,n){this.moduleStateMap[e]||(this.moduleStateMap[e]=Object.create(null));var r={timestamp:Date.now(),suiteVersion:this.suiteVersion,data:n};this.moduleStateMap[e][t]=r},O.prototype.setAlreadyReplayActionState=function(e,t,n){this.alreadyReplayState[this.status]||(this.alreadyReplayState[this.status]=Object.create(null)),this.alreadyReplayState[this.status][e]||(this.alreadyReplayState[this.status][e]=Object.create(null)),this.alreadyReplayState[this.status][e][t]=n},O.prototype.setNextVersionActionState=function(e){var t=e.suiteVersion,n=e.moduleName,r=e.actionType,i=e.timestamp,o=e.data;this.nextVersionState[t]||(this.nextVersionState[t]={}),this.nextVersionState[t][n]||(this.nextVersionState[t][n]={}),this.nextVersionState[t][n][r]={suiteVersion:t,timestamp:i,data:o}},O.prototype.clearState=function(){this.suiteVersion="0",this.lastApplyFollowState=void 0,this.moduleStateMap=Object.create(null),this.alreadyReplayState=Object.create(null),this.nextVersionState=Object.create(null)},O.prototype.setModuleStateByGetAllCurrentModuleState=function(){return Object(p.e)(this,void 0,void 0,function(){var n=this;return Object(p.f)(this,function(e){return p.a.map(this.id,function(t){return Object(p.e)(n,void 0,void 0,function(){return Object(p.f)(this,function(e){switch(e.label){case 0:return[4,this.setModuleStateByGetCurrentModuleState(t)];case 1:return[2,e.sent()]}})})}),[2]})})},O.prototype.setModuleStateByGetCurrentModuleState=function(e){var r=e.moduleName,i=e.getCurrentModuleState;return Object(p.e)(this,void 0,void 0,function(){var t,n;return Object(p.f)(this,function(e){switch(e.label){case 0:if(!i)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,i()];case 2:return(t=e.sent())&&this.setModuleState(r,t),[3,4];case 3:return n=e.sent(),this.log({event:h.c.GET_CURRENT_MODULE_STATE_ERROR,level:h.d.ERROR,type:h.f.BUSINESS,message:"get module["+r+"] current state error: "+n}),[3,4];case 4:return[2]}})})},O.prototype.followListenerBinding=function(e){p.g[e](f.a,this.onFollowAction),p.g[e](f.a+":"+this.id,this.onFollowAction),p.g[e](f.i,this.onFollowStateChange),p.g[e](f.i+":"+this.id,this.onFollowStateChange)},O.prototype.clearSendFollowStateTimer=function(){this.sendFollowStateTimer&&(clearTimeout(this.sendFollowStateTimer),this.sendFollowStateTimer=null)},O.prototype.emitNewActions=function(e){p.g.emit(f.c+":"+f.j+":"+this.id,e)},O.prototype.checkIsNewActionState=function(e){var t=e.moduleName,n=e.actionType,r=e.timestamp,i=!0;return this.alreadyReplayState[this.status]&&this.alreadyReplayState[this.status][t]&&this.alreadyReplayState[this.status][t][n]&&this.alreadyReplayState[this.status][t][n].timestamp>=r&&(i=!1),this.log({event:h.c.CHECK_NEW_ACTION,module:t,actionType:n,timestamp:r,message:"check module["+t+"] action["+n+"] is"+(i?"":" not")+" new action"+(i?"":" [block]")}),i},O.prototype.checkIsNextVersion=function(e){var t=e.suiteVersion,n=e.moduleName,r=e.actionType,i=e.timestamp,o=!1;try{o=!b(this.suiteVersion,t.toString())}catch(e){console.error()}return this.log({event:h.c.CHECK_VERSION,module:n,actionType:r,timestamp:i,message:"check module["+n+"] action["+r+"] is"+(o?"":" not")+" next version action"+(o?", current suite version["+this.suiteVersion+"], action version["+t+"] [block]":"")}),o},O.prototype.setStateLog=function(e){var t=e&&e.header&&e.header.reqId||0,n=t?Date.now()-t:void 0;this.log({event:h.c.ACCEPT_STATE,timestamp:t,followState:JSON.stringify(e),delay:n,message:"accept follow state, delay["+n+"ms]"})},O.prototype._setState=function(e){var r=this;this.setStateLog(e),e&&e.header&&e.body&&(this.lastApplyFollowState&&e.header.memberId!==this.lastApplyFollowState.header.memberId&&(this.alreadyReplayState=Object.create(null)),this.lastApplyFollowState=e,this.isRecord?this.getSortActionStateList(e.body).forEach(function(e){var t=e.uuid,n=e.moduleName;return r.onActionLifecycleChange(h.b.IGNORED,n,t,h.a.RECORDING)}):this.replayFollowState(e.body)),this.statManager.heartbeat()},O.prototype.replayThisModuleStateMap=function(r){var i=this;return new Promise(function(t){var n=0;i.replayModuleStateMapTimer=setInterval(function(){n++;var e=i.alreadyReplayState[i.status]?i.exceptSameActionType(i.moduleStateMap,i.alreadyReplayState[i.status]):i.moduleStateMap;Object.keys(e).length&&n<r?i.replayFollowState(e):(i.clearReplayModuleStateMapTimer(),t())},300)})},O.prototype.clearReplayModuleStateMapTimer=function(){this.replayModuleStateMapTimer&&clearInterval(this.replayModuleStateMapTimer),this.replayModuleStateMapTimer=null},O.prototype.replayFollowState=function(e){var r=this;this.getSortActionStateList(e).forEach(function(e){if(!r.checkIsNewActionState(e)){var t=e.uuid,n=e.moduleName;return r.onActionLifecycleChange(h.b.IGNORED,n,t,h.a.OLD_VERSION)}if(r.checkIsNextVersion(e))return r.setNextVersionActionState(e);r.dispatchActionState(e)})},O.prototype.dispatchFollowState=function(e){e&&this.dispatchModuleState(e.body)},O.prototype.dispatchModuleState=function(e){var t=this;e&&this.getSortActionStateList(e).forEach(function(e){return t.dispatchActionState(e)})},O.prototype.dispatchActionState=function(e){var t=e.moduleName,n=this.isFollow?f.g:f.k;this.emitFollowReplayEvent(n,e),this.emitFollowReplayEvent(n+":"+this.id,e),this.emitFollowReplayEvent(n+":"+t,e),this.emitFollowReplayEvent(n+":"+t+":"+this.id,e),this.emitFollowReplayEvent(n+":"+this.id+":"+t,e)},O.prototype.emitFollowReplayEvent=function(e,t){var n=t.actionType,r=t.data,i=t.timestamp,o=t.suiteVersion,a=t.moduleName,s=t.uuid;if(!(!new RegExp(f.g).test(e)&&!new RegExp(f.k).test(e)||p.g.getListeners&&0===p.g.getListeners(e).length)){if(this.setAlreadyReplayActionState(a,n,{timestamp:i,suiteVersion:o,data:r}),this.isFollow&&this.shouldCheckMute){var c=p.h.checkIsModuleMute(a,i,this.id);if(this.log({event:h.c.CHECK_MUTE,module:a,actionType:n,timestamp:i,message:"check module["+a+"] action["+n+"] is"+(c?"":" not")+" mute"+(c?" [block]":"")}),c)return this.onActionLifecycleChange(h.b.IGNORED,a,s,h.a.IS_MUTE)}var u=Date.now()-i,l=e.split(":")[0];this.log({event:h.c.DISPATCH_MODULE,type:h.f.BUSINESS,module:a,actionType:n,timestamp:i,delay:u,message:"dispatch event["+l+"] module["+a+"] action["+n+"]-["+JSON.stringify(r)+"], delay["+u+"ms]"}),this.onActionLifecycleChange(h.b.DISPATCHED,a,s);try{var d={module:a,actionType:n,data:r,uuid:s};this.isFollow?p.g.emit(e,d,this.getReplayActionOperation(a,n)):p.g.emit(e,d)}catch(e){throw this.log({event:h.c.EMIT_ACTION_ERROR,type:h.f.BUSINESS,level:h.d.ERROR,message:"emit action error: "+e}),e}}},O.prototype.getSortActionStateList=function(n){var r=[];return Object.keys(n).forEach(function(t){return Object.keys(n[t]).forEach(function(e){return r.push(Object(p.d)(Object(p.d)({},n[t][e]),{actionType:e,moduleName:t}))})}),r.sort(function(e,t){return e.timestamp-t.timestamp})},O.prototype.getNewestModuleStateMap=function(e,t){var n=y(e),o=y(t);return Object.keys(n).forEach(function(r){var i=n[r];o[r]?Object.keys(i).forEach(function(e){var t=i[e],n=o[r][e];o[r][e]=!n||t.timestamp>=n.timestamp?t:n}):o[r]=i}),o},O.prototype.exceptSameActionType=function(e,n){var r=y(e);return Object.keys(r).forEach(function(t){var e;n[t]&&(e=r[t],Object.keys(e).forEach(function(e){n[t][e]&&(delete r[t][e],Object.keys(r[t]).length||delete r[t])}))}),r},O.prototype.getReplayActionOperation=function(e,t){var n=this,r=this.alreadyReplayState[this.status][e][t].timestamp;return{muteAllModulesPlay:function(e){return p.h.muteAllModulesPlay(e,r,n.id)},muteOtherModulesPlay:function(e,t){return p.h.muteOtherModulesPlay(e,t,r,n.id)},muteModulesPlay:function(e,t){return p.h.muteModulesPlay(e,t,r,n.id)}}},O.registerVCFunc=function(e,t){E(e,t)},O.registerVCModule=function(e){r(e)},O.unregisterVCModule=function(e,t){i(e,t)},Object.defineProperty(O,"eventEmitter",{get:function(){return p.g},enumerable:!0,configurable:!0}),O);function O(e){var i=this,t=void 0===e?{}:e,n=t.id,r=t.eventEmitter;this.id=o.a.v4(),this.protocolVersion=a,this.memberId=o.a.v4(),this.settingOptions=s,this.status=h.g.Normal,this.shouldCheckMute=!1,this.suiteVersion="0",this.sendFollowStateTimer=null,this.replayModuleStateMapTimer=null,this.eventMap=Object.create(null),this.moduleStateMap=Object.create(null),this.alreadyReplayState=Object.create(null),this.nextVersionState=Object.create(null),this.onActionLifecycleChange=function(e,t,n,r){var i;n&&(i={uuid:n,timestamp:Date.now(),type:e,reason:r,moduleName:t},p.g.emit(f.c+":"+f.b,i))},this.handleSuiteVersionChange=function(e){var t;e&&(i.suiteVersion=e.toString(),i.log({event:h.c.SUITE_VERSION_CHANGE,message:"suite version change, current version["+i.suiteVersion+"]"}),!i.isFollow||(t=i.nextVersionState[e])&&i.dispatchModuleState(t))},this.onFollowAction=function(e){var t=e.module,n=e.actionType,r=e.data;i.log({event:h.c.ON_FOLLOW_ACTION,type:h.f.BUSINESS,module:t,actionType:n,message:"get follow action, module["+t+"] action["+n+"]-["+JSON.stringify(r)+"]"}),i.setActionState(t,n,r),i.sendFollowState()},this.onFollowStateChange=function(n){return Object(p.e)(i,void 0,void 0,function(){var t;return Object(p.f)(this,function(e){switch(e.label){case 0:return t=p.a.get(this.id,n),this.log({event:h.c.ON_FOLLOW_STATE_CHANGE,type:h.f.BUSINESS,module:n,message:"get follow state change, module["+n+"] has"+(t?"":" not")+" register, has"+(t&&t.getCurrentModuleState?"":" not")+" getCurrentModuleState"}),t?[4,this.setModuleStateByGetCurrentModuleState(t)]:[3,2];case 1:e.sent(),this.sendFollowState(),e.label=2;case 2:return[2]}})})},this.sendFollowState=function(){var e;i.isRecord&&(e=function(){var e=i.getFollowState();i.checkFollowState(e)&&(i.emitNewActions(e),i.lastApplyFollowState=e,i.log({event:h.c.SEND_STATE,timestamp:e.header.reqId,followState:JSON.stringify(e),message:"send follow state"}))},i.clearSendFollowStateTimer(),i.sendFollowStateTimer=setTimeout(function(){i.sendFollowStateTimer=null,e()},i.settingOptions.recordInterval))},this.handleWindowResize=function(){i.isFollow&&i.dispatchModuleState(i.alreadyReplayState[h.g.Follow])},this._startRecord=function(t){return Object(p.e)(i,void 0,void 0,function(){return Object(p.f)(this,function(e){switch(e.label){case 0:return this.isRecord?[2]:(this.isFollow&&this.stopFollow(),this.lastApplyFollowState=void 0,this.log({event:h.c.START_RECORD,followState:JSON.stringify(t),message:"start record"}),t&&t.body&&"object"==typeof t.body?(this.status=h.g.Follow,this.alreadyReplayState=Object.create(null),this.moduleStateMap=t.body,[4,this.replayThisModuleStateMap(10)]):[3,2]);case 1:e.sent(),e.label=2;case 2:return this.status=h.g.Record,p.g.emit(f.m),p.g.emit(f.m+":"+this.id),[4,this.setModuleStateByGetAllCurrentModuleState()];case 3:return e.sent(),this.alreadyReplayState[h.g.Follow]&&(this.moduleStateMap=this.getNewestModuleStateMap(this.moduleStateMap,this.alreadyReplayState[h.g.Follow])),this.sendFollowState(),[2]}})})},this.on=function(e,t){i.eventMap[e]=t,i.log({event:h.c.SDK_ON,message:"on event["+e+"]"}),p.g.on(f.c+":"+e,t),p.g.on(f.c+":"+e+":"+i.id,t)},this.updateOptions=function(e){i.settingOptions=Object(p.d)(Object(p.d)({},i.settingOptions),e)},this.refresh=function(){i.log({event:h.c.SDK_REFRESH,message:"refresh"}),p.b.clear(""),p.b.clear(i.id),i.clearState(),p.g.emit(f.c+":"+f.f),p.g.emit(f.c+":"+f.f+":"+i.id)},this.destroy=function(){i.log({event:h.c.DESTROY,message:"destroy"}),i.stopRecord(),i.stopFollow(),i.clearState(),p.g.off(f.c+":"+f.p,i.handleSuiteVersionChange),p.g.off(f.c+":"+f.p+":"+i.id,i.handleSuiteVersionChange),Object.keys(i.eventMap).forEach(function(e){p.g.off(f.c+":"+e,i.eventMap[e]),p.g.off(f.c+":"+e+":"+i.id,i.eventMap[e])}),i.followListenerBinding("off"),i.eventMap=Object.create(null),Object(p.i)(),p.b.clear(i.id),p.a.clear(i.id)},this.getStatus=function(){return i.status},this.startRecord=function(e){i._startRecord(e)},this.stopRecord=function(){i.isRecord&&(i.status=h.g.Normal,i.clearSendFollowStateTimer(),i.clearReplayModuleStateMapTimer(),p.g.emit(f.o),p.g.emit(f.o+":"+i.id),i.lastApplyFollowState=void 0,i.alreadyReplayState=Object.create(null),i.log({event:h.c.STOP_RECORD,message:"stop record"}))},this.startFollow=function(){i.isFollow||(i.isRecord&&i.stopRecord(),i.status=h.g.Follow,i.alreadyReplayState=Object.create(null),p.b.clear(i.id,[h.c.DISPATCH_MODULE]),p.g.emit(f.l),p.g.emit(f.l+":"+i.id),i.log({event:h.c.START_FOLLOW,followState:JSON.stringify(i.lastApplyFollowState),message:"start follow"}),i.dispatchFollowState(i.lastApplyFollowState),i.shouldCheckMute=!0,window&&window.addEventListener&&window.addEventListener("resize",i.handleWindowResize),i.statManager.start())},this.stopFollow=function(){i.isFollow&&(i.status=h.g.Normal,i.shouldCheckMute=!1,i.nextVersionState=Object.create(null),p.g.emit(f.n),p.g.emit(f.n+":"+i.id),p.h.clear(i.id),p.b.clear(i.id,[h.c.DISPATCH_MODULE]),i.log({event:h.c.STOP_FOLLOW,followState:JSON.stringify(i.lastApplyFollowState),message:"stop follow"}),i.dispatchFollowState(i.lastApplyFollowState),window&&window.removeEventListener&&window.removeEventListener("resize",i.handleWindowResize),i.statManager.stop())},this.getState=function(){return i.log({event:h.c.GET_STATE,followState:i.simplifyData(i.lastApplyFollowState),message:"get VC state"}),i.lastApplyFollowState},this.setState=function(e){i._setState(e)},this.simplifyData=function(e){var t,a={};return e&&(t=e.body,Object.keys(t).forEach(function(i){a[i]={};var o=t[i];Object.keys(o).forEach(function(e){var t=o[e],n=t.timestamp,r=t.suiteVersion;a[i][e]={timestamp:n,suiteVersion:r}})})),JSON.stringify(a)},n&&(this.id=n),r&&Object(p.j)(r),this.followListenerBinding("on"),p.g.on(f.c+":"+f.p,this.handleSuiteVersionChange),p.g.on(f.c+":"+f.p+":"+this.id,this.handleSuiteVersionChange),this.log({event:h.c.INIT,message:"init"}),this.statManager=new g({log:this.log.bind(this)})}function E(e,t){k.prototype[e]=t;var n=Date.now();p.b.collect({type:h.f.BUSINESS,level:h.d.INFO,event:h.c.REGISTER_FUNC,timestamp:n,message:Object(p.c)(n)+", register func["+e+"]."},"")}function C(e){if(Array.isArray(e)){var d=0,f="",h={};return e.forEach(function(e){var t=e.id,n=e.module,r=e.type,i=e.data,o=void 0===i?{}:i,a=e.suiteVersion,s=void 0===a?0:a,c=e.memberId,u=void 0===c?"":c,l=e.uuid;t&&n&&r&&(d<t&&(d=t),u&&(f=u),h[n]||(h[n]={}),h[n][r]={timestamp:t,suiteVersion:s+"",data:o,uuid:l})}),{header:{protocolVersion:"0.0.1",memberId:f,reqId:d},body:h}}}function I(e){var c=[],u=e.header.memberId,t=e.body;return Object.keys(t).forEach(function(a){var s=t[a];Object.keys(s).forEach(function(e){var t=s[e],n=t.timestamp,r=t.suiteVersion,i=t.data,o=t.uuid;c.push({id:n,module:a,suiteVersion:parseInt(r.split(".")[0]),type:e,data:i,memberId:u,uuid:o})})}),c}var S,j=(S=k,Object(p.k)(T,S),T.prototype.emitNewActions=function(e){p.g.emit(f.c+":"+f.j+":"+this.id,I(e))},T.prototype.parseFollowState=function(e){return e?e.header&&e.body?e:C(e):void 0},T);function T(){var t=null!==S&&S.apply(this,arguments)||this;return t.protocolVersion="0.0.1",t.startRecord=function(e){t._startRecord(t.parseFollowState(e))},t.startReplay=function(){t.startFollow()},t.stopReplay=function(){t.stopFollow()},t.getCurrentStatus=function(){var e=t.getState();return e?I(e):[]},t.getActions=function(){return t.getCurrentStatus()},t.replayActions=function(e){t._setState(t.parseFollowState(e))},t.setState=function(e){t.replayActions(e)},t}t.default=j},tp5K:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a});var r=n("RIqP"),g=n.n(r);function m(e){return void 0===e}function i(t,r,e){var i,o,a=e.maxWait,s=0,c=Date.now,u=[],n=function(){u=null,i=void 0},l=function(e){s=e,u&&t(u),n()},d=function(e){var t=e-o,n=e-s;return m(o)||r<=t||t<0||!m(a)&&a<=n},f=function(e){var t=e-s,n=r-(e-o);return m(a)?n:Math.min(n,a-t)},h=function(){var e=c();if(d(e))return l(e);var t=f(e);i=p(t)},p=function(e){return window.setTimeout(h,e)};return function(e){(u=u||[]).push.apply(u,g()(e));var t=c(),n=d(t);if(o=t,n&&(m(i)&&(s=t,i=p(r)),!m(a)))return window.clearTimeout(i),i=p(r),l(o);m(i)&&(i=p(r))}}function o(e){return Array.from(new Set(e))}function a(e){return e.split("_")[1]}},uEBw:function(e,y,k){"use strict";(function(r){k.d(y,"a",function(){return u}),k.d(y,"f",function(){return l}),k.d(y,"g",function(){return f}),k.d(y,"e",function(){return h}),k.d(y,"c",function(){return g}),k.d(y,"b",function(){return m}),k.d(y,"d",function(){return v}),k.d(y,"h",function(){return b});k("J4zp");var t=k("n/R6"),i=k("KCMi"),n=k("2ACu"),o=k("Mvmg"),e=k("BmhO"),a="client_uploader_file_operation",s="file_card_file_info",c="request_file_block_permission",u={enter:"enter",quit:"quit",show_toolbar:"show_toolbar",click_inline_view:"click_inline_view",click_card_view:"click_card_view",click_preview_view:"click_preview_view",icon_download:"icon_download"};function l(e){var t=decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(t)}function d(e){for(var t=0,n=0;n<e.length;n++)127<e.charCodeAt(n)||94===e.charCodeAt(n)?t+=2:t+=1;return 20<t?"".concat(e.substring(0,10),"..."):e}function f(e){t.a.show({type:"error",closable:!0,content:e})}function h(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return n&&Object(i.a)(e,n)||Object(i.b)(e,t)}function p(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Object(n.default)(e,Object.assign({},t))}function g(){p(a,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}function m(){p(s,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}function v(){p(c,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}e.s.PNG,e.s.JPG,e.s.JPEG,e.s.GIF,e.s.ICO;function b(e){var t,n=d(e.name);return e.name.length>o.d&&(t="「".concat(n,"」 ").concat(r("drive.file_name_valid"))),(e.size>o.f||0===e.size)&&(t="「".concat(n,"」 ").concat(r("drive.file_size_valid_v2"))),/(?:[?*<>:"/\\|]+)/g.test(e.name)&&(t="「".concat(n,"」 ").concat(r("drive.file_name_char"))),t}}).call(this,k("2vAP"))},ukIz:function(e,t,n){"use strict";var o=n("AUh1"),a=n("fshX"),s=Math.max;function r(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Object(a.a)(n);return i<0&&(i=s(r+i,0)),Object(o.a)(e,t,i)}t.a=r},urrH:function(e,Ee,Ce){"use strict";(function(b){var e=Ce("RIqP"),d=Ce.n(e),t=Ce("lwsE"),o=Ce.n(t),n=Ce("W8MJ"),r=Ce.n(n),i=Ce("a1gu"),a=Ce.n(i),s=Ce("Nsbk"),c=Ce.n(s),u=Ce("7W2i"),l=Ce.n(u),f=Ce("Bw5p"),v=Ce("NZ+B"),y=Ce("7EGn"),h=Ce("c8Bs"),p=Ce("ifKl"),g=Ce("q1tI"),k=Ce.n(g),m=(Ce("17x9"),Ce("TSYQ")),O=Ce.n(m),E=Ce("UlbS"),C=Ce("uQON"),I=Ce("FJEn"),S=(Ce("Z7ZV"),Ce("5Ucn")),j=Ce("Vr4U"),T=Ce("OIAp"),w=Ce("chgP"),_=Ce("nMtL"),M=Ce("E3B5"),x=Ce("Kboj"),L=Ce("AvAw"),N=Ce("iP/4"),R=(Ce("fqG5"),Ce("i8i4")),P=Ce.n(R),D=Ce("Mpt7"),U=Ce("MRgF"),F=Ce.n(U),z=Ce("4O8T"),B=Ce.n(z),H=Ce("H6oK"),W=Ce("OX8E"),V=Ce("sFgt"),K=Ce("Hj9z"),q=Ce("AYG9"),Z=Ce("uGsk"),Q=Ce("5gSl"),J=Ce("Kwn9"),X=Ce("n67m"),Y=Ce("y7Jg"),$=Ce("DGTj"),ee=Ce("k8MZ"),te=Ce("bVwM"),ne=Ce("2ACu"),re=Ce("fQzm"),ie=Ce("Ahmm"),oe=Ce("gNEk"),ae=Ce("SebV"),se=Ce("VI6H"),ce=Ce("PX10"),ue=Ce("4d5w"),le=Ce("WUVX"),de=Ce("96li"),fe=Ce("TfC2"),he=Ce("6jTl"),pe=Ce("qqiU"),ge=Ce("MO5G"),me=Ce("n/R6"),ve=Ce("l8+p"),be=Ce("kS6I"),ye=F.a,ke=[{validator:function(e){return!(!e||e.match(/^[\s\n]+$/))},errorMsg:""}];Object(Z.a)();var Oe=function(e){function n(r){var m;o()(this,n),(m=a()(this,c()(n).call(this,r))).handleImageAdd=function(e){var t,n,r=e.uniqueId,i=e.imageItem;m.uniqueId===r&&((t=m.state.imageList).length>=fe.f||(n=[].concat(d()(t),[i]),m.setState({imageList:n,validate:Object(y.default)(m.isValidate(m.inputDom.innerText,n),"validate")})))},m.handleImageProgress=function(e){var t,n,r,i,o=e.uniqueId,a=e.percentage,s=e.uid,c=e.replyId,u=e.token;m.uniqueId===o&&(c&&(m.realReplyId=c),-1!==(n=(t=m.state.imageList).findIndex(function(e){return e.uid===s}))&&(r=d()(t),i=-1===a?de.a.FAILED:100===a?de.a.READY:de.a.UPLOADING,r[n]=Object.assign({},r[n],{token:u,percentage:a,status:i}),m.setState({imageList:r,validate:Object(y.default)(m.isValidate(m.inputDom.innerText,r),"validate")})))},m.handleImageListChange=function(e){var t=m.inputDom;W.a.trigger("CommentTextareaImageChange",[{uniqueId:m.uniqueId,imageList:e}]),m.setState({imageList:e,validate:Object(y.default)(m.isValidate(t.innerText,e),"validate")})},m.handleImageDelete=function(){return!!m.getCommentImageEnabled()||(me.a.error({duration:3e3,content:b("comment.image.unavailable")}),!1)},m.handleReloadEditor=function(){m.haveEditorError=!0,m.setState({haveEditorError:!0},function(){m.setState({haveEditorError:!1}),m.haveEditorError=!1})},m.handleEditorInnerError=function(e){m.haveEditorError=!0;var t=e||{},n=t.message,r=void 0===n?"":n,i=t.from,o=void 0===i?"":i,a=t.code,s=void 0===a?-1e3:a,c=e.module;console.log(JSON.stringify(window.scm));var u=o+"_comment";N.a.firefox||window.oopsDebugMode||(Object(ae.a)("comment textarea oops: ".concat(r,", oops code: ").concat(s)),Object(ne.default)("dev_comment_editor_oops",{category:"core",from:u,status_code:s,status_name:r,editor_id:m.editorComponent.editor.lineIdPre,plugin_module:c||""}),ie.a.trackEvent({category:"pad_error_from_".concat(u),action:"pad_error"}),re.b.count("ee.suite.oops",{source:"network"===o?"backend":"frontend"}),re.b.count("ee.docs.doc.oops",{code:s.toString(),status_name:r,err_type:"core",module:c}))},m.getInputRef=function(e){m.inputDom=P.a.findDOMNode(e),m.editorComponent=e;var t=m.props.inputRef;t&&t(m.inputDom)},m.getConfirmRef=function(e){m.confirmRef=e},m.getEditorAreaRef=function(e){m.editorAreaRef=e;var t=m.props.editorAreaRef;t&&t(e)},m.getCurrentTextareaValue=function(){var e=m.props,t=e.source,n=e.cell,r=e.mentionOptions,i=m.editorComponent.editor;return L.default.calTextAndCollectMentionFromRep(i,i.getRep(),{source:t,cell:n,mentionOptions:r})},m.handleConfirm=function(e){var t=m.props.sendable;if("click"===e.type&&e.stopPropagation(),!(m.state.submitting||Object(v.a)(t)&&!t)){var n=m.props,i=n.onConfirm,o=n.source,a=n.limit,r=n.mentionOptions,s=m.editorComponent.editor,c=(r&&r.notifyOptions?r.notifyOptions:{}).useMention,u=void 0!==c&&c;try{s.inCallStackIfNecessary("textareaConfirm",function(){s.fastIncorp(!0)})}catch(e){console.error(e)}var l=m.getCurrentTextareaValue(),d=l.html,f=l.mentionTokenList;X.a.addComment(f);var h,p=function(){var e=[{validator:function(e){return e.length<=a},errorMsg:b("comment.comment_limit_tips",a)}].concat(ke),t=m.isValidate(d,m.state.imageList,e),n=t.validate,r=t.errorMsg;n?m.setState({validate:!0,errorMsg:"",submitting:!0},function(){var e;m.getCommentImageEnabled()&&(e=m.state.imageList.map(function(e){return e.token}));var t=d;t&&!t.match(/^[\s\n]+$/)||(t=""),i(t,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Object(q.c)(q.a.ADD_COMMENT);var t=e.error,n=e.isTemplate,r=m.inputDom;if(t){var i=Object(C.i)(t.code);return(m.setState({errorMsg:i,submitting:!1}),r)?void window.setTimeout(function(){m.setState({errorMsg:""})},3e3):void 0}if(n||(u?L.default.sendMentionNotifications2(o):L.default.sendMentionNotifications()),r){try{s.clear(),m.currentHtml="",m.setCursorEnd()}catch(e){console.error(e),m.handleReloadEditor()}W.a.trigger("CommentTextareaImageReset",[{uniqueId:m.uniqueId}]),m.setState({errorMsg:"",submitting:!1,imageList:[],validate:Object(y.default)(m.isValidate(r.innerText,[]),"validate")})}},e,m.realReplyId)}):m.setState({validate:n,errorMsg:r})},g=m.state.imageList;m.getCommentImageEnabled()&&g.some(function(e){return e.status!==de.a.READY})?(h=function(){m.setState({imageList:m.state.imageList.filter(function(e){return e.status===de.a.READY})},function(){p()})},he.a.show({title:b("comment.image.check_title"),body:b("comment.image.check_content"),confirmText:b("comment.send"),cancelText:b("common.cancel"),maskClosable:!1,onConfirm:h})):p()}},m.handleKeyUp=function(e){var t,n,r,i,o=m.shortcuts.confirm;m.matchShortcut(o,e)||(t=e.target.innerText,r=(n=m.isValidate(t,m.state.imageList)).validate,i=n.errorMsg,m.setState({validate:r,errorMsg:i}))},m.handleEditorClick=function(e){var t=m.editorComponent.editor;t&&(t.isContentEditable()||(e.stopPropagation(),t.setEditable(!0),m.handleFocus(),Object(ae.a)("commentTextarea have no content editable"),m.isFocus()||Object(ae.a)("commentTextarea can not focus")),"A"===e.target.tagName&&e.preventDefault())},m.handleKeyDown=function(e){if(m.hasManualInput=!0,!e.nativeEvent){var t=m.mention&&m.mention.docMention.isMentionBoxVisible();if(!m.isIMEInputing&&!t){var n=m.editorComponent.editor,r=m.shortcuts,i=r.confirm,o=r.lineBreak,a=r.esc;return m.matchShortcut(o,e)?(m.stopEvt(e),n.inCallStackIfNecessary("lineBreak",function(){var e=n.getRep().zoneId;n.fastIncorp(),n.performDocumentReplaceSelection(e,"\n")}),!1):m.matchShortcut(i,e)&&!m.mention.docMention.isMentionBoxVisible()?(m.stopEvt(e),m.handleConfirm(e),!1):m.matchShortcut(a,e)?(m.stopEvt(e),e.target.blur(),m.props.onEscCancel(e),!1):void 0}}},m.stopEvt=function(e){e.preventDefault(),e.stopImmediatePropagation&&e.stopImmediatePropagation()},m.performUserToTextareaHead=function(e){var t=Object(se.m)(e),n=m.props.mentionOptions,r=m.editorComponent.editor,i=H.BlockType.AT_USER_BLOCK,o=Object(H.generateBlockDataSet)({blockType:i,creator:Object(H.getBlockCreator)(i,r),props:{data:{source:n.type,user:Object(f.a)(t,["avatar_url","cn_name","en_name","id","name","type"])}}}),a=r.plugins.blockPlugin.getAttrsFromBlockDataSet(o);Object(ce.d)(r,[0,0],[0,0]," ",a);var s=r.getAuthor();Object(ce.f)(r,[0,1],[0,1],[["author",s]]),m.focus(),m.handleEditorResize()},m.handleComposition=function(e){var t=e.type;"compositionstart"!==t?"compositionend"===t&&(m.isIMEInputing=!1):m.isIMEInputing=!0},m.handleFocus=function(e){"A"===e.target.tagName&&Object(oe.b)(e),m.isFocus()||(m.focus(),m.setCursorEnd())},m.handleFillHtml=function(e,t,n){var r,i;e&&!e.match(/^[\s\n]+$/)&&(r=m.editorComponent.editor,m.content=e,i=t||(V.n.cache.delete(e),Object(V.n)(e,n,r).split("\n").join("<br/>")),N.a.msie?r.inCallStackIfNecessary("fillText",function(){var e=document.createElement("div");e.innerHTML=i,r.fastIncorp(),m.inputDom.appendChild(e),r.fastIncorp()}):(m.inputDom.innerHTML=i,r.inCallStackIfNecessary("fillText",function(){r.fastIncorp()})))},m.handleFillImage=function(e){m.setState({imageList:e})},m.handleInput=function(e){var t=e.target.innerText,n=m.isValidate(t,m.state.imageList),r=n.validate,i=n.errorMsg,o=m.showConfirmBtn;m.setState({validate:r,errorMsg:i},function(){var e;o===m.showConfirmBtn||(e=m.props.onResize)&&e()});var a=m.props.onInput;a&&a(e)},m.handleEditorResize=function(){var e=m.props,t=e.onResize,n=e.onEditorResize;t&&t(!0),n&&n()},m.handleBlur=function(e){var t;m.mention.docMention.isMentionBoxVisible()||((t=m.props.onBlur)&&t(e),m.setState({textareaFocus:!1}))},m.handleEditorFocus=function(e){var t=m.props.onFocus;t&&t(e),m.setState({textareaFocus:!0})},m.handleCancel=function(e){"click"===e.type&&e.stopPropagation();var t=m.props.onCancel;try{e.target.blur(),m.editorComponent.editor.clear(),m.currentHtml="",m.handleEditorResize()}catch(e){console.error(e),m.handleReloadEditor()}t&&t(e),W.a.trigger("CommentTextareaImageReset",[{uniqueId:m.uniqueId}]),m.setState({validate:!1,imageList:[]})},m.handleEditorDidUpdate=function(){var e,t=m.inputDom?m.inputDom.textContent:"",n=m.inputDom?m.inputDom.innerHTML:"";if(n!==m.currentHtml){m.currentHtml=n;for(var r,i,o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];m.props.editorDidUpdate&&(e=m.props).editorDidUpdate.apply(e,[m.props.replyId,t,n].concat(a)),m.getCommentImageEnabled()&&(i=(r=m.editorComponent.editor).repManager.getActiveRep(),m.hasManualInput||2!==i.alines.length||""!==i.alltext.replace(/\s/g,"")||r.clear(),m.setState({isSingleLine:1===i.alines.length}))}},m.handleImageSelect=function(e){e.stopPropagation(),m.state.imageList.length>=fe.f||(W.a.trigger("CommentTextareaSelectImage",[m.uniqueId]),Object(ne.default)("client_comment",{action:"click_image_icon"}))},m.registerPlugin=function(e){var t=m.props,n=t.mentionOptions,r=t.source,i=t.mentionContainer,o=m.state.imageList,a=new B.a;m.mention=new j.default({eventEmitter:a,showable:!0,editor:e,type:n.type,boxWidth:280,boxMinHeight:200,source:r,container:i||".doc-position",hoverArea:".doc-comment,.doc-comment-new,.comment-history,.spreadsheet-comment-wrapper,.global-comment,.message-comment-entity"});var s,c,u,l=[m.mention,new ee.a(e),new S.HyperLinks({editor:e,isCommentEditor:!0}),te.a,x.b,new T.default({editor:e}),new w.default({editor:e}),new _.default({editor:e}),new H.BlockPlugin({editor:e,blockManager:new H.BlockManager([new K.AtUserCreator({ExternalServices:J.a.AtUserCreator})]),defaultSupportModules:new Map([].concat(d()(Object(H.getAllDisableModulesConfig)()),[[H.PermissionModule,!0],[H.LoadingModule,!0]]))}),new Y.a(e),new $.a(e)];return m.getCommentImageEnabled()&&(c=(s=m.props).commentId,u=s.replyId,l.push(new ue.a({editor:e,commentId:c,replyId:u,uniqueId:m.uniqueId,currentImageCount:o.length}))),l},m.state={submitting:!1,validate:!1,errorMsg:"",haveEditorError:!1,imageList:r.imageList||[],isSingleLine:!0,textareaFocus:!1};var i=["meta","ctrl"];m.shortcuts=["confirm","lineBreak","esc"].reduce(function(e,t){var n=r.shortcuts[t];return e[t]=n.map(function(e){var t=e.split(","),n=!!i.find(function(e){return-1<t.indexOf(e)});return{names:t,withCombindKey:n}}),e},{}),m.content="",m.haveEditorError=!1,m.currentHtml="";var e=r.commentId,t=r.replyId;return m.uniqueId=e?"commentId".concat(e):t?"replyId".concat(t):"globalComment",m.realReplyId="",m.hasManualInput=!1,m.isOnCommentTextareaImage=!1,m}return l()(n,e),r()(n,[{key:"componentDidMount",value:function(){this.editorComponent&&this.editorComponent.editor&&this.editorComponent.editor.once("error",this.handleEditorInnerError),this.getCommentImageEnabled()&&(this.isOnCommentTextareaImage=!0,W.a.on("CommentTextareaImageAdd",this.handleImageAdd),W.a.on("CommentTextareaImageProgress",this.handleImageProgress))}},{key:"componentDidUpdate",value:function(e,t){var n,r=t.errorMsg,i=t.imageList,o=t.validate,a=this.state,s=a.errorMsg,c=a.imageList,u=a.validate;s===r&&c.length===i.length&&u===o||(n=this.props.onResize)&&n()}},{key:"componentWillUnmount",value:function(){this.content&&(V.n.cache.delete(this.content),this.content=null),this.editorComponent&&this.editorComponent.editor&&this.editorComponent.editor.off("error",this.handleEditorInnerError),this.isOnCommentTextareaImage&&(W.a.off("CommentTextareaImageAdd",this.handleImageAdd),W.a.off("CommentTextareaImageProgress",this.handleImageProgress)),this.mention=null,this.inputDom=null,this.editorComponent=null,this.confirmRef=null,this.editorAreaRef=null,this.shortcuts=[],this.haveEditorError=!1,this.currentHtml=""}},{key:"getCommentImageEnabled",value:function(){return Object(ge.a)()&&this.props.commentImageEnabled}},{key:"blur",value:function(){this.inputDom.blur()}},{key:"focus",value:function(){var e=window._gcGlobal&&window._gcGlobal.activeElement,t=!0;e&&e._setFocus(null,t),this.inputDom.focus(),this.setState({validate:this.inputDom.querySelector(".j-block-container")||Object(y.default)(this.isValidate(this.inputDom.innerText,this.state.imageList),"validate")})}},{key:"setEditorCursorToEnd",value:function(e){var t=e.repManager.getActiveRep().lines,n=t.length()-1,r=[n,t.atIndex(n).text.length];e.setWithSelection("0",r,r),e.updateBrowserSelectionFromRep()}},{key:"setCursorEnd",value:function(){this.setEditorCursorToEnd(this.editorComponent.editor),(N.a.firefox||N.a.modernIE)&&this.inputDom.click()}},{key:"isFocus",value:function(){return document.activeElement===this.inputDom}},{key:"isEmpty",value:function(){if(0<this.state.imageList.length)return!1;if(!this.inputDom)return!0;var e=this.editorComponent.editor;return!e||e.isEmpty()}},{key:"isValidate",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:ke;if(0<t.filter(function(e){return e.status===de.a.READY}).length)return{validate:!0,errorMsg:""};for(var r=0;r<n.length;r++){var i=n[r],o=i.validator,a=i.errorMsg;if(!o(e))return{validate:!1,errorMsg:a}}return{validate:!0,errorMsg:""}}},{key:"matchShortcut",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length?arguments[1]:void 0,o={enterKey:13===i.keyCode,escKey:27===i.keyCode},a=!!["meta","ctrl"].find(function(e){return i["".concat(e,"Key")]});return e.find(function(e){var t=e.names,n=e.withCombindKey,r=a===n;return Object(h.a)(t,function(e){return(o["".concat(e,"Key")]||i["".concat(e,"Key")])&&r})})}},{key:"renderButton",value:function(){var e=this.props,t=e.confirmText,n=e.cancelText,r=e.alwaysShowConfirmBtn,i=e.isGlobal,o=!0===this.haveEditorError||!0===r||this.showConfirmBtn,a=O()("comment-textarea__confirm-btn",{"comment-textarea__confirm-btn-disable":!this.showConfirmBtn});return o&&t&&k.a.createElement("div",{className:O()("comment-textarea__confirm",{"comment-textarea__confirm--global":i},{"comment-textarea__confirm--image":this.getCommentImageEnabled()}),ref:this.getConfirmRef},k.a.createElement("button",{className:"comment-textarea__cancel-btn",onClick:this.handleCancel},n),k.a.createElement("button",{className:a,onClick:this.handleConfirm},t))}},{key:"renderImageSelectButton",value:function(){var e=this.state.imageList.length>=fe.f;return Object(be.d)(be.b.FILE_UPLOAD)===be.a.DENY?k.a.createElement(E.Tooltip,{title:b("CreationDoc_ECM_AdminDisableToast"),placement:"top",adjustPlacements:["topRight"],arrowAtCenter:!0},k.a.createElement("div",{className:"comment-textarea__image-select comment-textarea__image-select--disabled"},k.a.createElement(pe.a,null))):k.a.createElement("div",{className:O()("comment-textarea__image-select",{"comment-textarea__image-select--disabled":e}),onClick:this.handleImageSelect},k.a.createElement(pe.a,null))}},{key:"renderOperationButton",value:function(){return this.getCommentImageEnabled()?k.a.createElement("div",{className:"comment-textarea__operation-btn"},this.renderImageSelectButton()):null}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.placeholder,r=e.user,i=e.initPlaceholder,o=e.isGlobal,a=e.commentId,s=e.replyId,c=this.state,u=c.errorMsg,l=c.haveEditorError,d=c.imageList,f=c.isSingleLine,h=c.textareaFocus,p=O()("comment-textarea__error-tips",{"comment-textarea__error-tips--show":u}),g=r?Object(D.isImmutable)(r)?r.get("avatar_url"):r.avatar_url:ye,m=this.getCommentImageEnabled(),v=O()("comment-textarea-wrapper",{"comment-textarea-wrapper--single-line":m&&f,"comment-textarea--image":m,"comment-textarea--image--focus":m&&h},t);return k.a.createElement(k.a.Fragment,null,k.a.createElement("div",{className:v,onClick:this.handleFocus},r?k.a.createElement("div",{className:"comment-placeholder-wrapper"},k.a.createElement("div",{className:"comment-avatar"},k.a.createElement(M.a,{url:g||ye,tip:!1})),k.a.createElement("div",{className:"comment-placeholder"},i||b("comment.full_text"))):null,k.a.createElement("div",{className:"comment-textarea",style:this.props.style,ref:this.getEditorAreaRef,onCopy:Q.a,onCut:Q.a,onContextMenu:Q.a},!l&&k.a.createElement(I.EditorReact,{className:"comment-textarea__input",onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onClick:this.handleEditorClick,onCompositionStart:this.handleComposition,onCompositionEnd:this.handleComposition,spellCheck:"true",onInput:this.handleInput,onBlur:this.handleBlur,onFocus:this.handleEditorFocus,idleWorkTimer:!1,placeholder:n,onResize:this.handleEditorResize,editorDidUpdate:this.handleEditorDidUpdate,domPurifyConfig:{enable:!0},registerPlugin:this.registerPlugin,ref:this.getInputRef,bus:W.a})),0<d.length&&k.a.createElement(le.a,{style:{marginTop:8},imageList:d,canEdit:m,canDelete:!0,onDeleteImage:this.handleImageDelete,onImageListChange:this.handleImageListChange,lineImageCount:o?1/0:3,scrollContainer:Object(ve.a)(o?"globalComment":void 0),commentId:a,replyId:s}),k.a.createElement("div",{className:p},k.a.createElement("div",{className:"error-icon"}),k.a.createElement("div",{className:"error-tips"},u)),!m&&this.renderButton(),this.renderOperationButton()),m&&this.renderButton())}},{key:"showConfirmBtn",get:function(){var e=this.props,t=e.showConfirmBtn,n=e.sendable,r=this.state,i=r.validate,o=r.submitting;return t&&i&&!o&&(!Object(v.a)(n)||n)}}]),n}(k.a.PureComponent);Oe.defaultProps={limit:1e4,shortcuts:{confirm:["enter"],lineBreak:["shift,enter","meta,enter","ctrl,enter"],esc:["esc"]},showConfirmBtn:!0,confirmText:b("comment.send"),cancelText:b("common.cancel"),onEscCancel:p.default,onConfirm:p.default},Ee.a=Oe}).call(this,Ce("2vAP"))},uwMH:function(e,L,N){"use strict";(function(c){N.d(L,"a",function(){return n}),N.d(L,"c",function(){return _});var e,t,n,r,i=N("a1gu"),u=N.n(i),o=N("Nsbk"),l=N.n(o),a=N("7W2i"),d=N.n(a),s=N("lSNA"),f=N.n(s),h=N("o0o1"),p=N.n(h),g=N("yXPU"),m=N.n(g),v=N("lwsE"),b=N.n(v),y=N("W8MJ"),k=N.n(y),O=N("D7h9"),E=N("5cZX"),C=N("n3ZB"),I=N("yaX4"),S=N("AiBH"),j=N("iP/4"),T=N("uxcB"),w=function(){function e(){var t=this;b()(this,e),this.isGuideDone=function(e){return!1!==t.getCurGuides().getIn([e,"is_done"])},this.updated=!1}function t(e){return n.apply(this,arguments)}var n,r,i;function o(e){return r.apply(this,arguments)}function a(){return i.apply(this,arguments)}return k()(e,[{key:"fetchGuidesAPI",value:(i=m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.default.dispatch(Object(I.b)()));case 1:case"end":return e.stop()}},e)})),a)},{key:"getCurGuides",value:function(){return Object(C.i)(O.default.getState())}},{key:"clearUpdated",value:function(){this.updated=!1}},{key:"updateGuideAPI",value:(r=m()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.updated=!0,e.prev=1,e.next=4,O.default.dispatch(Object(I.d)(t));case 4:e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(1),this.updated=!1,e.t0;case 10:case"end":return e.stop()}},e,this,[[1,6]])})),o)},{key:"markGuideAsDoneAPI",value:(n=m()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.default.dispatch(Object(I.a)(t)));case 1:case"end":return e.stop()}},e)})),t)},{key:"canStart",value:function(){return!j.a.isMobile&&Object(E.c)(O.default.getState())}},{key:"isUpdated",get:function(){return this.updated}}]),e}();(r=n=n||{}).GROUP="atplaceholder_b_at_group",r.DOC="atplaceholder_b_at_doc",r.GROUP_CARD="atplaceholder_b_at_group_card",r.SHEET="atplaceholder_b_at_sheet",r.FILE="atplaceholder_b_at_file";var _=(e={},f()(e,S.E.GROUP,n.GROUP),f()(e,S.E.FILE,n.DOC),f()(e,S.E.SHEET,n.DOC),f()(e,S.E.CHAT,n.GROUP_CARD),e),M=function(e){function n(){return b()(this,n),u()(this,l()(n).apply(this,arguments))}function t(e){return r.apply(this,arguments)}var r,i,o;function a(){return i.apply(this,arguments)}function s(){return o.apply(this,arguments)}return d()(n,e),k()(n,[{key:"start",value:(o=m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canStart()){e.next=2;break}return e.abrupt("return");case 2:this.init();case 3:case"end":return e.stop()}},e,this)})),s)},{key:"update",value:(i=m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDone||this.isUpdated)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,this.updateGuideAPI(this.curGuide);case 4:case"end":return e.stop()}},e,this)})),a)},{key:"markAsDone",value:(r=m()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDone||!n.GUIDE_TYPES.includes(t)||this.isGuideDone(t))return e.abrupt("return");e.next=2;break;case 2:return e.next=4,this.markGuideAsDoneAPI(t);case 4:this.curGuide===t&&this.init();case 5:case"end":return e.stop()}},e,this)})),t)},{key:"init",value:function(){var t=this;Object(T.a)(),this.clearUpdated(),this.curGuide=n.GUIDE_TYPES.find(function(e){return!t.isGuideDone(e)});var e=this.curGuide?n.GUIDE_TEXT[this.curGuide]:c("doc.body_placeholder_default");Object(T.b)(e)}},{key:"isDone",get:function(){return void 0===this.curGuide}}]),n}(w);function x(){return new M}M.GUIDE_TYPES=[n.DOC,n.GROUP_CARD,n.SHEET,n.FILE],M.GUIDE_TEXT=(t={},f()(t,n.DOC,c("abtest.atplaceholder.b.at.doc")),f()(t,n.GROUP_CARD,c("abtest.atplaceholder.b.at.groupcard")),f()(t,n.SHEET,c("abtest.atplaceholder.b.at.sheet")),f()(t,n.FILE,c("abtest.atplaceholder.b.at.file")),t),L.b=x()}).call(this,N("2vAP"))},uxcB:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return v});var r=n("O9F5"),i="TITLE_PLACEHOLDER_RULE_ID",o="BODY_PLACEHOLDER_RULE_ID",a="",s="";function c(){return document.body.id?"#".concat(document.body.id):""}var u=">.ace-line:nth-child(1)::before";function l(e){return"\n  ".concat(c()," .maindocbody.innerdocbody.blank-title.docbody--write[contenteditable=true]").concat(u,'{\n    content: "').concat(e,'";\n  }')}function d(e){return"\n  ".concat(c(),' .maindocbody.innerdocbody.blank-body.docbody--write[contenteditable=true]>div:nth-child(2)::before {\n    content: "').concat(e,'";\n  }')}function f(e,t){h(e),p(e,t)}function h(e){r.a.deleteRuleById(e)}function p(e,t){r.a.insertRule(t,e)}function g(){return d(a+s)}function m(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;a=e,f(o,g()),null!==t&&f(i,l(t))}function v(){h(o),h(i)}},v2N6:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var r=new Map;function i(e){var t=e.lastModified,n=e.name,r=e.type,i=e.size;return"".concat(n,"_").concat(r,"_").concat(i,"_").concat(t)}function o(e,t){var n=i(e);r.set(n,t)}function a(){r.clear()}},vPIQ:function(e,t,n){"use strict";var r=n("Xh8f"),i=n("3ftV"),o=Object(r.a)(i.a);t.a=o},vzE1:function(e,t,n){"use strict";e.exports=Number.isNaN||function(e){return e!=e}},wOYm:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("lwsE"),o=n.n(r),i=n("W8MJ"),a=n.n(i);function s(r,i){return new(function(){function e(){o()(this,e),this.services=new Map}return a()(e,[{key:"getOrCreate",value:function(e){var t=i(e),n=this.services.get(t);return n||(n=r(e),this.services.set(t,n)),n}},{key:"destroy",value:function(e){var t=i(e),n=this.services.get(t);n&&n.destroy(),this.services.delete(t)}}]),e}())}},wQna:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n("Vfrr"),i=n("D7h9"),o=n("toa8"),a=n("Q9MD"),s=n("5gS9"),c=n("QM+C"),u=n("wOYm");function l(e){var t=e.suiteType,n=e.suiteToken;return new r.a({serviceType:t,serviceToken:n,engineType:c.NUM_SUITE_TYPE_TO_SUITE_ENGINE_TYPE[t],io:s.b.getInstance(),getRequest:function(){return o.d},getMemberId:function(){return function(){return Object(a.b)(i.default.getState())}}})}var d=Object(u.a)(l,function(e){return"".concat(e.suiteType,":").concat(e.suiteToken)})},wSsa:function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"b",function(){return f}),n.d(t,"a",function(){return h});var r=n("VkAN"),i=n.n(r),o=n("MjSh"),a=n("vOnD"),s=n("qxQb"),c=n.n(s);function u(){var e=i()(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 28px;\n  height: 28px;\n  margin-top: 2px;\n  border-radius: 3px;\n  transition: background-color 0.1s linear;\n\n  &:hover {\n    background-color: ",";\n  }\n  &:active {\n    background-color: ",";\n  }\n"]);return u=function(){return e},e}var l=86400,d=(Date.now(),"bytedance_storage.whats_new_storage_key"),f="suiteCanReady",h=a.default.span(u(),c()(o.N900,.1),c()(o.N900,.15))},whZn:function(e,t,n){"use strict";n.d(t,"a",function(){return g}),n.d(t,"b",function(){return m});var r=n("J4zp"),i=n.n(r),o=n("RIqP"),l=n.n(o),a=n("lwsE"),s=n.n(a),c=n("W8MJ"),u=n.n(c),d=n("3Hq1"),f=n("y2sV"),h=n("elsr"),p=n("tp5K"),g=function(){function t(e){var u=this;s()(this,t),this.suiteEmbedObjManager=e,this.tokenListsOfNewLines=[],this.handleBufferChanged=function(o,e){var t,a;u.suiteEmbedObjManager&&(t=e.enteredLines,a=[],t.forEach(function(e){var t=e.lineEntry,n=e.childZoneLineEntries,r=e.lineNum,i=u.disposeLineEntry(o,t,r);a.push.apply(a,l()(i)),n.length&&n.forEach(function(e){var t=u.disposeLineEntry(o,e,r);a.push.apply(a,l()(t))})}),u.suiteEmbedObjManager.debounceSendEmbedObjsToManager(a))},this.processAddTokensFromNewLine=function(e){var n=e.hasAddTokens;e.alinesAttribs.forEach(function(e){var t;n&&(t=u.getMentionTokenFromAttribPairs(e),u.tokenListsOfNewLines.push(t))})},this.handleLinesWillReplace=function(e){var t,n,a,r;u.suiteEmbedObjManager&&(t=e.oldLineEntries,n=e.newLineEntries,t.forEach(function(e){var t=e.key,n=e.zone;u.getLineNodeIdSet(n).delete(t)}),u.tokenListsOfNewLines.length?(a=[],n.forEach(function(e,t){var n=e.key,r=e.zone,i=e.isActive,o=u.tokenListsOfNewLines[t];o&&(i?(a.push.apply(a,l()(o)),u.getLineNodeIdSet(r).add(n)):u.suiteEmbedObjManager.waitingIntoBufferMap.set(n,o))}),r=a.map(u.convertTokenToObj),u.suiteEmbedObjManager.debounceSendEmbedObjsToManager(r)):n.forEach(function(e){var t=e.key,n=e.zone;u.getLineNodeIdSet(n).add(t)}),u.tokenListsOfNewLines.length=0)},this.disposeLineEntry=function(e,t,n){var r=t.key,i=t.zone;if(!u.checkIfDirtyLine(i,r))return[];var o=u.getTokenListFromWaitingMap(r);return o?o.map(u.convertTokenToObj):i!==h.a?[]:u.getEmbedObjsFromLine(e,n,t)},this.checkIfDirtyLine=function(e,t){var n=u.getLineNodeIdSet(e);return!n.has(t)&&(n.add(t),!0)},this.getLineNodeIdSet=function(e){if(!u.suiteEmbedObjManager)return new Set;var t=u.suiteEmbedObjManager.zoneToLineNodeIdMap;return Object(d.default)(t[e])&&(t[e]=new Set),t[e]},this.getTokenListFromWaitingMap=function(e){if(u.suiteEmbedObjManager)return u.suiteEmbedObjManager.waitingIntoBufferMap.get(e)},this.getEmbedObjsFromLine=function(e,t,n){var r,i,o,a=n.zone,s=n.text,c=new Set;return e.version.includes(f.y)?(r={start:{line:t,offset:0,zoneId:a},end:{line:t,offset:s.length,zoneId:a}},i=function(e){return e.startsWith("mention-token")},e.getEntities(r,i).forEach(function(e){var t=Object.keys(e.attributes).find(i),n=Object(p.c)(t),r=u.convertTokenToObj(n);r&&c.add(r)})):(o={selStart:[t,0],selEnd:[t,s.length],selZone:a},e.getMatchedAttributePositionOnSelection(o,function(e){return/mention-token/.test(e)},{shouldMerge:!1}).forEach(function(e){var t=e.attrKey,n=Object(p.c)(t),r=u.convertTokenToObj(n);r&&c.add(r)})),l()(c)},this.convertTokenToObj=function(e){return u.suiteEmbedObjManager?u.suiteEmbedObjManager.embedObjMap[e]:null},this.getMentionTokenFromAttribPairs=function(e){var n=[];return e.forEach(function(e){var t=i()(e,1)[0];/mention-token/.test(t)&&n.push(Object(p.c)(t))}),n}}return u()(t,[{key:"destroy",value:function(){this.suiteEmbedObjManager=null,this.tokenListsOfNewLines.length=0}}]),t}();function m(s,e){var c=[],u="mention-token_".concat(e);return s.getMatchedAttributePositionOnSelection(null,function(e){return e===u}).forEach(function(e){var t,n,r=e.docPosition,i=r.selStart,o=r.selZone,a=s.getRep(o||h.a).lines.atIndex(i[0]);!a||(t=a.lineNode)&&(n=t.querySelectorAll("span.".concat(u)),c.push.apply(c,l()(n)))}),c}},wvVt:function(e,t){function n(e,t,p){if(!e||"object"!=typeof e||!t||"object"!=typeof t)throw new Error("both arguments must be objects or arrays");function g(e,t,n,r){for(var i,o=Object.keys(e),a=o.length,s=Object.keys(t),c=s.length,u=0;u<a;u++)(l=o[u])in t||(i=n.concat(l),r.remove.push({op:"remove",path:p?p(i):i}));for(u=0;u<c;u++){var l,d,f=e[l=s[u]],h=t[l];l in e?f!==h&&(Object(f)===f&&Object(h)===h&&(Object.keys(f).length||Object.keys(h).length||String(f)==String(h))?g(e[l],t[l],n.concat(l),r):i=m(i,n,l,r,p,t)):(i=n.concat(l),d=t[l],r.add.push({op:"add",path:p?p(i):i,value:d}))}return r.remove.concat(r.replace).concat(r.add)}return g(e,t,[],{remove:[],replace:[],add:[]})}function m(e,t,n,r,i,o){return e=t.concat(n),r.replace.push({op:"replace",path:i?i(e):e,value:o[n]}),e}function r(e){return[""].concat(e).join("/")}e.exports={diff:n,jsonPatchPathConverter:r}},xUlX:function(e,t,n){"use strict";var d=n("twO/"),f=n("AUh1");function r(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}var h=r,p=n("ovuK"),g=n("eAQQ"),m=Array.prototype.splice;function i(e,t,n,r){var i=r?h:f.a,o=-1,a=t.length,s=e;for(e===t&&(t=Object(g.a)(t)),n&&(s=Object(d.a)(e,Object(p.a)(n)));++o<a;)for(var c=0,u=t[o],l=n?n(u):u;-1<(c=i(s,l,c,r));)s!==e&&m.call(s,c,1),m.call(e,c,1);return e}t.a=i},xetH:function(e,t,n){"use strict";var r=n("lSNA"),s=n.n(r),i=n("UXvI"),o=n("0X7r"),c=n("D7h9"),a=n("jp/M"),u=function(e){return{type:a.actionTypes.etherpad.UPDATE_DOC_PERMISSION_USER_MAP,payload:e}},l=n("HjLD");function d(){return new o.b({onPermissionChange:function(e){var a={};e.forEach(function(e){var t,n,r,i=e.permission,o=e.userId;i&&(t=i.readable,n=i.editable,f.hasUser(o)&&(a[o]=(r={},s()(r,l.a.Readable,t),s()(r,l.a.Editable,n),r)))}),c.default.dispatch(u(a))},onError:function(e){}})}n.d(t,"a",function(){return f});var f={userMap:{},userPermissionManager:null,createUserPermissionManager:function(){this.userPermissionManager=d()},destroyUserPermissionManager:function(){this.userPermissionManager&&(this.userPermissionManager.destroy(),this.userPermissionManager=null)},recreateUserPermissionManager:function(){this.destroyUserPermissionManager(),this.createUserPermissionManager()},hasUser:function(e){return this.userMap[e]},addUser:function(e){this.userMap[e]?this.userMap[e]++:(this.userMap[e]=1,this.userPermissionManagerUpdateUserList())},removeUser:function(e){this.userMap[e]&&(this.userMap[e]--,0===this.userMap[e]&&this.userPermissionManagerUpdateUserList())},updateUserPerm:function(e){this.userPermissionManager.fetchUserPermissions(e)},userPermissionManagerUpdateUserList:Object(i.default)(function(){var t=this;this.userPermissionManager&&this.userPermissionManager.updateUserList(Object.keys(this.userMap).filter(function(e){return 0<t.userMap[e]}))},300)}},xk4V:function(e,t,n){var a=n("4fRq"),s=n("I2ZF");function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||s(i)}e.exports=r},y2hG:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNzJweCIgaGVpZ2h0PSI3MnB4IiB2aWV3Qm94PSIwIDAgNzIgNzIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU5LjEgKDg2MTQ0KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT7nvJbnu4Q8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0i6aG16Z2iLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnlLvmnb8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKC05NTIuMDAwMDAwLCAtNjcxLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0i57yW57uEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5NTIuMDAwMDAwLCA2NzEuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8Y2lyY2xlIGlkPSLmpK3lnIblvaIiIGZpbGw9IiNCQkJGQzQiIGN4PSIzNiIgY3k9IjM2IiByPSIzNiI+PC9jaXJjbGU+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMzAsMzcgTDQyLDM3IEM0Ny41MjI4NDc1LDM3IDU0LDQxLjI4NTY3ODUgNTQsNDkgTDU0LDUzIEM1NCw1NC4xMDQ1Njk1IDUzLjEwNDU2OTUsNTUgNTIsNTUgTDIwLDU1IEMxOC44OTU0MzA1LDU1IDE4LDU0LjEwNDU2OTUgMTgsNTMgTDE4LDQ5IEMxOCw0MS4yOTIxNjU4IDI0LjQ3NzE1MjUsMzcgMzAsMzcgWiBNMzYsMzUgQzMwLjQ3NzE1MjUsMzUgMjYsMzAuNTIyODQ3NSAyNiwyNSBDMjYsMTkuNDc3MTUyNSAzMC40NzcxNTI1LDE1IDM2LDE1IEM0MS41MjI4NDc1LDE1IDQ2LDE5LjQ3NzE1MjUgNDYsMjUgQzQ2LDMwLjUyMjg0NzUgNDEuNTIyODQ3NSwzNSAzNiwzNSBaIiBpZD0i5b2i54q2IiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"},y7Jg:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),p=n("3Hq1"),d=n("YWBl"),g=n("aBgF"),f=n("7Kxq"),s=n("D7h9"),c=n("Kn+I"),u=n("Poi8"),l=function(){function h(e){var t=this;i()(this,h),this.className="AutoCapitalization",this.autoUppercase=!0,this.isDoReturnKey=!1,this.enabled=!0,this.editor=e,this.unsubscribe=s.default.subscribe(function(){var e=Object(c.c)(s.default.getState()).get("enable_auto_capitalize");t.enabled=1===e})}return a()(h,[{key:"destroy",value:function(){this.unsubscribe()}},{key:"doReturnKey",value:function(){this.isDoReturnKey=!0}},{key:"editorKeyDown",value:function(e,t){this.handleEditorKeyDown(t),this.isDoReturnKey=!1}},{key:"handleEditorKeyDown",value:function(e){var t,n,r,i,o,a,s,c,u,l,d,f=this;this.enabled&&(t=e.evt,Object(p.default)(t.keyCode)||(n=t.keyCode===g.c.Enter&&this.isDoReturnKey,(r=t.keyCode===g.c.Space||n)&&this.editor.callStack.inCallStackIfNecessary("fastIncorp",function(){f.editor.fastIncorp()}),(o=(i=e.rep).selStart)&&(n||this.editor.isCaret())&&(a=o[0],n&&a--,(s=i.lines.atIndex(a))&&(n&&(o=[a,s.text.length]),this.isUppercaseLine(i,o)&&(c=s.text.substring(s.lineMarker,s.text.length),u=t.metaKey||t.ctrlKey,c?this.autoUppercase&&r?(l=o[1]-s.lineMarker,this.isUppercasePosition(c,l)&&(d=this.findSentencePosition(c,l),this.shouldUppercase(d,i,a,o[1])&&(this.editor.getInInternationalComposition()||(t.preventDefault(),this.performUppercase(t.keyCode,i,o,a,c,d.sentenceIndex))))):t.keyCode===g.c.Ime||t.keyCode===g.c.Z&&u||t.keyCode===g.c.V&&u||(-1<h.CURSOR_KEY_CODE.indexOf(t.keyCode)||u?this.autoUppercase=!1:this.autoUppercase=!0):u||(this.autoUppercase=!0))))))}},{key:"aceClickEvent",value:function(){this.autoUppercase=!1}},{key:"aceAfterCompositionEnd",value:function(){this.autoUppercase=!0}},{key:"UNSAFE_editorNormalizePasteNode",value:function(){this.autoUppercase=!1}},{key:"acePaste",value:function(){this.autoUppercase=!1}},{key:"performUndoRedo",value:function(){this.autoUppercase=!1}},{key:"isUppercaseLine",value:function(e,t){var n=e.attributeManager.getAttributesOnSelection(t,t,e),r=n.attribs.some(function(e){return"lang"===e[0]||"list"===e[0]&&"code1"===e[1]}),i=n.attribs.some(function(e){return"inline-code"===e[0]&&"true"===e[1]});return!(Object(u.i)(this.editor,e.zoneId)||r||i)}},{key:"findSentencePosition",value:function(e,t){for(var n,r=h.SENTENCE_END_REG,i=e.length,o=[],a=0,s=-1,c=-1,u=r.exec(e);u;)o.push({sentence:e.substring(a,u.index),index:u.index+u[0].length}),a=u.index+u[0].length,s++,-1===c&&t<=a&&(c=s),u=r.exec(e);a<i&&(-1===c&&(c=s+1),n="",n=-1<h.END_PUNCTUATION.indexOf(e.substr(i-1,1))?e.substring(a,i-1):e.substring(a,i),o.push({sentence:n,index:i}));var l=0===c?0:o[c-1].index;return{sentence:o[c].sentence,position:t-l,sentenceIndex:l}}},{key:"isUppercasePosition",value:function(e,t){if(0<t&&t<e.length){var n=e[t-1]+e[t],r=h.SENTENCE_END_REG;if(!h.SENTENCE_SPECIAL_REG.test(n)&&("  "===n||r.test(n)))return!1}var i=this.findSentencePosition(e,t),o=i.sentence,a=i.position;return!(-1<o.substring(0,a).indexOf(" "))}},{key:"shouldUppercase",value:function(e,n,r,i){var t=e.sentence,o=e.position,a=function(){var e=[r,i-o],t=[r,i];return n.attributeManager.getAttributesOnSelection(e,t,n,!1).attribs},s=function(){return a().some(function(e){return"inline-code"===e[0]&&"true"===e[1]||e[0].startsWith("mention-token_")&&"true"===e[1]||e[0].startsWith("url-")&&void 0!==e[1]})},c=/^[a-z][a-z'-]*$/,u=new RegExp("^[a-z][a-z'-]*[".concat(h.SPECIAL_PUNCTUATION.map(function(e){return"\\"+e}).join(""),"]$"),"g"),l=t.substring(0,o);return c.test(l)?!(o>t.length&&o!==t.length+1)&&!s():!!u.test(l)&&!s()}},{key:"performUppercase",value:function(e,t,n,r,i,o){var a,s,c,u=this,l=t.lines.atIndex(r);l&&(a=o+l.lineMarker,s=[r,a],c=[r,a+1],e===g.c.Enter&&this.isDoReturnKey||this.editor.makeNewEvent("performSpace",function(){u.editor.fastIncorp();var e=t.attributeManager.getAttributesOnSelection(n,n,t,!1);u.editor.performDocumentReplaceRangeWithAttributes(t.zoneId,n,n," ",e.attribs)}),this.editor.makeNewEvent("autoUppercase",function(){u.editor.fastIncorp();var e=t.attributeManager.getAttributesOnSelection(s,c,t,!1);u.editor.performDocumentReplaceRangeWithAttributes(t.zoneId,s,c,i.substr(o,1).toUpperCase(),e.attribs)}),Object(d.a)({action:"autoCapitalization",op:f.f,source:"autoCapitalization"}))}}]),h}();l.END_PUNCTUATION=["。",".","？","?","！","!"],l.SPECIAL_PUNCTUATION=[",",".","?",":",";","'","!"],l.SENTENCE_END_REG=new RegExp("[".concat(l.END_PUNCTUATION.map(function(e){return"\\"+e}).join(""),"]\\s+"),"g"),l.SENTENCE_SPECIAL_REG=new RegExp("[".concat(l.SPECIAL_PUNCTUATION.map(function(e){return"\\"+e}).join(""),"]\\s+"),"g"),l.CURSOR_KEY_CODE=[g.c.Up,g.c.Down,g.c.Left,g.c.Right,g.c.PageUp,g.c.PageDown,g.c.Home,g.c.End]},yG8O:function(e,t){function n(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}e.exports=n},zLXu:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var s=n("OZf9"),c=n("Bw5p"),u=n("mkut"),l=n("b6qs"),d=n("HIeq"),r=n("toa8"),f=n("QM+C");function h(e){return r.d.post("/api/mention/chat.info.v2/",e,{headers:{"Content-Type":"application/json;"}}).then(function(e){return Object(s.a)(e.data,function(e){e.hasjoin=e.has_join}),e})}function i(n,e,t){var r,i,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},a=4<arguments.length?arguments[4]:void 0;e.length&&(f.isAnonymousAccess||(r=l.a.getAllCacheInfo(),i=Object(c.a)(r,e),Object(u.a)(i).length!==e.length?h({chat_ids:e,source:t,token:Object(d.e)()}).then(function(e){l.a.setCacheInfo(e.data),Object(s.a)(e.data,function(e,t){o(n,t,e,a)})}):Object(s.a)(i,function(e,t){o(n,t,e,a)})))}}}]);
//# sourceMappingURL=comment_textarea.d8b0c708a871ad6f515e.js.map