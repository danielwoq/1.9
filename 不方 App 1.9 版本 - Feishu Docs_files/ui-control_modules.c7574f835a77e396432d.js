(this.webpackJsonp=this.webpackJsonp||[]).push([["ui-control_modules","vendors--doc_collector_security_audit","vendors--modal_template_preview","vendors--template-page","vendors--template_preview_new_layout"],{"/FZm":function(e,t,n){e.exports=n("Kxu3")},"/KLm":function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return s});var r,o,i,a=n("uJCm");(o=r=r||{})[o.UPLOAD=0]="UPLOAD",o[o.IMPORT=1]="IMPORT",o[o.MIXED=2]="MIXED",i=i||{};var s=Object.assign({},a.f,{},i)},"/rwt":function(e,n,r){"use strict";(function(d){r.d(n,"a",function(){return t});var e=r("o0o1"),f=r.n(e),p=r("ucr6"),_=r("oZtI"),E=r("jJw9"),h=r("iP/4"),m=r("aR0j"),O=r("dvZ7"),y=r("Xngx"),g=f.a.mark(t);function t(){var t,n,r,o,i,a,s,c,u,l;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.select)(m.pb);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=d||h.a.isLarkWindow,r=t.type,o=t.obj_token,i=t.token,a=t.url,s=t.name,Object(O.e)({source:"list",action:"edit_online",subFileType:s?Object(y.d)(s):"",fileToken:o}),c=Object(E.processPathUrl)({type:r,objToken:o,token:i,url:a}),u=c.includes("?")?"&":"?",l="".concat(c).concat(u,"office_edit=1"),n?window.open(l):p.a.push({pathname:l});case 12:case"end":return e.stop()}},g)}}).call(this,r("kCIs"))},"/xWd":function(e,t,n){"use strict";var r=n("uT1x"),o=n("fshX");function i(e,t){return(null==e?0:e.length)?(t=void 0===t?1:Object(o.a)(t),Object(r.a)(e,t)):[]}t.a=i},"04Ix":function(e,t,n){var r=n("hdMt");function o(e,t,n){return t in e?r(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.exports=o},"04M5":function(e,t,n){"use strict";var r=n("mIMY"),o=n("QYBB"),i=n("A2Ma"),a=n("wbIY"),s=i("species");e.exports=function(e){var t=r(e),n=o.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},"093l":function(e,t,n){"use strict";function r(e){var t=!0;return function(){t?t=!1:e()}}n.d(t,"a",function(){return r})},"1a6t":function(e,t,n){"use strict";var o,r,l=n("h6S9");(r=o=o||{}).init="init",r.opened="opened",r.loaded="loaded",r.cancelled="cancelled";var i=n("7/sA"),a=n("skFV");function d(e){return e?null!=e.info?e:null!=e.code?{info:"code: ".concat(e.code)}:e.toString?{info:e.toString()}:{}:{}}function f(e){if(!e)return"unknown";if(e.specialSuite){var t=e.info;return"SpecialSuite-".concat(t.code)}return e.info}function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return e&&i.a&&/^https?:\/\//.test(e)?e.replace(/^https?:\/\/[^/]+/,a.a):e}var c=n("lwsE"),u=n.n(c),p=n("W8MJ"),_=n.n(p),E=n("sLU5"),h=n("OX8E"),m=n("093l"),O=n("Ibn6"),y=n("bdgK"),g=n("ifKl"),v=n("4TP3"),b=n("TGBA"),T=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:15;u()(this,t),this.runningPool={},this.currentRunningSize=0,this.waitingQueue=[],this.maxRunningSize=e}return _()(t,[{key:"addTask",value:function(e){this.isInRunningOrWaitingQueue(e)||(this.currentRunningSize<this.maxRunningSize?this.runTask(e):this.waitTask(e))}},{key:"runTask",value:function(e){var t=this,n=function(){t.onFinishRunningTask(e.id)};e.onLoad=n,e.onCancel=n,this.currentRunningSize++,(this.runningPool[e.id]=e).send()}},{key:"waitTask",value:function(e){var t=this;e.onCancel=function(){t.onFinishWaitingTask(e)},this.waitingQueue.push(e)}},{key:"onFinishRunningTask",value:function(e){delete this.runningPool[e],this.currentRunningSize--;var t=this.waitingQueue.shift();t&&this.runTask(t)}},{key:"onFinishWaitingTask",value:function(e){Object(v.a)(this.waitingQueue,e)}},{key:"removeAllTasks",value:function(){var t=this;0<this.waitingQueue.length&&(this.waitingQueue.forEach(function(e){e.onCancel=g.default,e.cancel()}),this.waitingQueue.length=0),0<this.currentRunningSize&&Object(b.a)(this.runningPool).forEach(function(e){e.onCancel=g.default,e.onLoad=g.default,e.cancel(),delete t.runningPool[e.id],t.currentRunningSize--})}},{key:"isInRunningOrWaitingQueue",value:function(t){var e=this.runningPool[t.id],n=this.waitingQueue.find(function(e){return e.id===t.id});return!(!e&&!n)}}]),t}(),R=n("o0o1"),S=n.n(R),C=n("lSNA"),I=n.n(C),L=n("yXPU"),N=n.n(L),w=n("Olm7"),D=n("jp/M"),k=n("toa8"),P=n("3doy"),F=function(){function e(){var t=this;u()(this,e),this.sendDatas={},this.responses={},this.getResponsePromiseCallbacks={},this.fetchs=[],this.timer=null,this.sendRequests=function(){t.timer=null;var e=Object.values(t.sendDatas).map(function(e){return t.convertSendDataToRequestSendData(e)});t.sendDatas={},t.doSendRequests(e)}}function t(e){return n.apply(this,arguments)}var n;return _()(e,[{key:"addRequest",value:function(e){var t=e.token;this.responses[t]||this.isCurrentTokenInRequest(t)||(this.sendDatas[t]=e,this.timer&&window.clearTimeout(this.timer),this.timer=window.setTimeout(this.sendRequests,100))}},{key:"getResponse",value:function(r){var o=this,e=new Promise(function(e,t){var n=o.responses[r.token];n?n.isSuccess?e(n.data):t():o.isCurrentTokenInRequest(r.token)?o.getResponsePromiseCallbacks[r.token]={resolve:e,reject:t}:(o.getResponsePromiseCallbacks[r.token]={resolve:e,reject:t},o.doSendRequests([o.convertSendDataToRequestSendData(r)]))});return e.abort=function(){var e=o.getResponsePromiseCallbacks[r.token];e&&(e.reject(),delete o.getResponsePromiseCallbacks[r.token])},e}},{key:"doSendRequests",value:(n=N()(S.a.mark(function e(t){var n,r,o,i=this;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(k.d)({url:D.apiUrls.POST_FILE_CDN_URL,method:D.apiUrls.METHOD.POST,headers:{"Content-Type":"application/json"},data:t}),this.fetchs.push({fetch:n,tokens:t.reduce(function(e,t){return Object.assign({},e,I()({},t.file_token,!0))},{})}),e.prev=2,e.next=5,n;case 5:r=e.sent,o={},r&&r.data&&r.data.forEach(function(e){o[e.file_token]=e}),t.forEach(function(e){var t=e.file_token,n=o[t];i.responses[t]={data:n,isSuccess:Boolean(n)};var r=i.getResponsePromiseCallbacks[t];r&&(n?r.resolve(n):r.reject(),delete i.getResponsePromiseCallbacks[t])}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:return e.prev=13,Object(w.a)(this.fetchs,function(e){return e.fetch===n}),e.finish(13);case 16:case"end":return e.stop()}},e,this,[[2,11,13,16]])})),t)},{key:"convertSendDataToRequestSendData",value:function(e){return{file_token:e.token,width:e.width,height:e.height,policy:P.PostFileCdnUrlPolicy.allow_up}}},{key:"isCurrentTokenInRequest",value:function(t){return Boolean(this.sendDatas[t]||this.fetchs.find(function(e){return e.tokens[t]}))}},{key:"reset",value:function(){this.fetchs.forEach(function(e){e.fetch.abort()}),this.fetchs=[],this.sendDatas={},this.responses={},this.timer&&window.clearTimeout(this.timer)}}]),e}();function x(e,t){var n="function"==typeof e?e():e;return void 0!==n?n:t}var M=function(){function o(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};u()(this,o),this.isStoppedFetchImgSrc=!1,this.viewportParam={},this.scrollEvent=E.a.PC.DRIVE.GridView.gridScroll,this.resizeEvent=E.a.PC.DRIVE.GridView.gridResize,this.onResizeEnd=function(){n.isStoppedFetchImgSrc=!1,h.a.emit(n.resizeEvent)},this.onScrollEnd=function(){n.isStoppedFetchImgSrc=!1,h.a.emit(n.scrollEvent)},this.onScrollStart=function(){n.isStoppedFetchImgSrc=!0},this.onResizeStart=function(){n.isStoppedFetchImgSrc=!0,n.parallelRequestKeyManager.reset()},this.toggleBindEvent=function(e,t){t?n.bindEvent(e):n.unbindEvent()};var t=e.scrollEvent,r=e.resizeEvent;this.fetchImgSrcTaskQueue=new T,this.parallelRequestKeyManager=new F,t&&(this.scrollEvent=t),r&&(this.resizeEvent=r)}return _()(o,[{key:"bindEvent",value:function(e){this.resizeEventRemover=this.detectResizeEvent(e,this.onResizeStart,this.onResizeEnd),this.scrollEventRemover=this.detectScrollEvent(e,this.onScrollStart,this.onScrollEnd)}},{key:"unbindEvent",value:function(){this.resizeEventRemover&&this.resizeEventRemover.removeEvent(),this.scrollEventRemover&&this.scrollEventRemover.removeEvent()}},{key:"isInViewport",value:function(e){if(!e)return!1;var t={top:0,bottom:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},n=x(this.viewportParam.top,t.top),r=x(this.viewportParam.bottom,t.bottom),o=e.getBoundingClientRect(),i=o.top,a=o.bottom;return!(!i&&!a)&&(n<=a&&i<=r)}},{key:"setViewportParam",value:function(e){this.viewportParam=e}},{key:"removeAllTasks",value:function(){this.fetchImgSrcTaskQueue.removeAllTasks(),this.parallelRequestKeyManager.reset()}},{key:"detectScrollEvent",value:function(e,t,n){var r=new j(t,n);return e.addEventListener("scroll",r.handleEvent,!!O.a&&{passive:!0}),{removeEvent:function(){r.destroyEvent(),e.removeEventListener("scroll",r.handleEvent)}}}},{key:"detectResizeEvent",value:function(e,t,n){var r=new j(t,n),o=new y.default(Object(m.a)(r.handleEvent));return o.observe(e),{removeEvent:function(){r.destroyEvent(),o.disconnect()}}}}]),o}(),j=function(){function r(e,t){var n=this;u()(this,r),this.handleEvent=function(){window.clearTimeout(n.isEventProcessing),n.isEventProcessing||n.onStart(),n.isEventProcessing=window.setTimeout(function(){n.isEventProcessing=void 0,n.onEnd()},200)},this.onStart=e,this.onEnd=t}return _()(r,[{key:"destroyEvent",value:function(){this.isEventProcessing&&window.clearTimeout(this.isEventProcessing)}}]),r}(),U=n("fp5s"),B=n("mbpr"),V=n("lAOT"),H=function(){function t(e){var n=this;u()(this,t),this.state=o.init,this.onCancel=g.default,this.onLoad=g.default,this.cancelSource=V.b.source(),this.logger=new B.a,this.wrapWithCancel=function(t){return function(e){if(n.isCancelled())throw new Error;return t(e)}},this.id=e||Object(U.a)("_FetchImgSrcTask_")}return _()(t,[{key:"setState",value:function(e){this.state=e}},{key:"getLog",value:function(){return this.logger.getLog()}},{key:"isCancelled",value:function(){return this.state===o.cancelled}},{key:"open",value:function(e){var n=this,r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return this.sendData=e,this.setState(o.opened),this.logger.logStartTime("display_time_cost"),this.logger.logStartTime("queue_time_cost"),new Promise(function(e,t){n.resolve=e,n.reject=t,r&&n.send()})}},{key:"send",value:function(){var t=this;if(this.state!==o.opened)throw new Error("cannot start fetch when state is not ".concat(o.opened));this.logger.logEndTime("queue_time_cost"),this.logger.logStartTime("request_time_cost"),this.doSend().then(function(e){t.load(e)}).catch(function(e){t.fail(e)})}},{key:"load",value:function(e){this.logger.logEndTime("request_time_cost"),this.logger.logEndTime("display_time_cost"),this.logger.sendLog("client_grid_cover_load"),this.resolve&&this.resolve(e),this.setState(o.loaded),this.onLoad()}},{key:"fail",value:function(e){this.reject&&this.reject(e),e&&Object(V.c)(e)||(this.setState(o.loaded),this.onLoad(),this.logger.logValue("request_img_fail",!0),this.logger.logValue("request_img_fail_reason",f(e)),this.logger.sendLog("client_grid_cover_load"))}},{key:"cancel",value:function(){this.fail(new V.a),this.setState(o.cancelled),this.onCancel(),this.cancelSource.cancel()}}]),t}(),W=n("a1gu"),Y=n.n(W),K=n("Nsbk"),z=n.n(K),q=n("7W2i"),X=n.n(q),J=n("7EGn"),Q=n("AESI"),Z=n("ahx2"),$=n("rLED"),ee=n("2IHA"),te=n("D1oa"),ne={"use-new-default-thumbnail":"true"};function re(e){var i=e.url,a=e.key,s=e.cancelToken,c=e.logger,u=!1;return new Promise(function(n,r){c&&(c.logValue("request_suite_necessary",!0),c.logStartTime("request_suite_time_cost"));var t=Object(k.d)({url:i,params:{adapter:"front"},headers:Object.assign({},Object($.P)()&&ne),responseType:"arraybuffer",withCredentials:!0,ignoreInterceptors:!0});function e(t){return function(e){if(u)throw new Error;return t(e)}}s&&s.promise.then(function(e){r(e),t.abort(),u=!0});var o=!1;t.then(function(e){var t=e.headers,n=e.data;if(c&&c.logEndTime("request_suite_time_cost"),o=!!t["access-new-default-thumbnail"],t["content-type"].includes("json")){var r=JSON.parse(Object(te.b)(n));if(Z.SpecitalSuiteCodeList.includes(r.code))throw{specialSuite:!0,info:r};if(r.code===Z.STATUS_CODE.FORBIDDEN)throw{noPermitted:!0,info:"no permission"};throw{info:"[".concat(r.code,"]").concat(r.msg)}}return c&&(c.logValue("size",n.byteLength),c.logValue("decrypt_necessary",!0),c.logStartTime("decrypt_time_cost")),Object(ee.d)(a,ee.b["SHA-256"]).then(function(e){return Object(ee.c)(n.slice(16),e.slice(0,32),n.slice(0,16),ee.a["AES-CBC"])})}).then(e(function(e){c&&c.logEndTime("decrypt_time_cost");var t=Object(te.a)(e);n(Object.assign({},t,{isIcon:o}))})).catch(function(e){var t,n;u||(t=d(e),c&&(n=f(t),c.getLogValue("decrypt_necessary")?(c.logValue("decrypt_fail",!0),c.logValue("decrypt_fail_reason",n)):(c.logValue("request_suite_failed",!0),c.logValue("request_suite_fail_reason",n))),r(t))})})}function oe(o){var i=o.url,a=o.key,s=o.iv,c=o.cancelToken,u=o.logger,l=!1;return new Promise(function(n,r){u&&(u.logValue("request_cdn_necessary",!0),u.logStartTime("request_cdn_time_cost"));var t=Object(k.d)({url:i,responseType:"arraybuffer",withCredentials:!1,ignoreInterceptors:!0,timeout:o.timeout});function e(t){return function(e){if(l)throw new Error;return t(e)}}c&&c.promise.then(function(e){r(e),t.abort(),l=!0}),t.then(function(e){var t=e.data;return u&&(u.logEndTime("request_cdn_time_cost"),u.logValue("size",t.byteLength),u.logValue("decrypt_necessary",!0),u.logStartTime("decrypt_time_cost")),Object(ee.c)(t,window.atob(a),window.atob(s),ee.a["AES-GCM"])}).then(e(function(e){u&&u.logEndTime("decrypt_time_cost");var t=Object(te.a)(e);n(t)})).catch(function(e){var t,n;l||(t=d(e),u&&(n=f(t),u.getLogValue("decrypt_necessary")?(u.logValue("decrypt_fail",!0),u.logValue("decrypt_fail_reason",n)):(u.logValue("request_cdn_fail",!0),u.logValue("request_cdn_fail_reason",n))),r(t))})})}var ie=function(e){function t(){return u()(this,t),Y()(this,z()(t).apply(this,arguments))}function n(e,t,n){return r.apply(this,arguments)}var r,o;function i(){return o.apply(this,arguments)}return X()(t,e),_()(t,[{key:"doSend",value:(o=N()(S.a.mark(function e(){var t,n,r,o,i,a,s,c;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.sendData,n=t.token,r=t.type,o=t.hash,this.logger.setNotSendLog(!0),e.next=4,this.getThumbnail(n,r,o);case 4:return i=e.sent,e.next=7,re({url:i.thumbnail,key:i.decrypt_key,cancelToken:this.cancelSource.token,logger:this.logger});case 7:return a=e.sent,s=a.blobUrl,c=a.isIcon,e.abrupt("return",{src:s,isIcon:c});case 11:case"end":return e.stop()}},e,this)})),i)},{key:"getThumbnail",value:(r=N()(S.a.mark(function e(t,n,r){var o,i,a;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.sendData.thumbnail,this.isCorrectThumbnail(o))return e.abrupt("return",Object.assign({},o,{thumbnail:s(o.thumbnail)}));e.next=3;break;case 3:return e.prev=3,e.next=6,Object(k.d)({url:Q.GET_THUMBNAIL_URL,method:"GET",params:Object.assign({obj_type:n,obj_token:t},r?{hash:r}:null)});case 6:if(i=e.sent,a={thumbnail:s(Object(J.default)(i,"data.url")),decrypt_key:Object(J.default)(i,"data.decrypt_key")},this.isCorrectThumbnail(a)){e.next=10;break}throw new Error("thumbnail info error");case 10:return e.abrupt("return",a);case 13:throw e.prev=13,e.t0=e.catch(3),e.t0&&e.t0.code===Z.STATUS_CODE.FORBIDDEN&&(e.t0={noPermitted:!0,info:"no permission"}),d(e.t0);case 18:case"end":return e.stop()}},e,this,[[3,13]])})),n)},{key:"isCorrectThumbnail",value:function(e){return Boolean(e&&e.thumbnail&&e.decrypt_key)}}]),t}(H),ae=n("QILm"),se=n.n(ae),ce=n("6omo"),ue=function(e){function t(){return u()(this,t),Y()(this,z()(t).apply(this,arguments))}function n(e){return r.apply(this,arguments)}var r,o;function i(){return o.apply(this,arguments)}return X()(t,e),_()(t,[{key:"doSend",value:(o=N()(S.a.mark(function e(){var t;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.setNotSendLog(!0),e.next=3,this.getCdnUrl(this.sendData);case 3:return t=e.sent,e.abrupt("return",oe({url:t.url,key:t.secret,iv:t.nonce,cancelToken:this.cancelSource.token,logger:this.logger}).then(function(e){return{src:e.blobUrl,isIcon:!1}}));case 5:case"end":return e.stop()}},e,this)})),i)},{key:"getCdnUrl",value:(r=N()(S.a.mark(function e(t){var n,r,o,i,a,s,c,u;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.token,r=t.width,o=t.height,i=t.policy,a=void 0===i?l.a.NEAR:i,s=this.sendData.cdnUrl,this.isCorrectCdnUrl(s))return e.abrupt("return",s);e.next=4;break;case 4:return e.prev=4,e.next=7,Object(k.d)({url:Q.FETCH_BOX_FILE_CDN_URL,method:Q.METHOD.POST,headers:{"Content-Type":"application/json"},data:[{file_token:n,width:r,height:o,policy:a}]});case 7:if(c=e.sent,u=Object(J.default)(c,"data[0]",{}),this.isCorrectCdnUrl(u)){e.next=11;break}throw new Error("thumbnail info error");case 11:return e.abrupt("return",u);case 14:throw e.prev=14,e.t0=e.catch(4),e.t0&&e.t0.code===Z.STATUS_CODE.FORBIDDEN&&(e.t0={noPermitted:!0,info:"no permission"}),d(e.t0);case 19:case"end":return e.stop()}},e,this,[[4,14]])})),n)},{key:"isCorrectCdnUrl",value:function(e){return Boolean(e&&e.url&&e.secret&&e.nonce)}}]),t}(H),le=function(e,t){var n=t.uniqueId,r=e===ce.n.THUMBNAIL?new ie("FetchCoverSrc_".concat(n)):new ue("FetchCdnSrc_".concat(n));return r},de=function(e){var t=e.fetchImgSrcManager,n=e.fetchType,r=se()(e,["fetchImgSrcManager","fetchType"]),o=le(n,r),i=o.open(r,!1);t?t.fetchImgSrcTaskQueue.addTask(o):o.send();var a=i;return a.task=o,a};n.d(t,"a",function(){return M}),n.d(t,"b",function(){return de})},"2IHA":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s});var r,o,i,u=n("gSGL"),l=n("D1oa"),d=Boolean(window.crypto&&window.crypto.subtle);function a(i,a,s,c){return new Promise(function(e,t){var n,r,o;d?(n=window.crypto.subtle,r=Object(u.a)(a)?Object(l.c)(a):a,o=Object(u.a)(s)?Object(l.c)(s):s,n.importKey("raw",r,c,!1,["decrypt"]).then(function(e){return n.decrypt({name:c,iv:o,tagLength:128},e,i)}).then(e).catch(t)):t(new Error("web crypto not support for decrypt"))})}function s(o,i){return new Promise(function(e,t){var n,r;d?(n=window.crypto.subtle,r=Object(u.a)(o)?Object(l.c)(o):o,n.digest(i,r).then(e)):t(new Error("web crypto not support for digest"))})}(o=r=r||{})["AES-GCM"]="AES-GCM",o["AES-CBC"]="AES-CBC",(i=i||{})["SHA-256"]="SHA-256"},"2fOL":function(e,t,n){var r=n("b42z"),o=n("C3ug");e.exports=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return r(t.call(e))}},"3b8Q":function(e,t,n){"use strict";function r(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return{type:e.type,token:e.token,obj_token:e.obj_token,url:e.url||"",checkedInList:t,fatherToken:e.fatherToken,fatherType:e.fatherType}}n.d(t,"a",function(){return r})},"3doy":function(e,t,n){"use strict";n.r(t);var r,o,i=n("lSNA"),a=n.n(i),s=n("RIqP"),c=n.n(s),u=n("BmhO"),l=n("QM+C"),d=n("ahx2"),f=n("hNo0");(o=r=r||{}).ADD="ADD",o.TASK_PROGRESS="TASK_PROGRESS",o.FILE_PROGRESS="FILE_PROGRESS",o.SUCCESS="SUCCESS",o.ERROR="ERROR",o.CANCEL="CANCEL",o.CANCEL_ALL="CANCEL_ALL",o.PAUSE="PAUSE",o.PAUSE_ALL="PAUSE_ALL",o.PENDING="PENDING";var p,_,E,h,m,O,y,g,v,b,T,R,S,C,I,L,N,w,D,k,P,F,x=n("658s");n.d(t,"BoxUploadStatus",function(){return _}),n.d(t,"BoxDownloadStatus",function(){return h}),n.d(t,"BoxLarkUploadStatus",function(){return O}),n.d(t,"CallerType",function(){return g}),n.d(t,"RegenerateType",function(){return v}),n.d(t,"RedirectType",function(){return T}),n.d(t,"PreviewRightPanelType",function(){return S}),n.d(t,"VersionPreviewType",function(){return I}),n.d(t,"WarningType",function(){return N}),n.d(t,"FileErrorType",function(){return D}),n.d(t,"PostFileCdnUrlPolicy",function(){return P}),n.d(t,"PDFPreviewTypes",function(){return V}),n.d(t,"mountPointTypeMap",function(){return H}),n.d(t,"IOMessageDataType",function(){return M}),n.d(t,"CommentType",function(){return U}),n.d(t,"FeedToolbarHiddenWidth",function(){return z}),n.d(t,"COMPLETE_DELETE_CALLER",function(){return W}),n.d(t,"NoteMetaSyncTypes",function(){return Y}),n.d(t,"MountPointType",function(){return f.a}),n.d(t,"ACTION",function(){return r}),n.d(t,"NEW_FILE_VERSION_SOURCE",function(){return x.a}),(E=_=_||{}).PENDING="pending",E.UPLOADING="uploading",E.SUCCESS="success",E.ERROR="error",E.PAUSE="pause",(m=h=h||{}).PENDING="downloadPending",m.DOWNLOADING="downloading",m.SUCCESS="downloadSuccess",m.ERROR="downloadError",m.PAUSE="downloadPause",(y=O=O||{}).PENDING="uploadPending",y.UPLOADING="uploading",y.CONVERTING="importConverting",y.SUCCESS="uploadSuccess",y.ERROR="uploadError",y.PAUSE="uploadPause",(g=g||{}).EXPLORER="explorer",(b=v=v||{})[b.DEFAULT=0]="DEFAULT",b[b.MANUAL=1]="MANUAL",(R=T=T||{})[R.OFF=0]="OFF",R[R.ON=1]="ON",(C=S=S||{}).Comment="Comment",C.FileInfo="FileInfo",(L=I=I||{}).Revert="Revert",L.Download="Download",L.Delete="Delete",(w=N=N||{})[w.ColumnCut=1]="ColumnCut",w[w.CellCut=2]="CellCut",w[w.ColumnAndCellCut=3]="ColumnAndCellCut",(k=D=D||{})[k.Other=1]="Other",k[k.NumLimited=88]="NumLimited",k[k.UnknownProblem=100]="UnknownProblem",k[k.xmlVersionNotSupport=101]="xmlVersionNotSupport",k[k.FileEncrypted=102]="FileEncrypted",k[k.ForderNumLimited=4001]="ForderNumLimited",k[k.SizeLimited=9004]="SizeLimited",k[k.EmptyFile=9011]="EmptyFile",k[k.FolderNodeLimited=d.NODE_OUT_OF_LIMIT_BY_EXPLORER_ERROR_CODE]="FolderNodeLimited",(F=P=P||{}).equal="equal",F.near="near",F.allow_up="allow_up",F.allow_down="allow_down";var M,j,U,B,V=[u.s.PDF].concat(c()(u.F),c()(u.G),c()(u.B),c()(u.H)),H=(p={},a()(p,l.NUM_FILE_TYPE.DOC,f.a.DOC),a()(p,l.NUM_FILE_TYPE.BITABLE,f.a.BITABLE),a()(p,f.a.BITABLE,f.a.BITABLE),p);(j=M=M||{}).USER_NEWINFO="USER_NEWINFO",j.USER_LEAVE="USER_LEAVE",j.ROOM_MEMBERS="ROOM_MEMBERS",j.USER_CHANGES="USER_CHANGES",j.MESSAGE_CHANNEL="MESSAGE_CHANNEL",j.PUSH_COMMENT="driveCommonPushChannel",j.DELETE_FILE_VERSION="DELETE_FILE_VERSION",j.UPLOAD_FILE_VERSION="UPLOAD_FILE_VERSION",j.UPDATE_FILE_META="UPDATE_FILE_META",(B=U=U||{})[B.RECT=1]="RECT",B[B.OLD=2]="OLD",B[B.FULL=3]="FULL",B[B.TEXT=4]="TEXT";var W,Y,K,z=300;(W=W||{}).STORAGE_CENTER="quota_center",(K=Y=Y||{}).USER_CHANGES="USER_CHANGES",K.ACCEPT_COMMIT="ACCEPT_COMMIT",K.NEW_CHANGES="NEW_CHANGES"},"49sm":function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},"4TP3":function(e,t,n){"use strict";var r=n("LV2V"),o=n("qMRW"),i=Object(r.a)(o.a);t.a=i},"5ydi":function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"b",function(){return m}),n.d(t,"c",function(){return O}),n.d(t,"a",function(){return y}),n.d(t,"d",function(){return g});var r,o,i=n("lwsE"),a=n.n(i),s=n("a1gu"),c=n.n(s),u=n("Nsbk"),l=n.n(u),d=n("7W2i"),f=n.n(d),p=n("Mpt7"),_=n("658s");(o=r=r||{})[o.NewVersion=1]="NewVersion",o[o.RenameFile=2]="RenameFile",o[o.DeleteVersion=3]="DeleteVersion",o[o.RestoreVersion=4]="RestoreVersion";var E={version:"",edit_uid:"",edit_time:0},h={name:"",size:0,tag:0},m=function(e){function t(){return a()(this,t),c()(this,l()(t).apply(this,arguments))}return f()(t,e),t}(Object(p.Record)(Object.assign({type:r.NewVersion},E,{},h,{data_version:"",is_deleted:!1,user_source:_.a.OTHER}))),O=function(e){function t(){return a()(this,t),c()(this,l()(t).apply(this,arguments))}return f()(t,e),t}(Object(p.Record)(Object.assign({type:r.RenameFile},E,{name:"",source_tag:0}))),y=function(e){function t(){return a()(this,t),c()(this,l()(t).apply(this,arguments))}return f()(t,e),t}(Object(p.Record)(Object.assign({type:r.DeleteVersion},E,{source_tag:0,source_name:""}))),g=function(e){function t(){return a()(this,t),c()(this,l()(t).apply(this,arguments))}return f()(t,e),t}(Object(p.Record)(Object.assign({type:r.RestoreVersion},E,{},h,{source_tag:0,data_version:"",is_deleted:!1})))},"61Ik":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={word:1,excel:2,ppt:3}},"658s":function(e,t,n){"use strict";var r,o;n.d(t,"a",function(){return r}),(o=r=r||{})[o.WEB=0]="WEB",o[o.CLIENT=1]="CLIENT",o[o.ANDRIOD=2]="ANDRIOD",o[o.IOS=3]="IOS",o[o.LARK=4]="LARK",o[o.OTHER=5]="OTHER",o[o.SYNC_DISK=6]="SYNC_DISK",o[o.WPS=7]="WPS"},"6IgM":function(e,t,n){"use strict";n.d(t,"o",function(){return u}),n.d(t,"s",function(){return l}),n.d(t,"n",function(){return d}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"t",function(){return _}),n.d(t,"e",function(){return E}),n.d(t,"j",function(){return h}),n.d(t,"q",function(){return m}),n.d(t,"a",function(){return O}),n.d(t,"u",function(){return y}),n.d(t,"r",function(){return g}),n.d(t,"k",function(){return v}),n.d(t,"i",function(){return b}),n.d(t,"f",function(){return T}),n.d(t,"b",function(){return R}),n.d(t,"h",function(){return S}),n.d(t,"p",function(){return C}),n.d(t,"g",function(){return I}),n.d(t,"l",function(){return L}),n.d(t,"m",function(){return N});var r=n("o0o1"),o=n.n(r),i=n("yXPU"),a=n.n(i),s=function(){console.error("No Moirae Instance")},c=function(e){console.error("No Toast Instance")},u={teaLog:s,ravenCatch:s,suspend:s,resume:s},l={show:c,info:c,success:c,error:c,remove:c,removeAll:c,destroy:c},d={askUserShouldDelEmptyCellsAndContinuePaste:function(){var e=a()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.error("No askUserShouldDelEmptyCellsAndContinuePaste Instance"),e.abrupt("return",!1);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),showCopyDataOutdatedModal:function(){console.error("No showCopyDataOutdatedModal Instance")},showPastePageOutdatedModal:function(){console.error("No showPastePageOutdatedModal Instance")}},f=function(){console.error("No CollectSuiteEvent Instance")},p=function(){console.error("No CollectToAdmin Instance")},_=function(){console.error("No TransformPerformanceData Instance")},E=function(){return console.error("No EncryptTea Instance"),""},h=function(){return console.error("No GetFileType Instance"),""},m=function(){return console.error("No PrependSpace Instance"),""},O=function(){return console.error("No BeforeCopy Instance"),!1},y=function(){return console.error("No isLarkProduct Instance"),!1},g=function(e){return console.error("No ReplaceImageDataSrc Instance"),e},v=function(){return console.error("No GetSegmentArray Instance"),{}},b=function(){return console.error("No GetCustomIconUrl Instance"),""},T=function(){console.error("No GenerateEditorValue Instance")},R={setIsSsd:function(){console.log("No CollectLoadPerformance Instance")},setLoadStartTime:function(){console.log("No CollectLoadPerformance Instance")},getLoadStartTime:function(){console.log("No CollectLoadPerformance Instance")},setBlockCount:function(e){console.log("No CollectLoadPerformance Instance")},collectData:function(e,t){console.log("No CollectLoadPerformance Instance")}},S=function(){return!1},C={updateStage:function(){console.error("No PerformanceStageCollector Instance")},renderFail:function(){console.error("No PerformanceStageCollector Instance")}},I=function(){return console.error("no getCellLimit instance"),0},L=function(){return console.error("no getSheetCopyDataVersion instance"),0},N=function(){return console.error("no getSheetDropdown2DataValidationEnable instance"),!1}},"6omo":function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"f",function(){return k}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"j",function(){return l}),n.d(t,"n",function(){return f}),n.d(t,"l",function(){return _}),n.d(t,"o",function(){return h}),n.d(t,"a",function(){return O}),n.d(t,"i",function(){return g}),n.d(t,"d",function(){return b}),n.d(t,"p",function(){return R}),n.d(t,"g",function(){return C}),n.d(t,"m",function(){return L}),n.d(t,"k",function(){return w});var r,o,i=n("QM+C");(o=r=r||{})[o.ALL_TYPES=0]="ALL_TYPES",o[o.DOC=i.NUM_SUITE_TYPE.DOC]="DOC",o[o.SHEET=i.NUM_SUITE_TYPE.SHEET]="SHEET",o[o.MINDNOTE=i.NUM_SUITE_TYPE.MINDNOTE]="MINDNOTE";var a,s,c,u,l,d,f,p,_,E,h,m,O,y,g,v,b,T,R,S,C,I,L,N,w,D,k=0;(s=a=a||{})[s.OWN=5]="OWN",s[s.SHARE=6]="SHARE",(u=c=c||{})[u.TENANT=7]="TENANT",(d=l=l||{}).GALLERY="gallery",d.CUSTOM="custom",d.CORPORATE="corporate",(p=f=f||{})[p.WALLPAPER=1]="WALLPAPER",p[p.THUMBNAIL=2]="THUMBNAIL",p[p.SCREENSHOT=3]="SCREENSHOT",(E=_=_||{})[E.HEAT=1]="HEAT",E[E.CREATE_BY_MYSELF=2]="CREATE_BY_MYSELF",E[E.SHARED_BY_USER=3]="SHARED_BY_USER",(m=h=h||{})[m.GALLERY=1]="GALLERY",m[m.CUSTOM=2]="CUSTOM",m[m.CORPORATE=3]="CORPORATE",(y=O=O||{})[y.TEMPLATE=1]="TEMPLATE",y[y.TOPIC=2]="TOPIC",(v=g=g||{})[v.GALLERY=1]="GALLERY",v[v.CUSTOM=2]="CUSTOM",v[v.CORPORATE=3]="CORPORATE",(T=b=b||{})[T.CREATE_BY_MYSELF=1]="CREATE_BY_MYSELF",T[T.SHARED_BY_USER=2]="SHARED_BY_USER",(S=R=R||{})[S.V3=3]="V3",S[S.V4=4]="V4",(I=C=C||{}).INIT="INIT",I.PENDING="PENDING",I.SUCCESS="SUCCESS",I.FAILED="FAILED",I.SPECIAL_ICON="SPECIAL_ICON",(N=L=L||{}).BANNER="templatecenter_banner",N.SEARCH="templatecenter_searchresult",N.NORMAL="templatecenter_normalcreate",(D=w=w||{}).USE_BUTTON="use_button",D.PICTURE="picture",D.PREVIEW="from_preview"},"8LbN":function(e,n,r){"use strict";(function(v){r.d(n,"b",function(){return t}),r.d(n,"a",function(){return H});var e=r("o0o1"),b=r.n(e),T=r("oZtI"),R=r("L342"),S=r("jp/M"),i=r("XMIC"),a=r("jryj"),C=r("QM+C"),_=r("nLXU"),E=r("jqWJ"),h=r("61Ik"),I=r("iP/4"),L=r("VIFs"),N=r("5dbN"),s=r("rAc3"),c=r("LCeV"),u=r("Y0Lu"),w=r("GIKb"),D=r("dP4c"),k=r("ZGZ5"),P=r("aR0j"),F=r("/PhZ"),x=r("nYlk"),M=r("aXiW"),m=r("xiBh"),O=b.a.mark(t),l=b.a.mark(B),j=b.a.mark(H),f=b.a.mark(W),y=b.a.mark(Y),d=b.a.mark(K),p=b.a.mark(z),g="CREATE_",U=[_.d.CREATE_DOC,_.d.CREATE_SHEET,_.d.CREATE_SLIDE,_.d.CREATE_BITABLE,_.d.CREATE_MINDNOTE];function t(t){var n,r,o,i,a,s,c,u,l,d,f,p;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.payload,r=n.createType,o=n.isCtrlOrMetaKeyClicked,i=n.path,a=n.type,s=n.objType,c=n.isFromTemplateCenter,-1<C.suiteType.indexOf(r))return e.next=4,H({type:a,createType:r,isCtrlOrMetaKeyClicked:o,path:i,isFromTemplateCenter:c});e.next=5;break;case 4:return e.abrupt("return",e.sent);case 5:if(U.includes(a))return u=C.mapFileType2TypeNum[a.slice(g.length).toLowerCase()],e.next=9,H({type:a,createType:u,isCtrlOrMetaKeyClicked:o,path:i,isFromTemplateCenter:c});e.next=10;break;case 9:return e.abrupt("return",e.sent);case 10:if(-1<C.folderType.indexOf(r)||a===_.d.CREATE_SUB_FOLDER)return e.next=13,z(t);e.next=14;break;case 13:return e.abrupt("return");case 14:if(C.templateType.includes(r)||a===_.d.CREATE_BY_TEMPLATE)return e.next=17,Object(m.a)({createType:r,isCtrlOrMetaKeyClicked:o,path:i,objType:s});e.next=18;break;case 17:return e.abrupt("return");case 18:if(_.d.CREATE_ISV!==a){e.next=29;break}if(l=t.payload,d=l.data,f=l.source,p={data:d,isCtrlOrMetaKeyClicked:o,path:i,source:f},d.isvType===E.a.WPS)return e.next=24,Y(p);e.next=26;break;case 24:e.next=28;break;case 26:return e.next=28,W(p);case 28:return e.abrupt("return");case 29:case"end":return e.stop()}},O)}function B(t){var n,r,o,i,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.path,Object(u.d)(n))return e.next=4,Object(T.select)(P.qb);e.next=7;break;case 4:return r=e.sent,o=r.token,e.abrupt("return",o);case 7:return e.next=9,Object(T.select)(P.s);case 9:return i=e.sent,a=Object(c.a)(i.toJS()),e.abrupt("return",a);case 12:case"end":return e.stop()}},l)}function V(){return Object(N.isUnderHomeRoute)()?C.FILE_SOURCE.SPACE_HOME_CREATE:Object(N.isUnderMeRoute)()?C.FILE_SOURCE.SPACE_PERSNOAL_CREATE:Object(N.isUnderShareFolderHomeRoute)()?C.FILE_SOURCE.SPACE_SHARED_CREATE:Object(N.isUnderSuiteView)()?C.FILE_SOURCE.DETAIL_CREATE:""}function H(t){var n,r,o,i,a,s,c,u,l,d,f,p,_,E,h,m,O,y,g;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.createType,r=t.isCtrlOrMetaKeyClicked,o=t.isFromTemplateCenter,e.next=4,B(t);case 4:return i=e.sent,r&&!v&&(a=window.open("")),e.next=8,Object(T.select)(P.y);case 8:return s=e.sent,c=s.get(i),u=Object(w.a)(c),e.next=13,Object(T.put)(Object(F.createFile)(u,i,n));case 13:return e.next=15,Object(T.race)({success:Object(T.take)(S.actionTypes.explorer.CREATE_FILE_SUCCESS),failed:Object(T.take)(S.actionTypes.explorer.CREATE_FILE_FAIL),cancelled:Object(T.take)(S.actionTypes.explorer.CREATE_FILE_CANCEL)});case 15:if(l=e.sent,d=l.success,f=l.failed,p=l.cancelled,f||p)return e.abrupt("return");e.next=21;break;case 21:return _=d.payload,E=_.obj_token,h=_.type,e.prev=22,e.next=25,Object(T.select)(k.a);case 25:m=e.sent,Object(M.a)("create_new_objs").report({file_id:E,file_type:C.mapTypeNumToFileType[h],open_type:r?"new_tab":"parent",create_uid:m?m.get("id"):"",create_time:Date.now(),create_source:""}),o&&Object(M.a)("create_from_template_center").reportWithoutClear({file_id:E,file_type:C.mapTypeNumToFileType[h]}),e.next=33;break;case 30:e.prev=30,e.t0=e.catch(22),console.error(e.t0);case 33:if(O=V(),y=Object(L.prependSpace)("/".concat(C.FILE_TYPE_URL_MAP[h],"/").concat(E)),g=d.payload.url,!r){e.next=40;break}v?window.open(g):(a.location.href=g,a=null),e.next=46;break;case 40:if(!I.a.isLarkPhone){e.next=44;break}Object(D.c)(g,!1,!0),e.next=46;break;case 44:return e.next=46,Object(T.put)(Object(R.b)({pathname:y,state:{from:O}}));case 46:if(Object(N.isUnderSuiteView)())return e.next=49,Object(T.put)(Object(x.e)());e.next=49;break;case 49:return e.abrupt("return",d.payload);case 52:e.prev=52,e.t1=e.catch(0),console.error(e.t1);case 55:case"end":return e.stop()}},j,null,[[0,52],[22,30]])}function W(t){var n,r,o,i,a,s,c,u,l,d;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,r=t.source,o=n.appId,e.next=4,B(t);case 4:return i=e.sent,a=window.open(""),e.next=8,Object(T.put)(Object(F.createISV)(o,i));case 8:return e.next=10,Object(T.race)({success:Object(T.take)(S.actionTypes.explorer.CREATE_ISV_SUCCESS),failed:Object(T.take)(S.actionTypes.explorer.CREATE_ISV_FAIL),cancelled:Object(T.take)(S.actionTypes.explorer.CREATE_ISV_CANCEL)});case 10:if(s=e.sent,c=s.success,u=s.failed,l=s.cancelled,u||l)return e.abrupt("return");e.next=16;break;case 16:return e.next=18,K(C.FILE_TYPE.ISV,o,r);case 18:d=c.payload.url,v?window.open(d):(a.location.href=d,a=null);case 20:case"end":return e.stop()}},f)}function Y(t){var n,r,o,i,a,s,c,u,l,d,f,p;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.source,e.next=3,B(t);case 3:return r=e.sent,o=window.open(""),e.next=7,Object(T.put)(Object(F.createDriveFile)({type:h.a.ppt,parentToken:r}));case 7:return e.next=9,Object(T.race)({success:Object(T.take)(S.actionTypes.explorer.CREATE_DRIVE_FILE_SUCCESS),failed:Object(T.take)(S.actionTypes.explorer.CREATE_DRIVE_FILE_FAIL),cancelled:Object(T.take)(S.actionTypes.explorer.CREATE_DRIVE_FILE_CANCEL)});case 9:if(i=e.sent,a=i.success,s=i.failed,c=i.cancelled,s||c)return e.abrupt("return");e.next=15;break;case 15:return u=a.payload,l=u.url,d=u.obj_token,e.next=18,K(C.FILE_TYPE.FILE,"wps_ppt",n,d);case 18:f=l.includes("?")?"&":"?",p="".concat(l).concat(f,"office_edit=1"),v?window.open(p):(o.location.href=p,o=null);case 21:case"end":return e.stop()}},y)}function K(t,n,r,o){var i;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(T.select)(k.a);case 3:i=e.sent,Object(M.a)("create_new_objs").report({file_id:o,file_type:t,isv_id:n,create_uid:i?i.get("id"):"",create_time:Date.now(),create_source:r}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},d,null,[[0,7]])}function z(t){var n,r,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},t.payload.type===_.d.CREATE_SUB_FOLDER)return e.next=5,Object(T.select)(P.pb);e.next=10;break;case 5:if(o=e.sent){e.next=8;break}return e.abrupt("return");case 8:o.token&&(r={parentToken:o.token}),n=Object(s.a)(o)?a.MODAL_TYPES.CREATE_UNIFIED_FOLDER_TEAMSPACE_V1:a.MODAL_TYPES.CREATE_UNIFIED_FOLDER;case 10:return e.next=12,Object(T.put)(Object(i.c)(n,r));case 12:case"end":return e.stop()}},p)}}).call(this,r("kCIs"))},"8sqB":function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"f",function(){return C}),n.d(t,"b",function(){return N}),n.d(t,"c",function(){return w}),n.d(t,"a",function(){return D});var r,o,i=n("QILm"),u=n.n(i),a=n("o0o1"),s=n.n(a),c=n("lwsE"),l=n.n(c),d=n("W8MJ"),f=n.n(d),p=n("a1gu"),_=n.n(p),E=n("Nsbk"),h=n.n(E),m=n("7W2i"),O=n.n(m),y=n("yXPU"),g=n.n(y),v=n("7EGn"),b=n("q1tI"),T=n.n(b),R=n("NVF8");(o=r=r||{}).SEARCH_NOTE="SearchNote",o.LOGO="Logo",o.PUBLISH_TO_WIKI="PublishToWiki",o.REMOVE_WIKI="RemoveWiki",o.CREATE_WIKI="CreateWiki",o.ADMIN_SETTING="AdminSetting",o.CREATE_MENU="CreateMenu",o.WIKI_MODAL_MANAGER="WikiModalManager";var S=null;function C(){return I.apply(this,arguments)}function I(){return(I=g()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=S,e.t0){e.next=5;break}return e.next=4,Object(R.a)("wiki");case 4:e.t0=e.sent;case 5:return S=e.t0,e.abrupt("return",S);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var L=function(e){function n(e){var t;return l()(this,n),(t=_()(this,h()(n).call(this,e))).state={wikiModule:S},t.state.wikiModule||t.fetchWikiComponent(),t}function t(){return r.apply(this,arguments)}var r;return O()(n,e),f()(n,[{key:"fetchWikiComponent",value:(r=g()(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:t=e.sent,this.setState({wikiModule:t});case 4:case"end":return e.stop()}},e,this)})),t)},{key:"render",value:function(){var e=this.state.wikiModule,t=this.props,n=t.componentName,r=t.preload,o=void 0!==r&&r,i=t.show,a=void 0===i||i,s=u()(t,["componentName","preload","show"]);if(!e||!n)return null;var c=Object(v.default)(e,"components.".concat(n));return c?(o&&c.preload&&c.preload(),a&&T.a.createElement(c,Object.assign({},s))):null}}]),n}(T.a.PureComponent);function N(e){return T.a.createElement(L,Object.assign({componentName:r.PUBLISH_TO_WIKI},e))}function w(e){return T.a.createElement(L,Object.assign({componentName:r.REMOVE_WIKI},e))}function D(e){return T.a.createElement(L,Object.assign({componentName:r.CREATE_WIKI},e))}t.e=L},"9IUp":function(e,te,ne){"use strict";(function(d){ne.d(te,"b",function(){return Z}),ne.d(te,"a",function(){return $});var e=ne("o0o1"),f=ne.n(e),t=ne("yXPU"),p=ne.n(t),n=ne("lSNA"),r=ne.n(n),_=ne("7EGn"),E=ne("S/x3"),h=ne("BmhO"),m=ne("03In"),o=ne("/PhZ"),O=ne("ahx2"),i=ne("VIFs"),a=ne("n/R6"),s=ne("jp/M"),y=ne("QM+C"),c=ne("iP/4"),u=ne("dP4c"),g=ne("Xngx"),v=ne("D7h9"),l=ne("q1tI"),b=ne.n(l),T=ne("UlbS"),R=ne("MjSh"),S=ne("2ACu"),C=ne("IQ5M"),I=ne("UB5X"),L=ne.n(I),N=ne("Qyje"),w=ne.n(N),D=ne("6jTl"),k=ne("ucr6"),P=ne("dvZ7"),F=ne("we6V"),x=ne("hVE6"),M="importTips",j=r()({timeout:d("common.server_busy"),netWork:d("common.upload_fail_network")},O.SERVER_STATUS_CODE.SERVER_BUSY,d("common.server_busy"));function U(){a.a.show({key:M,type:"loading",content:d("common.importing"),duration:0,closable:!1})}function B(){a.a.remove(M)}function V(e){var t=e.ext,n=void 0===t?"":t,r=e.type,o=void 0===r?"":r,i="";return([s.common.docxSuffix,s.common.docSuffix].includes(n)||[s.common.docxMimeTypes,s.common.docMimeTypes].includes(o))&&(i="doc"),![s.common.xlsxSuffix,s.common.xlsSuffix,s.common.CSVSuffix].includes(n)&&o!==s.common.excelMimeTypes||(i="sheet"),([s.common.xmindSuffix,s.common.mmSuffix,s.common.opmlSuffix].includes(n)||[s.common.xmindMimeTypes,s.common.opmlMimeTypes,s.common.mmMimeTypes].includes(o))&&(i="mindnote"),i}function H(e){var t=e.suiteStr,n=e.token,r=Object(i.prependSpace)("/".concat(t,"/").concat(n));c.a.isLarkWindow?window.open(r):Object(u.c)(r)}function W(e){var t,n=e.token,r=e.file;B(),!r||(t=V(r))&&H({suiteStr:t,token:n})}var Y=function(o){return function(e){var t,n=e.token,r=e.file;B(),!r||(t=V(r))&&(o(),H({suiteStr:t,token:n}))}};function K(e,t,n){var r,o;B(),t&&(r=L()(e)?Object(C.b)(e,n):j[e||""],o=b.a.createElement("span",null,d("common.upload_error_prefix")," ",b.a.createElement("a",{href:d("common.upload_error_link"),target:"_blank",className:"upload-tips-link"},d("common.upload_error_suffix"))),a.a.show({key:"importFailTips",type:"error",content:r||o,duration:C.a,closable:!0}))}var z=function(e){var t=Object(C.c)(e);t&&a.a.info({key:"FileWarning",content:t,closable:!0,duration:C.a})};function q(e){var s=e.ticket,c=e.times,u=e.file,l=e.onSuccessCb;100<c?K():setTimeout(p()(f.a.mark(function e(){var t,n,r,o,i,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.default.dispatch(Object(m.b)(s));case 3:t=e.sent,n=t.payload,r=n.tokens,o=n.status,i=n.warningCode,a=n.warningExtra,r&&r.length&&1===r.length?"function"==typeof l&&(l({token:r[0],file:u}),i&&z(i),a&&Object(C.d)(a)):!o||"failed"!==o&&"timeout"!==o?q({ticket:s,times:c+1,file:u,onSuccessCb:l}):K(o),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),K(e.t0.code,Object(_.default)(e.t0,"code")!==O.CREATE_LIMITATION_ERROR_CODE,u&&u.ext);case 11:case"end":return e.stop()}},e,null,[[0,8]])})),Math.min(1e3,200*(c+1)))}function X(e){return J.apply(this,arguments)}function J(){return(J=p()(f.a.mark(function e(t){var n,r,o,i,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.token,r=t.file,o=t.onSuccessCb,e.prev=1,e.next=4,v.default.dispatch(Object(m.k)(n));case 4:i=e.sent,(a=i.payload.ticket)?q({ticket:a,times:0,file:r,onSuccessCb:o}):K(void 0,!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),K(e.t0.code,!0,r&&r.ext);case 12:case"end":return e.stop()}},e,null,[[1,9]])}))).apply(this,arguments)}function Q(e){v.default.dispatch(Object(o.deleteObject)({objTokens:[e],listName:null,noSuccessToast:!0}))}function Z(){var e,t,n,r=w.a.parse(window.location.search.slice(1)),o=r.source_token,i=r.source_title,a=document&&document.referrer,s=new RegExp("/slide(s?)/".concat(o)).test(a);o&&i&&s&&(e=location.href.split("?")[0],t=function(){Object(S.default)("click_export",{action:"delete_original"}),Q(o),k.a.replace(e)},n=function(){Object(S.default)("click_export",{action:"keep_original"}),k.a.replace(e)},D.a.show({title:d("slide.export_alert"),body:d("slide.export_alert_content",i),confirmText:d("slide.export_alert_delete"),cancelText:d("slide.export_alert_keep"),maskClosable:!1,wrapClassName:"modal-delete-source-slide",onConfirm:t,onCancel:n}))}function $(e){return ee.apply(this,arguments)}function ee(){return(ee=p()(f.a.mark(function e(t){var n,r,o,i,a,s,c,u,l;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.token,r=void 0===n?"":n,o=t.file,i=t.importText,s=function(){var e=p()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=v.default.getState(),n=Object(x.a)(t),r=Object(x.h)(t),Object(E.d)({fileInfo:n,enableWPSComponent:Object(P.l)(n,r)})===h.n.WPS&&r)return e.next=8,F.a.getInstance().triggerSave();e.next=8;break;case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("wps save error",e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(){return e.apply(this,arguments)}}(),c=function(){var e=p()(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"function"==typeof a.close&&a.close(),U(),e.next=4,s();case 4:t=Object(g.d)(o.name||"").toLowerCase(),Object(S.default)("toggle_attribute",{action:"convert_keep_original",sub_file_type:t,source:"headerbar",file_type:y.mapTypeToSuite[t]}),X({token:r,file:o,onSuccessCb:W});case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),u=function(){return Q(r)},l=function(){var e=p()(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"function"==typeof a.close&&a.close(),U(),e.next=4,s();case 4:t=Object(g.d)(o.name||"").toLowerCase(),Object(S.default)("toggle_attribute",{action:"convert_delete_original",sub_file_type:t,source:"headerbar",file_type:y.mapTypeToSuite[t]}),X({token:r,file:o,onSuccessCb:Y(u)});case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),a=T.Dialog.show({title:d("explorer.v3.upload_keep_original_title"),bodyStyle:{color:R.N900},content:d("explorer.v3.after_import_keep_original",o.name,i,o.ext),footer:[b.a.createElement(T.Button,{key:"delete",type:"warn",onClick:l},d("common.delete")),b.a.createElement(T.Button,{key:"reserve",onClick:c},d("explorer.v3.upload_keep_original_btn_text"))]});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}}).call(this,ne("2vAP"))},"9Mno":function(e,t,n){var r=n("O3vZ"),o=Array.prototype;e.exports=function(e){var t=e.indexOf;return e===o||e instanceof Array&&t===o.indexOf?r:t}},BAjd:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"k",function(){return r}),n.d(t,"m",function(){return i}),n.d(t,"l",function(){return p}),n.d(t,"c",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"d",function(){return O}),n.d(t,"o",function(){return _}),n.d(t,"j",function(){return h}),n.d(t,"f",function(){return y}),n.d(t,"g",function(){return g}),n.d(t,"h",function(){return v}),n.d(t,"i",function(){return b}),n.d(t,"a",function(){return T}),n.d(t,"n",function(){return R});var r,o,i,a,s=n("VIFs"),c={CHUNK_CHECK:Object(s.prependAPI)("/api/box/upload/block/check/"),CHUNK_UPLOAD:Object(s.prependDriveStreamAPI)("/api/box/stream/upload/block/"),FINISH:Object(s.prependAPI)("/api/box/upload/finish/"),PREPARE:Object(s.prependAPI)("/api/box/upload/prepare/"),IMPORT_UPLOAD:Object(s.prependAPI)("/api/parser/uploadfile/"),IMPORT_STATUS:Object(s.prependAPI)("/api/parser/getresult/")};(o=r=r||{}).beforeAdd="beforeAdd",o.cancel="cancel",o.cancelAll="cancelAll",o.complete="complete",o.error="error",o.taskProgress="taskProgress",o.fileProgress="fileProgress",o.fileError="fileError",o.fileWarning="fileWarning",o.taskAdded="taskAdded",o.taskError="taskError",o.taskRetry="taskRetry",o.tasksAdded="tasksAdded",o.taskSuccess="taskSuccess",o.pause="pause",o.pauseAll="pauseAll",o.progress="progress",o.uploadStart="uploadStart",o.offline="offline",o.online="online",o.usageLimitReached="usageLimitReached",o.collectReport="collectReport",o.pending="pending",(a=i=i||{}).upload="upload",a.import="import";var u,l,d,f,p={clearInput:"clearInput",dragOverClass:"dragOverClass",fileType:"fileType",importableType:"importableType",fileTypeErrorCallback:"fileTypeErrorCallback",finishTarget:"finishTarget",getParentToken:"getParentToken",createDirectory:"createDirectory",uploadChunk:"uploadChunk",uploadMergedChunk:"uploadMergedChunk",getMountPoint:"getMountPoint",maxFileSize:"maxFileSize",maxImportFileSize:"maxImportFileSize",maxFileSizeErrorCallback:"maxFileSizeErrorCallback",minFileSize:"minFileSize",minFileSizeErrorCallback:"minFileSizeErrorCallback",fastModeEnabled:"fastModeEnabled",emptyDirectoryCallback:"emptyDirectoryCallback",directoryNotImportableCallback:"directoryNotImportableCallback",prepareTarget:"prepareTarget",setChunkTypeFromFile:"setChunkTypeFromFile",simultaneousUploads:"simultaneousUploads",testTarget:"testTarget",throttleProgressCallbacks:"throttleProgressCallbacks",uploadTarget:"uploadTarget",xhrTimeout:"xhrTimeout",onDragStart:"onDragStart",onDragEnd:"onDragEnd",shouldAddToRecents:"shouldAddToRecents",preferMergedChunks:"preferMergedChunks"};(l=u=u||{}).ERROR="error",l.PROGRESS="progress",l.RETRY="retry",l.SUCCESS="success",l.REPORT_ERROR="report_error",(f=d=d||{}).ERROR="error",f.PENDING="pending",f.SUCCESS="success",f.UPLOADING="uploading",f.ABORT="abort";var _,E,h,m,O=3;(E=_=_||{}).ChunkError="ChunkError",E.ChunkSuccess="ChunkSuccess",E.FileFinishError="FileFinishError",E.FilePrepareError="FilePrepareError",E.FileSuccess="FileSuccess",E.FolderCreateError="FolderCreateError",E.ImportUploadError="ImportUploadError",E.ImportParseError="ImportParseError",(m=h=h||{}).Upload="upload",m.Import="import",m.Exit="Exit";var y="directory-a47de874",g=11001,v=10009,b=90002007,T="api.sheet.parser.uploadfile",R=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"]},"BP/7":function(e,t,n){var r=n("FRmQ"),o=Array.prototype;e.exports=function(e){var t=e.find;return e===o||e instanceof Array&&t===o.find?r:t}},CQgL:function(e,d,f){"use strict";(function(n){f.d(d,"c",function(){return a}),f.d(d,"a",function(){return c}),f.d(d,"d",function(){return u}),f.d(d,"b",function(){return l});var e=f("RIqP"),t=f.n(e),r=f("lZeq"),o=f("Xngx"),i=(f("BAjd"),f("QM+C")),a=(f("XMIC"),f("jryj"),[].concat(t()(i.importableTypes),t()(i.importableMimeTypes))),s=function(t,e){return e.some(function(e){return t.includes(e)})},c=function(e){return Array.from(e).map(function(e){if(e instanceof DataTransferItem){var t=e.webkitGetAsEntry();return t.isFile&&e.getAsFile?e.getAsFile():t}return e})},u=function(e){var t=c(e).map(function(e){return Object(o.d)(e.name)});return s(a,t)},l=function(e){var t=[];return(s(i.docImportableTypes,e)||s(i.sheetImportableTypes,e))&&t.push(n("filetype_office")),r.a&&s(i.mindnoteImportableTypes,e)&&t.push(n("filetype_mindnote")),t.join(n("common.comma_seperator"))}}).call(this,f("2vAP"))},Cdfq:function(e,h,m){"use strict";(function(n){m.d(h,"c",function(){return l}),m.d(h,"b",function(){return d}),m.d(h,"a",function(){return E});var e,t,r=m("lSNA"),o=m.n(r),i=m("bPB8"),a=m("Jonh"),s=m("QM+C"),c=m("6omo"),u=m("po4q"),l=(Object.assign(Object.create(null),(e={},o()(e,s.NUM_SUITE_TYPE.DOC,n("template.v3.objtype.doc")),o()(e,s.NUM_SUITE_TYPE.SHEET,n("template.v3.objtype.sheet")),o()(e,s.NUM_SUITE_TYPE.MINDNOTE,n("template.v3.objtype.mindnote")),e)),Object.assign(Object.create(null),(t={},o()(t,c.e.ALL_TYPES,n("explorer.v3.meta_filter_menu_item.all")),o()(t,s.NUM_SUITE_TYPE.DOC,n("doc.search.filter.doc")),o()(t,s.NUM_SUITE_TYPE.SHEET,n("doc.search.filter.sheet")),o()(t,s.NUM_SUITE_TYPE.MINDNOTE,n("doc.search.filter.mindnote")),t))),d=function(){var e=[];return f(e),p(e),_(e),e};function f(e){e.push({tabTypeKey:c.j.GALLERY,name:n("explorer.v3.template_gallery")})}function p(e){a.a&&e.push({name:n("explorer.v3.template_custom"),tabTypeKey:c.j.CUSTOM})}function _(e){a.h&&e.push({tabTypeKey:c.j.CORPORATE,name:n("explorer.v3.template_corporate")})}function E(e){var t=[];switch(e){case c.j.GALLERY:t=[{category_id:u.a,name:n("template_v3_recommended"),is_recent:!0,templates:Object(i.a)([{cover_width:1,cover_height:2,name:n("template_v3_blank"),obj_type:s.NUM_SUITE_TYPE.DOC,obj_token:"",is_create_new:!0},{cover_width:2,cover_height:1,name:n("template_v3_blank"),obj_type:s.NUM_SUITE_TYPE.SHEET,obj_token:"",is_create_new:!0},a.g&&{cover_width:1,cover_height:2,name:n("template_v3_blank"),obj_type:s.NUM_SUITE_TYPE.MINDNOTE,obj_token:"",is_create_new:!0}])}];break;case c.j.CUSTOM:t=[{category_id:c.c.OWN,name:n("explorer.v3.my_templates"),templates:[],type:"own"},{category_id:c.c.SHARE,name:n("explorer.v3.templates_shared"),templates:[],type:"share"}];break;case c.j.CORPORATE:t=[{category_id:c.b.TENANT,name:n("explorer.v3.corporate_tenant"),templates:[],type:"tenant"}]}return t}}).call(this,m("2vAP"))},Cupc:function(e,t,n){var o=n("1mbr");e.exports=function(e,t,n){for(var r in t)n&&n.unsafe&&e[r]?e[r]=t[r]:o(e,r,t[r],n);return e}},D1oa:function(e,t,n){"use strict";function r(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n.buffer}function o(e){return String.fromCharCode.apply(null,new Uint8Array(e))}n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var i="image/png";function a(e){var t=s(e),n=new DataView(e),r=new Blob([n],{type:t||i});return{blobUrl:URL.createObjectURL(r),mime:t}}function s(e){for(var t=e.slice(0,4),t=new Uint8Array(t),n=[],r=0;r<t.byteLength;r++)n.push(t[r].toString(16));return c(n.join("").toUpperCase())}function c(e){switch(e){case"89504E47":return"image/png";case"47494638":return"image/gif";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":case"FFD8FFE2":case"FFD8FFE3":case"FFD8FFE8":return"image/jpeg";case"52494646":return"image/webp";default:return""}}},DK5n:function(e,t,n){"use strict";var d=n("pevS"),f=n("OsYe"),p=n("ZZQp"),_=n("Bvq2"),E=n("MdFX"),h=n("W1ep"),m=n("X32N"),O=n("39uu"),y=n("KHTo"),g=n("QYBB").f,v=n("3uAa").forEach,b=n("wbIY"),r=n("L1rz"),T=r.set,R=r.getterFor;e.exports=function(n,e,t,r,a){var s,c,o=f[n],u=o&&o.prototype,i=r?"set":"add",l={};return b&&"function"==typeof o&&(a||u.forEach&&!_(function(){(new o).entries().next()}))?(s=e(function(e,t){T(m(e,s,n),{type:n,collection:new o}),null!=t&&h(t,e[i],e,r)}),c=R(n),v(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(o){var i="add"==o||"set"==o;o in u&&(!a||"clear"!=o)&&E(s.prototype,o,function(e,t){var n=c(this).collection;if(!i&&a&&!O(e))return"get"==o&&void 0;var r=n[o](0===e?0:e,t);return i?this:r})}),a||g(s.prototype,"size",{get:function(){return c(this).collection.size}})):(s=t.getConstructor(e,n,r,i),p.REQUIRED=!0),y(s,n,!1,!0),l[n]=s,d({global:!0,forced:!0},l),a||t.setStrong(s,n,r),s}},"EPt+":function(e,t,n){"use strict";n.d(t,"O",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"y",function(){return c}),n.d(t,"P",function(){return l}),n.d(t,"g",function(){return f}),n.d(t,"w",function(){return _}),n.d(t,"h",function(){return h}),n.d(t,"k",function(){return O}),n.d(t,"l",function(){return g}),n.d(t,"A",function(){return b}),n.d(t,"b",function(){return R}),n.d(t,"B",function(){return C}),n.d(t,"u",function(){return L}),n.d(t,"G",function(){return w}),n.d(t,"q",function(){return k}),n.d(t,"p",function(){return Z}),n.d(t,"o",function(){return $}),n.d(t,"R",function(){return ee}),n.d(t,"S",function(){return te}),n.d(t,"m",function(){return ne}),n.d(t,"n",function(){return re}),n.d(t,"d",function(){return oe}),n.d(t,"i",function(){return B}),n.d(t,"e",function(){return H}),n.d(t,"r",function(){return W}),n.d(t,"E",function(){return K}),n.d(t,"D",function(){return q}),n.d(t,"H",function(){return ie}),n.d(t,"L",function(){return se}),n.d(t,"J",function(){return ue}),n.d(t,"K",function(){return Oe}),n.d(t,"N",function(){return de}),n.d(t,"C",function(){return pe}),n.d(t,"t",function(){return Ee}),n.d(t,"c",function(){return me}),n.d(t,"v",function(){return Se}),n.d(t,"f",function(){return ye}),n.d(t,"Q",function(){return ve}),n.d(t,"F",function(){return Te}),n.d(t,"I",function(){return Ne}),n.d(t,"M",function(){return we}),n.d(t,"x",function(){return Ce}),n.d(t,"j",function(){return Ae}),n.d(t,"z",function(){return ke}),n.d(t,"s",function(){return De});var r,o,i,a,s,c,u,l,d,f,p,_,E,h,m,O,y,g,v,b,T,R,S,C,I,L,N,w,D,k,P,F=n("lSNA"),x=n.n(F),M=n("Z/fP"),j=n("fV25");(i=o=o||{})[i.corner=0]="corner",i[i.colHeader=1]="colHeader",i[i.rowHeader=2]="rowHeader",i[i.viewport=3]="viewport",(s=a=a||{})[s.execute=0]="execute",s[s.undo=1]="undo",s[s.redo=2]="redo",(u=c=c||{})[u.Left=0]="Left",u[u.Center=1]="Center",u[u.Right=2]="Right",u[u.General=3]="General",(d=l=l||{})[d.underline=1]="underline",d[d.lineThrough=2]="lineThrough",d[d.overline=4]="overline",d[d.none=0]="none",(p=f=f||{})[p.Add=0]="Add",p[p.Set=1]="Set",p[p.Del=2]="Del",(E=_=_||{})[E.Add=0]="Add",E[E.Set=1]="Set",E[E.Del=2]="Del",(m=h=h||{})[m.all=0]="all",m[m.values=1]="values",m[m.formatting=2]="formatting",m[m.formulas=3]="formulas",(y=O=O||{})[y.noHeaders=0]="noHeaders",y[y.rowHeaders=1]="rowHeaders",y[y.columnHeaders=2]="columnHeaders",y[y.allHeaders=3]="allHeaders",(v=g=g||{})[v.value=1]="value",v[v.formula=2]="formula",v[v.comment=4]="comment",v[v.outline=8]="outline",v[v.sparkline=16]="sparkline",v[v.span=32]="span",v[v.style=64]="style",v[v.tag=128]="tag",v[v.bindingPath=256]="bindingPath",v[v.conditionalFormat=512]="conditionalFormat",v[v.rowColInfo=1024]="rowColInfo",v[v.dataValidation=2048]="dataValidation",v[v.all=4095]="all",(T=b=b||{})[T.auto=1]="auto",T[T.active=2]="active",T[T.inactive=4]="inactive",T[T.disabled=0]="disabled",(S=R=R||{})[S.cell=0]="cell",S[S.cellWithHeader=1]="cellWithHeader",(I=C=C||{})[I.setFormula=0]="setFormula",I[I.copyPaste=1]="copyPaste",I[I.dragFill=2]="dragFill",I[I.dragDrop=3]="dragDrop",I[I.changePartOfArrayFormula=4]="changePartOfArrayFormula",I[I.invalidSheetName=5]="invalidSheetName",I[I.cellLimitExceed=6]="cellLimitExceed",I[I.exportFile=7]="exportFile",I[I.editProtectedRange=8]="editProtectedRange",I[I.failToPasteModal=9]="failToPasteModal",(N=L=L||{}).ValidationError="ValidationError",N.CellClick="CellClick",N.EnterCell="EnterCell",N.LeaveCell="LeaveCell",N.ValueChanged="ValueChanged",N.ClearSelection="ClearSelection",N.CellClickInSelection="CellClickInSelection",N.CellClickOutSelection="CellClickOutSelection",N.SheetViewMouseDown="SheetViewMouseDown",N.CellPress="CellPress",N.CellDoubleClick="CellDoubleClick",N.TopPosChanged="TopPosChanged",N.TopRowChanged="TopRowChanged",N.LeftTopPosChanged="LeftTopPosChanged",N.LeftPosChanged="LeftPosChanged",N.LeftColumnChanged="LeftColumnChanged",N.InvalidOperation="InvalidOperation",N.RangeFiltering="RangeFiltering",N.RangeFiltered="RangeFiltered",N.TableFiltering="TableFiltering",N.TableFiltered="TableFiltered",N.RangeSorting="RangeSorting",N.RangeSorted="RangeSorted",N.ClipboardChanging="ClipboardChanging",N.ClipboardChanged="ClipboardChanged",N.ClipboardPasting="ClipboardPasting",N.ClipboardPasted="ClipboardPasted",N.ColumnWidthChanging="ColumnWidthChanging",N.ColumnWidthChanged="ColumnWidthChanged",N.RowHeightChanging="RowHeightChanging",N.RowHeightChanged="RowHeightChanged",N.DragDropBlock="DragDropBlock",N.DragDropBlockCompleted="DragDropBlockCompleted",N.DragFillBlock="DragFillBlock",N.DragFillBlockCompleted="DragFillBlockCompleted",N.EditStarting="EditStarting",N.EditStarted="EditStarted",N.StartEditFail="StartEditFail",N.EditChange="EditChange",N.EditEnding="EditEnding",N.EditEnd="EditEnd",N.EditEnded="EditEnded",N.SuspendEditing="SuspendEditing",N.ResumeEditing="ResumeEditing",N.RangeGroupStateChanging="RangeGroupStateChanging",N.RangeGroupStateChanged="RangeGroupStateChanged",N.SelectionChanging="SelectionChanging",N.SelectionChanged="SelectionChanged",N.SheetTabClick="SheetTabClick",N.SheetTabRepaint="SheetTabRepaint",N.NewSheetTab="NewSheetTab",N.ShowAllTabs="ShowAllTabs",N.ChangeFocusHolder="ChangeFocusHolder",N.SheetNameChanging="SheetNameChanging",N.SheetNameChanged="SheetNameChanged",N.UserZooming="UserZooming",N.UserFormulaEntered="UserFormulaEntered",N.CellChanged="CellChanged",N.ColumnChanged="ColumnChanged",N.RowChanged="RowChanged",N.ActiveSheetChanging="ActiveSheetChanging",N.ActiveSheetChanged="ActiveSheetChanged",N.CurrentSheetRemoved="CurrentSheetRemoved",N.SparklineChanged="@byted/byted-sparklineChanged",N.RangeChanged="RangeChanged",N.ButtonClicked="ButtonClicked",N.EditorStatusChanged="EditorStatusChanged",N.FloatingObjectChanged="FloatingObjectChanged",N.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",N.PictureChanged="PictureChanged",N.FloatingObjectRemoving="FloatingObjectRemoving",N.FloatingObjectRemoved="FloatingObjectRemoved",N.PictureSelectionChanged="PictureSelectionChanged",N.FloatingObjectLoaded="FloatingObjectLoaded",N.TouchToolStripOpening="TouchToolStripOpening",N.CloseOtherPanel="CloseOtherPanel",N.Resize="Resize",N.GuideBarToggling="GuideBarToggling",N.HistoryPanelToggling="HistoryPanelToggling",N.CommentHotkeyPress="CommentHotkeyPress",N.OpenCommentPanel="OpenCommentPanel",N.SetComments="SetComments",N.SlicerChanged="SlicerChanged",N.ResetBinding="ResetBinding",N.InitBinding="InitBinding",N.BeforeDragDrop="BeforeDragDrop",N.FormulatextboxActiveSheetChanging="FormulatextboxActiveSheetChanging",N.FormulatextboxActiveSheetChanged="FormulatextboxActiveSheetChanged",N.FormulatextboxEditStarted="FormulatextboxEditStarted",N.FormulatextboxEnterCell="FormulatextboxEnterCell",N.FormulatextboxEditEnded="FormulatextboxEditEnded",N.FormulatextboxRangeChanged="FormulatextboxRangeChanged",N.SetSpans="SetSpans",N.Sort="Sort",N.CommandExecuting="CommandExecuting",N.CommandExecuted="CommandExecuted",N.OptionChanged="OptionChanged",N.SegClick="SegClick",N.SegHover="SegHover",N.ShowDropdown="ShowDropdown",N.ShowFilter="ShowFilter",N.FilterStateChanged="FilterStateChanged",N.HideDropdown="HideDropdown",N.Focus="Focus",N.LoseFocus="LoseFocus",N.CutSheet="CutSheet",N.FillRange="FillRange",N.UndoSuccessfully="UndoSuccessfully",N.HoverCellChanged="HoverCellChanged",N.DistrictCursorChanged="DistrictCursorChanged",N.FrozenChanged="FrozenChanged",N.FCornerContextMenu="FCornerContextMenu",N.FRowHeaderContextMenu="FRowHeaderContextMenu",N.FColHeaderContextMenu="FColHeaderContextMenu",N.FCellContextMenu="FCellContextMenu",N.FCellHover="FCellHover",N.ActiveCellChanged="ActiveCellChanged",N.EmbedSheetRequireFullScreen="EmbedSheetRequireFullScreen",N.EmbedSheetFullScreenModeEntered="EmbedSheetFullScreenModeEntered",N.EmbedSheetScrollRowTo="EmbedSheetScrollRowTo",N.ScrollDoc="ScrollDoc",N.HideHeaderBubble="HideHeaderBubble",N.ShowImageUploader="ShowImageUploader",N.StartPaste="StartPaste",N.OpenImgFullScreen="OpenImgFullScreen",N.OpenFloatImgFullScreen="OpenFloatImgFullScreen",N.ToggleOptionalPasteIcon="ToggleOptionalPasteIcon",N.OnRebuild="OnRebuild",N.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",N.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",N.SheetPermissionChanged="SheetPermissionChanged",N.ProtectionChange="ProtectionChange",N.ModifyValues="ModifyValues",N.SegmentArrayChanged="SegmentArrayChanged",N.AddSheet="AddSheet",N.RemoveSheet="RemoveSheet",N.SuspendStatusCollect="SuspendStatusCollect",N.ResumeStatusCollect="ResumeStatusCollect",N.FormatPainting="FormatPainting",N.ShowCellCommentBubble="ShowCellCommentBubble",N.HideCellCommentBubble="HideCellCommentBubble",N.LaunchCommentPanel="LaunchCommentPanel",N.AddComment="AddComment",N.PullSheetCommentSucc="PullSheetCommentSucc",N.UpdateActiveCommentId="UpdateActiveCommentId",N.RowDataApplied="RowDataApplied",N.SheetPageLoaded="SheetPageLoaded",N.SheetPageUnmount="SheetPageUnmount",N.HeaderMenuClick="HeaderMenuClick",N.FABLoaded="FABLoaded",N.ShowInstallPasteExtensionModal="showInstallPasteExtensionModal",N.ShowInstallPasteExtensionToast="showInstallPasteExtensionToast",N.SwitchBlockTab="SwitchBlockTab",N.EmbedSheetOffsetLeftChanged="EmbedSheetOffsetLeftChanged",N.onTableLoaded="onTableLoaded",N.onBatchUpdateBlockComment="onBatchUpdateBlockComment",N.onStartNewComment="onStartNewComment",N.AddRowColExceedCellLimit="addRowColExceedCellLimit",N.BitableBlockRejectCommit="BitableBlockRejectCommit",N.ConditionalFormatUpdate="ConditionalFormatUpdate",N.ActiveFloatObjectChange="ActiveFloatObjectChange",N.ShowFloatMenu="ShowFloatMenu",N.HideFloatMenu="HideFloatMenu",N.HideCellContextMenu="HideCellContextMenu",N.ShowReminderTooltip="ShowReminderTooltip",N.HideReminderTooltip="HideReminderTooltip",N.ResizeRowOrCol="ResizeRowOrCol",N.modifyWhenModelLocked="modifyWhenModelLocked",N.modelLockModifyError="modelLockModifyError",N.FocusDropdownListEditor="FocusDropdownListEditor",N.BeforeShortcutKeyExecuted="BeforeShortcutKeyExecuted",(D=w=w||{})[D.dragDrop=0]="dragDrop",D[D.dragFill=1]="dragFill",D[D.clear=2]="clear",D[D.paste=3]="paste",D[D.sort=4]="sort",D[D.setArrayFormula=5]="setArrayFormula",D[D.evaluateFormula=6]="evaluateFormula",(P=k=k||{})[P.Up=0]="Up",P[P.Left=1]="Left",P[P.Right=2]="Right",P[P.Down=3]="Down";var U,B,V,H,W,Y,K,z,q,X,J,Q,Z="10pt",$=j.a.split(",").map(function(e){return e.trim()}).map(function(e){return-1!==e.indexOf(" ")?'"'+e+'"':e}).join(", "),ee=function(){return U=U||(M.a.getSheetCellLimitNum()||5e5)},te=function(){return ee().toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},ne="".concat(Z,"/1.5 ").concat($),re=("9pt ".concat($),200),oe="COMMAND";(V=B=B||{}).SELECT_ROW="selectRow",V.SELECT_COLUMN="selectColumn",V.BOLD="bold",V.UNDERLINE="underline",V.LINE_THROUGH="lineThrough",V.ITALIC="italic",V.H_ALIGN_LEFT="hAlign.left",V.H_ALIGN_CENTER="hAlign.center",V.H_ALIGN_RIGHT="hAlign.right",V.HORIZONTAL_FILL_BY_SHORTCUT="horizontalFillByShortcut",V.VERTICAL_FILL_BY_SHORTCUT="verticalFillByShortcut",V.HORIZONTAL_FILL="horizontalFill",V.VERTICAL_FILL="verticalFill",V.PREVIOUS_SHEET="previousSheet",V.NEXT_SHEET="nextSheet",V.MOVE_HEAD="moveHead",V.MOVE_END="moveEnd",V.MOVE_ACTIVE="moveActive",V.FIND="find",V.SELECT_ALL="selectAll",V.PASTE_VALUES_ONLY="pasteValuesOnly",V.PASTE_FORMATS_ONLY="pasteFormatsOnly",V.NAVIGATION_HOME_2="navigationHome2",V.NAVIGATION_END_2="navigationEnd2",V.NAVIGATION_TOP="navigationTop",V.NAVIGATION_BOTTOM="navigationBottom",V.NAVIGATION_DOWN="navigationDown",V.MOVE_TO_NEXT_CELL="moveToNextCell",V.PREVENT_SAVE="preventSave",V.UNDO="undo",V.REDO="redo",V.PASTE="paste",V.REDO_2="redo2",V.COPY="copy",V.CUT="cut",V.SET_COMMENTS="setComments",V.COMMENT="comment",V.OPEN_COMMENT="openComment",V.SHOW_ALL_TABS="showAllTabs",V.OPEN_CONTEXT_MENU="openContextMenu",V.OPEN_FILTER_MENU="openFilterMenu",V.OPEN_HYPER_LINK="openHyperLink",V.OPEN_GUIDE_BAR="openGuideBar",V.TOGGLE_HISTORY_PANEL="toggleHistoryPanel",V.SET_RANGE_VALUE="setRangeValue",V.SET_RANGE_STYLE="setRangeStyle",V.SET_STYLE_FONT="setStyleFont",V.SET_FORMATTER="setFormatter",V.SET_TEXT_DECORATION="setTextDecoration",V.MERGE_CELLS="mergeCells",V.SET_ROW_COL_CHANGE="setRowColChange",V.SET_ROW_COL_VISIBLE="setRowColVisible",V.DO_CLEAR="doClear",V.CLEAR_VALUES_STYLE="clearValuesAndStyles",V.SORT_RANGE="sortRange",V.AUTO_FIT_ROW="autoFitRow",V.AUTO_FIT_COLUMN="autoFitColumn",V.ADD_SHEET="addSheet",V.MOVE_SHEET="moveSheet",V.DELETE_SHEET="deleteSheet",V.RENAME_SHEET="renameSheet",V.COPY_SHEET="copySheet",V.RESIZE_ROW="resizeRow",V.RESIZE_COLUMN="resizeColumn",V.EDIT_CELL="editCell",V.DRAG_DROP="dragDrop",V.FILL="fill",V.LINK="link",V.CLIPBOARD_PASTE="clipboardPaste",V.CLEAR_VALUES="clearValues",V.SET_FILTER="setFilter",V.FREEZE_SHEET="freezeSheet",V.FORMAT_PAINTER="formatPainter",V.FORMAT_PAINTING="formatPainting",V.REPLACE="replace",V.SET_DROPDOWN="setDropdown",V.SET_DROPDOWN_VALID="setDropdownValid",V.CONVERT_LINK="convertLink",V.LOCK_ROW="lockRow",V.UNLOCK_ROW="unlockRow",V.LOCK_COL="lockCol",V.UNLOCK_COL="unlockCol",V.LOCK_SHEET="lockSheet",V.UNLOCK_SHEET="unlockSheet",V.MODIFY_VALUES="modifyValues",V.UPGRADE_SNAPSHOT="upgradeSnapshot",V.SET_CONDITIONAL_FORMAT="setConditionalFormat",V.INCREASE_FONT_SIZE="increaseFontSize",V.DECREASE_FONT_SIZE="decreaseFontSize",V.INSERT_DATE="insertDate",V.INSERT_TIME="insertTime",V.QUICK_SUM="quickSum",V.TO_DECIMAL="toDecimal",V.TO_TIME="toTime",V.TO_DATE="toDate",V.TO_MONEY="toMoney",V.TO_PERCENTAGE="toPercentage",V.TO_SCIENTIFIC="toScientific",V.TOP_BORDER="topBorder",V.RIGHT_BORDER="rightBorder",V.BOTTOM_BORDER="bottomBorder",V.LEFT_BORDER="leftBorder",V.CANCEL_BORDER="cancelBorder",V.NEW_SHEET_TAB="newSheetTab",V.AUTO_FILL_RANGE="autoFillRange",V.FILL_RANGE="fillRange",V.SORT="sort",V.FILTER="filter",V.SET_CHART="setChart",V.SET_FLOAT_IMAGE="setFloatImage",V.CLICK_COPY="clickCopy",V.CLICK_CUT="clickCut",V.CLICK_PASTE="clickPaste",V.COPY_CELL_POSITION="copyCellPosition",V.ADD_BLOCK="addBlock",V.DEL_BLOCK="delBlock",V.COPY_BLOCK="copyBlock",V.ADD_ROW_OR_COL_AHEAD="addRowOrColAhead",V.ADD_ROW_OR_COL_BEHIND="addRowOrColBehind",V.PREV_ADD_ROW_OR_COL_BEHIND="prevAddRowOrColBehind",V.DEL_ROW_OR_COL="delRowOrCol",V.HIDE_ROW="hideRow",V.HIDE_COL="hideCol",V.UNHIDE_ROW="unhideRow",V.UNHIDE_COL="unhideCOl",V.PASTE_FORMAT="pasteFormat",V.TOGGLE_FORMULA_DISPLAY="toggleFormulaDisplay",V.TOOGLE_FORMULA_LIST="toogleFormulaList",V.DRAG_DROP_ROW_COL="dragDropRowCol",V.MOVE_RANGE="moveRange",V.SET_REMINDER="setReminder",V.ADD_REMINDER="addReminder",V.MODIFY_TO_STRING="modifyToString",V.SET_VALUE_BY_DATA_VALIDATION="setValueByDataValidation",V.SET_MULTIPLE_VALUES_BY_RANGE="setMultipleValuesByRange",V.CLEAR="clear",V.ADD_VIEW="add_\bview",V.DEL_VIEW="del_view",V.SET_VIEW="set_view",V.ENTERY_VIEW="enter_view",V.EXIT_VIEW="exit_view",V.SET_FILTER_VIEW="set_filter_view",V.SET_DATA_VALIDATION="setDataValidation",V.SET_LIST_DATA_VALIDATION="setListDataValidation",V.INSERT_CHECKBOXS="InsertCheckboxs",(H=H||{}).CONTEXT_MENU="CONTEXT_MENU",(Y=W=W||{}).CSV="CSV",Y.XLSX="XLSX",(z=K=K||{})[z.USER=0]="USER",z[z.DOC=1]="DOC",z[z.FOLDER=2]="FOLDER",z[z.SHEET=3]="SHEET",z[z.SHEET_DOC=4]="SHEET_DOC",z[z.CHAT=5]="CHAT",z[z.BITABLE=8]="BITABLE",z[z.MINDNOTE=11]="MINDNOTE",z[z.FILE=12]="FILE",z[z.SLIDE=15]="SLIDE",z[z.WIKI=16]="WIKI",(X=q=q||{})[X.DOC=1]="DOC",X[X.SHEET=3]="SHEET",X[X.BITABLE=8]="BITABLE",X[X.MINDNOTE=11]="MINDNOTE",X[X.BOX=12]="BOX",X[X.SLIDE=15]="SLIDE",X[X.WIKI=16]="WIKI",(Q=J=J||{})[Q.DOC=2]="DOC",Q[Q.SHEET=3]="SHEET",Q[Q.BITABLE=8]="BITABLE",Q[Q.MINDNOTE=11]="MINDNOTE",Q[Q.BOX=12]="BOX",Q[Q.SLIDE=15]="SLIDE",Q[Q.WIKI=16]="WIKI";var ie,ae,se,ce,ue,le;r={},x()(r,q.DOC,J.DOC),x()(r,q.SHEET,J.SHEET),x()(r,q.BITABLE,J.BITABLE),x()(r,q.MINDNOTE,J.MINDNOTE),x()(r,q.BOX,J.BOX),x()(r,q.SLIDE,J.SLIDE),x()(r,q.WIKI,J.WIKI);(ae=ie=ie||{}).FULL_BORDER="fullborder",ae.NO_BORDER="noborder",ae.OUTER_BORDER="outerborder",ae.INNER_BORDER="innerborder",ae.LEFT_BORDER="leftborder",ae.RIGHT_BORDER="rightborder",ae.TOP_BORDER="topborder",ae.BOTTOM_BORDER="bottomborder",(ce=se=se||{})[ce.RANGE=0]="RANGE",ce[ce.ROW=1]="ROW",ce[ce.COL=2]="COL",ce[ce.SHEET=3]="SHEET",(le=ue=ue||{})[le.NORMAL=0]="NORMAL",le[le.LARK=1]="LARK",le[le.LARK_CHAT_GROUP=2]="LARK_CHAT_GROUP",le[le.PUBLIC=4]="PUBLIC",le[le.SHARE_FOLDER=5]="SHARE_FOLDER",le[le.All=6]="All";var de,fe,pe,_e,Ee,he,me,Oe="sheet-protection-public-id";(fe=de=de||{})[fe.Normal=1]="Normal",fe[fe.Hidden=3]="Hidden",(_e=pe=pe||{}).CLIPBOARD_PASTE="clipboard_paste",_e.GET_PASTE_INFO="get_paste_info",_e.CLIPBOARD_COPY="clipboard_copy",_e.SERIALIZE_COPY_DATA="serialize_copy_data",_e.ACTIVE_CELL_CHANGE="active_cell_change",_e.ENTER_EDIT="enter_edit",(he=Ee=Ee||{}).MENTION_CLICK="MENTION_CLICK",he.ACTIVE_COMMENT_CHANGED="ACTIVE_COMMENT_CHANGED",he.CHART_SET_DEFAULT_SELECTION="CHART_SET_DEFAULT_SELECTION",he.ADD_ROW="ADD_ROW",he.ADD_COL="ADD_COL",he.DEL_ROW="DEL_ROW",he.DEL_COL="DEL_COL",(me=me||{}).SET_MENTION_ID="SET_MENTION_ID";var ye,ge,ve,be,Te,Re,Se=[9,10,11,12,14,18,24,30,36];(ge=ye=ye||{})[ge.NORMAL=0]="NORMAL",ge[ge.LARK_CHAT=1]="LARK_CHAT",ge[ge.IMPORT=2]="IMPORT",ge[ge.GOOGLE_IMPORT=3]="GOOGLE_IMPORT",ge[ge.DRIVE_IMPORT=4]="DRIVE_IMPORT",ge[ge.LARK_IMPORT=5]="LARK_IMPORT",ge[ge.MEETING=6]="MEETING",ge[ge.BEAR_COPY=7]="BEAR_COPY",ge[ge.TEMPLATE=8]="TEMPLATE",ge[ge.GROUP_ANNOUNCEMENT=9]="GROUP_ANNOUNCEMENT",ge[ge.SHEET_OPEN_API=10]="SHEET_OPEN_API",ge[ge.README_DOC=11]="README_DOC",ge[ge.COPYLINK_CLONE=12]="COPYLINK_CLONE",ge[ge.COPYLINK_NEW=13]="COPYLINK_NEW",ge[ge.LARK_CREATEDOC=14]="LARK_CREATEDOC",ge[ge.LARK_CREATE_CALENDER=15]="LARK_CREATE_CALENDER",ge[ge.SCAN=16]="SCAN",(be=ve=ve||{}).PASTING="pasting",be.PASTE_CANCELABLE="paste_cancelable",be.CHART_LOADING="chart_loading",(Re=Te=Te||{}).ALONE_SHEET="AloneSheet",Re.EMBED_SHEET="EmbedSheet",Re.EXCEL="Excel",Re.WORD="Word",Re.GOOGLE_SHEET="GoogleSheet",Re.SHIMO_SHEET="ShimoSheet",Re.SHIMO_Doc="ShimoDoc",Re.TIM_SHEET="TimSheet",Re.TIM_DOC="TimDoc",Re.OTHER="Other";var Ce,Ie,Ae,Le,Ne="sheet",we=3;(Ie=Ce=Ce||{}).REMOTE="sheets_history",Ie.LOCAL="local_record",Ie.DOC_MIXED="doc_mixed_history",(Le=Ae=Ae||{})[Le.V1=1]="V1";var De,ke="HEAD";(De=De||{}).Formulabar="Formulabar"},EzSe:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return f});var r=n("L9Vw"),o=n("2ACu"),i=n("iP/4"),a=n("VIFs"),s="link_clicked",c=function(e){if(i.a.isFeed)return e;var t={logParams:{location:r.SECURE_LINK_LOG.CCM_DOCS}};return Object(r.getSecureLink)(e,t)},u=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r.SECURE_LINK_LOG.CCM_DOCS;i.a.isFeed||Object(o.default)(s,{scene:r.SECURE_LINK_LOG.CCM_DOCS,location:e})};function l(e,t){var n;Object(a.isDocUrl)(e)?window.open(t):i.a.isChrome?window.open(t,"_blank","noopener"):(n=window.open(t,"_blank"))&&(n.opener=null)}function d(e){l(e,c(e)),u()}function f(e){i.a.isFeed&&l(e,e);var t={logParams:{location:r.SECURE_LINK_LOG.DOCS_SDK_COMMENT}};l(e,Object(r.getSecureLink)(e,t)),u(r.SECURE_LINK_LOG.DOCS_SDK_COMMENT)}},F2y5:function(e,t,n){"use strict";var r=n("wpDl"),o=Object(r.a)("floor");t.a=o},F8Eo:function(e,t,n){e.exports=n("vLSA")},FRmQ:function(e,t,n){n("vfRR");var r=n("oWnS");e.exports=r("Array").find},FvEI:function(e,t,n){n("UUWy"),n("Pkew"),e.exports=n("2fOL")},Gp6W:function(e,t,n){"use strict";var r=n("pVnL"),o=n.n(r),i=n("QILm"),a=n.n(i),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",o()({width:"120",height:"172",viewBox:"0 0 120 172",fill:"none"},t),c.a.createElement("path",{fill:"#F8F9FA",fillOpacity:".5",d:"M0 0h120v172H0z"}),c.a.createElement("path",{d:"M52 26c0-1.1.9-2 2-2h52a2 2 0 012 2v10a2 2 0 01-2 2H54a2 2 0 01-2-2V26z",fill:"url(#e4e49d98a793185789d3fd16a0fe872a-paint0_linear)"}),c.a.createElement("rect",{x:"52",y:"44",width:"36",height:"14",rx:"2",fill:"url(#e4e49d98a793185789d3fd16a0fe872a-paint1_linear)"}),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28 57a16 16 0 100-32 16 16 0 000 32z",fill:"url(#e4e49d98a793185789d3fd16a0fe872a-paint2_linear)"}),c.a.createElement("rect",{x:"12",y:"74",width:"96",height:"14",rx:"2",fill:"url(#e4e49d98a793185789d3fd16a0fe872a-paint3_linear)"}),c.a.createElement("rect",{x:"12",y:"104",width:"96",height:"14",rx:"2",fill:"url(#e4e49d98a793185789d3fd16a0fe872a-paint4_linear)"}),c.a.createElement("rect",{x:"12",y:"134",width:"96",height:"14",rx:"2",fill:"url(#e4e49d98a793185789d3fd16a0fe872a-paint5_linear)"}),c.a.createElement("defs",null,c.a.createElement("linearGradient",{id:"e4e49d98a793185789d3fd16a0fe872a-paint0_linear",x1:"52",y1:"38",x2:"109",y2:"38",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"})),c.a.createElement("linearGradient",{id:"e4e49d98a793185789d3fd16a0fe872a-paint1_linear",x1:"52",y1:"58",x2:"88",y2:"58",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"})),c.a.createElement("linearGradient",{id:"e4e49d98a793185789d3fd16a0fe872a-paint2_linear",x1:"12",y1:"57",x2:"44",y2:"57",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"})),c.a.createElement("linearGradient",{id:"e4e49d98a793185789d3fd16a0fe872a-paint3_linear",x1:"12",y1:"88",x2:"108",y2:"88",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"})),c.a.createElement("linearGradient",{id:"e4e49d98a793185789d3fd16a0fe872a-paint4_linear",x1:"12",y1:"118",x2:"108",y2:"118",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"})),c.a.createElement("linearGradient",{id:"e4e49d98a793185789d3fd16a0fe872a-paint5_linear",x1:"12",y1:"148",x2:"108",y2:"148",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"}))))}},H7XF:function(e,t,n){"use strict";t.byteLength=a,t.toByteArray=s,t.fromByteArray=E;for(var c=[],u=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,i=r.length;o<i;++o)c[o]=r[o],u[r.charCodeAt(o)]=o;function d(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function a(e){var t=d(e),n=t[0],r=t[1];return 3*(n+r)/4-r}function f(e,t,n){return 3*(t+n)/4-n}function s(e){for(var t,n=d(e),r=n[0],o=n[1],i=new l(f(e,r,o)),a=0,s=0<o?r-4:r,c=0;c<s;c+=4)t=u[e.charCodeAt(c)]<<18|u[e.charCodeAt(c+1)]<<12|u[e.charCodeAt(c+2)]<<6|u[e.charCodeAt(c+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=255&t;return 2===o&&(t=u[e.charCodeAt(c)]<<2|u[e.charCodeAt(c+1)]>>4,i[a++]=255&t),1===o&&(t=u[e.charCodeAt(c)]<<10|u[e.charCodeAt(c+1)]<<4|u[e.charCodeAt(c+2)]>>2,i[a++]=t>>8&255,i[a++]=255&t),i}function p(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function _(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(p(r));return o.join("")}function E(e){for(var t,n=e.length,r=n%3,o=[],i=16383,a=0,s=n-r;a<s;a+=i)o.push(_(e,a,s<a+i?s:a+i));return 1===r?(t=e[n-1],o.push(c[t>>2]+c[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(c[t>>10]+c[t>>4&63]+c[t<<2&63]+"=")),o.join("")}u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},HDXh:function(e,ne,re){"use strict";(function(e){var r=re("H7XF"),i=re("kVK+"),a=re("49sm");function t(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}function n(){return d.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return d.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=d.prototype:(null===e&&(e=new d(t)),e.length=t),e}function d(e,t,n){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(e,t,n);if("number"!=typeof e)return o(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}function o(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?_(e,t,n,r):"string"==typeof t?f(e,t,n):E(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,n,r){return c(t),!(t<=0)&&void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}function l(e,t){if(c(t),e=s(e,t<0?0:0|h(t)),!d.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!d.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|O(t,n),o=(e=s(e,r)).write(t,n);return o!==r&&(e=e.slice(0,o)),e}function p(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function _(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),d.TYPED_ARRAY_SUPPORT?(e=t).__proto__=d.prototype:e=p(e,t),e}function E(e,t){if(d.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||te(t.length)?s(e,0):p(e,t);if("Buffer"===t.type&&a(t.data))return p(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function h(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function m(e){return+e!=e&&(e=0),d.alloc(+e)}function O(e,t){if(d.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return J(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(e).length;default:if(r)return J(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return w(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return F(this,t,n);case"base64":return N(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=d.from(t,r)),d.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,o);if("number"==typeof t)return t&=255,d.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(o?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):b(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,o){var i=1,a=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a/=i=2,s/=2,n/=2}function c(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(o)for(var u=-1,l=n;l<a;l++)if(c(e,l)===c(t,-1===u?0:l-u)){if(-1===u&&(u=l),l-u+1===s)return u*i}else-1!==u&&(l-=l-u),u=-1;else for(a<n+s&&(n=a-s),l=n;0<=l;l--){for(var d=!0,f=0;f<s;f++)if(c(e,l+f)!==c(t,f)){d=!1;break}if(d)return l}return-1}function T(e,t,n,r){n=Number(n)||0;var o=e.length-n;(!r||o<(r=Number(r)))&&(r=o);var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");i/2<r&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function R(e,t,n,r){return ee(J(t,e.length-n),e,n,r)}function S(e,t,n,r){return ee(Q(t),e,n,r)}function C(e,t,n,r){return S(e,t,n,r)}function I(e,t,n,r){return ee($(t),e,n,r)}function L(e,t,n,r){return ee(Z(t,e.length-n),e,n,r)}function N(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function w(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,c,u=e[o],l=null,d=239<u?4:223<u?3:191<u?2:1;if(o+d<=n)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&127<(c=(31&u)<<6|63&i)&&(l=c);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&2047<(c=(15&u)<<12|(63&i)<<6|63&a)&&(c<55296||57343<c)&&(l=c);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&65535<(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)&&c<1114112&&(l=c)}null===l?(l=65533,d=1):65535<l&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=d}return k(r)}ne.Buffer=d,ne.SlowBuffer=m,ne.INSPECT_MAX_BYTES=50,d.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:t(),ne.kMaxLength=n(),d.poolSize=8192,d._augment=function(e){return e.__proto__=d.prototype,e},d.from=function(e,t,n){return o(null,e,t,n)},d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})),d.alloc=function(e,t,n){return u(null,e,t,n)},d.allocUnsafe=function(e){return l(null,e)},d.allocUnsafeSlow=function(e){return l(null,e)},d.isBuffer=function(e){return!(null==e||!e._isBuffer)},d.compare=function(e,t){if(!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);if(void 0===t)for(o=t=0;o<e.length;++o)t+=e[o].length;for(var n=d.allocUnsafe(t),r=0,o=0;o<e.length;++o){var i=e[o];if(!d.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,r),r+=i.length}return n},d.byteLength=O,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},d.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?w(this,0,e):y.apply(this,arguments)},d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",t=ne.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},d.prototype.compare=function(e,t,n,r,o){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(o<=r&&n<=t)return 0;if(o<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),c=this.slice(r,o),u=e.slice(t,n),l=0;l<s;++l)if(c[l]!==u[l]){i=c[l],a=u[l];break}return i<a?-1:a<i?1:0},d.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},d.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},d.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},d.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||o<n)&&(n=o),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var i=!1;;)switch(r){case"hex":return T(this,e,t,n);case"utf8":case"utf-8":return R(this,e,t,n);case"ascii":return S(this,e,t,n);case"latin1":case"binary":return C(this,e,t,n);case"base64":return I(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var D=4096;function k(e){var t=e.length;if(t<=D)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=D));return n}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function F(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function x(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||r<n)&&(n=r);for(var o="",i=t;i<n;++i)o+=X(e[i]);return o}function M(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function j(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function U(e,t,n,r,o,i){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<t||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function B(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function V(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function H(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function W(e,t,n,r,o){return o||H(e,t,n,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,n,r,23,4),n+4}function Y(e,t,n,r,o){return o||H(e,t,n,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,n,r,52,8),n+8}d.prototype.slice=function(e,t){var n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e),d.TYPED_ARRAY_SUPPORT)(o=this.subarray(e,t)).__proto__=d.prototype;else for(var r=t-e,o=new d(r,void 0),i=0;i<r;++i)o[i]=this[i+e];return o},d.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},d.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var r=this[e+--t],o=1;0<t&&(o*=256);)r+=this[e+--t]*o;return r},d.prototype.readUInt8=function(e,t){return t||j(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return t||j(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return t||j(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return t||j(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return t||j(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return(o*=128)<=r&&(r-=Math.pow(2,8*t)),r},d.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var r=t,o=1,i=this[e+--r];0<r&&(o*=256);)i+=this[e+--r]*o;return(o*=128)<=i&&(i-=Math.pow(2,8*t)),i},d.prototype.readInt8=function(e,t){return t||j(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){t||j(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},d.prototype.readInt16BE=function(e,t){t||j(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},d.prototype.readInt32LE=function(e,t){return t||j(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return t||j(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return t||j(e,4,this.length),i.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return t||j(e,4,this.length),i.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return t||j(e,8,this.length),i.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return t||j(e,8,this.length),i.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||U(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},d.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||U(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;0<=--o&&(i*=256);)this[t+o]=e/i&255;return t+n},d.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,1,255,0),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},d.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},d.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):V(this,e,t,!0),t+4},d.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},d.prototype.writeIntLE=function(e,t,n,r){var o;e=+e,t|=0,r||U(this,e,t,n,(o=Math.pow(2,8*n-1))-1,-o);var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},d.prototype.writeIntBE=function(e,t,n,r){var o;e=+e,t|=0,r||U(this,e,t,n,(o=Math.pow(2,8*n-1))-1,-o);var i=n-1,a=1,s=0;for(this[t+i]=255&e;0<=--i&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},d.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,1,127,-128),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},d.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},d.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):V(this,e,t,!0),t+4},d.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},d.prototype.writeFloatLE=function(e,t,n){return W(this,e,t,!0,n)},d.prototype.writeFloatBE=function(e,t,n){return W(this,e,t,!1,n)},d.prototype.writeDoubleLE=function(e,t,n){return Y(this,e,t,!0,n)},d.prototype.writeDoubleBE=function(e,t,n){return Y(this,e,t,!1,n)},d.prototype.copy=function(e,t,n,r){if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),t=t||0,0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;0<=o;--o)e[o+t]=this[o+n];else if(i<1e3||!d.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},d.prototype.fill=function(e,t,n,r){if("string"==typeof e){var o;if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1!==e.length||(o=e.charCodeAt(0))<256&&(e=o),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!d.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(s=t;s<n;++s)this[s]=e;else for(var i=d.isBuffer(e)?e:J(new d(e,r).toString()),a=i.length,s=0;s<n-t;++s)this[s+t]=i[s%a];return this};var K=/[^+\/0-9A-Za-z-_]/g;function z(e){if((e=q(e).replace(K,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function q(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function X(e){return e<16?"0"+e.toString(16):e.toString(16)}function J(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if(55295<(n=e.charCodeAt(a))&&n<57344){if(!o){if(56319<n){-1<(t-=3)&&i.push(239,191,189);continue}if(a+1===r){-1<(t-=3)&&i.push(239,191,189);continue}o=n;continue}if(n<56320){-1<(t-=3)&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&-1<(t-=3)&&i.push(239,191,189);if(o=null,n<128){if(--t<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function Q(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function Z(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}function $(e){return r.toByteArray(z(e))}function ee(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function te(e){return e!=e}}).call(this,re("yLpj"))},IQ5M:function(e,u,l){"use strict";(function(a){l.d(u,"d",function(){return e}),l.d(u,"c",function(){return t}),l.d(u,"b",function(){return n}),l.d(u,"a",function(){return c});var r=l("3doy"),o=l("QM+C"),i=l("ahx2"),s=l("n/R6");function e(e){var t=e.imgExceedLimit,n=e.imgNeedCharge,r=e.imgFailed,o=e.folderNotExist,i=[];t&&i.push(a("sheet.import_exceed_image_limit")),n&&i.push(a("common.storage_usage_limitation_body_upload")),r&&i.push(a("sheet.import_image_upload_error")),o&&i.push(a("sheet.import.folder_not_exist")),i.forEach(function(e){s.a.info({key:e,content:e,closable:!0,duration:c})})}function t(e){var t="";switch(e){case r.WarningType.CellCut:t=a("drive.upload_warning_cell_cut");break;case r.WarningType.ColumnAndCellCut:t=a("drive.upload_warning_cell_and_column_cut");break;case r.WarningType.ColumnCut:t=a("drive.upload_warning_column_cut")}return t}function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n="";switch(e){case r.FileErrorType.NumLimited:n=a("drive.import_num_limited");break;case r.FileErrorType.UnknownProblem:n=a("drive.import_unknown_problem");break;case r.FileErrorType.ForderNumLimited:n=a("drive.import_forder_num_limited");break;case r.FileErrorType.SizeLimited:n=a("common.file_size_exceeds_limit",20);break;case r.FileErrorType.EmptyFile:n=a("drive.import.import_empty_file");break;case r.FileErrorType.FileEncrypted:n=a("drive.import_encrypt_file_not_support");break;case r.FileErrorType.xmlVersionNotSupport:o.docImportableMimeTypes.includes(t)||o.docImportableTypes.includes(t)?n=a("drive.import_xml_version_not_support_ms_word"):(o.sheetImportableMimeTypes.includes(t)||o.sheetImportableTypes.includes(t))&&(n=a("drive.import_xml_version_not_support"));break;case r.FileErrorType.FolderNodeLimited:n=i.maxShareFolderNodeErrorTips}return n}var c=8e3}).call(this,l("2vAP"))},Ibn6:function(e,t,n){"use strict";function r(){var e=!1,t={get passive(){e=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch(e){}return e}t.a=r()},J6x8:function(e,t,n){e.exports=n("9Mno")},Jonh:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"g",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"i",function(){return l}),n.d(t,"f",function(){return d}),n.d(t,"e",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"c",function(){return _});var r=n("rLED"),o=n("ZGZ5"),i=n("D7h9"),a=Object(r.e)("doc_template_v3_custom_enabled"),s=Object(r.e)("doc_template_v3_mindnote_enabled"),c=Object(r.e)("doc_template_v3_from_v2"),u=Object(r.e)("doc_template_v3_corporate_enabled")&&!Object(o.d)(i.default.getState()),l=Object(r.e)("doc_template_v4_preview_enabled"),d=Object(r.e)("template_new_layout_enabled"),f=Object(r.e)("system_template_shared_enabled"),p=Object(r.e)("send_template_exposure_log_enable"),_=Object(r.e)("template_new_window_in_lark")},KgqQ:function(e,t,n){"use strict";var r=n("DK5n"),o=n("dmt9");e.exports=r("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},o,!0)},Kxu3:function(e,t,n){e.exports=n("BP/7")},LCeV:function(e,t,c){"use strict";c.d(t,"a",function(){return n});var u=c("uzgA"),l=c("5dbN");function n(e){var t=c("D7h9").default,n=Object(u.c)(t.getState()),r=Object(l.locateRoute)(),o=Object(l.locateRoute)(n),i=n&&o.isFolder,a=0<e.length,s="";return(r.isFolder||i)&&a&&(s=e[e.length-1].token),s}},LaPx:function(e,a,s){"use strict";(function(e){s.d(a,"d",function(){return n}),s.d(a,"c",function(){return r}),s.d(a,"b",function(){return o}),s.d(a,"a",function(){return i});var E=s("Xngx"),h=s("5dbN"),m=s("1dfU"),t=s("iP/4"),O=s("2ACu"),f=s("VQSS"),_=t.a.isLark&&!/electron/i.test(navigator.userAgent);function n(e){var t=e.action,n=void 0===t?"":t,r=e.fileToken,o=void 0===r?"":r,i=e.fileName,a=void 0===i?"":i,s=e.taskCount,c=void 0===s?1:s,u=e.eventType,l=void 0===u?"mouseclick":u,d=e.result,f=void 0===d?"":d,p=Object(E.d)(a),_=Object(h.getCurrentRouteObj)();Object(O.default)("client_file_upload",{action:n,product_type:"drive",event_type:l,file_id:o?Object(m.a)(o):"",file_type:"file",sub_file_type:p,module:_&&_.module?_.module:"",sub_module:"upload_layer",task_count:c,result:f})}function r(e){var t=e.action,n=e.fileTypeNum,r=e.size,o=e.finishedCount,i=e.totalCount,a=e.errorType,s=e.costTime,c=e.beginProgress,u=void 0===c?0:c,l=e.errorInfo,d=r&&s?Math.round(r*(1-u)/s*1e3):void 0;Object(O.default)("dev_client_file_lark_upload",Object(f.a)({action:t,file_type_num:n,size:r,finished_count:o,total_count:i,error_type:a,speed:d,cost_time:s,begin_progress:u,error_info:l}))}var y=e||t.a.isLarkWindow;function o(e){var t=e.action,n=void 0===t?"":t,r=e.fileToken,o=void 0===r?"":r,i=e.fileName,a=void 0===i?"":i,s=e.taskCount,c=void 0===s?1:s,u=e.fileTypeNum,l=e.message,d=void 0===l?"":l,f=Object(E.d)(a),p=Object(h.getCurrentRouteObj)();Object(O.default)("client_file_download",{action:n,product_type:"drive",event_type:"mouseclick",file_id:o?Object(m.a)(o):"",file_type:"file",sub_file_type:f,module:p&&p.module?p.module:"",sub_module:"download_layer",task_count:c,file_type_num:u,platform:_?"native":y?"lark":"web",message_detail:d})}function i(e){var t=e.action,n=e.fileTypeNum,r=e.size,o=e.finishedCount,i=e.totalCount,a=e.errorType,s=e.costTime,c=e.errorInfo,u=e.beginProgress,l=void 0===u?0:u,d=r&&s?Math.round(r*(1-l)/s*1e3):void 0;Object(O.default)("dev_client_file_download",Object(f.a)({action:t,file_type_num:n,size:r,finished_count:o,total_count:i,error_type:a,speed:d,cost_time:s,begin_progress:l,error_info:c}))}}).call(this,s("kCIs"))},LqQ0:function(e,lt,dt){"use strict";(function(e){dt.d(lt,"a",function(){return st}),dt.d(lt,"b",function(){return ct}),dt.d(lt,"c",function(){return at});var t=dt("cDf5"),r=dt.n(t),n=dt("YAKS"),o=dt.n(n),i=dt("vYB2"),a=dt.n(i),s=dt("HEbw"),h=dt.n(s);function p(e,a,s,c){return new(s=s||Promise)(function(n,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,o)}i((c=c.apply(e,a||[])).next())})}function _(n,r){var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((a=0<(a=s.trys).length&&a[a.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var u,l,d,f,E,m,O,y,g,v,b,T,R,S,C,I,L,N,w,D=o.a.Writer,k=o.a.util,P=o.a.roots.default||(o.a.roots.default={});function F(e){if(this.Events=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function x(e){if(this.Recipients=[],this.Objects=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function M(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function j(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function U(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function B(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function V(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function H(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function W(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function Y(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}P.security_event=((w={}).ModuleType=(u={},(l=Object.create(u))[u[0]="ModuleUnknown"]=0,l[u[1]="ModuleDocs"]=1,l[u[2]="ModuleSheets"]=2,l[u[3]="ModuleFiles"]=3,l[u[4]="ModuleFolders"]=4,l[u[5]="ModulePassport"]=5,l[u[6]="ModuleMindNote"]=6,l[u[7]="ModuleBitable"]=7,l[u[8]="ModuleSlide"]=8,l[u[9]="ModuleChat"]=9,l[u[10]="ModuleIMImageAndVideo"]=10,l[u[11]="ModuleVideo"]=11,l[u[12]="ModuleIMFile"]=12,l),w.ClientType=(L={},(N=Object.create(L))[L[0]="ClientUnknown"]=0,N[L[1]="ClientLarkPC"]=1,N[L[2]="ClientAndroid"]=2,N[L[3]="ClientIOS"]=3,N[L[4]="ClientWeb"]=4,N),w.FlagType=(C={},(I=Object.create(C))[C[0]="FlagNormal"]=0,I[C[1]="FlagTest"]=1,I[C[2]="FlagStress"]=2,I),w.OperationType=(R={},(S=Object.create(R))[R[0]="OperationTypeUnknown"]=0,S[R[1]="OperationCreate"]=1,S[R[2]="OperationRead"]=2,S[R[3]="OperationUpdate"]=3,S[R[4]="OperationDelete"]=4,S[R[5]="OperationComment"]=5,S[R[6]="OperationExport"]=6,S[R[7]="OperationDownload"]=7,S[R[8]="OperationPrint"]=8,S[R[9]="OperationUpdateCollaborator"]=9,S[R[10]="OperationShareTo3rdApp"]=10,S[R[11]="OperationUpdateShareSetting"]=11,S[R[12]="OperationFrontExport"]=12,S[R[13]="OperationOpenWith3rdApp"]=13,S[R[14]="OperationImport"]=14,S[R[15]="OperationLogin"]=15,S[R[16]="OperationJoin"]=16,S[R[17]="OperationQuit"]=17,S[R[18]="OperationSaveAs"]=18,S[R[19]="OperationCopyContent"]=19,S[R[20]="OperationForward"]=20,S),w.EntityType=(b={},(T=Object.create(b))[b[0]="EntityTypeUnknown"]=0,T[b[1]="EntityUserID"]=1,T[b[2]="EntityDepartmentID"]=2,T[b[3]="EntityTenantID"]=3,T[b[4]="EntityChatID"]=4,T[b[5]="EntityDocID"]=5,T[b[6]="EntitySheetID"]=6,T[b[7]="EntityFileID"]=7,T[b[8]="EntityFolderID"]=8,T[b[9]="EntityMindNoteID"]=9,T[b[10]="EntityBitableID"]=10,T[b[11]="EntitySlideID"]=11,T[b[12]="EntityBotID"]=12,T[b[13]="EntityVideoID"]=13,T[b[14]="EntityDriverSDKFileID"]=14,T[b[15]="EntityLink"]=15,T[b[16]="EntityChatter"]=16,T[b[17]="EntityImage"]=17,T[b[18]="EntityVideoIM"]=18,T[b[19]="EntityFileIM"]=19,T),w.PermissionSettingType=(g={},(v=Object.create(g))[g[0]="PermissionSettingTypeUnknown"]=0,v[g[1]="DisableLinkShare"]=1,v[g[2]="CanReadByLinkInTenant"]=2,v[g[3]="CanEditByLinkInTenant"]=3,v[g[4]="CanReadByLinkInInternet"]=4,v[g[5]="CanEditByLinkInInternet"]=5,v),w.PermissionActionType=(O={},(y=Object.create(O))[O[0]="PermissionActionTypeUnknown"]=0,y[O[1]="AddUser"]=1,y[O[2]="RemoveUser"]=2,y[O[3]="AddChat"]=3,y[O[4]="RemoveChat"]=4,y[O[5]="AddDepartment"]=5,y[O[6]="RemoveDepartment"]=6,y),w.CommentType=(E={},(m=Object.create(E))[E[0]="CommentTypeUnknown"]=0,m[E[1]="AddComment"]=1,m[E[2]="AddReply"]=2,m[E[3]="EditReply"]=3,m[E[4]="DeleteReply"]=4,m[E[5]="UpdateComment"]=5,m),w.AppDetail=(d={},(f=Object.create(d))[d[0]="AppDetailUnknown"]=0,f[d[1]="WeChat"]=1,f[d[2]="WeChatMoments"]=2,f[d[3]="QQ"]=3,f[d[4]="Weibo"]=4,f[d[5]="Others"]=5,f),w.ObjectDetail=(Y.prototype.CloneSource="",Y.prototype.TextDetail="",Y.prototype.FileName="",Y.prototype.ThirdPartyAppID="",Y.prototype.PermissionSettingType=0,Y.create=function(e){return new Y(e)},Y.encode=function(e,t){return t=t||D.create(),null!=e.CloneSource&&Object.hasOwnProperty.call(e,"CloneSource")&&t.uint32(10).string(e.CloneSource),null!=e.TextDetail&&Object.hasOwnProperty.call(e,"TextDetail")&&t.uint32(18).string(e.TextDetail),null!=e.FileName&&Object.hasOwnProperty.call(e,"FileName")&&t.uint32(26).string(e.FileName),null!=e.ThirdPartyAppID&&Object.hasOwnProperty.call(e,"ThirdPartyAppID")&&t.uint32(34).string(e.ThirdPartyAppID),null!=e.PermissionSettingType&&Object.hasOwnProperty.call(e,"PermissionSettingType")&&t.uint32(40).int32(e.PermissionSettingType),t},Y.verify=function(e){if("object"!=r()(e)||null===e)return"object expected";if(null!=e.CloneSource&&e.hasOwnProperty("CloneSource")&&!k.isString(e.CloneSource))return"CloneSource: string expected";if(null!=e.TextDetail&&e.hasOwnProperty("TextDetail")&&!k.isString(e.TextDetail))return"TextDetail: string expected";if(null!=e.FileName&&e.hasOwnProperty("FileName")&&!k.isString(e.FileName))return"FileName: string expected";if(null!=e.ThirdPartyAppID&&e.hasOwnProperty("ThirdPartyAppID")&&!k.isString(e.ThirdPartyAppID))return"ThirdPartyAppID: string expected";if(null!=e.PermissionSettingType&&e.hasOwnProperty("PermissionSettingType"))switch(e.PermissionSettingType){default:return"PermissionSettingType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:}return null},Y),w.RecipientDetail=(W.prototype.PermissionActionType=0,W.create=function(e){return new W(e)},W.encode=function(e,t){return t=t||D.create(),null!=e.PermissionActionType&&Object.hasOwnProperty.call(e,"PermissionActionType")&&t.uint32(8).int32(e.PermissionActionType),t},W.verify=function(e){if("object"!=r()(e)||null===e)return"object expected";if(null!=e.PermissionActionType&&e.hasOwnProperty("PermissionActionType"))switch(e.PermissionActionType){default:return"PermissionActionType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}return null},W),w.OperatorDetail=(H.create=function(e){return new H(e)},H.encode=function(e,t){return t=t||D.create()},H.verify=function(e){return"object"!=r()(e)||null===e?"object expected":null},H),w.Extend=(V.prototype.CommentType=0,V.prototype.AppDetail=0,V.prototype.CreateGroup=k.Long?k.Long.fromBits(0,0,!1):0,V.prototype.DismissGroup=k.Long?k.Long.fromBits(0,0,!1):0,V.create=function(e){return new V(e)},V.encode=function(e,t){return t=t||D.create(),null!=e.CommentType&&Object.hasOwnProperty.call(e,"CommentType")&&t.uint32(8).int32(e.CommentType),null!=e.AppDetail&&Object.hasOwnProperty.call(e,"AppDetail")&&t.uint32(16).int32(e.AppDetail),null!=e.CreateGroup&&Object.hasOwnProperty.call(e,"CreateGroup")&&t.uint32(24).int64(e.CreateGroup),null!=e.DismissGroup&&Object.hasOwnProperty.call(e,"DismissGroup")&&t.uint32(32).int64(e.DismissGroup),t},V.verify=function(e){if("object"!=r()(e)||null===e)return"object expected";if(null!=e.CommentType&&e.hasOwnProperty("CommentType"))switch(e.CommentType){default:return"CommentType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:}if(null!=e.AppDetail&&e.hasOwnProperty("AppDetail"))switch(e.AppDetail){default:return"AppDetail: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:}return null!=e.CreateGroup&&e.hasOwnProperty("CreateGroup")&&!(k.isInteger(e.CreateGroup)||e.CreateGroup&&k.isInteger(e.CreateGroup.low)&&k.isInteger(e.CreateGroup.high))?"CreateGroup: integer|Long expected":null!=e.DismissGroup&&e.hasOwnProperty("DismissGroup")&&!(k.isInteger(e.DismissGroup)||e.DismissGroup&&k.isInteger(e.DismissGroup.low)&&k.isInteger(e.DismissGroup.high))?"DismissGroup: integer|Long expected":null},V),w.Env=(B.prototype.Client=0,B.prototype.DID="",B.prototype.Location="",B.prototype.UA="",B.prototype.IP="",B.prototype.Flag=0,B.create=function(e){return new B(e)},B.encode=function(e,t){return t=t||D.create(),null!=e.Client&&Object.hasOwnProperty.call(e,"Client")&&t.uint32(8).int32(e.Client),null!=e.DID&&Object.hasOwnProperty.call(e,"DID")&&t.uint32(18).string(e.DID),null!=e.Location&&Object.hasOwnProperty.call(e,"Location")&&t.uint32(26).string(e.Location),null!=e.UA&&Object.hasOwnProperty.call(e,"UA")&&t.uint32(34).string(e.UA),null!=e.IP&&Object.hasOwnProperty.call(e,"IP")&&t.uint32(42).string(e.IP),null!=e.Flag&&Object.hasOwnProperty.call(e,"Flag")&&t.uint32(48).int32(e.Flag),t},B.verify=function(e){if("object"!=r()(e)||null===e)return"object expected";if(null!=e.Client&&e.hasOwnProperty("Client"))switch(e.Client){default:return"Client: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(null!=e.DID&&e.hasOwnProperty("DID")&&!k.isString(e.DID))return"DID: string expected";if(null!=e.Location&&e.hasOwnProperty("Location")&&!k.isString(e.Location))return"Location: string expected";if(null!=e.UA&&e.hasOwnProperty("UA")&&!k.isString(e.UA))return"UA: string expected";if(null!=e.IP&&e.hasOwnProperty("IP")&&!k.isString(e.IP))return"IP: string expected";if(null!=e.Flag&&e.hasOwnProperty("Flag"))switch(e.Flag){default:return"Flag: enum value expected";case 0:case 1:case 2:}return null},B),w.OperatorEntity=(U.prototype.Type=0,U.prototype.Value="",U.prototype.Detail=null,U.create=function(e){return new U(e)},U.encode=function(e,t){return(t=t||D.create()).uint32(8).int32(e.Type),t.uint32(18).string(e.Value),null!=e.Detail&&Object.hasOwnProperty.call(e,"Detail")&&P.security_event.OperatorDetail.encode(e.Detail,t.uint32(26).fork()).ldelim(),t},U.verify=function(e){if("object"!=r()(e)||null===e)return"object expected";switch(e.Type){default:return"Type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:}if(!k.isString(e.Value))return"Value: string expected";if(null!=e.Detail&&e.hasOwnProperty("Detail")){var t=P.security_event.OperatorDetail.verify(e.Detail);if(t)return"Detail."+t}return null},U),w.RecipientEntity=(j.prototype.Type=0,j.prototype.Value="",j.prototype.Detail=null,j.create=function(e){return new j(e)},j.encode=function(e,t){return(t=t||D.create()).uint32(8).int32(e.Type),t.uint32(18).string(e.Value),null!=e.Detail&&Object.hasOwnProperty.call(e,"Detail")&&P.security_event.RecipientDetail.encode(e.Detail,t.uint32(26).fork()).ldelim(),t},j.verify=function(e){if("object"!=r()(e)||null===e)return"object expected";switch(e.Type){default:return"Type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:}if(!k.isString(e.Value))return"Value: string expected";if(null!=e.Detail&&e.hasOwnProperty("Detail")){var t=P.security_event.RecipientDetail.verify(e.Detail);if(t)return"Detail."+t}return null},j),w.ObjectEntity=(M.prototype.Type=0,M.prototype.Value="",M.prototype.Detail=null,M.create=function(e){return new M(e)},M.encode=function(e,t){return(t=t||D.create()).uint32(8).int32(e.Type),t.uint32(18).string(e.Value),null!=e.Detail&&Object.hasOwnProperty.call(e,"Detail")&&P.security_event.ObjectDetail.encode(e.Detail,t.uint32(26).fork()).ldelim(),t},M.verify=function(e){if("object"!=r()(e)||null===e)return"object expected";switch(e.Type){default:return"Type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:}if(!k.isString(e.Value))return"Value: string expected";if(null!=e.Detail&&e.hasOwnProperty("Detail")){var t=P.security_event.ObjectDetail.verify(e.Detail);if(t)return"Detail."+t}return null},M),w.Event=(x.prototype.Module=0,x.prototype.Operation=0,x.prototype.TimeStamp="",x.prototype.TenantID="",x.prototype.Operator=null,x.prototype.Recipients=k.emptyArray,x.prototype.Objects=k.emptyArray,x.prototype.Env=null,x.prototype.Extend=null,x.create=function(e){return new x(e)},x.encode=function(e,t){if((t=t||D.create()).uint32(8).int32(e.Module),t.uint32(16).int32(e.Operation),t.uint32(26).string(e.TimeStamp),null!=e.TenantID&&Object.hasOwnProperty.call(e,"TenantID")&&t.uint32(34).string(e.TenantID),P.security_event.OperatorEntity.encode(e.Operator,t.uint32(42).fork()).ldelim(),null!=e.Recipients&&e.Recipients.length)for(var n=0;n<e.Recipients.length;++n)P.security_event.RecipientEntity.encode(e.Recipients[n],t.uint32(50).fork()).ldelim();if(null!=e.Objects&&e.Objects.length)for(n=0;n<e.Objects.length;++n)P.security_event.ObjectEntity.encode(e.Objects[n],t.uint32(58).fork()).ldelim();return null!=e.Env&&Object.hasOwnProperty.call(e,"Env")&&P.security_event.Env.encode(e.Env,t.uint32(66).fork()).ldelim(),null!=e.Extend&&Object.hasOwnProperty.call(e,"Extend")&&P.security_event.Extend.encode(e.Extend,t.uint32(74).fork()).ldelim(),t},x.verify=function(e){if("object"!=r()(e)||null===e)return"object expected";switch(e.Module){default:return"Module: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}switch(e.Operation){default:return"Operation: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:}if(!k.isString(e.TimeStamp))return"TimeStamp: string expected";if(null!=e.TenantID&&e.hasOwnProperty("TenantID")&&!k.isString(e.TenantID))return"TenantID: string expected";if(n=P.security_event.OperatorEntity.verify(e.Operator))return"Operator."+n;if(null!=e.Recipients&&e.hasOwnProperty("Recipients")){if(!Array.isArray(e.Recipients))return"Recipients: array expected";for(var t=0;t<e.Recipients.length;++t)if(n=P.security_event.RecipientEntity.verify(e.Recipients[t]))return"Recipients."+n}if(null!=e.Objects&&e.hasOwnProperty("Objects")){if(!Array.isArray(e.Objects))return"Objects: array expected";for(t=0;t<e.Objects.length;++t){var n;if(n=P.security_event.ObjectEntity.verify(e.Objects[t]))return"Objects."+n}}return null!=e.Env&&e.hasOwnProperty("Env")&&(n=P.security_event.Env.verify(e.Env))?"Env."+n:null!=e.Extend&&e.hasOwnProperty("Extend")&&(n=P.security_event.Extend.verify(e.Extend))?"Extend."+n:null},x),w.EventsRequest=(F.prototype.Events=k.emptyArray,F.create=function(e){return new F(e)},F.encode=function(e,t){if(t=t||D.create(),null!=e.Events&&e.Events.length)for(var n=0;n<e.Events.length;++n)P.security_event.Event.encode(e.Events[n],t.uint32(10).fork()).ldelim();return t},F.verify=function(e){if("object"!=r()(e)||null===e)return"object expected";if(null!=e.Events&&e.hasOwnProperty("Events")){if(!Array.isArray(e.Events))return"Events: array expected";for(var t=0;t<e.Events.length;++t){var n=P.security_event.Event.verify(e.Events[t]);if(n)return"Events."+n}}return null},F),w);var K,z,q,X,J,Q,Z,$=P,ee=o.a.Reader,te=o.a.Writer,ne=o.a.util,re=o.a.roots.default||(o.a.roots.default={});function oe(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function ie(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function ae(e){if(this.operate_permission_data=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function se(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function ce(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function ue(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}re.authorization=((Z={}).PermissionType=(K={},(z=Object.create(K))[K[0]="PERMISSION_TYPE_UNKNOWN"]=0,z[K[1]="FILE_UPLOAD"]=1,z[K[2]="FILE_IMPORT"]=2,z[K[3]="FILE_DOWNLOAD"]=3,z[K[4]="FILE_EXPORT"]=4,z[K[5]="FILE_PRINT"]=5,z[K[6]="FILE_APP_OPEN"]=6,z[K[7]="FILE_ACCESS_FOLDER"]=7,z[K[8]="FILE_READ"]=8,z[K[9]="FILE_EDIT"]=9,z[K[10]="FILE_COMMENT"]=10,z[K[11]="FILE_COPY"]=11,z[K[12]="FILE_DELETE"]=12,z[K[13]="FILE_SHARE"]=13,z[K[14]="SEARCH"]=14,z),Z.PushPermissionEvent=(ue.create=function(e){return new ue(e)},ue.encode=function(e,t){return t=t||te.create()},ue.decode=function(e,t){e instanceof ee||(e=ee.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new re.authorization.PushPermissionEvent;e.pos<n;){var o=e.uint32();e.skipType(7&o)}return r},ue.fromObject=function(e){return e instanceof re.authorization.PushPermissionEvent?e:new re.authorization.PushPermissionEvent},ue.toObject=function(){return{}},ue.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},ue),Z.ResultType=(J={},(Q=Object.create(J))[J[0]="RESULT_TYPE_UNKNOWN"]=0,Q[J[1]="Deny"]=1,Q[J[2]="Allow"]=2,Q[J[3]="Null"]=3,Q),Z.EntityType=(q={},(X=Object.create(q))[q[0]="ENTITY_TYPE_UNKNOWN"]=0,X[q[1]="ANY"]=1,X[q[2]="USER"]=2,X[q[3]="IM_IMAGE"]=3,X[q[4]="IM_VIDEO"]=4,X[q[5]="IM_FILE"]=5,X[q[6]="CCM_DOC"]=6,X[q[7]="CCM_SHEET"]=7,X[q[8]="CCM_BITABLE"]=8,X[q[9]="CCM_MINDNOTE"]=9,X[q[10]="CCM_FILE"]=10,X[q[11]="CCM_SLIDE"]=11,X),Z.Entity=(ce.prototype.id="",ce.prototype.entity_type=0,ce.create=function(e){return new ce(e)},ce.encode=function(e,t){return(t=t||te.create()).uint32(10).string(e.id),t.uint32(16).int32(e.entity_type),t},ce.decode=function(e,t){e instanceof ee||(e=ee.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new re.authorization.Entity;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.id=e.string();break;case 2:r.entity_type=e.int32();break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("id"))throw ne.ProtocolError("missing required 'id'",{instance:r});if(!r.hasOwnProperty("entity_type"))throw ne.ProtocolError("missing required 'entity_type'",{instance:r});return r},ce.fromObject=function(e){if(e instanceof re.authorization.Entity)return e;var t=new re.authorization.Entity;switch(null!=e.id&&(t.id=String(e.id)),e.entity_type){case"ENTITY_TYPE_UNKNOWN":case 0:t.entity_type=0;break;case"ANY":case 1:t.entity_type=1;break;case"USER":case 2:t.entity_type=2;break;case"IM_IMAGE":case 3:t.entity_type=3;break;case"IM_VIDEO":case 4:t.entity_type=4;break;case"IM_FILE":case 5:t.entity_type=5;break;case"CCM_DOC":case 6:t.entity_type=6;break;case"CCM_SHEET":case 7:t.entity_type=7;break;case"CCM_BITABLE":case 8:t.entity_type=8;break;case"CCM_MINDNOTE":case 9:t.entity_type=9;break;case"CCM_FILE":case 10:t.entity_type=10;break;case"CCM_SLIDE":case 11:t.entity_type=11}return t},ce.toObject=function(e,t){var n={};return(t=t||{}).defaults&&(n.id="",n.entity_type=t.enums===String?"ENTITY_TYPE_UNKNOWN":0),null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),null!=e.entity_type&&e.hasOwnProperty("entity_type")&&(n.entity_type=t.enums===String?re.authorization.EntityType[e.entity_type]:e.entity_type),n},ce.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},ce),Z.OperatePermission=(se.prototype.perm_type=0,se.prototype.result=0,se.prototype.object=null,se.create=function(e){return new se(e)},se.encode=function(e,t){return(t=t||te.create()).uint32(8).int32(e.perm_type),t.uint32(16).int32(e.result),re.authorization.Entity.encode(e.object,t.uint32(26).fork()).ldelim(),t},se.decode=function(e,t){e instanceof ee||(e=ee.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new re.authorization.OperatePermission;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.perm_type=e.int32();break;case 2:r.result=e.int32();break;case 3:r.object=re.authorization.Entity.decode(e,e.uint32());break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("perm_type"))throw ne.ProtocolError("missing required 'perm_type'",{instance:r});if(!r.hasOwnProperty("result"))throw ne.ProtocolError("missing required 'result'",{instance:r});if(!r.hasOwnProperty("object"))throw ne.ProtocolError("missing required 'object'",{instance:r});return r},se.fromObject=function(e){if(e instanceof re.authorization.OperatePermission)return e;var t=new re.authorization.OperatePermission;switch(e.perm_type){case"PERMISSION_TYPE_UNKNOWN":case 0:t.perm_type=0;break;case"FILE_UPLOAD":case 1:t.perm_type=1;break;case"FILE_IMPORT":case 2:t.perm_type=2;break;case"FILE_DOWNLOAD":case 3:t.perm_type=3;break;case"FILE_EXPORT":case 4:t.perm_type=4;break;case"FILE_PRINT":case 5:t.perm_type=5;break;case"FILE_APP_OPEN":case 6:t.perm_type=6;break;case"FILE_ACCESS_FOLDER":case 7:t.perm_type=7;break;case"FILE_READ":case 8:t.perm_type=8;break;case"FILE_EDIT":case 9:t.perm_type=9;break;case"FILE_COMMENT":case 10:t.perm_type=10;break;case"FILE_COPY":case 11:t.perm_type=11;break;case"FILE_DELETE":case 12:t.perm_type=12;break;case"FILE_SHARE":case 13:t.perm_type=13;break;case"SEARCH":case 14:t.perm_type=14}switch(e.result){case"RESULT_TYPE_UNKNOWN":case 0:t.result=0;break;case"Deny":case 1:t.result=1;break;case"Allow":case 2:t.result=2;break;case"Null":case 3:t.result=3}if(null!=e.object){if("object"!=r()(e.object))throw TypeError(".authorization.OperatePermission.object: object expected");t.object=re.authorization.Entity.fromObject(e.object)}return t},se.toObject=function(e,t){var n={};return(t=t||{}).defaults&&(n.perm_type=t.enums===String?"PERMISSION_TYPE_UNKNOWN":0,n.result=t.enums===String?"RESULT_TYPE_UNKNOWN":0,n.object=null),null!=e.perm_type&&e.hasOwnProperty("perm_type")&&(n.perm_type=t.enums===String?re.authorization.PermissionType[e.perm_type]:e.perm_type),null!=e.result&&e.hasOwnProperty("result")&&(n.result=t.enums===String?re.authorization.ResultType[e.result]:e.result),null!=e.object&&e.hasOwnProperty("object")&&(n.object=re.authorization.Entity.toObject(e.object,t)),n},se.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},se),Z.AllPermissionData=(ae.prototype.update_time=ne.Long?ne.Long.fromBits(0,0,!1):0,ae.prototype.expire_time=ne.Long?ne.Long.fromBits(0,0,!1):0,ae.prototype.operate_permission_data=ne.emptyArray,ae.create=function(e){return new ae(e)},ae.encode=function(e,t){if((t=t||te.create()).uint32(8).int64(e.update_time),t.uint32(16).int64(e.expire_time),null!=e.operate_permission_data&&e.operate_permission_data.length)for(var n=0;n<e.operate_permission_data.length;++n)re.authorization.OperatePermission.encode(e.operate_permission_data[n],t.uint32(26).fork()).ldelim();return t},ae.decode=function(e,t){e instanceof ee||(e=ee.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new re.authorization.AllPermissionData;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.update_time=e.int64();break;case 2:r.expire_time=e.int64();break;case 3:r.operate_permission_data&&r.operate_permission_data.length||(r.operate_permission_data=[]),r.operate_permission_data.push(re.authorization.OperatePermission.decode(e,e.uint32()));break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("update_time"))throw ne.ProtocolError("missing required 'update_time'",{instance:r});if(!r.hasOwnProperty("expire_time"))throw ne.ProtocolError("missing required 'expire_time'",{instance:r});return r},ae.fromObject=function(e){if(e instanceof re.authorization.AllPermissionData)return e;var t=new re.authorization.AllPermissionData;if(null!=e.update_time&&(ne.Long?(t.update_time=ne.Long.fromValue(e.update_time)).unsigned=!1:"string"==typeof e.update_time?t.update_time=parseInt(e.update_time,10):"number"==typeof e.update_time?t.update_time=e.update_time:"object"==r()(e.update_time)&&(t.update_time=new ne.LongBits(e.update_time.low>>>0,e.update_time.high>>>0).toNumber())),null!=e.expire_time&&(ne.Long?(t.expire_time=ne.Long.fromValue(e.expire_time)).unsigned=!1:"string"==typeof e.expire_time?t.expire_time=parseInt(e.expire_time,10):"number"==typeof e.expire_time?t.expire_time=e.expire_time:"object"==r()(e.expire_time)&&(t.expire_time=new ne.LongBits(e.expire_time.low>>>0,e.expire_time.high>>>0).toNumber())),e.operate_permission_data){if(!Array.isArray(e.operate_permission_data))throw TypeError(".authorization.AllPermissionData.operate_permission_data: array expected");t.operate_permission_data=[];for(var n=0;n<e.operate_permission_data.length;++n){if("object"!=r()(e.operate_permission_data[n]))throw TypeError(".authorization.AllPermissionData.operate_permission_data: object expected");t.operate_permission_data[n]=re.authorization.OperatePermission.fromObject(e.operate_permission_data[n])}}return t},ae.toObject=function(e,t){var n,r={};if(((t=t||{}).arrays||t.defaults)&&(r.operate_permission_data=[]),t.defaults&&(ne.Long?(n=new ne.Long(0,0,!1),r.update_time=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.update_time=t.longs===String?"0":0,ne.Long?(n=new ne.Long(0,0,!1),r.expire_time=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.expire_time=t.longs===String?"0":0),null!=e.update_time&&e.hasOwnProperty("update_time")&&("number"==typeof e.update_time?r.update_time=t.longs===String?String(e.update_time):e.update_time:r.update_time=t.longs===String?ne.Long.prototype.toString.call(e.update_time):t.longs===Number?new ne.LongBits(e.update_time.low>>>0,e.update_time.high>>>0).toNumber():e.update_time),null!=e.expire_time&&e.hasOwnProperty("expire_time")&&("number"==typeof e.expire_time?r.expire_time=t.longs===String?String(e.expire_time):e.expire_time:r.expire_time=t.longs===String?ne.Long.prototype.toString.call(e.expire_time):t.longs===Number?new ne.LongBits(e.expire_time.low>>>0,e.expire_time.high>>>0).toNumber():e.expire_time),e.operate_permission_data&&e.operate_permission_data.length){r.operate_permission_data=[];for(var o=0;o<e.operate_permission_data.length;++o)r.operate_permission_data[o]=re.authorization.OperatePermission.toObject(e.operate_permission_data[o],t)}return r},ae.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},ae),Z.PullPermissionRequest=(ie.prototype.app_id=ne.Long?ne.Long.fromBits(0,0,!1):0,ie.prototype.api_version="",ie.prototype.perm_version="",ie.create=function(e){return new ie(e)},ie.encode=function(e,t){return(t=t||te.create()).uint32(8).int64(e.app_id),t.uint32(18).string(e.api_version),t.uint32(26).string(e.perm_version),t},ie.decode=function(e,t){e instanceof ee||(e=ee.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new re.authorization.PullPermissionRequest;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.app_id=e.int64();break;case 2:r.api_version=e.string();break;case 3:r.perm_version=e.string();break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("app_id"))throw ne.ProtocolError("missing required 'app_id'",{instance:r});if(!r.hasOwnProperty("api_version"))throw ne.ProtocolError("missing required 'api_version'",{instance:r});if(!r.hasOwnProperty("perm_version"))throw ne.ProtocolError("missing required 'perm_version'",{instance:r});return r},ie.fromObject=function(e){if(e instanceof re.authorization.PullPermissionRequest)return e;var t=new re.authorization.PullPermissionRequest;return null!=e.app_id&&(ne.Long?(t.app_id=ne.Long.fromValue(e.app_id)).unsigned=!1:"string"==typeof e.app_id?t.app_id=parseInt(e.app_id,10):"number"==typeof e.app_id?t.app_id=e.app_id:"object"==r()(e.app_id)&&(t.app_id=new ne.LongBits(e.app_id.low>>>0,e.app_id.high>>>0).toNumber())),null!=e.api_version&&(t.api_version=String(e.api_version)),null!=e.perm_version&&(t.perm_version=String(e.perm_version)),t},ie.toObject=function(e,t){var n,r={};return(t=t||{}).defaults&&(ne.Long?(n=new ne.Long(0,0,!1),r.app_id=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.app_id=t.longs===String?"0":0,r.api_version="",r.perm_version=""),null!=e.app_id&&e.hasOwnProperty("app_id")&&("number"==typeof e.app_id?r.app_id=t.longs===String?String(e.app_id):e.app_id:r.app_id=t.longs===String?ne.Long.prototype.toString.call(e.app_id):t.longs===Number?new ne.LongBits(e.app_id.low>>>0,e.app_id.high>>>0).toNumber():e.app_id),null!=e.api_version&&e.hasOwnProperty("api_version")&&(r.api_version=e.api_version),null!=e.perm_version&&e.hasOwnProperty("perm_version")&&(r.perm_version=e.perm_version),r},ie.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},ie),Z.PullPermissionResponse=(oe.prototype.permission_data=null,oe.prototype.clear_old=!1,oe.prototype.perm_version="",oe.create=function(e){return new oe(e)},oe.encode=function(e,t){return t=t||te.create(),re.authorization.AllPermissionData.encode(e.permission_data,t.uint32(10).fork()).ldelim(),t.uint32(16).bool(e.clear_old),t.uint32(26).string(e.perm_version),t},oe.decode=function(e,t){e instanceof ee||(e=ee.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new re.authorization.PullPermissionResponse;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.permission_data=re.authorization.AllPermissionData.decode(e,e.uint32());break;case 2:r.clear_old=e.bool();break;case 3:r.perm_version=e.string();break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("permission_data"))throw ne.ProtocolError("missing required 'permission_data'",{instance:r});if(!r.hasOwnProperty("clear_old"))throw ne.ProtocolError("missing required 'clear_old'",{instance:r});if(!r.hasOwnProperty("perm_version"))throw ne.ProtocolError("missing required 'perm_version'",{instance:r});return r},oe.fromObject=function(e){if(e instanceof re.authorization.PullPermissionResponse)return e;var t=new re.authorization.PullPermissionResponse;if(null!=e.permission_data){if("object"!=r()(e.permission_data))throw TypeError(".authorization.PullPermissionResponse.permission_data: object expected");t.permission_data=re.authorization.AllPermissionData.fromObject(e.permission_data)}return null!=e.clear_old&&(t.clear_old=Boolean(e.clear_old)),null!=e.perm_version&&(t.perm_version=String(e.perm_version)),t},oe.toObject=function(e,t){var n={};return(t=t||{}).defaults&&(n.permission_data=null,n.clear_old=!1,n.perm_version=""),null!=e.permission_data&&e.hasOwnProperty("permission_data")&&(n.permission_data=re.authorization.AllPermissionData.toObject(e.permission_data,t)),null!=e.clear_old&&e.hasOwnProperty("clear_old")&&(n.clear_old=e.clear_old),null!=e.perm_version&&e.hasOwnProperty("perm_version")&&(n.perm_version=e.perm_version),n},oe.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},oe),Z);var le,de,fe,pe,_e=re;(pe=le=le||{})[pe.Success=0]="Success",pe[pe.Error=1]="Error",(fe=de=de||{})[fe.Allow=0]="Allow",fe[fe.Deny=1]="Deny",fe[fe.Null=2]="Null";var Ee,he=(Re.isOn=!1,Re.method=console.log,Re.updateIsOn=function(e){Re.isOn=Boolean(e),"[object Function]"===Object.prototype.toString.apply(e)&&(Re.method=e)},Re),me=(Te.prototype.useDatabase=function(t){t.onversionchange=function(e){t.close()}},Te.prototype.open=function(){var o=this;return new Promise(function(t,n){var r;o.db?t(o.db):((r=o.database.open(o.databaseName,o.databaseVersion)).onerror=function(e){o.log("open db error, event=",e),n(e)},r.onsuccess=function(e){o.log("open db success"),o.db=r.result,o.useDatabase(o.db),t(o.db)},r.onupgradeneeded=function(e){o.log("create db success"),o.db=e.target.result,o.storeList.forEach(function(e){o.db.objectStoreNames.contains(e)||o.db.createObjectStore(e,{keyPath:"key"})}),o.useDatabase(o.db),t(o.db)},r.onblocked=function(){o.log("open db blocked")})})},Te.prototype.add=function(r,o){var i=this,a=o.key;return new Promise(function(t,n){var e=i.db.transaction(r,"readwrite").objectStore(r).add(o);e.onsuccess=function(e){i.log("add data success, store=",r,"key=",a),t(a)},e.onerror=function(e){i.log("add data error, store=",r,"key=",a),n(e)}})},Te.prototype.put=function(r,o){var i=this,a=o.key;return new Promise(function(t,n){var e=i.db.transaction(r,"readwrite").objectStore(r).put(o);e.onsuccess=function(e){i.log("put data success, store=",r,"key=",a),t(a)},e.onerror=function(e){i.log("put data error, store=",r,"key=",a),n(e)}})},Te.prototype.read=function(o,i){var a=this;return new Promise(function(t,n){var r=a.db.transaction(o).objectStore(o).get(i);r.onsuccess=function(e){r.result?(a.log("read data success, store=",o,"key=",i),t(r.result)):(a.log("read data null, store=",o,"key=",i),n(e))},r.onerror=function(e){a.log("read data error, store=",o,"key=",i),n(e)}})},Te.prototype.remove=function(r,o){var i=this;return new Promise(function(t,n){var e=i.db.transaction(r,"readwrite").objectStore(r).delete(o);e.onsuccess=function(e){i.log("remove data success, store=",r,"key=",o),t(o)},e.onerror=function(e){i.log("remove data error, store=",r,"key=",o),n(e)}})},Te.prototype.readMulti=function(r,e){void 0===e&&(e=10);var o=this,i=e,a=[];return console.log("ppp"),new Promise(function(n,t){var e=o.db.transaction(r).objectStore(r).openCursor();e.onsuccess=function(e){var t=e.target.result;if(!t)return o.log("read multi data no more store=",r),void n(a);a.push("sss"),console.log(JSON.stringify(t.value)),t.continue(),--i<=0&&(o.log("read multi data reach count store=",r),n(a))},e.onerror=function(e){o.log("read multi data error store=",r),t(e)}})},Te.prototype.get=function(o,i){var a=this;return new Promise(function(t,n){var r=a.db.transaction(o,"readwrite").objectStore(o).get(i);r.onsuccess=function(e){a.log("get data success, store=",o,"key=",i),t(r.result)},r.onerror=function(e){a.log("get data error, store=",o,"key=",i),n(e)}})},Te.prototype.getAll=function(r){var o=this;return new Promise(function(t,n){var e=o.db.transaction(r).objectStore(r).getAll();e.onsuccess=function(e){o.log("get all data success store=",r),t(e.target.result)},e.onerror=function(e){o.log("get all data error store=",r),n(e)}})},Te.prototype.count=function(r){var o=this;return new Promise(function(e,t){var n=o.db.transaction(r).objectStore(r).count();n.onsuccess=function(){e(n.result)},n.onerror=function(e){t(e)}})},Te),Oe="event_temp",ye="event_fail",ge="authority",ve=(be.prototype.add=function(o){return p(this,void 0,void 0,function(){var t,n,r;return _(this,function(e){switch(e.label){case 0:t=this.storeName,n="",e.label=1;case 1:return e.trys.push([1,5,,6]),[4,this.count()];case 2:return e.sent()<this.maxNum?[4,be.idb.add(t,o)]:[3,4];case 3:n=e.sent(),e.label=4;case 4:return[3,6];case 5:return r=e.sent(),this.log("add fail e=",r),[3,6];case 6:return[2,n]}})})},be.prototype.put=function(r){return p(this,void 0,void 0,function(){var t,n;return _(this,function(e){switch(e.label){case 0:t=this.storeName,e.label=1;case 1:return e.trys.push([1,7,,8]),[4,this.get(r.key)];case 2:return e.sent()?[3,4]:[4,this.add(r)];case 3:return e.sent(),[3,6];case 4:return[4,be.idb.put(t,r)];case 5:e.sent(),e.label=6;case 6:return[3,8];case 7:return n=e.sent(),this.log("put fail e=",n),[3,8];case 8:return[2,r.key]}})})},be.prototype.remove=function(r){return p(this,void 0,void 0,function(){var t,n;return _(this,function(e){switch(e.label){case 0:if(t=this.storeName,!r)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,be.idb.remove(t,r)];case 2:return e.sent(),[3,4];case 3:return n=e.sent(),this.log("remove fail e=",n),[3,4];case 4:return[2]}})})},be.prototype.count=function(){return p(this,void 0,void 0,function(){var t,n;return _(this,function(e){switch(e.label){case 0:t=this.storeName,n=0,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,be.idb.count(t)];case 2:return n=e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2,n]}})})},be.prototype.readMulti=function(r){return p(this,void 0,void 0,function(){var t,n;return _(this,function(e){switch(e.label){case 0:t=this.storeName,n=[],e.label=1;case 1:return e.trys.push([1,3,,4]),[4,be.idb.readMulti(t,r)];case 2:return n=e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2,n]}})})},be.prototype.get=function(o){return p(this,void 0,void 0,function(){var t,n,r;return _(this,function(e){switch(e.label){case 0:if(t=this.storeName,!o)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,be.idb.get(t,o)];case 2:return n=e.sent(),[3,4];case 3:return r=e.sent(),this.log("get fail e=",r),[3,4];case 4:return[2,n]}})})},be.prototype.getAll=function(){return p(this,void 0,void 0,function(){var t,n;return _(this,function(e){switch(e.label){case 0:t=this.storeName,n=[],e.label=1;case 1:return e.trys.push([1,3,,4]),[4,be.idb.getAll(t)];case 2:return n=e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2,n]}})})},be);function be(e){this.maxNum=500,this.log=new he("store").info,this.storeName=e}function Te(e){var t=e.database,n=e.databaseName,r=e.databaseVersion,o=e.storeList;this.log=new he("idb").info,this.database=t||window.indexedDB,this.databaseName=n,this.databaseVersion=r||1,this.storeList=o||[]}function Re(e){var n=this;this.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Re.isOn&&Re.method.apply(Re,c(["[lark-security-audit] ["+n.type+"]"],e))},this.type=e||""}ve.initIdb=function(t){return p(void 0,void 0,void 0,function(){return _(this,function(e){return Ee||(ve.idb=new me({database:t,databaseName:"security-audit",databaseVersion:2,storeList:[Oe,ye,ge]}),Ee=ve.idb.open()),[2,Ee]})})};var Se,Ce,Ie,Ae,Le,Ne=new ve(Oe),we=new ve(ye),De=new ve(ge),ke=o.a.Reader,Pe=o.a.Writer,Fe=o.a.util,xe=o.a.roots.default||(o.a.roots.default={});function Me(e){if(this.version_payloads=[],this.pipe_entities=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function je(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function Ue(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}function Be(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}xe.improto=((Le={}).Command=(Se={},(Ce=Object.create(Se))[Se[1]="ACK"]=1,Ce[Se[2]="CONNECT"]=2,Ce[Se[3]="DISCONNECT"]=3,Ce[Se[4]="PING"]=4,Ce[Se[1011741]="PULL_PERMISSION"]=1011741,Ce),Le.PayloadType=(Ie={},(Ae=Object.create(Ie))[Ie[0]="TYPE_UNKNOWN"]=0,Ae[Ie[1]="PB2"]=1,Ae[Ie[2]="JSON"]=2,Ae),Le.PipeEntity=(Be.prototype.type="",Be.prototype.id=Fe.Long?Fe.Long.fromBits(0,0,!1):0,Be.create=function(e){return new Be(e)},Be.encode=function(e,t){return(t=t||Pe.create()).uint32(10).string(e.type),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(24).int64(e.id),t},Be.decode=function(e,t){e instanceof ke||(e=ke.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new xe.improto.PipeEntity;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.type=e.string();break;case 3:r.id=e.int64();break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("type"))throw Fe.ProtocolError("missing required 'type'",{instance:r});return r},Be.fromObject=function(e){if(e instanceof xe.improto.PipeEntity)return e;var t=new xe.improto.PipeEntity;return null!=e.type&&(t.type=String(e.type)),null!=e.id&&(Fe.Long?(t.id=Fe.Long.fromValue(e.id)).unsigned=!1:"string"==typeof e.id?t.id=parseInt(e.id,10):"number"==typeof e.id?t.id=e.id:"object"==r()(e.id)&&(t.id=new Fe.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber())),t},Be.toObject=function(e,t){var n,r={};return(t=t||{}).defaults&&(r.type="",Fe.Long?(n=new Fe.Long(0,0,!1),r.id=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.id=t.longs===String?"0":0),null!=e.type&&e.hasOwnProperty("type")&&(r.type=e.type),null!=e.id&&e.hasOwnProperty("id")&&("number"==typeof e.id?r.id=t.longs===String?String(e.id):e.id:r.id=t.longs===String?Fe.Long.prototype.toString.call(e.id):t.longs===Number?new Fe.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber():e.id),r},Be.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},Be),Le.VersionRange=(Ue.prototype.start="",Ue.prototype.end="",Ue.create=function(e){return new Ue(e)},Ue.encode=function(e,t){return(t=t||Pe.create()).uint32(10).string(e.start),t.uint32(18).string(e.end),t},Ue.decode=function(e,t){e instanceof ke||(e=ke.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new xe.improto.VersionRange;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.start=e.string();break;case 2:r.end=e.string();break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("start"))throw Fe.ProtocolError("missing required 'start'",{instance:r});if(!r.hasOwnProperty("end"))throw Fe.ProtocolError("missing required 'end'",{instance:r});return r},Ue.fromObject=function(e){if(e instanceof xe.improto.VersionRange)return e;var t=new xe.improto.VersionRange;return null!=e.start&&(t.start=String(e.start)),null!=e.end&&(t.end=String(e.end)),t},Ue.toObject=function(e,t){var n={};return(t=t||{}).defaults&&(n.start="",n.end=""),null!=e.start&&e.hasOwnProperty("start")&&(n.start=e.start),null!=e.end&&e.hasOwnProperty("end")&&(n.end=e.end),n},Ue.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},Ue),Le.Packet=(Me.prototype.sid="",Me.prototype.payload_type=1,Me.prototype.cmd=1,Me.prototype.status=200,Me.prototype.payload=Fe.newBuffer([]),Me.prototype.cid="",Me.prototype.pipe_entity=null,Me.prototype.version_payloads=Fe.emptyArray,Me.prototype.pipe_entities=Fe.emptyArray,Me.prototype.wait_retry_interval=0,Me.prototype.command=0,Me.create=function(e){return new Me(e)},Me.encode=function(e,t){if(t=t||Pe.create(),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),t.uint32(16).int32(e.payload_type),t.uint32(24).int32(e.cmd),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(32).uint32(e.status),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(42).bytes(e.payload),null!=e.cid&&Object.hasOwnProperty.call(e,"cid")&&t.uint32(50).string(e.cid),null!=e.pipe_entity&&Object.hasOwnProperty.call(e,"pipe_entity")&&xe.improto.PipeEntity.encode(e.pipe_entity,t.uint32(58).fork()).ldelim(),null!=e.version_payloads&&e.version_payloads.length)for(var n=0;n<e.version_payloads.length;++n)xe.improto.Packet.VersionPayload.encode(e.version_payloads[n],t.uint32(66).fork()).ldelim();if(null!=e.pipe_entities&&e.pipe_entities.length)for(n=0;n<e.pipe_entities.length;++n)xe.improto.PipeEntity.encode(e.pipe_entities[n],t.uint32(74).fork()).ldelim();return null!=e.wait_retry_interval&&Object.hasOwnProperty.call(e,"wait_retry_interval")&&t.uint32(80).uint32(e.wait_retry_interval),null!=e.command&&Object.hasOwnProperty.call(e,"command")&&t.uint32(88).int32(e.command),t},Me.decode=function(e,t){e instanceof ke||(e=ke.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new xe.improto.Packet;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.sid=e.string();break;case 2:r.payload_type=e.int32();break;case 3:r.cmd=e.int32();break;case 4:r.status=e.uint32();break;case 5:r.payload=e.bytes();break;case 6:r.cid=e.string();break;case 7:r.pipe_entity=xe.improto.PipeEntity.decode(e,e.uint32());break;case 8:r.version_payloads&&r.version_payloads.length||(r.version_payloads=[]),r.version_payloads.push(xe.improto.Packet.VersionPayload.decode(e,e.uint32()));break;case 9:r.pipe_entities&&r.pipe_entities.length||(r.pipe_entities=[]),r.pipe_entities.push(xe.improto.PipeEntity.decode(e,e.uint32()));break;case 10:r.wait_retry_interval=e.uint32();break;case 11:r.command=e.int32();break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("payload_type"))throw Fe.ProtocolError("missing required 'payload_type'",{instance:r});if(!r.hasOwnProperty("cmd"))throw Fe.ProtocolError("missing required 'cmd'",{instance:r});return r},Me.fromObject=function(e){if(e instanceof xe.improto.Packet)return e;var t=new xe.improto.Packet;switch(null!=e.sid&&(t.sid=String(e.sid)),e.payload_type){case"TYPE_UNKNOWN":case 0:t.payload_type=0;break;case"PB2":case 1:t.payload_type=1;break;case"JSON":case 2:t.payload_type=2}switch(e.cmd){case"ACK":case 1:t.cmd=1;break;case"CONNECT":case 2:t.cmd=2;break;case"DISCONNECT":case 3:t.cmd=3;break;case"PING":case 4:t.cmd=4;break;case"PULL_PERMISSION":case 1011741:t.cmd=1011741}if(null!=e.status&&(t.status=e.status>>>0),null!=e.payload&&("string"==typeof e.payload?Fe.base64.decode(e.payload,t.payload=Fe.newBuffer(Fe.base64.length(e.payload)),0):e.payload.length&&(t.payload=e.payload)),null!=e.cid&&(t.cid=String(e.cid)),null!=e.pipe_entity){if("object"!=r()(e.pipe_entity))throw TypeError(".improto.Packet.pipe_entity: object expected");t.pipe_entity=xe.improto.PipeEntity.fromObject(e.pipe_entity)}if(e.version_payloads){if(!Array.isArray(e.version_payloads))throw TypeError(".improto.Packet.version_payloads: array expected");t.version_payloads=[];for(var n=0;n<e.version_payloads.length;++n){if("object"!=r()(e.version_payloads[n]))throw TypeError(".improto.Packet.version_payloads: object expected");t.version_payloads[n]=xe.improto.Packet.VersionPayload.fromObject(e.version_payloads[n])}}if(e.pipe_entities){if(!Array.isArray(e.pipe_entities))throw TypeError(".improto.Packet.pipe_entities: array expected");for(t.pipe_entities=[],n=0;n<e.pipe_entities.length;++n){if("object"!=r()(e.pipe_entities[n]))throw TypeError(".improto.Packet.pipe_entities: object expected");t.pipe_entities[n]=xe.improto.PipeEntity.fromObject(e.pipe_entities[n])}}return null!=e.wait_retry_interval&&(t.wait_retry_interval=e.wait_retry_interval>>>0),null!=e.command&&(t.command=0|e.command),t},Me.toObject=function(e,t){var n={};if(((t=t||{}).arrays||t.defaults)&&(n.version_payloads=[],n.pipe_entities=[]),t.defaults&&(n.sid="",n.payload_type=t.enums===String?"PB2":1,n.cmd=t.enums===String?"ACK":1,n.status=200,t.bytes===String?n.payload="":(n.payload=[],t.bytes!==Array&&(n.payload=Fe.newBuffer(n.payload))),n.cid="",n.pipe_entity=null,n.wait_retry_interval=0,n.command=0),null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.payload_type&&e.hasOwnProperty("payload_type")&&(n.payload_type=t.enums===String?xe.improto.PayloadType[e.payload_type]:e.payload_type),null!=e.cmd&&e.hasOwnProperty("cmd")&&(n.cmd=t.enums===String?xe.improto.Command[e.cmd]:e.cmd),null!=e.status&&e.hasOwnProperty("status")&&(n.status=e.status),null!=e.payload&&e.hasOwnProperty("payload")&&(n.payload=t.bytes===String?Fe.base64.encode(e.payload,0,e.payload.length):t.bytes===Array?Array.prototype.slice.call(e.payload):e.payload),null!=e.cid&&e.hasOwnProperty("cid")&&(n.cid=e.cid),null!=e.pipe_entity&&e.hasOwnProperty("pipe_entity")&&(n.pipe_entity=xe.improto.PipeEntity.toObject(e.pipe_entity,t)),e.version_payloads&&e.version_payloads.length){n.version_payloads=[];for(var r=0;r<e.version_payloads.length;++r)n.version_payloads[r]=xe.improto.Packet.VersionPayload.toObject(e.version_payloads[r],t)}if(e.pipe_entities&&e.pipe_entities.length)for(n.pipe_entities=[],r=0;r<e.pipe_entities.length;++r)n.pipe_entities[r]=xe.improto.PipeEntity.toObject(e.pipe_entities[r],t);return null!=e.wait_retry_interval&&e.hasOwnProperty("wait_retry_interval")&&(n.wait_retry_interval=e.wait_retry_interval),null!=e.command&&e.hasOwnProperty("command")&&(n.command=e.command),n},Me.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},Me.VersionPayload=(je.prototype.version_range=null,je.prototype.payload=Fe.newBuffer([]),je.create=function(e){return new je(e)},je.encode=function(e,t){return t=t||Pe.create(),xe.improto.VersionRange.encode(e.version_range,t.uint32(10).fork()).ldelim(),t.uint32(18).bytes(e.payload),t},je.decode=function(e,t){e instanceof ke||(e=ke.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new xe.improto.Packet.VersionPayload;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.version_range=xe.improto.VersionRange.decode(e,e.uint32());break;case 2:r.payload=e.bytes();break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("version_range"))throw Fe.ProtocolError("missing required 'version_range'",{instance:r});if(!r.hasOwnProperty("payload"))throw Fe.ProtocolError("missing required 'payload'",{instance:r});return r},je.fromObject=function(e){if(e instanceof xe.improto.Packet.VersionPayload)return e;var t=new xe.improto.Packet.VersionPayload;if(null!=e.version_range){if("object"!=r()(e.version_range))throw TypeError(".improto.Packet.VersionPayload.version_range: object expected");t.version_range=xe.improto.VersionRange.fromObject(e.version_range)}return null!=e.payload&&("string"==typeof e.payload?Fe.base64.decode(e.payload,t.payload=Fe.newBuffer(Fe.base64.length(e.payload)),0):e.payload.length&&(t.payload=e.payload)),t},je.toObject=function(e,t){var n={};return(t=t||{}).defaults&&(n.version_range=null,t.bytes===String?n.payload="":(n.payload=[],t.bytes!==Array&&(n.payload=Fe.newBuffer(n.payload)))),null!=e.version_range&&e.hasOwnProperty("version_range")&&(n.version_range=xe.improto.VersionRange.toObject(e.version_range,t)),null!=e.payload&&e.hasOwnProperty("payload")&&(n.payload=t.bytes===String?Fe.base64.encode(e.payload,0,e.payload.length):t.bytes===Array?Array.prototype.slice.call(e.payload):e.payload),n},je.prototype.toJSON=function(){return this.constructor.toObject(this,o.a.util.toJSONOptions)},je),Me),Le);var Ve=xe;function He(){for(var e,t="",n=0;n<32;n++)e=16*Math.random()|0,8!=n&&12!=n&&16!=n&&20!=n||(t+="-"),t+=(12==n?4:16==n?3&e|8:e).toString(16);return t}function A(e,r){return e.reduce(function(e,t){var n=t[r];return e[n]||(e[n]=[]),e[n].push(t),e},{})}var Ge=(Ke.prototype.updateOrigin=function(e){this.origin=e},Ke.prototype.updateRequestId=function(e){this.requestId=e},Ke.prototype.updateSessionKey=function(e){this.sessionKey=e},Ke.prototype.uploadEvent=function(n){return p(this,void 0,void 0,function(){var t;return _(this,function(e){switch(e.label){case 0:return t={method:"post",data:new Blob([n],{type:"buffer"}),headers:{"X-Request-Id":He()}},this.requestId&&(t.headers["X-Request-Id"]=this.requestId),this.sessionKey&&(t.headers["Suite-Session-Key"]=this.sessionKey),[4,this.request(this.origin+"/suite/admin/security/events/",t)];case 1:return[2,e.sent().data]}})})},Ke.prototype.gateway=function(e){var u=e.payload,l=e.cmd;return p(this,void 0,void 0,function(){var t,n,r,o,i,a,s,c;return _(this,function(e){switch(e.label){case 0:return t=He(),n={cmd:l,payload_type:Ve.improto.PayloadType.PB2,payload:u,cid:t},r=Ve.improto.Packet.create(n),o=Ve.improto.Packet.encode(r).finish(),i={method:"post",data:new Blob([o],{type:"buffer"}),headers:{"X-Command":l,"Content-Type":"application/x-protobuf","X-Request-Id":t,"X-Source":"web"},responseType:"arraybuffer"},a=this.origin||function(){var e="";try{e="https://internal-api-lark-api."+location.hostname.split(".").slice(-2).join(".")}catch(e){}return e}(),[4,this.request(a+"/im/gateway/",i)];case 1:return s=e.sent(),c=Ve.improto.Packet.decode(new Uint8Array(s.data)),[2,Ve.improto.Packet.toObject(c)]}})})},Ke),We=$.security_event.EventsRequest,Ye=new Ge;function Ke(){this.origin="",this.request=a.a.create({headers:{"Content-Type":"application/octet-stream"},withCredentials:!0,timeout:3e4})}function ze(o){return p(this,void 0,void 0,function(){var t,n,r;return _(this,function(e){switch(e.label){case 0:return t={Events:o},n=We.create(t),r=We.encode(n).finish(),[4,Ye.uploadEvent(r)];case 1:return[2,e.sent()]}})})}function qe(a){return p(this,void 0,void 0,function(){var t,n,r,o,i;return _(this,function(e){switch(e.label){case 0:return a.api_version="1-0",t=_e.authorization.PullPermissionRequest.create(a),n=_e.authorization.PullPermissionRequest.encode(t).finish(),r=Ve.improto.Command.PULL_PERMISSION,[4,Ye.gateway({cmd:r,payload:n})];case 1:return o=e.sent(),i=_e.authorization.PullPermissionResponse.decode(o.payload),[2,_e.authorization.PullPermissionResponse.toObject(i)]}})})}var Xe=(Qe.prototype.start=function(){this.isOn||(this.isOn=!0,this.log("start"),this.flushLoop())},Qe.prototype.stop=function(){return p(this,void 0,void 0,function(){return _(this,function(e){return this.log("stop"),this.isOn=!1,this.retryTimes=0,this.t&&(clearTimeout(this.t),this.t=null),[2]})})},Qe.prototype.flushLoop=function(){return p(this,void 0,void 0,function(){var t,n=this;return _(this,function(e){switch(e.label){case 0:return this.log("flushloop start, retrytimes=",this.retryTimes+1),[4,this.flush()];case 1:return e.sent()<=0?this.stop():(this.retryTimes+=1,this.retryTimes>=this.retryMaxTimes?this.stop():(t=this.retryTimes<=1?this.basicInterval:this.basicInterval*(2<<this.retryTimes-2),this.log("flushloop next retry wait=",t,"ms"),this.t=setTimeout(function(){n.flushLoop()},t))),[2]}})})},Qe.prototype.flush=function(){return p(this,void 0,void 0,function(){var t,n,r,o,i=this;return _(this,function(e){switch(e.label){case 0:return[4,we.getAll()];case 1:t=e.sent(),this.log("flush start, failevents num=",null==t?void 0:t.length),e.label=2;case 2:if(!t||!t.length)return[3,8];if(!(n=t.splice(0,this.batchNum)).length)return[3,8];e.label=3;case 3:return e.trys.push([3,6,,7]),[4,ze(n.map(function(e){return e.data}))];case 4:return e.sent(),[4,Promise.all(n.map(function(t){return p(i,void 0,void 0,function(){return _(this,function(e){switch(e.label){case 0:return[4,we.remove(t.key)];case 1:return e.sent(),[2]}})})}))];case 5:return e.sent(),[3,7];case 6:return r=e.sent(),this.log("flush batch upload error e=",r),[3,7];case 7:return[3,2];case 8:return[4,we.count()];case 9:return o=e.sent(),this.log("flush end, failevents num=",o),[2,o]}})})},new Qe),Je="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function Qe(){this.basicInterval=6e4,this.batchNum=50,this.isOn=!1,this.retryTimes=0,this.retryMaxTimes=7,this.log=new he("task").info}function Ze(e){var t={exports:{}};return e(t,t.exports),t.exports}var $e=Ze(function(e,t){var n;e.exports=n=n||function(l,n){var e;if("undefined"!=typeof window&&window.crypto&&(e=window.crypto),!e&&"undefined"!=typeof window&&window.msCrypto&&(e=window.msCrypto),!e&&void 0!==Je&&Je.crypto&&(e=Je.crypto),!e)try{e=h.a}catch(l){}var r=function(){if(e){if("function"==typeof e.getRandomValues)try{return e.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof e.randomBytes)try{return e.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(e){var t;return E.prototype=e,t=new E,E.prototype=null,t},t={},i=t.lib={},a=i.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},d=i.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=t!=n?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=l.ceil(t/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new d.init(t,e)}}),s=t.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new d.init(n,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new d.init(n,t)}},f=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},p=i.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t,n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i),s=(a=e?l.ceil(a):l.max((0|a)-this._minBufferSize,0))*i,c=l.min(4*s,o);if(s){for(var u=0;u<s;u+=i)this._doProcessBlock(r,u);t=r.splice(0,s),n.sigBytes-=c}return new d.init(t,c)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),_=(i.Hasher=p.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(e,t){return new n.init(t).finalize(e)}},_createHmacHelper:function(n){return function(e,t){return new _.HMAC.init(n,t).finalize(e)}}}),t.algo={});function E(){}return t}(Math)}),et=Ze(function(e,t){var a;e.exports=(a=$e,function(l){var e=a,t=e.lib,n=t.WordArray,r=t.Hasher,o=e.algo,C=[];!function(){for(var e=0;e<64;e++)C[e]=4294967296*l.abs(l.sin(e+1))|0}();var i=o.MD5=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],s=e[t+1],c=e[t+2],u=e[t+3],l=e[t+4],d=e[t+5],f=e[t+6],p=e[t+7],_=e[t+8],E=e[t+9],h=e[t+10],m=e[t+11],O=e[t+12],y=e[t+13],g=e[t+14],v=e[t+15],b=I(b=i[0],S=i[1],R=i[2],T=i[3],a,7,C[0]),T=I(T,b,S,R,s,12,C[1]),R=I(R,T,b,S,c,17,C[2]),S=I(S,R,T,b,u,22,C[3]);b=I(b,S,R,T,l,7,C[4]),T=I(T,b,S,R,d,12,C[5]),R=I(R,T,b,S,f,17,C[6]),S=I(S,R,T,b,p,22,C[7]),b=I(b,S,R,T,_,7,C[8]),T=I(T,b,S,R,E,12,C[9]),R=I(R,T,b,S,h,17,C[10]),S=I(S,R,T,b,m,22,C[11]),b=I(b,S,R,T,O,7,C[12]),T=I(T,b,S,R,y,12,C[13]),R=I(R,T,b,S,g,17,C[14]),b=L(b,S=I(S,R,T,b,v,22,C[15]),R,T,s,5,C[16]),T=L(T,b,S,R,f,9,C[17]),R=L(R,T,b,S,m,14,C[18]),S=L(S,R,T,b,a,20,C[19]),b=L(b,S,R,T,d,5,C[20]),T=L(T,b,S,R,h,9,C[21]),R=L(R,T,b,S,v,14,C[22]),S=L(S,R,T,b,l,20,C[23]),b=L(b,S,R,T,E,5,C[24]),T=L(T,b,S,R,g,9,C[25]),R=L(R,T,b,S,u,14,C[26]),S=L(S,R,T,b,_,20,C[27]),b=L(b,S,R,T,y,5,C[28]),T=L(T,b,S,R,c,9,C[29]),R=L(R,T,b,S,p,14,C[30]),b=N(b,S=L(S,R,T,b,O,20,C[31]),R,T,d,4,C[32]),T=N(T,b,S,R,_,11,C[33]),R=N(R,T,b,S,m,16,C[34]),S=N(S,R,T,b,g,23,C[35]),b=N(b,S,R,T,s,4,C[36]),T=N(T,b,S,R,l,11,C[37]),R=N(R,T,b,S,p,16,C[38]),S=N(S,R,T,b,h,23,C[39]),b=N(b,S,R,T,y,4,C[40]),T=N(T,b,S,R,a,11,C[41]),R=N(R,T,b,S,u,16,C[42]),S=N(S,R,T,b,f,23,C[43]),b=N(b,S,R,T,E,4,C[44]),T=N(T,b,S,R,O,11,C[45]),R=N(R,T,b,S,v,16,C[46]),b=w(b,S=N(S,R,T,b,c,23,C[47]),R,T,a,6,C[48]),T=w(T,b,S,R,p,10,C[49]),R=w(R,T,b,S,g,15,C[50]),S=w(S,R,T,b,d,21,C[51]),b=w(b,S,R,T,O,6,C[52]),T=w(T,b,S,R,u,10,C[53]),R=w(R,T,b,S,h,15,C[54]),S=w(S,R,T,b,s,21,C[55]),b=w(b,S,R,T,_,6,C[56]),T=w(T,b,S,R,v,10,C[57]),R=w(R,T,b,S,f,15,C[58]),S=w(S,R,T,b,y,21,C[59]),b=w(b,S,R,T,l,6,C[60]),T=w(T,b,S,R,m,10,C[61]),R=w(R,T,b,S,c,15,C[62]),S=w(S,R,T,b,E,21,C[63]),i[0]=i[0]+b|0,i[1]=i[1]+S|0,i[2]=i[2]+R|0,i[3]=i[3]+T|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32;var o=l.floor(n/4294967296),i=n;t[15+(r+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),t[14+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(t.length+1),this._process();for(var a=this._hash,s=a.words,c=0;c<4;c++){var u=s[c];s[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return a},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function I(e,t,n,r,o,i,a){var s=e+(t&n|~t&r)+o+a;return(s<<i|s>>>32-i)+t}function L(e,t,n,r,o,i,a){var s=e+(t&r|n&~r)+o+a;return(s<<i|s>>>32-i)+t}function N(e,t,n,r,o,i,a){var s=e+(t^n^r)+o+a;return(s<<i|s>>>32-i)+t}function w(e,t,n,r,o,i,a){var s=e+(n^(t|~r))+o+a;return(s<<i|s>>>32-i)+t}e.MD5=r._createHelper(i),e.HmacMD5=r._createHmacHelper(i)}(Math),a.MD5)}),tt=(Ze(function(e,t){var n,s;function c(e,t,n){for(var r,o=[],i=0,a=0;a<t;a++)a%4&&(r=n[e.charCodeAt(a-1)]<<a%4*2|n[e.charCodeAt(a)]>>>6-a%4*2,o[i>>>2]|=r<<24-i%4*8,i++);return s.create(o,i)}e.exports=(s=(n=$e).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(a>>>6*(3-s)&63));var c=r.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var o=0;o<n.length;o++)r[n.charCodeAt(o)]=o}var i,a=n.charAt(64);return!a||-1!==(i=e.indexOf(a))&&(t=i),c(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},n.enc.Base64)}),Ze(function(e,t){var n,r,o,i,a,d,s,c;e.exports=(r=(n=c=$e).lib,o=r.WordArray,i=r.Hasher,a=n.algo,d=[],s=a.SHA1=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n,r=this._hash.words,o=r[0],i=r[1],a=r[2],s=r[3],c=r[4],u=0;u<80;u++){u<16?d[u]=0|e[t+u]:(n=d[u-3]^d[u-8]^d[u-14]^d[u-16],d[u]=n<<1|n>>>31);var l=(o<<5|o>>>27)+c+d[u];l+=u<20?1518500249+(i&a|~i&s):u<40?1859775393+(i^a^s):u<60?(i&a|i&s|a&s)-1894007588:(i^a^s)-899497514,c=s,s=a,a=i<<30|i>>>2,i=o,o=l}r[0]=r[0]+o|0,r[1]=r[1]+i|0,r[2]=r[2]+a|0,r[3]=r[3]+s|0,r[4]=r[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=i._createHelper(s),n.HmacSHA1=i._createHmacHelper(s),c.SHA1)}),Ze(function(e,t){var n,u;e.exports=(n=$e.lib.Base,u=$e.enc.Utf8,void($e.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=u.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,s=i.words,c=0;c<n;c++)a[c]^=1549556828,s[c]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))}),Ze(function(e,t){var n,r,o,l,i,a,s,c;e.exports=(o=(r=(n=c=$e).lib).Base,l=r.WordArray,a=(i=n.algo).MD5,s=i.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,r=this.cfg,o=r.hasher.create(),i=l.create(),a=i.words,s=r.keySize,c=r.iterations;a.length<s;){n&&o.update(n),n=o.update(e).finalize(t),o.reset();for(var u=1;u<c;u++)n=o.finalize(n),o.reset();i.concat(n)}return i.sigBytes=4*s,i}}),n.EvpKDF=function(e,t,n){return s.create(n).compute(e,t)},c.EvpKDF)}),Ze(function(e,t){var a,n,r,o,c,i,s,u,l,d,f,p,_,E,h,m,O,y,g,v;function b(e,t,n){var r,o=this._iv;o?(r=o,this._iv=a):r=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=r[i]}function T(e){return"string"==typeof e?g:O}e.exports=void($e.lib.Cipher||(o=(r=(n=$e).lib).Base,c=r.WordArray,i=r.BufferedBlockAlgorithm,(s=n.enc).Utf8,u=s.Base64,l=n.algo.EvpKDF,d=r.Cipher=i.extend({cfg:o.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(r){return{encrypt:function(e,t,n){return T(t).encrypt(r,e,t,n)},decrypt:function(e,t,n){return T(t).decrypt(r,e,t,n)}}}}),r.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),f=n.mode={},p=r.BlockCipherMode=o.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),_=f.CBC=((v=p.extend()).Encryptor=v.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;b.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),v.Decryptor=v.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),b.call(this,e,t,r),this._prevBlock=o}}),v),E=(n.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,o=r<<24|r<<16|r<<8|r,i=[],a=0;a<r;a+=4)i.push(o);var s=c.create(i,r);e.concat(s)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.BlockCipher=d.extend({cfg:d.cfg.extend({mode:_,padding:E}),reset:function(){var e;d.reset.call(this);var t=this.cfg,n=t.iv,r=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(r,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),h=r.CipherParams=o.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),m=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?c.create([1398893684,1701076831]).concat(n).concat(t):t).toString(u)},parse:function(e){var t,n=u.parse(e),r=n.words;return 1398893684==r[0]&&1701076831==r[1]&&(t=c.create(r.slice(2,4)),r.splice(0,4),n.sigBytes-=16),h.create({ciphertext:n,salt:t})}},O=r.SerializableCipher=o.extend({cfg:o.extend({format:m}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r),i=o.finalize(t),a=o.cfg;return h.create({ciphertext:i,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),y=(n.kdf={}).OpenSSL={execute:function(e,t,n,r){r=r||c.random(8);var o=l.create({keySize:t+n}).compute(e,r),i=c.create(o.words.slice(t),4*n);return o.sigBytes=4*t,h.create({key:o,iv:i,salt:r})}},g=r.PasswordBasedCipher=O.extend({cfg:O.cfg.extend({kdf:y}),encrypt:function(e,t,n,r){var o=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=o.iv;var i=O.encrypt.call(this,e,t,o.key,r);return i.mixIn(o),i},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=o.iv,O.decrypt.call(this,e,t,o.key,r)}})))}),Ze(function(e,t){var o;e.exports=(o=$e,function(){var e=o,t=e.lib.BlockCipher,n=e.algo,u=[],l=[],d=[],f=[],p=[],_=[],E=[],h=[],m=[],O=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var n=0,r=0,t=0;t<256;t++){var o=(o=r^r<<1^r<<2^r<<3^r<<4)>>>8^255&o^99;u[n]=o;var i=e[l[o]=n],a=e[i],s=e[a],c=257*e[o]^16843008*o;d[n]=c<<24|c>>>8,f[n]=c<<16|c>>>16,p[n]=c<<8|c>>>24,_[n]=c,c=16843009*s^65537*a^257*i^16843008*n,E[o]=c<<24|c>>>8,h[o]=c<<16|c>>>16,m[o]=c<<8|c>>>24,O[o]=c,n?(n=i^e[e[e[s^i]]],r^=e[e[r]]):n=r=1}}();var y=[0,1,2,4,8,16,32,64,128,27,54],r=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],i=0;i<r;i++)i<n?o[i]=t[i]:(c=o[i-1],i%n?6<n&&i%n==4&&(c=u[c>>>24]<<24|u[c>>>16&255]<<16|u[c>>>8&255]<<8|u[255&c]):(c=u[(c=c<<8|c>>>24)>>>24]<<24|u[c>>>16&255]<<16|u[c>>>8&255]<<8|u[255&c],c^=y[i/n|0]<<24),o[i]=o[i-n]^c);for(var a=this._invKeySchedule=[],s=0;s<r;s++){var i=r-s,c=s%4?o[i]:o[i-4];a[s]=s<4||i<=4?c:E[u[c>>>24]]^h[u[c>>>16&255]]^m[u[c>>>8&255]]^O[u[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,d,f,p,_,u)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,E,h,m,O,l),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var c=this._nRounds,u=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],f=e[t+3]^n[3],p=4,_=1;_<c;_++)var E=r[u>>>24]^o[l>>>16&255]^i[d>>>8&255]^a[255&f]^n[p++],h=r[l>>>24]^o[d>>>16&255]^i[f>>>8&255]^a[255&u]^n[p++],m=r[d>>>24]^o[f>>>16&255]^i[u>>>8&255]^a[255&l]^n[p++],O=r[f>>>24]^o[u>>>16&255]^i[l>>>8&255]^a[255&d]^n[p++],u=E,l=h,d=m,f=O;E=(s[u>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&f])^n[p++],h=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[f>>>8&255]<<8|s[255&u])^n[p++],m=(s[d>>>24]<<24|s[f>>>16&255]<<16|s[u>>>8&255]<<8|s[255&l])^n[p++],O=(s[f>>>24]<<24|s[u>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^n[p++],e[t]=E,e[t+1]=h,e[t+2]=m,e[t+3]=O},keySize:8});e.AES=t._createHelper(r)}(),o.AES)})),nt=Ze(function(e,t){e.exports=$e.enc.Utf8});function G(e){return et(e).toString()}function rt(e,t){try{var n=tt.decrypt(e,t).toString(nt);return JSON.parse(n)}catch(e){return null}}function ot(r,o,i){return p(this,void 0,void 0,function(){var t,n;return _(this,function(e){switch(e.label){case 0:return t="updatetime_"+r,[4,De.get(t)];case 1:return!(n=e.sent())||Date.now()-n.data>=o?(i(),[4,De.put({data:Date.now(),key:t})]):[3,3];case 2:e.sent(),e.label=3;case 3:return setTimeout(function(){ot(r,o,i)},o),[2]}})})}var it=$.security_event.Event,at=(ut.prototype.init=function(){return p(this,void 0,void 0,function(){var t=this;return _(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,ve.initIdb()];case 1:return e.sent(),Xe.start(),this.appId&&this.userId&&!this.authorityOff?[4,this.updateAuthorityInfo()]:[3,3];case 2:e.sent(),ot(G(this.appId+"_"+this.userId),9e5,function(){t.updateAuthorityInfo()}),e.label=3;case 3:return[3,5];case 4:return e.sent(),this.log("init error"),[3,5];case 5:return[2]}})})},ut.prototype.initDone=function(){return p(this,void 0,void 0,function(){return _(this,function(e){switch(e.label){case 0:return this.initP?[4,this.initP]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},ut.prototype.updateConfig=function(e){e&&(e.hasOwnProperty("origin")&&Ye.updateOrigin(e.origin),e.hasOwnProperty("requestId")&&Ye.updateRequestId(e.requestId),e.hasOwnProperty("sessionKey")&&Ye.updateSessionKey(e.sessionKey),e.hasOwnProperty("log")&&he.updateIsOn(e.log),e.hasOwnProperty("userId")&&(this.userId=e.userId),e.hasOwnProperty("appId")&&(this.appId=e.appId),e.hasOwnProperty("authorityOff")&&(this.authorityOff=e.authorityOff))},ut.prototype.updateSharedParams=function(e){Object.assign(this.sharedParams,e)},ut.prototype.auditEvent=function(s,c){var u;return void 0===c&&(c=!1),p(this,void 0,void 0,function(){var t,n,r,o,i,a;return _(this,function(e){switch(e.label){case 0:return this.initP?[4,this.initP]:[3,2];case 1:e.sent(),e.label=2;case 2:if(t=Object.assign({TimeStamp:""+Date.now()},this.sharedParams,s),n=it.verify(t))return[2,Promise.reject({code:le.Error,message:n,error:new Error(n)})];if(r=He(),c)return[3,6];this.log("store event in queue, key=",r),e.label=3;case 3:return e.trys.push([3,5,,6]),[4,we.add({data:t,key:r})];case 4:return e.sent(),Xe.start(),this.log("store event in queue success, key=",r),[2,{code:le.Success,message:"wait in queue"}];case 5:return o=e.sent(),this.log("store event in queue error, key=",r,"e=",o),[2,Promise.reject({code:le.Error,message:(null==o?void 0:o.message)||"store event error",error:o})];case 6:return this.log("upload event start, key=",r),[4,Ne.add({data:t,key:r})];case 7:e.sent(),e.label=8;case 8:return e.trys.push([8,10,,11]),[4,ze([t])];case 9:return i=e.sent(),Ne.remove(r),null!==(u=null==i?void 0:i.data)&&void 0!==u&&u.failNum?(this.log("upload event partly success, key=",r),[2,Promise.reject({code:le.Error,data:i.data,message:i.message})]):(this.log("upload event all success, key=",r),[2,{code:le.Success,data:null==i?void 0:i.data,message:null==i?void 0:i.message}]);case 10:return a=e.sent(),this.log("upload event error, key=",r,"e=",a),we.add({data:t,key:r}),Ne.remove(r),Xe.start(),[2,Promise.reject({code:le.Error,message:(null==a?void 0:a.message)||"server error",error:a})];case 11:return[2]}})})},ut.prototype.updateAuthorityInfo=function(){var d,f;return p(this,void 0,void 0,function(){var t,n,r,o,i,a,s,c,u,l;return _(this,function(e){switch(e.label){case 0:if(this.authorityOff)return this.log("update authority info, authority is off"),[2];if(!this.appId||!this.userId)return this.log("update authority info, no appId or userId"),[2];t=G(this.appId+"_"+this.userId),this.log("update authority info, hashKey=",t),e.label=1;case 1:return e.trys.push([1,5,,6]),n="",r=void 0,[4,De.get(t)];case 2:return(o=e.sent())&&(i=rt(o.data,this.userId))&&(n=i.perm_version,r=i),this.cacheAuthorityInfo=r,a={app_id:this.appId},n&&(a.perm_version=n),[4,qe(a)];case 3:return(s=e.sent())&&s.permission_data&&s.permission_data.operate_permission_data?(s.clear_old?r=s:(c=function(e,t,n){void 0===e&&(e=[]),void 0===t&&(t=[]),void 0===n&&(n="");var r=A(e,n),o=A(t,n),i=Object.assign({},r,o);return Object.values(i).reduce(function(e,t){return e.concat(t)},[])}(null===(d=null==r?void 0:r.permission_data)||void 0===d?void 0:d.operate_permission_data,null===(f=null==s?void 0:s.permission_data)||void 0===f?void 0:f.operate_permission_data,"perm_type"),(r=s).permission_data.operate_permission_data=c),this.cacheAuthorityInfo=r,u=function(e,t){try{return tt.encrypt(JSON.stringify(e),t).toString()}catch(e){return""}}(r,this.userId),[4,De.put({data:u,key:t})]):(this.log("update authority info, data is empty"),[2]);case 4:return e.sent(),this.log("update authority info success"),[2,s];case 5:return l=e.sent(),this.log("update authority info error, e=",l),[3,6];case 6:return[2]}})})},ut.prototype.preCheckAuthority=function(e){var t=e.perm_type;return this.authorityOff?(this.log("check authority, authority is off"),{code:de.Null,message:"authority is off"}):(this.log("check authority, params=",e),t?this.appId&&this.userId?void 0:(this.log("check authority, no appId or userId"),{code:de.Null,message:"no appId or userId"}):(this.log("check authority, no permType"),{code:de.Null,message:"no permType"}))},ut.prototype.postCheckAuthority=function(e,t){var n,r=e.perm_type,o=e.object,i=t.permission_data.operate_permission_data,a=void 0===i?[]:i;if(this.log("check authority, try to find permData"),o&&(n=a.find(function(e){var t,n;return e.perm_type===r&&o.entity_type===(null===(t=e.object)||void 0===t?void 0:t.entity_type)&&o.id===(null===(n=e.object)||void 0===n?void 0:n.id)})),!(n=n||a.find(function(e){return e.perm_type===r&&e.object.entity_type===_e.authorization.EntityType.ANY})))return this.log("check authority, no permData"),{code:de.Null,message:"no permData"};switch(this.log("check authority, find permData=",n),n.result){case _e.authorization.ResultType.Allow:return this.log("check authority, allow"),{code:de.Allow,message:"allow"};case _e.authorization.ResultType.Deny:return this.log("check authority, deny"),{code:de.Deny,message:"deny"};default:return this.log("check authority, null"),{code:de.Null,message:"null"}}},ut.prototype.checkAuthority=function(a){return p(this,void 0,void 0,function(){var t,n,r,o,i;return _(this,function(e){switch(e.label){case 0:return(t=this.preCheckAuthority(a))?[2,t]:this.initP?[4,this.initP]:[3,2];case 1:e.sent(),e.label=2;case 2:return n=G(this.appId+"_"+this.userId),[4,De.get(n)];case 3:return(r=e.sent())&&r.data?(o=rt(r.data,this.userId))&&o.permission_data?(i=o.permission_data.expire_time,Math.floor(Date.now()/1e3)>i?[4,De.remove(n)]:[3,5]):(this.log("check authority, decrypt error"),[2,{code:de.Null,message:"decrypt error"}]):(this.log("check authority, no authorityInfo"),[2,{code:de.Null,message:"no authorityInfo"}]);case 4:return e.sent(),this.log("check authority, time expired"),[2,{code:de.Null,message:"time expired"}];case 5:return[2,this.postCheckAuthority(a,o)]}})})},ut.prototype.checkAuthoritySync=function(e){var t=this.preCheckAuthority(e);if(t)return t;var n=this.cacheAuthorityInfo;if(!n||!n.permission_data)return this.log("check authority,  no cache authorityInfo"),{code:de.Null,message:"no cache authorityInfo"};var r=n.permission_data.expire_time;return Math.floor(Date.now()/1e3)>r?(this.log("check authority, time expired"),this.cacheAuthorityInfo=null,{code:de.Null,message:"time expired"}):this.postCheckAuthority(e,n)},ut),st=_e.authorization,ct=$.security_event;function ut(e){this.sharedParams={Module:$.security_event.ModuleType.ModuleUnknown},this.log=new he("main").info,this.authorityOff=!1,this.updateConfig(e),this.initP=this.init()}}).call(this,dt("yLpj"))},M5eE:function(e,t,n){"use strict";var r=n("Bvq2");e.exports=function(e,t){var n=[][e];return!n||!r(function(){n.call(null,t||function(){throw 1},1)})}},MjSh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="#0c296e",o="#133c9a",i="#1c4cba",a="#245bdb",s="#3370ff",c="#4e83fd",u="#82a7fc",l="#bacefd",d="#e1eaff",f="#f0f4ff",p="#004761",_="#006185",E="#037eaa",h="#049fd7",m="#14c0ff",O="#50cefb",y="#7edafb",g="#b1e8fc",v="#d9f3fd",b="#ecf9fe",T="#024b41",R="#036356",S="#078372",C="#04b49c",I="#00d6b9",L="#14e1c6",N="#64e8d6",w="#a9efe6",D="#d5f6f2",k="#eafaf8",P="#5c3a00",F="#795101",x="#aa7803",M="#dc9b04",j="#ffc60a",U="#fad355",B="#f7dc82",V="#f8e6ab",H="#faf1d1",W="#fdf9ed",Y="#6b3900",K="#8f4f04",z="#b26206",q="#de7802",X="#ff8800",J="#ffa53d",Q="#ffba6b",Z="#fed4a4",$="#feead2",ee="#fff5eb",te="#621c18",ne="#812520",re="#ac2f28",oe="#d83931",ie="#f54a45",ae="#f76964",se="#f98e8b",ce="#fbbfbc",ue="#fde2e2",le="#fef1f1",de="#520a32",fe="#7a0f4b",pe="#9e1361",_e="#c71077",Ee="#f01d94",he="#f14ba9",me="#f57ac0",Oe="#f9aed9",ye="#fdddef",ge="#fef1f8",ve="#270561",be="#380d82",Te="#4e1ba7",Re="#6425d0",Se="#7f3bf5",Ce="#935af6",Ie="#ad82f7",Ae="#cdb2fa",Le="#ece2fe",Ne="#f6f1fe",we="#000000",De="#0f1114",ke="#1f2329",Pe="#2b2f36",Fe="#373c43",xe="#51565d",Me="#646a73",je="#8f959e",Ue="#bbbfc4",Be="#dee0e3",Ve="#eff0f1",He="#f5f6f7",Ge="#f8f9fa",We="#ffffff",Ye="#124b0c",Ke="#186010",ze="#237b19",qe="#2ea121",Xe="#34c724",Je="#62d256",Qe="#8ee085",Ze="#b7edb1",$e="#d9f5d6",et="#f0fbef",tt="#354200",nt="#495700",rt="#667901",ot="#8fac02",it="#b3d600",at="#c3dd40",st="#d2e76a",ct="#dfee96",ut="#eef6c6",lt="#f7fae5",dt="#460b46",ft="#681268",pt="#8c218c",_t="#b320b3",Et="#d136d1",ht="#db66db",mt="#e58fe5",Ot="#efb9ef",yt="#f8def8",gt="#fceefc",vt="#0c1264",bt="#0a1285",Tt="#161fa2",Rt="#2933c7",St="#4954e6",Ct="#616ae5",It="#7b83ea",At="#b4b9f3",Lt="#e0e2fa",Nt="#f2f3fd",wt=["#3370FF","#64E8D6","#667901","#FF8800","#520A32","#AD82F7","#049FD7","#2EA121","#795101","#F76964","#B220B2","#0A1285","#50CEFB","#186010","#B26206","#F57AC0","#7F3BF5","#00D6B9","#354200","#FFBA6B","#9E1361","#270561","#1C4CBA","#078372","#B3D600","#6B3900","#F01D94","#4E1BA7","#D83931","#DB66DB","#2933C7","#006185","#62D256","#812520","#681268","#616AE5","#024B41","#82A7FC","#0C296E"];t.B100=d,t.B200=l,t.B300=u,t.B400=c,t.B50=f,t.B500=s,t.B600=a,t.B700=i,t.B800=o,t.B900=r,t.C100=ye,t.C200=Oe,t.C300=me,t.C400=he,t.C50=ge,t.C500=Ee,t.C600=_e,t.C700=pe,t.C800=fe,t.C900=de,t.CURSOR_COLOR_PALETTE=wt,t.G100=$e,t.G200=Ze,t.G300=Qe,t.G400=Je,t.G50=et,t.G500=Xe,t.G600=qe,t.G700=ze,t.G800=Ke,t.G900=Ye,t.I100=Lt,t.I200=At,t.I300=It,t.I400=Ct,t.I50=Nt,t.I500=St,t.I600=Rt,t.I700=Tt,t.I800=bt,t.I900=vt,t.L100=ut,t.L200=ct,t.L300=st,t.L400=at,t.L50=lt,t.L500=it,t.L600=ot,t.L700=rt,t.L800=nt,t.L900=tt,t.N00=We,t.N100=He,t.N1000=we,t.N200=Ve,t.N300=Be,t.N400=Ue,t.N50=Ge,t.N500=je,t.N600=Me,t.N650=xe,t.N700=Fe,t.N800=Pe,t.N900=ke,t.N950=De,t.O100=$,t.O200=Z,t.O300=Q,t.O400=J,t.O50=ee,t.O500=X,t.O600=q,t.O700=z,t.O800=K,t.O900=Y,t.P100=Le,t.P200=Ae,t.P300=Ie,t.P400=Ce,t.P50=Ne,t.P500=Se,t.P600=Re,t.P700=Te,t.P800=be,t.P900=ve,t.R100=ue,t.R200=ce,t.R300=se,t.R400=ae,t.R50=le,t.R500=ie,t.R600=oe,t.R700=re,t.R800=ne,t.R900=te,t.T100=D,t.T200=w,t.T300=N,t.T400=L,t.T50=k,t.T500=I,t.T600=C,t.T700=S,t.T800=R,t.T900=T,t.V100=yt,t.V200=Ot,t.V300=mt,t.V400=ht,t.V50=gt,t.V500=Et,t.V600=_t,t.V700=pt,t.V800=ft,t.V900=dt,t.W100=v,t.W200=g,t.W300=y,t.W400=O,t.W50=b,t.W500=m,t.W600=h,t.W700=E,t.W800=_,t.W900=p,t.Y100=H,t.Y200=V,t.Y300=B,t.Y400=U,t.Y50=W,t.Y500=j,t.Y600=M,t.Y700=x,t.Y800=F,t.Y900=P},NVF8:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("o0o1"),u=n.n(r),o=n("yXPU"),i=n.n(o),l=n("WtXJ"),d=n("JHqw"),f=n("Nmqt");function p(){return(new Date).getTime()}function a(e){return s.apply(this,arguments)}function s(){return(s=i()(u.a.mark(function e(t){var n,r,o,i,a,s,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(f.b)(t)){e.next=25;break}if((r=window["scm".concat(t)]=window["scm".concat(t)]||{}).tracker=r.tracker||{},o=p(),Object(l.a)().length){e.next=12;break}return i=p(),e.next=9,Object(l.b)({loadModule:!0});case 9:a=e.sent,r.tracker.fetchList_cost_time=p()-i,Object(l.d)(a.navs);case 12:return s=p(),e.next=15,Object(l.c)(t);case 15:return r.tracker.intExternalJS_cost_time=p()-s,c=p(),e.next=19,d.a.manager.loadModule(t,{disableSandbox:!0});case 19:e.sent.precompile(),r.tracker.intModuleJS_cost_time=p()-c,(n=Object(f.b)(t))||console.error("get garr ".concat(t," module error")),r.tracker.loadModule_cost_time=(new Date).getTime()-o;case 25:return e.abrupt("return",Promise.resolve(n||{}));case 26:case"end":return e.stop()}},e)}))).apply(this,arguments)}window.garrRequire=a},Naly:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return d});var r=n("lwsE"),o=n.n(r),i=n("W8MJ"),s=n.n(i),a=n("J4zp"),c=n.n(a),u=function(e){return e.startsWith("translated_")?e.substr(11):e},l=function(e){return e.reduce(function(e,t){var n=t.split("_"),r=c()(n,3),o=r[0],i=r[1],a=r[2];return e[o]||(e[o]={},e[o][i]={}),e[o][i]=a,e},{})},d=function(){function a(){o()(this,a)}return s()(a,null,[{key:"init",value:function(e){try{var t,n=JSON.parse(localStorage.getItem("sheetZoom")||"[]"),r=l(n)[e];for(t in r){var o=Number(r[t]);(Number.isNaN(o)||o<=0)&&delete r[t]}a.zoomDataObj=r||{}}catch(e){a.zoomDataObj={}}}},{key:"getItem",value:function(e){return a.zoomDataObj[e]||1}},{key:"setItem",value:function(t,e,n){var r=u(e);try{var o=JSON.parse(localStorage.getItem("sheetZoom")||"[]");30<o.length&&o.shift();var i=o.findIndex(function(e){return e.startsWith(t+"_"+r)});if(-1<i)return 1===n?o.splice(i,1):o[i]="".concat(t,"_").concat(r,"_").concat(n),a.zoomDataObj[e]=n,void localStorage.setItem("sheetZoom",JSON.stringify(o));o.push("".concat(t,"_").concat(r,"_").concat(n)),a.zoomDataObj[e]=n,localStorage.setItem("sheetZoom",JSON.stringify(o))}catch(e){}}}]),a}();d.zoomDataObj={}},O3vZ:function(e,t,n){n("u+ON");var r=n("oWnS");e.exports=r("Array").indexOf},Olm7:function(e,t,n){"use strict";var s=n("fywt"),c=n("ntxC");function r(e,t){var n=[];if(!e||!e.length)return n;var r=-1,o=[],i=e.length;for(t=Object(s.a)(t,3);++r<i;){var a=e[r];t(a,r,e)&&(n.push(a),o.push(r))}return Object(c.a)(e,o),n}t.a=r},Pkdo:function(e,t,n){var r=n("pevS"),o=n("wbIY");r({target:"Object",stat:!0,forced:!o,sham:!o},{defineProperty:n("QYBB").f})},Qub4:function(e,t,n){var r=n("Bvq2");e.exports=!r(function(){return Object.isExtensible(Object.preventExtensions({}))})},"S/x3":function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return g}),n.d(t,"d",function(){return R}),n.d(t,"e",function(){return m}),n.d(t,"f",function(){return O}),n.d(t,"g",function(){return E}),n.d(t,"h",function(){return y}),n.d(t,"i",function(){return v}),n.d(t,"j",function(){return b}),n.d(t,"k",function(){return T}),n.d(t,"l",function(){return S});var r=n("mnMc"),l=n.n(r),d=n("3Hq1"),o=n("7EGn"),i=n("/FZm"),f=n.n(i),a=n("BmhO"),p=n("Wz9t"),s=n("iYz8"),_=n.n(s);function c(e){var t=String(e).split(".").pop();return t&&t!==e?t.toLowerCase():""}function E(e){return c(e&&e.name?e.name:"")}function u(e){return Boolean(e&&e.weboffice)}function h(e){return p.z.get(e)||[]}function m(e){return l()(a.A).call(a.A,E(e))}function O(e){return l()(a.K).call(a.K,E(e))}function y(e){return l()(a.x).call(a.x,E(e))}function g(e){return l()(a.v).call(a.v,E(e))}function v(e){return E(e)===a.s.PDF}function b(e){return l()(a.t).call(a.t,E(e))}function T(e){if(!e||!e.available_preview_type.length)return null;var t=h(E(e)),n=e.available_preview_type;if(0<t.length){var r=!0,o=!1,i=void 0;try{for(var a,s=_()(t);!(r=(a=s.next()).done);r=!0){var c=a.value;if(l()(n).call(n,c))return c}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return null}var u=f()(n).call(n,function(e){return l()(p.B).call(p.B,e)});return Object(d.default)(u)?null:u}function R(e){var t=e.fileInfo;if(e.enableWPSComponent&&u(t))return a.n.WPS;var n=a.n.NULL,r=T(t),o=p.P.get(r);return o?n=o:m(t)||O(t)?n=a.n.CODE:y(t)?n=a.n.AUDIO:g(t)?n=a.n.VIDEO:b(t)?n=a.n.IMG:v(t)&&(n=a.n.PDF),n}function S(e){if(!e||!e.name)return!1;switch(E(e)){case a.s.PDF:case a.s.CSV:return!0;case a.s.DOC:case a.s.DOCX:case a.s.DOT:case a.s.DOTX:case a.s.PPT:case a.s.PPTX:case a.s.PPS:case a.s.PPSX:case a.s.POT:return Object(o.default)(e,"preview_meta.data.".concat(a.m.PDF,".status"))===a.j.READY||Object(o.default)(e,"preview_meta.data.".concat(a.m.LINEARIZED_PDF,".status"))===a.j.READY;case a.s.XLS:case a.s.XLSX:case a.s.XLSM:return Object(o.default)(e,"preview_meta.data.".concat(a.m.HTML,".status"))===a.j.READY;default:return!1}}},S7iq:function(e,t,n){"use strict";n.d(t,"a",function(){return _}),n.d(t,"c",function(){return E}),n.d(t,"W",function(){return h}),n.d(t,"d",function(){return m}),n.d(t,"U",function(){return T}),n.d(t,"E",function(){return R}),n.d(t,"D",function(){return S}),n.d(t,"s",function(){return C}),n.d(t,"r",function(){return I}),n.d(t,"t",function(){return L}),n.d(t,"u",function(){return N}),n.d(t,"w",function(){return w}),n.d(t,"v",function(){return D}),n.d(t,"o",function(){return k}),n.d(t,"n",function(){return P}),n.d(t,"p",function(){return F}),n.d(t,"x",function(){return x}),n.d(t,"z",function(){return M}),n.d(t,"y",function(){return j}),n.d(t,"q",function(){return U}),n.d(t,"I",function(){return B}),n.d(t,"L",function(){return V}),n.d(t,"K",function(){return H}),n.d(t,"l",function(){return W}),n.d(t,"m",function(){return Y}),n.d(t,"e",function(){return K}),n.d(t,"J",function(){return z}),n.d(t,"f",function(){return q}),n.d(t,"db",function(){return X}),n.d(t,"eb",function(){return J}),n.d(t,"fb",function(){return Q}),n.d(t,"gb",function(){return Z}),n.d(t,"F",function(){return $}),n.d(t,"G",function(){return ee}),n.d(t,"H",function(){return te}),n.d(t,"T",function(){return ne}),n.d(t,"Q",function(){return ie}),n.d(t,"g",function(){return ae}),n.d(t,"k",function(){return se}),n.d(t,"j",function(){return ce}),n.d(t,"P",function(){return ue}),n.d(t,"i",function(){return le}),n.d(t,"M",function(){return de}),n.d(t,"b",function(){return o}),n.d(t,"O",function(){return fe}),n.d(t,"N",function(){return pe}),n.d(t,"cb",function(){return _e}),n.d(t,"V",function(){return Ee}),n.d(t,"ab",function(){return he}),n.d(t,"bb",function(){return me}),n.d(t,"R",function(){return Oe}),n.d(t,"S",function(){return ye}),n.d(t,"X",function(){return ge}),n.d(t,"Z",function(){return ve}),n.d(t,"Y",function(){return be}),n.d(t,"B",function(){return Te}),n.d(t,"C",function(){return Re}),n.d(t,"A",function(){return Se}),n.d(t,"h",function(){return Ce});var r,o,i,a=n("lSNA"),s=n.n(a),c=n("qxQb"),u=n.n(c),l=n("Ngi8"),d=n("fLNQ"),f=(l.N900,l.N500,l.N300),p=l.N300,_=l.B500,E=(l.N700,l.N00,u()(l.N900,.65),u()(l.N900,.4),u()(l.N900,.2),p),h=_,m=f,O=l.B500,y=d.a.isMac?u()(l.N900,.1):u()(l.N900,.15),g=l.N400,v="#FAD355",b=l.G500,T=h,R=l.B500,S=u()(l.N900,.1),C="crossLightGray",I="crossLightBlue",L="crossLightGreen",N="crossLightPurple",w="crossLightYellow",D="crossLightRed",k="crossGray",P="crossBlue",F="crossGreen",x="crossPurple",M="crossYellow",j="crossRed",U=(r={},s()(r,C,u()(l.N1000,.05)),s()(r,I,u()(l.B500,.15)),s()(r,L,u()(l.G500,.15)),s()(r,N,u()(l.P500,.15)),s()(r,w,u()(l.Y500,.15)),s()(r,D,u()(l.R500,.15)),s()(r,k,u()("#08141F",.2)),s()(r,P,u()(l.B500,.45)),s()(r,F,u()(l.G500,.5)),s()(r,x,u()(l.P500,.55)),s()(r,M,u()(l.Y500,.6)),s()(r,j,u()(l.R500,.55)),r),B={normal:l.N50,embed:l.N00},V=u()(l.B500,.06),H=l.N600,W=l.N300,Y=l.N500,K={color:y,width:1},z={color:g,width:1},q={color:l.N800,width:1},X={color:v,width:2},J={color:v,width:1},Q={color:"transparent",width:1},Z={color:O,width:1},$={color:u()(l.B500,1),width:1},ee={color:l.N400,width:2},te={offsetX:0,offsetY:0,color:u()(l.N900,.4),blur:16},ne=(u()(l.N900,.1),{color:T,width:2}),re={color:T,width:0},oe={color:l.N00,width:1},ie=u()(l.B500,.06),ae={color:T,width:1},se={color:T,width:1},ce={color:b,width:2},ue=u()(l.B500,.2),le="rgba(255, 205, 0, 0.25)",de=6;(i=o=o||{})[i.Level0=0]="Level0",i[i.Level1=100]="Level1",i[i.Level2=200]="Level2",i[i.Level3=300]="Level3",i[i.Level4=400]="Level4",i[i.Level5=500]="Level5",i[i.Level6=600]="Level6",i[i.Level7=700]="Level7",i[i.Level8=800]="Level8",i[i.Level9=900]="Level9",i[i.Level10=1e3]="Level10";var fe={color:l.N300,hoverColor:l.N400},pe={background:l.N00},_e={borderRight:ne,background:V,zindex:o.Level2},Ee={borderBottom:ne,background:V,zindex:o.Level2},he={borderBottom:ne,background:u()(l.N00,.2),zindex:o.Level2},me={borderRight:ne,background:u()(l.N00,.2),zindex:o.Level2},Oe={background:ie},ye={border:re,background:ie},ge={x:3,y:3,width:6,height:6,border:oe,background:T},ve={width:12,height:12},be={width:12,height:12,border:{width:1.5,color:l.N00},background:h},Te={resizeLineX:0,resizeLineY:0,resizeTipLineX:50,resizeTipLineY:24},Re={fontSize:12,borderRadius:4},Se=1,Ce={radius:10,minWidth:20,minHeight:20,padding:[1,6],margin:[3,2,3,2]}},TYER:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return z}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return o}),n.d(t,"e",function(){return R}),n.d(t,"f",function(){return Y}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return T}),n.d(t,"i",function(){return b}),n.d(t,"j",function(){return B});var b,r,o,i,T,a,s,c,u,l,d,f,R,p,_=n("cDf5"),E=n.n(_),S=n("UXvI"),C=n("XhtD"),h=n("vJtL"),m=n("YHdI"),O=n("4O8T"),I=n.n(O);(r=b=b||{})[r.SUCCESS=0]="SUCCESS",r[r.FAILED=1]="FAILED",r[r.INVALID_PARAM=2]="INVALID_PARAM",r[r.NOT_FOUND=3]="NOT_FOUND",r[r.FORBIDDEN=4]="FORBIDDEN",r[r.LOGIN_REQUIRED=5]="LOGIN_REQUIRED",r[r.LIMIT_EXCEED=6]="LIMIT_EXCEED",r[r.CHANGESET_LIMIT_EXCEED=1001]="CHANGESET_LIMIT_EXCEED",r[r.OBJECT_DELETED=1002]="OBJECT_DELETED",r[r.NOT_IN_SESSION=1003]="NOT_IN_SESSION",r[r.CHAGESET_INVALID=1005]="CHAGESET_INVALID",r[r.INTERNAL_ERROR=1006]="INTERNAL_ERROR",r[r.INVALID_MESSAGE=1007]="INVALID_MESSAGE",r[r.SYNC_FAILED=1008]="SYNC_FAILED",r[r.VERSION_TOO_OLD=1010]="VERSION_TOO_OLD",r[r.WRITE_PERMISSION_DENIED=1012]="WRITE_PERMISSION_DENIED",r[r.COMMENT_PERMISSION_DENIED=1013]="COMMENT_PERMISSION_DENIED",r[r.SERVICE_ERROR=1015]="SERVICE_ERROR",r[r.DATABASE_CONFLICT=1021]="DATABASE_CONFLICT",r[r.SERVER_BUSY=9998]="SERVER_BUSY",r[r.MISSING_VERSION_VERIFY_FAILED=-1101]="MISSING_VERSION_VERIFY_FAILED",r[r.RETRY_OVER_TIMES=-1102]="RETRY_OVER_TIMES",(i=o=o||{}).JSON="JSON",i.MESSAGE_BOX="MESSAGE_BOX",i.DOC="DOC",(a=T=T||{}).USER_NEWINFO="USER_NEWINFO",a.USER_LEAVE="USER_LEAVE",a.CLIENT_VARS="CLIENT_VARS",a.GET_VERSION="GET_VERSION",a.ENGAGEMENT_CURSOR="ENGAGEMENT_CURSOR",a.WATCH="WATCH",a.ACCEPT_WATCH="ACCEPT_WATCH",a.ACCEPT_COMMIT="ACCEPT_COMMIT",a.NEW_CHANGES="NEW_CHANGES",a.GET_MESSAGE="GET_MESSAGE",a.USER_CHANGES="USER_CHANGES",a.MESSAGE_CHANNEL="MESSAGE_CHANNEL",a.ROOM_MEMBERS="ROOM_MEMBERS",a.ERROR="ERROR",a.MESSAGE="MESSAGE",(c=s=s||{}).ENGINE_CHANNEL="engine_channel",c.MEMBER_CHANNEL="member_channel",(l=u=u||{}).Content="content",l.Note="note",l.Topic="topic",l.Title="title",l.Image="image",l.None="none",(f=d=d||{})[f.MISSING_VERSION_TOO_MANY=0]="MISSING_VERSION_TOO_MANY",f[f.MISSING_VERSION_VERIFY_FAILED=1]="MISSING_VERSION_VERIFY_FAILED",(p=R=R||{}).CLIENT_ERROR="CLIENT_ERROR",p.RESPONSE_ERROR="RESPONSE_ERROR";var L=function(){return(L=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function y(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}function g(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":E()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(i<3?o(a):3<i?o(t,n,a):o(t,n))||a);return 3<i&&a&&Object.defineProperty(t,n,a),a}function v(e,t){if("object"===("undefined"==typeof Reflect?"undefined":E()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function N(e,a,n,s){function c(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n=n||Promise)(function(t,n){function r(e){try{i(s.next(e))}catch(e){n(e)}}function o(e){try{i(s.throw(e))}catch(e){n(e)}}function i(e){e.done?t(e.value):c(e.value).then(r,o)}i((s=s.apply(e,a||[])).next())})}function w(e,n){var r,o,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},t={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function s(t){return function(e){return c([t,e])}}function c(t){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(i=2&t[0]?o.return:t[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,t[1])).done)return i;switch(o=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,o=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){a.label=t[1];break}if(6===t[0]&&a.label<i[1]){a.label=i[1],i=t;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(t);break}i[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(e,a)}catch(e){t=[6,e],o=0}finally{r=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}function D(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function k(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function P(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(k(arguments[t]));return e}function F(e){return e&&"function"==typeof e.then}function x(a){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[2],o=(n.get,n.set,n.writable,n.value),r=y(n,["get","set","writable","value"]);if(!Object(h.default)(o))return n;var i=new Map;return L(L({},r),{value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0]||a;if(!i.get(n)){var r=o.call.apply(o,P([this],e));return F(r)?(i.set(n,!0),r.then(function(e){return i.delete(n),e}).catch(function(e){throw i.delete(n),e})):console.error("should return an Promise")}}})}}function M(t){return new Promise(function(e){setTimeout(function(){e()},t)})}var j=(U.prototype.log=function(e,t){this.loggable&&console.log(this.prefix,e,t)},U.prototype.enable=function(){this.loggable=!0},U.prototype.disable=function(){this.loggable=!1},U);function U(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.loggable=!0,this.prefix="["+e.join("][")+"]"}var B=(V.prototype._log=function(e,t){void 0===t&&(t={}),this._logger.log(e,L(L({},this._loggerOptions),t))},Object.defineProperty(V.prototype,"NEW_CHANGES",{get:function(){return this._alias&&this._alias[T.NEW_CHANGES]||T.NEW_CHANGES},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"CLIENT_VARS",{get:function(){return this._alias&&this._alias[T.CLIENT_VARS]||T.CLIENT_VARS},enumerable:!0,configurable:!0}),V.prototype.registerEntity=function(){return N(this,void 0,void 0,function(){var t,n,r,o,i,a=this;return w(this,function(e){switch(e.label){case 0:return t={interval:1,callback:function(e){var t=a._version;e<=t||(console.log("engine: local: "+t+", remote: "+e),a.fetchMissVersionWithLimitingFrequency(e))}},n=Object.values(this.channels).reduce(function(e,t){var n,r=t.channel,o=t.heartbeat;return r&&o?L(L({},e),((n={})[r]=o,n)):e},((i={})[s.ENGINE_CHANNEL]=t,i)),r=this.generateWatchEntity(),o={handler:this.handleMessageFromServer,filter:r},[4,Promise.resolve(this._io.isEntityRegistered(r))];case 1:return e.sent()?(this._io.addHeartbeat(r,s.ENGINE_CHANNEL,t),this._io.addMessage(r,s.ENGINE_CHANNEL,o)):this._io.register(r,{message:o,heartbeats:n,acceptWatchHandler:this.handleAcceptWatch,isNewHeartbeatsProtocol:this._isNewProtocol}),[2]}})})},V.prototype.generateWatchEntity=function(){return L(L({type:this._syncType,token:this._token},this._requestDataOptions),this._requestWatchDataOptions)},V.prototype.syncEngineBaseRev=function(e){this.syncBaseRev("engine_channel",e)},V.prototype.syncBaseRev=function(e,t){this._receiveClientVars&&this._io.setHeartbeatVersion({type:this._syncType,token:this._token},e,t)},V.prototype.verrifyFetchMiss=function(e,t){return t[0]===e[0]},V.prototype.fetchMissVersionWithLimitingFrequency=function(e){e>this._latestVersion&&(this._latestVersion=e),this.fetchMissVersionFromCurrentToLatest()},V.prototype.fetchMissVersion=function(o){var i=this;if(this._receiveClientVars){if(!this._isFetching){var e=o[0];return o[o.length-1]-e>this.missVersionLimit?(this._log("dev_sync_fetch_missing_version_too_old"),void this.emit(T.ERROR,{type:R.RESPONSE_ERROR,msg:"version too old",code:b.VERSION_TOO_OLD,requestType:T.NEW_CHANGES})):0!==o.length?(this._log("dev_sync_fetch_missing",{rev_list:o,version:this._version}),this._isFetching=!0,(this._isNewProtocol&&this._request&&this._requestAPI?this.autoRetryRequestDoNotRelyOnIO(this._requestAPI.NEW_CHANGES,{member_id:this.memberId,token:this._token,rev_list:o}).then(function(e){return i.tryHandleErrorV2(e,T.NEW_CHANGES)}).then(function(e){var t,n=e.data,r=i.getChangesets(n);r?(t=r.sort(function(e,t){return i.getVersionOfChangeset(e)-i.getVersionOfChangeset(t)}).map(function(e){return i.getVersionOfChangeset(e)}),i.verrifyFetchMiss(o,t)?(W("NEW_CHANGES",e),i.handleNewChanges(n)):(i._log("dev_sync_fetch_missing_verrify_failed",{version:i._version,fetching_list:o,fetched_verion:t}),i.emit(T.ERROR,{code:b.MISSING_VERSION_VERIFY_FAILED,type:R.CLIENT_ERROR,msg:"fetched missing version verrified failed",options:{send:o,receive:t}}))):i._log("dev_sync_fetch_missing_no_changes")}):this.autoRetryRequest({type:this.NEW_CHANGES,member_id:this.memberId,token:this._token,rev_list:o},m.c.http).then(function(e){return i.tryHandleError(e,T.NEW_CHANGES)}).then(function(e){var t,n=e.data,r=i.getChangesets(n);r?(t=r.sort(function(e,t){return i.getVersionOfChangeset(e)-i.getVersionOfChangeset(t)}).map(function(e){return i.getVersionOfChangeset(e)}),i.verrifyFetchMiss(o,t)?i.handleMessageFromServer(e):(i._log("dev_sync_fetch_missing_verrify_failed",{version:i._version,fetching_list:o,fetched_verion:t}),i.emit(T.ERROR,{code:b.MISSING_VERSION_VERIFY_FAILED,type:R.CLIENT_ERROR,msg:"fetched missing version verrified failed",options:{send:o,receive:t}}))):i._log("dev_sync_fetch_missing_no_changes")})).finally(function(){i._log("dev_sync_fetch_missing_end",{rev_list:o,version:i._version}),i._isFetching=!1})):void this._log("dev_sync_fetch_missing_versions_is_empty",{version:this._version})}}else this._log("dev_sync_fetch_missing_before_client_vars")},V.prototype.verifyMessage=function(e){return e.type===this._syncType&&(e.data&&e.data.type===T.ERROR?e.token===this._token:e.data&&e.data.token===this._token)},V.prototype.autoRetryRequestDoNotRelyOnIO=function(r,o,i){return void 0===i&&(i=0),N(this,void 0,void 0,function(){var t,n;return w(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,6]),[4,this._request({url:r,method:"post",headers:L({"Content-Type":"application/json"},this._requestExceptWatchHeaderOptions),data:L(L({},o),this._requestDataOptions)})];case 1:return t=e.sent(),i<=0?[2,t]:t.code!==b.SERVICE_ERROR&&t.code!==b.DATABASE_CONFLICT?[3,3]:[4,M(3/i*1e3)];case 2:return e.sent(),this._log("dev_sync_request_retry_since_code",{retry:i,res_code:t.code,rev:this.version}),console.warn("[sync] retry request by server code"),[2,this.autoRetryRequestDoNotRelyOnIO(r,o,i-1)];case 3:return[3,6];case 4:if(n=e.sent(),i<=0)throw console.error("[sync] error response when io reject"),n;return[4,M(3/i*1e3)];case 5:return e.sent(),this._log("dev_sync_request_retry_since_reject",{retry:i,rev:this.version}),console.warn("[sync] retry request by net error"),[2,this.autoRetryRequestDoNotRelyOnIO(r,o,i-1)];case 6:return[2,t]}})})},V.prototype.autoRetryRequest=function(r,o,i){return void 0===o&&(o=m.c.http),void 0===i&&(i=0),N(this,void 0,void 0,function(){var t,n;return w(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,6]),[4,this._io.request(L({type:this._syncType,data:L(L({},r),this._requestDataOptions)},this._requestMessageOptions),{channel:o})];case 1:return t=e.sent(),i<=0?[2,t]:t.code!==b.SERVICE_ERROR&&t.data.code!==b.SERVICE_ERROR&&t.data.code!==b.DATABASE_CONFLICT?[3,3]:[4,M(3/i*1e3)];case 2:return e.sent(),this._log("dev_sync_request_retry_since_code",{retry:i,res_code:t.code,data_code:t.data.code,rev:this.version}),console.warn("[sync] retry request by server code"),[2,this.autoRetryRequest(r,m.c.http,i-1)];case 3:return[3,6];case 4:if(n=e.sent(),i<=0)throw console.error("[sync] error response when io reject"),n;return[4,M(3/i*1e3)];case 5:return e.sent(),this._log("dev_sync_request_retry_since_reject",{retry:i,rev:this.version}),console.warn("[sync] retry request by net error"),[2,this.autoRetryRequest(r,m.c.http,i-1)];case 6:return[2,t]}})})},V.prototype.handleChannelMessage=function(e){var t,n,r,o,i,a=e.type,s=this._channelMessageMap.get(a);s&&(t=s.getVersionOfChannelMessage,n=s.channel,r=s.refetchMessageIfVersionBreak,t&&n&&(o=t(e),(i=(this.io.getHeartbeatInfo(this.syncType,this.token)||{})[n].version)&&i+1<o&&r?r(i,o):this.syncBaseRev(n,o)),s.onChannelMessage&&s.onChannelMessage(e))},V.prototype.emit=function(e,t){this._em.emit(e,t)},V.prototype.on=function(e,t){this._em.on(e,t)},V.prototype.off=function(e,t){this._em.off(e,t)},Object.defineProperty(V.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"memberId",{get:function(){return this._io.getMemberId()+""},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"io",{get:function(){return this._io},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"channels",{get:function(){return this._channels},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"syncType",{get:function(){return this._syncType},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"receiveClientVars",{get:function(){return this._receiveClientVars},enumerable:!0,configurable:!0}),V.prototype.setClientVars=function(e){this.handleClientVars(e)},V.prototype.fetchClientVars=function(c){return void 0===c&&(c={}),N(this,void 0,void 0,function(){var t,n,r,o,i,a,s=this;return w(this,function(e){switch(e.label){case 0:return this._log("dev_fetch_client_vars"),this._isNewProtocol&&this._request&&this._requestAPI?[4,this.autoRetryRequestDoNotRelyOnIO(this._requestAPI.CLIENT_VARS,L({token:this._token,member_id:this.memberId},c),3).then(function(e){return s.tryHandleErrorV2(e,T.CLIENT_VARS)})]:[3,2];case 1:return(t=e.sent()).code!==b.SUCCESS?(console.error("fetchClientVars failed: ",t.data),[2,Promise.reject(t.data)]):(n=t.data,r=this.getVersionOfClientVars(n),this.handleClientVars(r),[2,n]);case 2:return[4,this.autoRetryRequest(L({type:this.CLIENT_VARS,token:this._token,member_id:this.memberId},c),m.c.http,3).then(function(e){return s.tryHandleError(e,T.CLIENT_VARS)})];case 3:return(o=e.sent()).data.type===T.ERROR?(console.error("fetchClientVars failed: ",o.data),[2,Promise.reject(o.data)]):(i=o.data,a=this.getVersionOfClientVars(i),this.handleClientVars(a),[2,i])}})})},V.prototype.handleClientVars=function(e){var t=this;this._log("dev_handle_client_vars",{version:e}),this._receiveClientVars=!0,this._version=e,this.syncEngineBaseRev(this._version);var n=this.generateWatchEntity();this._io.watch(n,{isNewProtocol:this._isNewProtocol}).catch(function(e){t._log("dev_watch_failed"),t.emit(T.ERROR,L(L({},e),{type:R.RESPONSE_ERROR,requestType:T.WATCH}))})},V.prototype.sendUserChange=function(e){var n=this;return this._log("dev_user_changes",{local_rev:this._version,rev:this._version+1}),this._isNewProtocol&&this._request&&this._requestAPI?this.autoRetryRequestDoNotRelyOnIO(this._requestAPI.USER_CHANGES,L({token:this._token,type:T.USER_CHANGES,member_id:this.memberId},e),3).then(function(e){return n.tryHandleErrorV2(e,T.USER_CHANGES)}).then(function(e){var t=e.data;W("ACCEPT_COMMIT",e),n.handleAcceptCommit(t),n.emit(T.MESSAGE,e)}):this.autoRetryRequest(L({token:this._token,type:T.USER_CHANGES,member_id:this.memberId},e),m.c.socket,3).then(function(e){return n.tryHandleError(e,T.USER_CHANGES)}).then(this.handleMessageFromServer)},V.prototype.destroy=function(){var e,t;null!==(t=(e=this.fetchMissVersionFromCurrentToLatest).cancel)&&void 0!==t&&t.call(e);var n=this.generateWatchEntity();this._io.removeMessage(n,s.ENGINE_CHANNEL),this._io.removeHeartbeat(n,s.ENGINE_CHANNEL),this._io.unRegister(n),this._em.removeEvent()},V);function V(e){var t,n,f=this,r=e.io,o=e.type,i=e.token,a=e.alias,s=e.requestMessageOptions,c=e.requestDataOptions,u=e.requestWatchDataOptions,l=e.requestExceptWatchHeaderOptions,d=e.request,p=e.requestAPI,_=e.isNewProtocol,E=e.registerChannels,h=e.logger,m=e.fetchMissWait,O=void 0===m?1e3:m;this._version=1,this._receiveClientVars=!1,this._loggerOptions={},this._em=new I.a,this._channelMessageMap=new Map,this._isFetching=!1,this._isNewProtocol=!1,this._latestVersion=1,this.tryHandleError=function(e,t){var n,r,o=e.data,i=e.request_id;return o.type===T.ERROR&&(n=o.code,r=o.msg,f._log("dev_sync_error",{code:n,requestType:t,msg:r,requestId:i}),f.emit(T.ERROR,L(L({},o),{type:R.RESPONSE_ERROR,requestType:t}))),e},this.tryHandleErrorV2=function(e,t){var n=e.code,r=e.msg;return n!==b.SUCCESS&&(f._log("dev_sync_error",{code:n,requestType:t,msg:r}),f.emit(T.ERROR,L(L({},e),{type:R.RESPONSE_ERROR,requestType:t}))),e},this.fetchMissVersionFromCurrentToLatest=function(){f._version>=f._latestVersion||f.fetchMissVersion(Object(C.a)(f._version+1,f._latestVersion+1))},this.handleMessageFromServer=function(e){if(!e.data)return f.emit(T.MESSAGE,e),e;if(H(e),!f.verifyMessage(e))return f.emit(T.MESSAGE,e),e;var t=e.data;switch(t.type){case f.NEW_CHANGES:f.handleNewChanges(t);break;case T.ACCEPT_COMMIT:f.handleAcceptCommit(t);break;default:f.handleChannelMessage(t)}return f.emit(T.MESSAGE,e),e},this.handleAcceptWatch=function(e){var t,n,r=e.data.entities,o=f._version;f.emit(T.ACCEPT_WATCH);try{for(var i=D(r),a=i.next();!a.done;a=i.next()){var s=a.value,c=s.type,u=s.token,l=s.version;if(c===f._syncType&&u===f._token)return void(l&&o<l&&f.fetchMissVersionWithLimitingFrequency(l))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},this.handleNewChanges=function(e){var t,n;if(e.over_size){var r=f.getVersionOfOversize(e);return(f._log("dev_sync_new_changes_oversize",{version:r,rev:f.version}),r<=f._version)?void f._log("dev_sync_new_changes_oversize_return"):void f.fetchMissVersionWithLimitingFrequency(r)}var o=f.getChangesets(e);if(f._log("dev_sync_new_changes",{rev_list:o.map(function(e){return f.getVersionOfChangeset(e)}),rev:f._version}),o.length)if(o.sort(function(e,t){return f.getVersionOfChangeset(e)-f.getVersionOfChangeset(t)}),f.getVersionOfChangeset(o[0])>f._version+1){var i=o[o.length-1],a=f.getVersionOfChangeset(i);f.fetchMissVersionWithLimitingFrequency(a)}else try{for(var s=D(o),c=s.next();!c.done;c=s.next()){var u=c.value,l=f.getVersionOfChangeset(u);if(!(l<=f._version)){if(l>f._version+1)break;var d=f.version;if(f._version=l,f.syncEngineBaseRev(f._version),f.isSelfChangeset(u))return f._log("dev_sync_new_changes_ack",{rev:f.version}),void f.emit(T.ACCEPT_COMMIT,u);f._log("dev_sync_emit_new_changes",{oldVersion:d,rev:f.version}),f.emit(T.NEW_CHANGES,u)}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},this.handleAcceptCommit=function(e){var t=f.getVersionOfAcceptCommit(e);f._log("dev_sync_ack",{rev:t,local_rev:f._version});var n=f._version;t===n+1?(f._version=t,f.syncEngineBaseRev(f._version),f.emit(T.ACCEPT_COMMIT,e)):n<t&&f.fetchMissVersionWithLimitingFrequency(t)},this.fetchMissVersionFromCurrentToLatest=Object(S.default)(this.fetchMissVersionFromCurrentToLatest,O),this._io=r,this._syncType=o,this._token=i,this._alias=a,this._requestMessageOptions=s||{},this._requestDataOptions=c||{},this._requestWatchDataOptions=u||{},this._requestExceptWatchHeaderOptions=l||{},this._request=d,this._requestAPI=p,this._isNewProtocol=Boolean(_),this._channels=E?E(this):{};var y=function(t){t.messageTypes&&Array.from(t.messageTypes).forEach(function(e){f._channelMessageMap.set(e,t)})};try{for(var g=D(Object.values(this.channels)),v=g.next();!v.done;v=g.next())y(v.value)}catch(e){t={error:e}}finally{try{v&&!v.done&&(n=g.return)&&n.call(g)}finally{if(t)throw t.error}}this._loggerOptions={sync_type:this._syncType,sync_token:window.encryptTea?window.encryptTea(this._token):""},this._logger=h||new j("DataJS","Sync",o),this.registerEntity()}function H(e){var t=e.data,n=t.type;"RESPONSE"===n||n===T.ENGAGEMENT_CURSOR||n===T.CLIENT_VARS&&"gzip_snapshot"in t||(n!==T.ERROR?console.log("received!",n,t.new_rev||t.revision||t.note_revision,e.request_id):console.error("received!",n,t.code,t.msg,e.request_id))}function W(e,t){var n=t.data;console.log("received!",e,n.new_rev||n.revision||n.note_revision,t)}var Y=(Object.defineProperty(K.prototype,"messageTypes",{get:function(){return new Set([T.USER_LEAVE,T.USER_NEWINFO,T.ROOM_MEMBERS])},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"channel",{get:function(){return"member_channel"},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"heartbeat",{get:function(){var n=this;return{interval:1,callback:function(e,t){e<=t||(console.log("oldVersion: "+t+", newVersion: "+e),n.fetchRoomMembers())}}},enumerable:!0,configurable:!0}),K.prototype.getVersionOfChannelMessage=function(e){return e.version},K.prototype.fetchRoomMembers=function(){var r=this;return this.fetchMemberList().then(function(e){var t=e.data,n=t.version;r.setHeartbeatVersion(n),r.emit(T.ROOM_MEMBERS,t)})},K.prototype.setHeartbeatVersion=function(e){this.sync.io.setHeartbeatVersion({type:this.sync.syncType,token:this.sync.token},this.channel,e)},K.prototype.onChannelMessage=function(e){switch(e.type){case T.USER_NEWINFO:this.emit(T.USER_NEWINFO,e);break;case T.USER_LEAVE:this.emit(T.USER_LEAVE,e)}},K.prototype.on=function(e,t){this._em.on(e,t)},K.prototype.off=function(e,t){this._em.off(e,t)},K.prototype.emit=function(e,t){this._em.emit(e,t)},g([x(),v("design:type",Function),v("design:paramtypes",[]),v("design:returntype",void 0)],K.prototype,"fetchRoomMembers",null),K);function K(e,t){var n=this,r=t.fetchMemberList,o=t.shouldFetchMemberList;this.sync=e,this._em=new I.a,this.handleAcceptWatch=function(){n.fetchRoomMembers()},this.refetchMessageIfVersionBreak=function(e,t){t<=e+1||n.shouldFetchMemberList&&!1===n.shouldFetchMemberList()||n.fetchRoomMembers()},this.fetchMemberList=r,this.shouldFetchMemberList=o,e.on(T.ACCEPT_WATCH,this.handleAcceptWatch)}var z=(Object.defineProperty(q.prototype,"messageTypes",{get:function(){return new Set([T.ENGAGEMENT_CURSOR])},enumerable:!0,configurable:!0}),q.prototype.onChannelMessage=function(e){this.emit(T.ENGAGEMENT_CURSOR,e)},q.prototype.on=function(e,t){this._em.on(e,t)},q.prototype.off=function(e,t){this._em.off(e,t)},q.prototype.emit=function(e,t){this._em.emit(e,t)},q);function q(){this._em=new I.a}},UB5X:function(e,t,n){var r=n("NykK"),o=n("ExA7"),i="[object Number]";function a(e){return"number"==typeof e||o(e)&&r(e)==i}e.exports=a},UF4K:function(e,t,n){e.exports=n("F8Eo")},W1ep:function(e,t,n){var f=n("b42z"),p=n("JhaV"),_=n("ZyXh"),E=n("GUr9"),h=n("C3ug"),m=n("+qqD"),O=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,n,r,o){var i,a,s,c,u,l,d=E(t,n,r?2:1);if(o)i=e;else{if("function"!=typeof(a=h(e)))throw TypeError("Target is not iterable");if(p(a)){for(s=0,c=_(e.length);s<c;s++)if((u=r?d(f(l=e[s])[0],l[1]):d(e[s]))&&u instanceof O)return u;return new O(!1)}i=a.call(e)}for(;!(l=i.next()).done;)if((u=m(i,d,l.value,r))&&u instanceof O)return u;return new O(!1)}).stop=function(e){return new O(!0,e)}},WItK:function(e,f,p){"use strict";(function(e){p.d(f,"a",function(){return c}),p.d(f,"b",function(){return d});var t=p("EyGs"),n=p("U6jp"),r=p("TtEC"),o=p("iP/4"),i=p("rLED"),a=Object(n.j)("appVersion"),s=o.a.isLark&&!/electron/i.test(navigator.userAgent),c=!s&&Object(t.a)(a,Object(r.i)())&&Object(r.b)()&&e,u=Object(i.N)("native_upload_manager_least_version",""),l=Object(i.I)("native_upload_manager_enabled",!1)&&Object(t.a)(a,u),d=s&&e&&l}).call(this,p("kCIs"))},Wz9t:function(e,t,n){"use strict";n.r(t),n.d(t,"$",function(){return g}),n.d(t,"A",function(){return ee}),n.d(t,"B",function(){return w}),n.d(t,"C",function(){return v}),n.d(t,"D",function(){return X}),n.d(t,"E",function(){return ne}),n.d(t,"F",function(){return z}),n.d(t,"G",function(){return T}),n.d(t,"H",function(){return B}),n.d(t,"I",function(){return Y}),n.d(t,"J",function(){return W}),n.d(t,"K",function(){return V}),n.d(t,"L",function(){return be}),n.d(t,"M",function(){return U}),n.d(t,"N",function(){return R}),n.d(t,"O",function(){return le}),n.d(t,"P",function(){return P}),n.d(t,"Q",function(){return D}),n.d(t,"R",function(){return M}),n.d(t,"S",function(){return I}),n.d(t,"T",function(){return J}),n.d(t,"U",function(){return x}),n.d(t,"V",function(){return C}),n.d(t,"W",function(){return N}),n.d(t,"X",function(){return H}),n.d(t,"Y",function(){return Z}),n.d(t,"Z",function(){return Q}),n.d(t,"_",function(){return $}),n.d(t,"a",function(){return b}),n.d(t,"b",function(){return ge}),n.d(t,"c",function(){return q}),n.d(t,"d",function(){return ve}),n.d(t,"e",function(){return k}),n.d(t,"f",function(){return L}),n.d(t,"g",function(){return ue}),n.d(t,"h",function(){return ae}),n.d(t,"i",function(){return Ee}),n.d(t,"j",function(){return de}),n.d(t,"k",function(){return fe}),n.d(t,"l",function(){return pe}),n.d(t,"m",function(){return K}),n.d(t,"n",function(){return _e}),n.d(t,"o",function(){return he}),n.d(t,"p",function(){return se}),n.d(t,"q",function(){return Oe}),n.d(t,"r",function(){return ce}),n.d(t,"s",function(){return me}),n.d(t,"t",function(){return ie}),n.d(t,"u",function(){return oe}),n.d(t,"v",function(){return ye}),n.d(t,"w",function(){return re}),n.d(t,"x",function(){return S}),n.d(t,"y",function(){return te}),n.d(t,"z",function(){return F});var r,o,i,a=n("5PDf"),s=n.n(a),c=n("04Ix"),u=n.n(c),l=n("yIs4"),d=n("OL4R"),f=n("STz3"),p=n.n(f),_=n("BmhO"),E=n("UF4K"),h=n.n(E),m=n("ZbhI"),O=n.n(m),y={"archive.name":"名称","archive.no_result":"这是一个空文件夹","archive.size":"大小","common.can_not_copy":"复制失败，所有者关闭了文件的复制功能","common.cancel":"取消","common.confirm":"确认","common.download":"下载","common.download_failed":"下载失败","common.download_success":"下载成功","common.downloading":"文件正在下载中","common.file_deleted_content":"该文件已被删除","common.file_need_password":"此文件受密码保护，无法预览文件。","common.file_not_found_content":"此文件不存在","common.file_preview_failed":"文件预览失败","common.file_too_large":"文件太大无法预览","common.file_too_small":"大小为0的文件无法预览","common.file_transcoding":"正在转码中","common.file_type_not_supported":"文件类型无法预览","common.find":"查找","common.find_placeholder":"在文件内查找","common.loading":"正在加载","common.network_error":"网络错误，请稍后重试。","common.no_authority":"管理员已禁用此功能，如有疑问请联系管理员","common.no_permission_content":"没有权限访问","common.open_locally":"查看文件夹","common.prompt":"提示","common.retry":"重试","common.save_failed":"保存失败，请重试","common.save_success":"保存成功!","common.save_to_drive":"保存到云文档","common.saving_to_drive":"保存中...","common.share":"分享","common.view_in_drive":"在线预览","common.waiting_render":"在线预览正在生成中，可能需要一点时间，请稍后查看","error.excel.size_exceeded":"表格过大，无法预览","error.wps.action_back_to_preview":"返回预览","error.wps.action_request_permission":"申请权限","error.wps.file_too_large":"文件过大，不支持在线编辑","error.wps.generic":"加载失败，请稍后重试","error.wps.offline":"网络异常，请稍后重试","error.wps.permission":"您的操作权限不足，请向所有者申请权限","error.wps.session_full":"在线编辑人数超过上限，请稍后再试","image.download":"下载","image.exitfullscreen":"退出全屏","image.fullscreen":"全屏","image.next":"下一张","image.onetoone":"原始尺寸","image.prev":"上一张","image.reset":"适应页面","image.rotate":"旋转","image.zoomin":"放大","image.zoomout":"缩小","pdf.comment":"评论","pdf.copy":"复制","pdf.download":"下载","pdf.exitfullscreen":"退出全屏","pdf.fullscreen":"全屏","pdf.fullscreen_tips":"按 ESC 可退出演示模式","pdf.next":"下一页","pdf.password_is_wrong":"您输入的密码错误，请重试。","pdf.password_tips":"此文件受密码保护，请输入密码","pdf.play":"演示","pdf.presentation_end":"结束演示","pdf.presentation_last":"已是最后一页，按 ESC 退出","pdf.prev":"上一页","pdf.print":"打印","pdf.print_loading":"正在准备打印","pdf.sidebar":"侧边栏","pdf.turn_page":"翻页","pdf.zoomin":"放大","pdf.zoomout":"缩小","video.aborted_error":"取回过程被用户中止","video.decode_error":"解码时发生错误","video.error":"网络连接似乎出现了问题","video.have_current_data":"关于当前播放位置的数据是可用的，但没有足够的数据来播放下一帧/毫秒","video.have_enough_data":"可用数据足以开始播放","video.have_future_data":"当前及至少下一帧的数据是可用的","video.have_meta_data":"音频/视频的元数据已就绪","video.have_nothing":"没有关于音频/视频是否就绪的信息","video.network.empty":"音频/视频尚未初始化","video.network.idle":"音频/视频是活动的且已选取资源，但并未使用网络","video.network.loading":"浏览器正在下载数据","video.network.no_source":"未找到音频/视频来源","video.network_error":"下载时发生错误","video.not_supported":"不支持的音频/视频格式","video.original_file":"原画","video.replay":"重播","video.stats":"视频信息","warning.file_preview_limited":"${1} 预览仅显示部分内容，建议下载后查看全部"},g=Object.freeze({__proto__:null,default:y}),v={EXPLORER:"explorer"},b={SAVE_TO_DRIVE_SUCCESS:"SAVE_TO_DRIVE_SUCCESS",SAVE_TO_DRIVE_FAILED:"SAVE_TO_DRIVE_FAILED",WAITING_RENDER:"WAITING_RENDER",DOWNLOAD_ERROR:"DOWNLOAD_ERROR",DOWNLOAD_SUCCESS:"DOWNLOAD_SUCCESS",COPY_FAILED:"COPY_FAILED"},T=3e3,R=1e4,S=40,C=10,I=90002101,L=2e3,N="folder",w=s()(r=p()(_.m)).call(r,l.default),D=[_.m.LINEARIZED_JPG,_.m.LINEARIZED_PNG],k={AUDIO:"audio",VIDEO:"video"},P=new h.a([[_.m.PDF,_.n.PDF],[_.m.LINEARIZED_PDF,_.n.PDF],[_.m.PNG,_.n.IMG],[_.m.JPG,_.n.IMG],[_.m.LINEARIZED_JPG,_.n.IMG],[_.m.LINEARIZED_PNG,_.n.IMG],[_.m.VIDEO,_.n.VIDEO],[_.m.ARCHIVE,_.n.ARCHIVE],[_.m.TEXT,_.n.CODE],[_.m.HTML,_.n.SHEET]]),F=new h.a([[_.s.PDF,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.DOC,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.DOCX,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.DOT,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.DOTX,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.PPT,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.PPTX,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.PPS,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.PPSX,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.POT,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.RTF,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.XLS,[_.m.HTML,_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.XLSX,[_.m.HTML,_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.XLSM,[_.m.HTML,_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.CSV,[_.m.TEXT,_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.TXT,[_.m.TEXT,_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.AVI,[_.m.VIDEO]],[_.s.MOV,[_.m.VIDEO]],[_.s.MP4,[_.m.VIDEO]],[_.s.A3GP,[_.m.VIDEO]],[_.s.A3GPP,[_.m.VIDEO]],[_.s.A3GPP2,[_.m.VIDEO]],[_.s.ASF,[_.m.VIDEO]],[_.s.DV,[_.m.VIDEO]],[_.s.M2T,[_.m.VIDEO]],[_.s.M4V,[_.m.VIDEO]],[_.s.MKV,[_.m.VIDEO]],[_.s.MPE,[_.m.VIDEO]],[_.s.MPG,[_.m.VIDEO]],[_.s.MTS,[_.m.VIDEO]],[_.s.OGV,[_.m.VIDEO]],[_.s.RM,[_.m.VIDEO]],[_.s.TS,[_.m.VIDEO]],[_.s.VOB,[_.m.VIDEO]],[_.s.WEBM,[_.m.VIDEO]],[_.s.WMV,[_.m.VIDEO]],[_.s.SKETCH,[_.m.PNG]],[_.s.HEIC,[_.m.JPG]],[_.s.HEIF,[_.m.JPG]],[_.s.JPEG,[_.m.LINEARIZED_JPG]],[_.s.JPG,[_.m.LINEARIZED_JPG]],[_.s.PNG,[_.m.LINEARIZED_PNG]],[_.s.SVG,[_.m.LINEARIZED_PNG,_.m.PNG]],[_.s.PSD,[_.m.LINEARIZED_PNG,_.m.PNG]],[_.s.PSB,[_.m.LINEARIZED_PNG,_.m.PNG]],[_.s.AI,[_.m.LINEARIZED_PNG,_.m.PNG]],[_.s.TAR,[_.m.ARCHIVE]],[_.s.GZ,[_.m.ARCHIVE]],[_.s.BZ2,[_.m.ARCHIVE]],[_.s.ZIP,[_.m.ARCHIVE]],[_.s.RAR,[_.m.ARCHIVE]],[_.s.PAGES,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.NUMBERS,[_.m.LINEARIZED_PDF,_.m.PDF]],[_.s.KEY,[_.m.LINEARIZED_PDF,_.m.PDF]]]),x=new h.a([[_.m.LINEARIZED_JPG,_.m.JPG],[_.m.LINEARIZED_PNG,_.m.PNG],[_.m.LINEARIZED_PDF,_.m.PDF]]),M=[_.j.INTERFACE_ERROR,_.j.GET_FILE_INFO_ERROR,_.j.IFRAME_NETWORK_ERROR,_.j.PROGRESS,_.j.WPS_GENERIC_ERROR,_.j.WPS_NETWORK_OFFLINE],j=(o={},u()(o,_.a.LARK,_.h.LARK),u()(o,_.a.APPBUILDER,_.h.APPBUILDER),u()(o,_.a.SMARTABLE,_.h.SMARTABLE),o),U=Object(d.a)(j),B="drive-pdf-info",V="drive-media-info",H="drive-sheet-info",W=256,Y={SAVE_TO_DRIVE:"saveToDrive",VIEW_IN_DRIVE:"viewInDrive",DOWNLOAD:"download",OPEN_LOCALLY:"openLocally",SHARE:"share"},K={name:"",size:-1,available_preview_type:[],preview_status:_.j.GET_FILE_INFO_ERROR,version:"",data_version:"",comment_flag:0,weboffice:!1},z={FILE_TOKEN:"FILE_TOKEN",VERSION:"VERSION",SEED:"SEED",IS_IN_EDIT_MODE:"IS_IN_EDIT_MODE"},q=[_.n.PDF],X={chrome:["mp4v","hvc1","fmp4","hev1","apcn"],safari:["mp4v","vp09","fmp4","hev1"]},J={EXCEL:"excel",PDF:"pdf"},Q={WPS:1},Z={UNKNOWN:"Unknown",FILE_INFO_ERROR:"GetFileInfoFailed",USER_NOT_LOGIN:"userNotLogin",INVALID_LINK:"InvalidLink",SESSION_FULL:"SessionFull",FAIL:"Fail",PERMISSION_DENIED:"PermissionDenied",GET_TOKEN_FAILED:"GetTokenFailed",SESSION_EXPIRED:"SessionExpired",FILE_TOO_LARGE:"fileTooLarge"},$={READ:1,EDIT:2},ee="ALL_PREVIEW_STATUS",te={PDF_PRINT:"PDF_PRINT",PDF_TO_PREV_PAGE:"PDF_TO_PREV_PAGE",PDF_TO_NEXT_PAGE:"PDF_TO_NEXT_PAGE",PDF_JUMP_TO_PAGE:"PDF_JUMP_TO_PAGE",PDF_ZOOM_IN:"PDF_ZOOM_IN",PDF_ZOOM_OUT:"PDF_ZOOM_OUT",MEDIA_PLAY:"MEDIA_PLAY",MEDIA_PAUSE:"MEDIA_PAUSE",MEDIA_SET_CURRENT_TIME:"MEDIA_SET_CURRENT_TIME",MEDIA_SET_CURRENT_VOLUME:"MEDIA_SET_CURRENT_VOLUME",SHEET_TO_TAB:"SHEET_TO_TAB",WPS_JUMP_TO_PAGE:"WPS_JUMP_TO_PAGE",WPS_SAVE:"WPS_SAVE",WPS_TAB_TO_INDEX:"WPS_TAB_TO_INDEX",WPS_PRINT:"WPS_PRINT"},ne={HEADER:"header",TOOLBAR:"toolbar",NOT_PREVIEWABLE_COMPONENT:"not_previewable_component",PREVIEW_COMPONENT:"preview_component"},re={CLICK:"click",AUTO:"auto"},oe=s()(i=p()(_.b)).call(i,function(e){return 0===O()(e).call(e,_.k)}),ie=[_.b.SAVE_TO_DRIVE_FAILED,_.b.WPS_COMMON_ERROR,_.b.MULTI_ERROR],ae="toggle_attribute",se="preview_pv",ce="outside_toggle_attribute",ue="dev_performance_drive_open_finish",le="dev_performance_drive_open_stages",de="click_open_mentioned_obj",fe="mention_download",pe="link_clicked",_e="drive_enter_presentation",Ee="preview_error",he="media_play_cost_time",me="common_error",Oe="preview_reload_i18n",ye={RequestFileInfo:"request_file_info",RequestPreviewUrl:"request_preview_url",RenderFile:"render_file"},ge={Success:"DEC0",Cancel:"DEC1",NetworkError:"DEC2",RenderError:"DEC3",RequestFileInfoError:"DEC4",RequestPreviewUrlError:"DEC5",FileDeletedError:"DEC6",NoPermission:"DEC7",NotFound:"DEC8",Unknown:"DEC9",UnsupportedFileType:"DEC11",FileSizeExceed:"DEC12",EmptyFileContent:"DEC13",Transcoding:"DEC14"},ve=new h.a([[_.j.INTERFACE_ERROR,ge.NetworkError],[_.j.FILE_RENDER_ERROR,ge.RenderError],[_.j.GET_FILE_INFO_ERROR,ge.RequestFileInfoError],[_.j.GET_PREVIEW_URL_ERROR,ge.RequestPreviewUrlError],[_.j.GET_PREVIEW_URL_FATAL,ge.RequestPreviewUrlError],[_.j.FILE_TYPE_UNSUPPORTED,ge.UnsupportedFileType],[_.j.FILE_TOO_LARGE,ge.FileSizeExceed],[_.j.FILE_EMPTY,ge.EmptyFileContent],[_.j.IFRAME_NETWORK_ERROR,ge.NetworkError],[_.j.PROGRESS,ge.Transcoding],[_.j.NO_PERMISSION,ge.NoPermission],[_.j.FILE_DELETED,ge.FileDeletedError],[_.j.FILE_NOT_FOUND,ge.NotFound],[_.j.FILE_NEED_PASSWORD,ge.Cancel],[_.j.PART_ERROR,ge.RequestPreviewUrlError],[_.j.PREVIEW_TYPE_UNMATCH,ge.RequestPreviewUrlError],[_.j.ARCHIVE_FILE_TYPE_UNEXPECTED,ge.RequestPreviewUrlError],[_.j.ARCHIVE_FILE_WHOLE_NODE_COUNT_EXCEEDED,ge.FileSizeExceed],[_.j.ARCHIVE_FILE_SINGLE_NODE_COUNT_EXCEEDED,ge.FileSizeExceed]]),be={doc:"drivesdk_creation",doc_file:"drivesdk_creation",bitable:"drivesdk_creation",default:"ccm_drive"}},WzBf:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n("lwsE"),o=n.n(r),i=n("W8MJ"),a=n.n(i),s=n("mJXI"),c=n("5gS9"),u=n("toa8"),l=n("rLED"),d=function(){function i(){o()(this,i)}return a()(i,null,[{key:"register",value:function(e,t){var n=this.generateOptions(e),r=n.token,o=i.messageBoxMap.get(r);o||(o=new s.a(n,c.b.getInstance(),u.d,Object(l.H)()),i.messageBoxMap.set(r,o)),o.register(t,n.subtype)}},{key:"deregister",value:function(e,t){var n=this.generateOptions(e),r=i.messageBoxMap.get(n.token);r&&(r.deregister(t,n.subtype),r.isRegistered()||(r.destory(),i.messageBoxMap.delete(n.token)))}},{key:"onError",value:function(e,t){var n=this.generateOptions(e),r=i.messageBoxMap.get(n.token);r||(r=new s.a(n,c.b.getInstance(),u.d,Object(l.H)()),i.messageBoxMap.set(n.token,r)),r.onError(t)}},{key:"removeErrorListener",value:function(e,t){var n=this.generateOptions(e),r=i.messageBoxMap.get(n.token);r&&r.removeErrorListener(t)}},{key:"generateOptions",value:function(e){return"string"==typeof e?{token:e}:e}}]),i}();d.messageBoxMap=new Map},X32N:function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},XhtD:function(e,t,n){"use strict";var r=n("eHo2"),o=Object(r.a)();t.a=o},Xngx:function(e,t,n){"use strict";var r=n("RIqP"),o=n.n(r),i=n("yIs4"),a=n("F2y5"),s=n("BmhO"),c=n("VIFs"),u=n("kUgE"),l=n("EVj1"),d=n("5ydi"),f=n("y94N"),p=n("VQSS"),_=n("JC8k");function E(e){var t=e.fileToken,n=e.mountPoint,r=e.version,o=Object(c.prependDriveStreamAPI)("/api/box/stream/download/all/".concat(t,"/")),i=Object(p.a)({mount_node_token:n&&n.token,mount_point:n&&n.type,version:r});return o+Object(l.d)(i)}function h(e){var t=e.fileToken,n=e.mountPoint,r=e.coverOptions,o=Object(c.prependAPI)("/api/box/stream/download/v2/cover/".concat(t,"/")),i=Object(p.a)({mount_node_token:n&&n.token,mount_point:n&&n.type,width:r&&r.width,height:r&&r.height,policy:r&&r.policy,shape:r&&r.shape});return o+Object(l.d)(i)}function m(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;if(!Object(i.default)(e))return"";var n=e;return n<1024?"".concat(Math.round(n)," B"):(n/=1024)<1024?"".concat(n.toFixed(t)," KB"):(n/=1024)<1024?"".concat(n.toFixed(t)," MB"):(n/=1024)<1024?"".concat(n.toFixed(t)," GB"):"".concat((n/=1024).toFixed(t)," TB")}function O(e){var t=Object(_.a)(e),n={image:o()(s.C),video:o()(s.D),audio:o()(s.E),txt:o()(s.F),word:o()(s.G),excel:o()(s.B),ppt:o()(s.H),code:o()(s.A)};return Object.keys(n).find(function(e){return n[e].includes(t)})||t}function y(e){return s.w.includes(e.toLowerCase())}function g(e){return s.x.includes(e.toLowerCase())}function v(e){return s.u.includes(e.toLowerCase())}function b(e){return s.J.includes(e.toLowerCase())}var T=function(e){return Array.isArray(e)?e.map(function(e){switch(e&&e.type){case d.e.NewVersion:return new d.b(e);case d.e.RenameFile:return new d.c(e);case d.e.DeleteVersion:return new d.a(e);case d.e.RestoreVersion:return new d.d(e);default:return null}}).filter(function(e){return e}):[]},R=function(e,t){var n=e.map(function(e){return e.get("version")});return t.filter(function(e){return e&&!n.includes(e.get("version"))})};function S(e){return"number"!=typeof e||e<1e4?e:"zh"===Object(u.getLanguage)()?"".concat(Object(a.a)(e/1e4,1),"万"):"".concat(Object(a.a)(e/1e3,1),"K")}function C(e){if(!e.render_config)return{};try{var t=e.render_config;return"string"==typeof e.render_config&&(t=JSON.parse(e.render_config)),{"--top-border-bg-color":t&&t.show_top_border?t.top_border_color:"transparent"}}catch(e){return{}}}function I(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=Object(_.a)(e);return s.C.includes(t)?s.C:s.D.includes(t)?s.D:s.E.includes(t)?s.E:s.G.includes(t)?s.G:s.B.includes(t)?s.B:s.H.includes(t)?s.H:t===s.s.PDF?[s.s.PDF]:void 0}function L(e){return s.C.includes(e)?f.d.IMAGE:f.d.FILE}n.d(t,"d",function(){return _.a}),n.d(t,"f",function(){return _.b}),n.d(t,"c",function(){return E}),n.d(t,"b",function(){return h}),n.d(t,"g",function(){return m}),n.d(t,"e",function(){return O}),n.d(t,"n",function(){return y}),n.d(t,"l",function(){return g}),n.d(t,"m",function(){return v}),n.d(t,"k",function(){return b}),n.d(t,"o",function(){return T}),n.d(t,"p",function(){return R}),n.d(t,"a",function(){return S}),n.d(t,"i",function(){return C}),n.d(t,"j",function(){return I}),n.d(t,"h",function(){return L})},Y0Lu:function(e,t,n){"use strict";var r,o=n("RIqP"),s=n.n(o),i=n("q1tI"),c=n("nLXU"),a=n("jeQL"),u=n("dtwz"),l=n("/1FC"),d=n("gSGL"),f=n("7EGn"),p=n("Bw5p"),_=n("lSNA"),E=n.n(_),h=n("QM+C"),m=(r={},E()(r,h.NUM_FILE_TYPE.DOC,[[c.p.FIND_REPLACE],[c.p.COPY],[c.p.TOGGLE_PIN],[c.p.TOGGLE_STAR],[c.p.PUBLISH_TO_WIKI],[c.p.DETAIL],[c.p.HISTORY_VIEW],[c.p.HISTORY],[c.p.TRANSLATE_BACK_ORIGIN],[c.p.TRANSLATE_TO],[c.p.TRANSLATE_SETTING],[c.p.MORE],[c.p.REPORT_ABUSE],[c.p.DELETE]]),E()(r,h.NUM_FILE_TYPE.WIKI,[[c.p.FIND_REPLACE],[c.p.COPY],[c.p.TOGGLE_PIN],[c.p.TOGGLE_STAR],[c.p.PUBLISH_TO_WIKI],[c.p.DETAIL],[c.p.HISTORY_VIEW],[c.p.HISTORY],[c.p.TRANSLATE_BACK_ORIGIN],[c.p.TRANSLATE_TO],[c.p.TRANSLATE_SETTING],[c.p.MORE],[c.p.REPORT_ABUSE],[c.p.DELETE]]),E()(r,h.NUM_FILE_TYPE.SHEET,[[c.p.FIND_REPLACE],[c.p.COPY],[c.p.TOGGLE_PIN],[c.p.TOGGLE_STAR],[c.p.PUBLISH_TO_WIKI],[c.p.DETAIL],[c.p.HISTORY_VIEW],[c.p.HISTORY],[c.p.TRANSLATE_BACK_ORIGIN],[c.p.TRANSLATE_TO],[c.p.TRANSLATE_SETTING],[c.p.MORE],[c.p.REPORT_ABUSE],[c.p.DELETE]]),r);n.d(t,"i",function(){return O}),n.d(t,"g",function(){return y}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return v}),n.d(t,"h",function(){return b}),n.d(t,"a",function(){return S}),n.d(t,"j",function(){return C}),n.d(t,"k",function(){return I}),n.d(t,"l",function(){return L}),n.d(t,"d",function(){return N}),n.d(t,"b",function(){return w}),n.d(t,"c",function(){return D});var O=function(e){if(Object(l.a)(e)){if(0===e.length)return!1;var t=e.find(function(e){return b(e)&&Object(l.a)(e.subMenuItemKeys)});return t&&b(t)?!0:!1}return!1},y=function(e){var t=Object(f.default)(e,"payload.type","");return t&&t===c.d.___LOADER___},g=function(e){return e&&e===c.d.___DIVIDER___},v=function(e){return e&&e===c.d.OPEN_IMPORT_CENTER},b=function(e){return e&&[e.type,e.key,e.actionType].some(function(e){return"string"==typeof e})},T=function(a,e){return e.reduce(function(e,t,n,r){if(Object(d.a)(t)){if(g(t))return e.concat({key:c.d.___DIVIDER___});var o=a[t];return o?e.concat(Object.assign({key:t},o)):e}if(Object(l.a)(t)){var i=Object(f.default)(t,["0"]);return!a[i]?e:[].concat(s()(e),[S(a,t)])}return e},[])},R=function o(e){return e.filter(function(e,t,n){if(Object(l.a)(e))return o(e);if(-1<t&&t<n.length-1){if(!e.key)return!0;var r=n[t+1];if(g(e.key)&&b(r)&&g(r.key))return!1}return!0}).filter(function(e,t,n){return 0!==t&&t!==n.length-1||(Object(l.a)(e)||b(e)&&!g(e.key))})};function S(e,t){return Object(u.a)([T,R])(e,t)}function C(e){return Object(a.a)(e,function(e){return!e.allowed&&(!e.predicate||!e.predicate())})}function I(t){return Object(a.a)(t,function(e){return!!Object(l.a)(e.subMenuItemKeys)&&e.subMenuItemKeys.every(function(e){return!t[e]})})}function L(e,t,n){return t?Object(p.a)(e,m[n]):e}var N=function(e){if(e){var t=e.split("|");return[c.d.CREATE,c.d.CREATE_SUITE,c.d.UPLOAD].some(function(e){return e===t[0]})}return!1};function w(e,t){return"string"==typeof e?i.createElement("div",{className:t.className,style:{display:"flex",alignItems:"center"}},i.createElement("img",{src:e})):i.createElement("div",{className:t.className},e&&i.createElement(e,null))}function D(e){return e.some(function(e){if(Object(l.a)(e)){if(!e.length)return!1;var t=e.find(function(e){return b(e)&&Object(l.a)(e.subMenuItemKeys)});return t&&b(t)?Boolean(t.icon):!1}return(!b(e)||!g(e.key))&&Boolean(e.icon)})}},YAKS:function(e,t,n){"use strict";e.exports=n("pGAK")},YsLn:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"h",function(){return l}),n.d(t,"l",function(){return d}),n.d(t,"k",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"g",function(){return _}),n.d(t,"j",function(){return E}),n.d(t,"f",function(){return h}),n.d(t,"m",function(){return m});var r=n("S9xK"),o=n("jp/M"),i=function(){return{type:o.actionTypes.box.EMIT_UPDATE_STORAGE_USAGES}},a=function(e){return{type:r.a.SET_CURRENT_FOLDER_IMAGE_LIST_INFO,payload:e}},s=function(){return{type:r.a.RESET_CURRENT_FOLDER_IMAGE_LIST_INFO}},c=function(e){return{type:o.actionTypes.box.SET_PREVIEW_SDK_DOWNLOAD,payload:e}},u=function(e){return{type:o.actionTypes.box.SET_FILE_FIND,payload:e}},l=function(e){return{type:o.actionTypes.box.SET_PDF_PRINT,payload:e}},d=function(){return{type:o.actionTypes.box.UPDATE_VERSION_SEED}},f=function(e,t){return{type:o.actionTypes.box.FILE_NAME_UPDATED,payload:{fileName:e,version:t}}},p=function(e){return{type:o.actionTypes.box.SET_IFRAME_LAYER_SHOW,payload:e}},_=function(e){return{type:r.a.SET_BOX_SUITE_IS_IN_EDIT_MODE,payload:e}},E=function(){return{type:o.actionTypes.box.TOGGLE_FILE_INFO_PANEL}},h=function(e){return{type:r.a.SET_IS_FILE_DRAGGING,payload:e}},m=function(e){var t=e.token,n=e.isFolder,r=e.parentToken;return{type:o.actionTypes.box.UPLOAD_SUCCESS,payload:{token:t,isFolder:n,parentToken:r}}}},Ysvc:function(e,t,n){"use strict";var r=n("7EGn"),o=n("iP/4"),i=function(o){var i,a=this;return function(){if(i)return i;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=o.apply(a,t);return i=r}};function a(){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split("."),n=e.split("."),r=Math.max(t.length,n.length),o=0;o<r;o++){var i=t[o],a=n[o];if(!a)return!0;if(!i)return!1;var s=Number(i),c=Number(a);if(s<c)return!1;if(c<s)return!0}return!0}function s(e,t){var n;o.a.isDocsSDK?o.a.android?n=e[0]:o.a.ios&&(n=e[1]):o.a.android?n=t[0]:o.a.ios&&(n=t[1]);var r=l();return!!n&&a(r,n)}n.d(t,"a",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"f",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"c",function(){return _}),n.d(t,"b",function(){return h});var c=i(function(){var e=window.navigator.userAgent;return Object(r.default)(e.match(/DocsSDK\/([0-9.]+)/i),"[1]")}),u=(i(function(){var e=c();return!!(e&&o.a.isLark&&(o.a.ios&&a(e,"1.3")||!o.a.ios&&a(e,"1.1.0")))}),i(function(){var e=c();return!!(e&&o.a.ios&&a(e,"1.7.0"))}));function l(){if(o.a.isDocsSDK)return c();var e=navigator.userAgent||"";return Object(r.default)(e.match(/Docs[^SDK/]*\/([0-9.]+)/),"[1]")}function d(){var e=l(),t="",t=o.a.isDocsSDK?o.a.android?"1.2.3":"1.8.2":"0.2.5";return(!o.a.isIOS||E())&&a(e,t)}function f(){var e=l(),t="";return!o.a.isDocsSDK||o.a.android?t="0.2.4":o.a.ios&&(t="1.8.0"),a(e,t)}function p(){return s(["1.12.99","1.9.1"],["0.2.7","0.2.7"])}function _(){if(o.a.isDocs){if(o.a.ios)return!0;var e=o.a.isDocsSDK?"1.12.99":"0.2.7";return a(l(),e)}return!1}function E(){return-1<location.protocol.indexOf("docsource")}function h(){return s(["1.15.99","1.9.4"],["0.3.0","0.3.0"])}s(["1.15.99","1.9.4"],["0.3.0","0.3.0"])},"Z/fP":function(e,s,c){"use strict";(function(t){c.d(s,"a",function(){return a});var e=c("lwsE"),n=c.n(e),r=c("W8MJ"),o=c.n(r),i=c("6IgM"),a=new(function(){function e(){n()(this,e),this._mobileEditor=null,this._ttI18NMap={},"undefined"!=typeof window&&"function"==typeof t&&(this._ttI18NMap={"sheet.spread.pass_instance_tips":t("sheet.spread.pass_instance_tips"),"sheet.spread.target_not_exit_tips":t("sheet.spread.target_not_exit_tips"),"sheet.copy_item":t("sheet.copy_item"),"sheet.pasting":t("sheet.pasting"),"sheet.fail_to_paste":t("sheet.fail_to_paste"),"sheet.conflict":t("sheet.conflict"),"sheet.cell_limit_exceed":t("sheet.cell_limit_exceed"),"common.unnamed_document":t("common.unnamed_document"),"common.unnamed_sheet":t("common.unnamed_sheet"),"sheet.invalid_link":t("sheet.invalid_link"),"sheet.overlapping_spans":t("sheet.overlapping_spans"),"sheet.paste_merges_over_filtered_rows":t("sheet.paste_merges_over_filtered_rows"),"sheet.protection.sync_permission_fail":t("sheet.protection.sync_permission_fail"),"sheet.conventional":t("sheet.conventional"),"sheet.plain_text":t("sheet.plain_text"),"sheet.digital":t("sheet.digital"),"sheet.digital_point":t("sheet.digital_point"),"sheet.digital_without_separator":t("sheet.digital_without_separator"),"sheet.percent":t("sheet.percent"),"sheet.percent_point":t("sheet.percent_point"),"sheet.scientific_count":t("sheet.scientific_count"),"sheet.currency_dollar_rounded":t("sheet.currency_dollar_rounded"),"sheet.currency_dollar":t("sheet.currency_dollar"),"sheet.date":t("sheet.date"),"sheet.time":t("sheet.time"),"sheet.data_time":t("sheet.data_time"),"sheet.format_code.date_with_slash":t("sheet.format_code.date_with_slash"),"sheet.format_text.date_with_slash":t("sheet.format_text.date_with_slash"),"sheet.format_code.date_with_hyphen":t("sheet.format_code.date_with_hyphen"),"sheet.format_text.date_with_hyphen":t("sheet.format_text.date_with_hyphen"),"sheet.format_code.date_time":t("sheet.format_code.date_time"),"sheet.format_text.date_time":t("sheet.format_text.date_time"),"sheet.currency_cny_rounded":t("sheet.currency_cny_rounded"),"sheet.currency_cny":t("sheet.currency_cny"),"sheet.copy_with_hidden_rows":t("sheet.copy_with_hidden_rows"),"sheet.copy_with_hidden_cols":t("sheet.copy_with_hidden_cols"),"sheet.copy_with_hidden_rows&cols":t("sheet.copy_with_hidden_rows&cols"),"sheet.error.drag_from_part_spans":t("sheet.error.drag_from_part_spans"),"sheet.error.drag_to_part_spans":t("sheet.error.drag_to_part_spans"),"sheet.error.drag_with_filter":t("sheet.error.drag_with_filter"),"sheet.error.drag_to_protected":t("sheet.error.drag_to_protected"),"sheet.error.drag_contain_protected":t("sheet.error.drag_contain_protected"),"sheet.fill_no_merge":t("sheet.fill_no_merge"),"sheet.reminder.day_of_event":t("smartable.reminder.day_of_event"),"sheet.reminder.1_day_before":t("smartable.reminder.1_day_before"),"sheet.reminder.2_day_before":t("smartable.reminder.2_day_before"),"sheet.reminder.1_week_before":t("smartable.reminder.1_week_before"),"sheet.reminder.at_time_of_event":t("smartable.reminder.at_time_of_event"),"sheet.reminder.remind_before_5_mins":t("smartable.reminder.remind_before_min",5),"sheet.reminder.remind_before_15_mins":t("smartable.reminder.remind_before_min",15),"sheet.reminder.remind_before_30_mins":t("smartable.reminder.remind_before_min",30),"sheet.reminder.remind_before_1_hour":t("smartable.reminder.1_hour_before"),"sheet.reminder.remind_before_2_hours":t("smartable.reminder.remind_before_hour",2),"sheet.reminder.popover.beforeOneDay":t("reminder.popover.beforeDay",1),"sheet.reminder.popover.beforeTwoDay":t("reminder.popover.beforeDay",2),"sheet.reminder.popover.beforeOneWeek":t("reminder.popover.beforeWeek",1),"common.edit":t("common.edit"),"common.copy":t("common.copy"),"common.delete":t("common.delete"),"common.cut":t("common.cut"),"sheet.chart.nodata":t("sheet.chart.nodata"),"header.please_enter_title":t("header.please_enter_title"),"sheet.chart_download_img":t("sheet.chart_download_img"),"sheet.chart_download_fail":t("sheet.chart_download_fail"),"common.reactivate_tab_apply_data":t("common.reactivate_tab_apply_data"),"sheet.new_commen_deleted.toast":t("sheet.new_commen_deleted.toast"),sheet_more_date_time:t("sheet_more_date_time"),"sheet.chart_loading":t("sheet.chart_loading"),"sheets.filter_view.view_only_temporary":t("sheets.filter_view.view_only_temporary"),"sheets.filter_view.hover_create_new":t("sheets.filter_view.hover_create_new"),"mobile.sheet.view_image":t("mobile.sheet.view_image"),"common.download_file":t("common.download_file"),"sheet.resize_value_tip":t("CreationDoc_Sheets_Hyperlink_HeightHoverTooltip")})}return o()(e,[{key:"t",value:function(e){return this._ttI18NMap[e]}},{key:"moirae",get:function(){return this._moirae||i.o},set:function(e){this._moirae=e}},{key:"collectSuiteEvent",get:function(){return this._collectSuiteEvent||i.c},set:function(e){this._collectSuiteEvent=e}},{key:"collectToAdmin",get:function(){return this._collectToAdmin||i.d},set:function(e){this._collectToAdmin=e}},{key:"transformPerformanceData",get:function(){return this._transformPerformanceData||i.t},set:function(e){this._transformPerformanceData=e}},{key:"encryptTea",get:function(){return this._encryptTea||i.e},set:function(e){this._encryptTea=e}},{key:"getFileType",get:function(){return this._getFileType||i.j},set:function(e){this._getFileType=e}},{key:"prependSpace",get:function(){return this._prependSpace||i.q},set:function(e){this._prependSpace=e}},{key:"beforeCopy",get:function(){return this._beforeCopy||i.a},set:function(e){this._beforeCopy=e}},{key:"EditorManager",get:function(){return this._EditorManager},set:function(e){this._EditorManager=e}},{key:"isLarkProduct",get:function(){return this._isLarkProduct||i.u},set:function(e){this._isLarkProduct=e}},{key:"diyIconEnable",get:function(){return this._diyIconEnable||!1},set:function(e){this._diyIconEnable=e}},{key:"syncbufferEnable",get:function(){return this._syncbufferEnable||!1},set:function(e){this._syncbufferEnable=e}},{key:"replaceImageDataSrc",get:function(){return this._replaceImageDataSrc||i.r},set:function(e){this._replaceImageDataSrc=e}},{key:"getSegmentArray",get:function(){return this._getSegmentArray||i.k},set:function(e){this._getSegmentArray=e}},{key:"getCustomIconUrl",get:function(){return this._getCustomIconUrl||i.i},set:function(e){this._getCustomIconUrl=e}},{key:"generateEditorValue",get:function(){return this._generateEditorValue||i.f},set:function(e){this._generateEditorValue=e}},{key:"Toast",get:function(){return this._Toast||i.s},set:function(e){this._Toast=e}},{key:"modalHelper",get:function(){return this._modalHelper||i.n},set:function(e){this._modalHelper=e}},{key:"mobileEditor",get:function(){return this._mobileEditor},set:function(e){this._mobileEditor=e}},{key:"imageHelper",get:function(){return this._imageHelper||{getDriveImageUrl:function(){return console.error("No imageHelper Instance"),""},getDriveOriginalImageUrl:function(){return console.error("No imageHelper Instance"),""},getDriveImageToken:function(){return console.error("No imageHelper Instance"),""},decodeInfo:function(){console.error("No imageHelper Instance")},encodeInfo:function(){return console.error("No imageHelper Instance"),""},copyDriveImages:function(){return new Promise(function(e){console.error("No imageHelper Instance"),e([])})},collectImageError:function(){console.error("No collectImageError Instance")},copyDriveImageForSheet:function(){return new Promise(function(e){console.error("No imageHelper Instance"),e({})})}}},set:function(e){this._imageHelper=e}},{key:"freezeSheetToggle",get:function(){return this._freezeSheetToggle},set:function(e){this._freezeSheetToggle=e}},{key:"checkCopyAuthority",get:function(){return this._checkCopyAuthority},set:function(e){this._checkCopyAuthority=e}},{key:"checkExportAuthority",get:function(){return this._checkExportAuthority},set:function(e){this._checkExportAuthority=e}},{key:"logHelper",get:function(){return this._logHelper},set:function(e){this._logHelper=e}},{key:"collectLoadPerformance",get:function(){return this._collectLoadPerformance||i.b},set:function(e){this._collectLoadPerformance=e}},{key:"getCustomIconFG",get:function(){return this._getCustomIconFG||i.h},set:function(e){this._getCustomIconFG=e}},{key:"isAnonymousAccess",get:function(){return this._isAnonymousAccess},set:function(e){this._isAnonymousAccess=e}},{key:"isSheetGarrEnable",get:function(){return this._isSheetGarrEnable},set:function(e){this._isSheetGarrEnable=e}},{key:"getSuiteMember",get:function(){return this._getSuiteMember},set:function(e){this._getSuiteMember=e}},{key:"performanceStageCollector",get:function(){return this._performanceStageCollector||i.p},set:function(e){this._performanceStageCollector=e}},{key:"sheetRenderStage",get:function(){return this._sheetRenderStage||{}},set:function(e){this._sheetRenderStage=e}},{key:"getLanguage",get:function(){return this._getLanguage},set:function(e){this._getLanguage=e}},{key:"getSheetCellLimitNum",get:function(){return this._getSheetCellLimitNum||i.g},set:function(e){this._getSheetCellLimitNum=e}},{key:"getSheetCopyDataVersion",get:function(){return this._getSheetCopyDataVersion||i.l},set:function(e){this._getSheetCopyDataVersion=e}},{key:"getSheetDropdown2DataValidationEnable",get:function(){return this._getSheetDropdown2DataValidationEnable||i.m},set:function(e){this._getSheetDropdown2DataValidationEnable=e}},{key:"browser",set:function(e){this._browser=e},get:function(){return this._browser}}]),e}())}).call(this,c("2vAP"))},ZZQp:function(e,t,n){var r=n("bpon"),o=n("39uu"),i=n("eOcF"),a=n("QYBB").f,s=n("PoCt"),c=n("Qub4"),u=s("meta"),l=0,d=Object.isExtensible||function(){return!0},f=function(e){a(e,u,{value:{objectID:"O"+ ++l,weakData:{}}})},p=function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,u)){if(!d(e))return"F";if(!t)return"E";f(e)}return e[u].objectID},_=function(e,t){if(!i(e,u)){if(!d(e))return!0;if(!t)return!1;f(e)}return e[u].weakData},E=function(e){return c&&h.REQUIRED&&d(e)&&!i(e,u)&&f(e),e},h=e.exports={REQUIRED:!1,fastKey:p,getWeakData:_,onFreeze:E};r[u]=!0},ZbhI:function(e,t,n){e.exports=n("J6x8")},b4mI:function(e,t){},bPB8:function(e,t,n){"use strict";function r(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var i=e[t];i&&(o[r++]=i)}return o}t.a=r},bZiw:function(e,t,n){"use strict";var r,o,i,a,s,c;n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s}),(o=r=r||{})[o.Normal=1]="Normal",o[o.High=2]="High",(a=i=i||{}).Idle="idle",a.Pending="pending",a.Done="done",(c=s=s||{}).onDemand="onDemand",c.runInBackground="runInBackground"},dP4c:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return d}),n.d(t,"d",function(){return p});var r=n("hMnB"),o=n.n(r),i=n("iP/4"),a=n("ucr6"),s=n("QM+C"),c=n("Ysvc");function u(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];!i.a.isLark&&t?window.open(e):Object(c.a)()||n?o.a.href=e:a.a.push(e)}function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=new RegExp(s.LENGTH_LIMITED_EMAIL_REG).test(e);return/^https?:|^mailto:|^ftp:/.test(e)?e:t?"mailto:"+e:(e.startsWith("http")||(e="http://"+e),e)}function d(){return/^data:/.test(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")}var f="docs-open-link-iframe";function p(e){var t=document.querySelector("iframe#".concat(f));return t||((t=document.createElement("iframe")).id=f,t.style.display="none",document.body.appendChild(t)),t.src=e,t}},dYgn:function(e,n,r){"use strict";(function(c){r.d(n,"a",function(){return t});var e=r("o0o1"),u=r.n(e),l=r("jJw9"),d=r("EVj1"),f=r("QM+C"),p=r("wH0k"),_=r("aR0j"),E=r("oZtI"),h=r("n/R6"),m=u.a.mark(t);function t(e){var t,n,r,o,i,a,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.select)(_.qb);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=t.type,r=t.obj_token,o=t.token,i=t.url,a=Object(l.processPathUrl)({objToken:r,token:o,type:n,url:i}),n===f.NUM_FILE_TYPE.ISV&&(a=i),s=Object(d.e)(a),p.a.setDataWithoutEvent({text:s}),h.a.success({content:c("common.copied"),duration:3e3,closable:!1});case 11:case"end":return e.stop()}},m)}}).call(this,r("2vAP"))},djbN:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"h",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"f",function(){return p});var r=n("USG6"),o=n("6SzI"),i=Object(o.createAction)(r.FREEZE_SPREAD_TOGGLE),a=function(e){var t=e.isExport,n=e.fileType;return{type:r.EXPORT_FILE,payload:{isExport:t,fileType:n}}},s=function(){return{type:r.TOGGLE_HISTORY}},c=function(e){return{type:r.TOGGLE_TITLE_FOCUS_STATUS,payload:{isFocus:e}}},u=function(e){return{type:r.CONTENT_VISIBLE,payload:e}},l=Object(o.createAction)(r.HIDE_DROPDOWN_MENU),d=function(){return{type:r.HIDE_HYPER_LINK_EDITOR}},f=Object(o.createAction)(r.HIDE_FILTER_MENU),p=function(e){return{type:r.SET_EMBED_SHEET_ALLOW_COMMENT,payload:e}}},dmt9:function(e,t,n){"use strict";var u=n("QYBB").f,l=n("SJYm"),d=n("Cupc"),f=n("GUr9"),p=n("X32N"),_=n("W1ep"),a=n("QFZC"),s=n("04M5"),E=n("wbIY"),h=n("ZZQp").fastKey,r=n("L1rz"),m=r.set,O=r.getterFor;e.exports={getConstructor:function(e,n,r,o){var i=e(function(e,t){p(e,i,n),m(e,{type:n,index:l(null),first:void 0,last:void 0,size:0}),E||(e.size=0),null!=t&&_(t,e[o],e,r)}),s=O(n),a=function(e,t,n){var r,o,i=s(e),a=c(e,t);return a?a.value=n:(i.last=a={index:o=h(t,!0),key:t,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=a),r&&(r.next=a),E?i.size++:e.size++,"F"!==o&&(i.index[o]=a)),e},c=function(e,t){var n,r=s(e),o=h(t);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==t)return n};return d(i.prototype,{clear:function(){for(var e=this,t=s(e),n=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete n[r.index],r=r.next;t.first=t.last=void 0,E?t.size=0:e.size=0},delete:function(e){var t,n,r=this,o=s(r),i=c(r,e);return i&&(t=i.next,n=i.previous,delete o.index[i.index],i.removed=!0,n&&(n.next=t),t&&(t.previous=n),o.first==i&&(o.first=t),o.last==i&&(o.last=n),E?o.size--:r.size--),!!i},forEach:function(e){for(var t,n=s(this),r=f(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),d(i.prototype,r?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),E&&u(i.prototype,"size",{get:function(){return s(this).size}}),i},setStrong:function(e,t,n){var r=t+" Iterator",o=O(t),i=O(r);a(e,t,function(e,t){m(this,{type:r,target:e,state:o(e),kind:t,last:void 0})},function(){for(var e=i(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:e.target=void 0,done:!0}},n?"entries":"values",!n,!0),s(t)}}},dvZ7:function(e,t,n){"use strict";var y=n("7EGn"),i=n("BmhO"),a=n("TtEC"),r=n("WzBf");function o(e){return{token:"DRIVE_PREVIEW_EVENT_".concat(e),resourceType:"DRIVE_PREVIEW_EVENT",routeType:"local",routeKey:""}}function s(e,t){var n=o(e);r.a.register(n,t),r.a.onError(n,function(e){console.error("[MessageBoxError]:",e)})}function c(e,t){var n=o(e);r.a.deregister(n,t)}var u={register:s,deregister:c},g=n("Xngx"),l=n("rLED"),d=n("vE74"),f=n("QM+C"),p=n("iP/4"),v=n("skFV"),_=n("f8Ac"),b=n("5dbN"),E=n("omim"),h=n("EVj1"),m=n("VI6H"),O=n("EQyw"),T=n("erPj"),R=n("wCm6"),S=n("zaV1"),C=n("2ACu"),I=n("lgTS"),L=n("ucr6"),N=n("1dfU");function w(e){var t=e.file,n=e.files;if(!t||t instanceof I.e)return null;var r=t.get("type"),o=(t.get("subtype")||"").toLowerCase();return r===f.NUM_SUITE_TYPE.FILE&&i.u.includes(o)?n.filter(function(e){var t=e.get("type"),n=(e.get("subtype")||"").toLowerCase();return e instanceof I.f&&t===f.NUM_SUITE_TYPE.FILE&&i.u.includes(n)}).map(function(e){return e.get("obj_token")}):null}function D(e){var t=f.mapTypeToSuite[Object(g.d)(e).toLowerCase()]||"";return f.NUM_SUITE_TYPE[t.toUpperCase()]}function k(e){var t=e.action,n=void 0===t?"":t,r=e.fileToken,o=void 0===r?"":r,i=e.fileName,a=void 0===i?"":i,s=e.status,c=void 0===s?"success":s,u=e.subConfirmType,l=void 0===u?"":u,d=e.source,f=void 0===d?"":d,p=e.isCrossTenant,_=e.dummyToken,E=Object(g.d)(a),h=Object(b.getCurrentRouteObj)(),m=h&&h.module?h.module:"",O=h&&h.subModule?h.subModule:"";Object(C.default)("client_content_management",{action:n,source:f,sub_file_type:E,file_id:o?Object(N.a)(o):"",dummy_token:_&&Object(N.a)(_),module:m,sub_module:O,status_name:c,sub_confirm_type:l,file_is_cross_tenant:p,api_host:v.d,location_country:Object(y.default)(window,"User.locationCountry")})}function P(e){var t=e.action,n=void 0===t?"":t,r=e.status,o=void 0===r?"success":r,i=e.subConfirmType,a=void 0===i?"":i,s=e.source,c=void 0===s?"":s,u=e.isCrossTenant,l=Object(b.getCurrentRouteObj)(),d=l&&l.module?l.module:"",f=l&&l.subModule?l.subModule:"";Object(C.default)("client_content_management",{action:n,source:c,file_type:"folder",sub_file_type:"",file_id:"",module:d,sub_module:f,status_name:o,sub_confirm_type:a,file_is_cross_tenant:u||void 0,api_host:v.d,location_country:Object(y.default)(window,"User.locationCountry")})}function F(e){var t,n=e.action,r=void 0===n?"":n,o=e.source,i=void 0===o?"direct":o,a=e.eventType,s=void 0===a?"mouseclick":a,c=e.commentId,u=void 0===c?"":c,l=e.replyId,d=void 0===l?"":l,f=e.statusCode,p=void 0===f?0:f,_=e.statusName,E=void 0===_?"success":_,h=e.commentType,m=void 0===h?"full_comment":h,O=Object(S.a)();O&&O.type&&(t=O.type,Object(C.default)("client_comment",{action:r,eventType:s,source:i,comment_type:m,comment_id:u,reply_id:d,comment_target_type:"whole_file",zone:"full_comment",mode:"drive_view",status_code:p,status_name:E,sub_file_type:t||""}))}function x(e){var t=e.action,n=void 0===t?"":t,r=e.source,o=void 0===r?"":r,i=e.eventType,a=void 0===i?"mouseclick":i,s=e.subFileType,c=Object(S.a)(),u=s||c&&c.type||"";Object(C.default)("toggle_attribute",{product_type:"drive",eventType:a,sub_file_type:u,mode:"drive_view",action:n,source:o})}function M(e){var t=e.source,n=e.action,r=e.subFileType,o=e.fileToken,i=Object(b.getCurrentRouteObj)(),a=i&&i.module?i.module:"";Object(C.default)("office_online_edit",{source:t,action:n,module:a,file_type:"file",sub_file_type:r,file_id:o?Object(N.a)(o):""})}function j(e){var t=e.costTime,n=e.fileToken,r=e.stage;Object(C.default)("dev_box_load_performance",{stage:r,file_id:n?Object(N.a)(n):"",cost_time:t})}function U(){window.dispatchEvent(Object(d.b)("resize"))}n.d(t,"i",function(){return w}),n.d(t,"k",function(){return D}),n.d(t,"b",function(){return k}),n.d(t,"d",function(){return P}),n.d(t,"a",function(){return F}),n.d(t,"f",function(){return x}),n.d(t,"e",function(){return M}),n.d(t,"c",function(){return j}),n.d(t,"p",function(){return U}),n.d(t,"h",function(){return H}),n.d(t,"j",function(){return K}),n.d(t,"g",function(){return q}),n.d(t,"m",function(){return X}),n.d(t,"l",function(){return J}),n.d(t,"o",function(){return Q}),n.d(t,"n",function(){return Z});var B={isOnlineEnv:!(Object(v.D)()||Object(v.z)()),apiHosts:Object(v.r)(),driveApiHosts:Object(v.i)(),fileUrlPrefix:Object(v.k)().fileURLPrefix||"",isLocalhost:Object(v.z)(),fileWebOfficeDomain:Object(v.k)().fileWebOfficeDomain||"",updatePreviewTplSeed:Object(v.k)().updatePreviewTplSeed},V=Object(v.g)().tea;function H(e){var t=Object(m.c)(),r=[],n=p.a.isInVC;n&&r.push(i.n.SHEET),(n||f.isAnonymousAccess||p.a.isFeed||!e)&&r.push(i.n.WPS);var o=function(e){var t=r.slice(),n=X(e);return n.edit||n.preview||t.push(i.n.WPS),t};return{customRequest:R.a,PreviewMessageHandler:u,envConfig:B,seclinkEnabled:a.j,languageType:Object(_.a)(),userId:t.get("id")||window.User.id,tenantId:t.get("tenant_id")||window.User.tenantId,showDownloadProgress:E.g,enablePDFProgressCache:!0,enableSheetProgressCache:!0,enableMediaProgressCache:!0,getDisabledPreviewComponents:o,maxPollCount:Object(a.f)(),pdfRangeChunkSize:Object(a.g)(),showPDFDigitalSign:!0,unsupportedVideoCodec:Object(a.h)(),authority:{downloadable:Object(T.c)(),printable:Object(T.e)(),exportable:Object(T.d)(),copyable:Object(T.b)()},floatingToolbarHiddenOnStart:p.a.isInVC}}V&&!0===V.open&&(B.teaConfig={sdkAppId:Object(y.default)(V,"config.appId.drive_sdk"),suiteAppId:Object(y.default)(V,"config.appId.doc"),singleProductAppID:Object(y.default)(V,"config.appId.single_product"),channelDomain:Object(y.default)(V,"config.channel_domain")}),B.slardarConfig={slardarCommonConfig:Object(v.g)().slardar,slardarMinaConfig:Object(l.L)("slardar_config"),sentryConfig:Object(v.g)().sentry,sentryMinaConfig:Object(l.L)("sentry_filter_config"),scm:Object(y.default)(window,"scm"),rvRev:Object(y.default)(window,"rv_rev")};var W=["pdf","csv"];function Y(e){return!W.includes(e)&&i.l.includes(e)}function K(e){return Boolean(e&&e.weboffice)}function z(e){var t=Object(g.d)(e);return Object(a.a)()&&i.H.includes(t)}function q(e){return Object(a.d)()&&Y(Object(g.d)(e))||z(e)}function X(e){if(!e)return{preview:!1,edit:!1};var t=K(e);return z(e.name)?{preview:t,edit:t}:{preview:Boolean(t&&Object(a.e)()),edit:Boolean(t&&Object(a.d)()&&!W.includes(Object(g.d)(e.name)))}}function J(e,t){var n=X(e);return t?n.edit:n.preview}function Q(e){var t=Object(h.l)(L.a.location.search)||{};e?t.office_edit="1":delete t.office_edit,L.a.replace({search:Object(h.d)(t)})}function Z(e){return e&&!Object(O.a)()}},eHo2:function(e,t,n){"use strict";var s=Math.ceil,c=Math.max;function r(e,t,n,r){for(var o=-1,i=c(s((t-e)/(n||1)),0),a=Array(i);i--;)a[r?i:++o]=e,e+=n;return a}var o=r,i=n("XFn8"),a=n("ywm8");function u(r){return function(e,t,n){return n&&"number"!=typeof n&&Object(i.a)(e,t,n)&&(t=n=void 0),e=Object(a.a)(e),void 0===t?(t=e,e=0):t=Object(a.a)(t),n=void 0===n?e<t?1:-1:Object(a.a)(n),o(e,t,n,r)}}t.a=u},erPj:function(e,t,n){"use strict";n.d(t,"f",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"e",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u});var r=n("kS6I");function o(){return Object(r.d)(r.b.FILE_UPLOAD)!==r.a.DENY}function i(){return Object(r.d)(r.b.FILE_DOWNLOAD)!==r.a.DENY}function a(){return Object(r.d)(r.b.FILE_COPY)!==r.a.DENY}function s(){return Object(r.d)(r.b.FILE_PRINT)!==r.a.DENY}function c(){return Object(r.d)(r.b.FILE_EXPORT)!==r.a.DENY}function u(){return Object(r.d)(r.b.FILE_COPY)!==r.a.DENY}},fLNQ:function(e,t,n){"use strict";n.d(t,"a",function(){return E});var r,o,i,a=n("puQj"),s=n.n(a),c=n("m3ds"),u="undefined"!=typeof window&&window.User&&window.User.userAgent||navigator.userAgent||"",l=Object.assign({},s.a.detect(u),{isFeishu:!1,isLark:!1,isLarkPcTab:!1,isDocs:!1,isDocsSDK:!1,isFeed:!1,isIphoneX:!1,isIPad:!1,isMobile:!1,isMac:!1,isSafari:!1,isIE:!1,isSougou:!1,isIOS:!1,isAndroid:!1,isQQ:!1,isX5:!1,is360:!1,is360Fast:!1,isUc:!1,isBaiDu:!1,isLB:!1,oldIE:!1,modernIE:!1,kernel:"",isLarkTab:!1,isOldLarkTab:!1,isEdge:!1,isFF:!1,isChrome:!1,isWebKit:!1,isBytedanceApp:!1,isIPhoneSeries:function(){return!1},isPrimaryChrome:!1,isOpera:!1,is2345:!1,isMaxthon:!1,isTheWorld:!1});l.isFeishu=/feishu/i.test(u),l.isLark=l.isFeishu||/lark/i.test(u),l.isLarkPcTab=l.isLark&&/TYPE\/PC_TAB/i.test(u),l.isDocs=/Docs/i.test(u),l.isDocsSDK=l.isLark&&l.isDocs,l.isFeed=/Feed/i.test(u)||/lark=1/.test(location.search)||/sourceType=feed/.test(location.search),l.isIphoneX=p(),l.isIPad=c.a.isIPad,l.isMobile=l.mobile||c.a.isIPad,l.isMac=l.mac,l.isSafari=c.a.isSafari,l.isIE=l.msie||l.msedge,l.isSougou=/MetaSr/i.test(u),l.isIOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),l.isAndroid=-1<u.indexOf("Android")||-1<u.indexOf("Adr"),l.isQQ=/QQBrowser/i.test(u),l.isX5=/MQQBrowser/i.test(u),l.is360=/360SE/i.test(u),l.is360Fast=/360EE/i.test(u),l.isUc=/UBrowser/i.test(u),l.isBaiDu=/BIDUBrowser/i.test(u),l.is2345=/2345Explorer/i.test(u),l.isMaxthon=/Maxthon/i.test(u),l.isTheWorld=/TheWorld/i.test(u),l.isLB=/LBBROWSER/i.test(u),l.isEdge=/Edge/i.test(u),l.isFF=/Firefox/i.test(u),l.isOpera=/OPR/i.test(u),l.isWebKit=/AppleWebKit/i.test(u),l.isChrome="chrome"===l.name.toLocaleLowerCase(),l.isPrimaryChrome=l.isChrome&&!l.isOpera&&!l.isLB&&!l.isUc&&!l.isBaiDu&&!l.is360&&!l.is360Fast&&!l.isQQ&&!l.isSougou&&!l.isEdge&&!l.is2345&&!l.isTheWorld&&!l.isMaxthon,l.msie&&(r=parseInt(String(l.version),10),l.oldIE=r<11,l.modernIE=11<=r),l.isSougou&&(l.name="sougou",o=/SE (\w*.\w*)\s/.exec(u),l.version=o&&o[1]||l.version),l.isQQ&&(l.name="qq",i=u.replace(/^.*QQBrowser\/([\d.]+).*$/,"$1"),l.version=String(parseFloat(i))),l.is360&&(l.name="360"),l.is360Fast&&(l.name="360fast"),l.isLB&&(l.name="liebao"),l.isUc&&(l.name="uc"),l.isBaiDu&&(l.name="baidu");var d=["msie","webkit","blink","gecko","msedge","tablet","mobile"];l.kernel=d.find(function(e){return l[e]}),l.isLarkTab=/from\/(old_)?lark_tab/i.test(u),l.isOldLarkTab=/from\/old_lark_tab/i.test(u);var f=l.isLark||l.isDocs;function p(){return _("X")}function _(e){var t=new RegExp("(iPhone\\s".concat(e,")"));return!!navigator.userAgent.match(t)}l.isBytedanceApp=f,l.isIPhoneSeries=_;var E=l},fRsX:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"f",function(){return l});var r,o,i=n("rLED");(o=r=r||{}).TOP_BOTTOM="v1",o.LEFT_RIGHT="v2";var a=function(){var e=r.LEFT_RIGHT;return Object(i.L)("doc_template_v3_layout")||e},s=Object(i.K)("doc_template_v3_custom_enabled"),c=Object(i.I)("doc_template_v3_mindnote_enabled"),u=Object(i.I)("doc_template_v3_from_v2"),l=Object(i.K)("doc_template_v3_corporate_enabled");a(),r.LEFT_RIGHT},fV25:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n("cDf5"),o=n.n(r),i=n("eq4C"),a=n("fLNQ"),s="object"===("undefined"==typeof window?"undefined":o()(window))&&"object"===o()(window.User)&&"ja"===(window.User.language||navigator.language),c="object"===("undefined"==typeof window?"undefined":o()(window))&&"object"===o()(window.User)&&"zh"===(window.User.language||navigator.language);function u(){return c?i.d.ChineseFont:s?i.d.JapaneseFont:i.d.EnglishFont}function l(){var e=u();return a.a.isSafari?e.replace(/^LarkEmojiFont, /,""):e}var d,f,p,_,E,h,m=l().replace(/\"/g,"").replace(/, /g,",");(f=d=d||{})[f.BTN_SIZE=34]="BTN_SIZE",(_=p=p||{}).ABORT="ABORT",_.COMPLETE="COMPLETE",_.TRANSFER="TRANSFER",(h=E=E||{}).MOVE="MOVE",h.CLONE="CLONE",h.COPY="COPY",h.SHARE="SHARE",h.RENAME="RENAME",h.CREATE_FOLDER="CREATE_FOLDER",h.CREATE_SHARE_FOLDER="CREATE_SHARE_FOLDER",h.EDIT_SHARE_FOLDER_INFO="EDIT_SHARE_FOLDER_INFO",h.DELETE_OR_REMOVE="DELETE_OR_REMOVE",h.MOVE_TO_PERSONAL_FOLDER="MOVE_TO_PERSONAL_FOLDER",h.MOVE_TO_SHARE_FOLDER="MOVE_TO_SHARE_FOLDER",h.DELETE="DELETE";Object.values(E);var O,y,g={TOGGLE_PIN:"TOGGLE_PIN",TOGGLE_STAR:"TOGGLE_STAR"},v=(Object.values(g),Object.assign({NEWTABOPEN:"NEWTABOPEN",OPEN_NEW_TAB:"OPEN_NEW_TAB",COPY:"COPY",SHARE:"SHARE",MOVE:"MOVE",DELETE_OR_REMOVE:"DELETE_OR_REMOVE",RESTORE:"RESTORE",DELETE:"DELETE",REMOVE:"REMOVE"},g)),b={CLONE:"CLONE",PRINT:"PRINT",EXPORT:"EXPORT",EXPORT_CSV:"EXPORT_CSV",HISTORY:"HISTORY",COMMENT_HISTORY:"COMMENT_HISTORY",ABOUT_US:"ABOUT_US"},T={RENAME:"RENAME"},R={CREATE:"CREATE",IMPORT:"IMPORT"};Object.assign({},v,{},b,{},T,{},R);(y=O=O||{}).EXPLORER_GLOBAL_CONTEXT="EXPLORER_GLOBAL_CONTEXT",y.EXPLORER_FILE_DROPDOWN="EXPLORER_FILE_DROPDOWN",y.EXPLORER_FILE_CONTEXT="EXPLORER_FILE_CONTEXT",y.EXPLORER_CREATE_DROPDOWN="EXPLORER_CREATE_DROPDOWN",y.NAVIGATION_BAR_DROPDOWN="NAVIGATION_BAR_DROPDOWN",y.MULTI_SELECT_OPERATION_PANEL="MULTI_SELECT_OPERATION_PANEL";var S,C;(C=S=S||{}).FILELIST_ITEM_STAR="FILELIST_ITEM_STAR",C.SUITE_HEADER_TITLE_STAR="SUITE_HEADER_TITLE_STAR",C.SUITE_HEADER_MENU="SUITE_HEADER_MENU"},fXKp:function(e,t,n){"use strict";var r=n("hwdV").Buffer,o=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function a(e){var t=i(e);if("string"!=typeof t&&(r.isEncoding===o||!o(e)))throw new Error("Unknown encoding: "+e);return t||e}function s(e){var t;switch(this.encoding=a(e),this.encoding){case"utf16le":this.text=_,this.end=E,t=4;break;case"utf8":this.fillLast=d,t=4;break;case"base64":this.text=h,this.end=m,t=3;break;default:return this.write=O,void(this.end=y)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function c(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function u(e,t,n){var r=t.length-1;if(r<n)return 0;var o=c(t[r]);return 0<=o?(0<o&&(e.lastNeed=o-1),o):--r<n||-2===o?0:0<=(o=c(t[r]))?(0<o&&(e.lastNeed=o-2),o):!(--r<n||-2===o)&&0<=(o=c(t[r]))?(0<o&&(2===o?o=0:e.lastNeed=o-3),o):0}function l(e,t,n){return 128!=(192&t[0])?(e.lastNeed=0,"�"):1<e.lastNeed&&1<t.length?128!=(192&t[1])?(e.lastNeed=1,"�"):2<e.lastNeed&&2<t.length&&128!=(192&t[2])?(e.lastNeed=2,"�"):void 0:void 0}function d(e){var t=this.lastTotal-this.lastNeed,n=l(this,e,t);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function f(e,t){var n=u(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)}function p(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t}function _(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}function E(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function h(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function m(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function O(e){return e.toString(this.encoding)}function y(e){return e&&e.length?this.write(e):""}(t.StringDecoder=s).prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},s.prototype.end=p,s.prototype.text=f,s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},h6PB:function(e,t,n){"use strict";var r=n("pVnL"),o=n.n(r),i=n("QILm"),a=n.n(i),s=n("q1tI"),c=n.n(s);t.a=function(e){e.styles;var t=a()(e,["styles"]);return c.a.createElement("svg",o()({width:"136",height:"74",viewBox:"0 0 136 74",fill:"none"},t),c.a.createElement("g",{clipPath:"url(#b6d0b96388d2ebe11ab0a05481d84ef7-clip0)"},c.a.createElement("path",{fill:"#F8F9FA",fillOpacity:".5",d:"M0 0h136v74H0z"}),c.a.createElement("path",{d:"M59 11c0-1.1.9-2 2-2h61a2 2 0 012 2v10a2 2 0 01-2 2H61a2 2 0 01-2-2V11z",fill:"url(#b6d0b96388d2ebe11ab0a05481d84ef7-paint0_linear)"}),c.a.createElement("rect",{x:"59",y:"29",width:"44",height:"14",rx:"2",fill:"url(#b6d0b96388d2ebe11ab0a05481d84ef7-paint1_linear)"}),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28 42a16 16 0 100-32 16 16 0 000 32z",fill:"url(#b6d0b96388d2ebe11ab0a05481d84ef7-paint2_linear)"}),c.a.createElement("rect",{x:"12",y:"51",width:"112",height:"14",rx:"2",fill:"url(#b6d0b96388d2ebe11ab0a05481d84ef7-paint3_linear)"})),c.a.createElement("defs",null,c.a.createElement("linearGradient",{id:"b6d0b96388d2ebe11ab0a05481d84ef7-paint0_linear",x1:"59",y1:"23",x2:"125.16",y2:"23",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"})),c.a.createElement("linearGradient",{id:"b6d0b96388d2ebe11ab0a05481d84ef7-paint1_linear",x1:"59",y1:"43",x2:"103",y2:"43",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"})),c.a.createElement("linearGradient",{id:"b6d0b96388d2ebe11ab0a05481d84ef7-paint2_linear",x1:"12",y1:"42",x2:"44",y2:"42",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"})),c.a.createElement("linearGradient",{id:"b6d0b96388d2ebe11ab0a05481d84ef7-paint3_linear",x1:"12",y1:"65",x2:"124",y2:"65",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EFF0F1",stopOpacity:".6"}),c.a.createElement("stop",{offset:"1",stopColor:"#EFF0F1"})),c.a.createElement("clipPath",{id:"b6d0b96388d2ebe11ab0a05481d84ef7-clip0"},c.a.createElement("path",{fill:"#fff",d:"M0 0h136v74H0z"}))))}},h6S9:function(e,t,n){"use strict";var r,o;n.d(t,"a",function(){return r}),(o=r=r||{}).EQUAL="equal",o.NEAR="near"},hC3k:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r="note-title__history";function o(){var e,t=document.getElementsByClassName(r)[0];t&&("function"==typeof MouseEvent?e=new MouseEvent("click",{bubbles:!0}):(e=document.createEvent("MouseEvent")).initEvent("click",!0,!1),t.dispatchEvent(e))}},hNo0:function(e,t,n){"use strict";var r,o;n.d(t,"a",function(){return r}),(o=r=r||{}).DOC="doc",o.BITABLE="bitable",o.BITABLE_IMAGE="bitable_image",o.BITABLE_FILE="bitable_file",o.EXPLORER="explorer",o.SHEET_IMAGE="sheet_image",o.DOC_IMAGE="doc_image",o.COMMENT_IMAGE="comment_image"},hdMt:function(e,t,n){e.exports=n("mhMO")},hwdV:function(e,t,n){var r=n("HDXh"),o=r.Buffer;function i(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return o(e,t,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=a),i(o,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=o(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},hyzN:function(e,t,n){"use strict";var o,r,i=function(e){window.SheetPackagesStatus=window.SheetPackagesStatus||{},window.SheetPackagesStatus[e]=!0};(r=o=o||{}).SET_VALUE="setValue",r.SET_FORMULA="setFormula",r.SET_STYLE="setStyle",r.ADD_SHEET="addSheet",r.CREATE="create",r.SORT="sort",r.SET_CELL="setCell",r.SET_SPANS="setSpans",r.SET_COLUMN_WIDTH="setColumnWidth",r.SET_ROW_HEIGHT="setRowHeight",r.SET_SHEET="setSheet",r.COPY_SHEET="copySheet",r.DEL_SHEET="delSheet",r.SOFT_DEL_SHEET="softDelSheet",r.RESTORE_SHEET="restoreSheet",r.MOVE_SHEET="moveSheet",r.ADD_ROW="addRow",r.ADD_COL="addCol",r.DEL_ROW="delRow",r.DEL_COL="delCol",r.HIDE_ROW="hideRow",r.UNHIDE_ROW="unhideRow",r.HIDE_COL="hideCol",r.UNHIDE_COL="unhideCol",r.DEL_FILTER="delFilter",r.SET_FILTER="setFilter",r.FREEZE_SHEET="freezeSheet",r.ADD_COMMENTS="addComments",r.RECOVER="recover",r.LOCK_ROW="lockRow",r.UNLOCK_ROW="unlockRow",r.LOCK_COL="lockCol",r.UNLOCK_COL="unlockCol",r.LOCK_SHEET="lockSheet",r.UNLOCK_SHEET="unlockSheet",r.SET_CHART="setChart",r.DEL_CHART="delChart",r.SET_FLOAT_IMAGE="setFloatImage",r.DEL_FLOAT_IMAGE="delFloatImage",r.UPGRADE_SNAPSHOT="upgradeSnapshot",r.ADD_CONDITIONAL_FORMAT="addConditionalFormat",r.SET_CONDITIONAL_FORMAT="setConditionalFormat",r.DEL_CONDITIONAL_FORMAT="delConditionalFormat",r.MOVE_CONDITIONAL_FORMAT="moveConditionalFormat",r.COVER_SNAPSHOT="coverSnapshot",r.ADD_BLOCK="addBlock",r.DEL_BLOCK="delBlock",r.RESTORE_BLOCK="restoreBlock",r.MOVE_RANGE="moveRange",r.COVER_SHEET="coverSheet",r.TID_SPLIT="tidSplit",r.SET_RANGE="setRange",r.UPDATE_RANGE="updateRange",r.SET_FORM_DATA="setFormData",r.SET_COL_PROPERTY="setColProperty",r.SET_ROW_PROPERTY="setRowProperty",r.ADD_VIEW="addView",r.SET_VIEW="setView",r.DEL_VIEW="delView",r.SET_FILTER_VIEW="setFilterView",r.LOCAL_ACTIVE_VIEW="localActiveView",r.LOCAL_DEACTIVE_VIEW="localDeactiveView",r.UPDATE_REFERENCE="updateReference";var a,s,c,u,l,d,f,p,_,E,h,m,O,y,g,v,b,T,R,S,C,I,L,N,w,D,k,P,F;o.TID_SPLIT,o.LOCAL_ACTIVE_VIEW,o.LOCAL_DEACTIVE_VIEW;(s=a=a||{})[s.BeginsWith=2]="BeginsWith",s[s.DoesNotBeginWith=3]="DoesNotBeginWith",s[s.EndsWith=4]="EndsWith",s[s.DoesNotEndWith=5]="DoesNotEndWith",s[s.Contains=6]="Contains",s[s.DoesNotContain=7]="DoesNotContain",(u=c=c||{})[u.Equal=0]="Equal",u[u.NotEqual=1]="NotEqual",u[u.Greater=2]="Greater",u[u.GreaterOrEqual=3]="GreaterOrEqual",u[u.Less=4]="Less",u[u.LessOrEqual=5]="LessOrEqual",u[u.Between=6]="Between",u[u.NotBetween=7]="NotBetween",(d=l=l||{})[d.BackgroundColor=0]="BackgroundColor",d[d.ForegroundColor=1]="ForegroundColor",(p=f=f||{})[p.Equal=0]="Equal",p[p.NotEqual=1]="NotEqual",(E=_=_||{})[E.MultiValueCondition=0]="MultiValueCondition",E[E.NumberCondition=1]="NumberCondition",E[E.TextCondition=2]="TextCondition",E[E.ColorCondition=3]="ColorCondition",(m=h=h||{}).NONE="none",m.CELL_COLOR="cellColor",m.FONT_COLOR="fontColor",m.EQUAL="equal",m.NOT_EQUAL="notEqual",m.GREATER="greater",m.GREATER_OR_EQUAL="greater_or_equal",m.LESS="less",m.LESS_OR_EQUAL="less_or_equal",m.BETWEEN="between",m.NOT_BETWEEN="not_between",m.START="start",m.NOT_START="notStart",m.END="end",m.NOT_END="notEnd",m.CONTAIN="contain",m.NOT_CONTAIN="notContain",(O=O||{}).DataValidation="dataValidation",(g=y=y||{})[g.Name=0]="Name",(b=v=v||{}).Height="height",b.Width="width",b.Resizable="resizable",b.Visible="visible",b.PageBreak="pageBreak",b.FId="fId",(R=T=T||{})[R.NORMAL=0]="NORMAL",R[R.ROW=1]="ROW",R[R.COL=2]="COL",R[R.ALL=3]="ALL",R[R.CELL=4]="CELL",R[R.INVALID=5]="INVALID",(C=S=S||{})[C.SEND_COMMENT_CHANGE=-100]="SEND_COMMENT_CHANGE",C[C.FETCH_MISS_VERSION_CORE=-300]="FETCH_MISS_VERSION_CORE",C[C.REFETCH_ROOM_MEMBER=-400]="REFETCH_ROOM_MEMBER",C[C.TRIGGER_CHANGESET=-500]="TRIGGER_CHANGESET",C[C.ONLINE_STATE_CHANGE=-800]="ONLINE_STATE_CHANGE",C[C.HANDLE_BACKUP_LOCAL_ACTION=-900]="HANDLE_BACKUP_LOCAL_ACTION",C[C.BEFORE_UNLOAD=-1e3]="BEFORE_UNLOAD",C[C.FORWARD_CHANGESET_CORE=-1200]="FORWARD_CHANGESET_CORE",C[C.HANDLE_BACKUP_SUBMITTING_FOLLOW=-1300]="HANDLE_BACKUP_SUBMITTING_FOLLOW",C[C.ERROR_PERM_LOCK=-1400]="ERROR_PERM_LOCK",C[C.FOLLOW_ACTIONS=-1500]="FOLLOW_ACTIONS",C[C.FOLLOW_ACTIONS_2=-1600]="FOLLOW_ACTIONS_2",C[C.SUSPEND_READY=-1700]="SUSPEND_READY",C[C.HB=-1800]="HB",C[C.REQUIRE_RESYNC=-1900]="REQUIRE_RESYNC",C[C.CONFLICT=-2e3]="CONFLICT",C[C.RECOVER=-2100]="RECOVER",C[C.ACK=-2200]="ACK",C[C.MOBILE_NETWORK_CHANGE=-2300]="MOBILE_NETWORK_CHANGE",C[C.SPREAD_LOADED=-2400]="SPREAD_LOADED",C[C.NEW_CHANGES=-2500]="NEW_CHANGES",C[C.SYNC_MAX_REV=-2600]="SYNC_MAX_REV",C[C.RESUME_ACTION=-2700]="RESUME_ACTION",C[C.CLEAR_BACKUP=-2800]="CLEAR_BACKUP",C[C.COPY=-2900]="COPY",(L=I=I||{})[L.OLD=3]="OLD",L[L.NEW_SPLIT_CODE=4]="NEW_SPLIT_CODE",L[L.CS_GZIP=5]="CS_GZIP",L[L.NODE=6]="NODE",L[L.REF=7]="REF",(w=N=N||{})[w.RELATED=0]="RELATED",w[w.UNRELATED=1]="UNRELATED",(k=D=D||{})[k.ERROR_CLIENT_VARS=0]="ERROR_CLIENT_VARS",k[k.ERROR_SORT_INCLUDE_MERGE=1]="ERROR_SORT_INCLUDE_MERGE",k[k.ERROR_MERGE_CONTAIN_VALUE=2]="ERROR_MERGE_CONTAIN_VALUE",k[k.ERROR_MERGE_CONTAIN_MERGE=3]="ERROR_MERGE_CONTAIN_MERGE",k[k.ERROR_INVALID_SHEET_NAME=4]="ERROR_INVALID_SHEET_NAME",k[k.ERROR_CELL_NOT_EXIST=5]="ERROR_CELL_NOT_EXIST",k[k.ERROR_SHEET_NOT_EXIST=6]="ERROR_SHEET_NOT_EXIST",k[k.ERROR_SHEET_HID=7]="ERROR_SHEET_HID",k[k.ERROR_ACTION_CONFLICT=8]="ERROR_ACTION_CONFLICT",k[k.ERROR_RECEIVE_RECOVER=9]="ERROR_RECEIVE_RECOVER",k[k.ERROR_UPGRADE_SNAPSHOT=10]="ERROR_UPGRADE_SNAPSHOT",k[k.ERROR_OLD_CALC_REFRESH=11]="ERROR_OLD_CALC_REFRESH",k[k.ERROR_EDIT_PROTECTED_RANGE=12]="ERROR_EDIT_PROTECTED_RANGE",k[k.ERROR_ERROR=13]="ERROR_ERROR",k[k.ERROR_CANVAS=14]="ERROR_CANVAS",k[k.ERROR_CONDITIONAL_FORMATTING_NUM_LIMIT=15]="ERROR_CONDITIONAL_FORMATTING_NUM_LIMIT",k[k.ERROR_SYNC_UPGRADE_SNAPSHOT=16]="ERROR_SYNC_UPGRADE_SNAPSHOT",k[k.ERROR_SORT_LOGICAL_ERROR=17]="ERROR_SORT_LOGICAL_ERROR",k[k.ERROR_RECOVER=18]="ERROR_RECOVER",k[k.ERROR_ILLEGAL_COLLASPREAD_OP=19]="ERROR_ILLEGAL_COLLASPREAD_OP",k[k.ERROR_ADD_REMINDER_CONTAIN_VALUE=20]="ERROR_ADD_REMINDER_CONTAIN_VALUE",(F=P=P||{}).ERR_REQUEST_FAIL="1",F.ERR_INVALID_PARAM="2",F.ERR_NOT_FOUND="3",F.ERR_FORBIDDEN="4",F.ERR_LOGIN_REQUIRE="5",F.ERR_DATA_EXCEED_LIMIT="6",F.ERR_OBJECT_DELETED="7",F.ERR_NOT_IN_ROOM="8",F.ERR_UNCHANGE="9",F.ERR_CHANGESET_EXCEED_LIMIT="1001",F.ERR_NOTE_DELETED="1002",F.ERR_NOT_IN_SESSION="1003",F.ERR_NOTE_NOT_EXISTS="1004",F.ERR_CHAGESET_VALID_FAIL="1005",F.ERR_500="1006",F.ERR_MESSAGE_INVALID="1007",F.ERR_SYNC_ALGO_FAIL="1008",F.ERR_RCE_LIVE_SYNC="1009",F.ERR_OLD_VERSION="1010",F.ERR_USER_LIST_SYNC="1011",F.ERR_NO_WRITE_PERMISSION="1012",F.ERR_NO_COMMENT_PERMISSION="1013",F.ERR_LOCK_FAILED="1015",F.ERR_GET_EXACT_NOTE="2001",F.ERROR_PERM_LOCK="1201",F.ERROR_CLIENT_VARS_RCE_MISMATCH="1202",F.ERROR_CLIENT_VARS_RCE_READONLY="1203",F.ERROR_CREATE_LIMITATION="11001",F.ERROR_CREATE_COPY_EXCEED_IMAGE_LIMIT="130001",F.ERR_FETCH_CLIENTVARS="100",F.ERR_FETCH_BLOCKS="101",F.ERR_BUNDLE_FETCH_BLOCKS="102",F.ERR_HANDLE_BLOCK_DATA="103",F.ERROR_MAX_CELL_LIMIT="5001",F.ERROR_MAX_CELL_LIMIT_OPERATION="5002",F.ERROR_WORKER_SEND_USER_CHANGE="5003",F.ERROR_SEND_HIGH_PRORITY_MESSAGE="5004",F.ERR_CLIENTVARS_INVALID="5005",F.ERROR_APPLY_ACTION_EX="5006",F.ERROR_APPLY_ACTION_CORE_EX="5006_1",F.ERROR_CMD_EX="5007",F.ERROR_WATCH_DOG="5008",F.ERROR_WATCH_DOG_WARNING="5008_1",F.ERROR_WATCH_DOG_ALERT="5008_2",F.ERROR_WATCH_DOG_DONE="5008_3",F.ERROR_ILLEGAL_OP="5009",F.ERROR_RETRY_EXCEED="50010",F.ERROR_ADD_ROW_COL_COUNT_OUT="1211",F.ERROR_SHEET_COL_COUNT_OUT="1212",F.ERROR_CELL_COUNT_OUT="1213",F.ERROR_SUB_SHEET_COUNT_OUT="1214",F.ERROR_BITTABLE_COUNT_OUT="1215",F.ERROR_CELL_STR_LEN_OUT="1216";var x,M,j,U,B,V,H,W,Y,K,z,q,X,J,Q,Z,$,ee,te,ne,re,oe,ie,ae,se,ce,ue,le,de,fe,pe,_e,Ee,he,me,Oe;function ye(e){return e===P.ERR_CHANGESET_EXCEED_LIMIT||e===P.ERROR_MAX_CELL_LIMIT||e===P.ERR_MESSAGE_INVALID||e===P.ERROR_CELL_STR_LEN_OUT||e===P.ERROR_BITTABLE_COUNT_OUT||e===P.ERROR_SUB_SHEET_COUNT_OUT||e===P.ERROR_SHEET_COL_COUNT_OUT||e===P.ERROR_ADD_ROW_COL_COUNT_OUT||e===P.ERROR_CELL_COUNT_OUT}function ge(e){return e===P.ERR_FORBIDDEN||e===P.ERR_LOGIN_REQUIRE}function ve(e){return e===P.ERROR_PERM_LOCK}function be(e){return e===P.ERROR_WATCH_DOG_ALERT||e===P.ERROR_WATCH_DOG_DONE||e===P.ERROR_WATCH_DOG_WARNING}function Te(e){return e===P.ERR_OLD_VERSION}(M=x=x||{})[M.OTHER=0]="OTHER",M[M.SEND_USER_CS=1]="SEND_USER_CS",M[M.IO_MESSAGE=2]="IO_MESSAGE",(U=j=j||{}).FOLLOW_REJECT="follow_reject",U.RECOVER_CONFLICT="recover_conflict",U.SEND_RECOVER="send_recover",U.SEND_USER_CS="send_user_cs",U.TOO_OLD_REV="too_old_rev",(V=B=B||{}).Line="line",V.Bar="bar",V.Pie="pie",(W=H=H||{}).Row="row",W.Col="col",(K=Y=Y||{}).Vertical="vertical",K.Horizontal="horizontal",(q=z=z||{})[q.Bottom=0]="Bottom",q[q.Right=1]="Right",q[q.Top=2]="Top",q[q.Left=3]="Left",q[q.None=4]="None",(J=X=X||{}).ColorA="ColorA",J.ColorB="ColorB",J.ColorC="ColorC",J.ColorD="ColorD",J.ColorE="ColorE",J.ColorF="ColorF",(Z=Q=Q||{}).CHART_SETUP="CHART_SETUP",Z.CHART_CUSTOMIZE="CHART_CUSTOMIZE",(ee=$=$||{}).Row="row",ee.Col="col",(ne=te=te||{})[ne.General=0]="General",ne[ne.Text=1]="Text",ne[ne.Number=2]="Number",ne[ne.Percentage=3]="Percentage",ne[ne.Currency=4]="Currency",ne[ne.DateTime=5]="DateTime",(oe=re=re||{}).GENERAL="general",oe.PLAIN_TEXT="plain_text",oe.DIGITAL_WITHOUT_SEPARATOR="digital_without_separator",oe.DIGITAL="digital",oe.DIGITAL_ROUNDED="digital_round",oe.PERCENTAGE_ROUNDED="percentage_rounded",oe.PERCENTAGE="percentage",oe.SCIENTIFIC="scientific",oe.CYN_ROUNDED="cyn_rounded",oe.CYN="cyn",oe.DOLLAR_ROUNDED="dollar_rounded",oe.DOLLAR="dollar",oe.DATE_WITH_SLASH="date_with_slash",oe.DATE_WITH_HYPHEN="date_with_hyphen",oe.TIME="time",oe.DATE_TIME="date_time",(ae=ie=ie||{}).TEXT="text",ae.MENTION="mention",ae.URL="url",ae.EMBED_IMAGE="embed-image",ae.REMINDER="reminder",ae.PANO="pano",(ce=se=se||{})[ce.UNSET=0]="UNSET",ce[ce.EMOJI=1]="EMOJI",ce[ce.IMAGE=2]="IMAGE",ce[ce.USER_UPLOAD_IMAGE=3]="USER_UPLOAD_IMAGE",(le=ue=ue||{})[le.UNSET=0]="UNSET",le[le.EMOJI=1]="EMOJI",le[le.IMAGE=2]="IMAGE",le[le.USER_UPLOAD_IMAGE=3]="USER_UPLOAD_IMAGE",(fe=de=de||{}).Equal="equal",fe.NotEqual="notEqual",fe.Greater="greaterThan",fe.GreaterOrEqual="greaterThanOrEqual",fe.Less="lessThan",fe.LessOrEqual="lessThanOrEqual",fe.Between="between",fe.NotBetween="notBetween",(_e=pe=pe||{}).BeginsWith="beginsWith",_e.EndsWith="endsWith",_e.Contains="containsText",_e.DoesNotContain="notContains",_e.Is="is",(he=Ee=Ee||{}).Before="before",he.Is="is",he.After="after",(Oe=me=me||{}).Today="today",Oe.Yesterday="yesterday",Oe.Tomorrow="tomorrow",Oe.Last7Days="last7Days";var Re,Se,Ce,Ie,Ae,Le,Ne=10;(Se=Re=Re||{}).DUPLICATE_VALUES="duplicateValues",Se.UNIQUE_VALUES="uniqueValues",Se.CELL_IS="cellIs",Se.CONTAINS_TEXT="containsText",Se.TIME_PERIOD="timePeriod",Se.CONTAINS_BLANKS="containsBlanks",Se.NOT_CONTAINS_BLANKS="notContainsBlanks",(Ie=Ce=Ce||{})[Ie.NONE=0]="NONE",Ie[Ie.UNDERLINE=1]="UNDERLINE",Ie[Ie.LINETHROUGH=2]="LINETHROUGH",Ie[Ie.BOTH=3]="BOTH",(Le=Ae=Ae||{}).READABLE="readable",Le.COMMENTABLE="commentable",Le.EDITABLE="editable",Le.SHAREABLE="shareable";var we,De,ke,Pe,Fe,xe,Me,je;(De=we=we||{}).IFRAME_BLOCK="IFRAME_BLOCK",De.REACTION_BLOCK="REACTION_BLOCK",De.SHEET_BLOCK="SHEET_BLOCK",De.BITABLE_BLOCK="BITABLE_BLOCK",De.POLL_BLOCK="POLL_BLOCK",De.REMINDER_BLOCK="REMINDER_BLOCK",De.PLACEHOLDER_BLOCK="PLACEHOLDER_BLOCK",De.JIRA_ISSUE_BLOCK="JIRA_ISSUE_BLOCK",De.JIRA_FILTER_BLOCK="JIRA_FILTER_BLOCK",De.MINDNOTE_BLOCK="MINDNOTE_BLOCK",De.MENTION_BLOCK="mentionBlock",De.JEST_BLOCK="JEST_BLOCK",De.AT_USER_BLOCK="AT_USER_BLOCK",De.FILE_CARD_BLOCK="FILE_CARD_BLOCK",De.HTML_BLOCK="HTML_BLOCK",De.CHAT_CARD_BLOCK="CHAT_CARD_BLOCK",De.READ_PROCESS_BLOCK="READ_PROCESS_BLOCK",De.APPLICATION_CONTROL_BLOCK="APPLICATION_CONTROL_BLOCK",De.DIAGRAM_BLOCK="DIAGRAM_BLOCK",De.EQUATION_BLOCK="EQUATION_BLOCK",De.ISV_BLOCK="ISV_BLOCK",De.LINK_BLOCK="LINK_BLOCK",De.OKR_BLOCK="OKR_BLOCK",(Pe=ke=ke||{}).PLACEHOLDER="PLACEHOLDER",Pe.PLACEHOLDER_NEW="PLACEHOLDER_NEW",Pe.CONTENT="CONTENT",(xe=Fe=Fe||{})[xe.UNLOADED=0]="UNLOADED",xe[xe.LOADING=1]="LOADING",xe[xe.LOADED=2]="LOADED",(je=Me=Me||{}).ApplyCS="ApplyCS",je.Normal="Normal";var Ue,Be,Ve=n("EPt+");(Be=Ue=Ue||{}).TICK="tick",Be.END="end",Be.SCROLL="scroll",Be.LOAD_ALONE="load_alone_sheet",Be.LOAD_EMBED="load_embed_sheet",Be.SWITCHTAB="switch_tab",Be.HIDE_FREEZE_SHADOW="hide_freeze_shadow",Be.UNKNOWN="unknown";var He,Ge,We,Ye,Ke=Object.assign({},Ue,{},Ve.i);(Ge=He=He||{})[Ge.BeginsWith=0]="BeginsWith",Ge[Ge.EndsWith=1]="EndsWith",Ge[Ge.Contains=2]="Contains",Ge[Ge.DoesNotContain=3]="DoesNotContain",Ge[Ge.Equal=4]="Equal",Ge[Ge.DoesNotBeginWith=5]="DoesNotBeginWith",Ge[Ge.DoesNotEndWith=6]="DoesNotEndWith",(Ye=We=We||{}).CELL_IS="cellIs",Ye.CONTAINS_TEXT="containsText",Ye.COLOR="color",Ye.MULTI_VALUES="multiValues";var ze,qe,Xe,Je=n("lSNA"),Qe=n.n(Je);(Xe=qe=qe||{})[Xe.AT_TIME_OF_EVENT=0]="AT_TIME_OF_EVENT",Xe[Xe.BEFORE_5_MINUTES=1]="BEFORE_5_MINUTES",Xe[Xe.BEFORE_15_MINUTES=2]="BEFORE_15_MINUTES",Xe[Xe.BEFORE_30_MINUTES=3]="BEFORE_30_MINUTES",Xe[Xe.BEFORE_1_HOUR=4]="BEFORE_1_HOUR",Xe[Xe.BEFORE_2_HOURS=5]="BEFORE_2_HOURS",Xe[Xe.AT_DAY_OF_EVENT=6]="AT_DAY_OF_EVENT",Xe[Xe.BEFORE_1_DAY=7]="BEFORE_1_DAY",Xe[Xe.BEFORE_2_DAYS=8]="BEFORE_2_DAYS",Xe[Xe.BEFORE_1_WEEK=9]="BEFORE_1_WEEK",Xe[Xe.AT_TIME_BEFORE_1_DAY=10]="AT_TIME_BEFORE_1_DAY",Xe[Xe.AT_TIME_BEFORE_2_DAYS=11]="AT_TIME_BEFORE_2_DAYS",Xe[Xe.AT_TIME_BEFORE_1_WEEK=12]="AT_TIME_BEFORE_1_WEEK";var Ze,$e,et,tt,nt=(ze={},Qe()(ze,qe.AT_TIME_OF_EVENT,"at_time_of_event"),Qe()(ze,qe.BEFORE_5_MINUTES,"before_5_minutes"),Qe()(ze,qe.BEFORE_15_MINUTES,"before_15_minutes"),Qe()(ze,qe.BEFORE_30_MINUTES,"before_30_minutes"),Qe()(ze,qe.BEFORE_1_HOUR,"before_1_hour"),Qe()(ze,qe.BEFORE_2_HOURS,"before_2_hours"),Qe()(ze,qe.AT_DAY_OF_EVENT,"at_day_of_event"),Qe()(ze,qe.BEFORE_1_DAY,"before_1_day"),Qe()(ze,qe.BEFORE_2_DAYS,"before_2_days"),Qe()(ze,qe.BEFORE_1_WEEK,"before_1_week"),Qe()(ze,qe.AT_TIME_BEFORE_1_DAY,"at_time_before_1_day"),Qe()(ze,qe.AT_TIME_BEFORE_2_DAYS,"at_time_before_2_day"),Qe()(ze,qe.AT_TIME_BEFORE_1_WEEK,"at_time_before_1_week"),ze);($e=Ze=Ze||{}).ADD_REMINDER="add_reminder",$e.SWITCH_REMINDER="switch_reminder",$e.SET_REMINDER_TIME="set_reminder_time",$e.EDIT_REMINDER_PERSON="edit_reminder_person",$e.EDIT_REMINDER_TEXT="edit_reminder_text",$e.HOVER_CLOCK_ICON="hover_clock_icon",$e.SHOW_REMINDER_LIMIT_TOAST="show_reminder_limit_toast",(tt=et=et||{}).ON="on",tt.OFF="off";var rt,ot,it,at,st=n("bZiw");(ot=rt=rt||{}).List="list",ot.Integer="integer",ot.Decimal="decimal",ot.Date="date",ot.Time="time",ot.TextLength="textLength",ot.Checkbox="checkbox",ot.Custom="custom",(at=it=it||{}).Between="between",at.NotBetween="notBetween",at.EqualTo="equalTo",at.NotEqualTo="notEqualTo",at.GreaterThan="greaterThan",at.LessThan="lessThan",at.GreaterThanOrEqualTo="greaterThanOrEqualTo",at.LessThanOrEqualTo="lessThanOrEqualTo";var ct,ut,lt=n("S7iq"),dt=n("puQj"),ft=n.n(dt).a.mac;(ut=ct=ct||{})[ut.BackSpace=8]="BackSpace",ut[ut.Tab=9]="Tab",ut[ut.Clear=12]="Clear",ut[ut.Enter=13]="Enter",ut[ut.Shift=16]="Shift",ut[ut.Ctrl=17]="Ctrl",ut[ut.Alt=18]="Alt",ut[ut.Caps=20]="Caps",ut[ut.Esc=27]="Esc",ut[ut.Space=32]="Space",ut[ut.PageUp=33]="PageUp",ut[ut.PageDown=34]="PageDown",ut[ut.End=35]="End",ut[ut.Home=36]="Home",ut[ut.Left=37]="Left",ut[ut.Up=38]="Up",ut[ut.Right=39]="Right",ut[ut.Down=40]="Down",ut[ut.Delete=46]="Delete",ut[ut.Digit0=48]="Digit0",ut[ut.Digit1=49]="Digit1",ut[ut.Digit2=50]="Digit2",ut[ut.Digit3=51]="Digit3",ut[ut.Digit4=52]="Digit4",ut[ut.Digit5=53]="Digit5",ut[ut.Digit6=54]="Digit6",ut[ut.Digit9=57]="Digit9",ut[ut.A=65]="A",ut[ut.B=66]="B",ut[ut.C=67]="C",ut[ut.D=68]="D",ut[ut.E=69]="E",ut[ut.F=70]="F",ut[ut.G=71]="G",ut[ut.H=72]="H",ut[ut.I=73]="I",ut[ut.J=74]="J",ut[ut.K=75]="K",ut[ut.L=76]="L",ut[ut.M=77]="M",ut[ut.N=78]="N",ut[ut.O=79]="O",ut[ut.P=80]="P",ut[ut.Q=81]="Q",ut[ut.R=82]="R",ut[ut.S=83]="S",ut[ut.T=84]="T",ut[ut.U=85]="U",ut[ut.V=86]="V",ut[ut.W=87]="W",ut[ut.X=88]="X",ut[ut.Y=89]="Y",ut[ut.Z=90]="Z",ut[ut.Meta=91]="Meta",ut[ut.RightMeta=92]="RightMeta",ut[ut.Caret=94]="Caret",ut[ut.Numpad0=96]="Numpad0",ut[ut.Numpad9=105]="Numpad9",ut[ut.Asterisk=106]="Asterisk",ut[ut.NumpadDot=110]="NumpadDot",ut[ut.F2=113]="F2",ut[ut.F3=114]="F3",ut[ut.F4=115]="F4",ut[ut.F11=122]="F11",ut[ut.Semicolon=186]="Semicolon",ut[ut.Equal=187]="Equal",ut[ut.Plus=187]="Plus",ut[ut.Comma=188]="Comma",ut[ut.Minus=189]="Minus",ut[ut.Dot=190]="Dot",ut[ut.Grave=192]="Grave",ut[ut.Bracket=219]="Bracket",ut[ut.Quot=222]="Quot",ut[ut.Slash=111]="Slash",ut[ut["/"]=191]="/",ut[ut.Backquote=192]="Backquote",ut[ut["\\"]=220]="\\",ut[ut.BracketRight=221]="BracketRight",ut[ut.Ime=229]="Ime";var pt=[ct.Up,ct.Down,ct.Left,ct.Right];ct.C,ct.V,ct.X;function _t(e){return Et(e)&&e.keyCode===ct.C}function Et(e){return ft?e.metaKey&&!e.altKey:e.ctrlKey&&!e.altKey}function ht(e){return Et(e)&&e.keyCode===ct.X}function mt(e){var t=e.keyCode,n=e.altKey,r=e.ctrlKey,o=e.shiftKey,i=e.metaKey;return!(n||r||o||i||t!==ct.BackSpace&&t!==ct.Delete)}function Ot(e){return Et(e)&&e.keyCode===ct.Z}function yt(e){var t=Ot(e)&&!!e.shiftKey,n=Et(e)&&e.keyCode===ct.Y;return t||n}function gt(e){var t,n=e.key,r=e.keyCode,o=e.which;229===r&&(t=ct[e.code]||ct[n.toUpperCase()]),/^[a-zA-Z]$/.test(n)&&ct[n.toUpperCase()]!==r&&(t=ct[n.toUpperCase()]),Object.defineProperty(e,"keyCode",{get:function(){return t||r}}),Object.defineProperty(e,"which",{get:function(){return t||o}})}var vt,bt=n("fV25"),Tt="embed-image-uploading",Rt=n("Z/fP"),St=n("lwsE"),Ct=n.n(St),It=n("W8MJ"),At=n.n(It),Lt=100,Nt=50,wt=function(){function e(){var n=this;Ct()(this,e),this.hasInit=!1,this.isPaused=!0,this.anrTime=0,this.lastTime=0,this.anrCalculator=function(){var e=window.performance.now(),t=e-n.lastTime-Lt;Nt<t&&(n.anrTime+=t),n.lastTime=e,n.timeoutId=setTimeout(n.anrCalculator,Lt)},this.handleVisibilityChange=function(){var e=document.visibilityState;"hidden"===e?n.pause():"visible"===e&&n.start()}}return At()(e,[{key:"getAnrTime",value:function(){var e=window.performance.now()-this.lastTime-Lt;return Nt<e&&!this.isPaused?this.anrTime+e:this.anrTime}},{key:"init",value:function(){this.hasInit||(this.hasInit=!0,this.start(),document.addEventListener("visibilitychange",this.handleVisibilityChange))}},{key:"destroy",value:function(){this.hasInit&&(this.pause(),document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.hasInit=!1)}},{key:"start",value:function(){var e;this.isPaused&&(e=window.performance,this.isPaused=!1,this.lastTime=e.now(),this.timeoutId=setTimeout(this.anrCalculator,Lt))}},{key:"pause",value:function(){!this.isPaused&&this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null,this.isPaused=!0)}}]),e}(),Dt=function(){return vt=vt||new wt},kt=new(function(){function e(){Ct()(this,e)}return At()(e,[{key:"setSpread",value:function(e){this.spread=e}},{key:"getSheetCommonOptions",value:function(e){if(this.spread){var t,n,r,o=e||this.spread.getActiveSheet(),i=0,a=0,s=0,c=0,u=0,l=0,d=0,f=0,p=0;return o&&((t=o.sheetFilterModel.getFilterRange())&&(c=t.rowCount()*t.colCount()),u=o._getSpanModel().length,f=0<o.conditionalFormatModel.getAllRules().length?1:0,p=0<Object.keys(o.getChartMap()).length?1:0,s=(i=o.getRowCount())*(a=o.getColumnCount()),n=o.id(),(r=this.spread.cacheManager.cache.get(n))&&(d=r.size()),l=this.spread.getCalcEngine().fmlSpace().getFormulaCount()),{row_count:i,col_count:a,cell_count:s,span_count:u,filter_cell_count:c,formula_count:l,typography_cache_size:d,has_condition:f,has_chart:p}}}},{key:"getSpreadComomOptions",value:function(){if(this.spread)return{sheetNum:this.spread.sheets.length,bitable_block_num:this.spread.getBitableBlockNum(),formula_count:this.spread.getCalcEngine().fmlSpace().getFormulaCount(),typography_cache_size:this.spread.cacheManager.length}}},{key:"collectSheetEvent",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0,r=this.getSheetCommonOptions(n);Rt.a.collectSuiteEvent(e,Object.assign({},r,{},t))}},{key:"collectSpreadEvent",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this.getSpreadComomOptions();Rt.a.collectSuiteEvent(e,Object.assign({},n,{},t))}},{key:"destroy",value:function(){this.spread=null}}]),e}()),Pt="sheet_lifetime",Ft="open_after_one_minute",xt={jsHeapSizeLimit:0,totalJSHeapSize:0,usedJSHeapSize:0},Mt=function(){var e=window.performance&&window.performance.memory;return e?{jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}:xt},jt=function(e){return parseFloat((e/1024).toFixed())},Ut="sheet_performance_memory",Bt=new(function(){function e(){var n=this;Ct()(this,e),this.spread=null,this.sceneMap=new Map,this.anrRecorder=Dt(),this.handleLogSceneEnd=function(){return n.logSceneEnd(Pt,!0)},this.logMemoryBeforeExec=function(e,t){t&&t.commandName&&n.logSceneBegin(t.commandName)},this.logMemoryAfterExec=function(e,t){t&&t.commandName&&n.logSceneEnd(t.commandName,!1,{cs_count:t.changesets&&t.changesets.length})}}return At()(e,[{key:"bindEvents",value:function(){"undefined"!=typeof window&&window.addEventListener("beforeunload",this.handleLogSceneEnd)}},{key:"unbindEvents",value:function(){"undefined"!=typeof window&&window.removeEventListener("beforeunload",this.handleLogSceneEnd)}},{key:"beginTracker",value:function(){var e=this;this.logSceneBegin(Pt),this.logSceneBegin(Ft),setTimeout(function(){e.logSceneEnd(Ft,!0)},6e4)}},{key:"logSceneBegin",value:function(e,t){var n,r=window.performance.now(),o=Mt(),i=this.anrRecorder.getAnrTime();this.sceneMap.has(e)?(n=this.sceneMap.get(e),this.sceneMap.set(e,Object.assign({},n,{begin:r,anrBegin:i},o,{eventParams:t}))):this.sceneMap.set(e,Object.assign({begin:r,anrBegin:i},o,{eventParams:t}))}},{key:"logSceneEnd",value:function(e,t,n){if(!this.sceneMap.has(e))return console.warn("event ".concat(e," doesn't exsit")),this.sceneMap.delete(e);var r,o,i,a=Mt(),s=this.sceneMap.get(e)||{},c=void 0!==s.anrBegin?this.anrRecorder.getAnrTime()-s.anrBegin:0,u=void 0!==s.begin?window.performance.now()-s.begin:0,l=jt(a.totalJSHeapSize-s.totalJSHeapSize),d=jt(a.usedJSHeapSize-s.usedJSHeapSize),f=Object.assign({scene_name:e,duration:u,ANR_time:c,totalJSHeapSizeDelta:l,usedJSHeapSizeDelta:d,totalJSHeapSize:jt(a.totalJSHeapSize),usedJSHeapSize:jt(a.usedJSHeapSize)},s.eventParams,{},n);return t&&this.spread&&this.spread.sheets&&(r=this.spread.sheets.reduce(function(e,t){return t.loadStatus===Fe.LOADED?e+1:e},0),o=this.spread.sheets.reduce(function(e,t){return t.loaded?t.getRowCount()*t.getColumnCount()+e:e},0),i=Number((r/this.spread.sheets.length).toFixed(3)),f=Object.assign({},f,{},kt.getSheetCommonOptions(),{loadedSheetCount:r,loadedSheetCellCount:o,loadingPercent:i})),kt.collectSpreadEvent(Ut,f),this.sceneMap.delete(e)}},{key:"setup",value:function(e){e&&(this.bindEvents(),e.bind(Ve.u.CommandExecuting,this.logMemoryBeforeExec),e.bind(Ve.u.CommandExecuted,this.logMemoryAfterExec),this.spread=e,this.anrRecorder.init())}},{key:"destroy",value:function(){var e=this.spread;e&&(this.unbindEvents(),e.unbind(Ve.u.CommandExecuting,this.logMemoryBeforeExec),e.unbind(Ve.u.CommandExecuted,this.logMemoryAfterExec),this.spread=null,this.logSceneEnd(Pt,!0),this.sceneMap.clear(),this.anrRecorder.destroy())}}]),e}()),Vt=n("hbEN"),Ht=n("RIqP"),Gt=n.n(Ht),Wt=n("gSGL"),Yt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Kt(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:20,t="",n=0;n<e;n++){var r=Math.floor(Math.random()*Yt.length);t+=Yt[r]}return t}var zt="https?|s?ftp|ftps|nfs|ssh",qt="\\b([/#?][\\-A-Z0-9@:%_+.~#?&'/=;$,!\\*\\[\\]\\(\\){}^|<>]*[-A-Z0-9&@#/%=~\\(\\)_|]?)?",Xt=/localhost(:[0-9]{2,5})?/,Jt=/(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}(2[0-4][0-9]|25[0-5]|1[0-9]{2}|[1-9][0-9]|[0-9])(:[0-9]{2,5})?/,Qt=new RegExp("((((".concat(zt,")://)?(").concat(Xt.source,"))|(((").concat(zt,")://)(").concat(Jt.source,")))").concat(qt),"gi"),Zt="([\\-A-Z:0-9%_+~#@]{1,256}\\.){1,50}",$t="[a-z\\-]{2,15}",en="com|org|net|int|edu|gov|mil|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gh|gi|gl|gm|gn|gp|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mf|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|site|top|wtf|xxx|xyz|cloud|engineering|help|one",tn="com|cn|tk|de|net|org|uk|info|nl|ru|hk",nn=new RegExp("(((".concat(zt,"):\\/\\/").concat(Zt).concat($t,")|([-A-Z0-9%_+~#@]").concat(Zt,"(").concat(tn,")))(:[0-9]{2,5})?").concat(qt),"gi"),rn="[\\w.!#$%&'*+-/=?^_\\`{|}~]{1,2000}@[A-Za-z0-9_.-]+\\.",on=new RegExp("^(?!data:)((mailto:".concat(rn).concat($t,")|(").concat(rn,"(").concat(en,")))\\b"),"gi"),an=new RegExp("(".concat(Qt.source,")|(").concat(nn.source,")|(").concat(on.source,")"),"gi"),sn=/^(https?|ftp):\/\/|mailto:/i;function cn(e){return new RegExp(sn).test(e)}function un(e){return new RegExp(an).test(e)}function ln(e){return new RegExp("^".concat(on.source,"$"),"i").test(e)}function dn(e){var t=[],n=0,r=new RegExp(an),o=r.exec(e);if(null==o)return e;for(;o;){var i=o.index,a=o[0];i!==n&&t.push({type:"text",text:e.substring(n,i)}),cn(a)?t.push({type:"url",text:a}):un(a)?t.push({type:"url",link:"http://".concat(a),text:a}):ln(a)&&t.push({type:"url",link:"mailto:".concat(a),text:a}),n=r.lastIndex,o=r.exec(e)}return n<e.length&&t.push({type:"text",text:e.substring(n)}),t}function fn(e){return Object(Wt.a)(e)?e.replace(/\u00a0/g," "):e}function pn(e){for(var t="";0<=e;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function _n(e){for(var t=e.toUpperCase(),n=0,r=t.length-1,o=0;0<=r;r--,o++)n+=(t.charCodeAt(r)-64)*Math.pow(26,o);return n-1}var En="[.~`!?@#$%^&*()\\-_+=|{};:\"<>'[\\]]",hn="[。？ ！ ， 、 ； ： “ ” ‘ （ ） 《 》 〈 〉 【 】 『 』 「 」 ﹃ ﹄ 〔 〕 … — ～ ﹏ ￥]",mn="[\\u4e00-\\u9fa5]",On="[\\u0800-\\u4e00]",yn="[A-Z]",gn="[a-z]",vn="[0-9]";function bn(e){if("string"!=typeof e)return e;var t=new RegExp([En,hn,mn,On,yn,gn,vn].map(function(e){return"(".concat(e,")")}).join("|")+"|.","g");return e.replace(t,function(e,t,n,r,o,i,a,s){return void 0!==t?t:void 0!==n?n:void 0!==r?"汉":void 0!==o?"日":void 0!==i?"X":void 0!==a?"x":void 0!==s?"9":"？"})}function Tn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function Rn(e){return Object(Wt.a)(e)?e.replace(/"/g,'""'):e}var Sn=n("vJtL");function Cn(e,t){var n=window.getSelection(),r=n.focusNode,o=n.getRangeAt(0),i=("#text"===r.nodeName?o:r).getBoundingClientRect(),a=i.top,s=e.getBoundingClientRect(),c=a-s.top,u=c+i.height-s.height,l=e.scrollTop;r!==e&&(t?e.scrollTop=c<=l?c:l+u:0<=u&&(e.scrollTop=l+u))}function In(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(Object(Sn.default)(CustomEvent))return new CustomEvent(e,t);var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail),n}var An,Ln=function(e){return window.requestAnimationFrame?window.requestAnimationFrame(e):window.setTimeout(e,16)},Nn=function(e){window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e)},wn=n("/xWd"),Dn=Array.prototype.flat?function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return e.flat(t)}:wn.a,kn=n("fLNQ"),Pn=n("o0o1"),Fn=n.n(Pn),xn=n("yXPU"),Mn=n.n(xn),jn={max:3,factor:0,interval:1e3};function Un(c,e){var t=Object.assign({},jn,e),u=t.max,l=t.interval,d=t.factor,f=t.onRetry,p=t.shouldRetry,_=0;return function(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++)s[t]=arguments[t];return new Promise(function(o,i){var a=function(){var e=Mn()(Fn.a.mark(function e(){var t,n,r;return Fn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(e){var t=Math.pow(_++,d)*l;p&&!p(e)||setTimeout(function(){f&&f(_,e),a()},t)},n=s?s[2]:{},e.prev=2,e.next=5,c.apply(null,s);case 5:if(r=e.sent,!p||!p(r)){e.next=12;break}if(_<u)return e.abrupt("return",t(r));e.next=9;break;case 9:i({code:P.ERROR_RETRY_EXCEED,payload:r,customErrorInfo:n}),e.next=13;break;case 12:o({code:0,payload:r});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),_<u&&(!p||p(e.t0))?t(e.t0):i({code:P.ERROR_RETRY_EXCEED,payload:e.t0,customErrorInfo:n});case 18:case"end":return e.stop()}},e,null,[[2,15]])}));return function(){return e.apply(this,arguments)}}();a()})}}function Bn(e){return"url"===e.type}function Vn(e){return"mention"===e.type}function Hn(e){return Vn(e)&&e.mentionType===Ve.E.USER}function Gn(e){return Vn(e)&&Yn(e.mentionType)}var Wn=(An={},Qe()(An,Ve.E.DOC,"Doc"),Qe()(An,Ve.E.SHEET,"Sheet"),Qe()(An,Ve.E.BITABLE,"Bitable"),Qe()(An,Ve.E.MINDNOTE,"MindNote"),Qe()(An,Ve.E.FILE,"File"),Qe()(An,Ve.E.SLIDE,"Slide"),Qe()(An,Ve.E.WIKI,"Wiki"),An);function Yn(e){return void 0!==Wn[e]}function Kn(e){return Vn(e)?decodeURIComponent(e.link||""):e.link||e.text||""}var zn=n("a1gu"),qn=n.n(zn),Xn=n("Nsbk"),Jn=n.n(Xn),Qn=n("7W2i"),Zn=n.n(Qn),$n=n("J4zp"),er=n.n($n);var tr,nr,rr=function(e){function t(){return Ct()(this,t),qn()(this,Jn()(t).apply(this,arguments))}return Zn()(t,e),At()(t,[{key:"enqueue",value:function(e,t,n){this.waitingQueue=[[e,t,n]]}}]),t}(function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Ct()(this,t),this.waitingQueue=[],this.runningSet=new Set,this.options=Object.assign({maxRunningCount:1},e)}function e(){return n.apply(this,arguments)}var n;return At()(t,[{key:"schedule",value:function(n){var r=this;return new Promise(function(e,t){r.enqueue(n,e,t),r.execute()})}},{key:"execute",value:(n=Mn()(Fn.a.mark(function e(){var t,n,r,o,i,a;return Fn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0<this.waitingQueue.length&&this.runningSet.size<this.options.maxRunningCount)return t=this.waitingQueue.shift(),n=er()(t,3),r=n[0],o=n[1],i=n[2],this.runningSet.add(r),e.prev=3,e.next=6,r();e.next=18;break;case 6:a=e.sent,o(a),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),i(e.t0);case 13:return e.prev=13,this.runningSet.delete(r),e.next=17,this.execute();case 17:return e.finish(13);case 18:case"end":return e.stop()}},e,this,[[3,10,13,18]])})),e)},{key:"enqueue",value:function(e,t,n){this.waitingQueue.push([e,t,n])}}]),t}()),or=n("cDf5"),ir=n.n(or),ar=n("7EGn"),sr=n("4O8T"),cr=n.n(sr),ur="visibilitychange";(nr=tr=tr||{}).Visible="visible",nr.Hidden="hidden";var lr,dr,fr=function(e){function n(){var t;if(Ct()(this,n),(t=qn()(this,Jn()(n).call(this))).handlePageVisible=function(){t.visibilityState=tr.Visible,t.emit(ur,tr.Visible)},t.handlePageNotVisible=function(){t.visibilityState=tr.Hidden,t.emit(ur,tr.Hidden)},t.handleVisibilityChange=function(){var e=document.visibilityState;t.visibilityState=e,t.emit(ur,e)},"object"!==("undefined"==typeof document?"undefined":ir()(document)))return qn()(t);var e=kn.a.isLarkPcTab?t.getStateFromLarkStatus():document.visibilityState;return t.visibilityState=e,t}return Zn()(n,e),At()(n,[{key:"getStateFromLarkStatus",value:function(){return"started"===Object(ar.default)(window,"__APPLICATION__STATUS__")?tr.Visible:tr.Hidden}},{key:"watch",value:function(){kn.a.isLarkPcTab?(window.addEventListener("application-stop",this.handlePageNotVisible),window.addEventListener("application-start",this.handlePageVisible)):window.addEventListener("visibilitychange",this.handleVisibilityChange),this.isWatching=!0}},{key:"unwatch",value:function(){kn.a.isLarkPcTab?(window.removeEventListener("application-stop",this.handlePageNotVisible),window.removeEventListener("application-start",this.handlePageVisible)):window.removeEventListener("visibilitychange",this.handleVisibilityChange),this.isWatching=!1}},{key:"isVisible",get:function(){return this.visibilityState===tr.Visible}}]),n}(cr.a),pr=n("CxY0"),_r=n.n(pr),Er=n("Qyje");function hr(e){return new URLSearchParams(location.search.substring(1)).get(e)||""}function mr(e,t){var n=new URLSearchParams(location.search.slice(1));n.set(e,t);var r=n.toString();return r?"?"+r:""}function Or(e){var t=new URLSearchParams(location.search.slice(1));t.delete(e);var n=t.toString();return n?"?"+n:""}function yr(e){if(!e)return null;var t=_r.a.parse(e);if(t&&t.query){var n=Object(Er.parse)(t.query);if(n.sheet)return{sheetId:n.sheet,rangeId:n.range}}return null}function gr(e){return e.action===o.UPDATE_RANGE||e.action===o.SET_RANGE}(dr=lr=lr||{}).APPLY_TEMPLATE_ERROR="apply_template_error",dr.APPLY_BLOCK_TEMPLATE_ERROR="apply_block_template_error",dr.SHEET_IS_NIL="sheet_is_nil";var vr=function(){function e(){Ct()(this,e)}return At()(e,null,[{key:"log",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.error,r=void 0===n?new Error:n,o=t.data,i=void 0===o?"":o,a="",s="";r instanceof Error&&(a=String(r.message),s=String(r.stack)),Rt.a.moirae.teaLog({key:"sheet_common_error",type:e,message:a,stack:s,error:String(r),data:i})}}]),e}();function br(){return window.performance.now()}function Tr(e){return Math.round(window.performance.now()-e)}vr.TYPE=lr;var Rr,Sr,Cr,Ir,Ar=n("PJYZ"),Lr=n.n(Ar),Nr=n("oShl"),wr=n.n(Nr);(Sr=Rr=Rr||{})[Sr.Base=5e5]="Base",Sr[Sr.SYSTEM_ERROR=500100]="SYSTEM_ERROR",Sr[Sr.HANDLE_REQUEST_FAIL=500101]="HANDLE_REQUEST_FAIL",Sr[Sr.AUTHORIZATION_FAIL=500200]="AUTHORIZATION_FAIL",Sr[Sr.NETWORK_ERROR=500300]="NETWORK_ERROR",Sr[Sr.SPREAD_SHEET_ID_ERROR=500400]="SPREAD_SHEET_ID_ERROR",Sr[Sr.PARAMETERS_ERROR=500500]="PARAMETERS_ERROR",Sr[Sr.RECOVER_FAIL=500600]="RECOVER_FAIL",Sr[Sr.REVISION_GAP_ERROR=500700]="REVISION_GAP_ERROR",Sr[Sr.HIT_POINT_KILL=500800]="HIT_POINT_KILL",Sr[Sr.GET_SSR_FAIL=500900]="GET_SSR_FAIL",Sr[Sr.COMPARE_ERROR=501e3]="COMPARE_ERROR",(Ir=Cr=Cr||{})[Ir.APPLY_FAIL=4e5]="APPLY_FAIL",Ir[Ir.APPLY_FAIL_SPAN_CONFLICT=400001]="APPLY_FAIL_SPAN_CONFLICT",Ir[Ir.SET_VALUE_FAIL=400100]="SET_VALUE_FAIL",Ir[Ir.SET_FORMULA_FAIL=400200]="SET_FORMULA_FAIL",Ir[Ir.SET_STYLE_FAIL=400300]="SET_STYLE_FAIL",Ir[Ir.ADD_SHEET_FAIL=400400]="ADD_SHEET_FAIL",Ir[Ir.CREATE_FAIL=400500]="CREATE_FAIL",Ir[Ir.SORT_FAIL=400600]="SORT_FAIL",Ir[Ir.SET_CELL_FAIL=400700]="SET_CELL_FAIL",Ir[Ir.SET_SPANS_FAIL=400800]="SET_SPANS_FAIL",Ir[Ir.SET_COLUMN_WIDTH_FAIL=400900]="SET_COLUMN_WIDTH_FAIL",Ir[Ir.SET_ROW_HEIGHT_FAIL=401e3]="SET_ROW_HEIGHT_FAIL",Ir[Ir.SET_SHEET_FAIL=401100]="SET_SHEET_FAIL",Ir[Ir.COPY_SHEET_FAIL=401200]="COPY_SHEET_FAIL",Ir[Ir.DEL_SHEET_FAIL=401300]="DEL_SHEET_FAIL",Ir[Ir.SOFT_DEL_SHEET_FAIL=401400]="SOFT_DEL_SHEET_FAIL",Ir[Ir.RESTORE_SHEET_FAIL=401500]="RESTORE_SHEET_FAIL",Ir[Ir.MOVE_SHEET_FAIL=401600]="MOVE_SHEET_FAIL",Ir[Ir.ADD_ROW_FAIL=401700]="ADD_ROW_FAIL",Ir[Ir.ADD_COL_FAIL=401800]="ADD_COL_FAIL",Ir[Ir.DEL_ROW_FAIL=401900]="DEL_ROW_FAIL",Ir[Ir.DEL_COL_FAIL=402e3]="DEL_COL_FAIL",Ir[Ir.HIDE_ROW_FAIL=402100]="HIDE_ROW_FAIL",Ir[Ir.UNHIDE_ROW_FAIL=402200]="UNHIDE_ROW_FAIL",Ir[Ir.HIDE_COL_FAIL=402300]="HIDE_COL_FAIL",Ir[Ir.UNHIDE_COL_FAIL=402400]="UNHIDE_COL_FAIL",Ir[Ir.DEL_FILTER_FAIL=402500]="DEL_FILTER_FAIL",Ir[Ir.SET_FILTER_FAIL=402600]="SET_FILTER_FAIL",Ir[Ir.FREEZE_SHEET_FAIL=402700]="FREEZE_SHEET_FAIL",Ir[Ir.ADD_COMMENTS_FAIL=402800]="ADD_COMMENTS_FAIL",Ir[Ir.RECOVER_FAIL=402900]="RECOVER_FAIL",Ir[Ir.LOCK_ROW_FAIL=403e3]="LOCK_ROW_FAIL",Ir[Ir.UNLOCK_ROW_FAIL=403100]="UNLOCK_ROW_FAIL",Ir[Ir.LOCK_COL_FAIL=403200]="LOCK_COL_FAIL",Ir[Ir.UNLOCK_COL_FAIL=403300]="UNLOCK_COL_FAIL",Ir[Ir.LOCK_SHEET_FAIL=403400]="LOCK_SHEET_FAIL",Ir[Ir.UNLOCK_SHEET_FAIL=403500]="UNLOCK_SHEET_FAIL",Ir[Ir.SET_CHART_FAIL=403600]="SET_CHART_FAIL",Ir[Ir.DEL_CHART_FAIL=403700]="DEL_CHART_FAIL",Ir[Ir.UPGRADE_SNAPSHOT_FAIL=403800]="UPGRADE_SNAPSHOT_FAIL",Ir[Ir.ADD_CONDITIONAL_FORMAT_FAIL=403900]="ADD_CONDITIONAL_FORMAT_FAIL",Ir[Ir.SET_CONDITIONAL_FORMAT_FAIL=404e3]="SET_CONDITIONAL_FORMAT_FAIL",Ir[Ir.DEL_CONDITIONAL_FORMAT_FAIL=404100]="DEL_CONDITIONAL_FORMAT_FAIL",Ir[Ir.MOVE_CONDITIONAL_FORMAT_FAIL=404200]="MOVE_CONDITIONAL_FORMAT_FAIL",Ir[Ir.COVER_SNAPSHOT_FAIL=404300]="COVER_SNAPSHOT_FAIL",Ir[Ir.ADD_BLOCK_FAIL=404400]="ADD_BLOCK_FAIL",Ir[Ir.DEL_BLOCK_FAIL=404500]="DEL_BLOCK_FAIL",Ir[Ir.RESTORE_BLOCK_FAIL=404600]="RESTORE_BLOCK_FAIL",Ir[Ir.MOVE_RANGE_FAIL=404700]="MOVE_RANGE_FAIL",Ir[Ir.MOVE_RANGE_CONFLICT_SPAN=404701]="MOVE_RANGE_CONFLICT_SPAN",Ir[Ir.COVER_SHEET_FAIL=404800]="COVER_SHEET_FAIL";for(var Dr={},kr=0,Pr=[Rr,Cr];kr<Pr.length;kr++){var Fr,xr=Pr[kr];for(Fr in xr)Dr[Fr]={code:Number(Fr),message:xr[Fr]}}var Mr=function(e){function r(e,t){var n;return Ct()(this,r),(n=qn()(this,Jn()(r).call(this,e.message)))._extra=t,n._errCode=e.code,n._errMsg=e.message,n.name=n.constructor.name,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(Lr()(n),n.constructor):n.stack=new Error(e.message).stack,n}return Zn()(r,e),At()(r,[{key:"code",get:function(){return this._errCode}},{key:"message",get:function(){return this._errMsg}},{key:"extra",get:function(){return this._extra}}],[{key:"fromCode",value:function(e,t){return Dr[e]?new r(Dr[e],t):new r({code:e,message:"unknown code"},t)}}]),r}(wr()(Error));var jr="temp_";function Ur(e){return!!e&&e.startsWith(jr)}function Br(e,t){var n=Ur(t.view_id);return n?{action:o.ADD_VIEW,sheet_id:e,is_local:n,value:t}:{action:o.ADD_VIEW,sheet_id:e,value:t}}function Vr(e,t){var n=Ur(t.view_id);return n?{action:o.DEL_VIEW,sheet_id:e,is_local:n,value:t}:{action:o.DEL_VIEW,sheet_id:e,value:t}}function Hr(e,t){var n=Ur(t.view_id);return n?{action:o.SET_VIEW,sheet_id:e,is_local:n,value:t}:{action:o.SET_VIEW,sheet_id:e,value:t}}function Gr(e,t){var n=Ur(t.view_id);return n?{action:o.SET_FILTER_VIEW,sheet_id:e,is_local:n,value:t}:{action:o.SET_FILTER_VIEW,sheet_id:e,value:t}}function Wr(e,t){return{action:o.LOCAL_ACTIVE_VIEW,sheet_id:e,is_local:!0,value:{view_id:t}}}function Yr(e){return{action:o.LOCAL_DEACTIVE_VIEW,sheet_id:e,is_local:!0}}var Kr,zr,qr,Xr=n("LqQ0"),Jr=new Map([["COPYCONTENT",Xr.b.OperationType.OperationCopyContent],["EXPORT",Xr.b.OperationType.OperationFrontExport]]),Qr=function(){var e=new Xr.c({log:!1,appId:2,userId:Object(ar.default)(window.User,"id","")});return e.updateSharedParams({Module:Xr.b.ModuleType.ModuleSheets,Env:{Client:Xr.b.ClientType.ClientWeb,UA:window.navigator.userAgent,Flag:Xr.b.FlagType.FlagNormal}}),e},Zr=function(){var n=Mn()(Fn.a.mark(function e(t,n){var r,o,i,a;return Fn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($r())return e.abrupt("return");e.next=2;break;case 2:return r=window.User.id,o=void 0===r?"":r,e.prev=3,i=Kr=Kr||Qr(),a=Jr.get(t),e.next=8,i.auditEvent({Operation:a,Operator:{Type:Xr.b.EntityType.EntityUserID,Value:o},Objects:[{Type:Xr.b.EntityType.EntitySheetID,Value:n}]});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("collectToAdmin "+t,e.t0);case 13:case"end":return e.stop()}},e,null,[[3,10]])}));return function(e,t){return n.apply(this,arguments)}}(),$r=function(){var e="http:"===location.protocol,t=Object(ar.default)(window,"anonymousAccess.isAnonymousAccess",!1);return e||t},eo=n("Naly");function to(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=Kt(6),n=new Set(e);n.has(t);)t=Kt(6);return t}(qr=zr=zr||{})[qr.valid=0]="valid",qr[qr.invalid=1]="invalid",qr[qr.length=2]="length",qr[qr.repeat=3]="repeat";var no;no=0;function ro(e){return e&&oo(e[0])}function oo(e){return e&&"embed-image"===e.type&&e.width&&e.height}function io(e){return!!Array.isArray(e)&&e.some(function(e){return"url"===e.type})}function ao(n){return new Promise(function(e,t){setTimeout(e,n)})}var so=function(e,t){for(var n=0,r=e.length;n<r;n++)if("mention"===(i=e[n]).type&&0===i.mentionType)try{var o,i=JSON.parse(JSON.stringify(i));"function"==typeof t&&(o=t(i),e[n]=o)}catch(e){Rt.a.moirae.ravenCatch(e)}};function co(e,t){return[].concat(Gt()(e),Gt()(t))}function uo(e){var t,n,r=!1;return 1===e.length&&((t=e[0].action)===o.SET_SHEET?r=!1===(n=e[0].value).hidden&&"visibility"===n.property_name:t===o.MOVE_SHEET&&(r=!0)),r}var lo,fo,po=[],_o={},Eo=!1,ho=function(e){var t=["KEYBOARD_EDIT","TOOLKIT_EDIT","DROPDOWN_EDIT"],n=e.toUpperCase();return!!lo[n]&&!t.includes(n)},mo=Object(Vt.default)(function(){po.forEach(function(e){e&&e.apply(null)}),po.length=0},1e3);(fo=lo=lo||{}).LOAD_SHEET_PAGE="load_sheet_page",fo.RENDER_SHEET_PAGE="render_sheet_page",fo.CONNECT_WEBSOCKET="connect_websocket",fo.DOWNLOAD_RESOURCE="download_resource",fo.FETCH_CLIENT_VARS="fetch_client_vars",fo.UNGZIP_CLIENT_VARS="ungzip_client_vars",fo.APPLY_SNAPSHOT="apply_snapshot",fo.RENDER_FIRST_PRINT="render_first_print",fo.FETCH_SUB_BLOCK="fetch_sub_block",fo.FASTER_FIRST_TICK="faster_first_tick",fo.INIT_CALC="init_calc",fo.APPLY_DATA="apply_data",fo.KEYBOARD_EDIT="keyboard_edit",fo.TOOLKIT_EDIT="toolkit_edit",fo.DROPDOWN_EDIT="dropdown_edit",fo.TIME_TO_USAGE="time_to_usage",fo.STAGE_PENDING="stage_pending",fo.HISTORY_INIT="history_init",fo.HISTORY_PREVIEW="history_preview",fo.HISTORY_RECOVER="history_recover",fo.SHEET_LOADED="client_sheet_loaded",fo.SHEET_APPLY_CS="client_sheet_apply_cs",fo.TRANSLATION_ENTER="translation_enter",fo.TRANSLATION_RESET_LANG="translation_reset_lang",fo.GET_RESPONSABLE_RANGE="get_responsable_range",fo.LOAD_DOC_SHEET_RESOURCE="load_doc_sheet_resource",fo.CALL_BRIDGE_TO_MOUNT_SHEET="call_bridge_to_mount_sheet",fo.RENDER_EMBED_SHEET_COMP="render_embed_sheet_comp";var Oo,yo,go,vo,bo,To,Ro=function(e){return(e?performance:Date).now()};function So(){Eo=!1,_o={}}function Co(){return Eo?"reload":"router"}function Io(){"sheet"===Rt.a.getFileType()&&(Eo=!0)}function Ao(e,t){return e===Ve.C.CLIPBOARD_COPY||e===Ve.C.CLIPBOARD_PASTE||!(!t||t.parent_stage!==Ve.C.CLIPBOARD_COPY&&t.parent_stage!==Ve.C.CLIPBOARD_PASTE)}function Lo(r,e,o){var i=(o=o||{}).transactionId?"_".concat(o.transactionId):"";o.isSheetGarrEnable=Rt.a.isSheetGarrEnable?1:0;var t=r===lo.DOWNLOAD_RESOURCE||r===lo.RENDER_SHEET_PAGE||r===lo.LOAD_SHEET_PAGE||r===lo.TIME_TO_USAGE,a=r===lo.DOWNLOAD_RESOURCE,n=Ao(r,o),s=Ro(n),c=window;if(t)if(kn.a.isMobile){if(a&&(!c.renderStartTS||!c.tapVisitStartTS))return;o.open_from=500<=c.renderStartTS-c.tapVisitStartTS?"reload":"router"}else o.open_from=Eo?"reload":"router";var u,l=function(e){var t,n=_o["".concat(r,"_start").concat(i)];n&&(t=Math.round(s-n),t=o.costTime||(a&&c.tapVisitStartTS&&c.renderStartTS?c.renderStartTS-c.tapVisitStartTS:t),ho(r)?(po.push(function(){kt.collectSheetEvent("sheet_performance_operation",Object.assign({operation:"".concat(r,"_").concat(e)},o)),kt.collectSheetEvent("sheet_performance_stage",Object.assign({stage:r,type:e,time_cost:t},o))}),mo()):(kt.collectSheetEvent("sheet_performance_operation",Object.assign({operation:"".concat(r,"_").concat(e)},o)),kt.collectSheetEvent("sheet_performance_stage",Object.assign({stage:r,type:e,time_cost:t},o))),"error"===e&&console.info("[SHEET LOG] render-node-log: ".concat(r," error")),delete _o["".concat(r,"_start").concat(i)],Bt.logSceneEnd(r,!1,o))};e===Oo.START?(u=s,(t||a)&&(u=kn.a.isMobile&&c.tapVisitStartTS?c.tapVisitStartTS:Eo?performance.timing.fetchStart:s),_o["".concat(r,"_start").concat(i)]=u,ho(r)?(po.push(function(){kt.collectSheetEvent("sheet_performance_operation",Object.assign({operation:"".concat(r,"_start")},o))}),mo()):kt.collectSheetEvent("sheet_performance_operation",Object.assign({operation:"".concat(r,"_start")},o)),Bt.logSceneBegin(r,o)):e===Oo.END?l("success"):e===Oo.ERROR&&l("error")}(yo=Oo=Oo||{})[yo.START=0]="START",yo[yo.END=1]="END",yo[yo.ERROR=2]="ERROR",(vo=go=go||{}).DOC_IMAGE="doc_image",vo.DRIVE_IMAGE="drive_image",(To=bo=bo||{}).RESOLVED="resolved",To.REJECTED="rejected";var No,wo,Do,ko,Po,Fo,xo=function(){function t(e){Ct()(this,t),this.imageType=e,this._resolvedImageCount=0,this._totalTimeCost=0,this._rejectedImageCount=0,this.collectResolvedImagesInfoBatchly=Object(Vt.default)(this.collectResolvedImagesInfo,3e3),this.collectRejectedImagesInfoBatchly=Object(Vt.default)(this.collectRejectedImagesInfo,3e3)}return At()(t,[{key:"collectResolvedImagesInfo",value:function(){0!==this._resolvedImageCount&&(Rt.a.collectSuiteEvent("sheet_image_monitor",{status:bo.RESOLVED,image_type:this.imageType,count:this._resolvedImageCount,total_time_cost:this._totalTimeCost}),this._resolvedImageCount=0,this._rejectedImageCount=0)}},{key:"collectRejectedImagesInfo",value:function(){0!==this._rejectedImageCount&&(Rt.a.collectSuiteEvent("sheet_image_monitor",{status:bo.REJECTED,image_type:this.imageType,count:this._rejectedImageCount}),this._rejectedImageCount=0)}},{key:"collectImageError",value:function(e){Rt.a.imageHelper.collectImageError(e,{tags:{scm:JSON.stringify(window.scm),key:"SHEET_".concat(this.imageType.toUpperCase(),"_LOAD_FAIL")}})}},{key:"onImageResolve",value:function(e){var t=e.timeCost;this._totalTimeCost+=t,++this._resolvedImageCount,this.collectResolvedImagesInfoBatchly()}},{key:"onImageReject",value:function(e){var t=e.ex;++this._rejectedImageCount,this.collectImageError(t),this.collectRejectedImagesInfoBatchly()}}]),t}(),Mo=new xo(go.DOC_IMAGE),jo=new xo(go.DRIVE_IMAGE),Uo=new(function(){function e(){Ct()(this,e)}return At()(e,[{key:"setSnapshotSize",value:function(e){this.snapshotLen=e}},{key:"collectInitSheetInfo",value:function(e){if(void 0!==this.snapshotLen){var t=0,n=0,r=this.snapshotLen,o=e.snapshot.sheets;if(o){for(var i in o){var a=o[i];!a.externalResource&&a.blocks&&void 0!==a.rowCount&&void 0!==a.columnCount&&(t++,n+=a.rowCount*a.columnCount,a.blocks.forEach(function(e){e.size&&(r+=e.size)}))}Rt.a.moirae.teaLog({key:"collect_sheet_info",stage:"init",sheetNum:t,dataSize:jt(r),sheetCellNum:n})}}}}]),e}()),Bo=function(e){var n=e.sheet,t=0,r=0;if(n){var o=n.getSelections();if(Array.isArray(o)){var i=!0,a=!1,s=void 0;try{for(var c,u=o.values()[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var l=c.value;t+=l.rowCount()*l.colCount()}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}}e.commandName===Ve.i.FILL&&(r=n.getSelections().reduce(function(e,t){return e+n.getFormulaCountByRange(t)},0))}var d={time_cost:e.rangeTime,command_name:e.commandName,selected_cell_count:t,selection_formula_count:r,changeset_count:e.changesets.length};kt.collectSheetEvent("client_performance_command",d,n)},Vo=n("vYB2"),Ho=n.n(Vo),Go=3e4,Wo=function(){function t(){var e=this;Ct()(this,t),this.logStack=[],this.onSheetStartLoad=function(e){Lo(lo.SHEET_LOADED,Oo.START,{transactionId:e})},this.onBlockDataReady=function(){Lo(lo.FETCH_SUB_BLOCK,Oo.END)},this.validateBlockRequest=function(e,t){e.schema_version?t.some(function(e){return/[A..Z]$/.test(e)})&&Rt.a.moirae.teaLog({key:"client_sheet_sub_block_token_invalid",schema_version:e.schema_version||0}):t.some(function(e){return/[a..z]$/.test(e)})&&Rt.a.moirae.teaLog({key:"client_sheet_sub_block_token_invalid",schema_version:e.schema_version||0})},this.blockReqError=function(e,t){var n;if(e instanceof Error&&!Ho.a.isCancel(e)?n=e.message:(!e||e.code&&0!==e.code)&&(n=e||""),void 0!==n){var r={};return r.requestId=t,r.codeServer=(e||{}).code,r.msgServer=(e||{}).msg,r}},this.timer=setInterval(function(){e.uploadLog()},Go)}return At()(t,[{key:"log",value:function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logStack.push(JSON.stringify(t))}catch(e){console.error("args 存在非结构化对象")}}},{key:"uploadLog",value:function(){this.logStack.length&&Rt.a.moirae.teaLog({key:"client_sheet_block_data_tracker",bmLog:this.logStack.join("\n")}),this.logStack=[]}},{key:"clear",value:function(){0<this.logStack.length&&this.uploadLog(),this.timer&&clearInterval(this.timer),this.timer=void 0}},{key:"onSpreadLoaded",value:function(){this.clear()}},{key:"onInitError",value:function(e){this.log.apply(this,["onInitError"].concat(Array.prototype.slice.call(arguments)))}},{key:"onTaskDoneError",value:function(e){this.log.apply(this,["onTaskDoneError"].concat(Array.prototype.slice.call(arguments)))}},{key:"onFetchSubBlocksError",value:function(e){this.log.apply(this,["onFetchSubBlocksError"].concat(Array.prototype.slice.call(arguments)))}},{key:"onParseBlockOffsetError",value:function(e){this.log.apply(this,["onParseBlockOffsetError"].concat(Array.prototype.slice.call(arguments)))}},{key:"markSheetLoaded",value:function(e,t,n){this.log.apply(this,["markSheetLoaded"].concat(Array.prototype.slice.call(arguments)))}},{key:"onDestroy",value:function(){this.log.apply(this,["onDestroy"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRequestSheets",value:function(e){this.log.apply(this,["onRequestSheets"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRequestBlocks",value:function(e){this.log.apply(this,["onRequestBlocks"].concat(Array.prototype.slice.call(arguments)))}},{key:"onSetBlockRowCount",value:function(e,t){this.log.apply(this,["onSetBlockRowCount"].concat(Array.prototype.slice.call(arguments)))}},{key:"onSetBlockRowCountFail",value:function(){this.log.apply(this,["onSetBlockRowCountFail"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRowDataApplied",value:function(e,t){}},{key:"onRowDataAppliedFail",value:function(){this.log.apply(this,["onRowDataAppliedFail"].concat(Array.prototype.slice.call(arguments)))}},{key:"onDataApplied",value:function(e){this.log.apply(this,["onDataApplied"].concat(Array.prototype.slice.call(arguments)))}},{key:"onTaskCallback",value:function(e){this.log.apply(this,["onTaskCallback"].concat(Array.prototype.slice.call(arguments)))}},{key:"onSheetLoaded",value:function(e){this.log.apply(this,["onSheetLoaded"].concat(Array.prototype.slice.call(arguments)))}},{key:"onCandidateTasksNum",value:function(e){this.log.apply(this,["onCandidateTasksNum"].concat(Array.prototype.slice.call(arguments)))}},{key:"onPendingTaskCount",value:function(e){this.log.apply(this,["onPendingTaskCount"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRun",value:function(){this.log.apply(this,["onRun"].concat(Array.prototype.slice.call(arguments)))}},{key:"onInitBlock",value:function(e,t,n){this.log.apply(this,["onInitBlock"].concat(Array.prototype.slice.call(arguments)))}},{key:"onBlockRequesterStart",value:function(){this.log.apply(this,["onBlockRequesterStart"].concat(Array.prototype.slice.call(arguments)))}},{key:"onFetchStart",value:function(e,t,n,r){this.log.apply(this,["onFetchStart"].concat(Array.prototype.slice.call(arguments)))}},{key:"onTasksEnd",value:function(e,t,n){this.log.apply(this,["onTasksEnd"].concat(Array.prototype.slice.call(arguments)))}},{key:"onNoIdleTask",value:function(){this.log.apply(this,["onNoIdleTask"].concat(Array.prototype.slice.call(arguments)))}},{key:"onRunCandidateTask",value:function(e,t){this.log.apply(this,["onRunCandidateTask"].concat(Array.prototype.slice.call(arguments)))}},{key:"onAggregateTask",value:function(e){this.log.apply(this,["onAggregateTask"].concat(Array.prototype.slice.call(arguments)))}},{key:"onTaskDone",value:function(e,t,n){this.log.apply(this,["onTaskDone"].concat(Array.prototype.slice.call(arguments)))}},{key:"onAddTask",value:function(e,t){this.log.apply(this,["onAddTask"].concat(Array.prototype.slice.call(arguments)))}},{key:"onUpdateQueue",value:function(e,t){this.log("onUpdateQueue","queue: ".concat(e,", length: ").concat(t))}},{key:"onCancelApplyCS",value:function(e,t){this.log("onCancelApplyCS","cancelCount: ".concat(e,", remain: ").concat(t))}},{key:"onFollowError",value:function(e){this.log.apply(this,["onFollowError"].concat(Array.prototype.slice.call(arguments)))}},{key:"onBlockChannelNotReady",value:function(){this.log("onBlockChannelNotReady")}},{key:"onAnalysisActionSheetDep",value:function(e,t){this.log("onAnalysisActionSheetDep","depLength: ".concat(e," hasChannel: ").concat(t))}},{key:"onGetBackRefBySheetId",value:function(e){this.log.apply(this,["onGetBackRefBySheetId: "].concat(Array.prototype.slice.call(arguments)))}},{key:"destroy",value:function(){this.clear()}}]),t}();Wo.instance=new Wo,(wo=No=No||{})[wo.TRUE=1]="TRUE",wo[wo.FALSE=0]="FALSE",(ko=Do=Do||{}).DOC="DOC",ko.SHEET="SHEET",(Fo=Po=Po||{})[Fo.SUCCESS=0]="SUCCESS",Fo[Fo.NO_EXISTS=1]="NO_EXISTS",n.d(t,"a",function(){return o}),n.d(t,"ac",function(){return a}),n.d(t,"vb",function(){return c}),n.d(t,"w",function(){return l}),n.d(t,"sb",function(){return f}),n.d(t,"W",function(){return _}),n.d(t,"z",function(){return h}),n.d(t,"Bb",function(){return O}),n.d(t,"Ob",function(){return y}),n.d(t,"Fb",function(){return v}),n.d(t,"zb",function(){return T}),n.d(t,"Wb",function(){return S}),n.d(t,"E",function(){return I}),n.d(t,"gb",function(){return N}),n.d(t,"P",function(){return D}),n.d(t,"Q",function(){return P}),n.d(t,"O",function(){return x}),n.d(t,"Cb",function(){return j}),n.d(t,"Dd",function(){return ye}),n.d(t,"Gd",function(){return ge}),n.d(t,"Hd",function(){return ve}),n.d(t,"Id",function(){return be}),n.d(t,"Nd",function(){return Te}),n.d(t,"ab",function(){return B}),n.d(t,"ic",function(){return H}),n.d(t,"x",function(){return Y}),n.d(t,"lb",function(){return z}),n.d(t,"s",function(){return X}),n.d(t,"wb",function(){return Q}),n.d(t,"K",function(){return $}),n.d(t,"Z",function(){return te}),n.d(t,"Y",function(){return re}),n.d(t,"Gb",function(){return ie}),n.d(t,"k",function(){return Ne}),n.d(t,"n",function(){return Re}),n.d(t,"gc",function(){return Ae}),n.d(t,"h",function(){return we}),n.d(t,"bb",function(){return ke}),n.d(t,"mb",function(){return Fe}),n.d(t,"q",function(){return Me}),n.d(t,"Sb",function(){return Ke}),n.d(t,"T",function(){return We}),n.d(t,"tb",function(){return qe}),n.d(t,"ub",function(){return nt}),n.d(t,"Eb",function(){return Ze}),n.d(t,"Db",function(){return et}),n.d(t,"yb",function(){return st.a}),n.d(t,"Zb",function(){return st.c}),n.d(t,"Yb",function(){return st.b}),n.d(t,"H",function(){return rt}),n.d(t,"p",function(){return He}),n.d(t,"r",function(){return de}),n.d(t,"B",function(){return pe}),n.d(t,"cc",function(){return Ee}),n.d(t,"dc",function(){return me}),n.d(t,"i",function(){return lt.a}),n.d(t,"lc",function(){return lt.c}),n.d(t,"ce",function(){return lt.W}),n.d(t,"mc",function(){return lt.d}),n.d(t,"ae",function(){return lt.U}),n.d(t,"Wc",function(){return lt.E}),n.d(t,"Vc",function(){return lt.D}),n.d(t,"Ic",function(){return lt.s}),n.d(t,"Hc",function(){return lt.r}),n.d(t,"Jc",function(){return lt.t}),n.d(t,"Kc",function(){return lt.u}),n.d(t,"Mc",function(){return lt.w}),n.d(t,"Lc",function(){return lt.v}),n.d(t,"Ec",function(){return lt.o}),n.d(t,"Dc",function(){return lt.n}),n.d(t,"Fc",function(){return lt.p}),n.d(t,"Nc",function(){return lt.x}),n.d(t,"Pc",function(){return lt.z}),n.d(t,"Oc",function(){return lt.y}),n.d(t,"Gc",function(){return lt.q}),n.d(t,"md",function(){return lt.I}),n.d(t,"pd",function(){return lt.L}),n.d(t,"od",function(){return lt.K}),n.d(t,"uc",function(){return lt.l}),n.d(t,"vc",function(){return lt.m}),n.d(t,"oc",function(){return lt.e}),n.d(t,"nd",function(){return lt.J}),n.d(t,"pc",function(){return lt.f}),n.d(t,"Zd",function(){return lt.T}),n.d(t,"Wd",function(){return lt.Q}),n.d(t,"qd",function(){return lt.M}),n.d(t,"jc",function(){return lt.b}),n.d(t,"he",function(){return lt.cb}),n.d(t,"be",function(){return lt.V}),n.d(t,"fe",function(){return lt.ab}),n.d(t,"ge",function(){return lt.bb}),n.d(t,"Xd",function(){return lt.R}),n.d(t,"Yd",function(){return lt.S}),n.d(t,"de",function(){return lt.X}),n.d(t,"ee",function(){return lt.Y}),n.d(t,"Rc",function(){return lt.B}),n.d(t,"Sc",function(){return lt.C}),n.d(t,"Qc",function(){return lt.A}),n.d(t,"rc",function(){return lt.h}),n.d(t,"kb",function(){return ct}),n.d(t,"e",function(){return pt}),n.d(t,"yd",function(){return _t}),n.d(t,"td",function(){return Et}),n.d(t,"zd",function(){return ht}),n.d(t,"Ad",function(){return mt}),n.d(t,"Kd",function(){return Ot}),n.d(t,"Jd",function(){return yt}),n.d(t,"fb",function(){return gt}),n.d(t,"U",function(){return bt.a}),n.d(t,"Pb",function(){return Ve.O}),n.d(t,"c",function(){return Ve.a}),n.d(t,"db",function(){return Ve.y}),n.d(t,"bc",function(){return Ve.P}),n.d(t,"t",function(){return Ve.g}),n.d(t,"X",function(){return Ve.w}),n.d(t,"v",function(){return Ve.h}),n.d(t,"C",function(){return Ve.k}),n.d(t,"D",function(){return Ve.l}),n.d(t,"ib",function(){return Ve.A}),n.d(t,"f",function(){return Ve.b}),n.d(t,"jb",function(){return Ve.B}),n.d(t,"S",function(){return Ve.u}),n.d(t,"Ab",function(){return Ve.G}),n.d(t,"L",function(){return Ve.q}),n.d(t,"J",function(){return Ve.p}),n.d(t,"I",function(){return Ve.o}),n.d(t,"cd",function(){return Ve.R}),n.d(t,"dd",function(){return Ve.S}),n.d(t,"F",function(){return Ve.m}),n.d(t,"G",function(){return Ve.n}),n.d(t,"l",function(){return Ve.d}),n.d(t,"y",function(){return Ve.i}),n.d(t,"m",function(){return Ve.e}),n.d(t,"M",function(){return Ve.r}),n.d(t,"rb",function(){return Ve.E}),n.d(t,"qb",function(){return Ve.D}),n.d(t,"Hb",function(){return Ve.H}),n.d(t,"Lb",function(){return Ve.L}),n.d(t,"Jb",function(){return Ve.J}),n.d(t,"Kb",function(){return Ve.K}),n.d(t,"Nb",function(){return Ve.N}),n.d(t,"ob",function(){return Ve.C}),n.d(t,"R",function(){return Ve.t}),n.d(t,"j",function(){return Ve.c}),n.d(t,"V",function(){return Ve.v}),n.d(t,"o",function(){return Ve.f}),n.d(t,"ec",function(){return Ve.Q}),n.d(t,"xb",function(){return Ve.F}),n.d(t,"Ib",function(){return Ve.I}),n.d(t,"Mb",function(){return Ve.M}),n.d(t,"cb",function(){return Ve.x}),n.d(t,"A",function(){return Ve.j}),n.d(t,"hb",function(){return Ve.z}),n.d(t,"N",function(){return Ve.s}),n.d(t,"eb",function(){return Tt}),n.d(t,"Rb",function(){return Rt.a}),n.d(t,"Od",function(){return Bt}),n.d(t,"nb",function(){return lo}),n.d(t,"pb",function(){return Oo}),n.d(t,"Ud",function(){return So}),n.d(t,"Qd",function(){return Co}),n.d(t,"rd",function(){return Io}),n.d(t,"me",function(){return Lo}),n.d(t,"Uc",function(){return Mo}),n.d(t,"Xc",function(){return jo}),n.d(t,"je",function(){return Uo}),n.d(t,"ke",function(){return kt}),n.d(t,"sc",function(){return Bo}),n.d(t,"g",function(){return Wo}),n.d(t,"Tb",function(){return Po}),n.d(t,"jd",function(){return eo.b}),n.d(t,"kc",function(){return eo.a}),n.d(t,"Ub",function(){return zr}),n.d(t,"ad",function(){return to}),n.d(t,"vd",function(){return ro}),n.d(t,"wd",function(){return oo}),n.d(t,"ud",function(){return io}),n.d(t,"se",function(){return ao}),n.d(t,"pe",function(){return so}),n.d(t,"tc",function(){return co}),n.d(t,"le",function(){return uo}),n.d(t,"ld",function(){return Cn}),n.d(t,"yc",function(){return In}),n.d(t,"Td",function(){return Ln}),n.d(t,"oe",function(){return Nn}),n.d(t,"bd",function(){return Kt}),n.d(t,"Ld",function(){return un}),n.d(t,"Sd",function(){return dn}),n.d(t,"ne",function(){return fn}),n.d(t,"sd",function(){return pn}),n.d(t,"b",function(){return _n}),n.d(t,"Pd",function(){return bn}),n.d(t,"fc",function(){return Tn}),n.d(t,"Yc",function(){return Rn}),n.d(t,"Zc",function(){return Dn}),n.d(t,"nc",function(){return kn.a}),n.d(t,"Vd",function(){return Un}),n.d(t,"Cd",function(){return Bn}),n.d(t,"Fd",function(){return Vn}),n.d(t,"Md",function(){return Hn}),n.d(t,"Bd",function(){return Gn}),n.d(t,"Ed",function(){return Yn}),n.d(t,"gd",function(){return Kn}),n.d(t,"Vb",function(){return rr}),n.d(t,"qe",function(){return ur}),n.d(t,"re",function(){return tr}),n.d(t,"hc",function(){return fr}),n.d(t,"kd",function(){return hr}),n.d(t,"ie",function(){return mr}),n.d(t,"Tc",function(){return Or}),n.d(t,"ed",function(){return yr}),n.d(t,"xd",function(){return gr}),n.d(t,"Qb",function(){return vr}),n.d(t,"id",function(){return br}),n.d(t,"hd",function(){return Tr}),n.d(t,"u",function(){return Cr}),n.d(t,"d",function(){return Mr}),n.d(t,"qc",function(){return Zr}),n.d(t,"Xb",function(){return jr}),n.d(t,"fd",function(){return Ur}),n.d(t,"xc",function(){return Br}),n.d(t,"Ac",function(){return Vr}),n.d(t,"Cc",function(){return Hr}),n.d(t,"Bc",function(){return Gr}),n.d(t,"wc",function(){return Wr}),n.d(t,"zc",function(){return Yr}),n.d(t,"Rd",function(){return i})},iYz8:function(e,t,n){e.exports=n("FvEI")},k7EW:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return l});var r=n("rLED"),o=n("U6jp"),i=n("EyGs"),a=Object(o.j)("appVersion"),s=Object(r.N)("download_manager_least_version",""),c=Object(i.a)(a,s),u=Object(r.N)("native_download_manager_least_version",""),l=Object(r.I)("native_download_manager_enabled",!1)&&Object(i.a)(a,u)},"kVK+":function(e,t){t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,u=c>>1,l=-7,d=n?o-1:0,f=n?-1:1,p=e[t+d];for(d+=f,i=p&(1<<-l)-1,p>>=-l,l+=s;0<l;i=256*i+e[t+d],d+=f,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;0<l;a=256*a+e[t+d],d+=f,l-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),i-=u}return(p?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,c,u=8*i-o-1,l=(1<<u)-1,d=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,_=r?1:-1,E=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),2<=(t+=1<=a+d?f/c:f*Math.pow(2,1-d))*c&&(a++,c/=2),l<=a+d?(s=0,a=l):1<=a+d?(s=(t*c-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));8<=o;e[n+p]=255&s,p+=_,s/=256,o-=8);for(a=a<<o|s,u+=o;0<u;e[n+p]=255&a,p+=_,a/=256,u-=8);e[n+p-_]|=128*E}},lAOT:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s});var r=n("vYB2"),o=n.n(r),i=o.a.CancelToken,a=o.a.isCancel,s=o.a.Cancel},lBQb:function(e,me,Oe){"use strict";(function(i){Oe.d(me,"i",function(){return M}),Oe.d(me,"w",function(){return j}),Oe.d(me,"c",function(){return U}),Oe.d(me,"q",function(){return H}),Oe.d(me,"r",function(){return W}),Oe.d(me,"n",function(){return Y}),Oe.d(me,"x",function(){return K}),Oe.d(me,"y",function(){return z}),Oe.d(me,"o",function(){return q}),Oe.d(me,"v",function(){return X}),Oe.d(me,"u",function(){return J}),Oe.d(me,"t",function(){return Q}),Oe.d(me,"s",function(){return Z}),Oe.d(me,"e",function(){return $}),Oe.d(me,"h",function(){return ee}),Oe.d(me,"g",function(){return te}),Oe.d(me,"k",function(){return ne}),Oe.d(me,"j",function(){return re}),Oe.d(me,"m",function(){return oe}),Oe.d(me,"p",function(){return ie}),Oe.d(me,"d",function(){return ae}),Oe.d(me,"a",function(){return ce}),Oe.d(me,"b",function(){return ue}),Oe.d(me,"f",function(){return le}),Oe.d(me,"z",function(){return Ee}),Oe.d(me,"l",function(){return he});var e,t=Oe("RIqP"),o=Oe.n(t),n=Oe("lSNA"),s=Oe.n(n),r=Oe("o0o1"),l=Oe.n(r),a=Oe("yXPU"),c=Oe.n(a),u=Oe("3Hq1"),d=Oe("gSGL"),f=Oe("ZBlo"),p=Oe("yIs4"),_=Oe("7EGn"),E=Oe("ucr6"),h=Oe("QM+C"),m=Oe("Gp6W"),O=Oe("h6PB"),y=Oe("EVj1"),g=Oe("PCyy"),v=Oe("t6I4"),b=Oe("wd/R"),T=Oe.n(b),R=Oe("kUgE"),S=Oe("6omo"),C=Oe("Jonh"),I=Oe("Cdfq"),L=Oe("1a6t"),N=Oe("h6S9"),w=Oe("VI6H"),D=Oe("zhgJ"),k=Oe("po4q"),P=Oe("toa8"),F=Oe("Xngx"),x=Oe("AESI");function M(){var e=Object(y.m)(window.location.href).search,t=Object(y.l)(e);return t[g.a.OPEN_TEMPLATE_CENTER]?t:null}function j(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:location.href,t=Object(v.g)(e,[g.a.OPEN_TEMPLATE_CENTER,g.a.TEMPLATE_CATEGORY,g.a.TEMPLATE_OBJ_TYPE,g.a.TEMPLATE_TOPIC_ID,g.a.TEMPLATE_FROM_SOURCE]);t!==e&&E.a.replace(t)}T.a.locale(Object(R.getLanguage)());var U=function(e){if(e){var t=(new Date).getFullYear(),n=new Date(1e3*e).getFullYear()<t?"ll":Object(R.isEnLanguage)()?"MMM D":"MMMDo";return T()(1e3*e).format(n)}},B=Object.create(null),V=Object.create(null),H=function(){var t=c()(l.a.mark(function e(t){var n,r,o,i,a,s,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.obj_type,r=t.obj_token,o=t.fetchImgSrcManager,i=t.thumbnail,a=t.fetchType,s=t.uniqueId,r in V)return e.abrupt("return",V[r]);e.next=3;break;case 3:return e.next=5,Object(L.b)({uniqueId:s,fetchType:a,sourceForLog:h.FILE_PREVIEW_SOURCE_FOR_LOG.templateV2,token:r,type:n,fetchImgSrcManager:o,thumbnail:i});case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),W=function(){var t=c()(l.a.mark(function e(t){var n,r,o,i,a,s,c,u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.obj_type,r=t.obj_token,o=t.cover_token,i=t.fetchImgSrcManager,a=t.cdnUrl,s=t.fetchType,c=t.uniqueId,r in B)return e.abrupt("return",B[r]);e.next=3;break;case 3:return e.next=5,Object(L.b)({uniqueId:c,fetchType:s,sourceForLog:h.FILE_PREVIEW_SOURCE_FOR_LOG.templateV2,token:o,type:n,objToken:r,fetchImgSrcManager:i,cdnUrl:a,width:k.O,height:k.N});case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),Y=function(e){return V[e]},K=function(e,t){V[e]=t},z=function(e,t){B[e]=t},q=function(e){return B[e]},X=(e={},s()(e,h.NUM_SUITE_TYPE.DOC,m.a),s()(e,h.NUM_SUITE_TYPE.SHEET,O.a),s()(e,h.NUM_SUITE_TYPE.MINDNOTE,m.a),function(e,t){var n,r=e.categories,o=e.recents;return o&&(n=o.templates.map(function(e){return Object.assign({},e,{is_recent:!0})}),t||(C.g&&n.unshift({cover_token:"",cover_width:1,cover_height:2,name:i("template_v3_blank"),obj_type:h.NUM_SUITE_TYPE.MINDNOTE,obj_token:"",is_create_new:!0,id:0}),n.unshift({cover_token:"",cover_width:2,cover_height:1,name:i("template_v3_blank"),obj_type:h.NUM_SUITE_TYPE.SHEET,obj_token:"",is_create_new:!0,id:0}),n.unshift({cover_token:"",cover_width:1,cover_height:2,name:i("template_v3_blank"),obj_type:h.NUM_SUITE_TYPE.DOC,obj_token:"",is_create_new:!0,id:0})),r.unshift({category_id:o.category_id,name:i("template_v3_recommended"),templates:n,is_recent:!0})),r.forEach(function(e){Array.isArray(e.templates)&&(e.templates=e.templates.map(function(e){return Object.assign({},e,{is_sys:!0,can_share:C.e})}))}),r}),J=function(e){var n=Object(_.default)(e,"users")||{},t=(Object(_.default)(e,"own")||[]).map(function(e){return Object.assign({},e,{is_custom:!0,can_share:!0,can_delete:!0})}),r=(Object(_.default)(e,"share")||[]).map(function(e){var t=n[e.from_user_id]||{};return Object.assign({},e,{is_custom:!0,can_share:!0,can_delete:!0,from_user_name:Object(w.d)(t),from_user_avatar:t.avatar_url})});return[{category_id:S.c.OWN,name:i("explorer.v3.my_templates"),templates:t,type:"own"},{category_id:S.c.SHARE,name:i("explorer.v3.templates_shared"),templates:r,type:"share"}]},Q=function(e){var n=Object(_.default)(e,"users"),t=(Object(_.default)(e,"categories[0].templates")||[]).map(function(e){var t=n[e.from_user_id]||{};return Object.assign({},e,{is_corporate:!0,from_user_name:Object(w.d)(t),from_user_avatar:t.avatar_url})});return[{category_id:S.b.TENANT,name:i("explorer.v3.corporate_tenant"),templates:t,type:"tenant"}]},Z=function(e,r){return e.map(function(e,t){if("share"!==e.type)return e;var n=[].concat(o()(e.templates),o()(r[t].templates));return Object.assign({},e,{templates:n})})},$=function(t){var e=[S.e.ALL_TYPES,S.e.DOC,S.e.SHEET].concat(o()(C.g?[S.e.MINDNOTE]:[]));return Array.isArray(t)&&(e=e.filter(function(e){return t.includes(e)})),e.map(function(e){return{value:e,text:I.c[e]}})},ee=function(e,t){return(e=Number(e))in S.e?e:Array.isArray(t)?t[0]:S.f},te=function(e){return Object(u.default)(e)?k.a:Number(e)},ne=function(e){return e?{topic_id:e,title:""}:null},re=function(e,t,n){var r,o=(r={},s()(r,S.j.GALLERY,"Gallery"),s()(r,S.j.CUSTOM,"Custom"),s()(r,S.j.CORPORATE,"Enterprise"),r)[e],i=t===S.e.ALL_TYPES?"Default":"filter_file_type",a="";if(e===S.j.GALLERY&&(a=n===k.a?"Gallery_all":"".concat(n)),e===S.j.CUSTOM)switch(n){case k.a:a="Custom_all";break;case S.c.OWN:a="Custom_my_template";break;case S.c.SHARE:a="Custom_sharewithme"}return{primary_tab_type:o,primary_tab_Source:i,primary_sub_tab_Source:a}};function oe(t){var e="PGC",n=[{key:"is_create_new",type:"blank"},{key:"is_custom",type:"ugc"},{key:"is_recent",type:"recent"},{key:"is_corporate",type:"enterprise"}].find(function(e){return t[e.key]});return n?n.type:e}var ie=C.f&&Object(D.l)(),ae=function(e){var t="";return Object(p.default)(e)&&(t=1e4<=e?"".concat((e/1e4).toFixed(1),"W"):1e3<=e?"".concat((e/1e3).toFixed(1),"K"):"".concat(e)),i("template.heat.label",t)},se=function(e){return Promise.all(e.map(function(e){return e.then(function(e){return{status:"fulfilled",value:e}}).catch(function(e){return{status:"rejected",reason:e}})}))},ce=function(){var t=c()(l.a.mark(function e(t){var n,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(f.a)(t,k.p),e.next=3,se(n.map(function(e){return Object(P.d)({url:x.FETCH_BOX_FILE_CDN_URL,method:x.METHOD.POST,headers:{"Content-Type":"application/json"},data:e})}));case 3:return r=e.sent,o=function(e){return"fulfilled"===e.status},e.abrupt("return",r.filter(o).flatMap(function(e){return e.value.data||[]}).filter(function(e){return e.permitted}));case 6:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),ue=function(){var t=c()(l.a.mark(function e(c){var u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0<(u=c.flatMap(function(e){return e.templates.filter(function(e){var t=e.cover_token,n=e.display_type;return Boolean(t)&&n&&[S.n.WALLPAPER,S.n.SCREENSHOT].includes(n)})})).length)return e.delegateYield(l.a.mark(function e(){var t,n,r,o,i,a,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.map(function(e){return{file_token:e.cover_token,policy:N.a.NEAR,width:k.O,height:k.N}}),e.next=3,ce(t);case 3:if(!(0<(n=e.sent).length)){e.next=24;break}for(o=!(r=!0),i=void 0,e.prev=8,a=c[Symbol.iterator]();!(r=(s=a.next()).done);r=!0)s.value.templates.forEach(function(t){var e=n.find(function(e){return e.file_token===t.cover_token});e&&(t.cover_cdn_url=e)});e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),o=!0,i=e.t0;case 16:e.prev=16,e.prev=17,r||null==a.return||a.return();case 19:if(e.prev=19,o)throw i;e.next=22;break;case 22:return e.finish(19);case 23:return e.finish(16);case 24:case"end":return e.stop()}},e,null,[[8,12,16,24],[17,,19,23]])})(),"t0",3);e.next=3;break;case 3:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),le=function(e){var t=e.src,n=e.token,r=e.params;if(t||n){var o=t||Object(F.b)({fileToken:n});if(Object(d.a)(o)){var i=o.split("?")[0];return i?"".concat(i).concat(Object(y.d)(r)):""}}return""},de=function(){var e=c()(l.a.mark(function e(){var t,n,r,o,i,a=arguments;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<a.length&&void 0!==a[0]?a[0]:"web",n=T()(),e.next=4,Object(P.d)({url:x.POST_GET_USER_GUIDE,method:x.METHOD.POST,data:{type:t}});case 4:if(r=e.sent,o=Object(_.default)(r,"data.firstlogin",{}),i=T()(1e3*o.doc),n.isSame(i,"day"))return e.abrupt("return",!0);e.next=9;break;case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function fe(){return pe.apply(this,arguments)}function pe(){return(pe=c()(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de();case 2:return t=e.sent,e.next=5,Oe.e(11).then(Oe.bind(null,"nqTt"));case 5:n=e.sent,n.default.triggerEvent("TemplateNewLayoutV4_1",{userInfo:{old_or_new_user:t?"NEW_USER":"OLD_USER"}});case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var _e,Ee=function(e){_e&&clearTimeout(_e),(e.is_sys||e.is_create_new)&&(_e=setTimeout(function(){fe(),_e=null},5e3))},he=function(e,t){var n=e.is_sys,r=e.name,o=e.obj_token;return{template_name:n?r:"",token_new:n?o:"",template_category_name:t?t.name:"",template_category_id:t?t.category_id:""}}}).call(this,Oe("2vAP"))},mJXI:function(e,t,n){"use strict";n.d(t,"a",function(){return _});var s=n("Bw5p"),c=n("TYER"),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function d(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var i,f=(o(a,i=c.j),a.prototype.getVersionOfOversize=function(e){return e.version},a.prototype.getVersionOfChangeset=function(e){return e.version},a.prototype.getChangesets=function(e){return e.messages},a.prototype.getVersionOfClientVars=function(e){return e.version},a.prototype.getVersionOfAcceptCommit=function(e){return e.version},a.prototype.isSelfChangeset=function(){return!1},a);function a(e){var t=i.call(this,u(u({},e),{requestAPI:{CLIENT_VARS:"/api/msg_box/get_version",NEW_CHANGES:"/api/msg_box/get_message",USER_CHANGES:""}}))||this;return t.missVersionLimit=100,t}var p=(l.prototype.log=function(e,t){this.loggable&&console.log(this.prefix,e,t)},l.prototype.enable=function(){this.loggable=!0},l.prototype.disable=function(){this.loggable=!1},l);function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.loggable=!0,this.prefix="["+e.join("][")+"]"}var _=(E.prototype.destory=function(){this.sync&&this.sync.destroy(),this.messageCallbackSet.clear(),this.messageSubtypeCallbackMap.clear(),this.errorCallbackSet.clear()},E.prototype.getMessageCallbackSetSize=function(){return this.messageCallbackSet.size},E.prototype.isRegistered=function(){return!(!this.messageCallbackSet.size&&!this.messageSubtypeCallbackMap.size)},E.prototype.getErrorCallbackSetSize=function(){return this.errorCallbackSet.size},E);function E(e,t,n,r){var l=this;this.options=e,this.io=t,this.request=n,this.isNewProtocol=r,this.messageCallbackSet=new Set,this.messageSubtypeCallbackMap=new Map,this.errorCallbackSet=new Set,this.connect=function(){var e,t,n=l.options,r=l.io,o=l.request,i=n.token,a=n.version;l.sync=new f({token:i,io:r,type:c.d.MESSAGE_BOX,alias:((e={})[c.h.NEW_CHANGES]="GET_MESSAGE",e[c.h.CLIENT_VARS]="GET_VERSION",e),logger:n.resourceType?new p("DataJS","Sync",c.d.MESSAGE_BOX,null!=(t=n.resourceType)?t:""):new p("DataJS","Sync",c.d.MESSAGE_BOX),requestDataOptions:u(u({},Object(s.a)(n,["extra"])),{resource_type:n.resourceType}),requestWatchDataOptions:{route_type:n.routeType,route_key:n.routeKey},requestExceptWatchHeaderOptions:{"route-key":n.routeKey,"route-type":n.routeType},request:o,isNewProtocol:l.isNewProtocol}),l.sync.on(c.h.NEW_CHANGES,l.handleMessage),l.sync.on(c.h.ERROR,l.handleSyncError),void 0!==a?l.sync.setClientVars(a):l.sync.fetchClientVars()},this.register=function(e,t){var n,r=l.messageCallbackSet,o=l.messageSubtypeCallbackMap;t?((n=o.get(t))||(n=new Set,o.set(t,n)),n.add(e)):r.add(e)},this.deregister=function(e,t){var n,r=l.messageCallbackSet,o=l.messageSubtypeCallbackMap;t?(n=o.get(t))&&(n.delete(e),0===n.size&&o.delete(t)):r.delete(e)},this.onError=function(e){return l.errorCallbackSet.add(e),l.errorCallbackSet.size},this.removeErrorListener=function(e){return l.errorCallbackSet.delete(e),l.errorCallbackSet.size},this.handleMessage=function(e){var t,n,r=e.message,o=e.extra,i=e.sub_type;if(r){var a=i?l.messageSubtypeCallbackMap.get(i):l.messageCallbackSet;if(a)try{for(var s=d(a),c=s.next();!c.done;c=s.next()){var u=c.value;u&&u(r,o)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}},this.handleSyncError=function(e){var t,n;try{for(var r=d(l.errorCallbackSet),o=r.next();!o.done;o=r.next()){var i=o.value;i&&i(e)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},this.connect()}},mbpr:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n("lwsE"),o=n.n(r),i=n("W8MJ"),a=n.n(i),s=n("2ACu"),c=function(){function e(){o()(this,e),this.timeRecoder={},this.log={},this.notSendLog=!1}return a()(e,[{key:"setNotSendLog",value:function(e){this.notSendLog=e}},{key:"logStartTime",value:function(e){this.timeRecoder[e]=performance.now()}},{key:"logEndTime",value:function(e){this.log[e]=Math.round(performance.now()-this.timeRecoder[e])}},{key:"logValue",value:function(e,t){this.log[e]=t}},{key:"getLogValue",value:function(e){return this.log[e]}},{key:"getLog",value:function(){return this.log}},{key:"mergeLog",value:function(e){this.log=Object.assign({},this.log,{},e)}},{key:"sendLog",value:function(e,t){this.notSendLog||Object(s.default)(e,Object.assign({},t,{},this.log))}},{key:"clear",value:function(){this.timeRecoder={},this.log={}}}]),e}()},mhMO:function(e,t,n){e.exports=n("o4zr")},nc3P:function(e,n,r){"use strict";(function(i){r.d(n,"a",function(){return t});var e=r("o0o1"),a=r.n(e),s=r("vc5i"),c=r("hVE6"),u=r("9IUp"),l=r("oZtI"),d=r("dvZ7"),f=r("QM+C"),p=a.a.mark(t);function t(){var t,n,r,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.select)(c.a);case 2:return t=e.sent,e.next=5,Object(l.select)(s.n);case 5:if((n=e.sent)&&t&&t.name){e.next=8;break}return e.abrupt("return");case 8:if(r="",!t||!t.type){e.next=20;break}o=f.mapTypeToSuite[t.type.toLowerCase()],e.t0=o,e.next=e.t0===f.ImportType.DOC?14:e.t0===f.ImportType.SHEET?16:e.t0===f.ImportType.MINDNOTE?18:20;break;case 14:return r=i("common.docs_with_brand"),e.abrupt("break",20);case 16:return r=i("common.sheet_with_brand"),e.abrupt("break",20);case 18:return r=i("common.mindnote_with_brand"),e.abrupt("break",20);case 20:Object(u.a)({token:n,importText:r,file:{name:t.name,ext:t.type.toLowerCase()}}),Object(d.f)({action:"import_file",source:"headerbar"});case 22:case"end":return e.stop()}},p)}}).call(this,r("2vAP"))},ntxC:function(e,t,n){"use strict";var a=n("FUmc"),s=n("cSlR"),c=Array.prototype.splice;function r(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o,i=t[n];n!=r&&i===o||(o=i,Object(s.a)(i)?c.call(e,i,1):Object(a.a)(e,i))}return e}t.a=r},o4zr:function(e,t,n){n("Pkdo");var r=n("dktu").Object,o=e.exports=function(e,t,n){return r.defineProperty(e,t,n)};r.defineProperty.sham&&(o.sham=!0)},omim:function(e,u,l){"use strict";(function(e){l.d(u,"a",function(){return a}),l.d(u,"g",function(){return s}),l.d(u,"d",function(){return o}),l.d(u,"c",function(){return r}),l.d(u,"f",function(){return i}),l.d(u,"e",function(){return c});var t=l("iP/4"),n=l("k7EW");l.d(u,"b",function(){return n.a});var r=e||t.a.isLarkWindow,o=t.a.isLark&&!/electron/i.test(navigator.userAgent),i=e&&o&&n.b,a=!0;o?a=n.b:r&&(a=n.a);var s=r&&!n.a,c=!o&&e&&n.a}).call(this,l("kCIs"))},"p+lB":function(e,t,n){"use strict";var r,o=n("o0o1"),s=n.n(o),i=n("yXPU"),a=n.n(i),c=n("lwsE"),u=n.n(c),l=n("W8MJ"),d=n.n(l),f=n("4O8T"),p=n.n(f),_=n("R8bB"),E=n("lSNA"),h=n.n(E),m=(n("7EGn"),n("zhgJ"),n("2ACu")),O=(n("VQSS"),n("BAjd"),n("skFV"),n("QM+C")),y=n("JC8k"),g=n("5dbN"),v=n("1dfU");function b(e){var t=e.action,n=void 0===t?"":t,r=e.fileToken,o=void 0===r?"":r,i=e.fileName,a=void 0===i?"":i,s=e.taskCount,c=void 0===s?1:s,u=e.eventType,l=void 0===u?"mouseclick":u,d=e.result,f=void 0===d?"":d,p=Object(y.a)(a||""),_=Object(g.getCurrentRouteObj)();Object(m.default)("client_file_upload",{action:n,product_type:"drive",event_type:l,file_id:o?Object(v.a)(o):"",file_type:"file",sub_file_type:p,module:_&&_.module?_.module:"",sub_module:"upload_layer",task_count:c,result:f})}var T=(r={},h()(r,O.ImportType.DOC,O.docImportableTypes),h()(r,O.ImportType.SHEET,O.sheetImportableTypes),h()(r,O.ImportType.SHEET_EXCEL,O.sheetExcelImportableTypes),h()(r,O.ImportType.SHEET_CSV,O.sheetCSVImportableTypes),h()(r,O.ImportType.MINDNOTE,O.mindnoteImportableTypes),h()(r,O.ImportType.MARKDOWN,O.markdownImportableTypes),r);function R(e){return[{extensions:T[e]||O.importableTypes}]}var S=n("/KLm"),C=n("uJCm"),I=n("TtEC"),L=n("CQgL"),N=n("D7h9"),w=n("XMIC"),D=n("jryj");n.d(t,"a",function(){return k});var k=function(){function e(){var n=this;u()(this,e),this.importableFiles=new RegExp(".(".concat(L.c.join("|"),")$")),this.eventEmitter=new p.a,this.rust=_.a.getInstance(),this.rust.onReadyCallbacks.push(a()(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getInitialUploadData();case 2:t=e.sent,n.emit(C.f.TasksAdded,t);case 4:case"end":return e.stop()}},e)}))),this.rust.initPushEvents(this.eventEmitter,[C.f.TasksAdded,C.f.TaskRemoved,C.f.TasksChanged,C.f.SpeedChanged,C.f.SubtaskFailed,C.f.ShowTips]),this.rust.initWebviewEvents(this.eventEmitter),this.on(C.g.DragFiles,this.handleDragFile.bind(this))}function t(e,t,n){return r.apply(this,arguments)}var r;return d()(e,[{key:"on",value:function(e,t){this.eventEmitter.on(e,t)}},{key:"off",value:function(e,t){this.eventEmitter.off(e,t)}},{key:"emit",value:function(e,t){this.eventEmitter.emit(e,t)}},{key:"handleDragFile",value:function(e){this.filesToBeUploaded=e}},{key:"selectFileAndUpload",value:(r=a()(s.a.mark(function e(t,n,r){var o,i,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r?R(r):void 0,t)return e.next=4,this.rust.selectFolder();e.next=7;break;case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,this.rust.selectMultiFile(o);case 9:e.t0=e.sent;case 10:if(i=e.t0){e.next=13;break}return e.abrupt("return");case 13:return b({action:"native_trigger_upload_file",taskCount:i.length,eventType:"click"}),a=r?S.b.IMPORT:S.b.UPLOAD,e.abrupt("return",this.processTasksByPath(i,n,a));case 16:case"end":return e.stop()}},e,this)})),t)},{key:"processTasksByPath",value:function(t,n){var r=this,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:S.b.UPLOAD;if(e===S.b.UPLOAD){var o=t.some(function(e){return r.importableFiles.test(e)});if(!Object(I.d)()&&o)return N.default.dispatch(Object(w.c)(D.MODAL_TYPES.UPLOAD_FILES_IMPORT_CONFIRM,{files:t,callback:function(e){return r.uploadFiles(t,n,e)}}))}return this.uploadFiles(t,n,e)}},{key:"uploadFiles",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:S.b.UPLOAD;return this.filesToBeUploaded=[],this.rust.callApi(C.d.GeneralUpload,{paths:e,mountNodePoint:t||"",jobType:n||S.b.UPLOAD})}},{key:"getInitialUploadData",value:function(){return this.rust.callApi(C.d.GetUploadProcessList)}},{key:"retryAllFailedTasks",value:function(){return this.rust.callApi(C.d.RetryAllFailedUploadTasks)}},{key:"pauseAllUploadTasks",value:function(){return this.rust.callApi(C.d.PauseAllUploadTasks)}},{key:"retryAllPauseUploadTasks",value:function(){return this.rust.callApi(C.d.RetryAllPauseUploadTasks)}},{key:"retryUploadTask",value:function(e){return this.rust.callApi(C.d.RetryUploadTask,{uuid:e})}},{key:"pauseUploadTask",value:function(e){return this.rust.callApi(C.d.PauseUploadTask,{uuid:e})}},{key:"clearAllUploadTask",value:function(){return this.rust.callApi(C.d.ClearAllUploadTask)}},{key:"getFolderUploadErrorDetail",value:function(e){return this.rust.callApi(C.d.GetFolderUploadErrorDetail,{uuid:e})}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}()},p9vl:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("EzSe"),s=n("kUgE"),c=n("9+L6");function r(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=JSON.stringify({obj_token:t,obj_type:e}),o=n?c.b:c.y,i="".concat(o,"&params=").concat(encodeURIComponent(r),"&lang=").concat(Object(s.getLocale)());Object(a.b)(i)}},po4q:function(e,t,n){"use strict";n.d(t,"m",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"F",function(){return f}),n.d(t,"w",function(){return p}),n.d(t,"r",function(){return _}),n.d(t,"c",function(){return E}),n.d(t,"b",function(){return h}),n.d(t,"a",function(){return m}),n.d(t,"q",function(){return O}),n.d(t,"H",function(){return g}),n.d(t,"G",function(){return v}),n.d(t,"L",function(){return b}),n.d(t,"K",function(){return T}),n.d(t,"J",function(){return S}),n.d(t,"v",function(){return C}),n.d(t,"s",function(){return I}),n.d(t,"t",function(){return L}),n.d(t,"u",function(){return N}),n.d(t,"e",function(){return w}),n.d(t,"i",function(){return D}),n.d(t,"h",function(){return k}),n.d(t,"g",function(){return P}),n.d(t,"f",function(){return F}),n.d(t,"C",function(){return x}),n.d(t,"D",function(){return M}),n.d(t,"E",function(){return j}),n.d(t,"j",function(){return U}),n.d(t,"l",function(){return B}),n.d(t,"p",function(){return V}),n.d(t,"y",function(){return H}),n.d(t,"z",function(){return W}),n.d(t,"B",function(){return Y}),n.d(t,"n",function(){return K}),n.d(t,"x",function(){return z}),n.d(t,"O",function(){return q}),n.d(t,"N",function(){return X}),n.d(t,"A",function(){return J}),n.d(t,"o",function(){return Q}),n.d(t,"k",function(){return Z}),n.d(t,"I",function(){return $}),n.d(t,"M",function(){return ee});var r,o,i,a=n("MjSh"),s=n("qxQb"),c=n.n(s),u=n("QM+C"),l="create-by-template-new-layout",d="template-item-dropdown-menu",f="template-center-new-layout__container",p=99,_=1e3,E=15,h="0",m=-1,O=4,y=7,g=208,v=19,b=20,T=20,R=20,S=20,C=1438,I=1024,L=840,N=600,w=180,D=90,k=3,P=2e3,F=400,x=18,M=8,j=6,U=20,B="0",V=150,H=248,W=164,Y=6,K=4,z=4,q=480,X=480,J="TemplateCenter_SearchPlaceholder",Q=[u.NUM_SUITE_TYPE.DOC,u.NUM_SUITE_TYPE.SHEET],Z="\n  &::-webkit-scrollbar {\n    width: ".concat(y,"px;\n    height: 7px;\n  }\n  &::-webkit-scrollbar-button {\n    display: none;\n    height: 0;\n    width: 0;\n  }\n  &::-webkit-scrollbar-thumb {\n    border-radius: 7px;\n    background-color: ").concat(c()(a.N600,.3),";\n    &:hover {\n      background-color: ").concat(c()(a.N600,.5),";\n    }\n  }\n"),$=(r=[C,I],o=[19,18],i="\n    @media screen and (min-width: ".concat(C,"px) {\n      padding-left: ").concat(R,"px;\n    }"),r.forEach(function(e,t){i+="@media screen and (max-width: ".concat(e,"px) {\n      padding-left: ").concat(o[t],"px;\n      }")}),i),ee={category_id:m,name:"topic",templates:[]}},qMRW:function(e,t,n){"use strict";var r=n("xUlX");function o(e,t){return e&&e.length&&t&&t.length?Object(r.a)(e,t):e}t.a=o},qxQb:function(e,t,n){"use strict";var i=function(e){return"#"===e.charAt(0)?e.slice(1):e},a=function(e){var t=3===e.length||4===e.length;return{r:t?"".concat(e.slice(0,1)).concat(e.slice(0,1)):e.slice(0,2),g:t?"".concat(e.slice(1,2)).concat(e.slice(1,2)):e.slice(2,4),b:t?"".concat(e.slice(2,3)).concat(e.slice(2,3)):e.slice(4,6),a:(t?"".concat(e.slice(3,4)).concat(e.slice(3,4)):e.slice(6,8))||"ff"}},s=function(e){return parseInt(e,16)},c=function(e){var t=e.r,n=e.g,r=e.b,o=e.a;return{r:s(t),g:s(n),b:s(r),a:+(s(o)/255).toFixed(2)}},u=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},l=function(e,t){var n=e.r,r=e.g,o=e.b,i=e.a,a=u(t)?t:i;return"rgba(".concat(n,", ").concat(r,", ").concat(o,", ").concat(a,")")},r=function(e,t){var n=i(e),r=a(n),o=c(r);return l(o,t)};e.exports=r},t2s0:function(e,t,n){"use strict";n.d(t,"h",function(){return i}),n.d(t,"i",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"j",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"c",function(){return f}),n.d(t,"k",function(){return p}),n.d(t,"e",function(){return _}),n.d(t,"f",function(){return E}),n.d(t,"b",function(){return h});var r=n("7EGn"),o=n("rLED"),i=Object(o.e)("wiki_enabled"),a=function(e,t){return(!t||t.every(Boolean))&&i&&Object(o.e)(e)},s=Object(o.I)("wiki_relation_enabled",Boolean(Object(r.default)(window,"ssr_wikiEnable"))),c=a("wiki_advanced_search_enabled"),u=a("wiki_search_list_entrance"),l=a("create_wiki_in_space"),d=a("wiki_intergate_space_enabled"),f=a("wiki_copy_enabled"),p=a("wiki_space_setting_enable"),_=a("wiki_new_layout_enabled"),E=a("wiki_support_sheet_enabled",[_]),h=a("new_rename_ui_enabled",[_])},to9o:function(e,t,u){"use strict";u.r(t);var n=u("o0o1"),g=u.n(n),v=u("oZtI"),i=u("jp/M"),l=u("jryj"),a=u("nLXU"),d=u("/PhZ"),b=u("aR0j"),s=u("GIKb"),c=g.a.mark(f);function f(e){var t,n,r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(b.nb);case 2:if(t=e.sent,n=t.map(function(e){return e.get("link_token")||e.token}).toArray()){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Object(v.select)(b.lb);case 8:return r=e.sent,o=Object(s.a)(),e.next=12,Object(v.put)(Object(d.restoreRemovedFile)({urlType:o,spaceId:r,srcToken:n}));case 12:case"end":return e.stop()}},c)}var p=u("jJw9"),T=u("QM+C"),_=g.a.mark(E);function E(e){var t,n,r,o,i,a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(b.qb);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=t.type,r=t.obj_token,o=t.token,i=t.url,a=Object(p.processPathUrl)({objToken:r,token:o,type:n,url:i}),n===T.NUM_FILE_TYPE.ISV&&(a=i),window.open(a);case 9:case"end":return e.stop()}},_)}var r,o,h,m=u("dYgn"),O=u("lSNA"),y=u.n(O),R=u("vc5i"),S=u("2ACu"),C=u("snzu"),I=u("xKvl"),L=u("5dbN"),N=u("t2s0"),w=u("1dfU"),D=g.a.mark(U),k=function(e){switch(e){case a.c.NAVIGATION_BAR_DROPDOWN:return a.f.SUITE_HEADER_MENU;case a.c.EXPLORER_FILE_CONTEXT:return a.f.FILELIST_ITEM_STAR;default:return a.f.SUITE_HEADER_MENU}},P=(r={},y()(r,a.p.TOGGLE_PIN,[d.addPin,d.removePin]),y()(r,a.p.TOGGLE_STAR,[d.addStar,d.removeStar]),y()(r,a.p.TOGGLE_SUBSCRIBE,[d.subscribe,d.unsubscribe]),r),F=(o={},y()(o,a.p.TOGGLE_PIN,"is_pined"),y()(o,a.p.TOGGLE_STAR,"is_stared"),y()(o,a.p.TOGGLE_SUBSCRIBE,"is_subscribed"),o),x=(h={},y()(h,a.p.TOGGLE_PIN,"click_file_pin"),y()(h,a.p.TOGGLE_STAR,"click_file_star"),y()(h,a.p.TOGGLE_SUBSCRIBE,"click_file_subscribe"),h);function M(e,t){if(e===a.p.TOGGLE_STAR&&!0===t)return"click_file_cancel_star";var n=!0===t?"_cancel":"";return x[e]+n}function j(e){switch(e){case a.f.SUITE_HEADER_MENU:return"header";case a.f.FILELIST_ITEM_STAR:return"list_more";default:return}}function U(t){var n,r,o,i,a,s,c,u,l,d,f,p,_,E,h,m,O,y;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(v.select)(b.qb);case 3:return n=e.sent,e.next=6,Object(v.select)(b.pb);case 6:return r=e.sent,o=n.type,i=n.obj_token,a=n.token,s=n.wiki_token,d=t.payload.type,f=F[d],p=P[d],e.next=13,Object(v.select)(R.r);case 13:if(_=e.sent,"boolean"!=typeof(l=N.d&&Object(L.isUnderWikiIndex)()&&s&&null!==_&&_.wiki_token===s?(c=s,u=T.NUM_FILE_TYPE.WIKI,_[f]):(c=i,u=-1<T.folderType.indexOf(o)?T.NUM_FILE_TYPE.FOLDER:o,r[f])))return e.abrupt("return");e.next=17;break;case 17:if(E=M(d,l),h=I.c.getObjInfoByToken(a),0===E.indexOf("click_file_subscribe")&&(m="_cancel"===E.replace("click_file_subscribe","")?"remove_subscribe":"add_subscribe",E="client_content_management"),O=k(t.payload.menuType),Object(S.default)(E,Object.assign({},h,{source:j(O),action:m,module:C.a.module(),file_type:T.mapTypeNumToFileType[u],file_id:Object(w.a)(c)})),y=p[Number(l)]){e.next=25;break}return e.abrupt("return");case 25:return e.next=27,v.put.resolve(y({token:a,objToken:c,type:u,from:O}));case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(0),console.error(e.t0);case 32:case"end":return e.stop()}},D,null,[[0,29]])}var B=u("8LbN"),V=u("XMIC"),H=u("y94N"),W=u("Y0Lu"),Y=u("dvZ7"),K=g.a.mark(Q),z=g.a.mark(Z),q=g.a.mark($),X=g.a.mark(ee),J=g.a.mark(te);function Q(t){var n,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload.type,e.next=3,ee(t);case 3:return e.next=5,$(t);case 5:return r=e.sent,e.next=8,Object(v.put)(Object(V.c)(l.MODAL_TYPES[n],r||{}));case 8:case"end":return e.stop()}},K)}function Z(t){var n,r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t&&t.listName,e.next=3,Object(v.select)(b.n);case 3:return r=e.sent,e.next=6,Object(v.select)(b.qb);case 6:if(o=e.sent,n===H.p.Folder&&o)return e.abrupt("return",{fileToken:o.token});e.next=9;break;case 9:return e.abrupt("return",{fileToken:r});case 10:case"end":return e.stop()}},z)}function $(t){var n,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.payload.type,e.next=e.t0===a.d.MOVE||e.t0===a.d.COPY||e.t0===a.d.CLONE?3:e.t0===a.d.CREATE_BY_TEMPLATE?7:e.t0===a.d.CREATE_WIKI_IN_SPACE?15:16;break;case 3:return e.next=5,Z(t.payload);case 5:return n=e.sent,e.abrupt("return",n);case 7:if(Object(W.d)(t.payload.path)){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,te();case 11:if(r=e.sent){e.next=14;break}return e.abrupt("return",null);case 14:return e.abrupt("return",{targetToken:r});case 15:return e.abrupt("return",{source:"space"});case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}},q)}function ee(t){var n,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.payload.type){e.next=3;break}return e.abrupt("return");case 3:e.t0=n,e.next=e.t0===l.MODAL_TYPES.DETAIL?6:e.t0===l.MODAL_TYPES.RENAME?8:17;break;case 6:return Object(S.default)("client_content_management",{action:"file_within_info_page"}),e.abrupt("break",18);case 8:return e.next=10,Object(v.select)(b.pb);case 10:if(null===(r=e.sent))return e.abrupt("return");e.next=13;break;case 13:if(r.get("type")!==T.NUM_FILE_TYPE.FILE)return e.abrupt("return");e.next=15;break;case 15:return Object(Y.b)({action:"click_rename",fileToken:r.get("obj_token"),fileName:r.get("name")}),e.abrupt("break",18);case 17:return e.abrupt("return");case 18:case"end":return e.stop()}},X)}function te(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(b.qb);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",t.token);case 6:case"end":return e.stop()}},J)}var ne=u("hC3k"),re=u("jzcD"),oe=g.a.mark(ie);function ie(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(re.b);case 2:if(e.sent.status.translated)return e.next=6,Object(v.put)(Object(V.c)(l.MODAL_TYPES.HISTORY_CONFIRM));e.next=8;break;case 6:e.next=9;break;case 8:Object(ne.a)();case 9:case"end":return e.stop()}},oe)}var ae=u("1T6K"),se=g.a.mark(ce);function ce(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Object(S.collectSuiteEvent)("click_comment_history"),(t=Object(L.getCurrentRouteObj)())&&t.module===ae.routeModule.DRIVE&&Object(Y.a)({action:"view_history"});case 3:case"end":return e.stop()}},se)}var ue=u("ZSG8"),le=u("YsLn"),de=g.a.mark(fe);function fe(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(R.o);case 2:t=e.sent,e.t0=t,e.next=e.t0===T.NUM_FILE_TYPE.DOC?6:e.t0===T.NUM_FILE_TYPE.FILE?9:12;break;case 6:return e.next=8,Object(v.put)(Object(ue.r)(!0));case 8:return e.abrupt("return");case 9:return e.next=11,Object(v.put)(Object(le.h)(!0));case 11:return e.abrupt("return");case 12:return e.abrupt("break",13);case 13:case"end":return e.stop()}},de)}var pe=g.a.mark(_e);function _e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.put)(Object(le.d)(!0));case 2:case"end":return e.stop()}},pe)}var Ee=u("djbN"),he=u("hyzN"),me=g.a.mark(Oe);function Oe(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.put)(Object(Ee.a)({isExport:!0,fileType:he.M.CSV}));case 2:case"end":return e.stop()}},me)}var ye=g.a.mark(ge);function ge(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.put)(Object(Ee.a)({isExport:!0,fileType:he.M.XLSX}));case 2:case"end":return e.stop()}},ye)}var ve=u("vnAn"),be=g.a.mark(Te);function Te(e){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.put)(Object(ve.triggerFindReplace)({hotkeyName:null}));case 2:case"end":return e.stop()}},be)}var Re=u("EWn2"),Se=u("TtEC"),Ce=u("LaPx"),Ie=u("LCeV"),Ae=u("/DSa"),Le=u("WItK"),Ne=u("CQgL"),we=u("p+lB"),De=g.a.mark(Pe),ke=g.a.mark(Fe);function Pe(t){var n,o,r,i,a,s,c;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe(t);case 2:if(n=e.sent,o=n&&n.parentToken?n.parentToken:Object(Ie.a)(Object(L.getParentMeta)()),Le.b)return e.prev=5,e.next=8,we.a.getInstance().selectFileAndUpload(!1,o);e.next=15;break;case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),console.error("InvokeUploadFileSelector Error: ",e.t0);case 13:return Object(Ce.d)({action:"native_trigger_upload_file"}),e.abrupt("return");case 15:if(Le.a)return e.prev=16,e.next=19,Ae.b.getInstance().postMessage({type:Ae.c.InvokeUploadFileSelector,data:{parentToken:o,directory:!1}});e.next=26;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(16),console.error("InvokeUploadFileSelector Error: ",e.t1);case 24:return Object(Ce.d)({action:"lark_trigger_upload_file"}),e.abrupt("return");case 26:return e.prev=26,e.next=29,Object(v.call)(Re.g,{allowMultiple:!0});case 29:if(r=e.sent,i=r.event,a=r.files,!Object(Se.d)()&&Object(Ne.d)(a))return s=Object.assign({},n,{parentToken:o}),e.next=36,Object(v.put)(Object(V.c)(l.MODAL_TYPES.UPLOAD_FILES_IMPORT_CONFIRM,{files:a,event:i,uploadOptions:s}));e.next=38;break;case 36:e.next=42;break;case 38:return e.next=40,Object(v.select)(b.y);case 40:c=e.sent,Promise.all([u.e("commons--FilePicker--attachment_preview_modal--box-utils-upload-v2--box_index--doc_uploader_delay----afa6617f"),u.e("commons--box-utils-upload-v2--box_right_bar--doc_uploader_delay--lark-upload-progress-viewer--nativ--93a0e733"),u.e("box-utils-upload-v2")]).then(u.bind(null,"9k4S")).then(function(e){var t=e.getUploader,n=e.JobType,r=(0,e.getDirectoryTypeByParentToken)(c,o);t().loadFiles(a,i,{parentToken:o,directoryType:r,jobType:n.Upload,shouldAddToRecents:!0})});case 42:e.next=47;break;case 44:e.prev=44,e.t2=e.catch(26),console.error("File selection error:",e.t2);case 47:case"end":return e.stop()}},De,null,[[5,10],[16,21],[26,44]])}function Fe(t){var n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(W.d)(t.payload.path)){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,Object(v.select)(b.qb);case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",{parentToken:n.token});case 8:case"end":return e.stop()}},ke)}var xe=g.a.mark(je),Me=g.a.mark(Ue);function je(t){var n,o,i;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue(t);case 2:if(n=e.sent,o=n&&n.parentToken?n.parentToken:Object(Ie.a)(Object(L.getParentMeta)()),Le.b)return e.prev=5,e.next=8,we.a.getInstance().selectFileAndUpload(!0,o);e.next=15;break;case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),console.error("InvokeUploadFileSelector Error: ",e.t0);case 13:return Object(Ce.d)({action:"native_trigger_upload_folder"}),e.abrupt("return");case 15:if(Le.a)return e.prev=16,e.next=19,Ae.b.getInstance().postMessage({type:Ae.c.InvokeUploadFileSelector,data:{parentToken:o,directory:!0}});e.next=27;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(16),console.error("InvokeUploadFileSelector Error: ",e.t1);case 24:Object(Ce.d)({action:"lark_trigger_upload_folder"}),e.next=31;break;case 27:return e.next=29,Object(v.select)(b.y);case 29:i=e.sent,Promise.all([u.e("commons--FilePicker--attachment_preview_modal--box-utils-upload-v2--box_index--doc_uploader_delay----afa6617f"),u.e("commons--box-utils-upload-v2--box_right_bar--doc_uploader_delay--lark-upload-progress-viewer--nativ--93a0e733"),u.e("box-utils-upload-v2")]).then(u.bind(null,"9k4S")).then(function(e){var t=e.triggerDirectoryUploadV2,n=e.JobType,r=(0,e.getDirectoryTypeByParentToken)(i,o);t({parentToken:o,directoryType:r,jobType:n.Upload})});case 31:case"end":return e.stop()}},xe,null,[[5,10],[16,21]])}function Ue(t){var n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(W.d)(t.payload.path)){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,Object(v.select)(b.qb);case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",{parentToken:n.token});case 8:case"end":return e.stop()}},Me)}var Be=u("7EGn"),Ve=u("G8Hj"),He=u("SGN9"),Ge=g.a.mark(We);function We(t){var n,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(He.a)(Ve.STEP_TYPES.add_existed_docs),n=Object(Be.default)(t,"payload.subScenario"),r={subScenario:n},e.next=5,Object(v.put)(Object(V.c)(l.MODAL_TYPES.OPEN_FILE_PICKER,r));case 5:case"end":return e.stop()}},Ge)}var Ye=u("TM+l"),Ke=g.a.mark(qe);function ze(e){return e&&e.size?e.map(function(e){var t=e.get("type");return{token:t===T.NUM_FOLDER_TYPE.FOLDER?e.get("token"):e.get("obj_token"),type:t,name:e.get("name")}}).toArray():[]}function qe(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(b.nb);case 2:if((t=e.sent)&&t.size){e.next=5;break}return e.abrupt("return");case 5:if(Object(L.locateRoute)().isFile)return e.next=8,Object(v.put)(Object(le.i)(!0));e.next=10;break;case 8:e.next=11;break;case 10:Object(Ye.b)(ze(t));case 11:Object(Y.f)({action:"download",source:"headerbar_more"});case 12:case"end":return e.stop()}},Ke)}var Xe=u("aXiW"),Je=g.a.mark(Qe);function Qe(e){var t,n,r,o,i;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(b.pb);case 2:return t=e.sent,e.next=5,Object(v.select)(b.qb);case 5:if(n=e.sent,t){e.next=8;break}return e.abrupt("return");case 8:return r=t.get("type"),o=t.get("obj_token"),i="".concat(r,":").concat(o),e.next=13,Object(v.put)(Object(d.removeRecommendedFile)(o));case 13:return e.next=15,Object(v.put)(Object(d.markFileAsUninterested)(i));case 15:if(n){e.next=17;break}return e.abrupt("return");case 17:Object(Xe.a)("client_recommend").report({action:"not_interested",sub_module:"recommended_pin",index:n.initIndex,request_id:n.requestId,file_type:r,file_id:o});case 18:case"end":return e.stop()}},Je)}var Ze=g.a.mark($e);function $e(e){var t,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(b.pb);case 2:return t=e.sent,e.next=5,Object(v.select)(b.qb);case 5:if(n=e.sent,t){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,Object(v.put)(Object(d.addPin)({objToken:t.get("obj_token"),token:t.get("token"),type:t.get("type")}));case 10:if(n){e.next=12;break}return e.abrupt("return");case 12:Object(Xe.a)("client_recommend").report({action:"pin",sub_module:"recommended_pin",index:n.initIndex,request_id:n.requestId,file_type:t.get("type"),file_id:t.get("obj_token")});case 13:case"end":return e.stop()}},Ze)}var et=u("p9vl"),tt=g.a.mark(nt);function nt(){var t,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(R.o);case 2:return t=e.sent,e.next=5,Object(v.select)(R.n);case 5:n=e.sent,Object(et.a)(t,n,T.isAnonymousAccess);case 7:case"end":return e.stop()}},tt)}var rt=u("xXG4"),ot=u("OX8E"),it=u("sLU5"),at=u("fco7"),st=g.a.mark(ct);function ct(t){var n,r,o,i,a,s,c;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload.type,e.next=3,Object(v.select)(re.b);case 3:if((r=e.sent).status.translating)return e.abrupt("return");e.next=6;break;case 6:if(r.status.translated)return e.abrupt("return",ft(n));e.next=8;break;case 8:return e.next=10,Object(v.select)(R.f);case 10:if(o=e.sent,i=o.get("obj_token"),a=o.get("type"),s="menu_entrance",lt(c=ut(n)))return e.next=18,Object(v.put)(Object(rt.e)({target_lang:c}));e.next=20;break;case 18:return e.next=20,Object(v.put)(Object(rt.d)(!0,{token:i,type:a,targetLang:c}));case 20:return ot.a.emit(it.a.PC.COMMON.CLICK_TRANSLATE_MENU,{action:s,targetLang:c}),e.abrupt("return",null);case 22:case"end":return e.stop()}},st)}function ut(e){return e.substr(-2).toLocaleLowerCase()}function lt(e){return at.a.langs.includes(e)}var dt="translation_menu";function ft(e){if(e===l.MenuActionType.TRANSLATE_BACK_ORIGIN)return ot.a.emit(it.a.PC.COMMON.CLOSE_TRANSLATE,dt);if(e===l.MenuActionType.TRANSLATE_SETTING)return ot.a.emit(it.a.PC.COMMON.OPEN_TRANSLATE_SETTING,{source:dt});var t=ut(e);return lt(t)?ot.a.emit(it.a.PC.COMMON.TRANSLATE_CHANGE_LANG,{key:t},dt):null}var pt=u("nYlk"),_t=g.a.mark(Et);function Et(t){var n,r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",Object(W.d)(t.payload.path))return e.next=4,Object(v.select)(b.qb);e.next=8;break;case 4:(r=e.sent)&&(n=r.token),e.next=12;break;case 8:return e.next=10,Object(v.select)(b.m);case 10:o=e.sent,Object(L.locateRoute)().isFolder&&o&&(n=o);case 12:return e.next=14,Object(v.put)(Object(V.c)(i.ui.MODAL_TYPES.IMPORT_CENTER,{parentToken:n}));case 14:return e.next=16,Object(v.put)(Object(pt.m)(!1,!1));case 16:case"end":return e.stop()}},_t)}var ht=u("nyid"),mt=u("eoP6"),Ot=u("Z/YB"),yt=u("/Rq9"),gt=u("vfWA"),vt=g.a.mark(bt);function bt(e){var t,n,r,o,i,a,s,c,u,l,d,f;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(b.qb);case 2:return t=e.sent,e.next=5,Object(v.select)(ht.b);case 5:return n=e.sent,e.next=8,Object(v.select)(b.y);case 8:if(r=e.sent,t){e.next=11;break}return e.abrupt("return");case 11:o=t.token,i=r.get(o),a=n[o],void 0!==(s=a===mt.k.NOT_SYNCED?gt.SyncOption.SYNC:gt.SyncOption.CANCEL)&&(c=Object(yt.a)(i),u=c.spaceType,l=c.module,Object(yt.r)(o,s,u).then(function(e){}).catch(function(e){console.error("handleSyncToLocalClick:",o,s,e),Object(S.default)("sync_core_api_err",{api_name:"setFolderSync".concat(s===gt.SyncOption.CANCEL?"Cancel":""),error_type:e.errCode,file_id:Object(w.a)(o),module:l})}),d=mt.k.SYNC_PENDING,s===gt.SyncOption.CANCEL&&(d=mt.k.NOT_SYNCED),Object(Ot.j)({statusList:[{token:o,syncStatus:d}]}),f=window.User,Object(S.default)("client_file_sync",{action:s===gt.SyncOption.SYNC?"sync":"sync_cancel",source:"file_item_op",file_id:o?Object(w.a)(o):"",file_type:"folder",module:l,is_owner:i.owner_id===f.id?"yes":"no"}));case 16:case"end":return e.stop()}},vt)}var Tt=u("ucr6"),Rt=g.a.mark(St);function St(e){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Tt.a.push(ae.URL.TRASH);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}},Rt,null,[[0,5]])}var Ct=u("FFjf"),It=g.a.mark(At);function At(e){var t,n,r,o,i;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(v.select)(b.pb);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:return n=t.get("token"),r=!0===t.get("is_hidden")?d.showShareFolder:d.hideShareFolder,e.next=10,Object(v.put)(r(n));case 10:return o=!0===t.get("is_hidden")?"click_show_share_folder":"click_hide_share_folder",e.next=13,Object(v.select)(Ct.b);case 13:i=e.sent,Object(S.default)(o,{listName:i,source:"more"}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0);case 20:case"end":return e.stop()}},It,null,[[0,17]])}var Lt=g.a.mark(Nt);function Nt(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.put)(Object(d.triggerHandleDeleteOrRemoveFile)());case 2:case"end":return e.stop()}},Lt)}var wt=u("yXPU"),Dt=u.n(wt),kt=u("8sqB"),Pt=u("D7h9");function Ft(){return xt.apply(this,arguments)}function xt(){return(xt=Dt()(g.a.mark(function e(){var t,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(kt.f)();case 2:t=e.sent,n=t.actions.toggleSubscribe,Pt.default.dispatch(n());case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Mt=g.a.mark(jt);function jt(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ot.a.emit(it.a.PC.DRIVE.OPEN_VERSION_MODAL);case 1:case"end":return e.stop()}},Mt)}var Ut=u("/rwt"),Bt=u("nc3P"),Vt=g.a.mark(Ht);function Ht(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.put)(Object(V.c)(l.MODAL_TYPES.APPLY_EDIT_PERMISSION));case 2:Object(S.collectSuiteEvent)("click_authority_apply_btn",{source:"more"});case 3:case"end":return e.stop()}},Vt)}var Gt=u("MUo5"),Wt=g.a.mark(Yt);function Yt(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.select)(b.qb);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Object(v.put)(Object(Gt.leaveTeamSpace)(t.token));case 7:case"end":return e.stop()}},Wt)}var Kt=g.a.mark(Jt),zt=g.a.mark(Qt);function qt(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return e===a.p.DELETE||e===a.p.REMOVE?a.p.DELETE_OR_REMOVE:e}function Xt(e){var t=qt(t=(n=e.payload).type),n=Object.assign({},n,{type:t});return Object.assign({},e,{payload:n})}function Jt(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.takeEvery)([i.actionTypes.ui.CLICK_CONTEXTMENU_ITEM,i.actionTypes.ui.CLICK_DROPDOWNMENU_ITEM],Qt);case 2:case"end":return e.stop()}},Kt)}function Qt(t){var n,r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.payload,r=n.menuType,o=n.type,a.c.NAVIGATION_BAR_DROPDOWN===r&&(t=Xt(t),o=t.payload.type),o!==a.p.CREATE_BY_TEMPLATE&&-1<l.modalTypesArr.indexOf(o))return e.next=7,Q(t);e.next=8;break;case 7:return e.abrupt("return");case 8:if(-1<a.x.indexOf(o))return e.next=11,U(t);e.next=12;break;case 11:return e.abrupt("return");case 12:if(o.includes(a.p.TRANSLATE))return e.next=15,ct(t);e.next=16;break;case 15:return e.abrupt("return");case 16:e.t0=o,e.next=e.t0===a.p.OPEN_NEW_TAB?19:e.t0===a.p.COPY_LINK?22:e.t0===a.p.CREATE||e.t0===a.p.CREATE_DOC||e.t0===a.p.CREATE_SHEET||e.t0===a.p.CREATE_SLIDE||e.t0===a.p.CREATE_BITABLE||e.t0===a.p.CREATE_MINDNOTE||e.t0===a.p.CREATE_BY_TEMPLATE||e.t0===a.p.CREATE_SUB_FOLDER||e.t0===a.p.CREATE_ISV?25:e.t0===a.p.OPEN_IMPORT_CENTER?28:e.t0===a.p.UPLOAD_FILE?31:e.t0===a.p.UPLOAD_FOLDER?34:e.t0===a.p.ADD_FILE?37:e.t0===a.p.DOWNLOAD?40:e.t0===a.p.DELETE_OR_REMOVE||e.t0===a.p.REMOVE_RECORD||e.t0===a.p.COMPLETE_DELETE?43:e.t0===a.p.RESTORE?46:e.t0===a.p.HISTORY_VERSION?49:e.t0===a.p.HISTORY?52:e.t0===a.p.COMMENT_HISTORY?55:e.t0===a.p.PRINT?58:e.t0===a.p.FIND?61:e.t0===a.p.EXPORT_CSV?64:e.t0===a.p.EXPORT_XLSX?67:e.t0===a.p.FIND_REPLACE?70:e.t0===a.p.NOT_INTEREST?73:e.t0===a.p.REPORT_ABUSE?76:e.t0===a.p.PIN_RECOMMENDED_FILE?79:e.t0===a.p.SYNC_TO_LOCAL?82:e.t0===a.p.TO_TRASH_RESTORE?85:e.t0===a.p.TOGGLE_SHARED_FOLDER_VISIBLE?88:e.t0===a.p.TOGGLE_SUBSCRIBE_WIKI?91:e.t0===a.p.ONLINE_EDIT?94:e.t0===a.p.IMPORT_DOC||e.t0===a.p.IMPORT_SHEET?97:e.t0===a.p.APPLY_EDIT_PERMISSION?100:e.t0===a.p.LEAVE_TEAM_SPACE?103:106;break;case 19:return e.next=21,E(t);case 21:return e.abrupt("break",107);case 22:return e.next=24,Object(m.a)(t);case 24:return e.abrupt("break",107);case 25:return e.next=27,Object(B.b)(t);case 27:return e.abrupt("return",e.sent);case 28:return e.next=30,Et(t);case 30:return e.abrupt("break",107);case 31:return e.next=33,Pe(t);case 33:return e.abrupt("break",107);case 34:return e.next=36,je(t);case 36:return e.abrupt("break",107);case 37:return e.next=39,We(t);case 39:return e.abrupt("break",107);case 40:return e.next=42,qe();case 42:return e.abrupt("break",107);case 43:return e.next=45,Nt();case 45:return e.abrupt("break",107);case 46:return e.next=48,f(t);case 48:return e.abrupt("break",107);case 49:return e.next=51,jt();case 51:return e.abrupt("break",107);case 52:return e.next=54,ie();case 54:return e.abrupt("break",107);case 55:return e.next=57,ce();case 57:return e.abrupt("break",107);case 58:return e.next=60,fe();case 60:return e.abrupt("break",107);case 61:return e.next=63,_e();case 63:return e.abrupt("break",107);case 64:return e.next=66,Oe();case 66:return e.abrupt("break",107);case 67:return e.next=69,ge();case 69:return e.abrupt("break",107);case 70:return e.next=72,Te(t);case 72:return e.abrupt("break",107);case 73:return e.next=75,Qe(t);case 75:return e.abrupt("break",107);case 76:return e.next=78,nt();case 78:return e.abrupt("break",107);case 79:return e.next=81,$e(t);case 81:return e.abrupt("break",107);case 82:return e.next=84,bt(t);case 84:return e.abrupt("break",107);case 85:return e.next=87,St(t);case 87:return e.abrupt("break",107);case 88:return e.next=90,At(t);case 90:return e.abrupt("break",107);case 91:return e.next=93,Ft();case 93:return e.abrupt("break",107);case 94:return e.next=96,Object(Ut.a)();case 96:return e.abrupt("break",107);case 97:return e.next=99,Object(Bt.a)();case 99:return e.abrupt("break",107);case 100:return e.next=102,Ht();case 102:return e.abrupt("break",107);case 103:return e.next=105,Yt();case 105:case 106:return e.abrupt("break",107);case 107:case"end":return e.stop()}},zt)}var Zt=u("3b8Q"),$t=u("rLED"),en=g.a.mark(nn),tn=g.a.mark(rn);function nn(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.takeEvery)(i.actionTypes.ui.RIGHT_CLICK_FILE_LIST_ITEM,rn);case 2:case"end":return e.stop()}},en)}function rn(t){var n,r,o,i,a,s,c;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=t.payload.file){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Object(v.select)(b.mb);case 6:if(r=e.sent,o=1<r.size,i=r.find(function(e){var t=T.suiteType.includes(e.type)?"obj_token":"token";return e[t]===n.get(t)&&e.checkedInList}),o&&i)return e.abrupt("return");e.next=11;break;case 11:if(Object($t.kb)())return a=Object(Zt.a)(n,!1),s=a.obj_token,c=a.type,e.next=15,Object(v.put)(Object(d.fetchSubscribeStatus)({objToken:s,objType:c}));e.next=15;break;case 15:return e.next=17,Object(v.put)(Object(d.setSelectedFileMetas)([Object(Zt.a)(n,!1)]));case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0);case 22:case"end":return e.stop()}},tn,null,[[0,19]])}var on=u("xiBh"),an=g.a.mark(sn);function sn(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.all)([Object(v.fork)(Jt),Object(v.fork)(nn),Object(v.fork)(on.b)]);case 2:case"end":return e.stop()}},an)}function cn(){return{id:"ui-control",sagas:[sn]}}u.d(t,"getUiControlModule",function(){return cn})},"u+ON":function(e,t,n){"use strict";var r=n("pevS"),o=n("Y4Ys").indexOf,i=n("M5eE"),a=[].indexOf,s=!!a&&1/[1].indexOf(1,-0)<0,c=i("indexOf");r({target:"Array",proto:!0,forced:s||c},{indexOf:function(e){return s?a.apply(this,arguments)||0:o(this,e,1<arguments.length?arguments[1]:void 0)}})},vLSA:function(e,t,n){n("KgqQ"),n("b4mI"),n("Pkew"),n("UUWy");var r=n("dktu");e.exports=r.Map},vfRR:function(e,t,n){"use strict";var r=n("pevS"),o=n("3uAa").find,i=n("xE4W"),a="find",s=!0;a in[]&&Array(1)[a](function(){s=!1}),r({target:"Array",proto:!0,forced:s},{find:function(e){return o(this,e,1<arguments.length?arguments[1]:void 0)}}),i(a)},wCm6:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("gSGL"),o=n("toa8"),i=function(e){var t=Boolean(e.ignoreInterceptors),n=Math.max(e.url.indexOf("/api"),0);return e.url=e.url.substring(n),Object(o.d)(Object.assign({},e,{headers:Object.assign({"Content-Type":"application/json"},e.headers),ignoreInterceptors:t})).then(function(e){return t?e:{data:Object(r.a)(e.data)?e.data:e}}).catch(function(e){throw e.originalError||e})}},wH0k:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("iP/4"),o=a.a,r={setData:function(e,t){var n=t.text,r=t.html;(n||r)&&(o.modernIE?e.setData("text",r):(e.setData("text/html",r),e.setData("text/plain",n)))},getData:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"text/html";return o.modernIE?e.getData("text"):e.getData(t)},setDataWithoutEvent:function(i){function e(e){e.preventDefault(),e.stopImmediatePropagation&&e.stopImmediatePropagation();var t=i.html,n=void 0===t?"":t,r=i.text;document.createElement("div").innerHTML=n;var o=e.clipboardData||window.clipboardData;a.a.modernIE?o.setData("text",n||r):(o.setData("text/html",n),o.setData("text/plain",r))}var t=document.createElement("textarea");document.body.appendChild(t),document.addEventListener("copy",e),t.style.opacity="0",t.value=" ",t.focus({preventScroll:!0}),t.select(),document.execCommand("copy"),document.removeEventListener("copy",e),document.body.removeChild(t)}}},we6V:function(e,t,n){"use strict";n.d(t,"a",function(){return E});var r=n("o0o1"),o=n.n(r),i=n("yXPU"),a=n.n(i),s=n("lwsE"),c=n.n(s),u=n("W8MJ"),l=n.n(u),d=n("nN3d"),f=n("OX8E"),p=n("sLU5"),_=n("2spZ"),E=function(){function e(){var r=this;c()(this,e),this.EventResolveMap=null,this.handleWPSSaveResult=function(){var t=a()(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.uuid&&r.EventResolveMap){e.next=2;break}return e.abrupt("return");case 2:if(n=r.EventResolveMap.get(t.uuid)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Object(_.c)(2e3);case 7:n.resolve(void 0);case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),this.EventResolveMap=new Map,f.a.on(p.a.PC.DRIVE.WPS_SAVED_RESULT,this.handleWPSSaveResult)}function t(){return n.apply(this,arguments)}var n;return l()(e,[{key:"destroy",value:function(){f.a.off(p.a.PC.DRIVE.WPS_SAVED_RESULT,this.handleWPSSaveResult),this.EventResolveMap&&(this.EventResolveMap.forEach(function(e){e.resolve(void 0)}),this.EventResolveMap=null)}},{key:"triggerSave",value:(n=a()(o.a.mark(function e(){var t,n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise(function(e){if(!n.EventResolveMap)return e(void 0);var t=Object(d.c)(6);n.EventResolveMap.set(t,{resolve:e}),f.a.emit(p.a.PC.DRIVE.TRIGGER_WPS_SAVE,t)}),e.abrupt("return",Promise.race([t,Object(_.c)(4e3)]));case 2:case"end":return e.stop()}},e)})),t)}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}},{key:"destroyInstance",value:function(){this.instance&&(this.instance.destroy(),this.instance=null)}}]),e}();E.instance=null},wpDl:function(e,t,n){"use strict";var i=n("fshX"),a=n("SiRs"),s=n("efZk"),c=Math.min;function r(e){var o=Math[e];return function(e,t){if(e=Object(a.a)(e),t=null==t?0:c(Object(i.a)(t),292)){var n=(Object(s.a)(e)+"e").split("e"),r=o(n[0]+"e"+(+n[1]+t));return+((n=(Object(s.a)(r)+"e").split("e"))[0]+"e"+(+n[1]-t))}return o(e)}}t.a=r},xUlX:function(e,t,n){"use strict";var d=n("twO/"),f=n("AUh1");function r(e,t,n,r){for(var o=n-1,i=e.length;++o<i;)if(r(e[o],t))return o;return-1}var p=r,_=n("ovuK"),E=n("eAQQ"),h=Array.prototype.splice;function o(e,t,n,r){var o=r?p:f.a,i=-1,a=t.length,s=e;for(e===t&&(t=Object(E.a)(t)),n&&(s=Object(d.a)(e,Object(_.a)(n)));++i<a;)for(var c=0,u=t[i],l=n?n(u):u;-1<(c=o(s,l,c,r));)s!==e&&h.call(s,c,1),h.call(e,c,1);return e}t.a=o},xiBh:function(e,W,Y){"use strict";(function(u){Y.d(W,"b",function(){return F}),Y.d(W,"a",function(){return B});var e=Y("QILm"),l=Y.n(e),t=Y("lSNA"),d=Y.n(t),n=Y("o0o1"),f=Y.n(n),p=Y("oZtI"),r=Y("L342"),_=Y("fRsX"),E=Y("aR0j"),h=Y("Y0Lu"),m=Y("XMIC"),O=Y("jryj"),o=Y("jp/M"),i=Y("1T6K"),y=Y("lBQb"),g=Y("6omo"),v=Y("LCeV"),b=Y("8LbN"),T=Y("QM+C"),a=Y("hMnB"),R=Y.n(a),S=Y("t6I4"),C=Y("PCyy"),I=Y("Jonh"),s=f.a.mark(F),c=f.a.mark(x),L=f.a.mark(M),N=f.a.mark(j),w=f.a.mark(U),D=f.a.mark(B),k=f.a.mark(V),P=f.a.mark(H);function F(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.all)([Object(p.fork)(x),Object(p.fork)(M)]);case 2:case"end":return e.stop()}},s)}function x(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.takeEvery)(o.actionTypes.ui.CALL_TEMPLATE_CENTER,U);case 2:case"end":return e.stop()}},c)}function M(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.takeEvery)(o.actionTypes.template.CREATE_BLANK_FILE,j);case 2:case"end":return e.stop()}},L)}function j(t){var n,r,o,i,a,s,c,u;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t[T.DEFERRED],r=t.payload,o=r.createType,i=r.isCtrlOrMetaKeyClicked,a=r.path,s=r.type,c=r.isFromTemplateCenter,-1<T.suiteType.indexOf(o))return e.next=5,Object(b.a)({type:s,createType:o,isCtrlOrMetaKeyClicked:i,path:a,isFromTemplateCenter:c});e.next=7;break;case 5:(u=e.sent)?n&&n.resolve(u):n&&n.reject(new Error("fail"));case 7:case"end":return e.stop()}},N)}function U(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(t.payload);case 2:case"end":return e.stop()}},w)}function B(){var t,n,r,o,i,a,s,c=arguments;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<c.length&&void 0!==c[0]?c[0]:{},n=t.isCtrlOrMetaKeyClicked,r=t.objType,o=t.categoryId,i=t.topicId,!_.c){e.next=12;break}if(!u||!I.c){e.next=8;break}s=Object(S.a)(R.a.href,(a={},d()(a,C.a.OPEN_TEMPLATE_CENTER,g.j.GALLERY),d()(a,C.a.TEMPLATE_OBJ_TYPE,r),d()(a,C.a.TEMPLATE_CATEGORY,o),d()(a,C.a.TEMPLATE_TOPIC_ID,i),a)),window.open(s,"_blank"),e.next=10;break;case 8:return e.next=10,H(t);case 10:e.next=14;break;case 12:return e.next=14,V(!!n);case 14:case"end":return e.stop()}},D)}function V(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}window.open(location.origin+i.URL.TEMPLATE),e.next=6;break;case 4:return e.next=6,Object(p.put)(Object(r.b)(i.URL.TEMPLATE));case 6:case"end":return e.stop()}},k)}function H(t){var n,r,o,i,a,s,c,u;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.path,r=l()(t,["path"]),o="",i=y.p?O.MODAL_TYPES.CREATE_BY_TEMPLATE_NEW_LAYOUT:O.MODAL_TYPES.CREATE_BY_TEMPLATE,Object(h.d)(n))return e.next=6,Object(p.select)(E.qb);e.next=11;break;case 6:a=e.sent,s=a.token,o=s,e.next=16;break;case 11:return e.next=13,Object(p.select)(E.s);case 13:c=e.sent,u=Object(v.a)(c.toJS()),o=u;case 16:return e.next=18,Object(p.put)(Object(m.c)(i,Object.assign({},r,{targetToken:o})));case 18:case"end":return e.stop()}},P)}}).call(this,Y("kCIs"))}}]);
//# sourceMappingURL=ui-control_modules.5aced0006874c5d3d2c6.js.map